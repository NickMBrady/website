var Jre=Object.defineProperty;var Wie=nt=>{throw TypeError(nt)};var ene=(nt,st,mt)=>st in nt?Jre(nt,st,{enumerable:!0,configurable:!0,writable:!0,value:mt}):nt[st]=mt;var lee=(nt,st,mt)=>ene(nt,typeof st!="symbol"?st+"":st,mt),Yte=(nt,st,mt)=>st.has(nt)||Wie("Cannot "+mt);var Sv=(nt,st,mt)=>(Yte(nt,st,"read from private field"),mt?mt.call(nt):st.get(nt)),G$=(nt,st,mt)=>st.has(nt)?Wie("Cannot add the same private member more than once"):st instanceof WeakSet?st.add(nt):st.set(nt,mt),K$=(nt,st,mt,gt)=>(Yte(nt,st,"write to private field"),gt?gt.call(nt,mt):st.set(nt,mt),mt),L$=(nt,st,mt)=>(Yte(nt,st,"access private method"),mt);var hte=(nt,st,mt,gt)=>({set _(_t){K$(nt,st,_t,mt)},get _(){return Sv(nt,st,gt)}});function _mergeNamespaces(nt,st){for(var mt=0;mt<st.length;mt++){const gt=st[mt];if(typeof gt!="string"&&!Array.isArray(gt)){for(const _t in gt)if(_t!=="default"&&!(_t in nt)){const Et=Object.getOwnPropertyDescriptor(gt,_t);Et&&Object.defineProperty(nt,_t,Et.get?Et:{enumerable:!0,get:()=>gt[_t]})}}}return Object.freeze(Object.defineProperty(nt,Symbol.toStringTag,{value:"Module"}))}(function(){const st=document.createElement("link").relList;if(st&&st.supports&&st.supports("modulepreload"))return;for(const _t of document.querySelectorAll('link[rel="modulepreload"]'))gt(_t);new MutationObserver(_t=>{for(const Et of _t)if(Et.type==="childList")for(const At of Et.addedNodes)At.tagName==="LINK"&&At.rel==="modulepreload"&&gt(At)}).observe(document,{childList:!0,subtree:!0});function mt(_t){const Et={};return _t.integrity&&(Et.integrity=_t.integrity),_t.referrerPolicy&&(Et.referrerPolicy=_t.referrerPolicy),_t.crossOrigin==="use-credentials"?Et.credentials="include":_t.crossOrigin==="anonymous"?Et.credentials="omit":Et.credentials="same-origin",Et}function gt(_t){if(_t.ep)return;_t.ep=!0;const Et=mt(_t);fetch(_t.href,Et)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(nt){return nt&&nt.__esModule&&Object.prototype.hasOwnProperty.call(nt,"default")?nt.default:nt}function getAugmentedNamespace(nt){if(nt.__esModule)return nt;var st=nt.default;if(typeof st=="function"){var mt=function gt(){return this instanceof gt?Reflect.construct(st,arguments,this.constructor):st.apply(this,arguments)};mt.prototype=st.prototype}else mt={};return Object.defineProperty(mt,"__esModule",{value:!0}),Object.keys(nt).forEach(function(gt){var _t=Object.getOwnPropertyDescriptor(nt,gt);Object.defineProperty(mt,gt,_t.get?_t:{enumerable:!0,get:function(){return nt[gt]}})}),mt}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$f=Symbol.for("react.element"),n$g=Symbol.for("react.portal"),p$a=Symbol.for("react.fragment"),q$2=Symbol.for("react.strict_mode"),r$g=Symbol.for("react.profiler"),t$g=Symbol.for("react.provider"),u$e=Symbol.for("react.context"),v$8=Symbol.for("react.forward_ref"),w$3=Symbol.for("react.suspense"),x$3=Symbol.for("react.memo"),y$4=Symbol.for("react.lazy"),z$3=Symbol.iterator;function A$2(nt){return nt===null||typeof nt!="object"?null:(nt=z$3&&nt[z$3]||nt["@@iterator"],typeof nt=="function"?nt:null)}var B$2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$7=Object.assign,D$3={};function E$8(nt,st,mt){this.props=nt,this.context=st,this.refs=D$3,this.updater=mt||B$2}E$8.prototype.isReactComponent={};E$8.prototype.setState=function(nt,st){if(typeof nt!="object"&&typeof nt!="function"&&nt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,nt,st,"setState")};E$8.prototype.forceUpdate=function(nt){this.updater.enqueueForceUpdate(this,nt,"forceUpdate")};function F$2(){}F$2.prototype=E$8.prototype;function G$2(nt,st,mt){this.props=nt,this.context=st,this.refs=D$3,this.updater=mt||B$2}var H$2=G$2.prototype=new F$2;H$2.constructor=G$2;C$7(H$2,E$8.prototype);H$2.isPureReactComponent=!0;var I$6=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$3={current:null},L$3={key:!0,ref:!0,__self:!0,__source:!0};function M$6(nt,st,mt){var gt,_t={},Et=null,At=null;if(st!=null)for(gt in st.ref!==void 0&&(At=st.ref),st.key!==void 0&&(Et=""+st.key),st)J$1.call(st,gt)&&!L$3.hasOwnProperty(gt)&&(_t[gt]=st[gt]);var Rt=arguments.length-2;if(Rt===1)_t.children=mt;else if(1<Rt){for(var Ft=Array(Rt),Nt=0;Nt<Rt;Nt++)Ft[Nt]=arguments[Nt+2];_t.children=Ft}if(nt&&nt.defaultProps)for(gt in Rt=nt.defaultProps,Rt)_t[gt]===void 0&&(_t[gt]=Rt[gt]);return{$$typeof:l$f,type:nt,key:Et,ref:At,props:_t,_owner:K$3.current}}function N$2(nt,st){return{$$typeof:l$f,type:nt.type,key:st,ref:nt.ref,props:nt.props,_owner:nt._owner}}function O$2(nt){return typeof nt=="object"&&nt!==null&&nt.$$typeof===l$f}function escape$1(nt){var st={"=":"=0",":":"=2"};return"$"+nt.replace(/[=:]/g,function(mt){return st[mt]})}var P$4=/\/+/g;function Q$2(nt,st){return typeof nt=="object"&&nt!==null&&nt.key!=null?escape$1(""+nt.key):st.toString(36)}function R$2(nt,st,mt,gt,_t){var Et=typeof nt;(Et==="undefined"||Et==="boolean")&&(nt=null);var At=!1;if(nt===null)At=!0;else switch(Et){case"string":case"number":At=!0;break;case"object":switch(nt.$$typeof){case l$f:case n$g:At=!0}}if(At)return At=nt,_t=_t(At),nt=gt===""?"."+Q$2(At,0):gt,I$6(_t)?(mt="",nt!=null&&(mt=nt.replace(P$4,"$&/")+"/"),R$2(_t,st,mt,"",function(Nt){return Nt})):_t!=null&&(O$2(_t)&&(_t=N$2(_t,mt+(!_t.key||At&&At.key===_t.key?"":(""+_t.key).replace(P$4,"$&/")+"/")+nt)),st.push(_t)),1;if(At=0,gt=gt===""?".":gt+":",I$6(nt))for(var Rt=0;Rt<nt.length;Rt++){Et=nt[Rt];var Ft=gt+Q$2(Et,Rt);At+=R$2(Et,st,mt,Ft,_t)}else if(Ft=A$2(nt),typeof Ft=="function")for(nt=Ft.call(nt),Rt=0;!(Et=nt.next()).done;)Et=Et.value,Ft=gt+Q$2(Et,Rt++),At+=R$2(Et,st,mt,Ft,_t);else if(Et==="object")throw st=String(nt),Error("Objects are not valid as a React child (found: "+(st==="[object Object]"?"object with keys {"+Object.keys(nt).join(", ")+"}":st)+"). If you meant to render a collection of children, use an array instead.");return At}function S$7(nt,st,mt){if(nt==null)return nt;var gt=[],_t=0;return R$2(nt,gt,"","",function(Et){return st.call(mt,Et,_t++)}),gt}function T$3(nt){if(nt._status===-1){var st=nt._result;st=st(),st.then(function(mt){(nt._status===0||nt._status===-1)&&(nt._status=1,nt._result=mt)},function(mt){(nt._status===0||nt._status===-1)&&(nt._status=2,nt._result=mt)}),nt._status===-1&&(nt._status=0,nt._result=st)}if(nt._status===1)return nt._result.default;throw nt._result}var U$3={current:null},V$2={transition:null},W$2={ReactCurrentDispatcher:U$3,ReactCurrentBatchConfig:V$2,ReactCurrentOwner:K$3};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$7,forEach:function(nt,st,mt){S$7(nt,function(){st.apply(this,arguments)},mt)},count:function(nt){var st=0;return S$7(nt,function(){st++}),st},toArray:function(nt){return S$7(nt,function(st){return st})||[]},only:function(nt){if(!O$2(nt))throw Error("React.Children.only expected to receive a single React element child.");return nt}};react_production_min.Component=E$8;react_production_min.Fragment=p$a;react_production_min.Profiler=r$g;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$2;react_production_min.Suspense=w$3;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.act=X$2;react_production_min.cloneElement=function(nt,st,mt){if(nt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+nt+".");var gt=C$7({},nt.props),_t=nt.key,Et=nt.ref,At=nt._owner;if(st!=null){if(st.ref!==void 0&&(Et=st.ref,At=K$3.current),st.key!==void 0&&(_t=""+st.key),nt.type&&nt.type.defaultProps)var Rt=nt.type.defaultProps;for(Ft in st)J$1.call(st,Ft)&&!L$3.hasOwnProperty(Ft)&&(gt[Ft]=st[Ft]===void 0&&Rt!==void 0?Rt[Ft]:st[Ft])}var Ft=arguments.length-2;if(Ft===1)gt.children=mt;else if(1<Ft){Rt=Array(Ft);for(var Nt=0;Nt<Ft;Nt++)Rt[Nt]=arguments[Nt+2];gt.children=Rt}return{$$typeof:l$f,type:nt.type,key:_t,ref:Et,props:gt,_owner:At}};react_production_min.createContext=function(nt){return nt={$$typeof:u$e,_currentValue:nt,_currentValue2:nt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},nt.Provider={$$typeof:t$g,_context:nt},nt.Consumer=nt};react_production_min.createElement=M$6;react_production_min.createFactory=function(nt){var st=M$6.bind(null,nt);return st.type=nt,st};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(nt){return{$$typeof:v$8,render:nt}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(nt){return{$$typeof:y$4,_payload:{_status:-1,_result:nt},_init:T$3}};react_production_min.memo=function(nt,st){return{$$typeof:x$3,type:nt,compare:st===void 0?null:st}};react_production_min.startTransition=function(nt){var st=V$2.transition;V$2.transition={};try{nt()}finally{V$2.transition=st}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(nt,st){return U$3.current.useCallback(nt,st)};react_production_min.useContext=function(nt){return U$3.current.useContext(nt)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(nt){return U$3.current.useDeferredValue(nt)};react_production_min.useEffect=function(nt,st){return U$3.current.useEffect(nt,st)};react_production_min.useId=function(){return U$3.current.useId()};react_production_min.useImperativeHandle=function(nt,st,mt){return U$3.current.useImperativeHandle(nt,st,mt)};react_production_min.useInsertionEffect=function(nt,st){return U$3.current.useInsertionEffect(nt,st)};react_production_min.useLayoutEffect=function(nt,st){return U$3.current.useLayoutEffect(nt,st)};react_production_min.useMemo=function(nt,st){return U$3.current.useMemo(nt,st)};react_production_min.useReducer=function(nt,st,mt){return U$3.current.useReducer(nt,st,mt)};react_production_min.useRef=function(nt){return U$3.current.useRef(nt)};react_production_min.useState=function(nt){return U$3.current.useState(nt)};react_production_min.useSyncExternalStore=function(nt,st,mt){return U$3.current.useSyncExternalStore(nt,st,mt)};react_production_min.useTransition=function(){return U$3.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$b=reactExports,k$5=Symbol.for("react.element"),l$e=Symbol.for("react.fragment"),m$c=Object.prototype.hasOwnProperty,n$f=f$b.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$9={key:!0,ref:!0,__self:!0,__source:!0};function q$1(nt,st,mt){var gt,_t={},Et=null,At=null;mt!==void 0&&(Et=""+mt),st.key!==void 0&&(Et=""+st.key),st.ref!==void 0&&(At=st.ref);for(gt in st)m$c.call(st,gt)&&!p$9.hasOwnProperty(gt)&&(_t[gt]=st[gt]);if(nt&&nt.defaultProps)for(gt in st=nt.defaultProps,st)_t[gt]===void 0&&(_t[gt]=st[gt]);return{$$typeof:k$5,type:nt,key:Et,ref:At,props:_t,_owner:n$f.current}}reactJsxRuntime_production_min.Fragment=l$e;reactJsxRuntime_production_min.jsx=q$1;reactJsxRuntime_production_min.jsxs=q$1;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(nt){function st(W0,hu){var a1=W0.length;W0.push(hu);e:for(;0<a1;){var Vx=a1-1>>>1,t0=W0[Vx];if(0<_t(t0,hu))W0[Vx]=hu,W0[a1]=t0,a1=Vx;else break e}}function mt(W0){return W0.length===0?null:W0[0]}function gt(W0){if(W0.length===0)return null;var hu=W0[0],a1=W0.pop();if(a1!==hu){W0[0]=a1;e:for(var Vx=0,t0=W0.length,cu=t0>>>1;Vx<cu;){var lu=2*(Vx+1)-1,b0=W0[lu],l1=lu+1,LE=W0[l1];if(0>_t(b0,a1))l1<t0&&0>_t(LE,b0)?(W0[Vx]=LE,W0[l1]=a1,Vx=l1):(W0[Vx]=b0,W0[lu]=a1,Vx=lu);else if(l1<t0&&0>_t(LE,a1))W0[Vx]=LE,W0[l1]=a1,Vx=l1;else break e}}return hu}function _t(W0,hu){var a1=W0.sortIndex-hu.sortIndex;return a1!==0?a1:W0.id-hu.id}if(typeof performance=="object"&&typeof performance.now=="function"){var Et=performance;nt.unstable_now=function(){return Et.now()}}else{var At=Date,Rt=At.now();nt.unstable_now=function(){return At.now()-Rt}}var Ft=[],Nt=[],Bt=1,Gt=null,dr=3,Mr=!1,Tr=!1,zr=!1,Fr=typeof setTimeout=="function"?setTimeout:null,Nr=typeof clearTimeout=="function"?clearTimeout:null,tn=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function rn(W0){for(var hu=mt(Nt);hu!==null;){if(hu.callback===null)gt(Nt);else if(hu.startTime<=W0)gt(Nt),hu.sortIndex=hu.expirationTime,st(Ft,hu);else break;hu=mt(Nt)}}function Tn(W0){if(zr=!1,rn(W0),!Tr)if(mt(Ft)!==null)Tr=!0,X1($n);else{var hu=mt(Nt);hu!==null&&q0(Tn,hu.startTime-W0)}}function $n(W0,hu){Tr=!1,zr&&(zr=!1,Nr(kn),kn=-1),Mr=!0;var a1=dr;try{for(rn(hu),Gt=mt(Ft);Gt!==null&&(!(Gt.expirationTime>hu)||W0&&!ds());){var Vx=Gt.callback;if(typeof Vx=="function"){Gt.callback=null,dr=Gt.priorityLevel;var t0=Vx(Gt.expirationTime<=hu);hu=nt.unstable_now(),typeof t0=="function"?Gt.callback=t0:Gt===mt(Ft)&&gt(Ft),rn(hu)}else gt(Ft);Gt=mt(Ft)}if(Gt!==null)var cu=!0;else{var lu=mt(Nt);lu!==null&&q0(Tn,lu.startTime-hu),cu=!1}return cu}finally{Gt=null,dr=a1,Mr=!1}}var un=!1,es=null,kn=-1,ts=5,Ko=-1;function ds(){return!(nt.unstable_now()-Ko<ts)}function Il(){if(es!==null){var W0=nt.unstable_now();Ko=W0;var hu=!0;try{hu=es(!0,W0)}finally{hu?ru():(un=!1,es=null)}}else un=!1}var ru;if(typeof tn=="function")ru=function(){tn(Il)};else if(typeof MessageChannel<"u"){var uu=new MessageChannel,p0=uu.port2;uu.port1.onmessage=Il,ru=function(){p0.postMessage(null)}}else ru=function(){Fr(Il,0)};function X1(W0){es=W0,un||(un=!0,ru())}function q0(W0,hu){kn=Fr(function(){W0(nt.unstable_now())},hu)}nt.unstable_IdlePriority=5,nt.unstable_ImmediatePriority=1,nt.unstable_LowPriority=4,nt.unstable_NormalPriority=3,nt.unstable_Profiling=null,nt.unstable_UserBlockingPriority=2,nt.unstable_cancelCallback=function(W0){W0.callback=null},nt.unstable_continueExecution=function(){Tr||Mr||(Tr=!0,X1($n))},nt.unstable_forceFrameRate=function(W0){0>W0||125<W0?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ts=0<W0?Math.floor(1e3/W0):5},nt.unstable_getCurrentPriorityLevel=function(){return dr},nt.unstable_getFirstCallbackNode=function(){return mt(Ft)},nt.unstable_next=function(W0){switch(dr){case 1:case 2:case 3:var hu=3;break;default:hu=dr}var a1=dr;dr=hu;try{return W0()}finally{dr=a1}},nt.unstable_pauseExecution=function(){},nt.unstable_requestPaint=function(){},nt.unstable_runWithPriority=function(W0,hu){switch(W0){case 1:case 2:case 3:case 4:case 5:break;default:W0=3}var a1=dr;dr=W0;try{return hu()}finally{dr=a1}},nt.unstable_scheduleCallback=function(W0,hu,a1){var Vx=nt.unstable_now();switch(typeof a1=="object"&&a1!==null?(a1=a1.delay,a1=typeof a1=="number"&&0<a1?Vx+a1:Vx):a1=Vx,W0){case 1:var t0=-1;break;case 2:t0=250;break;case 5:t0=1073741823;break;case 4:t0=1e4;break;default:t0=5e3}return t0=a1+t0,W0={id:Bt++,callback:hu,priorityLevel:W0,startTime:a1,expirationTime:t0,sortIndex:-1},a1>Vx?(W0.sortIndex=a1,st(Nt,W0),mt(Ft)===null&&W0===mt(Nt)&&(zr?(Nr(kn),kn=-1):zr=!0,q0(Tn,a1-Vx))):(W0.sortIndex=t0,st(Ft,W0),Tr||Mr||(Tr=!0,X1($n))),W0},nt.unstable_shouldYield=ds,nt.unstable_wrapCallback=function(W0){var hu=dr;return function(){var a1=dr;dr=hu;try{return W0.apply(this,arguments)}finally{dr=a1}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa$1=reactExports,ca$1=schedulerExports;function p$8(nt){for(var st="https://reactjs.org/docs/error-decoder.html?invariant="+nt,mt=1;mt<arguments.length;mt++)st+="&args[]="+encodeURIComponent(arguments[mt]);return"Minified React error #"+nt+"; visit "+st+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da$1=new Set,ea$1={};function fa$1(nt,st){ha$1(nt,st),ha$1(nt+"Capture",st)}function ha$1(nt,st){for(ea$1[nt]=st,nt=0;nt<st.length;nt++)da$1.add(st[nt])}var ia$1=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja$1=Object.prototype.hasOwnProperty,ka$1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la$1={},ma$1={};function oa$1(nt){return ja$1.call(ma$1,nt)?!0:ja$1.call(la$1,nt)?!1:ka$1.test(nt)?ma$1[nt]=!0:(la$1[nt]=!0,!1)}function pa$1(nt,st,mt,gt){if(mt!==null&&mt.type===0)return!1;switch(typeof st){case"function":case"symbol":return!0;case"boolean":return gt?!1:mt!==null?!mt.acceptsBooleans:(nt=nt.toLowerCase().slice(0,5),nt!=="data-"&&nt!=="aria-");default:return!1}}function qa$1(nt,st,mt,gt){if(st===null||typeof st>"u"||pa$1(nt,st,mt,gt))return!0;if(gt)return!1;if(mt!==null)switch(mt.type){case 3:return!st;case 4:return st===!1;case 5:return isNaN(st);case 6:return isNaN(st)||1>st}return!1}function v$7(nt,st,mt,gt,_t,Et,At){this.acceptsBooleans=st===2||st===3||st===4,this.attributeName=gt,this.attributeNamespace=_t,this.mustUseProperty=mt,this.propertyName=nt,this.type=st,this.sanitizeURL=Et,this.removeEmptyString=At}var z$2={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(nt){z$2[nt]=new v$7(nt,0,!1,nt,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(nt){var st=nt[0];z$2[st]=new v$7(st,1,!1,nt[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(nt){z$2[nt]=new v$7(nt,2,!1,nt.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(nt){z$2[nt]=new v$7(nt,2,!1,nt,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(nt){z$2[nt]=new v$7(nt,3,!1,nt.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(nt){z$2[nt]=new v$7(nt,3,!0,nt,null,!1,!1)});["capture","download"].forEach(function(nt){z$2[nt]=new v$7(nt,4,!1,nt,null,!1,!1)});["cols","rows","size","span"].forEach(function(nt){z$2[nt]=new v$7(nt,6,!1,nt,null,!1,!1)});["rowSpan","start"].forEach(function(nt){z$2[nt]=new v$7(nt,5,!1,nt.toLowerCase(),null,!1,!1)});var ra$1=/[\-:]([a-z])/g;function sa$1(nt){return nt[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(nt){var st=nt.replace(ra$1,sa$1);z$2[st]=new v$7(st,1,!1,nt,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(nt){var st=nt.replace(ra$1,sa$1);z$2[st]=new v$7(st,1,!1,nt,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(nt){var st=nt.replace(ra$1,sa$1);z$2[st]=new v$7(st,1,!1,nt,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(nt){z$2[nt]=new v$7(nt,1,!1,nt.toLowerCase(),null,!1,!1)});z$2.xlinkHref=new v$7("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(nt){z$2[nt]=new v$7(nt,1,!1,nt.toLowerCase(),null,!0,!0)});function ta$1(nt,st,mt,gt){var _t=z$2.hasOwnProperty(st)?z$2[st]:null;(_t!==null?_t.type!==0:gt||!(2<st.length)||st[0]!=="o"&&st[0]!=="O"||st[1]!=="n"&&st[1]!=="N")&&(qa$1(st,mt,_t,gt)&&(mt=null),gt||_t===null?oa$1(st)&&(mt===null?nt.removeAttribute(st):nt.setAttribute(st,""+mt)):_t.mustUseProperty?nt[_t.propertyName]=mt===null?_t.type===3?!1:"":mt:(st=_t.attributeName,gt=_t.attributeNamespace,mt===null?nt.removeAttribute(st):(_t=_t.type,mt=_t===3||_t===4&&mt===!0?"":""+mt,gt?nt.setAttributeNS(gt,st,mt):nt.setAttribute(st,mt))))}var ua$1=aa$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va$1=Symbol.for("react.element"),wa$1=Symbol.for("react.portal"),ya$1=Symbol.for("react.fragment"),za$1=Symbol.for("react.strict_mode"),Aa$1=Symbol.for("react.profiler"),Ba$1=Symbol.for("react.provider"),Ca$1=Symbol.for("react.context"),Da$1=Symbol.for("react.forward_ref"),Ea$1=Symbol.for("react.suspense"),Fa$1=Symbol.for("react.suspense_list"),Ga$1=Symbol.for("react.memo"),Ha$1=Symbol.for("react.lazy"),Ia$1=Symbol.for("react.offscreen"),Ja$1=Symbol.iterator;function Ka$1(nt){return nt===null||typeof nt!="object"?null:(nt=Ja$1&&nt[Ja$1]||nt["@@iterator"],typeof nt=="function"?nt:null)}var A$1=Object.assign,La$1;function Ma$1(nt){if(La$1===void 0)try{throw Error()}catch(mt){var st=mt.stack.trim().match(/\n( *(at )?)/);La$1=st&&st[1]||""}return`
`+La$1+nt}var Na$1=!1;function Oa$1(nt,st){if(!nt||Na$1)return"";Na$1=!0;var mt=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(st)if(st=function(){throw Error()},Object.defineProperty(st.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(st,[])}catch(Nt){var gt=Nt}Reflect.construct(nt,[],st)}else{try{st.call()}catch(Nt){gt=Nt}nt.call(st.prototype)}else{try{throw Error()}catch(Nt){gt=Nt}nt()}}catch(Nt){if(Nt&&gt&&typeof Nt.stack=="string"){for(var _t=Nt.stack.split(`
`),Et=gt.stack.split(`
`),At=_t.length-1,Rt=Et.length-1;1<=At&&0<=Rt&&_t[At]!==Et[Rt];)Rt--;for(;1<=At&&0<=Rt;At--,Rt--)if(_t[At]!==Et[Rt]){if(At!==1||Rt!==1)do if(At--,Rt--,0>Rt||_t[At]!==Et[Rt]){var Ft=`
`+_t[At].replace(" at new "," at ");return nt.displayName&&Ft.includes("<anonymous>")&&(Ft=Ft.replace("<anonymous>",nt.displayName)),Ft}while(1<=At&&0<=Rt);break}}}finally{Na$1=!1,Error.prepareStackTrace=mt}return(nt=nt?nt.displayName||nt.name:"")?Ma$1(nt):""}function Pa$1(nt){switch(nt.tag){case 5:return Ma$1(nt.type);case 16:return Ma$1("Lazy");case 13:return Ma$1("Suspense");case 19:return Ma$1("SuspenseList");case 0:case 2:case 15:return nt=Oa$1(nt.type,!1),nt;case 11:return nt=Oa$1(nt.type.render,!1),nt;case 1:return nt=Oa$1(nt.type,!0),nt;default:return""}}function Qa$1(nt){if(nt==null)return null;if(typeof nt=="function")return nt.displayName||nt.name||null;if(typeof nt=="string")return nt;switch(nt){case ya$1:return"Fragment";case wa$1:return"Portal";case Aa$1:return"Profiler";case za$1:return"StrictMode";case Ea$1:return"Suspense";case Fa$1:return"SuspenseList"}if(typeof nt=="object")switch(nt.$$typeof){case Ca$1:return(nt.displayName||"Context")+".Consumer";case Ba$1:return(nt._context.displayName||"Context")+".Provider";case Da$1:var st=nt.render;return nt=nt.displayName,nt||(nt=st.displayName||st.name||"",nt=nt!==""?"ForwardRef("+nt+")":"ForwardRef"),nt;case Ga$1:return st=nt.displayName||null,st!==null?st:Qa$1(nt.type)||"Memo";case Ha$1:st=nt._payload,nt=nt._init;try{return Qa$1(nt(st))}catch{}}return null}function Ra$1(nt){var st=nt.type;switch(nt.tag){case 24:return"Cache";case 9:return(st.displayName||"Context")+".Consumer";case 10:return(st._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return nt=st.render,nt=nt.displayName||nt.name||"",st.displayName||(nt!==""?"ForwardRef("+nt+")":"ForwardRef");case 7:return"Fragment";case 5:return st;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa$1(st);case 8:return st===za$1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof st=="function")return st.displayName||st.name||null;if(typeof st=="string")return st}return null}function Sa$1(nt){switch(typeof nt){case"boolean":case"number":case"string":case"undefined":return nt;case"object":return nt;default:return""}}function Ta$1(nt){var st=nt.type;return(nt=nt.nodeName)&&nt.toLowerCase()==="input"&&(st==="checkbox"||st==="radio")}function Ua$1(nt){var st=Ta$1(nt)?"checked":"value",mt=Object.getOwnPropertyDescriptor(nt.constructor.prototype,st),gt=""+nt[st];if(!nt.hasOwnProperty(st)&&typeof mt<"u"&&typeof mt.get=="function"&&typeof mt.set=="function"){var _t=mt.get,Et=mt.set;return Object.defineProperty(nt,st,{configurable:!0,get:function(){return _t.call(this)},set:function(At){gt=""+At,Et.call(this,At)}}),Object.defineProperty(nt,st,{enumerable:mt.enumerable}),{getValue:function(){return gt},setValue:function(At){gt=""+At},stopTracking:function(){nt._valueTracker=null,delete nt[st]}}}}function Va$1(nt){nt._valueTracker||(nt._valueTracker=Ua$1(nt))}function Wa$1(nt){if(!nt)return!1;var st=nt._valueTracker;if(!st)return!0;var mt=st.getValue(),gt="";return nt&&(gt=Ta$1(nt)?nt.checked?"true":"false":nt.value),nt=gt,nt!==mt?(st.setValue(nt),!0):!1}function Xa$1(nt){if(nt=nt||(typeof document<"u"?document:void 0),typeof nt>"u")return null;try{return nt.activeElement||nt.body}catch{return nt.body}}function Ya$1(nt,st){var mt=st.checked;return A$1({},st,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:mt??nt._wrapperState.initialChecked})}function Za$1(nt,st){var mt=st.defaultValue==null?"":st.defaultValue,gt=st.checked!=null?st.checked:st.defaultChecked;mt=Sa$1(st.value!=null?st.value:mt),nt._wrapperState={initialChecked:gt,initialValue:mt,controlled:st.type==="checkbox"||st.type==="radio"?st.checked!=null:st.value!=null}}function ab$1(nt,st){st=st.checked,st!=null&&ta$1(nt,"checked",st,!1)}function bb$1(nt,st){ab$1(nt,st);var mt=Sa$1(st.value),gt=st.type;if(mt!=null)gt==="number"?(mt===0&&nt.value===""||nt.value!=mt)&&(nt.value=""+mt):nt.value!==""+mt&&(nt.value=""+mt);else if(gt==="submit"||gt==="reset"){nt.removeAttribute("value");return}st.hasOwnProperty("value")?cb$1(nt,st.type,mt):st.hasOwnProperty("defaultValue")&&cb$1(nt,st.type,Sa$1(st.defaultValue)),st.checked==null&&st.defaultChecked!=null&&(nt.defaultChecked=!!st.defaultChecked)}function db$1(nt,st,mt){if(st.hasOwnProperty("value")||st.hasOwnProperty("defaultValue")){var gt=st.type;if(!(gt!=="submit"&&gt!=="reset"||st.value!==void 0&&st.value!==null))return;st=""+nt._wrapperState.initialValue,mt||st===nt.value||(nt.value=st),nt.defaultValue=st}mt=nt.name,mt!==""&&(nt.name=""),nt.defaultChecked=!!nt._wrapperState.initialChecked,mt!==""&&(nt.name=mt)}function cb$1(nt,st,mt){(st!=="number"||Xa$1(nt.ownerDocument)!==nt)&&(mt==null?nt.defaultValue=""+nt._wrapperState.initialValue:nt.defaultValue!==""+mt&&(nt.defaultValue=""+mt))}var eb$1=Array.isArray;function fb$1(nt,st,mt,gt){if(nt=nt.options,st){st={};for(var _t=0;_t<mt.length;_t++)st["$"+mt[_t]]=!0;for(mt=0;mt<nt.length;mt++)_t=st.hasOwnProperty("$"+nt[mt].value),nt[mt].selected!==_t&&(nt[mt].selected=_t),_t&&gt&&(nt[mt].defaultSelected=!0)}else{for(mt=""+Sa$1(mt),st=null,_t=0;_t<nt.length;_t++){if(nt[_t].value===mt){nt[_t].selected=!0,gt&&(nt[_t].defaultSelected=!0);return}st!==null||nt[_t].disabled||(st=nt[_t])}st!==null&&(st.selected=!0)}}function gb$1(nt,st){if(st.dangerouslySetInnerHTML!=null)throw Error(p$8(91));return A$1({},st,{value:void 0,defaultValue:void 0,children:""+nt._wrapperState.initialValue})}function hb$1(nt,st){var mt=st.value;if(mt==null){if(mt=st.children,st=st.defaultValue,mt!=null){if(st!=null)throw Error(p$8(92));if(eb$1(mt)){if(1<mt.length)throw Error(p$8(93));mt=mt[0]}st=mt}st==null&&(st=""),mt=st}nt._wrapperState={initialValue:Sa$1(mt)}}function ib$1(nt,st){var mt=Sa$1(st.value),gt=Sa$1(st.defaultValue);mt!=null&&(mt=""+mt,mt!==nt.value&&(nt.value=mt),st.defaultValue==null&&nt.defaultValue!==mt&&(nt.defaultValue=mt)),gt!=null&&(nt.defaultValue=""+gt)}function jb$1(nt){var st=nt.textContent;st===nt._wrapperState.initialValue&&st!==""&&st!==null&&(nt.value=st)}function kb$1(nt){switch(nt){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb$1(nt,st){return nt==null||nt==="http://www.w3.org/1999/xhtml"?kb$1(st):nt==="http://www.w3.org/2000/svg"&&st==="foreignObject"?"http://www.w3.org/1999/xhtml":nt}var mb$1,nb$1=function(nt){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(st,mt,gt,_t){MSApp.execUnsafeLocalFunction(function(){return nt(st,mt,gt,_t)})}:nt}(function(nt,st){if(nt.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in nt)nt.innerHTML=st;else{for(mb$1=mb$1||document.createElement("div"),mb$1.innerHTML="<svg>"+st.valueOf().toString()+"</svg>",st=mb$1.firstChild;nt.firstChild;)nt.removeChild(nt.firstChild);for(;st.firstChild;)nt.appendChild(st.firstChild)}});function ob$1(nt,st){if(st){var mt=nt.firstChild;if(mt&&mt===nt.lastChild&&mt.nodeType===3){mt.nodeValue=st;return}}nt.textContent=st}var pb$1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb$1=["Webkit","ms","Moz","O"];Object.keys(pb$1).forEach(function(nt){qb$1.forEach(function(st){st=st+nt.charAt(0).toUpperCase()+nt.substring(1),pb$1[st]=pb$1[nt]})});function rb$1(nt,st,mt){return st==null||typeof st=="boolean"||st===""?"":mt||typeof st!="number"||st===0||pb$1.hasOwnProperty(nt)&&pb$1[nt]?(""+st).trim():st+"px"}function sb(nt,st){nt=nt.style;for(var mt in st)if(st.hasOwnProperty(mt)){var gt=mt.indexOf("--")===0,_t=rb$1(mt,st[mt],gt);mt==="float"&&(mt="cssFloat"),gt?nt.setProperty(mt,_t):nt[mt]=_t}}var tb$1=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub$1(nt,st){if(st){if(tb$1[nt]&&(st.children!=null||st.dangerouslySetInnerHTML!=null))throw Error(p$8(137,nt));if(st.dangerouslySetInnerHTML!=null){if(st.children!=null)throw Error(p$8(60));if(typeof st.dangerouslySetInnerHTML!="object"||!("__html"in st.dangerouslySetInnerHTML))throw Error(p$8(61))}if(st.style!=null&&typeof st.style!="object")throw Error(p$8(62))}}function vb$1(nt,st){if(nt.indexOf("-")===-1)return typeof st.is=="string";switch(nt){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb$1=null;function xb$1(nt){return nt=nt.target||nt.srcElement||window,nt.correspondingUseElement&&(nt=nt.correspondingUseElement),nt.nodeType===3?nt.parentNode:nt}var yb$1=null,zb$1=null,Ab$1=null;function Bb$1(nt){if(nt=Cb$1(nt)){if(typeof yb$1!="function")throw Error(p$8(280));var st=nt.stateNode;st&&(st=Db$1(st),yb$1(nt.stateNode,nt.type,st))}}function Eb$1(nt){zb$1?Ab$1?Ab$1.push(nt):Ab$1=[nt]:zb$1=nt}function Fb$1(){if(zb$1){var nt=zb$1,st=Ab$1;if(Ab$1=zb$1=null,Bb$1(nt),st)for(nt=0;nt<st.length;nt++)Bb$1(st[nt])}}function Gb$1(nt,st){return nt(st)}function Hb$1(){}var Ib$1=!1;function Jb(nt,st,mt){if(Ib$1)return nt(st,mt);Ib$1=!0;try{return Gb$1(nt,st,mt)}finally{Ib$1=!1,(zb$1!==null||Ab$1!==null)&&(Hb$1(),Fb$1())}}function Kb$1(nt,st){var mt=nt.stateNode;if(mt===null)return null;var gt=Db$1(mt);if(gt===null)return null;mt=gt[st];e:switch(st){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(gt=!gt.disabled)||(nt=nt.type,gt=!(nt==="button"||nt==="input"||nt==="select"||nt==="textarea")),nt=!gt;break e;default:nt=!1}if(nt)return null;if(mt&&typeof mt!="function")throw Error(p$8(231,st,typeof mt));return mt}var Lb$1=!1;if(ia$1)try{var Mb$1={};Object.defineProperty(Mb$1,"passive",{get:function(){Lb$1=!0}}),window.addEventListener("test",Mb$1,Mb$1),window.removeEventListener("test",Mb$1,Mb$1)}catch{Lb$1=!1}function Nb$1(nt,st,mt,gt,_t,Et,At,Rt,Ft){var Nt=Array.prototype.slice.call(arguments,3);try{st.apply(mt,Nt)}catch(Bt){this.onError(Bt)}}var Ob$1=!1,Pb$1=null,Qb$1=!1,Rb$1=null,Sb$1={onError:function(nt){Ob$1=!0,Pb$1=nt}};function Tb$1(nt,st,mt,gt,_t,Et,At,Rt,Ft){Ob$1=!1,Pb$1=null,Nb$1.apply(Sb$1,arguments)}function Ub$1(nt,st,mt,gt,_t,Et,At,Rt,Ft){if(Tb$1.apply(this,arguments),Ob$1){if(Ob$1){var Nt=Pb$1;Ob$1=!1,Pb$1=null}else throw Error(p$8(198));Qb$1||(Qb$1=!0,Rb$1=Nt)}}function Vb$1(nt){var st=nt,mt=nt;if(nt.alternate)for(;st.return;)st=st.return;else{nt=st;do st=nt,st.flags&4098&&(mt=st.return),nt=st.return;while(nt)}return st.tag===3?mt:null}function Wb$1(nt){if(nt.tag===13){var st=nt.memoizedState;if(st===null&&(nt=nt.alternate,nt!==null&&(st=nt.memoizedState)),st!==null)return st.dehydrated}return null}function Xb$1(nt){if(Vb$1(nt)!==nt)throw Error(p$8(188))}function Yb$1(nt){var st=nt.alternate;if(!st){if(st=Vb$1(nt),st===null)throw Error(p$8(188));return st!==nt?null:nt}for(var mt=nt,gt=st;;){var _t=mt.return;if(_t===null)break;var Et=_t.alternate;if(Et===null){if(gt=_t.return,gt!==null){mt=gt;continue}break}if(_t.child===Et.child){for(Et=_t.child;Et;){if(Et===mt)return Xb$1(_t),nt;if(Et===gt)return Xb$1(_t),st;Et=Et.sibling}throw Error(p$8(188))}if(mt.return!==gt.return)mt=_t,gt=Et;else{for(var At=!1,Rt=_t.child;Rt;){if(Rt===mt){At=!0,mt=_t,gt=Et;break}if(Rt===gt){At=!0,gt=_t,mt=Et;break}Rt=Rt.sibling}if(!At){for(Rt=Et.child;Rt;){if(Rt===mt){At=!0,mt=Et,gt=_t;break}if(Rt===gt){At=!0,gt=Et,mt=_t;break}Rt=Rt.sibling}if(!At)throw Error(p$8(189))}}if(mt.alternate!==gt)throw Error(p$8(190))}if(mt.tag!==3)throw Error(p$8(188));return mt.stateNode.current===mt?nt:st}function Zb(nt){return nt=Yb$1(nt),nt!==null?$b(nt):null}function $b(nt){if(nt.tag===5||nt.tag===6)return nt;for(nt=nt.child;nt!==null;){var st=$b(nt);if(st!==null)return st;nt=nt.sibling}return null}var ac$1=ca$1.unstable_scheduleCallback,bc$1=ca$1.unstable_cancelCallback,cc$1=ca$1.unstable_shouldYield,dc$1=ca$1.unstable_requestPaint,B$1=ca$1.unstable_now,ec$1=ca$1.unstable_getCurrentPriorityLevel,fc$1=ca$1.unstable_ImmediatePriority,gc$1=ca$1.unstable_UserBlockingPriority,hc$1=ca$1.unstable_NormalPriority,ic$1=ca$1.unstable_LowPriority,jc$1=ca$1.unstable_IdlePriority,kc$1=null,lc$1=null;function mc$1(nt){if(lc$1&&typeof lc$1.onCommitFiberRoot=="function")try{lc$1.onCommitFiberRoot(kc$1,nt,void 0,(nt.current.flags&128)===128)}catch{}}var oc$1=Math.clz32?Math.clz32:nc$1,pc$1=Math.log,qc$1=Math.LN2;function nc$1(nt){return nt>>>=0,nt===0?32:31-(pc$1(nt)/qc$1|0)|0}var rc$1=64,sc$1=4194304;function tc$1(nt){switch(nt&-nt){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return nt&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return nt&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return nt}}function uc$1(nt,st){var mt=nt.pendingLanes;if(mt===0)return 0;var gt=0,_t=nt.suspendedLanes,Et=nt.pingedLanes,At=mt&268435455;if(At!==0){var Rt=At&~_t;Rt!==0?gt=tc$1(Rt):(Et&=At,Et!==0&&(gt=tc$1(Et)))}else At=mt&~_t,At!==0?gt=tc$1(At):Et!==0&&(gt=tc$1(Et));if(gt===0)return 0;if(st!==0&&st!==gt&&!(st&_t)&&(_t=gt&-gt,Et=st&-st,_t>=Et||_t===16&&(Et&4194240)!==0))return st;if(gt&4&&(gt|=mt&16),st=nt.entangledLanes,st!==0)for(nt=nt.entanglements,st&=gt;0<st;)mt=31-oc$1(st),_t=1<<mt,gt|=nt[mt],st&=~_t;return gt}function vc$1(nt,st){switch(nt){case 1:case 2:case 4:return st+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return st+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc$1(nt,st){for(var mt=nt.suspendedLanes,gt=nt.pingedLanes,_t=nt.expirationTimes,Et=nt.pendingLanes;0<Et;){var At=31-oc$1(Et),Rt=1<<At,Ft=_t[At];Ft===-1?(!(Rt&mt)||Rt&gt)&&(_t[At]=vc$1(Rt,st)):Ft<=st&&(nt.expiredLanes|=Rt),Et&=~Rt}}function xc$1(nt){return nt=nt.pendingLanes&-1073741825,nt!==0?nt:nt&1073741824?1073741824:0}function yc$1(){var nt=rc$1;return rc$1<<=1,!(rc$1&4194240)&&(rc$1=64),nt}function zc$1(nt){for(var st=[],mt=0;31>mt;mt++)st.push(nt);return st}function Ac$1(nt,st,mt){nt.pendingLanes|=st,st!==536870912&&(nt.suspendedLanes=0,nt.pingedLanes=0),nt=nt.eventTimes,st=31-oc$1(st),nt[st]=mt}function Bc$1(nt,st){var mt=nt.pendingLanes&~st;nt.pendingLanes=st,nt.suspendedLanes=0,nt.pingedLanes=0,nt.expiredLanes&=st,nt.mutableReadLanes&=st,nt.entangledLanes&=st,st=nt.entanglements;var gt=nt.eventTimes;for(nt=nt.expirationTimes;0<mt;){var _t=31-oc$1(mt),Et=1<<_t;st[_t]=0,gt[_t]=-1,nt[_t]=-1,mt&=~Et}}function Cc$1(nt,st){var mt=nt.entangledLanes|=st;for(nt=nt.entanglements;mt;){var gt=31-oc$1(mt),_t=1<<gt;_t&st|nt[gt]&st&&(nt[gt]|=st),mt&=~_t}}var C$6=0;function Dc$1(nt){return nt&=-nt,1<nt?4<nt?nt&268435455?16:536870912:4:1}var Ec$1,Fc$1,Gc$1,Hc,Ic$1,Jc=!1,Kc$1=[],Lc$1=null,Mc$1=null,Nc$1=null,Oc$1=new Map,Pc$1=new Map,Qc$1=[],Rc$1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc$1(nt,st){switch(nt){case"focusin":case"focusout":Lc$1=null;break;case"dragenter":case"dragleave":Mc$1=null;break;case"mouseover":case"mouseout":Nc$1=null;break;case"pointerover":case"pointerout":Oc$1.delete(st.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc$1.delete(st.pointerId)}}function Tc$1(nt,st,mt,gt,_t,Et){return nt===null||nt.nativeEvent!==Et?(nt={blockedOn:st,domEventName:mt,eventSystemFlags:gt,nativeEvent:Et,targetContainers:[_t]},st!==null&&(st=Cb$1(st),st!==null&&Fc$1(st)),nt):(nt.eventSystemFlags|=gt,st=nt.targetContainers,_t!==null&&st.indexOf(_t)===-1&&st.push(_t),nt)}function Uc$1(nt,st,mt,gt,_t){switch(st){case"focusin":return Lc$1=Tc$1(Lc$1,nt,st,mt,gt,_t),!0;case"dragenter":return Mc$1=Tc$1(Mc$1,nt,st,mt,gt,_t),!0;case"mouseover":return Nc$1=Tc$1(Nc$1,nt,st,mt,gt,_t),!0;case"pointerover":var Et=_t.pointerId;return Oc$1.set(Et,Tc$1(Oc$1.get(Et)||null,nt,st,mt,gt,_t)),!0;case"gotpointercapture":return Et=_t.pointerId,Pc$1.set(Et,Tc$1(Pc$1.get(Et)||null,nt,st,mt,gt,_t)),!0}return!1}function Vc$1(nt){var st=Wc$1(nt.target);if(st!==null){var mt=Vb$1(st);if(mt!==null){if(st=mt.tag,st===13){if(st=Wb$1(mt),st!==null){nt.blockedOn=st,Ic$1(nt.priority,function(){Gc$1(mt)});return}}else if(st===3&&mt.stateNode.current.memoizedState.isDehydrated){nt.blockedOn=mt.tag===3?mt.stateNode.containerInfo:null;return}}}nt.blockedOn=null}function Xc$1(nt){if(nt.blockedOn!==null)return!1;for(var st=nt.targetContainers;0<st.length;){var mt=Yc$1(nt.domEventName,nt.eventSystemFlags,st[0],nt.nativeEvent);if(mt===null){mt=nt.nativeEvent;var gt=new mt.constructor(mt.type,mt);wb$1=gt,mt.target.dispatchEvent(gt),wb$1=null}else return st=Cb$1(mt),st!==null&&Fc$1(st),nt.blockedOn=mt,!1;st.shift()}return!0}function Zc$1(nt,st,mt){Xc$1(nt)&&mt.delete(st)}function $c(){Jc=!1,Lc$1!==null&&Xc$1(Lc$1)&&(Lc$1=null),Mc$1!==null&&Xc$1(Mc$1)&&(Mc$1=null),Nc$1!==null&&Xc$1(Nc$1)&&(Nc$1=null),Oc$1.forEach(Zc$1),Pc$1.forEach(Zc$1)}function ad$1(nt,st){nt.blockedOn===st&&(nt.blockedOn=null,Jc||(Jc=!0,ca$1.unstable_scheduleCallback(ca$1.unstable_NormalPriority,$c)))}function bd$1(nt){function st(_t){return ad$1(_t,nt)}if(0<Kc$1.length){ad$1(Kc$1[0],nt);for(var mt=1;mt<Kc$1.length;mt++){var gt=Kc$1[mt];gt.blockedOn===nt&&(gt.blockedOn=null)}}for(Lc$1!==null&&ad$1(Lc$1,nt),Mc$1!==null&&ad$1(Mc$1,nt),Nc$1!==null&&ad$1(Nc$1,nt),Oc$1.forEach(st),Pc$1.forEach(st),mt=0;mt<Qc$1.length;mt++)gt=Qc$1[mt],gt.blockedOn===nt&&(gt.blockedOn=null);for(;0<Qc$1.length&&(mt=Qc$1[0],mt.blockedOn===null);)Vc$1(mt),mt.blockedOn===null&&Qc$1.shift()}var cd$1=ua$1.ReactCurrentBatchConfig,dd$1=!0;function ed$1(nt,st,mt,gt){var _t=C$6,Et=cd$1.transition;cd$1.transition=null;try{C$6=1,fd$1(nt,st,mt,gt)}finally{C$6=_t,cd$1.transition=Et}}function gd$1(nt,st,mt,gt){var _t=C$6,Et=cd$1.transition;cd$1.transition=null;try{C$6=4,fd$1(nt,st,mt,gt)}finally{C$6=_t,cd$1.transition=Et}}function fd$1(nt,st,mt,gt){if(dd$1){var _t=Yc$1(nt,st,mt,gt);if(_t===null)hd$1(nt,st,gt,id$1,mt),Sc$1(nt,gt);else if(Uc$1(_t,nt,st,mt,gt))gt.stopPropagation();else if(Sc$1(nt,gt),st&4&&-1<Rc$1.indexOf(nt)){for(;_t!==null;){var Et=Cb$1(_t);if(Et!==null&&Ec$1(Et),Et=Yc$1(nt,st,mt,gt),Et===null&&hd$1(nt,st,gt,id$1,mt),Et===_t)break;_t=Et}_t!==null&&gt.stopPropagation()}else hd$1(nt,st,gt,null,mt)}}var id$1=null;function Yc$1(nt,st,mt,gt){if(id$1=null,nt=xb$1(gt),nt=Wc$1(nt),nt!==null)if(st=Vb$1(nt),st===null)nt=null;else if(mt=st.tag,mt===13){if(nt=Wb$1(st),nt!==null)return nt;nt=null}else if(mt===3){if(st.stateNode.current.memoizedState.isDehydrated)return st.tag===3?st.stateNode.containerInfo:null;nt=null}else st!==nt&&(nt=null);return id$1=nt,null}function jd$1(nt){switch(nt){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec$1()){case fc$1:return 1;case gc$1:return 4;case hc$1:case ic$1:return 16;case jc$1:return 536870912;default:return 16}default:return 16}}var kd$1=null,ld$1=null,md$1=null;function nd$1(){if(md$1)return md$1;var nt,st=ld$1,mt=st.length,gt,_t="value"in kd$1?kd$1.value:kd$1.textContent,Et=_t.length;for(nt=0;nt<mt&&st[nt]===_t[nt];nt++);var At=mt-nt;for(gt=1;gt<=At&&st[mt-gt]===_t[Et-gt];gt++);return md$1=_t.slice(nt,1<gt?1-gt:void 0)}function od$1(nt){var st=nt.keyCode;return"charCode"in nt?(nt=nt.charCode,nt===0&&st===13&&(nt=13)):nt=st,nt===10&&(nt=13),32<=nt||nt===13?nt:0}function pd$1(){return!0}function qd$1(){return!1}function rd$1(nt){function st(mt,gt,_t,Et,At){this._reactName=mt,this._targetInst=_t,this.type=gt,this.nativeEvent=Et,this.target=At,this.currentTarget=null;for(var Rt in nt)nt.hasOwnProperty(Rt)&&(mt=nt[Rt],this[Rt]=mt?mt(Et):Et[Rt]);return this.isDefaultPrevented=(Et.defaultPrevented!=null?Et.defaultPrevented:Et.returnValue===!1)?pd$1:qd$1,this.isPropagationStopped=qd$1,this}return A$1(st.prototype,{preventDefault:function(){this.defaultPrevented=!0;var mt=this.nativeEvent;mt&&(mt.preventDefault?mt.preventDefault():typeof mt.returnValue!="unknown"&&(mt.returnValue=!1),this.isDefaultPrevented=pd$1)},stopPropagation:function(){var mt=this.nativeEvent;mt&&(mt.stopPropagation?mt.stopPropagation():typeof mt.cancelBubble!="unknown"&&(mt.cancelBubble=!0),this.isPropagationStopped=pd$1)},persist:function(){},isPersistent:pd$1}),st}var sd$1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(nt){return nt.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$1=rd$1(sd$1),ud$1=A$1({},sd$1,{view:0,detail:0}),vd$1=rd$1(ud$1),wd$1,xd$1,yd$1,Ad$1=A$1({},ud$1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd$1,button:0,buttons:0,relatedTarget:function(nt){return nt.relatedTarget===void 0?nt.fromElement===nt.srcElement?nt.toElement:nt.fromElement:nt.relatedTarget},movementX:function(nt){return"movementX"in nt?nt.movementX:(nt!==yd$1&&(yd$1&&nt.type==="mousemove"?(wd$1=nt.screenX-yd$1.screenX,xd$1=nt.screenY-yd$1.screenY):xd$1=wd$1=0,yd$1=nt),wd$1)},movementY:function(nt){return"movementY"in nt?nt.movementY:xd$1}}),Bd$1=rd$1(Ad$1),Cd$1=A$1({},Ad$1,{dataTransfer:0}),Dd$1=rd$1(Cd$1),Ed$1=A$1({},ud$1,{relatedTarget:0}),Fd$1=rd$1(Ed$1),Gd$1=A$1({},sd$1,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd$1=rd$1(Gd$1),Id$1=A$1({},sd$1,{clipboardData:function(nt){return"clipboardData"in nt?nt.clipboardData:window.clipboardData}}),Jd$1=rd$1(Id$1),Kd$1=A$1({},sd$1,{data:0}),Ld$1=rd$1(Kd$1),Md$1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd$1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od$1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd$1(nt){var st=this.nativeEvent;return st.getModifierState?st.getModifierState(nt):(nt=Od$1[nt])?!!st[nt]:!1}function zd$1(){return Pd$1}var Qd$1=A$1({},ud$1,{key:function(nt){if(nt.key){var st=Md$1[nt.key]||nt.key;if(st!=="Unidentified")return st}return nt.type==="keypress"?(nt=od$1(nt),nt===13?"Enter":String.fromCharCode(nt)):nt.type==="keydown"||nt.type==="keyup"?Nd$1[nt.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd$1,charCode:function(nt){return nt.type==="keypress"?od$1(nt):0},keyCode:function(nt){return nt.type==="keydown"||nt.type==="keyup"?nt.keyCode:0},which:function(nt){return nt.type==="keypress"?od$1(nt):nt.type==="keydown"||nt.type==="keyup"?nt.keyCode:0}}),Rd$1=rd$1(Qd$1),Sd$1=A$1({},Ad$1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td$1=rd$1(Sd$1),Ud$1=A$1({},ud$1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd$1}),Vd$1=rd$1(Ud$1),Wd$1=A$1({},sd$1,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd$1=rd$1(Wd$1),Yd$1=A$1({},Ad$1,{deltaX:function(nt){return"deltaX"in nt?nt.deltaX:"wheelDeltaX"in nt?-nt.wheelDeltaX:0},deltaY:function(nt){return"deltaY"in nt?nt.deltaY:"wheelDeltaY"in nt?-nt.wheelDeltaY:"wheelDelta"in nt?-nt.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd$1=rd$1(Yd$1),$d$1=[9,13,27,32],ae$1=ia$1&&"CompositionEvent"in window,be$1=null;ia$1&&"documentMode"in document&&(be$1=document.documentMode);var ce$1=ia$1&&"TextEvent"in window&&!be$1,de=ia$1&&(!ae$1||be$1&&8<be$1&&11>=be$1),ee$1=" ",fe$2=!1;function ge$1(nt,st){switch(nt){case"keyup":return $d$1.indexOf(st.keyCode)!==-1;case"keydown":return st.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$2(nt){return nt=nt.detail,typeof nt=="object"&&"data"in nt?nt.data:null}var ie$1=!1;function je$1(nt,st){switch(nt){case"compositionend":return he$2(st);case"keypress":return st.which!==32?null:(fe$2=!0,ee$1);case"textInput":return nt=st.data,nt===ee$1&&fe$2?null:nt;default:return null}}function ke$1(nt,st){if(ie$1)return nt==="compositionend"||!ae$1&&ge$1(nt,st)?(nt=nd$1(),md$1=ld$1=kd$1=null,ie$1=!1,nt):null;switch(nt){case"paste":return null;case"keypress":if(!(st.ctrlKey||st.altKey||st.metaKey)||st.ctrlKey&&st.altKey){if(st.char&&1<st.char.length)return st.char;if(st.which)return String.fromCharCode(st.which)}return null;case"compositionend":return de&&st.locale!=="ko"?null:st.data;default:return null}}var le$2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(nt){var st=nt&&nt.nodeName&&nt.nodeName.toLowerCase();return st==="input"?!!le$2[nt.type]:st==="textarea"}function ne$2(nt,st,mt,gt){Eb$1(gt),st=oe$1(st,"onChange"),0<st.length&&(mt=new td$1("onChange","change",null,mt,gt),nt.push({event:mt,listeners:st}))}var pe=null,qe$2=null;function re$1(nt){se$1(nt,0)}function te$1(nt){var st=ue$2(nt);if(Wa$1(st))return nt}function ve$1(nt,st){if(nt==="change")return st}var we$2=!1;if(ia$1){var xe$1;if(ia$1){var ye$1="oninput"in document;if(!ye$1){var ze$1=document.createElement("div");ze$1.setAttribute("oninput","return;"),ye$1=typeof ze$1.oninput=="function"}xe$1=ye$1}else xe$1=!1;we$2=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae$1(){pe&&(pe.detachEvent("onpropertychange",Be),qe$2=pe=null)}function Be(nt){if(nt.propertyName==="value"&&te$1(qe$2)){var st=[];ne$2(st,qe$2,nt,xb$1(nt)),Jb(re$1,st)}}function Ce$1(nt,st,mt){nt==="focusin"?(Ae$1(),pe=st,qe$2=mt,pe.attachEvent("onpropertychange",Be)):nt==="focusout"&&Ae$1()}function De$2(nt){if(nt==="selectionchange"||nt==="keyup"||nt==="keydown")return te$1(qe$2)}function Ee$2(nt,st){if(nt==="click")return te$1(st)}function Fe$2(nt,st){if(nt==="input"||nt==="change")return te$1(st)}function Ge$1(nt,st){return nt===st&&(nt!==0||1/nt===1/st)||nt!==nt&&st!==st}var He$1=typeof Object.is=="function"?Object.is:Ge$1;function Ie$1(nt,st){if(He$1(nt,st))return!0;if(typeof nt!="object"||nt===null||typeof st!="object"||st===null)return!1;var mt=Object.keys(nt),gt=Object.keys(st);if(mt.length!==gt.length)return!1;for(gt=0;gt<mt.length;gt++){var _t=mt[gt];if(!ja$1.call(st,_t)||!He$1(nt[_t],st[_t]))return!1}return!0}function Je$2(nt){for(;nt&&nt.firstChild;)nt=nt.firstChild;return nt}function Ke$2(nt,st){var mt=Je$2(nt);nt=0;for(var gt;mt;){if(mt.nodeType===3){if(gt=nt+mt.textContent.length,nt<=st&&gt>=st)return{node:mt,offset:st-nt};nt=gt}e:{for(;mt;){if(mt.nextSibling){mt=mt.nextSibling;break e}mt=mt.parentNode}mt=void 0}mt=Je$2(mt)}}function Le(nt,st){return nt&&st?nt===st?!0:nt&&nt.nodeType===3?!1:st&&st.nodeType===3?Le(nt,st.parentNode):"contains"in nt?nt.contains(st):nt.compareDocumentPosition?!!(nt.compareDocumentPosition(st)&16):!1:!1}function Me$2(){for(var nt=window,st=Xa$1();st instanceof nt.HTMLIFrameElement;){try{var mt=typeof st.contentWindow.location.href=="string"}catch{mt=!1}if(mt)nt=st.contentWindow;else break;st=Xa$1(nt.document)}return st}function Ne$1(nt){var st=nt&&nt.nodeName&&nt.nodeName.toLowerCase();return st&&(st==="input"&&(nt.type==="text"||nt.type==="search"||nt.type==="tel"||nt.type==="url"||nt.type==="password")||st==="textarea"||nt.contentEditable==="true")}function Oe$1(nt){var st=Me$2(),mt=nt.focusedElem,gt=nt.selectionRange;if(st!==mt&&mt&&mt.ownerDocument&&Le(mt.ownerDocument.documentElement,mt)){if(gt!==null&&Ne$1(mt)){if(st=gt.start,nt=gt.end,nt===void 0&&(nt=st),"selectionStart"in mt)mt.selectionStart=st,mt.selectionEnd=Math.min(nt,mt.value.length);else if(nt=(st=mt.ownerDocument||document)&&st.defaultView||window,nt.getSelection){nt=nt.getSelection();var _t=mt.textContent.length,Et=Math.min(gt.start,_t);gt=gt.end===void 0?Et:Math.min(gt.end,_t),!nt.extend&&Et>gt&&(_t=gt,gt=Et,Et=_t),_t=Ke$2(mt,Et);var At=Ke$2(mt,gt);_t&&At&&(nt.rangeCount!==1||nt.anchorNode!==_t.node||nt.anchorOffset!==_t.offset||nt.focusNode!==At.node||nt.focusOffset!==At.offset)&&(st=st.createRange(),st.setStart(_t.node,_t.offset),nt.removeAllRanges(),Et>gt?(nt.addRange(st),nt.extend(At.node,At.offset)):(st.setEnd(At.node,At.offset),nt.addRange(st)))}}for(st=[],nt=mt;nt=nt.parentNode;)nt.nodeType===1&&st.push({element:nt,left:nt.scrollLeft,top:nt.scrollTop});for(typeof mt.focus=="function"&&mt.focus(),mt=0;mt<st.length;mt++)nt=st[mt],nt.element.scrollLeft=nt.left,nt.element.scrollTop=nt.top}}var Pe$1=ia$1&&"documentMode"in document&&11>=document.documentMode,Qe$2=null,Re$1=null,Se$2=null,Te$1=!1;function Ue$2(nt,st,mt){var gt=mt.window===mt?mt.document:mt.nodeType===9?mt:mt.ownerDocument;Te$1||Qe$2==null||Qe$2!==Xa$1(gt)||(gt=Qe$2,"selectionStart"in gt&&Ne$1(gt)?gt={start:gt.selectionStart,end:gt.selectionEnd}:(gt=(gt.ownerDocument&&gt.ownerDocument.defaultView||window).getSelection(),gt={anchorNode:gt.anchorNode,anchorOffset:gt.anchorOffset,focusNode:gt.focusNode,focusOffset:gt.focusOffset}),Se$2&&Ie$1(Se$2,gt)||(Se$2=gt,gt=oe$1(Re$1,"onSelect"),0<gt.length&&(st=new td$1("onSelect","select",null,st,mt),nt.push({event:st,listeners:gt}),st.target=Qe$2)))}function Ve$1(nt,st){var mt={};return mt[nt.toLowerCase()]=st.toLowerCase(),mt["Webkit"+nt]="webkit"+st,mt["Moz"+nt]="moz"+st,mt}var We$2={animationend:Ve$1("Animation","AnimationEnd"),animationiteration:Ve$1("Animation","AnimationIteration"),animationstart:Ve$1("Animation","AnimationStart"),transitionend:Ve$1("Transition","TransitionEnd")},Xe$2={},Ye={};ia$1&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We$2.animationend.animation,delete We$2.animationiteration.animation,delete We$2.animationstart.animation),"TransitionEvent"in window||delete We$2.transitionend.transition);function Ze$2(nt){if(Xe$2[nt])return Xe$2[nt];if(!We$2[nt])return nt;var st=We$2[nt],mt;for(mt in st)if(st.hasOwnProperty(mt)&&mt in Ye)return Xe$2[nt]=st[mt];return nt}var $e$2=Ze$2("animationend"),af$1=Ze$2("animationiteration"),bf$1=Ze$2("animationstart"),cf$1=Ze$2("transitionend"),df$1=new Map,ef$1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff$1(nt,st){df$1.set(nt,st),fa$1(st,[nt])}for(var gf$1=0;gf$1<ef$1.length;gf$1++){var hf$1=ef$1[gf$1],jf$1=hf$1.toLowerCase(),kf$1=hf$1[0].toUpperCase()+hf$1.slice(1);ff$1(jf$1,"on"+kf$1)}ff$1($e$2,"onAnimationEnd");ff$1(af$1,"onAnimationIteration");ff$1(bf$1,"onAnimationStart");ff$1("dblclick","onDoubleClick");ff$1("focusin","onFocus");ff$1("focusout","onBlur");ff$1(cf$1,"onTransitionEnd");ha$1("onMouseEnter",["mouseout","mouseover"]);ha$1("onMouseLeave",["mouseout","mouseover"]);ha$1("onPointerEnter",["pointerout","pointerover"]);ha$1("onPointerLeave",["pointerout","pointerover"]);fa$1("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa$1("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa$1("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa$1("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa$1("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa$1("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf$1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf$1=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf$1));function nf$1(nt,st,mt){var gt=nt.type||"unknown-event";nt.currentTarget=mt,Ub$1(gt,st,void 0,nt),nt.currentTarget=null}function se$1(nt,st){st=(st&4)!==0;for(var mt=0;mt<nt.length;mt++){var gt=nt[mt],_t=gt.event;gt=gt.listeners;e:{var Et=void 0;if(st)for(var At=gt.length-1;0<=At;At--){var Rt=gt[At],Ft=Rt.instance,Nt=Rt.currentTarget;if(Rt=Rt.listener,Ft!==Et&&_t.isPropagationStopped())break e;nf$1(_t,Rt,Nt),Et=Ft}else for(At=0;At<gt.length;At++){if(Rt=gt[At],Ft=Rt.instance,Nt=Rt.currentTarget,Rt=Rt.listener,Ft!==Et&&_t.isPropagationStopped())break e;nf$1(_t,Rt,Nt),Et=Ft}}}if(Qb$1)throw nt=Rb$1,Qb$1=!1,Rb$1=null,nt}function D$2(nt,st){var mt=st[of$1];mt===void 0&&(mt=st[of$1]=new Set);var gt=nt+"__bubble";mt.has(gt)||(pf$1(st,nt,2,!1),mt.add(gt))}function qf$1(nt,st,mt){var gt=0;st&&(gt|=4),pf$1(mt,nt,gt,st)}var rf$1="_reactListening"+Math.random().toString(36).slice(2);function sf$1(nt){if(!nt[rf$1]){nt[rf$1]=!0,da$1.forEach(function(mt){mt!=="selectionchange"&&(mf$1.has(mt)||qf$1(mt,!1,nt),qf$1(mt,!0,nt))});var st=nt.nodeType===9?nt:nt.ownerDocument;st===null||st[rf$1]||(st[rf$1]=!0,qf$1("selectionchange",!1,st))}}function pf$1(nt,st,mt,gt){switch(jd$1(st)){case 1:var _t=ed$1;break;case 4:_t=gd$1;break;default:_t=fd$1}mt=_t.bind(null,st,mt,nt),_t=void 0,!Lb$1||st!=="touchstart"&&st!=="touchmove"&&st!=="wheel"||(_t=!0),gt?_t!==void 0?nt.addEventListener(st,mt,{capture:!0,passive:_t}):nt.addEventListener(st,mt,!0):_t!==void 0?nt.addEventListener(st,mt,{passive:_t}):nt.addEventListener(st,mt,!1)}function hd$1(nt,st,mt,gt,_t){var Et=gt;if(!(st&1)&&!(st&2)&&gt!==null)e:for(;;){if(gt===null)return;var At=gt.tag;if(At===3||At===4){var Rt=gt.stateNode.containerInfo;if(Rt===_t||Rt.nodeType===8&&Rt.parentNode===_t)break;if(At===4)for(At=gt.return;At!==null;){var Ft=At.tag;if((Ft===3||Ft===4)&&(Ft=At.stateNode.containerInfo,Ft===_t||Ft.nodeType===8&&Ft.parentNode===_t))return;At=At.return}for(;Rt!==null;){if(At=Wc$1(Rt),At===null)return;if(Ft=At.tag,Ft===5||Ft===6){gt=Et=At;continue e}Rt=Rt.parentNode}}gt=gt.return}Jb(function(){var Nt=Et,Bt=xb$1(mt),Gt=[];e:{var dr=df$1.get(nt);if(dr!==void 0){var Mr=td$1,Tr=nt;switch(nt){case"keypress":if(od$1(mt)===0)break e;case"keydown":case"keyup":Mr=Rd$1;break;case"focusin":Tr="focus",Mr=Fd$1;break;case"focusout":Tr="blur",Mr=Fd$1;break;case"beforeblur":case"afterblur":Mr=Fd$1;break;case"click":if(mt.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Mr=Bd$1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Mr=Dd$1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Mr=Vd$1;break;case $e$2:case af$1:case bf$1:Mr=Hd$1;break;case cf$1:Mr=Xd$1;break;case"scroll":Mr=vd$1;break;case"wheel":Mr=Zd$1;break;case"copy":case"cut":case"paste":Mr=Jd$1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Mr=Td$1}var zr=(st&4)!==0,Fr=!zr&&nt==="scroll",Nr=zr?dr!==null?dr+"Capture":null:dr;zr=[];for(var tn=Nt,rn;tn!==null;){rn=tn;var Tn=rn.stateNode;if(rn.tag===5&&Tn!==null&&(rn=Tn,Nr!==null&&(Tn=Kb$1(tn,Nr),Tn!=null&&zr.push(tf$1(tn,Tn,rn)))),Fr)break;tn=tn.return}0<zr.length&&(dr=new Mr(dr,Tr,null,mt,Bt),Gt.push({event:dr,listeners:zr}))}}if(!(st&7)){e:{if(dr=nt==="mouseover"||nt==="pointerover",Mr=nt==="mouseout"||nt==="pointerout",dr&&mt!==wb$1&&(Tr=mt.relatedTarget||mt.fromElement)&&(Wc$1(Tr)||Tr[uf$1]))break e;if((Mr||dr)&&(dr=Bt.window===Bt?Bt:(dr=Bt.ownerDocument)?dr.defaultView||dr.parentWindow:window,Mr?(Tr=mt.relatedTarget||mt.toElement,Mr=Nt,Tr=Tr?Wc$1(Tr):null,Tr!==null&&(Fr=Vb$1(Tr),Tr!==Fr||Tr.tag!==5&&Tr.tag!==6)&&(Tr=null)):(Mr=null,Tr=Nt),Mr!==Tr)){if(zr=Bd$1,Tn="onMouseLeave",Nr="onMouseEnter",tn="mouse",(nt==="pointerout"||nt==="pointerover")&&(zr=Td$1,Tn="onPointerLeave",Nr="onPointerEnter",tn="pointer"),Fr=Mr==null?dr:ue$2(Mr),rn=Tr==null?dr:ue$2(Tr),dr=new zr(Tn,tn+"leave",Mr,mt,Bt),dr.target=Fr,dr.relatedTarget=rn,Tn=null,Wc$1(Bt)===Nt&&(zr=new zr(Nr,tn+"enter",Tr,mt,Bt),zr.target=rn,zr.relatedTarget=Fr,Tn=zr),Fr=Tn,Mr&&Tr)t:{for(zr=Mr,Nr=Tr,tn=0,rn=zr;rn;rn=vf$1(rn))tn++;for(rn=0,Tn=Nr;Tn;Tn=vf$1(Tn))rn++;for(;0<tn-rn;)zr=vf$1(zr),tn--;for(;0<rn-tn;)Nr=vf$1(Nr),rn--;for(;tn--;){if(zr===Nr||Nr!==null&&zr===Nr.alternate)break t;zr=vf$1(zr),Nr=vf$1(Nr)}zr=null}else zr=null;Mr!==null&&wf$1(Gt,dr,Mr,zr,!1),Tr!==null&&Fr!==null&&wf$1(Gt,Fr,Tr,zr,!0)}}e:{if(dr=Nt?ue$2(Nt):window,Mr=dr.nodeName&&dr.nodeName.toLowerCase(),Mr==="select"||Mr==="input"&&dr.type==="file")var $n=ve$1;else if(me(dr))if(we$2)$n=Fe$2;else{$n=De$2;var un=Ce$1}else(Mr=dr.nodeName)&&Mr.toLowerCase()==="input"&&(dr.type==="checkbox"||dr.type==="radio")&&($n=Ee$2);if($n&&($n=$n(nt,Nt))){ne$2(Gt,$n,mt,Bt);break e}un&&un(nt,dr,Nt),nt==="focusout"&&(un=dr._wrapperState)&&un.controlled&&dr.type==="number"&&cb$1(dr,"number",dr.value)}switch(un=Nt?ue$2(Nt):window,nt){case"focusin":(me(un)||un.contentEditable==="true")&&(Qe$2=un,Re$1=Nt,Se$2=null);break;case"focusout":Se$2=Re$1=Qe$2=null;break;case"mousedown":Te$1=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$1=!1,Ue$2(Gt,mt,Bt);break;case"selectionchange":if(Pe$1)break;case"keydown":case"keyup":Ue$2(Gt,mt,Bt)}var es;if(ae$1)e:{switch(nt){case"compositionstart":var kn="onCompositionStart";break e;case"compositionend":kn="onCompositionEnd";break e;case"compositionupdate":kn="onCompositionUpdate";break e}kn=void 0}else ie$1?ge$1(nt,mt)&&(kn="onCompositionEnd"):nt==="keydown"&&mt.keyCode===229&&(kn="onCompositionStart");kn&&(de&&mt.locale!=="ko"&&(ie$1||kn!=="onCompositionStart"?kn==="onCompositionEnd"&&ie$1&&(es=nd$1()):(kd$1=Bt,ld$1="value"in kd$1?kd$1.value:kd$1.textContent,ie$1=!0)),un=oe$1(Nt,kn),0<un.length&&(kn=new Ld$1(kn,nt,null,mt,Bt),Gt.push({event:kn,listeners:un}),es?kn.data=es:(es=he$2(mt),es!==null&&(kn.data=es)))),(es=ce$1?je$1(nt,mt):ke$1(nt,mt))&&(Nt=oe$1(Nt,"onBeforeInput"),0<Nt.length&&(Bt=new Ld$1("onBeforeInput","beforeinput",null,mt,Bt),Gt.push({event:Bt,listeners:Nt}),Bt.data=es))}se$1(Gt,st)})}function tf$1(nt,st,mt){return{instance:nt,listener:st,currentTarget:mt}}function oe$1(nt,st){for(var mt=st+"Capture",gt=[];nt!==null;){var _t=nt,Et=_t.stateNode;_t.tag===5&&Et!==null&&(_t=Et,Et=Kb$1(nt,mt),Et!=null&&gt.unshift(tf$1(nt,Et,_t)),Et=Kb$1(nt,st),Et!=null&&gt.push(tf$1(nt,Et,_t))),nt=nt.return}return gt}function vf$1(nt){if(nt===null)return null;do nt=nt.return;while(nt&&nt.tag!==5);return nt||null}function wf$1(nt,st,mt,gt,_t){for(var Et=st._reactName,At=[];mt!==null&&mt!==gt;){var Rt=mt,Ft=Rt.alternate,Nt=Rt.stateNode;if(Ft!==null&&Ft===gt)break;Rt.tag===5&&Nt!==null&&(Rt=Nt,_t?(Ft=Kb$1(mt,Et),Ft!=null&&At.unshift(tf$1(mt,Ft,Rt))):_t||(Ft=Kb$1(mt,Et),Ft!=null&&At.push(tf$1(mt,Ft,Rt)))),mt=mt.return}At.length!==0&&nt.push({event:st,listeners:At})}var xf$1=/\r\n?/g,yf$1=/\u0000|\uFFFD/g;function zf$1(nt){return(typeof nt=="string"?nt:""+nt).replace(xf$1,`
`).replace(yf$1,"")}function Af$1(nt,st,mt){if(st=zf$1(st),zf$1(nt)!==st&&mt)throw Error(p$8(425))}function Bf$1(){}var Cf$1=null,Df$1=null;function Ef$1(nt,st){return nt==="textarea"||nt==="noscript"||typeof st.children=="string"||typeof st.children=="number"||typeof st.dangerouslySetInnerHTML=="object"&&st.dangerouslySetInnerHTML!==null&&st.dangerouslySetInnerHTML.__html!=null}var Ff$1=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf$1=typeof Promise=="function"?Promise:void 0,Jf$1=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf$1<"u"?function(nt){return Hf$1.resolve(null).then(nt).catch(If$1)}:Ff$1;function If$1(nt){setTimeout(function(){throw nt})}function Kf$1(nt,st){var mt=st,gt=0;do{var _t=mt.nextSibling;if(nt.removeChild(mt),_t&&_t.nodeType===8)if(mt=_t.data,mt==="/$"){if(gt===0){nt.removeChild(_t),bd$1(st);return}gt--}else mt!=="$"&&mt!=="$?"&&mt!=="$!"||gt++;mt=_t}while(mt);bd$1(st)}function Lf$1(nt){for(;nt!=null;nt=nt.nextSibling){var st=nt.nodeType;if(st===1||st===3)break;if(st===8){if(st=nt.data,st==="$"||st==="$!"||st==="$?")break;if(st==="/$")return null}}return nt}function Mf$1(nt){nt=nt.previousSibling;for(var st=0;nt;){if(nt.nodeType===8){var mt=nt.data;if(mt==="$"||mt==="$!"||mt==="$?"){if(st===0)return nt;st--}else mt==="/$"&&st++}nt=nt.previousSibling}return null}var Nf$1=Math.random().toString(36).slice(2),Of$1="__reactFiber$"+Nf$1,Pf$1="__reactProps$"+Nf$1,uf$1="__reactContainer$"+Nf$1,of$1="__reactEvents$"+Nf$1,Qf$1="__reactListeners$"+Nf$1,Rf$1="__reactHandles$"+Nf$1;function Wc$1(nt){var st=nt[Of$1];if(st)return st;for(var mt=nt.parentNode;mt;){if(st=mt[uf$1]||mt[Of$1]){if(mt=st.alternate,st.child!==null||mt!==null&&mt.child!==null)for(nt=Mf$1(nt);nt!==null;){if(mt=nt[Of$1])return mt;nt=Mf$1(nt)}return st}nt=mt,mt=nt.parentNode}return null}function Cb$1(nt){return nt=nt[Of$1]||nt[uf$1],!nt||nt.tag!==5&&nt.tag!==6&&nt.tag!==13&&nt.tag!==3?null:nt}function ue$2(nt){if(nt.tag===5||nt.tag===6)return nt.stateNode;throw Error(p$8(33))}function Db$1(nt){return nt[Pf$1]||null}var Sf$1=[],Tf$1=-1;function Uf$1(nt){return{current:nt}}function E$7(nt){0>Tf$1||(nt.current=Sf$1[Tf$1],Sf$1[Tf$1]=null,Tf$1--)}function G$1(nt,st){Tf$1++,Sf$1[Tf$1]=nt.current,nt.current=st}var Vf$1={},H$1=Uf$1(Vf$1),Wf$1=Uf$1(!1),Xf$1=Vf$1;function Yf$1(nt,st){var mt=nt.type.contextTypes;if(!mt)return Vf$1;var gt=nt.stateNode;if(gt&&gt.__reactInternalMemoizedUnmaskedChildContext===st)return gt.__reactInternalMemoizedMaskedChildContext;var _t={},Et;for(Et in mt)_t[Et]=st[Et];return gt&&(nt=nt.stateNode,nt.__reactInternalMemoizedUnmaskedChildContext=st,nt.__reactInternalMemoizedMaskedChildContext=_t),_t}function Zf$1(nt){return nt=nt.childContextTypes,nt!=null}function $f$1(){E$7(Wf$1),E$7(H$1)}function ag$1(nt,st,mt){if(H$1.current!==Vf$1)throw Error(p$8(168));G$1(H$1,st),G$1(Wf$1,mt)}function bg$1(nt,st,mt){var gt=nt.stateNode;if(st=st.childContextTypes,typeof gt.getChildContext!="function")return mt;gt=gt.getChildContext();for(var _t in gt)if(!(_t in st))throw Error(p$8(108,Ra$1(nt)||"Unknown",_t));return A$1({},mt,gt)}function cg$1(nt){return nt=(nt=nt.stateNode)&&nt.__reactInternalMemoizedMergedChildContext||Vf$1,Xf$1=H$1.current,G$1(H$1,nt),G$1(Wf$1,Wf$1.current),!0}function dg$1(nt,st,mt){var gt=nt.stateNode;if(!gt)throw Error(p$8(169));mt?(nt=bg$1(nt,st,Xf$1),gt.__reactInternalMemoizedMergedChildContext=nt,E$7(Wf$1),E$7(H$1),G$1(H$1,nt)):E$7(Wf$1),G$1(Wf$1,mt)}var eg$1=null,fg$1=!1,gg=!1;function hg$1(nt){eg$1===null?eg$1=[nt]:eg$1.push(nt)}function ig$1(nt){fg$1=!0,hg$1(nt)}function jg$1(){if(!gg&&eg$1!==null){gg=!0;var nt=0,st=C$6;try{var mt=eg$1;for(C$6=1;nt<mt.length;nt++){var gt=mt[nt];do gt=gt(!0);while(gt!==null)}eg$1=null,fg$1=!1}catch(_t){throw eg$1!==null&&(eg$1=eg$1.slice(nt+1)),ac$1(fc$1,jg$1),_t}finally{C$6=st,gg=!1}}return null}var kg$1=[],lg$1=0,mg$1=null,ng$1=0,og$1=[],pg$1=0,qg$1=null,rg$1=1,sg$1="";function tg$1(nt,st){kg$1[lg$1++]=ng$1,kg$1[lg$1++]=mg$1,mg$1=nt,ng$1=st}function ug$1(nt,st,mt){og$1[pg$1++]=rg$1,og$1[pg$1++]=sg$1,og$1[pg$1++]=qg$1,qg$1=nt;var gt=rg$1;nt=sg$1;var _t=32-oc$1(gt)-1;gt&=~(1<<_t),mt+=1;var Et=32-oc$1(st)+_t;if(30<Et){var At=_t-_t%5;Et=(gt&(1<<At)-1).toString(32),gt>>=At,_t-=At,rg$1=1<<32-oc$1(st)+_t|mt<<_t|gt,sg$1=Et+nt}else rg$1=1<<Et|mt<<_t|gt,sg$1=nt}function vg$1(nt){nt.return!==null&&(tg$1(nt,1),ug$1(nt,1,0))}function wg$1(nt){for(;nt===mg$1;)mg$1=kg$1[--lg$1],kg$1[lg$1]=null,ng$1=kg$1[--lg$1],kg$1[lg$1]=null;for(;nt===qg$1;)qg$1=og$1[--pg$1],og$1[pg$1]=null,sg$1=og$1[--pg$1],og$1[pg$1]=null,rg$1=og$1[--pg$1],og$1[pg$1]=null}var xg$1=null,yg=null,I$5=!1,zg$1=null;function Ag$1(nt,st){var mt=Bg$1(5,null,null,0);mt.elementType="DELETED",mt.stateNode=st,mt.return=nt,st=nt.deletions,st===null?(nt.deletions=[mt],nt.flags|=16):st.push(mt)}function Cg$1(nt,st){switch(nt.tag){case 5:var mt=nt.type;return st=st.nodeType!==1||mt.toLowerCase()!==st.nodeName.toLowerCase()?null:st,st!==null?(nt.stateNode=st,xg$1=nt,yg=Lf$1(st.firstChild),!0):!1;case 6:return st=nt.pendingProps===""||st.nodeType!==3?null:st,st!==null?(nt.stateNode=st,xg$1=nt,yg=null,!0):!1;case 13:return st=st.nodeType!==8?null:st,st!==null?(mt=qg$1!==null?{id:rg$1,overflow:sg$1}:null,nt.memoizedState={dehydrated:st,treeContext:mt,retryLane:1073741824},mt=Bg$1(18,null,null,0),mt.stateNode=st,mt.return=nt,nt.child=mt,xg$1=nt,yg=null,!0):!1;default:return!1}}function Dg$1(nt){return(nt.mode&1)!==0&&(nt.flags&128)===0}function Eg$1(nt){if(I$5){var st=yg;if(st){var mt=st;if(!Cg$1(nt,st)){if(Dg$1(nt))throw Error(p$8(418));st=Lf$1(mt.nextSibling);var gt=xg$1;st&&Cg$1(nt,st)?Ag$1(gt,mt):(nt.flags=nt.flags&-4097|2,I$5=!1,xg$1=nt)}}else{if(Dg$1(nt))throw Error(p$8(418));nt.flags=nt.flags&-4097|2,I$5=!1,xg$1=nt}}}function Fg$1(nt){for(nt=nt.return;nt!==null&&nt.tag!==5&&nt.tag!==3&&nt.tag!==13;)nt=nt.return;xg$1=nt}function Gg$1(nt){if(nt!==xg$1)return!1;if(!I$5)return Fg$1(nt),I$5=!0,!1;var st;if((st=nt.tag!==3)&&!(st=nt.tag!==5)&&(st=nt.type,st=st!=="head"&&st!=="body"&&!Ef$1(nt.type,nt.memoizedProps)),st&&(st=yg)){if(Dg$1(nt))throw Hg$1(),Error(p$8(418));for(;st;)Ag$1(nt,st),st=Lf$1(st.nextSibling)}if(Fg$1(nt),nt.tag===13){if(nt=nt.memoizedState,nt=nt!==null?nt.dehydrated:null,!nt)throw Error(p$8(317));e:{for(nt=nt.nextSibling,st=0;nt;){if(nt.nodeType===8){var mt=nt.data;if(mt==="/$"){if(st===0){yg=Lf$1(nt.nextSibling);break e}st--}else mt!=="$"&&mt!=="$!"&&mt!=="$?"||st++}nt=nt.nextSibling}yg=null}}else yg=xg$1?Lf$1(nt.stateNode.nextSibling):null;return!0}function Hg$1(){for(var nt=yg;nt;)nt=Lf$1(nt.nextSibling)}function Ig$1(){yg=xg$1=null,I$5=!1}function Jg$1(nt){zg$1===null?zg$1=[nt]:zg$1.push(nt)}var Kg$1=ua$1.ReactCurrentBatchConfig;function Lg$1(nt,st,mt){if(nt=mt.ref,nt!==null&&typeof nt!="function"&&typeof nt!="object"){if(mt._owner){if(mt=mt._owner,mt){if(mt.tag!==1)throw Error(p$8(309));var gt=mt.stateNode}if(!gt)throw Error(p$8(147,nt));var _t=gt,Et=""+nt;return st!==null&&st.ref!==null&&typeof st.ref=="function"&&st.ref._stringRef===Et?st.ref:(st=function(At){var Rt=_t.refs;At===null?delete Rt[Et]:Rt[Et]=At},st._stringRef=Et,st)}if(typeof nt!="string")throw Error(p$8(284));if(!mt._owner)throw Error(p$8(290,nt))}return nt}function Mg$1(nt,st){throw nt=Object.prototype.toString.call(st),Error(p$8(31,nt==="[object Object]"?"object with keys {"+Object.keys(st).join(", ")+"}":nt))}function Ng$1(nt){var st=nt._init;return st(nt._payload)}function Og$1(nt){function st(Nr,tn){if(nt){var rn=Nr.deletions;rn===null?(Nr.deletions=[tn],Nr.flags|=16):rn.push(tn)}}function mt(Nr,tn){if(!nt)return null;for(;tn!==null;)st(Nr,tn),tn=tn.sibling;return null}function gt(Nr,tn){for(Nr=new Map;tn!==null;)tn.key!==null?Nr.set(tn.key,tn):Nr.set(tn.index,tn),tn=tn.sibling;return Nr}function _t(Nr,tn){return Nr=Pg$1(Nr,tn),Nr.index=0,Nr.sibling=null,Nr}function Et(Nr,tn,rn){return Nr.index=rn,nt?(rn=Nr.alternate,rn!==null?(rn=rn.index,rn<tn?(Nr.flags|=2,tn):rn):(Nr.flags|=2,tn)):(Nr.flags|=1048576,tn)}function At(Nr){return nt&&Nr.alternate===null&&(Nr.flags|=2),Nr}function Rt(Nr,tn,rn,Tn){return tn===null||tn.tag!==6?(tn=Qg$1(rn,Nr.mode,Tn),tn.return=Nr,tn):(tn=_t(tn,rn),tn.return=Nr,tn)}function Ft(Nr,tn,rn,Tn){var $n=rn.type;return $n===ya$1?Bt(Nr,tn,rn.props.children,Tn,rn.key):tn!==null&&(tn.elementType===$n||typeof $n=="object"&&$n!==null&&$n.$$typeof===Ha$1&&Ng$1($n)===tn.type)?(Tn=_t(tn,rn.props),Tn.ref=Lg$1(Nr,tn,rn),Tn.return=Nr,Tn):(Tn=Rg$1(rn.type,rn.key,rn.props,null,Nr.mode,Tn),Tn.ref=Lg$1(Nr,tn,rn),Tn.return=Nr,Tn)}function Nt(Nr,tn,rn,Tn){return tn===null||tn.tag!==4||tn.stateNode.containerInfo!==rn.containerInfo||tn.stateNode.implementation!==rn.implementation?(tn=Sg$1(rn,Nr.mode,Tn),tn.return=Nr,tn):(tn=_t(tn,rn.children||[]),tn.return=Nr,tn)}function Bt(Nr,tn,rn,Tn,$n){return tn===null||tn.tag!==7?(tn=Tg$1(rn,Nr.mode,Tn,$n),tn.return=Nr,tn):(tn=_t(tn,rn),tn.return=Nr,tn)}function Gt(Nr,tn,rn){if(typeof tn=="string"&&tn!==""||typeof tn=="number")return tn=Qg$1(""+tn,Nr.mode,rn),tn.return=Nr,tn;if(typeof tn=="object"&&tn!==null){switch(tn.$$typeof){case va$1:return rn=Rg$1(tn.type,tn.key,tn.props,null,Nr.mode,rn),rn.ref=Lg$1(Nr,null,tn),rn.return=Nr,rn;case wa$1:return tn=Sg$1(tn,Nr.mode,rn),tn.return=Nr,tn;case Ha$1:var Tn=tn._init;return Gt(Nr,Tn(tn._payload),rn)}if(eb$1(tn)||Ka$1(tn))return tn=Tg$1(tn,Nr.mode,rn,null),tn.return=Nr,tn;Mg$1(Nr,tn)}return null}function dr(Nr,tn,rn,Tn){var $n=tn!==null?tn.key:null;if(typeof rn=="string"&&rn!==""||typeof rn=="number")return $n!==null?null:Rt(Nr,tn,""+rn,Tn);if(typeof rn=="object"&&rn!==null){switch(rn.$$typeof){case va$1:return rn.key===$n?Ft(Nr,tn,rn,Tn):null;case wa$1:return rn.key===$n?Nt(Nr,tn,rn,Tn):null;case Ha$1:return $n=rn._init,dr(Nr,tn,$n(rn._payload),Tn)}if(eb$1(rn)||Ka$1(rn))return $n!==null?null:Bt(Nr,tn,rn,Tn,null);Mg$1(Nr,rn)}return null}function Mr(Nr,tn,rn,Tn,$n){if(typeof Tn=="string"&&Tn!==""||typeof Tn=="number")return Nr=Nr.get(rn)||null,Rt(tn,Nr,""+Tn,$n);if(typeof Tn=="object"&&Tn!==null){switch(Tn.$$typeof){case va$1:return Nr=Nr.get(Tn.key===null?rn:Tn.key)||null,Ft(tn,Nr,Tn,$n);case wa$1:return Nr=Nr.get(Tn.key===null?rn:Tn.key)||null,Nt(tn,Nr,Tn,$n);case Ha$1:var un=Tn._init;return Mr(Nr,tn,rn,un(Tn._payload),$n)}if(eb$1(Tn)||Ka$1(Tn))return Nr=Nr.get(rn)||null,Bt(tn,Nr,Tn,$n,null);Mg$1(tn,Tn)}return null}function Tr(Nr,tn,rn,Tn){for(var $n=null,un=null,es=tn,kn=tn=0,ts=null;es!==null&&kn<rn.length;kn++){es.index>kn?(ts=es,es=null):ts=es.sibling;var Ko=dr(Nr,es,rn[kn],Tn);if(Ko===null){es===null&&(es=ts);break}nt&&es&&Ko.alternate===null&&st(Nr,es),tn=Et(Ko,tn,kn),un===null?$n=Ko:un.sibling=Ko,un=Ko,es=ts}if(kn===rn.length)return mt(Nr,es),I$5&&tg$1(Nr,kn),$n;if(es===null){for(;kn<rn.length;kn++)es=Gt(Nr,rn[kn],Tn),es!==null&&(tn=Et(es,tn,kn),un===null?$n=es:un.sibling=es,un=es);return I$5&&tg$1(Nr,kn),$n}for(es=gt(Nr,es);kn<rn.length;kn++)ts=Mr(es,Nr,kn,rn[kn],Tn),ts!==null&&(nt&&ts.alternate!==null&&es.delete(ts.key===null?kn:ts.key),tn=Et(ts,tn,kn),un===null?$n=ts:un.sibling=ts,un=ts);return nt&&es.forEach(function(ds){return st(Nr,ds)}),I$5&&tg$1(Nr,kn),$n}function zr(Nr,tn,rn,Tn){var $n=Ka$1(rn);if(typeof $n!="function")throw Error(p$8(150));if(rn=$n.call(rn),rn==null)throw Error(p$8(151));for(var un=$n=null,es=tn,kn=tn=0,ts=null,Ko=rn.next();es!==null&&!Ko.done;kn++,Ko=rn.next()){es.index>kn?(ts=es,es=null):ts=es.sibling;var ds=dr(Nr,es,Ko.value,Tn);if(ds===null){es===null&&(es=ts);break}nt&&es&&ds.alternate===null&&st(Nr,es),tn=Et(ds,tn,kn),un===null?$n=ds:un.sibling=ds,un=ds,es=ts}if(Ko.done)return mt(Nr,es),I$5&&tg$1(Nr,kn),$n;if(es===null){for(;!Ko.done;kn++,Ko=rn.next())Ko=Gt(Nr,Ko.value,Tn),Ko!==null&&(tn=Et(Ko,tn,kn),un===null?$n=Ko:un.sibling=Ko,un=Ko);return I$5&&tg$1(Nr,kn),$n}for(es=gt(Nr,es);!Ko.done;kn++,Ko=rn.next())Ko=Mr(es,Nr,kn,Ko.value,Tn),Ko!==null&&(nt&&Ko.alternate!==null&&es.delete(Ko.key===null?kn:Ko.key),tn=Et(Ko,tn,kn),un===null?$n=Ko:un.sibling=Ko,un=Ko);return nt&&es.forEach(function(Il){return st(Nr,Il)}),I$5&&tg$1(Nr,kn),$n}function Fr(Nr,tn,rn,Tn){if(typeof rn=="object"&&rn!==null&&rn.type===ya$1&&rn.key===null&&(rn=rn.props.children),typeof rn=="object"&&rn!==null){switch(rn.$$typeof){case va$1:e:{for(var $n=rn.key,un=tn;un!==null;){if(un.key===$n){if($n=rn.type,$n===ya$1){if(un.tag===7){mt(Nr,un.sibling),tn=_t(un,rn.props.children),tn.return=Nr,Nr=tn;break e}}else if(un.elementType===$n||typeof $n=="object"&&$n!==null&&$n.$$typeof===Ha$1&&Ng$1($n)===un.type){mt(Nr,un.sibling),tn=_t(un,rn.props),tn.ref=Lg$1(Nr,un,rn),tn.return=Nr,Nr=tn;break e}mt(Nr,un);break}else st(Nr,un);un=un.sibling}rn.type===ya$1?(tn=Tg$1(rn.props.children,Nr.mode,Tn,rn.key),tn.return=Nr,Nr=tn):(Tn=Rg$1(rn.type,rn.key,rn.props,null,Nr.mode,Tn),Tn.ref=Lg$1(Nr,tn,rn),Tn.return=Nr,Nr=Tn)}return At(Nr);case wa$1:e:{for(un=rn.key;tn!==null;){if(tn.key===un)if(tn.tag===4&&tn.stateNode.containerInfo===rn.containerInfo&&tn.stateNode.implementation===rn.implementation){mt(Nr,tn.sibling),tn=_t(tn,rn.children||[]),tn.return=Nr,Nr=tn;break e}else{mt(Nr,tn);break}else st(Nr,tn);tn=tn.sibling}tn=Sg$1(rn,Nr.mode,Tn),tn.return=Nr,Nr=tn}return At(Nr);case Ha$1:return un=rn._init,Fr(Nr,tn,un(rn._payload),Tn)}if(eb$1(rn))return Tr(Nr,tn,rn,Tn);if(Ka$1(rn))return zr(Nr,tn,rn,Tn);Mg$1(Nr,rn)}return typeof rn=="string"&&rn!==""||typeof rn=="number"?(rn=""+rn,tn!==null&&tn.tag===6?(mt(Nr,tn.sibling),tn=_t(tn,rn),tn.return=Nr,Nr=tn):(mt(Nr,tn),tn=Qg$1(rn,Nr.mode,Tn),tn.return=Nr,Nr=tn),At(Nr)):mt(Nr,tn)}return Fr}var Ug$1=Og$1(!0),Vg$1=Og$1(!1),Wg$1=Uf$1(null),Xg$1=null,Yg$1=null,Zg$1=null;function $g$1(){Zg$1=Yg$1=Xg$1=null}function ah$1(nt){var st=Wg$1.current;E$7(Wg$1),nt._currentValue=st}function bh$1(nt,st,mt){for(;nt!==null;){var gt=nt.alternate;if((nt.childLanes&st)!==st?(nt.childLanes|=st,gt!==null&&(gt.childLanes|=st)):gt!==null&&(gt.childLanes&st)!==st&&(gt.childLanes|=st),nt===mt)break;nt=nt.return}}function ch$1(nt,st){Xg$1=nt,Zg$1=Yg$1=null,nt=nt.dependencies,nt!==null&&nt.firstContext!==null&&(nt.lanes&st&&(dh$1=!0),nt.firstContext=null)}function eh$1(nt){var st=nt._currentValue;if(Zg$1!==nt)if(nt={context:nt,memoizedValue:st,next:null},Yg$1===null){if(Xg$1===null)throw Error(p$8(308));Yg$1=nt,Xg$1.dependencies={lanes:0,firstContext:nt}}else Yg$1=Yg$1.next=nt;return st}var fh$1=null;function gh$1(nt){fh$1===null?fh$1=[nt]:fh$1.push(nt)}function hh$1(nt,st,mt,gt){var _t=st.interleaved;return _t===null?(mt.next=mt,gh$1(st)):(mt.next=_t.next,_t.next=mt),st.interleaved=mt,ih$1(nt,gt)}function ih$1(nt,st){nt.lanes|=st;var mt=nt.alternate;for(mt!==null&&(mt.lanes|=st),mt=nt,nt=nt.return;nt!==null;)nt.childLanes|=st,mt=nt.alternate,mt!==null&&(mt.childLanes|=st),mt=nt,nt=nt.return;return mt.tag===3?mt.stateNode:null}var jh$1=!1;function kh$1(nt){nt.updateQueue={baseState:nt.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh$1(nt,st){nt=nt.updateQueue,st.updateQueue===nt&&(st.updateQueue={baseState:nt.baseState,firstBaseUpdate:nt.firstBaseUpdate,lastBaseUpdate:nt.lastBaseUpdate,shared:nt.shared,effects:nt.effects})}function mh$1(nt,st){return{eventTime:nt,lane:st,tag:0,payload:null,callback:null,next:null}}function nh$1(nt,st,mt){var gt=nt.updateQueue;if(gt===null)return null;if(gt=gt.shared,K$2&2){var _t=gt.pending;return _t===null?st.next=st:(st.next=_t.next,_t.next=st),gt.pending=st,ih$1(nt,mt)}return _t=gt.interleaved,_t===null?(st.next=st,gh$1(gt)):(st.next=_t.next,_t.next=st),gt.interleaved=st,ih$1(nt,mt)}function oh$1(nt,st,mt){if(st=st.updateQueue,st!==null&&(st=st.shared,(mt&4194240)!==0)){var gt=st.lanes;gt&=nt.pendingLanes,mt|=gt,st.lanes=mt,Cc$1(nt,mt)}}function ph$1(nt,st){var mt=nt.updateQueue,gt=nt.alternate;if(gt!==null&&(gt=gt.updateQueue,mt===gt)){var _t=null,Et=null;if(mt=mt.firstBaseUpdate,mt!==null){do{var At={eventTime:mt.eventTime,lane:mt.lane,tag:mt.tag,payload:mt.payload,callback:mt.callback,next:null};Et===null?_t=Et=At:Et=Et.next=At,mt=mt.next}while(mt!==null);Et===null?_t=Et=st:Et=Et.next=st}else _t=Et=st;mt={baseState:gt.baseState,firstBaseUpdate:_t,lastBaseUpdate:Et,shared:gt.shared,effects:gt.effects},nt.updateQueue=mt;return}nt=mt.lastBaseUpdate,nt===null?mt.firstBaseUpdate=st:nt.next=st,mt.lastBaseUpdate=st}function qh$1(nt,st,mt,gt){var _t=nt.updateQueue;jh$1=!1;var Et=_t.firstBaseUpdate,At=_t.lastBaseUpdate,Rt=_t.shared.pending;if(Rt!==null){_t.shared.pending=null;var Ft=Rt,Nt=Ft.next;Ft.next=null,At===null?Et=Nt:At.next=Nt,At=Ft;var Bt=nt.alternate;Bt!==null&&(Bt=Bt.updateQueue,Rt=Bt.lastBaseUpdate,Rt!==At&&(Rt===null?Bt.firstBaseUpdate=Nt:Rt.next=Nt,Bt.lastBaseUpdate=Ft))}if(Et!==null){var Gt=_t.baseState;At=0,Bt=Nt=Ft=null,Rt=Et;do{var dr=Rt.lane,Mr=Rt.eventTime;if((gt&dr)===dr){Bt!==null&&(Bt=Bt.next={eventTime:Mr,lane:0,tag:Rt.tag,payload:Rt.payload,callback:Rt.callback,next:null});e:{var Tr=nt,zr=Rt;switch(dr=st,Mr=mt,zr.tag){case 1:if(Tr=zr.payload,typeof Tr=="function"){Gt=Tr.call(Mr,Gt,dr);break e}Gt=Tr;break e;case 3:Tr.flags=Tr.flags&-65537|128;case 0:if(Tr=zr.payload,dr=typeof Tr=="function"?Tr.call(Mr,Gt,dr):Tr,dr==null)break e;Gt=A$1({},Gt,dr);break e;case 2:jh$1=!0}}Rt.callback!==null&&Rt.lane!==0&&(nt.flags|=64,dr=_t.effects,dr===null?_t.effects=[Rt]:dr.push(Rt))}else Mr={eventTime:Mr,lane:dr,tag:Rt.tag,payload:Rt.payload,callback:Rt.callback,next:null},Bt===null?(Nt=Bt=Mr,Ft=Gt):Bt=Bt.next=Mr,At|=dr;if(Rt=Rt.next,Rt===null){if(Rt=_t.shared.pending,Rt===null)break;dr=Rt,Rt=dr.next,dr.next=null,_t.lastBaseUpdate=dr,_t.shared.pending=null}}while(!0);if(Bt===null&&(Ft=Gt),_t.baseState=Ft,_t.firstBaseUpdate=Nt,_t.lastBaseUpdate=Bt,st=_t.shared.interleaved,st!==null){_t=st;do At|=_t.lane,_t=_t.next;while(_t!==st)}else Et===null&&(_t.shared.lanes=0);rh$1|=At,nt.lanes=At,nt.memoizedState=Gt}}function sh$1(nt,st,mt){if(nt=st.effects,st.effects=null,nt!==null)for(st=0;st<nt.length;st++){var gt=nt[st],_t=gt.callback;if(_t!==null){if(gt.callback=null,gt=mt,typeof _t!="function")throw Error(p$8(191,_t));_t.call(gt)}}}var th$1={},uh$1=Uf$1(th$1),vh$1=Uf$1(th$1),wh$1=Uf$1(th$1);function xh$1(nt){if(nt===th$1)throw Error(p$8(174));return nt}function yh$1(nt,st){switch(G$1(wh$1,st),G$1(vh$1,nt),G$1(uh$1,th$1),nt=st.nodeType,nt){case 9:case 11:st=(st=st.documentElement)?st.namespaceURI:lb$1(null,"");break;default:nt=nt===8?st.parentNode:st,st=nt.namespaceURI||null,nt=nt.tagName,st=lb$1(st,nt)}E$7(uh$1),G$1(uh$1,st)}function zh$1(){E$7(uh$1),E$7(vh$1),E$7(wh$1)}function Ah$1(nt){xh$1(wh$1.current);var st=xh$1(uh$1.current),mt=lb$1(st,nt.type);st!==mt&&(G$1(vh$1,nt),G$1(uh$1,mt))}function Bh$1(nt){vh$1.current===nt&&(E$7(uh$1),E$7(vh$1))}var L$2=Uf$1(0);function Ch$1(nt){for(var st=nt;st!==null;){if(st.tag===13){var mt=st.memoizedState;if(mt!==null&&(mt=mt.dehydrated,mt===null||mt.data==="$?"||mt.data==="$!"))return st}else if(st.tag===19&&st.memoizedProps.revealOrder!==void 0){if(st.flags&128)return st}else if(st.child!==null){st.child.return=st,st=st.child;continue}if(st===nt)break;for(;st.sibling===null;){if(st.return===null||st.return===nt)return null;st=st.return}st.sibling.return=st.return,st=st.sibling}return null}var Dh$1=[];function Eh$1(){for(var nt=0;nt<Dh$1.length;nt++)Dh$1[nt]._workInProgressVersionPrimary=null;Dh$1.length=0}var Fh$1=ua$1.ReactCurrentDispatcher,Gh$1=ua$1.ReactCurrentBatchConfig,Hh$1=0,M$5=null,N$1=null,O$1=null,Ih$1=!1,Jh$1=!1,Kh$1=0,Lh$1=0;function P$3(){throw Error(p$8(321))}function Mh$1(nt,st){if(st===null)return!1;for(var mt=0;mt<st.length&&mt<nt.length;mt++)if(!He$1(nt[mt],st[mt]))return!1;return!0}function Nh$1(nt,st,mt,gt,_t,Et){if(Hh$1=Et,M$5=st,st.memoizedState=null,st.updateQueue=null,st.lanes=0,Fh$1.current=nt===null||nt.memoizedState===null?Oh$1:Ph$1,nt=mt(gt,_t),Jh$1){Et=0;do{if(Jh$1=!1,Kh$1=0,25<=Et)throw Error(p$8(301));Et+=1,O$1=N$1=null,st.updateQueue=null,Fh$1.current=Qh$1,nt=mt(gt,_t)}while(Jh$1)}if(Fh$1.current=Rh$1,st=N$1!==null&&N$1.next!==null,Hh$1=0,O$1=N$1=M$5=null,Ih$1=!1,st)throw Error(p$8(300));return nt}function Sh$1(){var nt=Kh$1!==0;return Kh$1=0,nt}function Th$1(){var nt={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O$1===null?M$5.memoizedState=O$1=nt:O$1=O$1.next=nt,O$1}function Uh$1(){if(N$1===null){var nt=M$5.alternate;nt=nt!==null?nt.memoizedState:null}else nt=N$1.next;var st=O$1===null?M$5.memoizedState:O$1.next;if(st!==null)O$1=st,N$1=nt;else{if(nt===null)throw Error(p$8(310));N$1=nt,nt={memoizedState:N$1.memoizedState,baseState:N$1.baseState,baseQueue:N$1.baseQueue,queue:N$1.queue,next:null},O$1===null?M$5.memoizedState=O$1=nt:O$1=O$1.next=nt}return O$1}function Vh$1(nt,st){return typeof st=="function"?st(nt):st}function Wh$1(nt){var st=Uh$1(),mt=st.queue;if(mt===null)throw Error(p$8(311));mt.lastRenderedReducer=nt;var gt=N$1,_t=gt.baseQueue,Et=mt.pending;if(Et!==null){if(_t!==null){var At=_t.next;_t.next=Et.next,Et.next=At}gt.baseQueue=_t=Et,mt.pending=null}if(_t!==null){Et=_t.next,gt=gt.baseState;var Rt=At=null,Ft=null,Nt=Et;do{var Bt=Nt.lane;if((Hh$1&Bt)===Bt)Ft!==null&&(Ft=Ft.next={lane:0,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null}),gt=Nt.hasEagerState?Nt.eagerState:nt(gt,Nt.action);else{var Gt={lane:Bt,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null};Ft===null?(Rt=Ft=Gt,At=gt):Ft=Ft.next=Gt,M$5.lanes|=Bt,rh$1|=Bt}Nt=Nt.next}while(Nt!==null&&Nt!==Et);Ft===null?At=gt:Ft.next=Rt,He$1(gt,st.memoizedState)||(dh$1=!0),st.memoizedState=gt,st.baseState=At,st.baseQueue=Ft,mt.lastRenderedState=gt}if(nt=mt.interleaved,nt!==null){_t=nt;do Et=_t.lane,M$5.lanes|=Et,rh$1|=Et,_t=_t.next;while(_t!==nt)}else _t===null&&(mt.lanes=0);return[st.memoizedState,mt.dispatch]}function Xh$1(nt){var st=Uh$1(),mt=st.queue;if(mt===null)throw Error(p$8(311));mt.lastRenderedReducer=nt;var gt=mt.dispatch,_t=mt.pending,Et=st.memoizedState;if(_t!==null){mt.pending=null;var At=_t=_t.next;do Et=nt(Et,At.action),At=At.next;while(At!==_t);He$1(Et,st.memoizedState)||(dh$1=!0),st.memoizedState=Et,st.baseQueue===null&&(st.baseState=Et),mt.lastRenderedState=Et}return[Et,gt]}function Yh$1(){}function Zh$1(nt,st){var mt=M$5,gt=Uh$1(),_t=st(),Et=!He$1(gt.memoizedState,_t);if(Et&&(gt.memoizedState=_t,dh$1=!0),gt=gt.queue,$h$1(ai$1.bind(null,mt,gt,nt),[nt]),gt.getSnapshot!==st||Et||O$1!==null&&O$1.memoizedState.tag&1){if(mt.flags|=2048,bi$1(9,ci.bind(null,mt,gt,_t,st),void 0,null),Q$1===null)throw Error(p$8(349));Hh$1&30||di$1(mt,st,_t)}return _t}function di$1(nt,st,mt){nt.flags|=16384,nt={getSnapshot:st,value:mt},st=M$5.updateQueue,st===null?(st={lastEffect:null,stores:null},M$5.updateQueue=st,st.stores=[nt]):(mt=st.stores,mt===null?st.stores=[nt]:mt.push(nt))}function ci(nt,st,mt,gt){st.value=mt,st.getSnapshot=gt,ei$1(st)&&fi$1(nt)}function ai$1(nt,st,mt){return mt(function(){ei$1(st)&&fi$1(nt)})}function ei$1(nt){var st=nt.getSnapshot;nt=nt.value;try{var mt=st();return!He$1(nt,mt)}catch{return!0}}function fi$1(nt){var st=ih$1(nt,1);st!==null&&gi$1(st,nt,1,-1)}function hi$1(nt){var st=Th$1();return typeof nt=="function"&&(nt=nt()),st.memoizedState=st.baseState=nt,nt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh$1,lastRenderedState:nt},st.queue=nt,nt=nt.dispatch=ii$1.bind(null,M$5,nt),[st.memoizedState,nt]}function bi$1(nt,st,mt,gt){return nt={tag:nt,create:st,destroy:mt,deps:gt,next:null},st=M$5.updateQueue,st===null?(st={lastEffect:null,stores:null},M$5.updateQueue=st,st.lastEffect=nt.next=nt):(mt=st.lastEffect,mt===null?st.lastEffect=nt.next=nt:(gt=mt.next,mt.next=nt,nt.next=gt,st.lastEffect=nt)),nt}function ji$1(){return Uh$1().memoizedState}function ki$1(nt,st,mt,gt){var _t=Th$1();M$5.flags|=nt,_t.memoizedState=bi$1(1|st,mt,void 0,gt===void 0?null:gt)}function li$1(nt,st,mt,gt){var _t=Uh$1();gt=gt===void 0?null:gt;var Et=void 0;if(N$1!==null){var At=N$1.memoizedState;if(Et=At.destroy,gt!==null&&Mh$1(gt,At.deps)){_t.memoizedState=bi$1(st,mt,Et,gt);return}}M$5.flags|=nt,_t.memoizedState=bi$1(1|st,mt,Et,gt)}function mi$1(nt,st){return ki$1(8390656,8,nt,st)}function $h$1(nt,st){return li$1(2048,8,nt,st)}function ni$1(nt,st){return li$1(4,2,nt,st)}function oi$1(nt,st){return li$1(4,4,nt,st)}function pi$1(nt,st){if(typeof st=="function")return nt=nt(),st(nt),function(){st(null)};if(st!=null)return nt=nt(),st.current=nt,function(){st.current=null}}function qi$1(nt,st,mt){return mt=mt!=null?mt.concat([nt]):null,li$1(4,4,pi$1.bind(null,st,nt),mt)}function ri$1(){}function si$1(nt,st){var mt=Uh$1();st=st===void 0?null:st;var gt=mt.memoizedState;return gt!==null&&st!==null&&Mh$1(st,gt[1])?gt[0]:(mt.memoizedState=[nt,st],nt)}function ti$1(nt,st){var mt=Uh$1();st=st===void 0?null:st;var gt=mt.memoizedState;return gt!==null&&st!==null&&Mh$1(st,gt[1])?gt[0]:(nt=nt(),mt.memoizedState=[nt,st],nt)}function ui(nt,st,mt){return Hh$1&21?(He$1(mt,st)||(mt=yc$1(),M$5.lanes|=mt,rh$1|=mt,nt.baseState=!0),st):(nt.baseState&&(nt.baseState=!1,dh$1=!0),nt.memoizedState=mt)}function vi$1(nt,st){var mt=C$6;C$6=mt!==0&&4>mt?mt:4,nt(!0);var gt=Gh$1.transition;Gh$1.transition={};try{nt(!1),st()}finally{C$6=mt,Gh$1.transition=gt}}function wi$1(){return Uh$1().memoizedState}function xi$1(nt,st,mt){var gt=yi$1(nt);if(mt={lane:gt,action:mt,hasEagerState:!1,eagerState:null,next:null},zi$1(nt))Ai$1(st,mt);else if(mt=hh$1(nt,st,mt,gt),mt!==null){var _t=R$1();gi$1(mt,nt,gt,_t),Bi$1(mt,st,gt)}}function ii$1(nt,st,mt){var gt=yi$1(nt),_t={lane:gt,action:mt,hasEagerState:!1,eagerState:null,next:null};if(zi$1(nt))Ai$1(st,_t);else{var Et=nt.alternate;if(nt.lanes===0&&(Et===null||Et.lanes===0)&&(Et=st.lastRenderedReducer,Et!==null))try{var At=st.lastRenderedState,Rt=Et(At,mt);if(_t.hasEagerState=!0,_t.eagerState=Rt,He$1(Rt,At)){var Ft=st.interleaved;Ft===null?(_t.next=_t,gh$1(st)):(_t.next=Ft.next,Ft.next=_t),st.interleaved=_t;return}}catch{}finally{}mt=hh$1(nt,st,_t,gt),mt!==null&&(_t=R$1(),gi$1(mt,nt,gt,_t),Bi$1(mt,st,gt))}}function zi$1(nt){var st=nt.alternate;return nt===M$5||st!==null&&st===M$5}function Ai$1(nt,st){Jh$1=Ih$1=!0;var mt=nt.pending;mt===null?st.next=st:(st.next=mt.next,mt.next=st),nt.pending=st}function Bi$1(nt,st,mt){if(mt&4194240){var gt=st.lanes;gt&=nt.pendingLanes,mt|=gt,st.lanes=mt,Cc$1(nt,mt)}}var Rh$1={readContext:eh$1,useCallback:P$3,useContext:P$3,useEffect:P$3,useImperativeHandle:P$3,useInsertionEffect:P$3,useLayoutEffect:P$3,useMemo:P$3,useReducer:P$3,useRef:P$3,useState:P$3,useDebugValue:P$3,useDeferredValue:P$3,useTransition:P$3,useMutableSource:P$3,useSyncExternalStore:P$3,useId:P$3,unstable_isNewReconciler:!1},Oh$1={readContext:eh$1,useCallback:function(nt,st){return Th$1().memoizedState=[nt,st===void 0?null:st],nt},useContext:eh$1,useEffect:mi$1,useImperativeHandle:function(nt,st,mt){return mt=mt!=null?mt.concat([nt]):null,ki$1(4194308,4,pi$1.bind(null,st,nt),mt)},useLayoutEffect:function(nt,st){return ki$1(4194308,4,nt,st)},useInsertionEffect:function(nt,st){return ki$1(4,2,nt,st)},useMemo:function(nt,st){var mt=Th$1();return st=st===void 0?null:st,nt=nt(),mt.memoizedState=[nt,st],nt},useReducer:function(nt,st,mt){var gt=Th$1();return st=mt!==void 0?mt(st):st,gt.memoizedState=gt.baseState=st,nt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nt,lastRenderedState:st},gt.queue=nt,nt=nt.dispatch=xi$1.bind(null,M$5,nt),[gt.memoizedState,nt]},useRef:function(nt){var st=Th$1();return nt={current:nt},st.memoizedState=nt},useState:hi$1,useDebugValue:ri$1,useDeferredValue:function(nt){return Th$1().memoizedState=nt},useTransition:function(){var nt=hi$1(!1),st=nt[0];return nt=vi$1.bind(null,nt[1]),Th$1().memoizedState=nt,[st,nt]},useMutableSource:function(){},useSyncExternalStore:function(nt,st,mt){var gt=M$5,_t=Th$1();if(I$5){if(mt===void 0)throw Error(p$8(407));mt=mt()}else{if(mt=st(),Q$1===null)throw Error(p$8(349));Hh$1&30||di$1(gt,st,mt)}_t.memoizedState=mt;var Et={value:mt,getSnapshot:st};return _t.queue=Et,mi$1(ai$1.bind(null,gt,Et,nt),[nt]),gt.flags|=2048,bi$1(9,ci.bind(null,gt,Et,mt,st),void 0,null),mt},useId:function(){var nt=Th$1(),st=Q$1.identifierPrefix;if(I$5){var mt=sg$1,gt=rg$1;mt=(gt&~(1<<32-oc$1(gt)-1)).toString(32)+mt,st=":"+st+"R"+mt,mt=Kh$1++,0<mt&&(st+="H"+mt.toString(32)),st+=":"}else mt=Lh$1++,st=":"+st+"r"+mt.toString(32)+":";return nt.memoizedState=st},unstable_isNewReconciler:!1},Ph$1={readContext:eh$1,useCallback:si$1,useContext:eh$1,useEffect:$h$1,useImperativeHandle:qi$1,useInsertionEffect:ni$1,useLayoutEffect:oi$1,useMemo:ti$1,useReducer:Wh$1,useRef:ji$1,useState:function(){return Wh$1(Vh$1)},useDebugValue:ri$1,useDeferredValue:function(nt){var st=Uh$1();return ui(st,N$1.memoizedState,nt)},useTransition:function(){var nt=Wh$1(Vh$1)[0],st=Uh$1().memoizedState;return[nt,st]},useMutableSource:Yh$1,useSyncExternalStore:Zh$1,useId:wi$1,unstable_isNewReconciler:!1},Qh$1={readContext:eh$1,useCallback:si$1,useContext:eh$1,useEffect:$h$1,useImperativeHandle:qi$1,useInsertionEffect:ni$1,useLayoutEffect:oi$1,useMemo:ti$1,useReducer:Xh$1,useRef:ji$1,useState:function(){return Xh$1(Vh$1)},useDebugValue:ri$1,useDeferredValue:function(nt){var st=Uh$1();return N$1===null?st.memoizedState=nt:ui(st,N$1.memoizedState,nt)},useTransition:function(){var nt=Xh$1(Vh$1)[0],st=Uh$1().memoizedState;return[nt,st]},useMutableSource:Yh$1,useSyncExternalStore:Zh$1,useId:wi$1,unstable_isNewReconciler:!1};function Ci$1(nt,st){if(nt&&nt.defaultProps){st=A$1({},st),nt=nt.defaultProps;for(var mt in nt)st[mt]===void 0&&(st[mt]=nt[mt]);return st}return st}function Di$1(nt,st,mt,gt){st=nt.memoizedState,mt=mt(gt,st),mt=mt==null?st:A$1({},st,mt),nt.memoizedState=mt,nt.lanes===0&&(nt.updateQueue.baseState=mt)}var Ei$1={isMounted:function(nt){return(nt=nt._reactInternals)?Vb$1(nt)===nt:!1},enqueueSetState:function(nt,st,mt){nt=nt._reactInternals;var gt=R$1(),_t=yi$1(nt),Et=mh$1(gt,_t);Et.payload=st,mt!=null&&(Et.callback=mt),st=nh$1(nt,Et,_t),st!==null&&(gi$1(st,nt,_t,gt),oh$1(st,nt,_t))},enqueueReplaceState:function(nt,st,mt){nt=nt._reactInternals;var gt=R$1(),_t=yi$1(nt),Et=mh$1(gt,_t);Et.tag=1,Et.payload=st,mt!=null&&(Et.callback=mt),st=nh$1(nt,Et,_t),st!==null&&(gi$1(st,nt,_t,gt),oh$1(st,nt,_t))},enqueueForceUpdate:function(nt,st){nt=nt._reactInternals;var mt=R$1(),gt=yi$1(nt),_t=mh$1(mt,gt);_t.tag=2,st!=null&&(_t.callback=st),st=nh$1(nt,_t,gt),st!==null&&(gi$1(st,nt,gt,mt),oh$1(st,nt,gt))}};function Fi$1(nt,st,mt,gt,_t,Et,At){return nt=nt.stateNode,typeof nt.shouldComponentUpdate=="function"?nt.shouldComponentUpdate(gt,Et,At):st.prototype&&st.prototype.isPureReactComponent?!Ie$1(mt,gt)||!Ie$1(_t,Et):!0}function Gi$1(nt,st,mt){var gt=!1,_t=Vf$1,Et=st.contextType;return typeof Et=="object"&&Et!==null?Et=eh$1(Et):(_t=Zf$1(st)?Xf$1:H$1.current,gt=st.contextTypes,Et=(gt=gt!=null)?Yf$1(nt,_t):Vf$1),st=new st(mt,Et),nt.memoizedState=st.state!==null&&st.state!==void 0?st.state:null,st.updater=Ei$1,nt.stateNode=st,st._reactInternals=nt,gt&&(nt=nt.stateNode,nt.__reactInternalMemoizedUnmaskedChildContext=_t,nt.__reactInternalMemoizedMaskedChildContext=Et),st}function Hi$1(nt,st,mt,gt){nt=st.state,typeof st.componentWillReceiveProps=="function"&&st.componentWillReceiveProps(mt,gt),typeof st.UNSAFE_componentWillReceiveProps=="function"&&st.UNSAFE_componentWillReceiveProps(mt,gt),st.state!==nt&&Ei$1.enqueueReplaceState(st,st.state,null)}function Ii$1(nt,st,mt,gt){var _t=nt.stateNode;_t.props=mt,_t.state=nt.memoizedState,_t.refs={},kh$1(nt);var Et=st.contextType;typeof Et=="object"&&Et!==null?_t.context=eh$1(Et):(Et=Zf$1(st)?Xf$1:H$1.current,_t.context=Yf$1(nt,Et)),_t.state=nt.memoizedState,Et=st.getDerivedStateFromProps,typeof Et=="function"&&(Di$1(nt,st,Et,mt),_t.state=nt.memoizedState),typeof st.getDerivedStateFromProps=="function"||typeof _t.getSnapshotBeforeUpdate=="function"||typeof _t.UNSAFE_componentWillMount!="function"&&typeof _t.componentWillMount!="function"||(st=_t.state,typeof _t.componentWillMount=="function"&&_t.componentWillMount(),typeof _t.UNSAFE_componentWillMount=="function"&&_t.UNSAFE_componentWillMount(),st!==_t.state&&Ei$1.enqueueReplaceState(_t,_t.state,null),qh$1(nt,mt,_t,gt),_t.state=nt.memoizedState),typeof _t.componentDidMount=="function"&&(nt.flags|=4194308)}function Ji$1(nt,st){try{var mt="",gt=st;do mt+=Pa$1(gt),gt=gt.return;while(gt);var _t=mt}catch(Et){_t=`
Error generating stack: `+Et.message+`
`+Et.stack}return{value:nt,source:st,stack:_t,digest:null}}function Ki$1(nt,st,mt){return{value:nt,source:null,stack:mt??null,digest:st??null}}function Li$1(nt,st){try{console.error(st.value)}catch(mt){setTimeout(function(){throw mt})}}var Mi$1=typeof WeakMap=="function"?WeakMap:Map;function Ni$1(nt,st,mt){mt=mh$1(-1,mt),mt.tag=3,mt.payload={element:null};var gt=st.value;return mt.callback=function(){Oi$1||(Oi$1=!0,Pi$1=gt),Li$1(nt,st)},mt}function Qi$1(nt,st,mt){mt=mh$1(-1,mt),mt.tag=3;var gt=nt.type.getDerivedStateFromError;if(typeof gt=="function"){var _t=st.value;mt.payload=function(){return gt(_t)},mt.callback=function(){Li$1(nt,st)}}var Et=nt.stateNode;return Et!==null&&typeof Et.componentDidCatch=="function"&&(mt.callback=function(){Li$1(nt,st),typeof gt!="function"&&(Ri$1===null?Ri$1=new Set([this]):Ri$1.add(this));var At=st.stack;this.componentDidCatch(st.value,{componentStack:At!==null?At:""})}),mt}function Si(nt,st,mt){var gt=nt.pingCache;if(gt===null){gt=nt.pingCache=new Mi$1;var _t=new Set;gt.set(st,_t)}else _t=gt.get(st),_t===void 0&&(_t=new Set,gt.set(st,_t));_t.has(mt)||(_t.add(mt),nt=Ti$1.bind(null,nt,st,mt),st.then(nt,nt))}function Ui$1(nt){do{var st;if((st=nt.tag===13)&&(st=nt.memoizedState,st=st!==null?st.dehydrated!==null:!0),st)return nt;nt=nt.return}while(nt!==null);return null}function Vi$1(nt,st,mt,gt,_t){return nt.mode&1?(nt.flags|=65536,nt.lanes=_t,nt):(nt===st?nt.flags|=65536:(nt.flags|=128,mt.flags|=131072,mt.flags&=-52805,mt.tag===1&&(mt.alternate===null?mt.tag=17:(st=mh$1(-1,1),st.tag=2,nh$1(mt,st,1))),mt.lanes|=1),nt)}var Wi$1=ua$1.ReactCurrentOwner,dh$1=!1;function Xi$1(nt,st,mt,gt){st.child=nt===null?Vg$1(st,null,mt,gt):Ug$1(st,nt.child,mt,gt)}function Yi$1(nt,st,mt,gt,_t){mt=mt.render;var Et=st.ref;return ch$1(st,_t),gt=Nh$1(nt,st,mt,gt,Et,_t),mt=Sh$1(),nt!==null&&!dh$1?(st.updateQueue=nt.updateQueue,st.flags&=-2053,nt.lanes&=~_t,Zi$1(nt,st,_t)):(I$5&&mt&&vg$1(st),st.flags|=1,Xi$1(nt,st,gt,_t),st.child)}function $i$1(nt,st,mt,gt,_t){if(nt===null){var Et=mt.type;return typeof Et=="function"&&!aj$1(Et)&&Et.defaultProps===void 0&&mt.compare===null&&mt.defaultProps===void 0?(st.tag=15,st.type=Et,bj$1(nt,st,Et,gt,_t)):(nt=Rg$1(mt.type,null,gt,st,st.mode,_t),nt.ref=st.ref,nt.return=st,st.child=nt)}if(Et=nt.child,!(nt.lanes&_t)){var At=Et.memoizedProps;if(mt=mt.compare,mt=mt!==null?mt:Ie$1,mt(At,gt)&&nt.ref===st.ref)return Zi$1(nt,st,_t)}return st.flags|=1,nt=Pg$1(Et,gt),nt.ref=st.ref,nt.return=st,st.child=nt}function bj$1(nt,st,mt,gt,_t){if(nt!==null){var Et=nt.memoizedProps;if(Ie$1(Et,gt)&&nt.ref===st.ref)if(dh$1=!1,st.pendingProps=gt=Et,(nt.lanes&_t)!==0)nt.flags&131072&&(dh$1=!0);else return st.lanes=nt.lanes,Zi$1(nt,st,_t)}return cj$1(nt,st,mt,gt,_t)}function dj$1(nt,st,mt){var gt=st.pendingProps,_t=gt.children,Et=nt!==null?nt.memoizedState:null;if(gt.mode==="hidden")if(!(st.mode&1))st.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(ej$1,fj$1),fj$1|=mt;else{if(!(mt&1073741824))return nt=Et!==null?Et.baseLanes|mt:mt,st.lanes=st.childLanes=1073741824,st.memoizedState={baseLanes:nt,cachePool:null,transitions:null},st.updateQueue=null,G$1(ej$1,fj$1),fj$1|=nt,null;st.memoizedState={baseLanes:0,cachePool:null,transitions:null},gt=Et!==null?Et.baseLanes:mt,G$1(ej$1,fj$1),fj$1|=gt}else Et!==null?(gt=Et.baseLanes|mt,st.memoizedState=null):gt=mt,G$1(ej$1,fj$1),fj$1|=gt;return Xi$1(nt,st,_t,mt),st.child}function gj$1(nt,st){var mt=st.ref;(nt===null&&mt!==null||nt!==null&&nt.ref!==mt)&&(st.flags|=512,st.flags|=2097152)}function cj$1(nt,st,mt,gt,_t){var Et=Zf$1(mt)?Xf$1:H$1.current;return Et=Yf$1(st,Et),ch$1(st,_t),mt=Nh$1(nt,st,mt,gt,Et,_t),gt=Sh$1(),nt!==null&&!dh$1?(st.updateQueue=nt.updateQueue,st.flags&=-2053,nt.lanes&=~_t,Zi$1(nt,st,_t)):(I$5&&gt&&vg$1(st),st.flags|=1,Xi$1(nt,st,mt,_t),st.child)}function hj$1(nt,st,mt,gt,_t){if(Zf$1(mt)){var Et=!0;cg$1(st)}else Et=!1;if(ch$1(st,_t),st.stateNode===null)ij$1(nt,st),Gi$1(st,mt,gt),Ii$1(st,mt,gt,_t),gt=!0;else if(nt===null){var At=st.stateNode,Rt=st.memoizedProps;At.props=Rt;var Ft=At.context,Nt=mt.contextType;typeof Nt=="object"&&Nt!==null?Nt=eh$1(Nt):(Nt=Zf$1(mt)?Xf$1:H$1.current,Nt=Yf$1(st,Nt));var Bt=mt.getDerivedStateFromProps,Gt=typeof Bt=="function"||typeof At.getSnapshotBeforeUpdate=="function";Gt||typeof At.UNSAFE_componentWillReceiveProps!="function"&&typeof At.componentWillReceiveProps!="function"||(Rt!==gt||Ft!==Nt)&&Hi$1(st,At,gt,Nt),jh$1=!1;var dr=st.memoizedState;At.state=dr,qh$1(st,gt,At,_t),Ft=st.memoizedState,Rt!==gt||dr!==Ft||Wf$1.current||jh$1?(typeof Bt=="function"&&(Di$1(st,mt,Bt,gt),Ft=st.memoizedState),(Rt=jh$1||Fi$1(st,mt,Rt,gt,dr,Ft,Nt))?(Gt||typeof At.UNSAFE_componentWillMount!="function"&&typeof At.componentWillMount!="function"||(typeof At.componentWillMount=="function"&&At.componentWillMount(),typeof At.UNSAFE_componentWillMount=="function"&&At.UNSAFE_componentWillMount()),typeof At.componentDidMount=="function"&&(st.flags|=4194308)):(typeof At.componentDidMount=="function"&&(st.flags|=4194308),st.memoizedProps=gt,st.memoizedState=Ft),At.props=gt,At.state=Ft,At.context=Nt,gt=Rt):(typeof At.componentDidMount=="function"&&(st.flags|=4194308),gt=!1)}else{At=st.stateNode,lh$1(nt,st),Rt=st.memoizedProps,Nt=st.type===st.elementType?Rt:Ci$1(st.type,Rt),At.props=Nt,Gt=st.pendingProps,dr=At.context,Ft=mt.contextType,typeof Ft=="object"&&Ft!==null?Ft=eh$1(Ft):(Ft=Zf$1(mt)?Xf$1:H$1.current,Ft=Yf$1(st,Ft));var Mr=mt.getDerivedStateFromProps;(Bt=typeof Mr=="function"||typeof At.getSnapshotBeforeUpdate=="function")||typeof At.UNSAFE_componentWillReceiveProps!="function"&&typeof At.componentWillReceiveProps!="function"||(Rt!==Gt||dr!==Ft)&&Hi$1(st,At,gt,Ft),jh$1=!1,dr=st.memoizedState,At.state=dr,qh$1(st,gt,At,_t);var Tr=st.memoizedState;Rt!==Gt||dr!==Tr||Wf$1.current||jh$1?(typeof Mr=="function"&&(Di$1(st,mt,Mr,gt),Tr=st.memoizedState),(Nt=jh$1||Fi$1(st,mt,Nt,gt,dr,Tr,Ft)||!1)?(Bt||typeof At.UNSAFE_componentWillUpdate!="function"&&typeof At.componentWillUpdate!="function"||(typeof At.componentWillUpdate=="function"&&At.componentWillUpdate(gt,Tr,Ft),typeof At.UNSAFE_componentWillUpdate=="function"&&At.UNSAFE_componentWillUpdate(gt,Tr,Ft)),typeof At.componentDidUpdate=="function"&&(st.flags|=4),typeof At.getSnapshotBeforeUpdate=="function"&&(st.flags|=1024)):(typeof At.componentDidUpdate!="function"||Rt===nt.memoizedProps&&dr===nt.memoizedState||(st.flags|=4),typeof At.getSnapshotBeforeUpdate!="function"||Rt===nt.memoizedProps&&dr===nt.memoizedState||(st.flags|=1024),st.memoizedProps=gt,st.memoizedState=Tr),At.props=gt,At.state=Tr,At.context=Ft,gt=Nt):(typeof At.componentDidUpdate!="function"||Rt===nt.memoizedProps&&dr===nt.memoizedState||(st.flags|=4),typeof At.getSnapshotBeforeUpdate!="function"||Rt===nt.memoizedProps&&dr===nt.memoizedState||(st.flags|=1024),gt=!1)}return jj$1(nt,st,mt,gt,Et,_t)}function jj$1(nt,st,mt,gt,_t,Et){gj$1(nt,st);var At=(st.flags&128)!==0;if(!gt&&!At)return _t&&dg$1(st,mt,!1),Zi$1(nt,st,Et);gt=st.stateNode,Wi$1.current=st;var Rt=At&&typeof mt.getDerivedStateFromError!="function"?null:gt.render();return st.flags|=1,nt!==null&&At?(st.child=Ug$1(st,nt.child,null,Et),st.child=Ug$1(st,null,Rt,Et)):Xi$1(nt,st,Rt,Et),st.memoizedState=gt.state,_t&&dg$1(st,mt,!0),st.child}function kj$1(nt){var st=nt.stateNode;st.pendingContext?ag$1(nt,st.pendingContext,st.pendingContext!==st.context):st.context&&ag$1(nt,st.context,!1),yh$1(nt,st.containerInfo)}function lj$1(nt,st,mt,gt,_t){return Ig$1(),Jg$1(_t),st.flags|=256,Xi$1(nt,st,mt,gt),st.child}var mj$1={dehydrated:null,treeContext:null,retryLane:0};function nj$1(nt){return{baseLanes:nt,cachePool:null,transitions:null}}function oj$1(nt,st,mt){var gt=st.pendingProps,_t=L$2.current,Et=!1,At=(st.flags&128)!==0,Rt;if((Rt=At)||(Rt=nt!==null&&nt.memoizedState===null?!1:(_t&2)!==0),Rt?(Et=!0,st.flags&=-129):(nt===null||nt.memoizedState!==null)&&(_t|=1),G$1(L$2,_t&1),nt===null)return Eg$1(st),nt=st.memoizedState,nt!==null&&(nt=nt.dehydrated,nt!==null)?(st.mode&1?nt.data==="$!"?st.lanes=8:st.lanes=1073741824:st.lanes=1,null):(At=gt.children,nt=gt.fallback,Et?(gt=st.mode,Et=st.child,At={mode:"hidden",children:At},!(gt&1)&&Et!==null?(Et.childLanes=0,Et.pendingProps=At):Et=pj$1(At,gt,0,null),nt=Tg$1(nt,gt,mt,null),Et.return=st,nt.return=st,Et.sibling=nt,st.child=Et,st.child.memoizedState=nj$1(mt),st.memoizedState=mj$1,nt):qj$1(st,At));if(_t=nt.memoizedState,_t!==null&&(Rt=_t.dehydrated,Rt!==null))return rj$1(nt,st,At,gt,Rt,_t,mt);if(Et){Et=gt.fallback,At=st.mode,_t=nt.child,Rt=_t.sibling;var Ft={mode:"hidden",children:gt.children};return!(At&1)&&st.child!==_t?(gt=st.child,gt.childLanes=0,gt.pendingProps=Ft,st.deletions=null):(gt=Pg$1(_t,Ft),gt.subtreeFlags=_t.subtreeFlags&14680064),Rt!==null?Et=Pg$1(Rt,Et):(Et=Tg$1(Et,At,mt,null),Et.flags|=2),Et.return=st,gt.return=st,gt.sibling=Et,st.child=gt,gt=Et,Et=st.child,At=nt.child.memoizedState,At=At===null?nj$1(mt):{baseLanes:At.baseLanes|mt,cachePool:null,transitions:At.transitions},Et.memoizedState=At,Et.childLanes=nt.childLanes&~mt,st.memoizedState=mj$1,gt}return Et=nt.child,nt=Et.sibling,gt=Pg$1(Et,{mode:"visible",children:gt.children}),!(st.mode&1)&&(gt.lanes=mt),gt.return=st,gt.sibling=null,nt!==null&&(mt=st.deletions,mt===null?(st.deletions=[nt],st.flags|=16):mt.push(nt)),st.child=gt,st.memoizedState=null,gt}function qj$1(nt,st){return st=pj$1({mode:"visible",children:st},nt.mode,0,null),st.return=nt,nt.child=st}function sj$1(nt,st,mt,gt){return gt!==null&&Jg$1(gt),Ug$1(st,nt.child,null,mt),nt=qj$1(st,st.pendingProps.children),nt.flags|=2,st.memoizedState=null,nt}function rj$1(nt,st,mt,gt,_t,Et,At){if(mt)return st.flags&256?(st.flags&=-257,gt=Ki$1(Error(p$8(422))),sj$1(nt,st,At,gt)):st.memoizedState!==null?(st.child=nt.child,st.flags|=128,null):(Et=gt.fallback,_t=st.mode,gt=pj$1({mode:"visible",children:gt.children},_t,0,null),Et=Tg$1(Et,_t,At,null),Et.flags|=2,gt.return=st,Et.return=st,gt.sibling=Et,st.child=gt,st.mode&1&&Ug$1(st,nt.child,null,At),st.child.memoizedState=nj$1(At),st.memoizedState=mj$1,Et);if(!(st.mode&1))return sj$1(nt,st,At,null);if(_t.data==="$!"){if(gt=_t.nextSibling&&_t.nextSibling.dataset,gt)var Rt=gt.dgst;return gt=Rt,Et=Error(p$8(419)),gt=Ki$1(Et,gt,void 0),sj$1(nt,st,At,gt)}if(Rt=(At&nt.childLanes)!==0,dh$1||Rt){if(gt=Q$1,gt!==null){switch(At&-At){case 4:_t=2;break;case 16:_t=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_t=32;break;case 536870912:_t=268435456;break;default:_t=0}_t=_t&(gt.suspendedLanes|At)?0:_t,_t!==0&&_t!==Et.retryLane&&(Et.retryLane=_t,ih$1(nt,_t),gi$1(gt,nt,_t,-1))}return tj$1(),gt=Ki$1(Error(p$8(421))),sj$1(nt,st,At,gt)}return _t.data==="$?"?(st.flags|=128,st.child=nt.child,st=uj$1.bind(null,nt),_t._reactRetry=st,null):(nt=Et.treeContext,yg=Lf$1(_t.nextSibling),xg$1=st,I$5=!0,zg$1=null,nt!==null&&(og$1[pg$1++]=rg$1,og$1[pg$1++]=sg$1,og$1[pg$1++]=qg$1,rg$1=nt.id,sg$1=nt.overflow,qg$1=st),st=qj$1(st,gt.children),st.flags|=4096,st)}function vj$1(nt,st,mt){nt.lanes|=st;var gt=nt.alternate;gt!==null&&(gt.lanes|=st),bh$1(nt.return,st,mt)}function wj$1(nt,st,mt,gt,_t){var Et=nt.memoizedState;Et===null?nt.memoizedState={isBackwards:st,rendering:null,renderingStartTime:0,last:gt,tail:mt,tailMode:_t}:(Et.isBackwards=st,Et.rendering=null,Et.renderingStartTime=0,Et.last=gt,Et.tail=mt,Et.tailMode=_t)}function xj$1(nt,st,mt){var gt=st.pendingProps,_t=gt.revealOrder,Et=gt.tail;if(Xi$1(nt,st,gt.children,mt),gt=L$2.current,gt&2)gt=gt&1|2,st.flags|=128;else{if(nt!==null&&nt.flags&128)e:for(nt=st.child;nt!==null;){if(nt.tag===13)nt.memoizedState!==null&&vj$1(nt,mt,st);else if(nt.tag===19)vj$1(nt,mt,st);else if(nt.child!==null){nt.child.return=nt,nt=nt.child;continue}if(nt===st)break e;for(;nt.sibling===null;){if(nt.return===null||nt.return===st)break e;nt=nt.return}nt.sibling.return=nt.return,nt=nt.sibling}gt&=1}if(G$1(L$2,gt),!(st.mode&1))st.memoizedState=null;else switch(_t){case"forwards":for(mt=st.child,_t=null;mt!==null;)nt=mt.alternate,nt!==null&&Ch$1(nt)===null&&(_t=mt),mt=mt.sibling;mt=_t,mt===null?(_t=st.child,st.child=null):(_t=mt.sibling,mt.sibling=null),wj$1(st,!1,_t,mt,Et);break;case"backwards":for(mt=null,_t=st.child,st.child=null;_t!==null;){if(nt=_t.alternate,nt!==null&&Ch$1(nt)===null){st.child=_t;break}nt=_t.sibling,_t.sibling=mt,mt=_t,_t=nt}wj$1(st,!0,mt,null,Et);break;case"together":wj$1(st,!1,null,null,void 0);break;default:st.memoizedState=null}return st.child}function ij$1(nt,st){!(st.mode&1)&&nt!==null&&(nt.alternate=null,st.alternate=null,st.flags|=2)}function Zi$1(nt,st,mt){if(nt!==null&&(st.dependencies=nt.dependencies),rh$1|=st.lanes,!(mt&st.childLanes))return null;if(nt!==null&&st.child!==nt.child)throw Error(p$8(153));if(st.child!==null){for(nt=st.child,mt=Pg$1(nt,nt.pendingProps),st.child=mt,mt.return=st;nt.sibling!==null;)nt=nt.sibling,mt=mt.sibling=Pg$1(nt,nt.pendingProps),mt.return=st;mt.sibling=null}return st.child}function yj$1(nt,st,mt){switch(st.tag){case 3:kj$1(st),Ig$1();break;case 5:Ah$1(st);break;case 1:Zf$1(st.type)&&cg$1(st);break;case 4:yh$1(st,st.stateNode.containerInfo);break;case 10:var gt=st.type._context,_t=st.memoizedProps.value;G$1(Wg$1,gt._currentValue),gt._currentValue=_t;break;case 13:if(gt=st.memoizedState,gt!==null)return gt.dehydrated!==null?(G$1(L$2,L$2.current&1),st.flags|=128,null):mt&st.child.childLanes?oj$1(nt,st,mt):(G$1(L$2,L$2.current&1),nt=Zi$1(nt,st,mt),nt!==null?nt.sibling:null);G$1(L$2,L$2.current&1);break;case 19:if(gt=(mt&st.childLanes)!==0,nt.flags&128){if(gt)return xj$1(nt,st,mt);st.flags|=128}if(_t=st.memoizedState,_t!==null&&(_t.rendering=null,_t.tail=null,_t.lastEffect=null),G$1(L$2,L$2.current),gt)break;return null;case 22:case 23:return st.lanes=0,dj$1(nt,st,mt)}return Zi$1(nt,st,mt)}var zj$1,Aj$1,Bj$1,Cj$1;zj$1=function(nt,st){for(var mt=st.child;mt!==null;){if(mt.tag===5||mt.tag===6)nt.appendChild(mt.stateNode);else if(mt.tag!==4&&mt.child!==null){mt.child.return=mt,mt=mt.child;continue}if(mt===st)break;for(;mt.sibling===null;){if(mt.return===null||mt.return===st)return;mt=mt.return}mt.sibling.return=mt.return,mt=mt.sibling}};Aj$1=function(){};Bj$1=function(nt,st,mt,gt){var _t=nt.memoizedProps;if(_t!==gt){nt=st.stateNode,xh$1(uh$1.current);var Et=null;switch(mt){case"input":_t=Ya$1(nt,_t),gt=Ya$1(nt,gt),Et=[];break;case"select":_t=A$1({},_t,{value:void 0}),gt=A$1({},gt,{value:void 0}),Et=[];break;case"textarea":_t=gb$1(nt,_t),gt=gb$1(nt,gt),Et=[];break;default:typeof _t.onClick!="function"&&typeof gt.onClick=="function"&&(nt.onclick=Bf$1)}ub$1(mt,gt);var At;mt=null;for(Nt in _t)if(!gt.hasOwnProperty(Nt)&&_t.hasOwnProperty(Nt)&&_t[Nt]!=null)if(Nt==="style"){var Rt=_t[Nt];for(At in Rt)Rt.hasOwnProperty(At)&&(mt||(mt={}),mt[At]="")}else Nt!=="dangerouslySetInnerHTML"&&Nt!=="children"&&Nt!=="suppressContentEditableWarning"&&Nt!=="suppressHydrationWarning"&&Nt!=="autoFocus"&&(ea$1.hasOwnProperty(Nt)?Et||(Et=[]):(Et=Et||[]).push(Nt,null));for(Nt in gt){var Ft=gt[Nt];if(Rt=_t!=null?_t[Nt]:void 0,gt.hasOwnProperty(Nt)&&Ft!==Rt&&(Ft!=null||Rt!=null))if(Nt==="style")if(Rt){for(At in Rt)!Rt.hasOwnProperty(At)||Ft&&Ft.hasOwnProperty(At)||(mt||(mt={}),mt[At]="");for(At in Ft)Ft.hasOwnProperty(At)&&Rt[At]!==Ft[At]&&(mt||(mt={}),mt[At]=Ft[At])}else mt||(Et||(Et=[]),Et.push(Nt,mt)),mt=Ft;else Nt==="dangerouslySetInnerHTML"?(Ft=Ft?Ft.__html:void 0,Rt=Rt?Rt.__html:void 0,Ft!=null&&Rt!==Ft&&(Et=Et||[]).push(Nt,Ft)):Nt==="children"?typeof Ft!="string"&&typeof Ft!="number"||(Et=Et||[]).push(Nt,""+Ft):Nt!=="suppressContentEditableWarning"&&Nt!=="suppressHydrationWarning"&&(ea$1.hasOwnProperty(Nt)?(Ft!=null&&Nt==="onScroll"&&D$2("scroll",nt),Et||Rt===Ft||(Et=[])):(Et=Et||[]).push(Nt,Ft))}mt&&(Et=Et||[]).push("style",mt);var Nt=Et;(st.updateQueue=Nt)&&(st.flags|=4)}};Cj$1=function(nt,st,mt,gt){mt!==gt&&(st.flags|=4)};function Dj$1(nt,st){if(!I$5)switch(nt.tailMode){case"hidden":st=nt.tail;for(var mt=null;st!==null;)st.alternate!==null&&(mt=st),st=st.sibling;mt===null?nt.tail=null:mt.sibling=null;break;case"collapsed":mt=nt.tail;for(var gt=null;mt!==null;)mt.alternate!==null&&(gt=mt),mt=mt.sibling;gt===null?st||nt.tail===null?nt.tail=null:nt.tail.sibling=null:gt.sibling=null}}function S$6(nt){var st=nt.alternate!==null&&nt.alternate.child===nt.child,mt=0,gt=0;if(st)for(var _t=nt.child;_t!==null;)mt|=_t.lanes|_t.childLanes,gt|=_t.subtreeFlags&14680064,gt|=_t.flags&14680064,_t.return=nt,_t=_t.sibling;else for(_t=nt.child;_t!==null;)mt|=_t.lanes|_t.childLanes,gt|=_t.subtreeFlags,gt|=_t.flags,_t.return=nt,_t=_t.sibling;return nt.subtreeFlags|=gt,nt.childLanes=mt,st}function Ej$1(nt,st,mt){var gt=st.pendingProps;switch(wg$1(st),st.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$6(st),null;case 1:return Zf$1(st.type)&&$f$1(),S$6(st),null;case 3:return gt=st.stateNode,zh$1(),E$7(Wf$1),E$7(H$1),Eh$1(),gt.pendingContext&&(gt.context=gt.pendingContext,gt.pendingContext=null),(nt===null||nt.child===null)&&(Gg$1(st)?st.flags|=4:nt===null||nt.memoizedState.isDehydrated&&!(st.flags&256)||(st.flags|=1024,zg$1!==null&&(Fj$1(zg$1),zg$1=null))),Aj$1(nt,st),S$6(st),null;case 5:Bh$1(st);var _t=xh$1(wh$1.current);if(mt=st.type,nt!==null&&st.stateNode!=null)Bj$1(nt,st,mt,gt,_t),nt.ref!==st.ref&&(st.flags|=512,st.flags|=2097152);else{if(!gt){if(st.stateNode===null)throw Error(p$8(166));return S$6(st),null}if(nt=xh$1(uh$1.current),Gg$1(st)){gt=st.stateNode,mt=st.type;var Et=st.memoizedProps;switch(gt[Of$1]=st,gt[Pf$1]=Et,nt=(st.mode&1)!==0,mt){case"dialog":D$2("cancel",gt),D$2("close",gt);break;case"iframe":case"object":case"embed":D$2("load",gt);break;case"video":case"audio":for(_t=0;_t<lf$1.length;_t++)D$2(lf$1[_t],gt);break;case"source":D$2("error",gt);break;case"img":case"image":case"link":D$2("error",gt),D$2("load",gt);break;case"details":D$2("toggle",gt);break;case"input":Za$1(gt,Et),D$2("invalid",gt);break;case"select":gt._wrapperState={wasMultiple:!!Et.multiple},D$2("invalid",gt);break;case"textarea":hb$1(gt,Et),D$2("invalid",gt)}ub$1(mt,Et),_t=null;for(var At in Et)if(Et.hasOwnProperty(At)){var Rt=Et[At];At==="children"?typeof Rt=="string"?gt.textContent!==Rt&&(Et.suppressHydrationWarning!==!0&&Af$1(gt.textContent,Rt,nt),_t=["children",Rt]):typeof Rt=="number"&&gt.textContent!==""+Rt&&(Et.suppressHydrationWarning!==!0&&Af$1(gt.textContent,Rt,nt),_t=["children",""+Rt]):ea$1.hasOwnProperty(At)&&Rt!=null&&At==="onScroll"&&D$2("scroll",gt)}switch(mt){case"input":Va$1(gt),db$1(gt,Et,!0);break;case"textarea":Va$1(gt),jb$1(gt);break;case"select":case"option":break;default:typeof Et.onClick=="function"&&(gt.onclick=Bf$1)}gt=_t,st.updateQueue=gt,gt!==null&&(st.flags|=4)}else{At=_t.nodeType===9?_t:_t.ownerDocument,nt==="http://www.w3.org/1999/xhtml"&&(nt=kb$1(mt)),nt==="http://www.w3.org/1999/xhtml"?mt==="script"?(nt=At.createElement("div"),nt.innerHTML="<script><\/script>",nt=nt.removeChild(nt.firstChild)):typeof gt.is=="string"?nt=At.createElement(mt,{is:gt.is}):(nt=At.createElement(mt),mt==="select"&&(At=nt,gt.multiple?At.multiple=!0:gt.size&&(At.size=gt.size))):nt=At.createElementNS(nt,mt),nt[Of$1]=st,nt[Pf$1]=gt,zj$1(nt,st,!1,!1),st.stateNode=nt;e:{switch(At=vb$1(mt,gt),mt){case"dialog":D$2("cancel",nt),D$2("close",nt),_t=gt;break;case"iframe":case"object":case"embed":D$2("load",nt),_t=gt;break;case"video":case"audio":for(_t=0;_t<lf$1.length;_t++)D$2(lf$1[_t],nt);_t=gt;break;case"source":D$2("error",nt),_t=gt;break;case"img":case"image":case"link":D$2("error",nt),D$2("load",nt),_t=gt;break;case"details":D$2("toggle",nt),_t=gt;break;case"input":Za$1(nt,gt),_t=Ya$1(nt,gt),D$2("invalid",nt);break;case"option":_t=gt;break;case"select":nt._wrapperState={wasMultiple:!!gt.multiple},_t=A$1({},gt,{value:void 0}),D$2("invalid",nt);break;case"textarea":hb$1(nt,gt),_t=gb$1(nt,gt),D$2("invalid",nt);break;default:_t=gt}ub$1(mt,_t),Rt=_t;for(Et in Rt)if(Rt.hasOwnProperty(Et)){var Ft=Rt[Et];Et==="style"?sb(nt,Ft):Et==="dangerouslySetInnerHTML"?(Ft=Ft?Ft.__html:void 0,Ft!=null&&nb$1(nt,Ft)):Et==="children"?typeof Ft=="string"?(mt!=="textarea"||Ft!=="")&&ob$1(nt,Ft):typeof Ft=="number"&&ob$1(nt,""+Ft):Et!=="suppressContentEditableWarning"&&Et!=="suppressHydrationWarning"&&Et!=="autoFocus"&&(ea$1.hasOwnProperty(Et)?Ft!=null&&Et==="onScroll"&&D$2("scroll",nt):Ft!=null&&ta$1(nt,Et,Ft,At))}switch(mt){case"input":Va$1(nt),db$1(nt,gt,!1);break;case"textarea":Va$1(nt),jb$1(nt);break;case"option":gt.value!=null&&nt.setAttribute("value",""+Sa$1(gt.value));break;case"select":nt.multiple=!!gt.multiple,Et=gt.value,Et!=null?fb$1(nt,!!gt.multiple,Et,!1):gt.defaultValue!=null&&fb$1(nt,!!gt.multiple,gt.defaultValue,!0);break;default:typeof _t.onClick=="function"&&(nt.onclick=Bf$1)}switch(mt){case"button":case"input":case"select":case"textarea":gt=!!gt.autoFocus;break e;case"img":gt=!0;break e;default:gt=!1}}gt&&(st.flags|=4)}st.ref!==null&&(st.flags|=512,st.flags|=2097152)}return S$6(st),null;case 6:if(nt&&st.stateNode!=null)Cj$1(nt,st,nt.memoizedProps,gt);else{if(typeof gt!="string"&&st.stateNode===null)throw Error(p$8(166));if(mt=xh$1(wh$1.current),xh$1(uh$1.current),Gg$1(st)){if(gt=st.stateNode,mt=st.memoizedProps,gt[Of$1]=st,(Et=gt.nodeValue!==mt)&&(nt=xg$1,nt!==null))switch(nt.tag){case 3:Af$1(gt.nodeValue,mt,(nt.mode&1)!==0);break;case 5:nt.memoizedProps.suppressHydrationWarning!==!0&&Af$1(gt.nodeValue,mt,(nt.mode&1)!==0)}Et&&(st.flags|=4)}else gt=(mt.nodeType===9?mt:mt.ownerDocument).createTextNode(gt),gt[Of$1]=st,st.stateNode=gt}return S$6(st),null;case 13:if(E$7(L$2),gt=st.memoizedState,nt===null||nt.memoizedState!==null&&nt.memoizedState.dehydrated!==null){if(I$5&&yg!==null&&st.mode&1&&!(st.flags&128))Hg$1(),Ig$1(),st.flags|=98560,Et=!1;else if(Et=Gg$1(st),gt!==null&&gt.dehydrated!==null){if(nt===null){if(!Et)throw Error(p$8(318));if(Et=st.memoizedState,Et=Et!==null?Et.dehydrated:null,!Et)throw Error(p$8(317));Et[Of$1]=st}else Ig$1(),!(st.flags&128)&&(st.memoizedState=null),st.flags|=4;S$6(st),Et=!1}else zg$1!==null&&(Fj$1(zg$1),zg$1=null),Et=!0;if(!Et)return st.flags&65536?st:null}return st.flags&128?(st.lanes=mt,st):(gt=gt!==null,gt!==(nt!==null&&nt.memoizedState!==null)&&gt&&(st.child.flags|=8192,st.mode&1&&(nt===null||L$2.current&1?T$2===0&&(T$2=3):tj$1())),st.updateQueue!==null&&(st.flags|=4),S$6(st),null);case 4:return zh$1(),Aj$1(nt,st),nt===null&&sf$1(st.stateNode.containerInfo),S$6(st),null;case 10:return ah$1(st.type._context),S$6(st),null;case 17:return Zf$1(st.type)&&$f$1(),S$6(st),null;case 19:if(E$7(L$2),Et=st.memoizedState,Et===null)return S$6(st),null;if(gt=(st.flags&128)!==0,At=Et.rendering,At===null)if(gt)Dj$1(Et,!1);else{if(T$2!==0||nt!==null&&nt.flags&128)for(nt=st.child;nt!==null;){if(At=Ch$1(nt),At!==null){for(st.flags|=128,Dj$1(Et,!1),gt=At.updateQueue,gt!==null&&(st.updateQueue=gt,st.flags|=4),st.subtreeFlags=0,gt=mt,mt=st.child;mt!==null;)Et=mt,nt=gt,Et.flags&=14680066,At=Et.alternate,At===null?(Et.childLanes=0,Et.lanes=nt,Et.child=null,Et.subtreeFlags=0,Et.memoizedProps=null,Et.memoizedState=null,Et.updateQueue=null,Et.dependencies=null,Et.stateNode=null):(Et.childLanes=At.childLanes,Et.lanes=At.lanes,Et.child=At.child,Et.subtreeFlags=0,Et.deletions=null,Et.memoizedProps=At.memoizedProps,Et.memoizedState=At.memoizedState,Et.updateQueue=At.updateQueue,Et.type=At.type,nt=At.dependencies,Et.dependencies=nt===null?null:{lanes:nt.lanes,firstContext:nt.firstContext}),mt=mt.sibling;return G$1(L$2,L$2.current&1|2),st.child}nt=nt.sibling}Et.tail!==null&&B$1()>Gj$1&&(st.flags|=128,gt=!0,Dj$1(Et,!1),st.lanes=4194304)}else{if(!gt)if(nt=Ch$1(At),nt!==null){if(st.flags|=128,gt=!0,mt=nt.updateQueue,mt!==null&&(st.updateQueue=mt,st.flags|=4),Dj$1(Et,!0),Et.tail===null&&Et.tailMode==="hidden"&&!At.alternate&&!I$5)return S$6(st),null}else 2*B$1()-Et.renderingStartTime>Gj$1&&mt!==1073741824&&(st.flags|=128,gt=!0,Dj$1(Et,!1),st.lanes=4194304);Et.isBackwards?(At.sibling=st.child,st.child=At):(mt=Et.last,mt!==null?mt.sibling=At:st.child=At,Et.last=At)}return Et.tail!==null?(st=Et.tail,Et.rendering=st,Et.tail=st.sibling,Et.renderingStartTime=B$1(),st.sibling=null,mt=L$2.current,G$1(L$2,gt?mt&1|2:mt&1),st):(S$6(st),null);case 22:case 23:return Hj$1(),gt=st.memoizedState!==null,nt!==null&&nt.memoizedState!==null!==gt&&(st.flags|=8192),gt&&st.mode&1?fj$1&1073741824&&(S$6(st),st.subtreeFlags&6&&(st.flags|=8192)):S$6(st),null;case 24:return null;case 25:return null}throw Error(p$8(156,st.tag))}function Ij$1(nt,st){switch(wg$1(st),st.tag){case 1:return Zf$1(st.type)&&$f$1(),nt=st.flags,nt&65536?(st.flags=nt&-65537|128,st):null;case 3:return zh$1(),E$7(Wf$1),E$7(H$1),Eh$1(),nt=st.flags,nt&65536&&!(nt&128)?(st.flags=nt&-65537|128,st):null;case 5:return Bh$1(st),null;case 13:if(E$7(L$2),nt=st.memoizedState,nt!==null&&nt.dehydrated!==null){if(st.alternate===null)throw Error(p$8(340));Ig$1()}return nt=st.flags,nt&65536?(st.flags=nt&-65537|128,st):null;case 19:return E$7(L$2),null;case 4:return zh$1(),null;case 10:return ah$1(st.type._context),null;case 22:case 23:return Hj$1(),null;case 24:return null;default:return null}}var Jj$1=!1,U$2=!1,Kj$1=typeof WeakSet=="function"?WeakSet:Set,V$1=null;function Lj$1(nt,st){var mt=nt.ref;if(mt!==null)if(typeof mt=="function")try{mt(null)}catch(gt){W$1(nt,st,gt)}else mt.current=null}function Mj$1(nt,st,mt){try{mt()}catch(gt){W$1(nt,st,gt)}}var Nj$1=!1;function Oj$1(nt,st){if(Cf$1=dd$1,nt=Me$2(),Ne$1(nt)){if("selectionStart"in nt)var mt={start:nt.selectionStart,end:nt.selectionEnd};else e:{mt=(mt=nt.ownerDocument)&&mt.defaultView||window;var gt=mt.getSelection&&mt.getSelection();if(gt&&gt.rangeCount!==0){mt=gt.anchorNode;var _t=gt.anchorOffset,Et=gt.focusNode;gt=gt.focusOffset;try{mt.nodeType,Et.nodeType}catch{mt=null;break e}var At=0,Rt=-1,Ft=-1,Nt=0,Bt=0,Gt=nt,dr=null;t:for(;;){for(var Mr;Gt!==mt||_t!==0&&Gt.nodeType!==3||(Rt=At+_t),Gt!==Et||gt!==0&&Gt.nodeType!==3||(Ft=At+gt),Gt.nodeType===3&&(At+=Gt.nodeValue.length),(Mr=Gt.firstChild)!==null;)dr=Gt,Gt=Mr;for(;;){if(Gt===nt)break t;if(dr===mt&&++Nt===_t&&(Rt=At),dr===Et&&++Bt===gt&&(Ft=At),(Mr=Gt.nextSibling)!==null)break;Gt=dr,dr=Gt.parentNode}Gt=Mr}mt=Rt===-1||Ft===-1?null:{start:Rt,end:Ft}}else mt=null}mt=mt||{start:0,end:0}}else mt=null;for(Df$1={focusedElem:nt,selectionRange:mt},dd$1=!1,V$1=st;V$1!==null;)if(st=V$1,nt=st.child,(st.subtreeFlags&1028)!==0&&nt!==null)nt.return=st,V$1=nt;else for(;V$1!==null;){st=V$1;try{var Tr=st.alternate;if(st.flags&1024)switch(st.tag){case 0:case 11:case 15:break;case 1:if(Tr!==null){var zr=Tr.memoizedProps,Fr=Tr.memoizedState,Nr=st.stateNode,tn=Nr.getSnapshotBeforeUpdate(st.elementType===st.type?zr:Ci$1(st.type,zr),Fr);Nr.__reactInternalSnapshotBeforeUpdate=tn}break;case 3:var rn=st.stateNode.containerInfo;rn.nodeType===1?rn.textContent="":rn.nodeType===9&&rn.documentElement&&rn.removeChild(rn.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$8(163))}}catch(Tn){W$1(st,st.return,Tn)}if(nt=st.sibling,nt!==null){nt.return=st.return,V$1=nt;break}V$1=st.return}return Tr=Nj$1,Nj$1=!1,Tr}function Pj$1(nt,st,mt){var gt=st.updateQueue;if(gt=gt!==null?gt.lastEffect:null,gt!==null){var _t=gt=gt.next;do{if((_t.tag&nt)===nt){var Et=_t.destroy;_t.destroy=void 0,Et!==void 0&&Mj$1(st,mt,Et)}_t=_t.next}while(_t!==gt)}}function Qj$1(nt,st){if(st=st.updateQueue,st=st!==null?st.lastEffect:null,st!==null){var mt=st=st.next;do{if((mt.tag&nt)===nt){var gt=mt.create;mt.destroy=gt()}mt=mt.next}while(mt!==st)}}function Rj$1(nt){var st=nt.ref;if(st!==null){var mt=nt.stateNode;switch(nt.tag){case 5:nt=mt;break;default:nt=mt}typeof st=="function"?st(nt):st.current=nt}}function Sj$1(nt){var st=nt.alternate;st!==null&&(nt.alternate=null,Sj$1(st)),nt.child=null,nt.deletions=null,nt.sibling=null,nt.tag===5&&(st=nt.stateNode,st!==null&&(delete st[Of$1],delete st[Pf$1],delete st[of$1],delete st[Qf$1],delete st[Rf$1])),nt.stateNode=null,nt.return=null,nt.dependencies=null,nt.memoizedProps=null,nt.memoizedState=null,nt.pendingProps=null,nt.stateNode=null,nt.updateQueue=null}function Tj$1(nt){return nt.tag===5||nt.tag===3||nt.tag===4}function Uj$1(nt){e:for(;;){for(;nt.sibling===null;){if(nt.return===null||Tj$1(nt.return))return null;nt=nt.return}for(nt.sibling.return=nt.return,nt=nt.sibling;nt.tag!==5&&nt.tag!==6&&nt.tag!==18;){if(nt.flags&2||nt.child===null||nt.tag===4)continue e;nt.child.return=nt,nt=nt.child}if(!(nt.flags&2))return nt.stateNode}}function Vj$1(nt,st,mt){var gt=nt.tag;if(gt===5||gt===6)nt=nt.stateNode,st?mt.nodeType===8?mt.parentNode.insertBefore(nt,st):mt.insertBefore(nt,st):(mt.nodeType===8?(st=mt.parentNode,st.insertBefore(nt,mt)):(st=mt,st.appendChild(nt)),mt=mt._reactRootContainer,mt!=null||st.onclick!==null||(st.onclick=Bf$1));else if(gt!==4&&(nt=nt.child,nt!==null))for(Vj$1(nt,st,mt),nt=nt.sibling;nt!==null;)Vj$1(nt,st,mt),nt=nt.sibling}function Wj$1(nt,st,mt){var gt=nt.tag;if(gt===5||gt===6)nt=nt.stateNode,st?mt.insertBefore(nt,st):mt.appendChild(nt);else if(gt!==4&&(nt=nt.child,nt!==null))for(Wj$1(nt,st,mt),nt=nt.sibling;nt!==null;)Wj$1(nt,st,mt),nt=nt.sibling}var X$1=null,Xj$1=!1;function Yj$1(nt,st,mt){for(mt=mt.child;mt!==null;)Zj$1(nt,st,mt),mt=mt.sibling}function Zj$1(nt,st,mt){if(lc$1&&typeof lc$1.onCommitFiberUnmount=="function")try{lc$1.onCommitFiberUnmount(kc$1,mt)}catch{}switch(mt.tag){case 5:U$2||Lj$1(mt,st);case 6:var gt=X$1,_t=Xj$1;X$1=null,Yj$1(nt,st,mt),X$1=gt,Xj$1=_t,X$1!==null&&(Xj$1?(nt=X$1,mt=mt.stateNode,nt.nodeType===8?nt.parentNode.removeChild(mt):nt.removeChild(mt)):X$1.removeChild(mt.stateNode));break;case 18:X$1!==null&&(Xj$1?(nt=X$1,mt=mt.stateNode,nt.nodeType===8?Kf$1(nt.parentNode,mt):nt.nodeType===1&&Kf$1(nt,mt),bd$1(nt)):Kf$1(X$1,mt.stateNode));break;case 4:gt=X$1,_t=Xj$1,X$1=mt.stateNode.containerInfo,Xj$1=!0,Yj$1(nt,st,mt),X$1=gt,Xj$1=_t;break;case 0:case 11:case 14:case 15:if(!U$2&&(gt=mt.updateQueue,gt!==null&&(gt=gt.lastEffect,gt!==null))){_t=gt=gt.next;do{var Et=_t,At=Et.destroy;Et=Et.tag,At!==void 0&&(Et&2||Et&4)&&Mj$1(mt,st,At),_t=_t.next}while(_t!==gt)}Yj$1(nt,st,mt);break;case 1:if(!U$2&&(Lj$1(mt,st),gt=mt.stateNode,typeof gt.componentWillUnmount=="function"))try{gt.props=mt.memoizedProps,gt.state=mt.memoizedState,gt.componentWillUnmount()}catch(Rt){W$1(mt,st,Rt)}Yj$1(nt,st,mt);break;case 21:Yj$1(nt,st,mt);break;case 22:mt.mode&1?(U$2=(gt=U$2)||mt.memoizedState!==null,Yj$1(nt,st,mt),U$2=gt):Yj$1(nt,st,mt);break;default:Yj$1(nt,st,mt)}}function ak$1(nt){var st=nt.updateQueue;if(st!==null){nt.updateQueue=null;var mt=nt.stateNode;mt===null&&(mt=nt.stateNode=new Kj$1),st.forEach(function(gt){var _t=bk$1.bind(null,nt,gt);mt.has(gt)||(mt.add(gt),gt.then(_t,_t))})}}function ck$1(nt,st){var mt=st.deletions;if(mt!==null)for(var gt=0;gt<mt.length;gt++){var _t=mt[gt];try{var Et=nt,At=st,Rt=At;e:for(;Rt!==null;){switch(Rt.tag){case 5:X$1=Rt.stateNode,Xj$1=!1;break e;case 3:X$1=Rt.stateNode.containerInfo,Xj$1=!0;break e;case 4:X$1=Rt.stateNode.containerInfo,Xj$1=!0;break e}Rt=Rt.return}if(X$1===null)throw Error(p$8(160));Zj$1(Et,At,_t),X$1=null,Xj$1=!1;var Ft=_t.alternate;Ft!==null&&(Ft.return=null),_t.return=null}catch(Nt){W$1(_t,st,Nt)}}if(st.subtreeFlags&12854)for(st=st.child;st!==null;)dk$1(st,nt),st=st.sibling}function dk$1(nt,st){var mt=nt.alternate,gt=nt.flags;switch(nt.tag){case 0:case 11:case 14:case 15:if(ck$1(st,nt),ek$1(nt),gt&4){try{Pj$1(3,nt,nt.return),Qj$1(3,nt)}catch(zr){W$1(nt,nt.return,zr)}try{Pj$1(5,nt,nt.return)}catch(zr){W$1(nt,nt.return,zr)}}break;case 1:ck$1(st,nt),ek$1(nt),gt&512&&mt!==null&&Lj$1(mt,mt.return);break;case 5:if(ck$1(st,nt),ek$1(nt),gt&512&&mt!==null&&Lj$1(mt,mt.return),nt.flags&32){var _t=nt.stateNode;try{ob$1(_t,"")}catch(zr){W$1(nt,nt.return,zr)}}if(gt&4&&(_t=nt.stateNode,_t!=null)){var Et=nt.memoizedProps,At=mt!==null?mt.memoizedProps:Et,Rt=nt.type,Ft=nt.updateQueue;if(nt.updateQueue=null,Ft!==null)try{Rt==="input"&&Et.type==="radio"&&Et.name!=null&&ab$1(_t,Et),vb$1(Rt,At);var Nt=vb$1(Rt,Et);for(At=0;At<Ft.length;At+=2){var Bt=Ft[At],Gt=Ft[At+1];Bt==="style"?sb(_t,Gt):Bt==="dangerouslySetInnerHTML"?nb$1(_t,Gt):Bt==="children"?ob$1(_t,Gt):ta$1(_t,Bt,Gt,Nt)}switch(Rt){case"input":bb$1(_t,Et);break;case"textarea":ib$1(_t,Et);break;case"select":var dr=_t._wrapperState.wasMultiple;_t._wrapperState.wasMultiple=!!Et.multiple;var Mr=Et.value;Mr!=null?fb$1(_t,!!Et.multiple,Mr,!1):dr!==!!Et.multiple&&(Et.defaultValue!=null?fb$1(_t,!!Et.multiple,Et.defaultValue,!0):fb$1(_t,!!Et.multiple,Et.multiple?[]:"",!1))}_t[Pf$1]=Et}catch(zr){W$1(nt,nt.return,zr)}}break;case 6:if(ck$1(st,nt),ek$1(nt),gt&4){if(nt.stateNode===null)throw Error(p$8(162));_t=nt.stateNode,Et=nt.memoizedProps;try{_t.nodeValue=Et}catch(zr){W$1(nt,nt.return,zr)}}break;case 3:if(ck$1(st,nt),ek$1(nt),gt&4&&mt!==null&&mt.memoizedState.isDehydrated)try{bd$1(st.containerInfo)}catch(zr){W$1(nt,nt.return,zr)}break;case 4:ck$1(st,nt),ek$1(nt);break;case 13:ck$1(st,nt),ek$1(nt),_t=nt.child,_t.flags&8192&&(Et=_t.memoizedState!==null,_t.stateNode.isHidden=Et,!Et||_t.alternate!==null&&_t.alternate.memoizedState!==null||(fk$1=B$1())),gt&4&&ak$1(nt);break;case 22:if(Bt=mt!==null&&mt.memoizedState!==null,nt.mode&1?(U$2=(Nt=U$2)||Bt,ck$1(st,nt),U$2=Nt):ck$1(st,nt),ek$1(nt),gt&8192){if(Nt=nt.memoizedState!==null,(nt.stateNode.isHidden=Nt)&&!Bt&&nt.mode&1)for(V$1=nt,Bt=nt.child;Bt!==null;){for(Gt=V$1=Bt;V$1!==null;){switch(dr=V$1,Mr=dr.child,dr.tag){case 0:case 11:case 14:case 15:Pj$1(4,dr,dr.return);break;case 1:Lj$1(dr,dr.return);var Tr=dr.stateNode;if(typeof Tr.componentWillUnmount=="function"){gt=dr,mt=dr.return;try{st=gt,Tr.props=st.memoizedProps,Tr.state=st.memoizedState,Tr.componentWillUnmount()}catch(zr){W$1(gt,mt,zr)}}break;case 5:Lj$1(dr,dr.return);break;case 22:if(dr.memoizedState!==null){gk$1(Gt);continue}}Mr!==null?(Mr.return=dr,V$1=Mr):gk$1(Gt)}Bt=Bt.sibling}e:for(Bt=null,Gt=nt;;){if(Gt.tag===5){if(Bt===null){Bt=Gt;try{_t=Gt.stateNode,Nt?(Et=_t.style,typeof Et.setProperty=="function"?Et.setProperty("display","none","important"):Et.display="none"):(Rt=Gt.stateNode,Ft=Gt.memoizedProps.style,At=Ft!=null&&Ft.hasOwnProperty("display")?Ft.display:null,Rt.style.display=rb$1("display",At))}catch(zr){W$1(nt,nt.return,zr)}}}else if(Gt.tag===6){if(Bt===null)try{Gt.stateNode.nodeValue=Nt?"":Gt.memoizedProps}catch(zr){W$1(nt,nt.return,zr)}}else if((Gt.tag!==22&&Gt.tag!==23||Gt.memoizedState===null||Gt===nt)&&Gt.child!==null){Gt.child.return=Gt,Gt=Gt.child;continue}if(Gt===nt)break e;for(;Gt.sibling===null;){if(Gt.return===null||Gt.return===nt)break e;Bt===Gt&&(Bt=null),Gt=Gt.return}Bt===Gt&&(Bt=null),Gt.sibling.return=Gt.return,Gt=Gt.sibling}}break;case 19:ck$1(st,nt),ek$1(nt),gt&4&&ak$1(nt);break;case 21:break;default:ck$1(st,nt),ek$1(nt)}}function ek$1(nt){var st=nt.flags;if(st&2){try{e:{for(var mt=nt.return;mt!==null;){if(Tj$1(mt)){var gt=mt;break e}mt=mt.return}throw Error(p$8(160))}switch(gt.tag){case 5:var _t=gt.stateNode;gt.flags&32&&(ob$1(_t,""),gt.flags&=-33);var Et=Uj$1(nt);Wj$1(nt,Et,_t);break;case 3:case 4:var At=gt.stateNode.containerInfo,Rt=Uj$1(nt);Vj$1(nt,Rt,At);break;default:throw Error(p$8(161))}}catch(Ft){W$1(nt,nt.return,Ft)}nt.flags&=-3}st&4096&&(nt.flags&=-4097)}function hk$1(nt,st,mt){V$1=nt,ik$1(nt)}function ik$1(nt,st,mt){for(var gt=(nt.mode&1)!==0;V$1!==null;){var _t=V$1,Et=_t.child;if(_t.tag===22&&gt){var At=_t.memoizedState!==null||Jj$1;if(!At){var Rt=_t.alternate,Ft=Rt!==null&&Rt.memoizedState!==null||U$2;Rt=Jj$1;var Nt=U$2;if(Jj$1=At,(U$2=Ft)&&!Nt)for(V$1=_t;V$1!==null;)At=V$1,Ft=At.child,At.tag===22&&At.memoizedState!==null?jk$1(_t):Ft!==null?(Ft.return=At,V$1=Ft):jk$1(_t);for(;Et!==null;)V$1=Et,ik$1(Et),Et=Et.sibling;V$1=_t,Jj$1=Rt,U$2=Nt}kk$1(nt)}else _t.subtreeFlags&8772&&Et!==null?(Et.return=_t,V$1=Et):kk$1(nt)}}function kk$1(nt){for(;V$1!==null;){var st=V$1;if(st.flags&8772){var mt=st.alternate;try{if(st.flags&8772)switch(st.tag){case 0:case 11:case 15:U$2||Qj$1(5,st);break;case 1:var gt=st.stateNode;if(st.flags&4&&!U$2)if(mt===null)gt.componentDidMount();else{var _t=st.elementType===st.type?mt.memoizedProps:Ci$1(st.type,mt.memoizedProps);gt.componentDidUpdate(_t,mt.memoizedState,gt.__reactInternalSnapshotBeforeUpdate)}var Et=st.updateQueue;Et!==null&&sh$1(st,Et,gt);break;case 3:var At=st.updateQueue;if(At!==null){if(mt=null,st.child!==null)switch(st.child.tag){case 5:mt=st.child.stateNode;break;case 1:mt=st.child.stateNode}sh$1(st,At,mt)}break;case 5:var Rt=st.stateNode;if(mt===null&&st.flags&4){mt=Rt;var Ft=st.memoizedProps;switch(st.type){case"button":case"input":case"select":case"textarea":Ft.autoFocus&&mt.focus();break;case"img":Ft.src&&(mt.src=Ft.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(st.memoizedState===null){var Nt=st.alternate;if(Nt!==null){var Bt=Nt.memoizedState;if(Bt!==null){var Gt=Bt.dehydrated;Gt!==null&&bd$1(Gt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$8(163))}U$2||st.flags&512&&Rj$1(st)}catch(dr){W$1(st,st.return,dr)}}if(st===nt){V$1=null;break}if(mt=st.sibling,mt!==null){mt.return=st.return,V$1=mt;break}V$1=st.return}}function gk$1(nt){for(;V$1!==null;){var st=V$1;if(st===nt){V$1=null;break}var mt=st.sibling;if(mt!==null){mt.return=st.return,V$1=mt;break}V$1=st.return}}function jk$1(nt){for(;V$1!==null;){var st=V$1;try{switch(st.tag){case 0:case 11:case 15:var mt=st.return;try{Qj$1(4,st)}catch(Ft){W$1(st,mt,Ft)}break;case 1:var gt=st.stateNode;if(typeof gt.componentDidMount=="function"){var _t=st.return;try{gt.componentDidMount()}catch(Ft){W$1(st,_t,Ft)}}var Et=st.return;try{Rj$1(st)}catch(Ft){W$1(st,Et,Ft)}break;case 5:var At=st.return;try{Rj$1(st)}catch(Ft){W$1(st,At,Ft)}}}catch(Ft){W$1(st,st.return,Ft)}if(st===nt){V$1=null;break}var Rt=st.sibling;if(Rt!==null){Rt.return=st.return,V$1=Rt;break}V$1=st.return}}var lk$1=Math.ceil,mk$1=ua$1.ReactCurrentDispatcher,nk$1=ua$1.ReactCurrentOwner,ok$1=ua$1.ReactCurrentBatchConfig,K$2=0,Q$1=null,Y$1=null,Z$2=0,fj$1=0,ej$1=Uf$1(0),T$2=0,pk$1=null,rh$1=0,qk$1=0,rk$1=0,sk$1=null,tk$1=null,fk$1=0,Gj$1=1/0,uk$1=null,Oi$1=!1,Pi$1=null,Ri$1=null,vk$1=!1,wk$1=null,xk$1=0,yk$1=0,zk$1=null,Ak$1=-1,Bk$1=0;function R$1(){return K$2&6?B$1():Ak$1!==-1?Ak$1:Ak$1=B$1()}function yi$1(nt){return nt.mode&1?K$2&2&&Z$2!==0?Z$2&-Z$2:Kg$1.transition!==null?(Bk$1===0&&(Bk$1=yc$1()),Bk$1):(nt=C$6,nt!==0||(nt=window.event,nt=nt===void 0?16:jd$1(nt.type)),nt):1}function gi$1(nt,st,mt,gt){if(50<yk$1)throw yk$1=0,zk$1=null,Error(p$8(185));Ac$1(nt,mt,gt),(!(K$2&2)||nt!==Q$1)&&(nt===Q$1&&(!(K$2&2)&&(qk$1|=mt),T$2===4&&Ck$1(nt,Z$2)),Dk$1(nt,gt),mt===1&&K$2===0&&!(st.mode&1)&&(Gj$1=B$1()+500,fg$1&&jg$1()))}function Dk$1(nt,st){var mt=nt.callbackNode;wc$1(nt,st);var gt=uc$1(nt,nt===Q$1?Z$2:0);if(gt===0)mt!==null&&bc$1(mt),nt.callbackNode=null,nt.callbackPriority=0;else if(st=gt&-gt,nt.callbackPriority!==st){if(mt!=null&&bc$1(mt),st===1)nt.tag===0?ig$1(Ek$1.bind(null,nt)):hg$1(Ek$1.bind(null,nt)),Jf$1(function(){!(K$2&6)&&jg$1()}),mt=null;else{switch(Dc$1(gt)){case 1:mt=fc$1;break;case 4:mt=gc$1;break;case 16:mt=hc$1;break;case 536870912:mt=jc$1;break;default:mt=hc$1}mt=Fk$1(mt,Gk$1.bind(null,nt))}nt.callbackPriority=st,nt.callbackNode=mt}}function Gk$1(nt,st){if(Ak$1=-1,Bk$1=0,K$2&6)throw Error(p$8(327));var mt=nt.callbackNode;if(Hk$1()&&nt.callbackNode!==mt)return null;var gt=uc$1(nt,nt===Q$1?Z$2:0);if(gt===0)return null;if(gt&30||gt&nt.expiredLanes||st)st=Ik$1(nt,gt);else{st=gt;var _t=K$2;K$2|=2;var Et=Jk$1();(Q$1!==nt||Z$2!==st)&&(uk$1=null,Gj$1=B$1()+500,Kk$1(nt,st));do try{Lk$1();break}catch(Rt){Mk$1(nt,Rt)}while(!0);$g$1(),mk$1.current=Et,K$2=_t,Y$1!==null?st=0:(Q$1=null,Z$2=0,st=T$2)}if(st!==0){if(st===2&&(_t=xc$1(nt),_t!==0&&(gt=_t,st=Nk$1(nt,_t))),st===1)throw mt=pk$1,Kk$1(nt,0),Ck$1(nt,gt),Dk$1(nt,B$1()),mt;if(st===6)Ck$1(nt,gt);else{if(_t=nt.current.alternate,!(gt&30)&&!Ok$1(_t)&&(st=Ik$1(nt,gt),st===2&&(Et=xc$1(nt),Et!==0&&(gt=Et,st=Nk$1(nt,Et))),st===1))throw mt=pk$1,Kk$1(nt,0),Ck$1(nt,gt),Dk$1(nt,B$1()),mt;switch(nt.finishedWork=_t,nt.finishedLanes=gt,st){case 0:case 1:throw Error(p$8(345));case 2:Pk$1(nt,tk$1,uk$1);break;case 3:if(Ck$1(nt,gt),(gt&130023424)===gt&&(st=fk$1+500-B$1(),10<st)){if(uc$1(nt,0)!==0)break;if(_t=nt.suspendedLanes,(_t&gt)!==gt){R$1(),nt.pingedLanes|=nt.suspendedLanes&_t;break}nt.timeoutHandle=Ff$1(Pk$1.bind(null,nt,tk$1,uk$1),st);break}Pk$1(nt,tk$1,uk$1);break;case 4:if(Ck$1(nt,gt),(gt&4194240)===gt)break;for(st=nt.eventTimes,_t=-1;0<gt;){var At=31-oc$1(gt);Et=1<<At,At=st[At],At>_t&&(_t=At),gt&=~Et}if(gt=_t,gt=B$1()-gt,gt=(120>gt?120:480>gt?480:1080>gt?1080:1920>gt?1920:3e3>gt?3e3:4320>gt?4320:1960*lk$1(gt/1960))-gt,10<gt){nt.timeoutHandle=Ff$1(Pk$1.bind(null,nt,tk$1,uk$1),gt);break}Pk$1(nt,tk$1,uk$1);break;case 5:Pk$1(nt,tk$1,uk$1);break;default:throw Error(p$8(329))}}}return Dk$1(nt,B$1()),nt.callbackNode===mt?Gk$1.bind(null,nt):null}function Nk$1(nt,st){var mt=sk$1;return nt.current.memoizedState.isDehydrated&&(Kk$1(nt,st).flags|=256),nt=Ik$1(nt,st),nt!==2&&(st=tk$1,tk$1=mt,st!==null&&Fj$1(st)),nt}function Fj$1(nt){tk$1===null?tk$1=nt:tk$1.push.apply(tk$1,nt)}function Ok$1(nt){for(var st=nt;;){if(st.flags&16384){var mt=st.updateQueue;if(mt!==null&&(mt=mt.stores,mt!==null))for(var gt=0;gt<mt.length;gt++){var _t=mt[gt],Et=_t.getSnapshot;_t=_t.value;try{if(!He$1(Et(),_t))return!1}catch{return!1}}}if(mt=st.child,st.subtreeFlags&16384&&mt!==null)mt.return=st,st=mt;else{if(st===nt)break;for(;st.sibling===null;){if(st.return===null||st.return===nt)return!0;st=st.return}st.sibling.return=st.return,st=st.sibling}}return!0}function Ck$1(nt,st){for(st&=~rk$1,st&=~qk$1,nt.suspendedLanes|=st,nt.pingedLanes&=~st,nt=nt.expirationTimes;0<st;){var mt=31-oc$1(st),gt=1<<mt;nt[mt]=-1,st&=~gt}}function Ek$1(nt){if(K$2&6)throw Error(p$8(327));Hk$1();var st=uc$1(nt,0);if(!(st&1))return Dk$1(nt,B$1()),null;var mt=Ik$1(nt,st);if(nt.tag!==0&&mt===2){var gt=xc$1(nt);gt!==0&&(st=gt,mt=Nk$1(nt,gt))}if(mt===1)throw mt=pk$1,Kk$1(nt,0),Ck$1(nt,st),Dk$1(nt,B$1()),mt;if(mt===6)throw Error(p$8(345));return nt.finishedWork=nt.current.alternate,nt.finishedLanes=st,Pk$1(nt,tk$1,uk$1),Dk$1(nt,B$1()),null}function Qk$1(nt,st){var mt=K$2;K$2|=1;try{return nt(st)}finally{K$2=mt,K$2===0&&(Gj$1=B$1()+500,fg$1&&jg$1())}}function Rk$1(nt){wk$1!==null&&wk$1.tag===0&&!(K$2&6)&&Hk$1();var st=K$2;K$2|=1;var mt=ok$1.transition,gt=C$6;try{if(ok$1.transition=null,C$6=1,nt)return nt()}finally{C$6=gt,ok$1.transition=mt,K$2=st,!(K$2&6)&&jg$1()}}function Hj$1(){fj$1=ej$1.current,E$7(ej$1)}function Kk$1(nt,st){nt.finishedWork=null,nt.finishedLanes=0;var mt=nt.timeoutHandle;if(mt!==-1&&(nt.timeoutHandle=-1,Gf(mt)),Y$1!==null)for(mt=Y$1.return;mt!==null;){var gt=mt;switch(wg$1(gt),gt.tag){case 1:gt=gt.type.childContextTypes,gt!=null&&$f$1();break;case 3:zh$1(),E$7(Wf$1),E$7(H$1),Eh$1();break;case 5:Bh$1(gt);break;case 4:zh$1();break;case 13:E$7(L$2);break;case 19:E$7(L$2);break;case 10:ah$1(gt.type._context);break;case 22:case 23:Hj$1()}mt=mt.return}if(Q$1=nt,Y$1=nt=Pg$1(nt.current,null),Z$2=fj$1=st,T$2=0,pk$1=null,rk$1=qk$1=rh$1=0,tk$1=sk$1=null,fh$1!==null){for(st=0;st<fh$1.length;st++)if(mt=fh$1[st],gt=mt.interleaved,gt!==null){mt.interleaved=null;var _t=gt.next,Et=mt.pending;if(Et!==null){var At=Et.next;Et.next=_t,gt.next=At}mt.pending=gt}fh$1=null}return nt}function Mk$1(nt,st){do{var mt=Y$1;try{if($g$1(),Fh$1.current=Rh$1,Ih$1){for(var gt=M$5.memoizedState;gt!==null;){var _t=gt.queue;_t!==null&&(_t.pending=null),gt=gt.next}Ih$1=!1}if(Hh$1=0,O$1=N$1=M$5=null,Jh$1=!1,Kh$1=0,nk$1.current=null,mt===null||mt.return===null){T$2=1,pk$1=st,Y$1=null;break}e:{var Et=nt,At=mt.return,Rt=mt,Ft=st;if(st=Z$2,Rt.flags|=32768,Ft!==null&&typeof Ft=="object"&&typeof Ft.then=="function"){var Nt=Ft,Bt=Rt,Gt=Bt.tag;if(!(Bt.mode&1)&&(Gt===0||Gt===11||Gt===15)){var dr=Bt.alternate;dr?(Bt.updateQueue=dr.updateQueue,Bt.memoizedState=dr.memoizedState,Bt.lanes=dr.lanes):(Bt.updateQueue=null,Bt.memoizedState=null)}var Mr=Ui$1(At);if(Mr!==null){Mr.flags&=-257,Vi$1(Mr,At,Rt,Et,st),Mr.mode&1&&Si(Et,Nt,st),st=Mr,Ft=Nt;var Tr=st.updateQueue;if(Tr===null){var zr=new Set;zr.add(Ft),st.updateQueue=zr}else Tr.add(Ft);break e}else{if(!(st&1)){Si(Et,Nt,st),tj$1();break e}Ft=Error(p$8(426))}}else if(I$5&&Rt.mode&1){var Fr=Ui$1(At);if(Fr!==null){!(Fr.flags&65536)&&(Fr.flags|=256),Vi$1(Fr,At,Rt,Et,st),Jg$1(Ji$1(Ft,Rt));break e}}Et=Ft=Ji$1(Ft,Rt),T$2!==4&&(T$2=2),sk$1===null?sk$1=[Et]:sk$1.push(Et),Et=At;do{switch(Et.tag){case 3:Et.flags|=65536,st&=-st,Et.lanes|=st;var Nr=Ni$1(Et,Ft,st);ph$1(Et,Nr);break e;case 1:Rt=Ft;var tn=Et.type,rn=Et.stateNode;if(!(Et.flags&128)&&(typeof tn.getDerivedStateFromError=="function"||rn!==null&&typeof rn.componentDidCatch=="function"&&(Ri$1===null||!Ri$1.has(rn)))){Et.flags|=65536,st&=-st,Et.lanes|=st;var Tn=Qi$1(Et,Rt,st);ph$1(Et,Tn);break e}}Et=Et.return}while(Et!==null)}Sk$1(mt)}catch($n){st=$n,Y$1===mt&&mt!==null&&(Y$1=mt=mt.return);continue}break}while(!0)}function Jk$1(){var nt=mk$1.current;return mk$1.current=Rh$1,nt===null?Rh$1:nt}function tj$1(){(T$2===0||T$2===3||T$2===2)&&(T$2=4),Q$1===null||!(rh$1&268435455)&&!(qk$1&268435455)||Ck$1(Q$1,Z$2)}function Ik$1(nt,st){var mt=K$2;K$2|=2;var gt=Jk$1();(Q$1!==nt||Z$2!==st)&&(uk$1=null,Kk$1(nt,st));do try{Tk$1();break}catch(_t){Mk$1(nt,_t)}while(!0);if($g$1(),K$2=mt,mk$1.current=gt,Y$1!==null)throw Error(p$8(261));return Q$1=null,Z$2=0,T$2}function Tk$1(){for(;Y$1!==null;)Uk$1(Y$1)}function Lk$1(){for(;Y$1!==null&&!cc$1();)Uk$1(Y$1)}function Uk$1(nt){var st=Vk$1(nt.alternate,nt,fj$1);nt.memoizedProps=nt.pendingProps,st===null?Sk$1(nt):Y$1=st,nk$1.current=null}function Sk$1(nt){var st=nt;do{var mt=st.alternate;if(nt=st.return,st.flags&32768){if(mt=Ij$1(mt,st),mt!==null){mt.flags&=32767,Y$1=mt;return}if(nt!==null)nt.flags|=32768,nt.subtreeFlags=0,nt.deletions=null;else{T$2=6,Y$1=null;return}}else if(mt=Ej$1(mt,st,fj$1),mt!==null){Y$1=mt;return}if(st=st.sibling,st!==null){Y$1=st;return}Y$1=st=nt}while(st!==null);T$2===0&&(T$2=5)}function Pk$1(nt,st,mt){var gt=C$6,_t=ok$1.transition;try{ok$1.transition=null,C$6=1,Wk$1(nt,st,mt,gt)}finally{ok$1.transition=_t,C$6=gt}return null}function Wk$1(nt,st,mt,gt){do Hk$1();while(wk$1!==null);if(K$2&6)throw Error(p$8(327));mt=nt.finishedWork;var _t=nt.finishedLanes;if(mt===null)return null;if(nt.finishedWork=null,nt.finishedLanes=0,mt===nt.current)throw Error(p$8(177));nt.callbackNode=null,nt.callbackPriority=0;var Et=mt.lanes|mt.childLanes;if(Bc$1(nt,Et),nt===Q$1&&(Y$1=Q$1=null,Z$2=0),!(mt.subtreeFlags&2064)&&!(mt.flags&2064)||vk$1||(vk$1=!0,Fk$1(hc$1,function(){return Hk$1(),null})),Et=(mt.flags&15990)!==0,mt.subtreeFlags&15990||Et){Et=ok$1.transition,ok$1.transition=null;var At=C$6;C$6=1;var Rt=K$2;K$2|=4,nk$1.current=null,Oj$1(nt,mt),dk$1(mt,nt),Oe$1(Df$1),dd$1=!!Cf$1,Df$1=Cf$1=null,nt.current=mt,hk$1(mt),dc$1(),K$2=Rt,C$6=At,ok$1.transition=Et}else nt.current=mt;if(vk$1&&(vk$1=!1,wk$1=nt,xk$1=_t),Et=nt.pendingLanes,Et===0&&(Ri$1=null),mc$1(mt.stateNode),Dk$1(nt,B$1()),st!==null)for(gt=nt.onRecoverableError,mt=0;mt<st.length;mt++)_t=st[mt],gt(_t.value,{componentStack:_t.stack,digest:_t.digest});if(Oi$1)throw Oi$1=!1,nt=Pi$1,Pi$1=null,nt;return xk$1&1&&nt.tag!==0&&Hk$1(),Et=nt.pendingLanes,Et&1?nt===zk$1?yk$1++:(yk$1=0,zk$1=nt):yk$1=0,jg$1(),null}function Hk$1(){if(wk$1!==null){var nt=Dc$1(xk$1),st=ok$1.transition,mt=C$6;try{if(ok$1.transition=null,C$6=16>nt?16:nt,wk$1===null)var gt=!1;else{if(nt=wk$1,wk$1=null,xk$1=0,K$2&6)throw Error(p$8(331));var _t=K$2;for(K$2|=4,V$1=nt.current;V$1!==null;){var Et=V$1,At=Et.child;if(V$1.flags&16){var Rt=Et.deletions;if(Rt!==null){for(var Ft=0;Ft<Rt.length;Ft++){var Nt=Rt[Ft];for(V$1=Nt;V$1!==null;){var Bt=V$1;switch(Bt.tag){case 0:case 11:case 15:Pj$1(8,Bt,Et)}var Gt=Bt.child;if(Gt!==null)Gt.return=Bt,V$1=Gt;else for(;V$1!==null;){Bt=V$1;var dr=Bt.sibling,Mr=Bt.return;if(Sj$1(Bt),Bt===Nt){V$1=null;break}if(dr!==null){dr.return=Mr,V$1=dr;break}V$1=Mr}}}var Tr=Et.alternate;if(Tr!==null){var zr=Tr.child;if(zr!==null){Tr.child=null;do{var Fr=zr.sibling;zr.sibling=null,zr=Fr}while(zr!==null)}}V$1=Et}}if(Et.subtreeFlags&2064&&At!==null)At.return=Et,V$1=At;else e:for(;V$1!==null;){if(Et=V$1,Et.flags&2048)switch(Et.tag){case 0:case 11:case 15:Pj$1(9,Et,Et.return)}var Nr=Et.sibling;if(Nr!==null){Nr.return=Et.return,V$1=Nr;break e}V$1=Et.return}}var tn=nt.current;for(V$1=tn;V$1!==null;){At=V$1;var rn=At.child;if(At.subtreeFlags&2064&&rn!==null)rn.return=At,V$1=rn;else e:for(At=tn;V$1!==null;){if(Rt=V$1,Rt.flags&2048)try{switch(Rt.tag){case 0:case 11:case 15:Qj$1(9,Rt)}}catch($n){W$1(Rt,Rt.return,$n)}if(Rt===At){V$1=null;break e}var Tn=Rt.sibling;if(Tn!==null){Tn.return=Rt.return,V$1=Tn;break e}V$1=Rt.return}}if(K$2=_t,jg$1(),lc$1&&typeof lc$1.onPostCommitFiberRoot=="function")try{lc$1.onPostCommitFiberRoot(kc$1,nt)}catch{}gt=!0}return gt}finally{C$6=mt,ok$1.transition=st}}return!1}function Xk$1(nt,st,mt){st=Ji$1(mt,st),st=Ni$1(nt,st,1),nt=nh$1(nt,st,1),st=R$1(),nt!==null&&(Ac$1(nt,1,st),Dk$1(nt,st))}function W$1(nt,st,mt){if(nt.tag===3)Xk$1(nt,nt,mt);else for(;st!==null;){if(st.tag===3){Xk$1(st,nt,mt);break}else if(st.tag===1){var gt=st.stateNode;if(typeof st.type.getDerivedStateFromError=="function"||typeof gt.componentDidCatch=="function"&&(Ri$1===null||!Ri$1.has(gt))){nt=Ji$1(mt,nt),nt=Qi$1(st,nt,1),st=nh$1(st,nt,1),nt=R$1(),st!==null&&(Ac$1(st,1,nt),Dk$1(st,nt));break}}st=st.return}}function Ti$1(nt,st,mt){var gt=nt.pingCache;gt!==null&&gt.delete(st),st=R$1(),nt.pingedLanes|=nt.suspendedLanes&mt,Q$1===nt&&(Z$2&mt)===mt&&(T$2===4||T$2===3&&(Z$2&130023424)===Z$2&&500>B$1()-fk$1?Kk$1(nt,0):rk$1|=mt),Dk$1(nt,st)}function Yk$1(nt,st){st===0&&(nt.mode&1?(st=sc$1,sc$1<<=1,!(sc$1&130023424)&&(sc$1=4194304)):st=1);var mt=R$1();nt=ih$1(nt,st),nt!==null&&(Ac$1(nt,st,mt),Dk$1(nt,mt))}function uj$1(nt){var st=nt.memoizedState,mt=0;st!==null&&(mt=st.retryLane),Yk$1(nt,mt)}function bk$1(nt,st){var mt=0;switch(nt.tag){case 13:var gt=nt.stateNode,_t=nt.memoizedState;_t!==null&&(mt=_t.retryLane);break;case 19:gt=nt.stateNode;break;default:throw Error(p$8(314))}gt!==null&&gt.delete(st),Yk$1(nt,mt)}var Vk$1;Vk$1=function(nt,st,mt){if(nt!==null)if(nt.memoizedProps!==st.pendingProps||Wf$1.current)dh$1=!0;else{if(!(nt.lanes&mt)&&!(st.flags&128))return dh$1=!1,yj$1(nt,st,mt);dh$1=!!(nt.flags&131072)}else dh$1=!1,I$5&&st.flags&1048576&&ug$1(st,ng$1,st.index);switch(st.lanes=0,st.tag){case 2:var gt=st.type;ij$1(nt,st),nt=st.pendingProps;var _t=Yf$1(st,H$1.current);ch$1(st,mt),_t=Nh$1(null,st,gt,nt,_t,mt);var Et=Sh$1();return st.flags|=1,typeof _t=="object"&&_t!==null&&typeof _t.render=="function"&&_t.$$typeof===void 0?(st.tag=1,st.memoizedState=null,st.updateQueue=null,Zf$1(gt)?(Et=!0,cg$1(st)):Et=!1,st.memoizedState=_t.state!==null&&_t.state!==void 0?_t.state:null,kh$1(st),_t.updater=Ei$1,st.stateNode=_t,_t._reactInternals=st,Ii$1(st,gt,nt,mt),st=jj$1(null,st,gt,!0,Et,mt)):(st.tag=0,I$5&&Et&&vg$1(st),Xi$1(null,st,_t,mt),st=st.child),st;case 16:gt=st.elementType;e:{switch(ij$1(nt,st),nt=st.pendingProps,_t=gt._init,gt=_t(gt._payload),st.type=gt,_t=st.tag=Zk$1(gt),nt=Ci$1(gt,nt),_t){case 0:st=cj$1(null,st,gt,nt,mt);break e;case 1:st=hj$1(null,st,gt,nt,mt);break e;case 11:st=Yi$1(null,st,gt,nt,mt);break e;case 14:st=$i$1(null,st,gt,Ci$1(gt.type,nt),mt);break e}throw Error(p$8(306,gt,""))}return st;case 0:return gt=st.type,_t=st.pendingProps,_t=st.elementType===gt?_t:Ci$1(gt,_t),cj$1(nt,st,gt,_t,mt);case 1:return gt=st.type,_t=st.pendingProps,_t=st.elementType===gt?_t:Ci$1(gt,_t),hj$1(nt,st,gt,_t,mt);case 3:e:{if(kj$1(st),nt===null)throw Error(p$8(387));gt=st.pendingProps,Et=st.memoizedState,_t=Et.element,lh$1(nt,st),qh$1(st,gt,null,mt);var At=st.memoizedState;if(gt=At.element,Et.isDehydrated)if(Et={element:gt,isDehydrated:!1,cache:At.cache,pendingSuspenseBoundaries:At.pendingSuspenseBoundaries,transitions:At.transitions},st.updateQueue.baseState=Et,st.memoizedState=Et,st.flags&256){_t=Ji$1(Error(p$8(423)),st),st=lj$1(nt,st,gt,mt,_t);break e}else if(gt!==_t){_t=Ji$1(Error(p$8(424)),st),st=lj$1(nt,st,gt,mt,_t);break e}else for(yg=Lf$1(st.stateNode.containerInfo.firstChild),xg$1=st,I$5=!0,zg$1=null,mt=Vg$1(st,null,gt,mt),st.child=mt;mt;)mt.flags=mt.flags&-3|4096,mt=mt.sibling;else{if(Ig$1(),gt===_t){st=Zi$1(nt,st,mt);break e}Xi$1(nt,st,gt,mt)}st=st.child}return st;case 5:return Ah$1(st),nt===null&&Eg$1(st),gt=st.type,_t=st.pendingProps,Et=nt!==null?nt.memoizedProps:null,At=_t.children,Ef$1(gt,_t)?At=null:Et!==null&&Ef$1(gt,Et)&&(st.flags|=32),gj$1(nt,st),Xi$1(nt,st,At,mt),st.child;case 6:return nt===null&&Eg$1(st),null;case 13:return oj$1(nt,st,mt);case 4:return yh$1(st,st.stateNode.containerInfo),gt=st.pendingProps,nt===null?st.child=Ug$1(st,null,gt,mt):Xi$1(nt,st,gt,mt),st.child;case 11:return gt=st.type,_t=st.pendingProps,_t=st.elementType===gt?_t:Ci$1(gt,_t),Yi$1(nt,st,gt,_t,mt);case 7:return Xi$1(nt,st,st.pendingProps,mt),st.child;case 8:return Xi$1(nt,st,st.pendingProps.children,mt),st.child;case 12:return Xi$1(nt,st,st.pendingProps.children,mt),st.child;case 10:e:{if(gt=st.type._context,_t=st.pendingProps,Et=st.memoizedProps,At=_t.value,G$1(Wg$1,gt._currentValue),gt._currentValue=At,Et!==null)if(He$1(Et.value,At)){if(Et.children===_t.children&&!Wf$1.current){st=Zi$1(nt,st,mt);break e}}else for(Et=st.child,Et!==null&&(Et.return=st);Et!==null;){var Rt=Et.dependencies;if(Rt!==null){At=Et.child;for(var Ft=Rt.firstContext;Ft!==null;){if(Ft.context===gt){if(Et.tag===1){Ft=mh$1(-1,mt&-mt),Ft.tag=2;var Nt=Et.updateQueue;if(Nt!==null){Nt=Nt.shared;var Bt=Nt.pending;Bt===null?Ft.next=Ft:(Ft.next=Bt.next,Bt.next=Ft),Nt.pending=Ft}}Et.lanes|=mt,Ft=Et.alternate,Ft!==null&&(Ft.lanes|=mt),bh$1(Et.return,mt,st),Rt.lanes|=mt;break}Ft=Ft.next}}else if(Et.tag===10)At=Et.type===st.type?null:Et.child;else if(Et.tag===18){if(At=Et.return,At===null)throw Error(p$8(341));At.lanes|=mt,Rt=At.alternate,Rt!==null&&(Rt.lanes|=mt),bh$1(At,mt,st),At=Et.sibling}else At=Et.child;if(At!==null)At.return=Et;else for(At=Et;At!==null;){if(At===st){At=null;break}if(Et=At.sibling,Et!==null){Et.return=At.return,At=Et;break}At=At.return}Et=At}Xi$1(nt,st,_t.children,mt),st=st.child}return st;case 9:return _t=st.type,gt=st.pendingProps.children,ch$1(st,mt),_t=eh$1(_t),gt=gt(_t),st.flags|=1,Xi$1(nt,st,gt,mt),st.child;case 14:return gt=st.type,_t=Ci$1(gt,st.pendingProps),_t=Ci$1(gt.type,_t),$i$1(nt,st,gt,_t,mt);case 15:return bj$1(nt,st,st.type,st.pendingProps,mt);case 17:return gt=st.type,_t=st.pendingProps,_t=st.elementType===gt?_t:Ci$1(gt,_t),ij$1(nt,st),st.tag=1,Zf$1(gt)?(nt=!0,cg$1(st)):nt=!1,ch$1(st,mt),Gi$1(st,gt,_t),Ii$1(st,gt,_t,mt),jj$1(null,st,gt,!0,nt,mt);case 19:return xj$1(nt,st,mt);case 22:return dj$1(nt,st,mt)}throw Error(p$8(156,st.tag))};function Fk$1(nt,st){return ac$1(nt,st)}function $k$1(nt,st,mt,gt){this.tag=nt,this.key=mt,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=st,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=gt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg$1(nt,st,mt,gt){return new $k$1(nt,st,mt,gt)}function aj$1(nt){return nt=nt.prototype,!(!nt||!nt.isReactComponent)}function Zk$1(nt){if(typeof nt=="function")return aj$1(nt)?1:0;if(nt!=null){if(nt=nt.$$typeof,nt===Da$1)return 11;if(nt===Ga$1)return 14}return 2}function Pg$1(nt,st){var mt=nt.alternate;return mt===null?(mt=Bg$1(nt.tag,st,nt.key,nt.mode),mt.elementType=nt.elementType,mt.type=nt.type,mt.stateNode=nt.stateNode,mt.alternate=nt,nt.alternate=mt):(mt.pendingProps=st,mt.type=nt.type,mt.flags=0,mt.subtreeFlags=0,mt.deletions=null),mt.flags=nt.flags&14680064,mt.childLanes=nt.childLanes,mt.lanes=nt.lanes,mt.child=nt.child,mt.memoizedProps=nt.memoizedProps,mt.memoizedState=nt.memoizedState,mt.updateQueue=nt.updateQueue,st=nt.dependencies,mt.dependencies=st===null?null:{lanes:st.lanes,firstContext:st.firstContext},mt.sibling=nt.sibling,mt.index=nt.index,mt.ref=nt.ref,mt}function Rg$1(nt,st,mt,gt,_t,Et){var At=2;if(gt=nt,typeof nt=="function")aj$1(nt)&&(At=1);else if(typeof nt=="string")At=5;else e:switch(nt){case ya$1:return Tg$1(mt.children,_t,Et,st);case za$1:At=8,_t|=8;break;case Aa$1:return nt=Bg$1(12,mt,st,_t|2),nt.elementType=Aa$1,nt.lanes=Et,nt;case Ea$1:return nt=Bg$1(13,mt,st,_t),nt.elementType=Ea$1,nt.lanes=Et,nt;case Fa$1:return nt=Bg$1(19,mt,st,_t),nt.elementType=Fa$1,nt.lanes=Et,nt;case Ia$1:return pj$1(mt,_t,Et,st);default:if(typeof nt=="object"&&nt!==null)switch(nt.$$typeof){case Ba$1:At=10;break e;case Ca$1:At=9;break e;case Da$1:At=11;break e;case Ga$1:At=14;break e;case Ha$1:At=16,gt=null;break e}throw Error(p$8(130,nt==null?nt:typeof nt,""))}return st=Bg$1(At,mt,st,_t),st.elementType=nt,st.type=gt,st.lanes=Et,st}function Tg$1(nt,st,mt,gt){return nt=Bg$1(7,nt,gt,st),nt.lanes=mt,nt}function pj$1(nt,st,mt,gt){return nt=Bg$1(22,nt,gt,st),nt.elementType=Ia$1,nt.lanes=mt,nt.stateNode={isHidden:!1},nt}function Qg$1(nt,st,mt){return nt=Bg$1(6,nt,null,st),nt.lanes=mt,nt}function Sg$1(nt,st,mt){return st=Bg$1(4,nt.children!==null?nt.children:[],nt.key,st),st.lanes=mt,st.stateNode={containerInfo:nt.containerInfo,pendingChildren:null,implementation:nt.implementation},st}function al$1(nt,st,mt,gt,_t){this.tag=st,this.containerInfo=nt,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc$1(0),this.expirationTimes=zc$1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc$1(0),this.identifierPrefix=gt,this.onRecoverableError=_t,this.mutableSourceEagerHydrationData=null}function bl$1(nt,st,mt,gt,_t,Et,At,Rt,Ft){return nt=new al$1(nt,st,mt,Rt,Ft),st===1?(st=1,Et===!0&&(st|=8)):st=0,Et=Bg$1(3,null,null,st),nt.current=Et,Et.stateNode=nt,Et.memoizedState={element:gt,isDehydrated:mt,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh$1(Et),nt}function cl$1(nt,st,mt){var gt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa$1,key:gt==null?null:""+gt,children:nt,containerInfo:st,implementation:mt}}function dl$1(nt){if(!nt)return Vf$1;nt=nt._reactInternals;e:{if(Vb$1(nt)!==nt||nt.tag!==1)throw Error(p$8(170));var st=nt;do{switch(st.tag){case 3:st=st.stateNode.context;break e;case 1:if(Zf$1(st.type)){st=st.stateNode.__reactInternalMemoizedMergedChildContext;break e}}st=st.return}while(st!==null);throw Error(p$8(171))}if(nt.tag===1){var mt=nt.type;if(Zf$1(mt))return bg$1(nt,mt,st)}return st}function el$1(nt,st,mt,gt,_t,Et,At,Rt,Ft){return nt=bl$1(mt,gt,!0,nt,_t,Et,At,Rt,Ft),nt.context=dl$1(null),mt=nt.current,gt=R$1(),_t=yi$1(mt),Et=mh$1(gt,_t),Et.callback=st??null,nh$1(mt,Et,_t),nt.current.lanes=_t,Ac$1(nt,_t,gt),Dk$1(nt,gt),nt}function fl$1(nt,st,mt,gt){var _t=st.current,Et=R$1(),At=yi$1(_t);return mt=dl$1(mt),st.context===null?st.context=mt:st.pendingContext=mt,st=mh$1(Et,At),st.payload={element:nt},gt=gt===void 0?null:gt,gt!==null&&(st.callback=gt),nt=nh$1(_t,st,At),nt!==null&&(gi$1(nt,_t,At,Et),oh$1(nt,_t,At)),At}function gl$1(nt){if(nt=nt.current,!nt.child)return null;switch(nt.child.tag){case 5:return nt.child.stateNode;default:return nt.child.stateNode}}function hl$1(nt,st){if(nt=nt.memoizedState,nt!==null&&nt.dehydrated!==null){var mt=nt.retryLane;nt.retryLane=mt!==0&&mt<st?mt:st}}function il$1(nt,st){hl$1(nt,st),(nt=nt.alternate)&&hl$1(nt,st)}function jl$1(){return null}var kl$1=typeof reportError=="function"?reportError:function(nt){console.error(nt)};function ll$1(nt){this._internalRoot=nt}ml$1.prototype.render=ll$1.prototype.render=function(nt){var st=this._internalRoot;if(st===null)throw Error(p$8(409));fl$1(nt,st,null,null)};ml$1.prototype.unmount=ll$1.prototype.unmount=function(){var nt=this._internalRoot;if(nt!==null){this._internalRoot=null;var st=nt.containerInfo;Rk$1(function(){fl$1(null,nt,null,null)}),st[uf$1]=null}};function ml$1(nt){this._internalRoot=nt}ml$1.prototype.unstable_scheduleHydration=function(nt){if(nt){var st=Hc();nt={blockedOn:null,target:nt,priority:st};for(var mt=0;mt<Qc$1.length&&st!==0&&st<Qc$1[mt].priority;mt++);Qc$1.splice(mt,0,nt),mt===0&&Vc$1(nt)}};function nl$1(nt){return!(!nt||nt.nodeType!==1&&nt.nodeType!==9&&nt.nodeType!==11)}function ol$1(nt){return!(!nt||nt.nodeType!==1&&nt.nodeType!==9&&nt.nodeType!==11&&(nt.nodeType!==8||nt.nodeValue!==" react-mount-point-unstable "))}function pl$1(){}function ql$1(nt,st,mt,gt,_t){if(_t){if(typeof gt=="function"){var Et=gt;gt=function(){var Nt=gl$1(At);Et.call(Nt)}}var At=el$1(st,gt,nt,0,null,!1,!1,"",pl$1);return nt._reactRootContainer=At,nt[uf$1]=At.current,sf$1(nt.nodeType===8?nt.parentNode:nt),Rk$1(),At}for(;_t=nt.lastChild;)nt.removeChild(_t);if(typeof gt=="function"){var Rt=gt;gt=function(){var Nt=gl$1(Ft);Rt.call(Nt)}}var Ft=bl$1(nt,0,!1,null,null,!1,!1,"",pl$1);return nt._reactRootContainer=Ft,nt[uf$1]=Ft.current,sf$1(nt.nodeType===8?nt.parentNode:nt),Rk$1(function(){fl$1(st,Ft,mt,gt)}),Ft}function rl$1(nt,st,mt,gt,_t){var Et=mt._reactRootContainer;if(Et){var At=Et;if(typeof _t=="function"){var Rt=_t;_t=function(){var Ft=gl$1(At);Rt.call(Ft)}}fl$1(st,At,nt,_t)}else At=ql$1(mt,st,nt,_t,gt);return gl$1(At)}Ec$1=function(nt){switch(nt.tag){case 3:var st=nt.stateNode;if(st.current.memoizedState.isDehydrated){var mt=tc$1(st.pendingLanes);mt!==0&&(Cc$1(st,mt|1),Dk$1(st,B$1()),!(K$2&6)&&(Gj$1=B$1()+500,jg$1()))}break;case 13:Rk$1(function(){var gt=ih$1(nt,1);if(gt!==null){var _t=R$1();gi$1(gt,nt,1,_t)}}),il$1(nt,1)}};Fc$1=function(nt){if(nt.tag===13){var st=ih$1(nt,134217728);if(st!==null){var mt=R$1();gi$1(st,nt,134217728,mt)}il$1(nt,134217728)}};Gc$1=function(nt){if(nt.tag===13){var st=yi$1(nt),mt=ih$1(nt,st);if(mt!==null){var gt=R$1();gi$1(mt,nt,st,gt)}il$1(nt,st)}};Hc=function(){return C$6};Ic$1=function(nt,st){var mt=C$6;try{return C$6=nt,st()}finally{C$6=mt}};yb$1=function(nt,st,mt){switch(st){case"input":if(bb$1(nt,mt),st=mt.name,mt.type==="radio"&&st!=null){for(mt=nt;mt.parentNode;)mt=mt.parentNode;for(mt=mt.querySelectorAll("input[name="+JSON.stringify(""+st)+'][type="radio"]'),st=0;st<mt.length;st++){var gt=mt[st];if(gt!==nt&&gt.form===nt.form){var _t=Db$1(gt);if(!_t)throw Error(p$8(90));Wa$1(gt),bb$1(gt,_t)}}}break;case"textarea":ib$1(nt,mt);break;case"select":st=mt.value,st!=null&&fb$1(nt,!!mt.multiple,st,!1)}};Gb$1=Qk$1;Hb$1=Rk$1;var sl$1={usingClientEntryPoint:!1,Events:[Cb$1,ue$2,Db$1,Eb$1,Fb$1,Qk$1]},tl$1={findFiberByHostInstance:Wc$1,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul$1={bundleType:tl$1.bundleType,version:tl$1.version,rendererPackageName:tl$1.rendererPackageName,rendererConfig:tl$1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua$1.ReactCurrentDispatcher,findHostInstanceByFiber:function(nt){return nt=Zb(nt),nt===null?null:nt.stateNode},findFiberByHostInstance:tl$1.findFiberByHostInstance||jl$1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl$1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl$1.isDisabled&&vl$1.supportsFiber)try{kc$1=vl$1.inject(ul$1),lc$1=vl$1}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl$1;reactDom_production_min.createPortal=function(nt,st){var mt=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl$1(st))throw Error(p$8(200));return cl$1(nt,st,null,mt)};reactDom_production_min.createRoot=function(nt,st){if(!nl$1(nt))throw Error(p$8(299));var mt=!1,gt="",_t=kl$1;return st!=null&&(st.unstable_strictMode===!0&&(mt=!0),st.identifierPrefix!==void 0&&(gt=st.identifierPrefix),st.onRecoverableError!==void 0&&(_t=st.onRecoverableError)),st=bl$1(nt,1,!1,null,null,mt,!1,gt,_t),nt[uf$1]=st.current,sf$1(nt.nodeType===8?nt.parentNode:nt),new ll$1(st)};reactDom_production_min.findDOMNode=function(nt){if(nt==null)return null;if(nt.nodeType===1)return nt;var st=nt._reactInternals;if(st===void 0)throw typeof nt.render=="function"?Error(p$8(188)):(nt=Object.keys(nt).join(","),Error(p$8(268,nt)));return nt=Zb(st),nt=nt===null?null:nt.stateNode,nt};reactDom_production_min.flushSync=function(nt){return Rk$1(nt)};reactDom_production_min.hydrate=function(nt,st,mt){if(!ol$1(st))throw Error(p$8(200));return rl$1(null,nt,st,!0,mt)};reactDom_production_min.hydrateRoot=function(nt,st,mt){if(!nl$1(nt))throw Error(p$8(405));var gt=mt!=null&&mt.hydratedSources||null,_t=!1,Et="",At=kl$1;if(mt!=null&&(mt.unstable_strictMode===!0&&(_t=!0),mt.identifierPrefix!==void 0&&(Et=mt.identifierPrefix),mt.onRecoverableError!==void 0&&(At=mt.onRecoverableError)),st=el$1(st,null,nt,1,mt??null,_t,!1,Et,At),nt[uf$1]=st.current,sf$1(nt),gt)for(nt=0;nt<gt.length;nt++)mt=gt[nt],_t=mt._getVersion,_t=_t(mt._source),st.mutableSourceEagerHydrationData==null?st.mutableSourceEagerHydrationData=[mt,_t]:st.mutableSourceEagerHydrationData.push(mt,_t);return new ml$1(st)};reactDom_production_min.render=function(nt,st,mt){if(!ol$1(st))throw Error(p$8(200));return rl$1(null,nt,st,!1,mt)};reactDom_production_min.unmountComponentAtNode=function(nt){if(!ol$1(nt))throw Error(p$8(40));return nt._reactRootContainer?(Rk$1(function(){rl$1(null,null,nt,!1,function(){nt._reactRootContainer=null,nt[uf$1]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk$1;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(nt,st,mt,gt){if(!ol$1(mt))throw Error(p$8(200));if(nt==null||nt._reactInternals===void 0)throw Error(p$8(38));return rl$1(nt,st,mt,!1,gt)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(nt){console.error(nt)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$b=reactDomExports;client.createRoot=m$b.createRoot,client.hydrateRoot=m$b.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$4(){return _extends$4=Object.assign?Object.assign.bind():function(nt){for(var st=1;st<arguments.length;st++){var mt=arguments[st];for(var gt in mt)Object.prototype.hasOwnProperty.call(mt,gt)&&(nt[gt]=mt[gt])}return nt},_extends$4.apply(this,arguments)}var Action;(function(nt){nt.Pop="POP",nt.Push="PUSH",nt.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createHashHistory(nt){nt===void 0&&(nt={});function st(_t,Et){let{pathname:At="/",search:Rt="",hash:Ft=""}=parsePath(_t.location.hash.substr(1));return!At.startsWith("/")&&!At.startsWith(".")&&(At="/"+At),createLocation("",{pathname:At,search:Rt,hash:Ft},Et.state&&Et.state.usr||null,Et.state&&Et.state.key||"default")}function mt(_t,Et){let At=_t.document.querySelector("base"),Rt="";if(At&&At.getAttribute("href")){let Ft=_t.location.href,Nt=Ft.indexOf("#");Rt=Nt===-1?Ft:Ft.slice(0,Nt)}return Rt+"#"+(typeof Et=="string"?Et:createPath(Et))}function gt(_t,Et){warning(_t.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(Et)+")")}return getUrlBasedHistory(st,mt,gt,nt)}function invariant(nt,st){if(nt===!1||nt===null||typeof nt>"u")throw new Error(st)}function warning(nt,st){if(!nt){typeof console<"u"&&console.warn(st);try{throw new Error(st)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(nt,st){return{usr:nt.state,key:nt.key,idx:st}}function createLocation(nt,st,mt,gt){return mt===void 0&&(mt=null),_extends$4({pathname:typeof nt=="string"?nt:nt.pathname,search:"",hash:""},typeof st=="string"?parsePath(st):st,{state:mt,key:st&&st.key||gt||createKey()})}function createPath(nt){let{pathname:st="/",search:mt="",hash:gt=""}=nt;return mt&&mt!=="?"&&(st+=mt.charAt(0)==="?"?mt:"?"+mt),gt&&gt!=="#"&&(st+=gt.charAt(0)==="#"?gt:"#"+gt),st}function parsePath(nt){let st={};if(nt){let mt=nt.indexOf("#");mt>=0&&(st.hash=nt.substr(mt),nt=nt.substr(0,mt));let gt=nt.indexOf("?");gt>=0&&(st.search=nt.substr(gt),nt=nt.substr(0,gt)),nt&&(st.pathname=nt)}return st}function getUrlBasedHistory(nt,st,mt,gt){gt===void 0&&(gt={});let{window:_t=document.defaultView,v5Compat:Et=!1}=gt,At=_t.history,Rt=Action.Pop,Ft=null,Nt=Bt();Nt==null&&(Nt=0,At.replaceState(_extends$4({},At.state,{idx:Nt}),""));function Bt(){return(At.state||{idx:null}).idx}function Gt(){Rt=Action.Pop;let Fr=Bt(),Nr=Fr==null?null:Fr-Nt;Nt=Fr,Ft&&Ft({action:Rt,location:zr.location,delta:Nr})}function dr(Fr,Nr){Rt=Action.Push;let tn=createLocation(zr.location,Fr,Nr);mt&&mt(tn,Fr),Nt=Bt()+1;let rn=getHistoryState(tn,Nt),Tn=zr.createHref(tn);try{At.pushState(rn,"",Tn)}catch($n){if($n instanceof DOMException&&$n.name==="DataCloneError")throw $n;_t.location.assign(Tn)}Et&&Ft&&Ft({action:Rt,location:zr.location,delta:1})}function Mr(Fr,Nr){Rt=Action.Replace;let tn=createLocation(zr.location,Fr,Nr);mt&&mt(tn,Fr),Nt=Bt();let rn=getHistoryState(tn,Nt),Tn=zr.createHref(tn);At.replaceState(rn,"",Tn),Et&&Ft&&Ft({action:Rt,location:zr.location,delta:0})}function Tr(Fr){let Nr=_t.location.origin!=="null"?_t.location.origin:_t.location.href,tn=typeof Fr=="string"?Fr:createPath(Fr);return tn=tn.replace(/ $/,"%20"),invariant(Nr,"No window.location.(origin|href) available to create URL for href: "+tn),new URL(tn,Nr)}let zr={get action(){return Rt},get location(){return nt(_t,At)},listen(Fr){if(Ft)throw new Error("A history only accepts one active listener");return _t.addEventListener(PopStateEventType,Gt),Ft=Fr,()=>{_t.removeEventListener(PopStateEventType,Gt),Ft=null}},createHref(Fr){return st(_t,Fr)},createURL:Tr,encodeLocation(Fr){let Nr=Tr(Fr);return{pathname:Nr.pathname,search:Nr.search,hash:Nr.hash}},push:dr,replace:Mr,go(Fr){return At.go(Fr)}};return zr}var ResultType;(function(nt){nt.data="data",nt.deferred="deferred",nt.redirect="redirect",nt.error="error"})(ResultType||(ResultType={}));function matchRoutes(nt,st,mt){return mt===void 0&&(mt="/"),matchRoutesImpl(nt,st,mt,!1)}function matchRoutesImpl(nt,st,mt,gt){let _t=typeof st=="string"?parsePath(st):st,Et=stripBasename(_t.pathname||"/",mt);if(Et==null)return null;let At=flattenRoutes(nt);rankRouteBranches(At);let Rt=null;for(let Ft=0;Rt==null&&Ft<At.length;++Ft){let Nt=decodePath(Et);Rt=matchRouteBranch(At[Ft],Nt,gt)}return Rt}function flattenRoutes(nt,st,mt,gt){st===void 0&&(st=[]),mt===void 0&&(mt=[]),gt===void 0&&(gt="");let _t=(Et,At,Rt)=>{let Ft={relativePath:Rt===void 0?Et.path||"":Rt,caseSensitive:Et.caseSensitive===!0,childrenIndex:At,route:Et};Ft.relativePath.startsWith("/")&&(invariant(Ft.relativePath.startsWith(gt),'Absolute route path "'+Ft.relativePath+'" nested under path '+('"'+gt+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),Ft.relativePath=Ft.relativePath.slice(gt.length));let Nt=joinPaths([gt,Ft.relativePath]),Bt=mt.concat(Ft);Et.children&&Et.children.length>0&&(invariant(Et.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+Nt+'".')),flattenRoutes(Et.children,st,Bt,Nt)),!(Et.path==null&&!Et.index)&&st.push({path:Nt,score:computeScore(Nt,Et.index),routesMeta:Bt})};return nt.forEach((Et,At)=>{var Rt;if(Et.path===""||!((Rt=Et.path)!=null&&Rt.includes("?")))_t(Et,At);else for(let Ft of explodeOptionalSegments(Et.path))_t(Et,At,Ft)}),st}function explodeOptionalSegments(nt){let st=nt.split("/");if(st.length===0)return[];let[mt,...gt]=st,_t=mt.endsWith("?"),Et=mt.replace(/\?$/,"");if(gt.length===0)return _t?[Et,""]:[Et];let At=explodeOptionalSegments(gt.join("/")),Rt=[];return Rt.push(...At.map(Ft=>Ft===""?Et:[Et,Ft].join("/"))),_t&&Rt.push(...At),Rt.map(Ft=>nt.startsWith("/")&&Ft===""?"/":Ft)}function rankRouteBranches(nt){nt.sort((st,mt)=>st.score!==mt.score?mt.score-st.score:compareIndexes(st.routesMeta.map(gt=>gt.childrenIndex),mt.routesMeta.map(gt=>gt.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=nt=>nt==="*";function computeScore(nt,st){let mt=nt.split("/"),gt=mt.length;return mt.some(isSplat)&&(gt+=splatPenalty),st&&(gt+=indexRouteValue),mt.filter(_t=>!isSplat(_t)).reduce((_t,Et)=>_t+(paramRe.test(Et)?dynamicSegmentValue:Et===""?emptySegmentValue:staticSegmentValue),gt)}function compareIndexes(nt,st){return nt.length===st.length&&nt.slice(0,-1).every((gt,_t)=>gt===st[_t])?nt[nt.length-1]-st[st.length-1]:0}function matchRouteBranch(nt,st,mt){let{routesMeta:gt}=nt,_t={},Et="/",At=[];for(let Rt=0;Rt<gt.length;++Rt){let Ft=gt[Rt],Nt=Rt===gt.length-1,Bt=Et==="/"?st:st.slice(Et.length)||"/",Gt=matchPath({path:Ft.relativePath,caseSensitive:Ft.caseSensitive,end:Nt},Bt),dr=Ft.route;if(!Gt&&Nt&&mt&&!gt[gt.length-1].route.index&&(Gt=matchPath({path:Ft.relativePath,caseSensitive:Ft.caseSensitive,end:!1},Bt)),!Gt)return null;Object.assign(_t,Gt.params),At.push({params:_t,pathname:joinPaths([Et,Gt.pathname]),pathnameBase:normalizePathname(joinPaths([Et,Gt.pathnameBase])),route:dr}),Gt.pathnameBase!=="/"&&(Et=joinPaths([Et,Gt.pathnameBase]))}return At}function matchPath(nt,st){typeof nt=="string"&&(nt={path:nt,caseSensitive:!1,end:!0});let[mt,gt]=compilePath(nt.path,nt.caseSensitive,nt.end),_t=st.match(mt);if(!_t)return null;let Et=_t[0],At=Et.replace(/(.)\/+$/,"$1"),Rt=_t.slice(1);return{params:gt.reduce((Nt,Bt,Gt)=>{let{paramName:dr,isOptional:Mr}=Bt;if(dr==="*"){let zr=Rt[Gt]||"";At=Et.slice(0,Et.length-zr.length).replace(/(.)\/+$/,"$1")}const Tr=Rt[Gt];return Mr&&!Tr?Nt[dr]=void 0:Nt[dr]=(Tr||"").replace(/%2F/g,"/"),Nt},{}),pathname:Et,pathnameBase:At,pattern:nt}}function compilePath(nt,st,mt){st===void 0&&(st=!1),mt===void 0&&(mt=!0),warning(nt==="*"||!nt.endsWith("*")||nt.endsWith("/*"),'Route path "'+nt+'" will be treated as if it were '+('"'+nt.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+nt.replace(/\*$/,"/*")+'".'));let gt=[],_t="^"+nt.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(At,Rt,Ft)=>(gt.push({paramName:Rt,isOptional:Ft!=null}),Ft?"/?([^\\/]+)?":"/([^\\/]+)"));return nt.endsWith("*")?(gt.push({paramName:"*"}),_t+=nt==="*"||nt==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):mt?_t+="\\/*$":nt!==""&&nt!=="/"&&(_t+="(?:(?=\\/|$))"),[new RegExp(_t,st?void 0:"i"),gt]}function decodePath(nt){try{return nt.split("/").map(st=>decodeURIComponent(st).replace(/\//g,"%2F")).join("/")}catch(st){return warning(!1,'The URL path "'+nt+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+st+").")),nt}}function stripBasename(nt,st){if(st==="/")return nt;if(!nt.toLowerCase().startsWith(st.toLowerCase()))return null;let mt=st.endsWith("/")?st.length-1:st.length,gt=nt.charAt(mt);return gt&&gt!=="/"?null:nt.slice(mt)||"/"}function resolvePath(nt,st){st===void 0&&(st="/");let{pathname:mt,search:gt="",hash:_t=""}=typeof nt=="string"?parsePath(nt):nt;return{pathname:mt?mt.startsWith("/")?mt:resolvePathname(mt,st):st,search:normalizeSearch(gt),hash:normalizeHash(_t)}}function resolvePathname(nt,st){let mt=st.replace(/\/+$/,"").split("/");return nt.split("/").forEach(_t=>{_t===".."?mt.length>1&&mt.pop():_t!=="."&&mt.push(_t)}),mt.length>1?mt.join("/"):"/"}function getInvalidPathError(nt,st,mt,gt){return"Cannot include a '"+nt+"' character in a manually specified "+("`to."+st+"` field ["+JSON.stringify(gt)+"].  Please separate it out to the ")+("`to."+mt+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(nt){return nt.filter((st,mt)=>mt===0||st.route.path&&st.route.path.length>0)}function getResolveToMatches(nt,st){let mt=getPathContributingMatches(nt);return st?mt.map((gt,_t)=>_t===mt.length-1?gt.pathname:gt.pathnameBase):mt.map(gt=>gt.pathnameBase)}function resolveTo(nt,st,mt,gt){gt===void 0&&(gt=!1);let _t;typeof nt=="string"?_t=parsePath(nt):(_t=_extends$4({},nt),invariant(!_t.pathname||!_t.pathname.includes("?"),getInvalidPathError("?","pathname","search",_t)),invariant(!_t.pathname||!_t.pathname.includes("#"),getInvalidPathError("#","pathname","hash",_t)),invariant(!_t.search||!_t.search.includes("#"),getInvalidPathError("#","search","hash",_t)));let Et=nt===""||_t.pathname==="",At=Et?"/":_t.pathname,Rt;if(At==null)Rt=mt;else{let Gt=st.length-1;if(!gt&&At.startsWith("..")){let dr=At.split("/");for(;dr[0]==="..";)dr.shift(),Gt-=1;_t.pathname=dr.join("/")}Rt=Gt>=0?st[Gt]:"/"}let Ft=resolvePath(_t,Rt),Nt=At&&At!=="/"&&At.endsWith("/"),Bt=(Et||At===".")&&mt.endsWith("/");return!Ft.pathname.endsWith("/")&&(Nt||Bt)&&(Ft.pathname+="/"),Ft}const joinPaths=nt=>nt.join("/").replace(/\/\/+/g,"/"),normalizePathname=nt=>nt.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=nt=>!nt||nt==="?"?"":nt.startsWith("?")?nt:"?"+nt,normalizeHash=nt=>!nt||nt==="#"?"":nt.startsWith("#")?nt:"#"+nt;function isRouteErrorResponse(nt){return nt!=null&&typeof nt.status=="number"&&typeof nt.statusText=="string"&&typeof nt.internal=="boolean"&&"data"in nt}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(nt){for(var st=1;st<arguments.length;st++){var mt=arguments[st];for(var gt in mt)Object.prototype.hasOwnProperty.call(mt,gt)&&(nt[gt]=mt[gt])}return nt},_extends$3.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect(nt){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(nt)}function useNavigate(){let{isDataRoute:nt}=reactExports.useContext(RouteContext);return nt?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let nt=reactExports.useContext(DataRouterContext),{basename:st,future:mt,navigator:gt}=reactExports.useContext(NavigationContext),{matches:_t}=reactExports.useContext(RouteContext),{pathname:Et}=useLocation(),At=JSON.stringify(getResolveToMatches(_t,mt.v7_relativeSplatPath)),Rt=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{Rt.current=!0}),reactExports.useCallback(function(Nt,Bt){if(Bt===void 0&&(Bt={}),!Rt.current)return;if(typeof Nt=="number"){gt.go(Nt);return}let Gt=resolveTo(Nt,JSON.parse(At),Et,Bt.relative==="path");nt==null&&st!=="/"&&(Gt.pathname=Gt.pathname==="/"?st:joinPaths([st,Gt.pathname])),(Bt.replace?gt.replace:gt.push)(Gt,Bt.state,Bt)},[st,gt,At,Et,nt])}function useRoutes(nt,st){return useRoutesImpl(nt,st)}function useRoutesImpl(nt,st,mt,gt){useInRouterContext()||invariant(!1);let{navigator:_t}=reactExports.useContext(NavigationContext),{matches:Et}=reactExports.useContext(RouteContext),At=Et[Et.length-1],Rt=At?At.params:{};At&&At.pathname;let Ft=At?At.pathnameBase:"/";At&&At.route;let Nt=useLocation(),Bt;if(st){var Gt;let Fr=typeof st=="string"?parsePath(st):st;Ft==="/"||(Gt=Fr.pathname)!=null&&Gt.startsWith(Ft)||invariant(!1),Bt=Fr}else Bt=Nt;let dr=Bt.pathname||"/",Mr=dr;if(Ft!=="/"){let Fr=Ft.replace(/^\//,"").split("/");Mr="/"+dr.replace(/^\//,"").split("/").slice(Fr.length).join("/")}let Tr=matchRoutes(nt,{pathname:Mr}),zr=_renderMatches(Tr&&Tr.map(Fr=>Object.assign({},Fr,{params:Object.assign({},Rt,Fr.params),pathname:joinPaths([Ft,_t.encodeLocation?_t.encodeLocation(Fr.pathname).pathname:Fr.pathname]),pathnameBase:Fr.pathnameBase==="/"?Ft:joinPaths([Ft,_t.encodeLocation?_t.encodeLocation(Fr.pathnameBase).pathname:Fr.pathnameBase])})),Et,mt,gt);return st&&zr?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$3({pathname:"/",search:"",hash:"",state:null,key:"default"},Bt),navigationType:Action.Pop}},zr):zr}function DefaultErrorComponent(){let nt=useRouteError(),st=isRouteErrorResponse(nt)?nt.status+" "+nt.statusText:nt instanceof Error?nt.message:JSON.stringify(nt),mt=nt instanceof Error?nt.stack:null,_t={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},st),mt?reactExports.createElement("pre",{style:_t},mt):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(st){super(st),this.state={location:st.location,revalidation:st.revalidation,error:st.error}}static getDerivedStateFromError(st){return{error:st}}static getDerivedStateFromProps(st,mt){return mt.location!==st.location||mt.revalidation!=="idle"&&st.revalidation==="idle"?{error:st.error,location:st.location,revalidation:st.revalidation}:{error:st.error!==void 0?st.error:mt.error,location:mt.location,revalidation:st.revalidation||mt.revalidation}}componentDidCatch(st,mt){console.error("React Router caught the following error during render",st,mt)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(nt){let{routeContext:st,match:mt,children:gt}=nt,_t=reactExports.useContext(DataRouterContext);return _t&&_t.static&&_t.staticContext&&(mt.route.errorElement||mt.route.ErrorBoundary)&&(_t.staticContext._deepestRenderedBoundaryId=mt.route.id),reactExports.createElement(RouteContext.Provider,{value:st},gt)}function _renderMatches(nt,st,mt,gt){var _t;if(st===void 0&&(st=[]),mt===void 0&&(mt=null),gt===void 0&&(gt=null),nt==null){var Et;if(!mt)return null;if(mt.errors)nt=mt.matches;else if((Et=gt)!=null&&Et.v7_partialHydration&&st.length===0&&!mt.initialized&&mt.matches.length>0)nt=mt.matches;else return null}let At=nt,Rt=(_t=mt)==null?void 0:_t.errors;if(Rt!=null){let Bt=At.findIndex(Gt=>Gt.route.id&&(Rt==null?void 0:Rt[Gt.route.id])!==void 0);Bt>=0||invariant(!1),At=At.slice(0,Math.min(At.length,Bt+1))}let Ft=!1,Nt=-1;if(mt&&gt&&gt.v7_partialHydration)for(let Bt=0;Bt<At.length;Bt++){let Gt=At[Bt];if((Gt.route.HydrateFallback||Gt.route.hydrateFallbackElement)&&(Nt=Bt),Gt.route.id){let{loaderData:dr,errors:Mr}=mt,Tr=Gt.route.loader&&dr[Gt.route.id]===void 0&&(!Mr||Mr[Gt.route.id]===void 0);if(Gt.route.lazy||Tr){Ft=!0,Nt>=0?At=At.slice(0,Nt+1):At=[At[0]];break}}}return At.reduceRight((Bt,Gt,dr)=>{let Mr,Tr=!1,zr=null,Fr=null;mt&&(Mr=Rt&&Gt.route.id?Rt[Gt.route.id]:void 0,zr=Gt.route.errorElement||defaultErrorElement,Ft&&(Nt<0&&dr===0?(Tr=!0,Fr=null):Nt===dr&&(Tr=!0,Fr=Gt.route.hydrateFallbackElement||null)));let Nr=st.concat(At.slice(0,dr+1)),tn=()=>{let rn;return Mr?rn=zr:Tr?rn=Fr:Gt.route.Component?rn=reactExports.createElement(Gt.route.Component,null):Gt.route.element?rn=Gt.route.element:rn=Bt,reactExports.createElement(RenderedRoute,{match:Gt,routeContext:{outlet:Bt,matches:Nr,isDataRoute:mt!=null},children:rn})};return mt&&(Gt.route.ErrorBoundary||Gt.route.errorElement||dr===0)?reactExports.createElement(RenderErrorBoundary,{location:mt.location,revalidation:mt.revalidation,component:zr,error:Mr,children:tn(),routeContext:{outlet:null,matches:Nr,isDataRoute:!0}}):tn()},null)}var DataRouterHook$1=function(nt){return nt.UseBlocker="useBlocker",nt.UseRevalidator="useRevalidator",nt.UseNavigateStable="useNavigate",nt}(DataRouterHook$1||{}),DataRouterStateHook$1=function(nt){return nt.UseBlocker="useBlocker",nt.UseLoaderData="useLoaderData",nt.UseActionData="useActionData",nt.UseRouteError="useRouteError",nt.UseNavigation="useNavigation",nt.UseRouteLoaderData="useRouteLoaderData",nt.UseMatches="useMatches",nt.UseRevalidator="useRevalidator",nt.UseNavigateStable="useNavigate",nt.UseRouteId="useRouteId",nt}(DataRouterStateHook$1||{});function useDataRouterContext(nt){let st=reactExports.useContext(DataRouterContext);return st||invariant(!1),st}function useDataRouterState(nt){let st=reactExports.useContext(DataRouterStateContext);return st||invariant(!1),st}function useRouteContext(nt){let st=reactExports.useContext(RouteContext);return st||invariant(!1),st}function useCurrentRouteId(nt){let st=useRouteContext(),mt=st.matches[st.matches.length-1];return mt.route.id||invariant(!1),mt.route.id}function useRouteError(){var nt;let st=reactExports.useContext(RouteErrorContext),mt=useDataRouterState(DataRouterStateHook$1.UseRouteError),gt=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return st!==void 0?st:(nt=mt.errors)==null?void 0:nt[gt]}function useNavigateStable(){let{router:nt}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),st=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),mt=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{mt.current=!0}),reactExports.useCallback(function(_t,Et){Et===void 0&&(Et={}),mt.current&&(typeof _t=="number"?nt.navigate(_t):nt.navigate(_t,_extends$3({fromRouteId:st},Et)))},[nt,st])}const alreadyWarned={};function warnOnce(nt,st){alreadyWarned[st]||(alreadyWarned[st]=!0,console.warn(st))}const logDeprecation=(nt,st,mt)=>warnOnce(nt," React Router Future Flag Warning: "+st+". "+("You can use the `"+nt+"` future flag to opt-in early. ")+("For more information, see "+mt+"."));function logV6DeprecationWarnings(nt,st){(nt==null?void 0:nt.v7_startTransition)===void 0&&logDeprecation("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(nt==null?void 0:nt.v7_relativeSplatPath)===void 0&&!st&&logDeprecation("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function Route(nt){invariant(!1)}function Router(nt){let{basename:st="/",children:mt=null,location:gt,navigationType:_t=Action.Pop,navigator:Et,static:At=!1,future:Rt}=nt;useInRouterContext()&&invariant(!1);let Ft=st.replace(/^\/*/,"/"),Nt=reactExports.useMemo(()=>({basename:Ft,navigator:Et,static:At,future:_extends$3({v7_relativeSplatPath:!1},Rt)}),[Ft,Rt,Et,At]);typeof gt=="string"&&(gt=parsePath(gt));let{pathname:Bt="/",search:Gt="",hash:dr="",state:Mr=null,key:Tr="default"}=gt,zr=reactExports.useMemo(()=>{let Fr=stripBasename(Bt,Ft);return Fr==null?null:{location:{pathname:Fr,search:Gt,hash:dr,state:Mr,key:Tr},navigationType:_t}},[Ft,Bt,Gt,dr,Mr,Tr,_t]);return zr==null?null:reactExports.createElement(NavigationContext.Provider,{value:Nt},reactExports.createElement(LocationContext.Provider,{children:mt,value:zr}))}function Routes(nt){let{children:st,location:mt}=nt;return useRoutes(createRoutesFromChildren(st),mt)}new Promise(()=>{});function createRoutesFromChildren(nt,st){st===void 0&&(st=[]);let mt=[];return reactExports.Children.forEach(nt,(gt,_t)=>{if(!reactExports.isValidElement(gt))return;let Et=[...st,_t];if(gt.type===reactExports.Fragment){mt.push.apply(mt,createRoutesFromChildren(gt.props.children,Et));return}gt.type!==Route&&invariant(!1),!gt.props.index||!gt.props.children||invariant(!1);let At={id:gt.props.id||Et.join("-"),caseSensitive:gt.props.caseSensitive,element:gt.props.element,Component:gt.props.Component,index:gt.props.index,path:gt.props.path,loader:gt.props.loader,action:gt.props.action,errorElement:gt.props.errorElement,ErrorBoundary:gt.props.ErrorBoundary,hasErrorBoundary:gt.props.ErrorBoundary!=null||gt.props.errorElement!=null,shouldRevalidate:gt.props.shouldRevalidate,handle:gt.props.handle,lazy:gt.props.lazy};gt.props.children&&(At.children=createRoutesFromChildren(gt.props.children,Et)),mt.push(At)}),mt}/**
 * React Router DOM v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function HashRouter(nt){let{basename:st,children:mt,future:gt,window:_t}=nt,Et=reactExports.useRef();Et.current==null&&(Et.current=createHashHistory({window:_t,v5Compat:!0}));let At=Et.current,[Rt,Ft]=reactExports.useState({action:At.action,location:At.location}),{v7_startTransition:Nt}=gt||{},Bt=reactExports.useCallback(Gt=>{Nt&&startTransitionImpl?startTransitionImpl(()=>Ft(Gt)):Ft(Gt)},[Ft,Nt]);return reactExports.useLayoutEffect(()=>At.listen(Bt),[At,Bt]),reactExports.useEffect(()=>logV6DeprecationWarnings(gt),[gt]),reactExports.createElement(Router,{basename:st,children:mt,location:Rt.location,navigationType:Rt.action,navigator:At,future:gt})}var DataRouterHook;(function(nt){nt.UseScrollRestoration="useScrollRestoration",nt.UseSubmit="useSubmit",nt.UseSubmitFetcher="useSubmitFetcher",nt.UseFetcher="useFetcher",nt.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(nt){nt.UseFetcher="useFetcher",nt.UseFetchers="useFetchers",nt.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));const scriptRel="modulepreload",assetsURL=function(nt){return"/website/"+nt},seen={},__vitePreload=function(st,mt,gt){let _t=Promise.resolve();if(mt&&mt.length>0){document.getElementsByTagName("link");const At=document.querySelector("meta[property=csp-nonce]"),Rt=(At==null?void 0:At.nonce)||(At==null?void 0:At.getAttribute("nonce"));_t=Promise.allSettled(mt.map(Ft=>{if(Ft=assetsURL(Ft),Ft in seen)return;seen[Ft]=!0;const Nt=Ft.endsWith(".css"),Bt=Nt?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${Ft}"]${Bt}`))return;const Gt=document.createElement("link");if(Gt.rel=Nt?"stylesheet":scriptRel,Nt||(Gt.as="script"),Gt.crossOrigin="",Gt.href=Ft,Rt&&Gt.setAttribute("nonce",Rt),document.head.appendChild(Gt),Nt)return new Promise((dr,Mr)=>{Gt.addEventListener("load",dr),Gt.addEventListener("error",()=>Mr(new Error(`Unable to preload CSS for ${Ft}`)))})}))}function Et(At){const Rt=new Event("vite:preloadError",{cancelable:!0});if(Rt.payload=At,window.dispatchEvent(Rt),!Rt.defaultPrevented)throw At}return _t.then(At=>{for(const Rt of At||[])Rt.status==="rejected"&&Et(Rt.reason);return st().catch(Et)})};var tF=Object.create,vg=Object.defineProperty,rF=Object.getOwnPropertyDescriptor,iF=Object.getOwnPropertyNames,nF=Object.getPrototypeOf,sF=Object.prototype.hasOwnProperty,oF=(nt,st,mt)=>st in nt?vg(nt,st,{enumerable:!0,configurable:!0,writable:!0,value:mt}):nt[st]=mt,Zo=(nt,st)=>()=>(st||nt((st={exports:{}}).exports,st),st.exports),aF=(nt,st)=>{for(var mt in st)vg(nt,mt,{get:st[mt],enumerable:!0})},lF=(nt,st,mt,gt)=>{if(st&&typeof st=="object"||typeof st=="function")for(let _t of iF(st))!sF.call(nt,_t)&&_t!==mt&&vg(nt,_t,{get:()=>st[_t],enumerable:!(gt=rF(st,_t))||gt.enumerable});return nt},Jo=(nt,st,mt)=>(mt=nt!=null?tF(nF(nt)):{},lF(st||!nt||!nt.__esModule?vg(mt,"default",{value:nt,enumerable:!0}):mt,nt)),nc=(nt,st,mt)=>(oF(nt,typeof st!="symbol"?st+"":st,mt),mt),FI=Zo((nt,st)=>{(function(mt,gt){typeof nt=="object"?st.exports=gt():typeof define=="function"&&define.amd?define(gt):mt.Alea=gt()})(nt,function(){return mt.importState=function(_t){var Et=new mt;return Et.importState(_t),Et},mt;function mt(){return function(_t){var Et=0,At=0,Rt=0,Ft=1;_t.length==0&&(_t=[+new Date]);var Nt=gt();Et=Nt(" "),At=Nt(" "),Rt=Nt(" ");for(var Bt=0;Bt<_t.length;Bt++)Et-=Nt(_t[Bt]),Et<0&&(Et+=1),At-=Nt(_t[Bt]),At<0&&(At+=1),Rt-=Nt(_t[Bt]),Rt<0&&(Rt+=1);Nt=null;var Gt=function(){var dr=2091639*Et+Ft*23283064365386963e-26;return Et=At,At=Rt,Rt=dr-(Ft=dr|0)};return Gt.next=Gt,Gt.uint32=function(){return Gt()*4294967296},Gt.fract53=function(){return Gt()+(Gt()*2097152|0)*11102230246251565e-32},Gt.version="Alea 0.9",Gt.args=_t,Gt.exportState=function(){return[Et,At,Rt,Ft]},Gt.importState=function(dr){Et=+dr[0]||0,At=+dr[1]||0,Rt=+dr[2]||0,Ft=+dr[3]||0},Gt}(Array.prototype.slice.call(arguments))}function gt(){var _t=4022871197,Et=function(At){At=At.toString();for(var Rt=0;Rt<At.length;Rt++){_t+=At.charCodeAt(Rt);var Ft=.02519603282416938*_t;_t=Ft>>>0,Ft-=_t,Ft*=_t,_t=Ft>>>0,Ft-=_t,_t+=Ft*4294967296}return(_t>>>0)*23283064365386963e-26};return Et.version="Mash 0.9",Et}})}),iA=Zo((nt,st)=>{(function(mt,gt){typeof nt=="object"&&typeof st<"u"?gt(nt):typeof define=="function"&&define.amd?define(["exports"],gt):gt((mt=typeof globalThis<"u"?globalThis:mt||self).SVDJS={})})(nt,function(mt){mt.SVD=function(gt,_t,Et,At,Rt){if(_t=_t===void 0||_t,Et=Et===void 0||Et,Rt=1e-64/(At=At||Math.pow(2,-52)),!gt)throw new TypeError("Matrix a is not defined");var Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr,Nr,tn,rn,Tn=gt[0].length,$n=gt.length;if($n<Tn)throw new TypeError("Invalid matrix: m < n");for(var un=[],es=[],kn=[],ts=_t==="f"?$n:Tn,Ko=Nr=Tr=0;Ko<$n;Ko++)es[Ko]=new Array(ts).fill(0);for(Ko=0;Ko<Tn;Ko++)kn[Ko]=new Array(Tn).fill(0);var ds,Il=new Array(Tn).fill(0);for(Ko=0;Ko<$n;Ko++)for(Ft=0;Ft<Tn;Ft++)es[Ko][Ft]=gt[Ko][Ft];for(Ko=0;Ko<Tn;Ko++){for(un[Ko]=Tr,Fr=0,Bt=Ko+1,Ft=Ko;Ft<$n;Ft++)Fr+=Math.pow(es[Ft][Ko],2);if(Fr<Rt)Tr=0;else for(zr=(Mr=es[Ko][Ko])*(Tr=Mr<0?Math.sqrt(Fr):-Math.sqrt(Fr))-Fr,es[Ko][Ko]=Mr-Tr,Ft=Bt;Ft<Tn;Ft++){for(Fr=0,Nt=Ko;Nt<$n;Nt++)Fr+=es[Nt][Ko]*es[Nt][Ft];for(Mr=Fr/zr,Nt=Ko;Nt<$n;Nt++)es[Nt][Ft]=es[Nt][Ft]+Mr*es[Nt][Ko]}for(Il[Ko]=Tr,Fr=0,Ft=Bt;Ft<Tn;Ft++)Fr+=Math.pow(es[Ko][Ft],2);if(Fr<Rt)Tr=0;else{for(zr=(Mr=es[Ko][Ko+1])*(Tr=Mr<0?Math.sqrt(Fr):-Math.sqrt(Fr))-Fr,es[Ko][Ko+1]=Mr-Tr,Ft=Bt;Ft<Tn;Ft++)un[Ft]=es[Ko][Ft]/zr;for(Ft=Bt;Ft<$n;Ft++){for(Fr=0,Nt=Bt;Nt<Tn;Nt++)Fr+=es[Ft][Nt]*es[Ko][Nt];for(Nt=Bt;Nt<Tn;Nt++)es[Ft][Nt]=es[Ft][Nt]+Fr*un[Nt]}}Nr<(tn=Math.abs(Il[Ko])+Math.abs(un[Ko]))&&(Nr=tn)}if(Et)for(Ko=Tn-1;0<=Ko;Ko--){if(Tr!==0){for(zr=es[Ko][Ko+1]*Tr,Ft=Bt;Ft<Tn;Ft++)kn[Ft][Ko]=es[Ko][Ft]/zr;for(Ft=Bt;Ft<Tn;Ft++){for(Fr=0,Nt=Bt;Nt<Tn;Nt++)Fr+=es[Ko][Nt]*kn[Nt][Ft];for(Nt=Bt;Nt<Tn;Nt++)kn[Nt][Ft]=kn[Nt][Ft]+Fr*kn[Nt][Ko]}}for(Ft=Bt;Ft<Tn;Ft++)kn[Ko][Ft]=0,kn[Ft][Ko]=0;kn[Ko][Ko]=1,Tr=un[Ko],Bt=Ko}if(_t){if(_t==="f")for(Ko=Tn;Ko<$n;Ko++){for(Ft=Tn;Ft<$n;Ft++)es[Ko][Ft]=0;es[Ko][Ko]=1}for(Ko=Tn-1;0<=Ko;Ko--){for(Bt=Ko+1,Tr=Il[Ko],Ft=Bt;Ft<ts;Ft++)es[Ko][Ft]=0;if(Tr!==0){for(zr=es[Ko][Ko]*Tr,Ft=Bt;Ft<ts;Ft++){for(Fr=0,Nt=Bt;Nt<$n;Nt++)Fr+=es[Nt][Ko]*es[Nt][Ft];for(Mr=Fr/zr,Nt=Ko;Nt<$n;Nt++)es[Nt][Ft]=es[Nt][Ft]+Mr*es[Nt][Ko]}for(Ft=Ko;Ft<$n;Ft++)es[Ft][Ko]=es[Ft][Ko]/Tr}else for(Ft=Ko;Ft<$n;Ft++)es[Ft][Ko]=0;es[Ko][Ko]=es[Ko][Ko]+1}}for(At*=Nr,Nt=Tn-1;0<=Nt;Nt--)for(var ru=0;ru<50;ru++){for(ds=!1,Bt=Nt;0<=Bt;Bt--){if(Math.abs(un[Bt])<=At){ds=!0;break}if(Math.abs(Il[Bt-1])<=At)break}if(!ds){for(dr=0,Gt=Bt-(Fr=1),Ko=Bt;Ko<Nt+1&&(Mr=Fr*un[Ko],un[Ko]=dr*un[Ko],!(Math.abs(Mr)<=At));Ko++)if(Tr=Il[Ko],Il[Ko]=Math.sqrt(Mr*Mr+Tr*Tr),dr=Tr/(zr=Il[Ko]),Fr=-Mr/zr,_t)for(Ft=0;Ft<$n;Ft++)tn=es[Ft][Gt],rn=es[Ft][Ko],es[Ft][Gt]=tn*dr+rn*Fr,es[Ft][Ko]=-tn*Fr+rn*dr}if(rn=Il[Nt],Bt===Nt){if(rn<0&&(Il[Nt]=-rn,Et))for(Ft=0;Ft<Tn;Ft++)kn[Ft][Nt]=-kn[Ft][Nt];break}for(Nr=Il[Bt],Mr=(((tn=Il[Nt-1])-rn)*(tn+rn)+((Tr=un[Nt-1])-(zr=un[Nt]))*(Tr+zr))/(2*zr*tn),Tr=Math.sqrt(Mr*Mr+1),Mr=((Nr-rn)*(Nr+rn)+zr*(tn/(Mr<0?Mr-Tr:Mr+Tr)-zr))/Nr,Ko=Bt+(Fr=dr=1);Ko<Nt+1;Ko++){if(Tr=un[Ko],tn=Il[Ko],zr=Fr*Tr,Tr*=dr,rn=Math.sqrt(Mr*Mr+zr*zr),Mr=Nr*(dr=Mr/(un[Ko-1]=rn))+Tr*(Fr=zr/rn),Tr=-Nr*Fr+Tr*dr,zr=tn*Fr,tn*=dr,Et)for(Ft=0;Ft<Tn;Ft++)Nr=kn[Ft][Ko-1],rn=kn[Ft][Ko],kn[Ft][Ko-1]=Nr*dr+rn*Fr,kn[Ft][Ko]=-Nr*Fr+rn*dr;if(rn=Math.sqrt(Mr*Mr+zr*zr),Mr=(dr=Mr/(Il[Ko-1]=rn))*Tr+(Fr=zr/rn)*tn,Nr=-Fr*Tr+dr*tn,_t)for(Ft=0;Ft<$n;Ft++)tn=es[Ft][Ko-1],rn=es[Ft][Ko],es[Ft][Ko-1]=tn*dr+rn*Fr,es[Ft][Ko]=-tn*Fr+rn*dr}un[Bt]=0,un[Nt]=Mr,Il[Nt]=Nr}for(Ko=0;Ko<Tn;Ko++)Il[Ko]<At&&(Il[Ko]=0);return{u:es,q:Il,v:kn}},mt.VERSION="1.1.1",Object.defineProperty(mt,"__esModule",{value:!0})})}),pO=Zo((nt,st)=>{(function(mt,gt){typeof nt=="object"&&typeof st<"u"?st.exports=gt():typeof define=="function"&&define.amd?define(gt):(mt=mt||self,mt.TinyQueue=gt())})(nt,function(){var mt=function(_t,Et){if(_t===void 0&&(_t=[]),Et===void 0&&(Et=gt),this.data=_t,this.length=this.data.length,this.compare=Et,this.length>0)for(var At=(this.length>>1)-1;At>=0;At--)this._down(At)};mt.prototype.push=function(_t){this.data.push(_t),this.length++,this._up(this.length-1)},mt.prototype.pop=function(){if(this.length!==0){var _t=this.data[0],Et=this.data.pop();return this.length--,this.length>0&&(this.data[0]=Et,this._down(0)),_t}},mt.prototype.peek=function(){return this.data[0]},mt.prototype._up=function(_t){for(var Et=this,At=Et.data,Rt=Et.compare,Ft=At[_t];_t>0;){var Nt=_t-1>>1,Bt=At[Nt];if(Rt(Ft,Bt)>=0)break;At[_t]=Bt,_t=Nt}At[_t]=Ft},mt.prototype._down=function(_t){for(var Et=this,At=Et.data,Rt=Et.compare,Ft=this.length>>1,Nt=At[_t];_t<Ft;){var Bt=(_t<<1)+1,Gt=At[Bt],dr=Bt+1;if(dr<this.length&&Rt(At[dr],Gt)<0&&(Bt=dr,Gt=At[dr]),Rt(Gt,Nt)>=0)break;At[_t]=Gt,_t=Bt}At[_t]=Nt};function gt(_t,Et){return _t<Et?-1:_t>Et?1:0}return mt})}),gO=Zo((nt,st)=>{var mt=pO();mt.default&&(mt=mt.default),st.exports=gt,st.exports.default=gt;function gt(Nt,Bt,Gt){Bt=Bt||1;for(var dr,Mr,Tr,zr,Fr=0;Fr<Nt[0].length;Fr++){var Nr=Nt[0][Fr];(!Fr||Nr[0]<dr)&&(dr=Nr[0]),(!Fr||Nr[1]<Mr)&&(Mr=Nr[1]),(!Fr||Nr[0]>Tr)&&(Tr=Nr[0]),(!Fr||Nr[1]>zr)&&(zr=Nr[1])}var tn=Tr-dr,rn=zr-Mr,Tn=Math.min(tn,rn),$n=Tn/2;if(Tn===0){var un=[dr,Mr];return un.distance=0,un}for(var es=new mt(void 0,_t),kn=dr;kn<Tr;kn+=Tn)for(var ts=Mr;ts<zr;ts+=Tn)es.push(new Et(kn+$n,ts+$n,$n,Nt));var Ko=Rt(Nt),ds=new Et(dr+tn/2,Mr+rn/2,0,Nt);ds.d>Ko.d&&(Ko=ds);for(var Il=es.length;es.length;){var ru=es.pop();ru.d>Ko.d&&(Ko=ru,Gt&&console.log("found best %d after %d probes",Math.round(1e4*ru.d)/1e4,Il)),!(ru.max-Ko.d<=Bt)&&($n=ru.h/2,es.push(new Et(ru.x-$n,ru.y-$n,$n,Nt)),es.push(new Et(ru.x+$n,ru.y-$n,$n,Nt)),es.push(new Et(ru.x-$n,ru.y+$n,$n,Nt)),es.push(new Et(ru.x+$n,ru.y+$n,$n,Nt)),Il+=4)}Gt&&(console.log("num probes: "+Il),console.log("best distance: "+Ko.d));var uu=[Ko.x,Ko.y];return uu.distance=Ko.d,uu}function _t(Nt,Bt){return Bt.max-Nt.max}function Et(Nt,Bt,Gt,dr){this.x=Nt,this.y=Bt,this.h=Gt,this.d=At(Nt,Bt,dr),this.max=this.d+this.h*Math.SQRT2}function At(Nt,Bt,Gt){for(var dr=!1,Mr=1/0,Tr=0;Tr<Gt.length;Tr++)for(var zr=Gt[Tr],Fr=0,Nr=zr.length,tn=Nr-1;Fr<Nr;tn=Fr++){var rn=zr[Fr],Tn=zr[tn];rn[1]>Bt!=Tn[1]>Bt&&Nt<(Tn[0]-rn[0])*(Bt-rn[1])/(Tn[1]-rn[1])+rn[0]&&(dr=!dr),Mr=Math.min(Mr,Ft(Nt,Bt,rn,Tn))}return Mr===0?0:(dr?1:-1)*Math.sqrt(Mr)}function Rt(Nt){for(var Bt=0,Gt=0,dr=0,Mr=Nt[0],Tr=0,zr=Mr.length,Fr=zr-1;Tr<zr;Fr=Tr++){var Nr=Mr[Tr],tn=Mr[Fr],rn=Nr[0]*tn[1]-tn[0]*Nr[1];Gt+=(Nr[0]+tn[0])*rn,dr+=(Nr[1]+tn[1])*rn,Bt+=rn*3}return Bt===0?new Et(Mr[0][0],Mr[0][1],0,Nt):new Et(Gt/Bt,dr/Bt,0,Nt)}function Ft(Nt,Bt,Gt,dr){var Mr=Gt[0],Tr=Gt[1],zr=dr[0]-Mr,Fr=dr[1]-Tr;if(zr!==0||Fr!==0){var Nr=((Nt-Mr)*zr+(Bt-Tr)*Fr)/(zr*zr+Fr*Fr);Nr>1?(Mr=dr[0],Tr=dr[1]):Nr>0&&(Mr+=zr*Nr,Tr+=Fr*Nr)}return zr=Nt-Mr,Fr=Bt-Tr,zr*zr+Fr*Fr}}),mR=Zo((nt,st)=>{Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=mt;function mt(gt){if(gt===null||gt===!0||gt===!1)return NaN;var _t=Number(gt);return isNaN(_t)?_t:_t<0?Math.ceil(_t):Math.floor(_t)}st.exports=nt.default}),yR=Zo((nt,st)=>{Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=mt;function mt(gt){var _t=new Date(Date.UTC(gt.getFullYear(),gt.getMonth(),gt.getDate(),gt.getHours(),gt.getMinutes(),gt.getSeconds(),gt.getMilliseconds()));return _t.setUTCFullYear(gt.getFullYear()),gt.getTime()-_t.getTime()}st.exports=nt.default}),pL=Zo((nt,st)=>{function mt(Et,At){function Rt(){this.constructor=Et}Rt.prototype=At.prototype,Et.prototype=new Rt}function gt(Et,At,Rt,Ft){this.message=Et,this.expected=At,this.found=Rt,this.location=Ft,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,gt)}mt(gt,Error),gt.buildMessage=function(Et,At){var Rt={literal:function(Tr){return'"'+Nt(Tr.text)+'"'},class:function(Tr){var zr="",Fr;for(Fr=0;Fr<Tr.parts.length;Fr++)zr+=Tr.parts[Fr]instanceof Array?Bt(Tr.parts[Fr][0])+"-"+Bt(Tr.parts[Fr][1]):Bt(Tr.parts[Fr]);return"["+(Tr.inverted?"^":"")+zr+"]"},any:function(Tr){return"any character"},end:function(Tr){return"end of input"},other:function(Tr){return Tr.description}};function Ft(Tr){return Tr.charCodeAt(0).toString(16).toUpperCase()}function Nt(Tr){return Tr.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(zr){return"\\x0"+Ft(zr)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(zr){return"\\x"+Ft(zr)})}function Bt(Tr){return Tr.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(zr){return"\\x0"+Ft(zr)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(zr){return"\\x"+Ft(zr)})}function Gt(Tr){return Rt[Tr.type](Tr)}function dr(Tr){var zr=new Array(Tr.length),Fr,Nr;for(Fr=0;Fr<Tr.length;Fr++)zr[Fr]=Gt(Tr[Fr]);if(zr.sort(),zr.length>0){for(Fr=1,Nr=1;Fr<zr.length;Fr++)zr[Fr-1]!==zr[Fr]&&(zr[Nr]=zr[Fr],Nr++);zr.length=Nr}switch(zr.length){case 1:return zr[0];case 2:return zr[0]+" or "+zr[1];default:return zr.slice(0,-1).join(", ")+", or "+zr[zr.length-1]}}function Mr(Tr){return Tr?'"'+Nt(Tr)+'"':"end of input"}return"Expected "+dr(Et)+" but "+Mr(At)+" found."};function _t(Et,At){At=At!==void 0?At:{};var Rt={},Ft={svg_path:GL},Nt=GL,Bt=function(AA){if(!AA)return[];for(var c$=[],$$=0;$$<AA.length;$$++)c$=c$.concat.apply(c$,AA[$$]);var p$=c$[0];return p$&&p$.code=="m"&&(delete p$.relative,p$.code="M"),c$},Gt=function(AA,c$){return kee(AA,c$)},dr=/^[Mm]/,Mr=gD(["M","m"],!1,!1),Tr=function(AA,c$,$$){var p$=Ree(AA,[c$]);return $$&&(p$=p$.concat(Ree(AA=="M"?"L":"l",$$[1]))),p$},zr=/^[Zz]/,Fr=gD(["Z","z"],!1,!1),Nr=function(){return Ree("Z")},tn=/^[Ll]/,rn=gD(["L","l"],!1,!1),Tn=function(AA,c$){return Ree(AA,c$)},$n=/^[Hh]/,un=gD(["H","h"],!1,!1),es=function(AA,c$){return Ree(AA,c$.map(function($$){return{x:$$}}))},kn=/^[Vv]/,ts=gD(["V","v"],!1,!1),Ko=function(AA,c$){return Ree(AA,c$.map(function($$){return{y:$$}}))},ds=/^[Cc]/,Il=gD(["C","c"],!1,!1),ru=function(AA,c$,$$){return{x1:AA.x,y1:AA.y,x2:c$.x,y2:c$.y,x:$$.x,y:$$.y}},uu=/^[Ss]/,p0=gD(["S","s"],!1,!1),X1=function(AA,c$){return{x2:AA.x,y2:AA.y,x:c$.x,y:c$.y}},q0=/^[Qq]/,W0=gD(["Q","q"],!1,!1),hu=function(AA,c$){return{x1:AA.x,y1:AA.y,x:c$.x,y:c$.y}},a1=/^[Tt]/,Vx=gD(["T","t"],!1,!1),t0=/^[Aa]/,cu=gD(["A","a"],!1,!1),lu=function(AA,c$,$$,p$,H$,Q9){return{rx:AA,ry:c$,xAxisRotation:$$,largeArc:p$,sweep:H$,x:Q9.x,y:Q9.y}},b0=function(AA,c$){return{x:AA,y:c$}},l1=function(AA){return AA*1},LE=function(AA){return AA.join("")*1},eS=/^[01]/,SA=gD(["0","1"],!1,!1),o$=function(AA){return AA=="1"},h$=function(){return""},d$=",",y$=J$(",",!1),R$=function(AA){return AA.join("")},M$=".",x$=J$(".",!1),v$=/^[eE]/,rS=gD(["e","E"],!1,!1),wA=/^[+\-]/,g$=gD(["+","-"],!1,!1),S$=/^[0-9]/,tA=gD([["0","9"]],!1,!1),tS=function(AA){return AA.join("")},m$=/^[ \t\n\r]/,u$=gD([" ","	",`
`,"\r"],!1,!1),UE=0,F$=[{line:1,column:1}],EI=0,pR=[],X$;if("startRule"in At){if(!(At.startRule in Ft))throw new Error(`Can't start parsing from rule "`+At.startRule+'".');Nt=Ft[At.startRule]}function J$(AA,c$){return{type:"literal",text:AA,ignoreCase:c$}}function gD(AA,c$,$$){return{type:"class",parts:AA,inverted:c$,ignoreCase:$$}}function fL(){return{type:"end"}}function I7(AA){var c$=F$[AA],$$;if(c$)return c$;for($$=AA-1;!F$[$$];)$$--;for(c$=F$[$$],c$={line:c$.line,column:c$.column};$$<AA;)Et.charCodeAt($$)===10?(c$.line++,c$.column=1):c$.column++,$$++;return F$[AA]=c$,c$}function j$(AA,c$){var $$=I7(AA),p$=I7(c$);return{start:{offset:AA,line:$$.line,column:$$.column},end:{offset:c$,line:p$.line,column:p$.column}}}function _$(AA){UE<EI||(UE>EI&&(EI=UE,pR=[]),pR.push(AA))}function I$(AA,c$,$$){return new gt(gt.buildMessage(AA,c$),AA,c$,$$)}function GL(){var AA,c$,$$,p$,H$;for(AA=UE,c$=[],$$=YQ();$$!==Rt;)c$.push($$),$$=YQ();if(c$!==Rt)if($$=w$(),$$===Rt&&($$=null),$$!==Rt){for(p$=[],H$=YQ();H$!==Rt;)p$.push(H$),H$=YQ();p$!==Rt?(c$=Bt($$),AA=c$):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;else UE=AA,AA=Rt;return AA}function w$(){var AA,c$,$$,p$,H$,Q9;if(AA=UE,c$=B$(),c$!==Rt){for($$=[],p$=UE,H$=[],Q9=YQ();Q9!==Rt;)H$.push(Q9),Q9=YQ();for(H$!==Rt?(Q9=B$(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);p$!==Rt;){for($$.push(p$),p$=UE,H$=[],Q9=YQ();Q9!==Rt;)H$.push(Q9),Q9=YQ();H$!==Rt?(Q9=B$(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt)}$$!==Rt?(c$=Gt(c$,$$),AA=c$):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function B$(){var AA,c$,$$,p$,H$,Q9;if(AA=UE,c$=O$(),c$!==Rt){for($$=[],p$=UE,H$=[],Q9=YQ();Q9!==Rt;)H$.push(Q9),Q9=YQ();for(H$!==Rt?(Q9=r$(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);p$!==Rt;){for($$.push(p$),p$=UE,H$=[],Q9=YQ();Q9!==Rt;)H$.push(Q9),Q9=YQ();H$!==Rt?(Q9=r$(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt)}$$!==Rt?(c$=Gt(c$,$$),AA=c$):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function r$(){var AA;return AA=Z$(),AA===Rt&&(AA=mL(),AA===Rt&&(AA=L9(),AA===Rt&&(AA=l$(),AA===Rt&&(AA=T$(),AA===Rt&&(AA=gR(),AA===Rt&&(AA=s$(),AA===Rt&&(AA=P$(),AA===Rt&&(AA=H3())))))))),AA}function O$(){var AA,c$,$$,p$,H$,Q9,Lee;if(AA=UE,dr.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(Mr)),c$!==Rt){for($$=[],p$=YQ();p$!==Rt;)$$.push(p$),p$=YQ();$$!==Rt?(p$=Cq(),p$!==Rt?(H$=UE,Q9=yK(),Q9===Rt&&(Q9=null),Q9!==Rt?(Lee=P7(),Lee!==Rt?(Q9=[Q9,Lee],H$=Q9):(UE=H$,H$=Rt)):(UE=H$,H$=Rt),H$===Rt&&(H$=null),H$!==Rt?(c$=Tr(c$,p$,H$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function Z$(){var AA,c$;return AA=UE,zr.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(Fr)),c$!==Rt&&(c$=Nr()),AA=c$,AA}function mL(){var AA,c$,$$,p$;if(AA=UE,tn.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(rn)),c$!==Rt){for($$=[],p$=YQ();p$!==Rt;)$$.push(p$),p$=YQ();$$!==Rt?(p$=P7(),p$!==Rt?(c$=Tn(c$,p$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function P7(){var AA,c$,$$,p$,H$,Q9;if(AA=UE,c$=Cq(),c$!==Rt){for($$=[],p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Cq(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);p$!==Rt;)$$.push(p$),p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Cq(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);$$!==Rt?(c$=Gt(c$,$$),AA=c$):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function L9(){var AA,c$,$$,p$;if(AA=UE,$n.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(un)),c$!==Rt){for($$=[],p$=YQ();p$!==Rt;)$$.push(p$),p$=YQ();$$!==Rt?(p$=f$(),p$!==Rt?(c$=es(c$,p$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function f$(){var AA,c$,$$,p$,H$,Q9;if(AA=UE,c$=Nq(),c$!==Rt){for($$=[],p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Nq(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);p$!==Rt;)$$.push(p$),p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Nq(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);$$!==Rt?(c$=Gt(c$,$$),AA=c$):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function l$(){var AA,c$,$$,p$;if(AA=UE,kn.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(ts)),c$!==Rt){for($$=[],p$=YQ();p$!==Rt;)$$.push(p$),p$=YQ();$$!==Rt?(p$=f$(),p$!==Rt?(c$=Ko(c$,p$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function T$(){var AA,c$,$$,p$;if(AA=UE,ds.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(Il)),c$!==Rt){for($$=[],p$=YQ();p$!==Rt;)$$.push(p$),p$=YQ();$$!==Rt?(p$=q$(),p$!==Rt?(c$=Tn(c$,p$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function q$(){var AA,c$,$$,p$,H$,Q9;if(AA=UE,c$=Q$(),c$!==Rt){for($$=[],p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Q$(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);p$!==Rt;)$$.push(p$),p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Q$(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);$$!==Rt?(c$=Gt(c$,$$),AA=c$):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function Q$(){var AA,c$,$$,p$,H$,Q9;return AA=UE,c$=Cq(),c$!==Rt?($$=yK(),$$===Rt&&($$=null),$$!==Rt?(p$=Cq(),p$!==Rt?(H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Cq(),Q9!==Rt?(c$=ru(c$,p$,Q9),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt),AA}function gR(){var AA,c$,$$,p$;if(AA=UE,uu.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(p0)),c$!==Rt){for($$=[],p$=YQ();p$!==Rt;)$$.push(p$),p$=YQ();$$!==Rt?(p$=kI(),p$!==Rt?(c$=Tn(c$,p$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function kI(){var AA,c$,$$,p$,H$,Q9;if(AA=UE,c$=Pq(),c$!==Rt){for($$=[],p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Pq(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);p$!==Rt;)$$.push(p$),p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Pq(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);$$!==Rt?(c$=Gt(c$,$$),AA=c$):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function Pq(){var AA,c$,$$,p$;return AA=UE,c$=Cq(),c$!==Rt?($$=yK(),$$===Rt&&($$=null),$$!==Rt?(p$=Cq(),p$!==Rt?(c$=X1(c$,p$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt),AA}function s$(){var AA,c$,$$,p$;if(AA=UE,q0.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(W0)),c$!==Rt){for($$=[],p$=YQ();p$!==Rt;)$$.push(p$),p$=YQ();$$!==Rt?(p$=C$(),p$!==Rt?(c$=Tn(c$,p$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function C$(){var AA,c$,$$,p$,H$,Q9;if(AA=UE,c$=Y$(),c$!==Rt){for($$=[],p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Y$(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);p$!==Rt;)$$.push(p$),p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Y$(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);$$!==Rt?(c$=Gt(c$,$$),AA=c$):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function Y$(){var AA,c$,$$,p$;return AA=UE,c$=Cq(),c$!==Rt?($$=yK(),$$===Rt&&($$=null),$$!==Rt?(p$=Cq(),p$!==Rt?(c$=hu(c$,p$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt),AA}function P$(){var AA,c$,$$,p$;if(AA=UE,a1.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(Vx)),c$!==Rt){for($$=[],p$=YQ();p$!==Rt;)$$.push(p$),p$=YQ();$$!==Rt?(p$=N$(),p$!==Rt?(c$=Tn(c$,p$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function N$(){var AA,c$,$$,p$,H$,Q9;if(AA=UE,c$=Cq(),c$!==Rt){for($$=[],p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Cq(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);p$!==Rt;)$$.push(p$),p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Cq(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);$$!==Rt?(c$=Gt(c$,$$),AA=c$):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function H3(){var AA,c$,$$,p$;if(AA=UE,t0.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(cu)),c$!==Rt){for($$=[],p$=YQ();p$!==Rt;)$$.push(p$),p$=YQ();$$!==Rt?(p$=D7(),p$!==Rt?(c$=Tn(c$,p$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function D7(){var AA,c$,$$,p$,H$,Q9;if(AA=UE,c$=Tq(),c$!==Rt){for($$=[],p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Tq(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);p$!==Rt;)$$.push(p$),p$=UE,H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Tq(),Q9!==Rt?(H$=[H$,Q9],p$=H$):(UE=p$,p$=Rt)):(UE=p$,p$=Rt);$$!==Rt?(c$=Gt(c$,$$),AA=c$):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;return AA}function Tq(){var AA,c$,$$,p$,H$,Q9,Lee,lte,Vee,cte,Zee,Jee;return AA=UE,c$=PK(),c$!==Rt?($$=yK(),$$===Rt&&($$=null),$$!==Rt?(p$=PK(),p$!==Rt?(H$=yK(),H$===Rt&&(H$=null),H$!==Rt?(Q9=Nq(),Q9!==Rt?(Lee=yK(),Lee!==Rt?(lte=DK(),lte!==Rt?(Vee=yK(),Vee===Rt&&(Vee=null),Vee!==Rt?(cte=DK(),cte!==Rt?(Zee=yK(),Zee===Rt&&(Zee=null),Zee!==Rt?(Jee=Cq(),Jee!==Rt?(c$=lu(c$,p$,Q9,lte,cte,Jee),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt),AA}function Cq(){var AA,c$,$$,p$;return AA=UE,c$=Nq(),c$!==Rt?($$=yK(),$$===Rt&&($$=null),$$!==Rt?(p$=Nq(),p$!==Rt?(c$=b0(c$,p$),AA=c$):(UE=AA,AA=Rt)):(UE=AA,AA=Rt)):(UE=AA,AA=Rt),AA}function PK(){var AA,c$;return AA=UE,c$=Cee(),c$===Rt&&(c$=Tee()),c$!==Rt&&(c$=l1(c$)),AA=c$,AA}function Nq(){var AA,c$,$$,p$;return AA=UE,c$=UE,$$=GQ(),$$===Rt&&($$=null),$$!==Rt?(p$=Cee(),p$!==Rt?($$=[$$,p$],c$=$$):(UE=c$,c$=Rt)):(UE=c$,c$=Rt),c$===Rt&&(c$=UE,$$=GQ(),$$===Rt&&($$=null),$$!==Rt?(p$=Tee(),p$!==Rt?($$=[$$,p$],c$=$$):(UE=c$,c$=Rt)):(UE=c$,c$=Rt)),c$!==Rt&&(c$=LE(c$)),AA=c$,AA}function DK(){var AA,c$;return AA=UE,eS.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(SA)),c$!==Rt&&(c$=o$(c$)),AA=c$,AA}function yK(){var AA,c$,$$,p$,H$;if(AA=UE,c$=[],$$=YQ(),$$!==Rt)for(;$$!==Rt;)c$.push($$),$$=YQ();else c$=Rt;if(c$!==Rt)if($$=hee(),$$===Rt&&($$=null),$$!==Rt){for(p$=[],H$=YQ();H$!==Rt;)p$.push(H$),H$=YQ();p$!==Rt?(c$=[c$,$$,p$],AA=c$):(UE=AA,AA=Rt)}else UE=AA,AA=Rt;else UE=AA,AA=Rt;if(AA===Rt){if(AA=UE,c$=UE,$$=hee(),$$!==Rt){for(p$=[],H$=YQ();H$!==Rt;)p$.push(H$),H$=YQ();p$!==Rt?($$=[$$,p$],c$=$$):(UE=c$,c$=Rt)}else UE=c$,c$=Rt;c$!==Rt&&(c$=h$()),AA=c$}return AA}function hee(){var AA;return Et.charCodeAt(UE)===44?(AA=d$,UE++):(AA=Rt,_$(y$)),AA}function Cee(){var AA,c$,$$,p$;return AA=UE,c$=UE,$$=Oee(),$$!==Rt?(p$=fee(),p$===Rt&&(p$=null),p$!==Rt?($$=[$$,p$],c$=$$):(UE=c$,c$=Rt)):(UE=c$,c$=Rt),c$===Rt&&(c$=UE,$$=Tee(),$$!==Rt?(p$=fee(),p$!==Rt?($$=[$$,p$],c$=$$):(UE=c$,c$=Rt)):(UE=c$,c$=Rt)),c$!==Rt&&(c$=R$(c$)),AA=c$,AA}function Oee(){var AA,c$,$$,p$,H$;return AA=UE,c$=UE,$$=Tee(),$$===Rt&&($$=null),$$!==Rt?(Et.charCodeAt(UE)===46?(p$=M$,UE++):(p$=Rt,_$(x$)),p$!==Rt?(H$=Tee(),H$!==Rt?($$=[$$,p$,H$],c$=$$):(UE=c$,c$=Rt)):(UE=c$,c$=Rt)):(UE=c$,c$=Rt),c$===Rt&&(c$=UE,$$=Tee(),$$!==Rt?(Et.charCodeAt(UE)===46?(p$=M$,UE++):(p$=Rt,_$(x$)),p$!==Rt?($$=[$$,p$],c$=$$):(UE=c$,c$=Rt)):(UE=c$,c$=Rt)),c$!==Rt&&(c$=R$(c$)),AA=c$,AA}function fee(){var AA,c$,$$,p$,H$;return AA=UE,c$=UE,v$.test(Et.charAt(UE))?($$=Et.charAt(UE),UE++):($$=Rt,_$(rS)),$$!==Rt?(p$=GQ(),p$===Rt&&(p$=null),p$!==Rt?(H$=Tee(),H$!==Rt?($$=[$$,p$,H$],c$=$$):(UE=c$,c$=Rt)):(UE=c$,c$=Rt)):(UE=c$,c$=Rt),c$!==Rt&&(c$=R$(c$)),AA=c$,AA}function GQ(){var AA;return wA.test(Et.charAt(UE))?(AA=Et.charAt(UE),UE++):(AA=Rt,_$(g$)),AA}function Tee(){var AA,c$,$$;if(AA=UE,c$=[],S$.test(Et.charAt(UE))?($$=Et.charAt(UE),UE++):($$=Rt,_$(tA)),$$!==Rt)for(;$$!==Rt;)c$.push($$),S$.test(Et.charAt(UE))?($$=Et.charAt(UE),UE++):($$=Rt,_$(tA));else c$=Rt;return c$!==Rt&&(c$=tS(c$)),AA=c$,AA}function YQ(){var AA,c$;return AA=UE,m$.test(Et.charAt(UE))?(c$=Et.charAt(UE),UE++):(c$=Rt,_$(u$)),c$!==Rt&&(c$=h$()),AA=c$,AA}function kee(AA,c$){if(!c$)return[AA];for(var $$=[AA],p$=0,H$=c$.length;p$<H$;p$++)$$[p$+1]=c$[p$][1];return $$}var Nee={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var zee in Nee)Nee[zee.toUpperCase()]=Nee[zee];function Ree(AA,c$){c$||(c$=[{}]);for(var $$=c$.length;$$--;){var p$={code:AA,command:Nee[AA]};AA==AA.toLowerCase()&&(p$.relative=!0);for(var H$ in c$[$$])p$[H$]=c$[$$][H$];c$[$$]=p$}return c$}if(X$=Nt(),X$!==Rt&&UE===Et.length)return X$;throw X$!==Rt&&UE<Et.length&&_$(fL()),I$(pR,EI<Et.length?Et.charAt(EI):null,EI<Et.length?j$(EI,EI+1):j$(EI,EI))}st.exports={SyntaxError:gt,parse:_t}}),WE=Zo((nt,st)=>{var mt=pL().parse;mt.parseSVG=mt,mt.makeAbsolute=gt,st.exports=mt;function gt(_t){var Et,At={x:0,y:0},Rt={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return _t.forEach(function(Ft){Ft.command==="moveto"&&(Et=Ft),Ft.x0=At.x,Ft.y0=At.y;for(var Nt in Rt)Nt in Ft&&(Ft[Nt]+=Ft.relative?Ft[Rt[Nt]]:0);"x"in Ft||(Ft.x=At.x),"y"in Ft||(Ft.y=At.y),Ft.relative=!1,Ft.code=Ft.code.toUpperCase(),Ft.command=="closepath"&&(Ft.x=Et.x,Ft.y=Et.y),At=Ft}),_t}}),JN=Zo((nt,st)=>{st.exports=function(mt,gt){for(var _t=mt.split("."),Et=gt.split("."),At=0;At<3;At++){var Rt=Number(_t[At]),Ft=Number(Et[At]);if(Rt>Ft)return 1;if(Ft>Rt)return-1;if(!isNaN(Rt)&&isNaN(Ft))return 1;if(isNaN(Rt)&&!isNaN(Ft))return-1}return 0}}),la="149",Xn={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},cF=0,cT=1,uF=2,Ay=1,hF=2,Jf=3,Hn=0,pi=1,fi=2,Jt=0,Ya=1,uT=2,hT=3,dT=4,dF=5,Tu=100,fF=101,pF=102,fT=103,pT=104,mF=200,gF=201,yF=202,vF=203,kC=204,GC=205,xF=206,bF=207,SF=208,wF=209,AF=210,EF=0,MF=1,TF=2,zS=3,CF=4,PF=5,_F=6,DF=7,jC=0,IF=1,OF=2,Is=0,RF=1,LF=2,BF=3,NF=4,FF=5,HC=300,Qa=301,Ka=302,kS=303,GS=304,Zu=306,Os=1e3,Xt=1001,jS=1002,Vt=1003,mT=1004,iS=1005,rt$1=1006,VF=1007,dc=1008,_r=1009,UF=1010,zF=1011,WC=1012,kF=1013,Ds=1014,br=1015,Wn=1016,GF=1017,jF=1018,Xa=1020,HF=1021,qr=1023,WF=1024,qF=1025,uc=1026,Za=1027,YF=1028,XF=1029,Ju=1030,QF=1031,ww=1033,nS=33776,sS=33777,oS=33778,aS=33779,gT=35840,yT=35841,vT=35842,xT=35843,KF=36196,bT=37492,ST=37496,wT=37808,AT=37809,ET=37810,MT=37811,TT=37812,CT=37813,PT=37814,_T=37815,DT=37816,IT=37817,OT=37818,RT=37819,LT=37820,BT=37821,lS=36492,ZF=36283,NT=36284,FT=36285,VT=36286,Aw=2200,Ew=2201,Sp=2202,Xg=2300,Qg=2301,cS=2302,Cu=2400,Pu=2401,Kg=2402,Mw=2500,JF=2501,mn=3e3,at$1=3001,Bi=3200,Tw=3201,$F=0,eV=1,co="srgb",sp="srgb-linear",uS=7680,tV=519,HS=35044,qC=35048,UT="300 es",WS=1035,pr=class{addEventListener(nt,st){this._listeners===void 0&&(this._listeners={});let mt=this._listeners;mt[nt]===void 0&&(mt[nt]=[]),mt[nt].indexOf(st)===-1&&mt[nt].push(st)}hasEventListener(nt,st){if(this._listeners===void 0)return!1;let mt=this._listeners;return mt[nt]!==void 0&&mt[nt].indexOf(st)!==-1}removeEventListener(nt,st){if(this._listeners===void 0)return;let mt=this._listeners[nt];if(mt!==void 0){let gt=mt.indexOf(st);gt!==-1&&mt.splice(gt,1)}}dispatchEvent(nt){if(this._listeners===void 0)return;let st=this._listeners[nt.type];if(st!==void 0){nt.target=this;let mt=st.slice(0);for(let gt=0,_t=mt.length;gt<_t;gt++)mt[gt].call(this,nt);nt.target=null}}},nn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],zT=1234567,ep=Math.PI/180,op=180/Math.PI;function is(){let nt=Math.random()*4294967295|0,st=Math.random()*4294967295|0,mt=Math.random()*4294967295|0,gt=Math.random()*4294967295|0;return(nn[nt&255]+nn[nt>>8&255]+nn[nt>>16&255]+nn[nt>>24&255]+"-"+nn[st&255]+nn[st>>8&255]+"-"+nn[st>>16&15|64]+nn[st>>24&255]+"-"+nn[mt&63|128]+nn[mt>>8&255]+"-"+nn[mt>>16&255]+nn[mt>>24&255]+nn[gt&255]+nn[gt>>8&255]+nn[gt>>16&255]+nn[gt>>24&255]).toLowerCase()}function di(nt,st,mt){return Math.max(st,Math.min(mt,nt))}function Cw(nt,st){return(nt%st+st)%st}function rV(nt,st,mt,gt,_t){return gt+(nt-st)*(_t-gt)/(mt-st)}function iV(nt,st,mt){return nt!==st?(mt-nt)/(st-nt):0}function tp(nt,st,mt){return(1-mt)*nt+mt*st}function nV(nt,st,mt,gt){return tp(nt,st,1-Math.exp(-mt*gt))}function sV(nt,st=1){return st-Math.abs(Cw(nt,st*2)-st)}function oV(nt,st,mt){return nt<=st?0:nt>=mt?1:(nt=(nt-st)/(mt-st),nt*nt*(3-2*nt))}function aV(nt,st,mt){return nt<=st?0:nt>=mt?1:(nt=(nt-st)/(mt-st),nt*nt*nt*(nt*(nt*6-15)+10))}function lV(nt,st){return nt+Math.floor(Math.random()*(st-nt+1))}function cV(nt,st){return nt+Math.random()*(st-nt)}function uV(nt){return nt*(.5-Math.random())}function hV(nt){nt!==void 0&&(zT=nt);let st=zT+=1831565813;return st=Math.imul(st^st>>>15,st|1),st^=st+Math.imul(st^st>>>7,st|61),((st^st>>>14)>>>0)/4294967296}function dV(nt){return nt*ep}function fV(nt){return nt*op}function qS(nt){return(nt&nt-1)===0&&nt!==0}function YC(nt){return Math.pow(2,Math.ceil(Math.log(nt)/Math.LN2))}function Zg(nt){return Math.pow(2,Math.floor(Math.log(nt)/Math.LN2))}function pV(nt,st,mt,gt,_t){let Et=Math.cos,At=Math.sin,Rt=Et(mt/2),Ft=At(mt/2),Nt=Et((st+gt)/2),Bt=At((st+gt)/2),Gt=Et((st-gt)/2),dr=At((st-gt)/2),Mr=Et((gt-st)/2),Tr=At((gt-st)/2);switch(_t){case"XYX":nt.set(Rt*Bt,Ft*Gt,Ft*dr,Rt*Nt);break;case"YZY":nt.set(Ft*dr,Rt*Bt,Ft*Gt,Rt*Nt);break;case"ZXZ":nt.set(Ft*Gt,Ft*dr,Rt*Bt,Rt*Nt);break;case"XZX":nt.set(Rt*Bt,Ft*Tr,Ft*Mr,Rt*Nt);break;case"YXY":nt.set(Ft*Mr,Rt*Bt,Ft*Tr,Rt*Nt);break;case"ZYZ":nt.set(Ft*Tr,Ft*Mr,Rt*Bt,Rt*Nt);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+_t)}}function oa(nt,st){switch(st.constructor){case Float32Array:return nt;case Uint16Array:return nt/65535;case Uint8Array:return nt/255;case Int16Array:return Math.max(nt/32767,-1);case Int8Array:return Math.max(nt/127,-1);default:throw new Error("Invalid component type.")}}function xr(nt,st){switch(st.constructor){case Float32Array:return nt;case Uint16Array:return Math.round(nt*65535);case Uint8Array:return Math.round(nt*255);case Int16Array:return Math.round(nt*32767);case Int8Array:return Math.round(nt*127);default:throw new Error("Invalid component type.")}}var we$1=Object.freeze({__proto__:null,DEG2RAD:ep,RAD2DEG:op,ceilPowerOfTwo:YC,clamp:di,damp:nV,degToRad:dV,denormalize:oa,euclideanModulo:Cw,floorPowerOfTwo:Zg,generateUUID:is,inverseLerp:iV,isPowerOfTwo:qS,lerp:tp,mapLinear:rV,normalize:xr,pingpong:sV,radToDeg:fV,randFloat:cV,randFloatSpread:uV,randInt:lV,seededRandom:hV,setQuaternionFromProperEuler:pV,smootherstep:aV,smoothstep:oV}),U$1=class{constructor(st=0,mt=0){U$1.prototype.isVector2=!0,this.x=st,this.y=mt}get width(){return this.x}set width(st){this.x=st}get height(){return this.y}set height(st){this.y=st}set(st,mt){return this.x=st,this.y=mt,this}setScalar(st){return this.x=st,this.y=st,this}setX(st){return this.x=st,this}setY(st){return this.y=st,this}setComponent(st,mt){switch(st){case 0:this.x=mt;break;case 1:this.y=mt;break;default:throw new Error("index is out of range: "+st)}return this}getComponent(st){switch(st){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+st)}}clone(){return new this.constructor(this.x,this.y)}copy(st){return this.x=st.x,this.y=st.y,this}add(st){return this.x+=st.x,this.y+=st.y,this}addScalar(st){return this.x+=st,this.y+=st,this}addVectors(st,mt){return this.x=st.x+mt.x,this.y=st.y+mt.y,this}addScaledVector(st,mt){return this.x+=st.x*mt,this.y+=st.y*mt,this}sub(st){return this.x-=st.x,this.y-=st.y,this}subScalar(st){return this.x-=st,this.y-=st,this}subVectors(st,mt){return this.x=st.x-mt.x,this.y=st.y-mt.y,this}multiply(st){return this.x*=st.x,this.y*=st.y,this}multiplyScalar(st){return this.x*=st,this.y*=st,this}divide(st){return this.x/=st.x,this.y/=st.y,this}divideScalar(st){return this.multiplyScalar(1/st)}applyMatrix3(st){let mt=this.x,gt=this.y,_t=st.elements;return this.x=_t[0]*mt+_t[3]*gt+_t[6],this.y=_t[1]*mt+_t[4]*gt+_t[7],this}min(st){return this.x=Math.min(this.x,st.x),this.y=Math.min(this.y,st.y),this}max(st){return this.x=Math.max(this.x,st.x),this.y=Math.max(this.y,st.y),this}clamp(st,mt){return this.x=Math.max(st.x,Math.min(mt.x,this.x)),this.y=Math.max(st.y,Math.min(mt.y,this.y)),this}clampScalar(st,mt){return this.x=Math.max(st,Math.min(mt,this.x)),this.y=Math.max(st,Math.min(mt,this.y)),this}clampLength(st,mt){let gt=this.length();return this.divideScalar(gt||1).multiplyScalar(Math.max(st,Math.min(mt,gt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(st){return this.x*st.x+this.y*st.y}cross(st){return this.x*st.y-this.y*st.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(st){return Math.sqrt(this.distanceToSquared(st))}distanceToSquared(st){let mt=this.x-st.x,gt=this.y-st.y;return mt*mt+gt*gt}manhattanDistanceTo(st){return Math.abs(this.x-st.x)+Math.abs(this.y-st.y)}setLength(st){return this.normalize().multiplyScalar(st)}lerp(st,mt){return this.x+=(st.x-this.x)*mt,this.y+=(st.y-this.y)*mt,this}lerpVectors(st,mt,gt){return this.x=st.x+(mt.x-st.x)*gt,this.y=st.y+(mt.y-st.y)*gt,this}equals(st){return st.x===this.x&&st.y===this.y}fromArray(st,mt=0){return this.x=st[mt],this.y=st[mt+1],this}toArray(st=[],mt=0){return st[mt]=this.x,st[mt+1]=this.y,st}fromBufferAttribute(st,mt){return this.x=st.getX(mt),this.y=st.getY(mt),this}rotateAround(st,mt){let gt=Math.cos(mt),_t=Math.sin(mt),Et=this.x-st.x,At=this.y-st.y;return this.x=Et*gt-At*_t+st.x,this.y=Et*_t+At*gt+st.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},fr=class{constructor(){fr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(nt,st,mt,gt,_t,Et,At,Rt,Ft){let Nt=this.elements;return Nt[0]=nt,Nt[1]=gt,Nt[2]=At,Nt[3]=st,Nt[4]=_t,Nt[5]=Rt,Nt[6]=mt,Nt[7]=Et,Nt[8]=Ft,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(nt){let st=this.elements,mt=nt.elements;return st[0]=mt[0],st[1]=mt[1],st[2]=mt[2],st[3]=mt[3],st[4]=mt[4],st[5]=mt[5],st[6]=mt[6],st[7]=mt[7],st[8]=mt[8],this}extractBasis(nt,st,mt){return nt.setFromMatrix3Column(this,0),st.setFromMatrix3Column(this,1),mt.setFromMatrix3Column(this,2),this}setFromMatrix4(nt){let st=nt.elements;return this.set(st[0],st[4],st[8],st[1],st[5],st[9],st[2],st[6],st[10]),this}multiply(nt){return this.multiplyMatrices(this,nt)}premultiply(nt){return this.multiplyMatrices(nt,this)}multiplyMatrices(nt,st){let mt=nt.elements,gt=st.elements,_t=this.elements,Et=mt[0],At=mt[3],Rt=mt[6],Ft=mt[1],Nt=mt[4],Bt=mt[7],Gt=mt[2],dr=mt[5],Mr=mt[8],Tr=gt[0],zr=gt[3],Fr=gt[6],Nr=gt[1],tn=gt[4],rn=gt[7],Tn=gt[2],$n=gt[5],un=gt[8];return _t[0]=Et*Tr+At*Nr+Rt*Tn,_t[3]=Et*zr+At*tn+Rt*$n,_t[6]=Et*Fr+At*rn+Rt*un,_t[1]=Ft*Tr+Nt*Nr+Bt*Tn,_t[4]=Ft*zr+Nt*tn+Bt*$n,_t[7]=Ft*Fr+Nt*rn+Bt*un,_t[2]=Gt*Tr+dr*Nr+Mr*Tn,_t[5]=Gt*zr+dr*tn+Mr*$n,_t[8]=Gt*Fr+dr*rn+Mr*un,this}multiplyScalar(nt){let st=this.elements;return st[0]*=nt,st[3]*=nt,st[6]*=nt,st[1]*=nt,st[4]*=nt,st[7]*=nt,st[2]*=nt,st[5]*=nt,st[8]*=nt,this}determinant(){let nt=this.elements,st=nt[0],mt=nt[1],gt=nt[2],_t=nt[3],Et=nt[4],At=nt[5],Rt=nt[6],Ft=nt[7],Nt=nt[8];return st*Et*Nt-st*At*Ft-mt*_t*Nt+mt*At*Rt+gt*_t*Ft-gt*Et*Rt}invert(){let nt=this.elements,st=nt[0],mt=nt[1],gt=nt[2],_t=nt[3],Et=nt[4],At=nt[5],Rt=nt[6],Ft=nt[7],Nt=nt[8],Bt=Nt*Et-At*Ft,Gt=At*Rt-Nt*_t,dr=Ft*_t-Et*Rt,Mr=st*Bt+mt*Gt+gt*dr;if(Mr===0)return this.set(0,0,0,0,0,0,0,0,0);let Tr=1/Mr;return nt[0]=Bt*Tr,nt[1]=(gt*Ft-Nt*mt)*Tr,nt[2]=(At*mt-gt*Et)*Tr,nt[3]=Gt*Tr,nt[4]=(Nt*st-gt*Rt)*Tr,nt[5]=(gt*_t-At*st)*Tr,nt[6]=dr*Tr,nt[7]=(mt*Rt-Ft*st)*Tr,nt[8]=(Et*st-mt*_t)*Tr,this}transpose(){let nt,st=this.elements;return nt=st[1],st[1]=st[3],st[3]=nt,nt=st[2],st[2]=st[6],st[6]=nt,nt=st[5],st[5]=st[7],st[7]=nt,this}getNormalMatrix(nt){return this.setFromMatrix4(nt).invert().transpose()}transposeIntoArray(nt){let st=this.elements;return nt[0]=st[0],nt[1]=st[3],nt[2]=st[6],nt[3]=st[1],nt[4]=st[4],nt[5]=st[7],nt[6]=st[2],nt[7]=st[5],nt[8]=st[8],this}setUvTransform(nt,st,mt,gt,_t,Et,At){let Rt=Math.cos(_t),Ft=Math.sin(_t);return this.set(mt*Rt,mt*Ft,-mt*(Rt*Et+Ft*At)+Et+nt,-gt*Ft,gt*Rt,-gt*(-Ft*Et+Rt*At)+At+st,0,0,1),this}scale(nt,st){return this.premultiply(hS.makeScale(nt,st)),this}rotate(nt){return this.premultiply(hS.makeRotation(-nt)),this}translate(nt,st){return this.premultiply(hS.makeTranslation(nt,st)),this}makeTranslation(nt,st){return this.set(1,0,nt,0,1,st,0,0,1),this}makeRotation(nt){let st=Math.cos(nt),mt=Math.sin(nt);return this.set(st,-mt,0,mt,st,0,0,0,1),this}makeScale(nt,st){return this.set(nt,0,0,0,st,0,0,0,1),this}equals(nt){let st=this.elements,mt=nt.elements;for(let gt=0;gt<9;gt++)if(st[gt]!==mt[gt])return!1;return!0}fromArray(nt,st=0){for(let mt=0;mt<9;mt++)this.elements[mt]=nt[mt+st];return this}toArray(nt=[],st=0){let mt=this.elements;return nt[st]=mt[0],nt[st+1]=mt[1],nt[st+2]=mt[2],nt[st+3]=mt[3],nt[st+4]=mt[4],nt[st+5]=mt[5],nt[st+6]=mt[6],nt[st+7]=mt[7],nt[st+8]=mt[8],nt}clone(){return new this.constructor().fromArray(this.elements)}},hS=new fr;function XC(nt){for(let st=nt.length-1;st>=0;--st)if(nt[st]>=65535)return!0;return!1}var mV={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function xg(nt,st){return new mV[nt](st)}function ap(nt){return document.createElementNS("http://www.w3.org/1999/xhtml",nt)}function hc(nt){return nt<.04045?nt*.0773993808:Math.pow(nt*.9478672986+.0521327014,2.4)}function Yg(nt){return nt<.0031308?nt*12.92:1.055*Math.pow(nt,.41666)-.055}var dS={[co]:{[sp]:hc},[sp]:{[co]:Yg}},dn={legacyMode:!0,get workingColorSpace(){return sp},set workingColorSpace(nt){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(nt,st,mt){if(this.legacyMode||st===mt||!st||!mt)return nt;if(dS[st]&&dS[st][mt]!==void 0){let gt=dS[st][mt];return nt.r=gt(nt.r),nt.g=gt(nt.g),nt.b=gt(nt.b),nt}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(nt,st){return this.convert(nt,this.workingColorSpace,st)},toWorkingColorSpace:function(nt,st){return this.convert(nt,st,this.workingColorSpace)}},QC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},wi={r:0,g:0,b:0},Cs={h:0,s:0,l:0},bg={h:0,s:0,l:0};function fS(nt,st,mt){return mt<0&&(mt+=1),mt>1&&(mt-=1),mt<1/6?nt+(st-nt)*6*mt:mt<1/2?st:mt<2/3?nt+(st-nt)*6*(2/3-mt):nt}function Sg(nt,st){return st.r=nt.r,st.g=nt.g,st.b=nt.b,st}var We$1=class{constructor(st,mt,gt){return this.isColor=!0,this.r=1,this.g=1,this.b=1,mt===void 0&&gt===void 0?this.set(st):this.setRGB(st,mt,gt)}set(st){return st&&st.isColor?this.copy(st):typeof st=="number"?this.setHex(st):typeof st=="string"&&this.setStyle(st),this}setScalar(st){return this.r=st,this.g=st,this.b=st,this}setHex(st,mt=co){return st=Math.floor(st),this.r=(st>>16&255)/255,this.g=(st>>8&255)/255,this.b=(st&255)/255,dn.toWorkingColorSpace(this,mt),this}setRGB(st,mt,gt,_t=dn.workingColorSpace){return this.r=st,this.g=mt,this.b=gt,dn.toWorkingColorSpace(this,_t),this}setHSL(st,mt,gt,_t=dn.workingColorSpace){if(st=Cw(st,1),mt=di(mt,0,1),gt=di(gt,0,1),mt===0)this.r=this.g=this.b=gt;else{let Et=gt<=.5?gt*(1+mt):gt+mt-gt*mt,At=2*gt-Et;this.r=fS(At,Et,st+1/3),this.g=fS(At,Et,st),this.b=fS(At,Et,st-1/3)}return dn.toWorkingColorSpace(this,_t),this}setStyle(st,mt=co){function gt(Et){Et!==void 0&&parseFloat(Et)<1&&console.warn("THREE.Color: Alpha component of "+st+" will be ignored.")}let _t;if(_t=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(st)){let Et,At=_t[1],Rt=_t[2];switch(At){case"rgb":case"rgba":if(Et=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(Rt))return this.r=Math.min(255,parseInt(Et[1],10))/255,this.g=Math.min(255,parseInt(Et[2],10))/255,this.b=Math.min(255,parseInt(Et[3],10))/255,dn.toWorkingColorSpace(this,mt),gt(Et[4]),this;if(Et=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(Rt))return this.r=Math.min(100,parseInt(Et[1],10))/100,this.g=Math.min(100,parseInt(Et[2],10))/100,this.b=Math.min(100,parseInt(Et[3],10))/100,dn.toWorkingColorSpace(this,mt),gt(Et[4]),this;break;case"hsl":case"hsla":if(Et=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(Rt)){let Ft=parseFloat(Et[1])/360,Nt=parseFloat(Et[2])/100,Bt=parseFloat(Et[3])/100;return gt(Et[4]),this.setHSL(Ft,Nt,Bt,mt)}break}}else if(_t=/^\#([A-Fa-f\d]+)$/.exec(st)){let Et=_t[1],At=Et.length;if(At===3)return this.r=parseInt(Et.charAt(0)+Et.charAt(0),16)/255,this.g=parseInt(Et.charAt(1)+Et.charAt(1),16)/255,this.b=parseInt(Et.charAt(2)+Et.charAt(2),16)/255,dn.toWorkingColorSpace(this,mt),this;if(At===6)return this.r=parseInt(Et.charAt(0)+Et.charAt(1),16)/255,this.g=parseInt(Et.charAt(2)+Et.charAt(3),16)/255,this.b=parseInt(Et.charAt(4)+Et.charAt(5),16)/255,dn.toWorkingColorSpace(this,mt),this}return st&&st.length>0?this.setColorName(st,mt):this}setColorName(st,mt=co){let gt=QC[st.toLowerCase()];return gt!==void 0?this.setHex(gt,mt):console.warn("THREE.Color: Unknown color "+st),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(st){return this.r=st.r,this.g=st.g,this.b=st.b,this}copySRGBToLinear(st){return this.r=hc(st.r),this.g=hc(st.g),this.b=hc(st.b),this}copyLinearToSRGB(st){return this.r=Yg(st.r),this.g=Yg(st.g),this.b=Yg(st.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(st=co){return dn.fromWorkingColorSpace(Sg(this,wi),st),di(wi.r*255,0,255)<<16^di(wi.g*255,0,255)<<8^di(wi.b*255,0,255)<<0}getHexString(st=co){return("000000"+this.getHex(st).toString(16)).slice(-6)}getHSL(st,mt=dn.workingColorSpace){dn.fromWorkingColorSpace(Sg(this,wi),mt);let gt=wi.r,_t=wi.g,Et=wi.b,At=Math.max(gt,_t,Et),Rt=Math.min(gt,_t,Et),Ft,Nt,Bt=(Rt+At)/2;if(Rt===At)Ft=0,Nt=0;else{let Gt=At-Rt;switch(Nt=Bt<=.5?Gt/(At+Rt):Gt/(2-At-Rt),At){case gt:Ft=(_t-Et)/Gt+(_t<Et?6:0);break;case _t:Ft=(Et-gt)/Gt+2;break;case Et:Ft=(gt-_t)/Gt+4;break}Ft/=6}return st.h=Ft,st.s=Nt,st.l=Bt,st}getRGB(st,mt=dn.workingColorSpace){return dn.fromWorkingColorSpace(Sg(this,wi),mt),st.r=wi.r,st.g=wi.g,st.b=wi.b,st}getStyle(st=co){return dn.fromWorkingColorSpace(Sg(this,wi),st),st!==co?`color(${st} ${wi.r} ${wi.g} ${wi.b})`:`rgb(${wi.r*255|0},${wi.g*255|0},${wi.b*255|0})`}offsetHSL(st,mt,gt){return this.getHSL(Cs),Cs.h+=st,Cs.s+=mt,Cs.l+=gt,this.setHSL(Cs.h,Cs.s,Cs.l),this}add(st){return this.r+=st.r,this.g+=st.g,this.b+=st.b,this}addColors(st,mt){return this.r=st.r+mt.r,this.g=st.g+mt.g,this.b=st.b+mt.b,this}addScalar(st){return this.r+=st,this.g+=st,this.b+=st,this}sub(st){return this.r=Math.max(0,this.r-st.r),this.g=Math.max(0,this.g-st.g),this.b=Math.max(0,this.b-st.b),this}multiply(st){return this.r*=st.r,this.g*=st.g,this.b*=st.b,this}multiplyScalar(st){return this.r*=st,this.g*=st,this.b*=st,this}lerp(st,mt){return this.r+=(st.r-this.r)*mt,this.g+=(st.g-this.g)*mt,this.b+=(st.b-this.b)*mt,this}lerpColors(st,mt,gt){return this.r=st.r+(mt.r-st.r)*gt,this.g=st.g+(mt.g-st.g)*gt,this.b=st.b+(mt.b-st.b)*gt,this}lerpHSL(st,mt){this.getHSL(Cs),st.getHSL(bg);let gt=tp(Cs.h,bg.h,mt),_t=tp(Cs.s,bg.s,mt),Et=tp(Cs.l,bg.l,mt);return this.setHSL(gt,_t,Et),this}equals(st){return st.r===this.r&&st.g===this.g&&st.b===this.b}fromArray(st,mt=0){return this.r=st[mt],this.g=st[mt+1],this.b=st[mt+2],this}toArray(st=[],mt=0){return st[mt]=this.r,st[mt+1]=this.g,st[mt+2]=this.b,st}fromBufferAttribute(st,mt){return this.r=st.getX(mt),this.g=st.getY(mt),this.b=st.getZ(mt),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};We$1.NAMES=QC;var du,Jg=class{static getDataURL(nt){if(/^data:/i.test(nt.src)||typeof HTMLCanvasElement>"u")return nt.src;let st;if(nt instanceof HTMLCanvasElement)st=nt;else{du===void 0&&(du=ap("canvas")),du.width=nt.width,du.height=nt.height;let mt=du.getContext("2d");nt instanceof ImageData?mt.putImageData(nt,0,0):mt.drawImage(nt,0,0,nt.width,nt.height),st=du}return st.width>2048||st.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",nt),st.toDataURL("image/jpeg",.6)):st.toDataURL("image/png")}static sRGBToLinear(nt){if(typeof HTMLImageElement<"u"&&nt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&nt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&nt instanceof ImageBitmap){let st=ap("canvas");st.width=nt.width,st.height=nt.height;let mt=st.getContext("2d");mt.drawImage(nt,0,0,nt.width,nt.height);let gt=mt.getImageData(0,0,nt.width,nt.height),_t=gt.data;for(let Et=0;Et<_t.length;Et++)_t[Et]=hc(_t[Et]/255)*255;return mt.putImageData(gt,0,0),st}else if(nt.data){let st=nt.data.slice(0);for(let mt=0;mt<st.length;mt++)st instanceof Uint8Array||st instanceof Uint8ClampedArray?st[mt]=Math.floor(hc(st[mt]/255)*255):st[mt]=hc(st[mt]);return{data:st,width:nt.width,height:nt.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),nt}},$g=class{constructor(nt=null){this.isSource=!0,this.uuid=is(),this.data=nt,this.version=0}set needsUpdate(nt){nt===!0&&this.version++}toJSON(nt){let st=nt===void 0||typeof nt=="string";if(!st&&nt.images[this.uuid]!==void 0)return nt.images[this.uuid];let mt={uuid:this.uuid,url:""},gt=this.data;if(gt!==null){let _t;if(Array.isArray(gt)){_t=[];for(let Et=0,At=gt.length;Et<At;Et++)gt[Et].isDataTexture?_t.push(pS(gt[Et].image)):_t.push(pS(gt[Et]))}else _t=pS(gt);mt.url=_t}return st||(nt.images[this.uuid]=mt),mt}};function pS(nt){return typeof HTMLImageElement<"u"&&nt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&nt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&nt instanceof ImageBitmap?Jg.getDataURL(nt):nt.data?{data:Array.from(nt.data),width:nt.width,height:nt.height,type:nt.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var gV=0,$t=class extends pr{constructor(nt=$t.DEFAULT_IMAGE,st=$t.DEFAULT_MAPPING,mt=Xt,gt=Xt,_t=rt$1,Et=dc,At=qr,Rt=_r,Ft=$t.DEFAULT_ANISOTROPY,Nt=mn){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:gV++}),this.uuid=is(),this.name="",this.source=new $g(nt),this.mipmaps=[],this.mapping=st,this.wrapS=mt,this.wrapT=gt,this.magFilter=_t,this.minFilter=Et,this.anisotropy=Ft,this.format=At,this.internalFormat=null,this.type=Rt,this.offset=new U$1(0,0),this.repeat=new U$1(1,1),this.center=new U$1(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new fr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=Nt,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(nt){this.source.data=nt}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(nt){return this.name=nt.name,this.source=nt.source,this.mipmaps=nt.mipmaps.slice(0),this.mapping=nt.mapping,this.wrapS=nt.wrapS,this.wrapT=nt.wrapT,this.magFilter=nt.magFilter,this.minFilter=nt.minFilter,this.anisotropy=nt.anisotropy,this.format=nt.format,this.internalFormat=nt.internalFormat,this.type=nt.type,this.offset.copy(nt.offset),this.repeat.copy(nt.repeat),this.center.copy(nt.center),this.rotation=nt.rotation,this.matrixAutoUpdate=nt.matrixAutoUpdate,this.matrix.copy(nt.matrix),this.generateMipmaps=nt.generateMipmaps,this.premultiplyAlpha=nt.premultiplyAlpha,this.flipY=nt.flipY,this.unpackAlignment=nt.unpackAlignment,this.encoding=nt.encoding,this.userData=JSON.parse(JSON.stringify(nt.userData)),this.needsUpdate=!0,this}toJSON(nt){let st=nt===void 0||typeof nt=="string";if(!st&&nt.textures[this.uuid]!==void 0)return nt.textures[this.uuid];let mt={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(nt).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(mt.userData=this.userData),st||(nt.textures[this.uuid]=mt),mt}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(nt){if(this.mapping!==HC)return nt;if(nt.applyMatrix3(this.matrix),nt.x<0||nt.x>1)switch(this.wrapS){case Os:nt.x=nt.x-Math.floor(nt.x);break;case Xt:nt.x=nt.x<0?0:1;break;case jS:Math.abs(Math.floor(nt.x)%2)===1?nt.x=Math.ceil(nt.x)-nt.x:nt.x=nt.x-Math.floor(nt.x);break}if(nt.y<0||nt.y>1)switch(this.wrapT){case Os:nt.y=nt.y-Math.floor(nt.y);break;case Xt:nt.y=nt.y<0?0:1;break;case jS:Math.abs(Math.floor(nt.y)%2)===1?nt.y=Math.ceil(nt.y)-nt.y:nt.y=nt.y-Math.floor(nt.y);break}return this.flipY&&(nt.y=1-nt.y),nt}set needsUpdate(nt){nt===!0&&(this.version++,this.source.needsUpdate=!0)}};$t.DEFAULT_IMAGE=null;$t.DEFAULT_MAPPING=HC;$t.DEFAULT_ANISOTROPY=1;var Ze$1=class{constructor(st=0,mt=0,gt=0,_t=1){Ze$1.prototype.isVector4=!0,this.x=st,this.y=mt,this.z=gt,this.w=_t}get width(){return this.z}set width(st){this.z=st}get height(){return this.w}set height(st){this.w=st}set(st,mt,gt,_t){return this.x=st,this.y=mt,this.z=gt,this.w=_t,this}setScalar(st){return this.x=st,this.y=st,this.z=st,this.w=st,this}setX(st){return this.x=st,this}setY(st){return this.y=st,this}setZ(st){return this.z=st,this}setW(st){return this.w=st,this}setComponent(st,mt){switch(st){case 0:this.x=mt;break;case 1:this.y=mt;break;case 2:this.z=mt;break;case 3:this.w=mt;break;default:throw new Error("index is out of range: "+st)}return this}getComponent(st){switch(st){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+st)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(st){return this.x=st.x,this.y=st.y,this.z=st.z,this.w=st.w!==void 0?st.w:1,this}add(st){return this.x+=st.x,this.y+=st.y,this.z+=st.z,this.w+=st.w,this}addScalar(st){return this.x+=st,this.y+=st,this.z+=st,this.w+=st,this}addVectors(st,mt){return this.x=st.x+mt.x,this.y=st.y+mt.y,this.z=st.z+mt.z,this.w=st.w+mt.w,this}addScaledVector(st,mt){return this.x+=st.x*mt,this.y+=st.y*mt,this.z+=st.z*mt,this.w+=st.w*mt,this}sub(st){return this.x-=st.x,this.y-=st.y,this.z-=st.z,this.w-=st.w,this}subScalar(st){return this.x-=st,this.y-=st,this.z-=st,this.w-=st,this}subVectors(st,mt){return this.x=st.x-mt.x,this.y=st.y-mt.y,this.z=st.z-mt.z,this.w=st.w-mt.w,this}multiply(st){return this.x*=st.x,this.y*=st.y,this.z*=st.z,this.w*=st.w,this}multiplyScalar(st){return this.x*=st,this.y*=st,this.z*=st,this.w*=st,this}applyMatrix4(st){let mt=this.x,gt=this.y,_t=this.z,Et=this.w,At=st.elements;return this.x=At[0]*mt+At[4]*gt+At[8]*_t+At[12]*Et,this.y=At[1]*mt+At[5]*gt+At[9]*_t+At[13]*Et,this.z=At[2]*mt+At[6]*gt+At[10]*_t+At[14]*Et,this.w=At[3]*mt+At[7]*gt+At[11]*_t+At[15]*Et,this}divideScalar(st){return this.multiplyScalar(1/st)}setAxisAngleFromQuaternion(st){this.w=2*Math.acos(st.w);let mt=Math.sqrt(1-st.w*st.w);return mt<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=st.x/mt,this.y=st.y/mt,this.z=st.z/mt),this}setAxisAngleFromRotationMatrix(st){let mt,gt,_t,Et,At=st.elements,Rt=At[0],Ft=At[4],Nt=At[8],Bt=At[1],Gt=At[5],dr=At[9],Mr=At[2],Tr=At[6],zr=At[10];if(Math.abs(Ft-Bt)<.01&&Math.abs(Nt-Mr)<.01&&Math.abs(dr-Tr)<.01){if(Math.abs(Ft+Bt)<.1&&Math.abs(Nt+Mr)<.1&&Math.abs(dr+Tr)<.1&&Math.abs(Rt+Gt+zr-3)<.1)return this.set(1,0,0,0),this;mt=Math.PI;let Nr=(Rt+1)/2,tn=(Gt+1)/2,rn=(zr+1)/2,Tn=(Ft+Bt)/4,$n=(Nt+Mr)/4,un=(dr+Tr)/4;return Nr>tn&&Nr>rn?Nr<.01?(gt=0,_t=.707106781,Et=.707106781):(gt=Math.sqrt(Nr),_t=Tn/gt,Et=$n/gt):tn>rn?tn<.01?(gt=.707106781,_t=0,Et=.707106781):(_t=Math.sqrt(tn),gt=Tn/_t,Et=un/_t):rn<.01?(gt=.707106781,_t=.707106781,Et=0):(Et=Math.sqrt(rn),gt=$n/Et,_t=un/Et),this.set(gt,_t,Et,mt),this}let Fr=Math.sqrt((Tr-dr)*(Tr-dr)+(Nt-Mr)*(Nt-Mr)+(Bt-Ft)*(Bt-Ft));return Math.abs(Fr)<.001&&(Fr=1),this.x=(Tr-dr)/Fr,this.y=(Nt-Mr)/Fr,this.z=(Bt-Ft)/Fr,this.w=Math.acos((Rt+Gt+zr-1)/2),this}min(st){return this.x=Math.min(this.x,st.x),this.y=Math.min(this.y,st.y),this.z=Math.min(this.z,st.z),this.w=Math.min(this.w,st.w),this}max(st){return this.x=Math.max(this.x,st.x),this.y=Math.max(this.y,st.y),this.z=Math.max(this.z,st.z),this.w=Math.max(this.w,st.w),this}clamp(st,mt){return this.x=Math.max(st.x,Math.min(mt.x,this.x)),this.y=Math.max(st.y,Math.min(mt.y,this.y)),this.z=Math.max(st.z,Math.min(mt.z,this.z)),this.w=Math.max(st.w,Math.min(mt.w,this.w)),this}clampScalar(st,mt){return this.x=Math.max(st,Math.min(mt,this.x)),this.y=Math.max(st,Math.min(mt,this.y)),this.z=Math.max(st,Math.min(mt,this.z)),this.w=Math.max(st,Math.min(mt,this.w)),this}clampLength(st,mt){let gt=this.length();return this.divideScalar(gt||1).multiplyScalar(Math.max(st,Math.min(mt,gt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(st){return this.x*st.x+this.y*st.y+this.z*st.z+this.w*st.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(st){return this.normalize().multiplyScalar(st)}lerp(st,mt){return this.x+=(st.x-this.x)*mt,this.y+=(st.y-this.y)*mt,this.z+=(st.z-this.z)*mt,this.w+=(st.w-this.w)*mt,this}lerpVectors(st,mt,gt){return this.x=st.x+(mt.x-st.x)*gt,this.y=st.y+(mt.y-st.y)*gt,this.z=st.z+(mt.z-st.z)*gt,this.w=st.w+(mt.w-st.w)*gt,this}equals(st){return st.x===this.x&&st.y===this.y&&st.z===this.z&&st.w===this.w}fromArray(st,mt=0){return this.x=st[mt],this.y=st[mt+1],this.z=st[mt+2],this.w=st[mt+3],this}toArray(st=[],mt=0){return st[mt]=this.x,st[mt+1]=this.y,st[mt+2]=this.z,st[mt+3]=this.w,st}fromBufferAttribute(st,mt){return this.x=st.getX(mt),this.y=st.getY(mt),this.z=st.getZ(mt),this.w=st.getW(mt),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},dt$1=class extends pr{constructor(st=1,mt=1,gt={}){super(),this.isWebGLRenderTarget=!0,this.width=st,this.height=mt,this.depth=1,this.scissor=new Ze$1(0,0,st,mt),this.scissorTest=!1,this.viewport=new Ze$1(0,0,st,mt);let _t={width:st,height:mt,depth:1};this.texture=new $t(_t,gt.mapping,gt.wrapS,gt.wrapT,gt.magFilter,gt.minFilter,gt.format,gt.type,gt.anisotropy,gt.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=gt.generateMipmaps!==void 0?gt.generateMipmaps:!1,this.texture.internalFormat=gt.internalFormat!==void 0?gt.internalFormat:null,this.texture.minFilter=gt.minFilter!==void 0?gt.minFilter:rt$1,this.depthBuffer=gt.depthBuffer!==void 0?gt.depthBuffer:!0,this.stencilBuffer=gt.stencilBuffer!==void 0?gt.stencilBuffer:!1,this.depthTexture=gt.depthTexture!==void 0?gt.depthTexture:null,this.samples=gt.samples!==void 0?gt.samples:0}setSize(st,mt,gt=1){(this.width!==st||this.height!==mt||this.depth!==gt)&&(this.width=st,this.height=mt,this.depth=gt,this.texture.image.width=st,this.texture.image.height=mt,this.texture.image.depth=gt,this.dispose()),this.viewport.set(0,0,st,mt),this.scissor.set(0,0,st,mt)}clone(){return new this.constructor().copy(this)}copy(st){this.width=st.width,this.height=st.height,this.depth=st.depth,this.viewport.copy(st.viewport),this.texture=st.texture.clone(),this.texture.isRenderTargetTexture=!0;let mt=Object.assign({},st.texture.image);return this.texture.source=new $g(mt),this.depthBuffer=st.depthBuffer,this.stencilBuffer=st.stencilBuffer,st.depthTexture!==null&&(this.depthTexture=st.depthTexture.clone()),this.samples=st.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},ey=class extends $t{constructor(nt=null,st=1,mt=1,gt=1){super(null),this.isDataArrayTexture=!0,this.image={data:nt,width:st,height:mt,depth:gt},this.magFilter=Vt,this.minFilter=Vt,this.wrapR=Xt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},ty=class extends $t{constructor(nt=null,st=1,mt=1,gt=1){super(null),this.isData3DTexture=!0,this.image={data:nt,width:st,height:mt,depth:gt},this.magFilter=Vt,this.minFilter=Vt,this.wrapR=Xt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},ry=class extends dt$1{constructor(nt=1,st=1,mt=1,gt={}){super(nt,st,gt),this.isWebGLMultipleRenderTargets=!0;let _t=this.texture;this.texture=[];for(let Et=0;Et<mt;Et++)this.texture[Et]=_t.clone(),this.texture[Et].isRenderTargetTexture=!0}setSize(nt,st,mt=1){if(this.width!==nt||this.height!==st||this.depth!==mt){this.width=nt,this.height=st,this.depth=mt;for(let gt=0,_t=this.texture.length;gt<_t;gt++)this.texture[gt].image.width=nt,this.texture[gt].image.height=st,this.texture[gt].image.depth=mt;this.dispose()}return this.viewport.set(0,0,nt,st),this.scissor.set(0,0,nt,st),this}copy(nt){this.dispose(),this.width=nt.width,this.height=nt.height,this.depth=nt.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=nt.depthBuffer,this.stencilBuffer=nt.stencilBuffer,nt.depthTexture!==null&&(this.depthTexture=nt.depthTexture.clone()),this.texture.length=0;for(let st=0,mt=nt.texture.length;st<mt;st++)this.texture[st]=nt.texture[st].clone(),this.texture[st].isRenderTargetTexture=!0;return this}},Qe$1=class{constructor(st=0,mt=0,gt=0,_t=1){this.isQuaternion=!0,this._x=st,this._y=mt,this._z=gt,this._w=_t}static slerpFlat(st,mt,gt,_t,Et,At,Rt){let Ft=gt[_t+0],Nt=gt[_t+1],Bt=gt[_t+2],Gt=gt[_t+3],dr=Et[At+0],Mr=Et[At+1],Tr=Et[At+2],zr=Et[At+3];if(Rt===0){st[mt+0]=Ft,st[mt+1]=Nt,st[mt+2]=Bt,st[mt+3]=Gt;return}if(Rt===1){st[mt+0]=dr,st[mt+1]=Mr,st[mt+2]=Tr,st[mt+3]=zr;return}if(Gt!==zr||Ft!==dr||Nt!==Mr||Bt!==Tr){let Fr=1-Rt,Nr=Ft*dr+Nt*Mr+Bt*Tr+Gt*zr,tn=Nr>=0?1:-1,rn=1-Nr*Nr;if(rn>Number.EPSILON){let $n=Math.sqrt(rn),un=Math.atan2($n,Nr*tn);Fr=Math.sin(Fr*un)/$n,Rt=Math.sin(Rt*un)/$n}let Tn=Rt*tn;if(Ft=Ft*Fr+dr*Tn,Nt=Nt*Fr+Mr*Tn,Bt=Bt*Fr+Tr*Tn,Gt=Gt*Fr+zr*Tn,Fr===1-Rt){let $n=1/Math.sqrt(Ft*Ft+Nt*Nt+Bt*Bt+Gt*Gt);Ft*=$n,Nt*=$n,Bt*=$n,Gt*=$n}}st[mt]=Ft,st[mt+1]=Nt,st[mt+2]=Bt,st[mt+3]=Gt}static multiplyQuaternionsFlat(st,mt,gt,_t,Et,At){let Rt=gt[_t],Ft=gt[_t+1],Nt=gt[_t+2],Bt=gt[_t+3],Gt=Et[At],dr=Et[At+1],Mr=Et[At+2],Tr=Et[At+3];return st[mt]=Rt*Tr+Bt*Gt+Ft*Mr-Nt*dr,st[mt+1]=Ft*Tr+Bt*dr+Nt*Gt-Rt*Mr,st[mt+2]=Nt*Tr+Bt*Mr+Rt*dr-Ft*Gt,st[mt+3]=Bt*Tr-Rt*Gt-Ft*dr-Nt*Mr,st}get x(){return this._x}set x(st){this._x=st,this._onChangeCallback()}get y(){return this._y}set y(st){this._y=st,this._onChangeCallback()}get z(){return this._z}set z(st){this._z=st,this._onChangeCallback()}get w(){return this._w}set w(st){this._w=st,this._onChangeCallback()}set(st,mt,gt,_t){return this._x=st,this._y=mt,this._z=gt,this._w=_t,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(st){return this._x=st.x,this._y=st.y,this._z=st.z,this._w=st.w,this._onChangeCallback(),this}setFromEuler(st,mt){let gt=st._x,_t=st._y,Et=st._z,At=st._order,Rt=Math.cos,Ft=Math.sin,Nt=Rt(gt/2),Bt=Rt(_t/2),Gt=Rt(Et/2),dr=Ft(gt/2),Mr=Ft(_t/2),Tr=Ft(Et/2);switch(At){case"XYZ":this._x=dr*Bt*Gt+Nt*Mr*Tr,this._y=Nt*Mr*Gt-dr*Bt*Tr,this._z=Nt*Bt*Tr+dr*Mr*Gt,this._w=Nt*Bt*Gt-dr*Mr*Tr;break;case"YXZ":this._x=dr*Bt*Gt+Nt*Mr*Tr,this._y=Nt*Mr*Gt-dr*Bt*Tr,this._z=Nt*Bt*Tr-dr*Mr*Gt,this._w=Nt*Bt*Gt+dr*Mr*Tr;break;case"ZXY":this._x=dr*Bt*Gt-Nt*Mr*Tr,this._y=Nt*Mr*Gt+dr*Bt*Tr,this._z=Nt*Bt*Tr+dr*Mr*Gt,this._w=Nt*Bt*Gt-dr*Mr*Tr;break;case"ZYX":this._x=dr*Bt*Gt-Nt*Mr*Tr,this._y=Nt*Mr*Gt+dr*Bt*Tr,this._z=Nt*Bt*Tr-dr*Mr*Gt,this._w=Nt*Bt*Gt+dr*Mr*Tr;break;case"YZX":this._x=dr*Bt*Gt+Nt*Mr*Tr,this._y=Nt*Mr*Gt+dr*Bt*Tr,this._z=Nt*Bt*Tr-dr*Mr*Gt,this._w=Nt*Bt*Gt-dr*Mr*Tr;break;case"XZY":this._x=dr*Bt*Gt-Nt*Mr*Tr,this._y=Nt*Mr*Gt-dr*Bt*Tr,this._z=Nt*Bt*Tr+dr*Mr*Gt,this._w=Nt*Bt*Gt+dr*Mr*Tr;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+At)}return mt!==!1&&this._onChangeCallback(),this}setFromAxisAngle(st,mt){let gt=mt/2,_t=Math.sin(gt);return this._x=st.x*_t,this._y=st.y*_t,this._z=st.z*_t,this._w=Math.cos(gt),this._onChangeCallback(),this}setFromRotationMatrix(st){let mt=st.elements,gt=mt[0],_t=mt[4],Et=mt[8],At=mt[1],Rt=mt[5],Ft=mt[9],Nt=mt[2],Bt=mt[6],Gt=mt[10],dr=gt+Rt+Gt;if(dr>0){let Mr=.5/Math.sqrt(dr+1);this._w=.25/Mr,this._x=(Bt-Ft)*Mr,this._y=(Et-Nt)*Mr,this._z=(At-_t)*Mr}else if(gt>Rt&&gt>Gt){let Mr=2*Math.sqrt(1+gt-Rt-Gt);this._w=(Bt-Ft)/Mr,this._x=.25*Mr,this._y=(_t+At)/Mr,this._z=(Et+Nt)/Mr}else if(Rt>Gt){let Mr=2*Math.sqrt(1+Rt-gt-Gt);this._w=(Et-Nt)/Mr,this._x=(_t+At)/Mr,this._y=.25*Mr,this._z=(Ft+Bt)/Mr}else{let Mr=2*Math.sqrt(1+Gt-gt-Rt);this._w=(At-_t)/Mr,this._x=(Et+Nt)/Mr,this._y=(Ft+Bt)/Mr,this._z=.25*Mr}return this._onChangeCallback(),this}setFromUnitVectors(st,mt){let gt=st.dot(mt)+1;return gt<Number.EPSILON?(gt=0,Math.abs(st.x)>Math.abs(st.z)?(this._x=-st.y,this._y=st.x,this._z=0,this._w=gt):(this._x=0,this._y=-st.z,this._z=st.y,this._w=gt)):(this._x=st.y*mt.z-st.z*mt.y,this._y=st.z*mt.x-st.x*mt.z,this._z=st.x*mt.y-st.y*mt.x,this._w=gt),this.normalize()}angleTo(st){return 2*Math.acos(Math.abs(di(this.dot(st),-1,1)))}rotateTowards(st,mt){let gt=this.angleTo(st);if(gt===0)return this;let _t=Math.min(1,mt/gt);return this.slerp(st,_t),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(st){return this._x*st._x+this._y*st._y+this._z*st._z+this._w*st._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let st=this.length();return st===0?(this._x=0,this._y=0,this._z=0,this._w=1):(st=1/st,this._x=this._x*st,this._y=this._y*st,this._z=this._z*st,this._w=this._w*st),this._onChangeCallback(),this}multiply(st){return this.multiplyQuaternions(this,st)}premultiply(st){return this.multiplyQuaternions(st,this)}multiplyQuaternions(st,mt){let gt=st._x,_t=st._y,Et=st._z,At=st._w,Rt=mt._x,Ft=mt._y,Nt=mt._z,Bt=mt._w;return this._x=gt*Bt+At*Rt+_t*Nt-Et*Ft,this._y=_t*Bt+At*Ft+Et*Rt-gt*Nt,this._z=Et*Bt+At*Nt+gt*Ft-_t*Rt,this._w=At*Bt-gt*Rt-_t*Ft-Et*Nt,this._onChangeCallback(),this}slerp(st,mt){if(mt===0)return this;if(mt===1)return this.copy(st);let gt=this._x,_t=this._y,Et=this._z,At=this._w,Rt=At*st._w+gt*st._x+_t*st._y+Et*st._z;if(Rt<0?(this._w=-st._w,this._x=-st._x,this._y=-st._y,this._z=-st._z,Rt=-Rt):this.copy(st),Rt>=1)return this._w=At,this._x=gt,this._y=_t,this._z=Et,this;let Ft=1-Rt*Rt;if(Ft<=Number.EPSILON){let Mr=1-mt;return this._w=Mr*At+mt*this._w,this._x=Mr*gt+mt*this._x,this._y=Mr*_t+mt*this._y,this._z=Mr*Et+mt*this._z,this.normalize(),this._onChangeCallback(),this}let Nt=Math.sqrt(Ft),Bt=Math.atan2(Nt,Rt),Gt=Math.sin((1-mt)*Bt)/Nt,dr=Math.sin(mt*Bt)/Nt;return this._w=At*Gt+this._w*dr,this._x=gt*Gt+this._x*dr,this._y=_t*Gt+this._y*dr,this._z=Et*Gt+this._z*dr,this._onChangeCallback(),this}slerpQuaternions(st,mt,gt){return this.copy(st).slerp(mt,gt)}random(){let st=Math.random(),mt=Math.sqrt(1-st),gt=Math.sqrt(st),_t=2*Math.PI*Math.random(),Et=2*Math.PI*Math.random();return this.set(mt*Math.cos(_t),gt*Math.sin(Et),gt*Math.cos(Et),mt*Math.sin(_t))}equals(st){return st._x===this._x&&st._y===this._y&&st._z===this._z&&st._w===this._w}fromArray(st,mt=0){return this._x=st[mt],this._y=st[mt+1],this._z=st[mt+2],this._w=st[mt+3],this._onChangeCallback(),this}toArray(st=[],mt=0){return st[mt]=this._x,st[mt+1]=this._y,st[mt+2]=this._z,st[mt+3]=this._w,st}fromBufferAttribute(st,mt){return this._x=st.getX(mt),this._y=st.getY(mt),this._z=st.getZ(mt),this._w=st.getW(mt),this}_onChange(st){return this._onChangeCallback=st,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},E$6=class{constructor(st=0,mt=0,gt=0){E$6.prototype.isVector3=!0,this.x=st,this.y=mt,this.z=gt}set(st,mt,gt){return gt===void 0&&(gt=this.z),this.x=st,this.y=mt,this.z=gt,this}setScalar(st){return this.x=st,this.y=st,this.z=st,this}setX(st){return this.x=st,this}setY(st){return this.y=st,this}setZ(st){return this.z=st,this}setComponent(st,mt){switch(st){case 0:this.x=mt;break;case 1:this.y=mt;break;case 2:this.z=mt;break;default:throw new Error("index is out of range: "+st)}return this}getComponent(st){switch(st){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+st)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(st){return this.x=st.x,this.y=st.y,this.z=st.z,this}add(st){return this.x+=st.x,this.y+=st.y,this.z+=st.z,this}addScalar(st){return this.x+=st,this.y+=st,this.z+=st,this}addVectors(st,mt){return this.x=st.x+mt.x,this.y=st.y+mt.y,this.z=st.z+mt.z,this}addScaledVector(st,mt){return this.x+=st.x*mt,this.y+=st.y*mt,this.z+=st.z*mt,this}sub(st){return this.x-=st.x,this.y-=st.y,this.z-=st.z,this}subScalar(st){return this.x-=st,this.y-=st,this.z-=st,this}subVectors(st,mt){return this.x=st.x-mt.x,this.y=st.y-mt.y,this.z=st.z-mt.z,this}multiply(st){return this.x*=st.x,this.y*=st.y,this.z*=st.z,this}multiplyScalar(st){return this.x*=st,this.y*=st,this.z*=st,this}multiplyVectors(st,mt){return this.x=st.x*mt.x,this.y=st.y*mt.y,this.z=st.z*mt.z,this}applyEuler(st){return this.applyQuaternion(kT.setFromEuler(st))}applyAxisAngle(st,mt){return this.applyQuaternion(kT.setFromAxisAngle(st,mt))}applyMatrix3(st){let mt=this.x,gt=this.y,_t=this.z,Et=st.elements;return this.x=Et[0]*mt+Et[3]*gt+Et[6]*_t,this.y=Et[1]*mt+Et[4]*gt+Et[7]*_t,this.z=Et[2]*mt+Et[5]*gt+Et[8]*_t,this}applyNormalMatrix(st){return this.applyMatrix3(st).normalize()}applyMatrix4(st){let mt=this.x,gt=this.y,_t=this.z,Et=st.elements,At=1/(Et[3]*mt+Et[7]*gt+Et[11]*_t+Et[15]);return this.x=(Et[0]*mt+Et[4]*gt+Et[8]*_t+Et[12])*At,this.y=(Et[1]*mt+Et[5]*gt+Et[9]*_t+Et[13])*At,this.z=(Et[2]*mt+Et[6]*gt+Et[10]*_t+Et[14])*At,this}applyQuaternion(st){let mt=this.x,gt=this.y,_t=this.z,Et=st.x,At=st.y,Rt=st.z,Ft=st.w,Nt=Ft*mt+At*_t-Rt*gt,Bt=Ft*gt+Rt*mt-Et*_t,Gt=Ft*_t+Et*gt-At*mt,dr=-Et*mt-At*gt-Rt*_t;return this.x=Nt*Ft+dr*-Et+Bt*-Rt-Gt*-At,this.y=Bt*Ft+dr*-At+Gt*-Et-Nt*-Rt,this.z=Gt*Ft+dr*-Rt+Nt*-At-Bt*-Et,this}project(st){return this.applyMatrix4(st.matrixWorldInverse).applyMatrix4(st.projectionMatrix)}unproject(st){return this.applyMatrix4(st.projectionMatrixInverse).applyMatrix4(st.matrixWorld)}transformDirection(st){let mt=this.x,gt=this.y,_t=this.z,Et=st.elements;return this.x=Et[0]*mt+Et[4]*gt+Et[8]*_t,this.y=Et[1]*mt+Et[5]*gt+Et[9]*_t,this.z=Et[2]*mt+Et[6]*gt+Et[10]*_t,this.normalize()}divide(st){return this.x/=st.x,this.y/=st.y,this.z/=st.z,this}divideScalar(st){return this.multiplyScalar(1/st)}min(st){return this.x=Math.min(this.x,st.x),this.y=Math.min(this.y,st.y),this.z=Math.min(this.z,st.z),this}max(st){return this.x=Math.max(this.x,st.x),this.y=Math.max(this.y,st.y),this.z=Math.max(this.z,st.z),this}clamp(st,mt){return this.x=Math.max(st.x,Math.min(mt.x,this.x)),this.y=Math.max(st.y,Math.min(mt.y,this.y)),this.z=Math.max(st.z,Math.min(mt.z,this.z)),this}clampScalar(st,mt){return this.x=Math.max(st,Math.min(mt,this.x)),this.y=Math.max(st,Math.min(mt,this.y)),this.z=Math.max(st,Math.min(mt,this.z)),this}clampLength(st,mt){let gt=this.length();return this.divideScalar(gt||1).multiplyScalar(Math.max(st,Math.min(mt,gt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(st){return this.x*st.x+this.y*st.y+this.z*st.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(st){return this.normalize().multiplyScalar(st)}lerp(st,mt){return this.x+=(st.x-this.x)*mt,this.y+=(st.y-this.y)*mt,this.z+=(st.z-this.z)*mt,this}lerpVectors(st,mt,gt){return this.x=st.x+(mt.x-st.x)*gt,this.y=st.y+(mt.y-st.y)*gt,this.z=st.z+(mt.z-st.z)*gt,this}cross(st){return this.crossVectors(this,st)}crossVectors(st,mt){let gt=st.x,_t=st.y,Et=st.z,At=mt.x,Rt=mt.y,Ft=mt.z;return this.x=_t*Ft-Et*Rt,this.y=Et*At-gt*Ft,this.z=gt*Rt-_t*At,this}projectOnVector(st){let mt=st.lengthSq();if(mt===0)return this.set(0,0,0);let gt=st.dot(this)/mt;return this.copy(st).multiplyScalar(gt)}projectOnPlane(st){return mS.copy(this).projectOnVector(st),this.sub(mS)}reflect(st){return this.sub(mS.copy(st).multiplyScalar(2*this.dot(st)))}angleTo(st){let mt=Math.sqrt(this.lengthSq()*st.lengthSq());if(mt===0)return Math.PI/2;let gt=this.dot(st)/mt;return Math.acos(di(gt,-1,1))}distanceTo(st){return Math.sqrt(this.distanceToSquared(st))}distanceToSquared(st){let mt=this.x-st.x,gt=this.y-st.y,_t=this.z-st.z;return mt*mt+gt*gt+_t*_t}manhattanDistanceTo(st){return Math.abs(this.x-st.x)+Math.abs(this.y-st.y)+Math.abs(this.z-st.z)}setFromSpherical(st){return this.setFromSphericalCoords(st.radius,st.phi,st.theta)}setFromSphericalCoords(st,mt,gt){let _t=Math.sin(mt)*st;return this.x=_t*Math.sin(gt),this.y=Math.cos(mt)*st,this.z=_t*Math.cos(gt),this}setFromCylindrical(st){return this.setFromCylindricalCoords(st.radius,st.theta,st.y)}setFromCylindricalCoords(st,mt,gt){return this.x=st*Math.sin(mt),this.y=gt,this.z=st*Math.cos(mt),this}setFromMatrixPosition(st){let mt=st.elements;return this.x=mt[12],this.y=mt[13],this.z=mt[14],this}setFromMatrixScale(st){let mt=this.setFromMatrixColumn(st,0).length(),gt=this.setFromMatrixColumn(st,1).length(),_t=this.setFromMatrixColumn(st,2).length();return this.x=mt,this.y=gt,this.z=_t,this}setFromMatrixColumn(st,mt){return this.fromArray(st.elements,mt*4)}setFromMatrix3Column(st,mt){return this.fromArray(st.elements,mt*3)}setFromEuler(st){return this.x=st._x,this.y=st._y,this.z=st._z,this}equals(st){return st.x===this.x&&st.y===this.y&&st.z===this.z}fromArray(st,mt=0){return this.x=st[mt],this.y=st[mt+1],this.z=st[mt+2],this}toArray(st=[],mt=0){return st[mt]=this.x,st[mt+1]=this.y,st[mt+2]=this.z,st}fromBufferAttribute(st,mt){return this.x=st.getX(mt),this.y=st.getY(mt),this.z=st.getZ(mt),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let st=(Math.random()-.5)*2,mt=Math.random()*Math.PI*2,gt=Math.sqrt(1-st**2);return this.x=gt*Math.cos(mt),this.y=gt*Math.sin(mt),this.z=st,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},mS=new E$6,kT=new Qe$1,jt=class{constructor(nt=new E$6(1/0,1/0,1/0),st=new E$6(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=nt,this.max=st}set(nt,st){return this.min.copy(nt),this.max.copy(st),this}setFromArray(nt){let st=1/0,mt=1/0,gt=1/0,_t=-1/0,Et=-1/0,At=-1/0;for(let Rt=0,Ft=nt.length;Rt<Ft;Rt+=3){let Nt=nt[Rt],Bt=nt[Rt+1],Gt=nt[Rt+2];Nt<st&&(st=Nt),Bt<mt&&(mt=Bt),Gt<gt&&(gt=Gt),Nt>_t&&(_t=Nt),Bt>Et&&(Et=Bt),Gt>At&&(At=Gt)}return this.min.set(st,mt,gt),this.max.set(_t,Et,At),this}setFromBufferAttribute(nt){let st=1/0,mt=1/0,gt=1/0,_t=-1/0,Et=-1/0,At=-1/0;for(let Rt=0,Ft=nt.count;Rt<Ft;Rt++){let Nt=nt.getX(Rt),Bt=nt.getY(Rt),Gt=nt.getZ(Rt);Nt<st&&(st=Nt),Bt<mt&&(mt=Bt),Gt<gt&&(gt=Gt),Nt>_t&&(_t=Nt),Bt>Et&&(Et=Bt),Gt>At&&(At=Gt)}return this.min.set(st,mt,gt),this.max.set(_t,Et,At),this}setFromPoints(nt){this.makeEmpty();for(let st=0,mt=nt.length;st<mt;st++)this.expandByPoint(nt[st]);return this}setFromCenterAndSize(nt,st){let mt=sc.copy(st).multiplyScalar(.5);return this.min.copy(nt).sub(mt),this.max.copy(nt).add(mt),this}setFromObject(nt,st=!1){return this.makeEmpty(),this.expandByObject(nt,st)}clone(){return new this.constructor().copy(this)}copy(nt){return this.min.copy(nt.min),this.max.copy(nt.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(nt){return this.isEmpty()?nt.set(0,0,0):nt.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(nt){return this.isEmpty()?nt.set(0,0,0):nt.subVectors(this.max,this.min)}expandByPoint(nt){return this.min.min(nt),this.max.max(nt),this}expandByVector(nt){return this.min.sub(nt),this.max.add(nt),this}expandByScalar(nt){return this.min.addScalar(-nt),this.max.addScalar(nt),this}expandByObject(nt,st=!1){nt.updateWorldMatrix(!1,!1);let mt=nt.geometry;if(mt!==void 0)if(st&&mt.attributes!=null&&mt.attributes.position!==void 0){let _t=mt.attributes.position;for(let Et=0,At=_t.count;Et<At;Et++)sc.fromBufferAttribute(_t,Et).applyMatrix4(nt.matrixWorld),this.expandByPoint(sc)}else mt.boundingBox===null&&mt.computeBoundingBox(),gS.copy(mt.boundingBox),gS.applyMatrix4(nt.matrixWorld),this.union(gS);let gt=nt.children;for(let _t=0,Et=gt.length;_t<Et;_t++)this.expandByObject(gt[_t],st);return this}containsPoint(nt){return!(nt.x<this.min.x||nt.x>this.max.x||nt.y<this.min.y||nt.y>this.max.y||nt.z<this.min.z||nt.z>this.max.z)}containsBox(nt){return this.min.x<=nt.min.x&&nt.max.x<=this.max.x&&this.min.y<=nt.min.y&&nt.max.y<=this.max.y&&this.min.z<=nt.min.z&&nt.max.z<=this.max.z}getParameter(nt,st){return st.set((nt.x-this.min.x)/(this.max.x-this.min.x),(nt.y-this.min.y)/(this.max.y-this.min.y),(nt.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(nt){return!(nt.max.x<this.min.x||nt.min.x>this.max.x||nt.max.y<this.min.y||nt.min.y>this.max.y||nt.max.z<this.min.z||nt.min.z>this.max.z)}intersectsSphere(nt){return this.clampPoint(nt.center,sc),sc.distanceToSquared(nt.center)<=nt.radius*nt.radius}intersectsPlane(nt){let st,mt;return nt.normal.x>0?(st=nt.normal.x*this.min.x,mt=nt.normal.x*this.max.x):(st=nt.normal.x*this.max.x,mt=nt.normal.x*this.min.x),nt.normal.y>0?(st+=nt.normal.y*this.min.y,mt+=nt.normal.y*this.max.y):(st+=nt.normal.y*this.max.y,mt+=nt.normal.y*this.min.y),nt.normal.z>0?(st+=nt.normal.z*this.min.z,mt+=nt.normal.z*this.max.z):(st+=nt.normal.z*this.max.z,mt+=nt.normal.z*this.min.z),st<=-nt.constant&&mt>=-nt.constant}intersectsTriangle(nt){if(this.isEmpty())return!1;this.getCenter(jf),wg.subVectors(this.max,jf),fu.subVectors(nt.a,jf),pu.subVectors(nt.b,jf),mu.subVectors(nt.c,jf),Ga.subVectors(pu,fu),ja.subVectors(mu,pu),oc.subVectors(fu,mu);let st=[0,-Ga.z,Ga.y,0,-ja.z,ja.y,0,-oc.z,oc.y,Ga.z,0,-Ga.x,ja.z,0,-ja.x,oc.z,0,-oc.x,-Ga.y,Ga.x,0,-ja.y,ja.x,0,-oc.y,oc.x,0];return!yS(st,fu,pu,mu,wg)||(st=[1,0,0,0,1,0,0,0,1],!yS(st,fu,pu,mu,wg))?!1:(Ag.crossVectors(Ga,ja),st=[Ag.x,Ag.y,Ag.z],yS(st,fu,pu,mu,wg))}clampPoint(nt,st){return st.copy(nt).clamp(this.min,this.max)}distanceToPoint(nt){return sc.copy(nt).clamp(this.min,this.max).sub(nt).length()}getBoundingSphere(nt){return this.getCenter(nt.center),nt.radius=this.getSize(sc).length()*.5,nt}intersect(nt){return this.min.max(nt.min),this.max.min(nt.max),this.isEmpty()&&this.makeEmpty(),this}union(nt){return this.min.min(nt.min),this.max.max(nt.max),this}applyMatrix4(nt){return this.isEmpty()?this:($o[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(nt),$o[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(nt),$o[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(nt),$o[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(nt),$o[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(nt),$o[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(nt),$o[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(nt),$o[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(nt),this.setFromPoints($o),this)}translate(nt){return this.min.add(nt),this.max.add(nt),this}equals(nt){return nt.min.equals(this.min)&&nt.max.equals(this.max)}},$o=[new E$6,new E$6,new E$6,new E$6,new E$6,new E$6,new E$6,new E$6],sc=new E$6,gS=new jt,fu=new E$6,pu=new E$6,mu=new E$6,Ga=new E$6,ja=new E$6,oc=new E$6,jf=new E$6,wg=new E$6,Ag=new E$6,ac=new E$6;function yS(nt,st,mt,gt,_t){for(let Et=0,At=nt.length-3;Et<=At;Et+=3){ac.fromArray(nt,Et);let Rt=_t.x*Math.abs(ac.x)+_t.y*Math.abs(ac.y)+_t.z*Math.abs(ac.z),Ft=st.dot(ac),Nt=mt.dot(ac),Bt=gt.dot(ac);if(Math.max(-Math.max(Ft,Nt,Bt),Math.min(Ft,Nt,Bt))>Rt)return!1}return!0}var yV=new jt,Hf=new E$6,vS=new E$6,Or=class{constructor(nt=new E$6,st=-1){this.center=nt,this.radius=st}set(nt,st){return this.center.copy(nt),this.radius=st,this}setFromPoints(nt,st){let mt=this.center;st!==void 0?mt.copy(st):yV.setFromPoints(nt).getCenter(mt);let gt=0;for(let _t=0,Et=nt.length;_t<Et;_t++)gt=Math.max(gt,mt.distanceToSquared(nt[_t]));return this.radius=Math.sqrt(gt),this}copy(nt){return this.center.copy(nt.center),this.radius=nt.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(nt){return nt.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(nt){return nt.distanceTo(this.center)-this.radius}intersectsSphere(nt){let st=this.radius+nt.radius;return nt.center.distanceToSquared(this.center)<=st*st}intersectsBox(nt){return nt.intersectsSphere(this)}intersectsPlane(nt){return Math.abs(nt.distanceToPoint(this.center))<=this.radius}clampPoint(nt,st){let mt=this.center.distanceToSquared(nt);return st.copy(nt),mt>this.radius*this.radius&&(st.sub(this.center).normalize(),st.multiplyScalar(this.radius).add(this.center)),st}getBoundingBox(nt){return this.isEmpty()?(nt.makeEmpty(),nt):(nt.set(this.center,this.center),nt.expandByScalar(this.radius),nt)}applyMatrix4(nt){return this.center.applyMatrix4(nt),this.radius=this.radius*nt.getMaxScaleOnAxis(),this}translate(nt){return this.center.add(nt),this}expandByPoint(nt){if(this.isEmpty())return this.center.copy(nt),this.radius=0,this;Hf.subVectors(nt,this.center);let st=Hf.lengthSq();if(st>this.radius*this.radius){let mt=Math.sqrt(st),gt=(mt-this.radius)*.5;this.center.addScaledVector(Hf,gt/mt),this.radius+=gt}return this}union(nt){return nt.isEmpty()?this:this.isEmpty()?(this.copy(nt),this):(this.center.equals(nt.center)===!0?this.radius=Math.max(this.radius,nt.radius):(vS.subVectors(nt.center,this.center).setLength(nt.radius),this.expandByPoint(Hf.copy(nt.center).add(vS)),this.expandByPoint(Hf.copy(nt.center).sub(vS))),this)}equals(nt){return nt.center.equals(this.center)&&nt.radius===this.radius}clone(){return new this.constructor().copy(this)}},ea=new E$6,xS=new E$6,Eg=new E$6,Ha=new E$6,bS=new E$6,Mg=new E$6,SS=new E$6,Rs=class{constructor(nt=new E$6,st=new E$6(0,0,-1)){this.origin=nt,this.direction=st}set(nt,st){return this.origin.copy(nt),this.direction.copy(st),this}copy(nt){return this.origin.copy(nt.origin),this.direction.copy(nt.direction),this}at(nt,st){return st.copy(this.direction).multiplyScalar(nt).add(this.origin)}lookAt(nt){return this.direction.copy(nt).sub(this.origin).normalize(),this}recast(nt){return this.origin.copy(this.at(nt,ea)),this}closestPointToPoint(nt,st){st.subVectors(nt,this.origin);let mt=st.dot(this.direction);return mt<0?st.copy(this.origin):st.copy(this.direction).multiplyScalar(mt).add(this.origin)}distanceToPoint(nt){return Math.sqrt(this.distanceSqToPoint(nt))}distanceSqToPoint(nt){let st=ea.subVectors(nt,this.origin).dot(this.direction);return st<0?this.origin.distanceToSquared(nt):(ea.copy(this.direction).multiplyScalar(st).add(this.origin),ea.distanceToSquared(nt))}distanceSqToSegment(nt,st,mt,gt){xS.copy(nt).add(st).multiplyScalar(.5),Eg.copy(st).sub(nt).normalize(),Ha.copy(this.origin).sub(xS);let _t=nt.distanceTo(st)*.5,Et=-this.direction.dot(Eg),At=Ha.dot(this.direction),Rt=-Ha.dot(Eg),Ft=Ha.lengthSq(),Nt=Math.abs(1-Et*Et),Bt,Gt,dr,Mr;if(Nt>0)if(Bt=Et*Rt-At,Gt=Et*At-Rt,Mr=_t*Nt,Bt>=0)if(Gt>=-Mr)if(Gt<=Mr){let Tr=1/Nt;Bt*=Tr,Gt*=Tr,dr=Bt*(Bt+Et*Gt+2*At)+Gt*(Et*Bt+Gt+2*Rt)+Ft}else Gt=_t,Bt=Math.max(0,-(Et*Gt+At)),dr=-Bt*Bt+Gt*(Gt+2*Rt)+Ft;else Gt=-_t,Bt=Math.max(0,-(Et*Gt+At)),dr=-Bt*Bt+Gt*(Gt+2*Rt)+Ft;else Gt<=-Mr?(Bt=Math.max(0,-(-Et*_t+At)),Gt=Bt>0?-_t:Math.min(Math.max(-_t,-Rt),_t),dr=-Bt*Bt+Gt*(Gt+2*Rt)+Ft):Gt<=Mr?(Bt=0,Gt=Math.min(Math.max(-_t,-Rt),_t),dr=Gt*(Gt+2*Rt)+Ft):(Bt=Math.max(0,-(Et*_t+At)),Gt=Bt>0?_t:Math.min(Math.max(-_t,-Rt),_t),dr=-Bt*Bt+Gt*(Gt+2*Rt)+Ft);else Gt=Et>0?-_t:_t,Bt=Math.max(0,-(Et*Gt+At)),dr=-Bt*Bt+Gt*(Gt+2*Rt)+Ft;return mt&&mt.copy(this.direction).multiplyScalar(Bt).add(this.origin),gt&&gt.copy(Eg).multiplyScalar(Gt).add(xS),dr}intersectSphere(nt,st){ea.subVectors(nt.center,this.origin);let mt=ea.dot(this.direction),gt=ea.dot(ea)-mt*mt,_t=nt.radius*nt.radius;if(gt>_t)return null;let Et=Math.sqrt(_t-gt),At=mt-Et,Rt=mt+Et;return At<0&&Rt<0?null:At<0?this.at(Rt,st):this.at(At,st)}intersectsSphere(nt){return this.distanceSqToPoint(nt.center)<=nt.radius*nt.radius}distanceToPlane(nt){let st=nt.normal.dot(this.direction);if(st===0)return nt.distanceToPoint(this.origin)===0?0:null;let mt=-(this.origin.dot(nt.normal)+nt.constant)/st;return mt>=0?mt:null}intersectPlane(nt,st){let mt=this.distanceToPlane(nt);return mt===null?null:this.at(mt,st)}intersectsPlane(nt){let st=nt.distanceToPoint(this.origin);return st===0||nt.normal.dot(this.direction)*st<0}intersectBox(nt,st){let mt,gt,_t,Et,At,Rt,Ft=1/this.direction.x,Nt=1/this.direction.y,Bt=1/this.direction.z,Gt=this.origin;return Ft>=0?(mt=(nt.min.x-Gt.x)*Ft,gt=(nt.max.x-Gt.x)*Ft):(mt=(nt.max.x-Gt.x)*Ft,gt=(nt.min.x-Gt.x)*Ft),Nt>=0?(_t=(nt.min.y-Gt.y)*Nt,Et=(nt.max.y-Gt.y)*Nt):(_t=(nt.max.y-Gt.y)*Nt,Et=(nt.min.y-Gt.y)*Nt),mt>Et||_t>gt||((_t>mt||isNaN(mt))&&(mt=_t),(Et<gt||isNaN(gt))&&(gt=Et),Bt>=0?(At=(nt.min.z-Gt.z)*Bt,Rt=(nt.max.z-Gt.z)*Bt):(At=(nt.max.z-Gt.z)*Bt,Rt=(nt.min.z-Gt.z)*Bt),mt>Rt||At>gt)||((At>mt||mt!==mt)&&(mt=At),(Rt<gt||gt!==gt)&&(gt=Rt),gt<0)?null:this.at(mt>=0?mt:gt,st)}intersectsBox(nt){return this.intersectBox(nt,ea)!==null}intersectTriangle(nt,st,mt,gt,_t){bS.subVectors(st,nt),Mg.subVectors(mt,nt),SS.crossVectors(bS,Mg);let Et=this.direction.dot(SS),At;if(Et>0){if(gt)return null;At=1}else if(Et<0)At=-1,Et=-Et;else return null;Ha.subVectors(this.origin,nt);let Rt=At*this.direction.dot(Mg.crossVectors(Ha,Mg));if(Rt<0)return null;let Ft=At*this.direction.dot(bS.cross(Ha));if(Ft<0||Rt+Ft>Et)return null;let Nt=-At*Ha.dot(SS);return Nt<0?null:this.at(Nt/Et,_t)}applyMatrix4(nt){return this.origin.applyMatrix4(nt),this.direction.transformDirection(nt),this}equals(nt){return nt.origin.equals(this.origin)&&nt.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},ue$1=class{constructor(){ue$1.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr){let Nr=this.elements;return Nr[0]=st,Nr[4]=mt,Nr[8]=gt,Nr[12]=_t,Nr[1]=Et,Nr[5]=At,Nr[9]=Rt,Nr[13]=Ft,Nr[2]=Nt,Nr[6]=Bt,Nr[10]=Gt,Nr[14]=dr,Nr[3]=Mr,Nr[7]=Tr,Nr[11]=zr,Nr[15]=Fr,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ue$1().fromArray(this.elements)}copy(st){let mt=this.elements,gt=st.elements;return mt[0]=gt[0],mt[1]=gt[1],mt[2]=gt[2],mt[3]=gt[3],mt[4]=gt[4],mt[5]=gt[5],mt[6]=gt[6],mt[7]=gt[7],mt[8]=gt[8],mt[9]=gt[9],mt[10]=gt[10],mt[11]=gt[11],mt[12]=gt[12],mt[13]=gt[13],mt[14]=gt[14],mt[15]=gt[15],this}copyPosition(st){let mt=this.elements,gt=st.elements;return mt[12]=gt[12],mt[13]=gt[13],mt[14]=gt[14],this}setFromMatrix3(st){let mt=st.elements;return this.set(mt[0],mt[3],mt[6],0,mt[1],mt[4],mt[7],0,mt[2],mt[5],mt[8],0,0,0,0,1),this}extractBasis(st,mt,gt){return st.setFromMatrixColumn(this,0),mt.setFromMatrixColumn(this,1),gt.setFromMatrixColumn(this,2),this}makeBasis(st,mt,gt){return this.set(st.x,mt.x,gt.x,0,st.y,mt.y,gt.y,0,st.z,mt.z,gt.z,0,0,0,0,1),this}extractRotation(st){let mt=this.elements,gt=st.elements,_t=1/gu.setFromMatrixColumn(st,0).length(),Et=1/gu.setFromMatrixColumn(st,1).length(),At=1/gu.setFromMatrixColumn(st,2).length();return mt[0]=gt[0]*_t,mt[1]=gt[1]*_t,mt[2]=gt[2]*_t,mt[3]=0,mt[4]=gt[4]*Et,mt[5]=gt[5]*Et,mt[6]=gt[6]*Et,mt[7]=0,mt[8]=gt[8]*At,mt[9]=gt[9]*At,mt[10]=gt[10]*At,mt[11]=0,mt[12]=0,mt[13]=0,mt[14]=0,mt[15]=1,this}makeRotationFromEuler(st){let mt=this.elements,gt=st.x,_t=st.y,Et=st.z,At=Math.cos(gt),Rt=Math.sin(gt),Ft=Math.cos(_t),Nt=Math.sin(_t),Bt=Math.cos(Et),Gt=Math.sin(Et);if(st.order==="XYZ"){let dr=At*Bt,Mr=At*Gt,Tr=Rt*Bt,zr=Rt*Gt;mt[0]=Ft*Bt,mt[4]=-Ft*Gt,mt[8]=Nt,mt[1]=Mr+Tr*Nt,mt[5]=dr-zr*Nt,mt[9]=-Rt*Ft,mt[2]=zr-dr*Nt,mt[6]=Tr+Mr*Nt,mt[10]=At*Ft}else if(st.order==="YXZ"){let dr=Ft*Bt,Mr=Ft*Gt,Tr=Nt*Bt,zr=Nt*Gt;mt[0]=dr+zr*Rt,mt[4]=Tr*Rt-Mr,mt[8]=At*Nt,mt[1]=At*Gt,mt[5]=At*Bt,mt[9]=-Rt,mt[2]=Mr*Rt-Tr,mt[6]=zr+dr*Rt,mt[10]=At*Ft}else if(st.order==="ZXY"){let dr=Ft*Bt,Mr=Ft*Gt,Tr=Nt*Bt,zr=Nt*Gt;mt[0]=dr-zr*Rt,mt[4]=-At*Gt,mt[8]=Tr+Mr*Rt,mt[1]=Mr+Tr*Rt,mt[5]=At*Bt,mt[9]=zr-dr*Rt,mt[2]=-At*Nt,mt[6]=Rt,mt[10]=At*Ft}else if(st.order==="ZYX"){let dr=At*Bt,Mr=At*Gt,Tr=Rt*Bt,zr=Rt*Gt;mt[0]=Ft*Bt,mt[4]=Tr*Nt-Mr,mt[8]=dr*Nt+zr,mt[1]=Ft*Gt,mt[5]=zr*Nt+dr,mt[9]=Mr*Nt-Tr,mt[2]=-Nt,mt[6]=Rt*Ft,mt[10]=At*Ft}else if(st.order==="YZX"){let dr=At*Ft,Mr=At*Nt,Tr=Rt*Ft,zr=Rt*Nt;mt[0]=Ft*Bt,mt[4]=zr-dr*Gt,mt[8]=Tr*Gt+Mr,mt[1]=Gt,mt[5]=At*Bt,mt[9]=-Rt*Bt,mt[2]=-Nt*Bt,mt[6]=Mr*Gt+Tr,mt[10]=dr-zr*Gt}else if(st.order==="XZY"){let dr=At*Ft,Mr=At*Nt,Tr=Rt*Ft,zr=Rt*Nt;mt[0]=Ft*Bt,mt[4]=-Gt,mt[8]=Nt*Bt,mt[1]=dr*Gt+zr,mt[5]=At*Bt,mt[9]=Mr*Gt-Tr,mt[2]=Tr*Gt-Mr,mt[6]=Rt*Bt,mt[10]=zr*Gt+dr}return mt[3]=0,mt[7]=0,mt[11]=0,mt[12]=0,mt[13]=0,mt[14]=0,mt[15]=1,this}makeRotationFromQuaternion(st){return this.compose(vV,st,xV)}lookAt(st,mt,gt){let _t=this.elements;return Gn.subVectors(st,mt),Gn.lengthSq()===0&&(Gn.z=1),Gn.normalize(),Wa.crossVectors(gt,Gn),Wa.lengthSq()===0&&(Math.abs(gt.z)===1?Gn.x+=1e-4:Gn.z+=1e-4,Gn.normalize(),Wa.crossVectors(gt,Gn)),Wa.normalize(),Tg.crossVectors(Gn,Wa),_t[0]=Wa.x,_t[4]=Tg.x,_t[8]=Gn.x,_t[1]=Wa.y,_t[5]=Tg.y,_t[9]=Gn.y,_t[2]=Wa.z,_t[6]=Tg.z,_t[10]=Gn.z,this}multiply(st){return this.multiplyMatrices(this,st)}premultiply(st){return this.multiplyMatrices(st,this)}multiplyMatrices(st,mt){let gt=st.elements,_t=mt.elements,Et=this.elements,At=gt[0],Rt=gt[4],Ft=gt[8],Nt=gt[12],Bt=gt[1],Gt=gt[5],dr=gt[9],Mr=gt[13],Tr=gt[2],zr=gt[6],Fr=gt[10],Nr=gt[14],tn=gt[3],rn=gt[7],Tn=gt[11],$n=gt[15],un=_t[0],es=_t[4],kn=_t[8],ts=_t[12],Ko=_t[1],ds=_t[5],Il=_t[9],ru=_t[13],uu=_t[2],p0=_t[6],X1=_t[10],q0=_t[14],W0=_t[3],hu=_t[7],a1=_t[11],Vx=_t[15];return Et[0]=At*un+Rt*Ko+Ft*uu+Nt*W0,Et[4]=At*es+Rt*ds+Ft*p0+Nt*hu,Et[8]=At*kn+Rt*Il+Ft*X1+Nt*a1,Et[12]=At*ts+Rt*ru+Ft*q0+Nt*Vx,Et[1]=Bt*un+Gt*Ko+dr*uu+Mr*W0,Et[5]=Bt*es+Gt*ds+dr*p0+Mr*hu,Et[9]=Bt*kn+Gt*Il+dr*X1+Mr*a1,Et[13]=Bt*ts+Gt*ru+dr*q0+Mr*Vx,Et[2]=Tr*un+zr*Ko+Fr*uu+Nr*W0,Et[6]=Tr*es+zr*ds+Fr*p0+Nr*hu,Et[10]=Tr*kn+zr*Il+Fr*X1+Nr*a1,Et[14]=Tr*ts+zr*ru+Fr*q0+Nr*Vx,Et[3]=tn*un+rn*Ko+Tn*uu+$n*W0,Et[7]=tn*es+rn*ds+Tn*p0+$n*hu,Et[11]=tn*kn+rn*Il+Tn*X1+$n*a1,Et[15]=tn*ts+rn*ru+Tn*q0+$n*Vx,this}multiplyScalar(st){let mt=this.elements;return mt[0]*=st,mt[4]*=st,mt[8]*=st,mt[12]*=st,mt[1]*=st,mt[5]*=st,mt[9]*=st,mt[13]*=st,mt[2]*=st,mt[6]*=st,mt[10]*=st,mt[14]*=st,mt[3]*=st,mt[7]*=st,mt[11]*=st,mt[15]*=st,this}determinant(){let st=this.elements,mt=st[0],gt=st[4],_t=st[8],Et=st[12],At=st[1],Rt=st[5],Ft=st[9],Nt=st[13],Bt=st[2],Gt=st[6],dr=st[10],Mr=st[14],Tr=st[3],zr=st[7],Fr=st[11],Nr=st[15];return Tr*(+Et*Ft*Gt-_t*Nt*Gt-Et*Rt*dr+gt*Nt*dr+_t*Rt*Mr-gt*Ft*Mr)+zr*(+mt*Ft*Mr-mt*Nt*dr+Et*At*dr-_t*At*Mr+_t*Nt*Bt-Et*Ft*Bt)+Fr*(+mt*Nt*Gt-mt*Rt*Mr-Et*At*Gt+gt*At*Mr+Et*Rt*Bt-gt*Nt*Bt)+Nr*(-_t*Rt*Bt-mt*Ft*Gt+mt*Rt*dr+_t*At*Gt-gt*At*dr+gt*Ft*Bt)}transpose(){let st=this.elements,mt;return mt=st[1],st[1]=st[4],st[4]=mt,mt=st[2],st[2]=st[8],st[8]=mt,mt=st[6],st[6]=st[9],st[9]=mt,mt=st[3],st[3]=st[12],st[12]=mt,mt=st[7],st[7]=st[13],st[13]=mt,mt=st[11],st[11]=st[14],st[14]=mt,this}setPosition(st,mt,gt){let _t=this.elements;return st.isVector3?(_t[12]=st.x,_t[13]=st.y,_t[14]=st.z):(_t[12]=st,_t[13]=mt,_t[14]=gt),this}invert(){let st=this.elements,mt=st[0],gt=st[1],_t=st[2],Et=st[3],At=st[4],Rt=st[5],Ft=st[6],Nt=st[7],Bt=st[8],Gt=st[9],dr=st[10],Mr=st[11],Tr=st[12],zr=st[13],Fr=st[14],Nr=st[15],tn=Gt*Fr*Nt-zr*dr*Nt+zr*Ft*Mr-Rt*Fr*Mr-Gt*Ft*Nr+Rt*dr*Nr,rn=Tr*dr*Nt-Bt*Fr*Nt-Tr*Ft*Mr+At*Fr*Mr+Bt*Ft*Nr-At*dr*Nr,Tn=Bt*zr*Nt-Tr*Gt*Nt+Tr*Rt*Mr-At*zr*Mr-Bt*Rt*Nr+At*Gt*Nr,$n=Tr*Gt*Ft-Bt*zr*Ft-Tr*Rt*dr+At*zr*dr+Bt*Rt*Fr-At*Gt*Fr,un=mt*tn+gt*rn+_t*Tn+Et*$n;if(un===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let es=1/un;return st[0]=tn*es,st[1]=(zr*dr*Et-Gt*Fr*Et-zr*_t*Mr+gt*Fr*Mr+Gt*_t*Nr-gt*dr*Nr)*es,st[2]=(Rt*Fr*Et-zr*Ft*Et+zr*_t*Nt-gt*Fr*Nt-Rt*_t*Nr+gt*Ft*Nr)*es,st[3]=(Gt*Ft*Et-Rt*dr*Et-Gt*_t*Nt+gt*dr*Nt+Rt*_t*Mr-gt*Ft*Mr)*es,st[4]=rn*es,st[5]=(Bt*Fr*Et-Tr*dr*Et+Tr*_t*Mr-mt*Fr*Mr-Bt*_t*Nr+mt*dr*Nr)*es,st[6]=(Tr*Ft*Et-At*Fr*Et-Tr*_t*Nt+mt*Fr*Nt+At*_t*Nr-mt*Ft*Nr)*es,st[7]=(At*dr*Et-Bt*Ft*Et+Bt*_t*Nt-mt*dr*Nt-At*_t*Mr+mt*Ft*Mr)*es,st[8]=Tn*es,st[9]=(Tr*Gt*Et-Bt*zr*Et-Tr*gt*Mr+mt*zr*Mr+Bt*gt*Nr-mt*Gt*Nr)*es,st[10]=(At*zr*Et-Tr*Rt*Et+Tr*gt*Nt-mt*zr*Nt-At*gt*Nr+mt*Rt*Nr)*es,st[11]=(Bt*Rt*Et-At*Gt*Et-Bt*gt*Nt+mt*Gt*Nt+At*gt*Mr-mt*Rt*Mr)*es,st[12]=$n*es,st[13]=(Bt*zr*_t-Tr*Gt*_t+Tr*gt*dr-mt*zr*dr-Bt*gt*Fr+mt*Gt*Fr)*es,st[14]=(Tr*Rt*_t-At*zr*_t-Tr*gt*Ft+mt*zr*Ft+At*gt*Fr-mt*Rt*Fr)*es,st[15]=(At*Gt*_t-Bt*Rt*_t+Bt*gt*Ft-mt*Gt*Ft-At*gt*dr+mt*Rt*dr)*es,this}scale(st){let mt=this.elements,gt=st.x,_t=st.y,Et=st.z;return mt[0]*=gt,mt[4]*=_t,mt[8]*=Et,mt[1]*=gt,mt[5]*=_t,mt[9]*=Et,mt[2]*=gt,mt[6]*=_t,mt[10]*=Et,mt[3]*=gt,mt[7]*=_t,mt[11]*=Et,this}getMaxScaleOnAxis(){let st=this.elements,mt=st[0]*st[0]+st[1]*st[1]+st[2]*st[2],gt=st[4]*st[4]+st[5]*st[5]+st[6]*st[6],_t=st[8]*st[8]+st[9]*st[9]+st[10]*st[10];return Math.sqrt(Math.max(mt,gt,_t))}makeTranslation(st,mt,gt){return this.set(1,0,0,st,0,1,0,mt,0,0,1,gt,0,0,0,1),this}makeRotationX(st){let mt=Math.cos(st),gt=Math.sin(st);return this.set(1,0,0,0,0,mt,-gt,0,0,gt,mt,0,0,0,0,1),this}makeRotationY(st){let mt=Math.cos(st),gt=Math.sin(st);return this.set(mt,0,gt,0,0,1,0,0,-gt,0,mt,0,0,0,0,1),this}makeRotationZ(st){let mt=Math.cos(st),gt=Math.sin(st);return this.set(mt,-gt,0,0,gt,mt,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(st,mt){let gt=Math.cos(mt),_t=Math.sin(mt),Et=1-gt,At=st.x,Rt=st.y,Ft=st.z,Nt=Et*At,Bt=Et*Rt;return this.set(Nt*At+gt,Nt*Rt-_t*Ft,Nt*Ft+_t*Rt,0,Nt*Rt+_t*Ft,Bt*Rt+gt,Bt*Ft-_t*At,0,Nt*Ft-_t*Rt,Bt*Ft+_t*At,Et*Ft*Ft+gt,0,0,0,0,1),this}makeScale(st,mt,gt){return this.set(st,0,0,0,0,mt,0,0,0,0,gt,0,0,0,0,1),this}makeShear(st,mt,gt,_t,Et,At){return this.set(1,gt,Et,0,st,1,At,0,mt,_t,1,0,0,0,0,1),this}compose(st,mt,gt){let _t=this.elements,Et=mt._x,At=mt._y,Rt=mt._z,Ft=mt._w,Nt=Et+Et,Bt=At+At,Gt=Rt+Rt,dr=Et*Nt,Mr=Et*Bt,Tr=Et*Gt,zr=At*Bt,Fr=At*Gt,Nr=Rt*Gt,tn=Ft*Nt,rn=Ft*Bt,Tn=Ft*Gt,$n=gt.x,un=gt.y,es=gt.z;return _t[0]=(1-(zr+Nr))*$n,_t[1]=(Mr+Tn)*$n,_t[2]=(Tr-rn)*$n,_t[3]=0,_t[4]=(Mr-Tn)*un,_t[5]=(1-(dr+Nr))*un,_t[6]=(Fr+tn)*un,_t[7]=0,_t[8]=(Tr+rn)*es,_t[9]=(Fr-tn)*es,_t[10]=(1-(dr+zr))*es,_t[11]=0,_t[12]=st.x,_t[13]=st.y,_t[14]=st.z,_t[15]=1,this}decompose(st,mt,gt){let _t=this.elements,Et=gu.set(_t[0],_t[1],_t[2]).length(),At=gu.set(_t[4],_t[5],_t[6]).length(),Rt=gu.set(_t[8],_t[9],_t[10]).length();this.determinant()<0&&(Et=-Et),st.x=_t[12],st.y=_t[13],st.z=_t[14],Ps.copy(this);let Ft=1/Et,Nt=1/At,Bt=1/Rt;return Ps.elements[0]*=Ft,Ps.elements[1]*=Ft,Ps.elements[2]*=Ft,Ps.elements[4]*=Nt,Ps.elements[5]*=Nt,Ps.elements[6]*=Nt,Ps.elements[8]*=Bt,Ps.elements[9]*=Bt,Ps.elements[10]*=Bt,mt.setFromRotationMatrix(Ps),gt.x=Et,gt.y=At,gt.z=Rt,this}makePerspective(st,mt,gt,_t,Et,At){let Rt=this.elements,Ft=2*Et/(mt-st),Nt=2*Et/(gt-_t),Bt=(mt+st)/(mt-st),Gt=(gt+_t)/(gt-_t),dr=-(At+Et)/(At-Et),Mr=-2*At*Et/(At-Et);return Rt[0]=Ft,Rt[4]=0,Rt[8]=Bt,Rt[12]=0,Rt[1]=0,Rt[5]=Nt,Rt[9]=Gt,Rt[13]=0,Rt[2]=0,Rt[6]=0,Rt[10]=dr,Rt[14]=Mr,Rt[3]=0,Rt[7]=0,Rt[11]=-1,Rt[15]=0,this}makeOrthographic(st,mt,gt,_t,Et,At){let Rt=this.elements,Ft=1/(mt-st),Nt=1/(gt-_t),Bt=1/(At-Et),Gt=(mt+st)*Ft,dr=(gt+_t)*Nt,Mr=(At+Et)*Bt;return Rt[0]=2*Ft,Rt[4]=0,Rt[8]=0,Rt[12]=-Gt,Rt[1]=0,Rt[5]=2*Nt,Rt[9]=0,Rt[13]=-dr,Rt[2]=0,Rt[6]=0,Rt[10]=-2*Bt,Rt[14]=-Mr,Rt[3]=0,Rt[7]=0,Rt[11]=0,Rt[15]=1,this}equals(st){let mt=this.elements,gt=st.elements;for(let _t=0;_t<16;_t++)if(mt[_t]!==gt[_t])return!1;return!0}fromArray(st,mt=0){for(let gt=0;gt<16;gt++)this.elements[gt]=st[gt+mt];return this}toArray(st=[],mt=0){let gt=this.elements;return st[mt]=gt[0],st[mt+1]=gt[1],st[mt+2]=gt[2],st[mt+3]=gt[3],st[mt+4]=gt[4],st[mt+5]=gt[5],st[mt+6]=gt[6],st[mt+7]=gt[7],st[mt+8]=gt[8],st[mt+9]=gt[9],st[mt+10]=gt[10],st[mt+11]=gt[11],st[mt+12]=gt[12],st[mt+13]=gt[13],st[mt+14]=gt[14],st[mt+15]=gt[15],st}},gu=new E$6,Ps=new ue$1,vV=new E$6(0,0,0),xV=new E$6(1,1,1),Wa=new E$6,Tg=new E$6,Gn=new E$6,GT=new ue$1,jT=new Qe$1,ir=class{constructor(nt=0,st=0,mt=0,gt=ir.DEFAULT_ORDER){this.isEuler=!0,this._x=nt,this._y=st,this._z=mt,this._order=gt}get x(){return this._x}set x(nt){this._x=nt,this._onChangeCallback()}get y(){return this._y}set y(nt){this._y=nt,this._onChangeCallback()}get z(){return this._z}set z(nt){this._z=nt,this._onChangeCallback()}get order(){return this._order}set order(nt){this._order=nt,this._onChangeCallback()}set(nt,st,mt,gt=this._order){return this._x=nt,this._y=st,this._z=mt,this._order=gt,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(nt){return this._x=nt._x,this._y=nt._y,this._z=nt._z,this._order=nt._order,this._onChangeCallback(),this}setFromRotationMatrix(nt,st=this._order,mt=!0){let gt=nt.elements,_t=gt[0],Et=gt[4],At=gt[8],Rt=gt[1],Ft=gt[5],Nt=gt[9],Bt=gt[2],Gt=gt[6],dr=gt[10];switch(st){case"XYZ":this._y=Math.asin(di(At,-1,1)),Math.abs(At)<.9999999?(this._x=Math.atan2(-Nt,dr),this._z=Math.atan2(-Et,_t)):(this._x=Math.atan2(Gt,Ft),this._z=0);break;case"YXZ":this._x=Math.asin(-di(Nt,-1,1)),Math.abs(Nt)<.9999999?(this._y=Math.atan2(At,dr),this._z=Math.atan2(Rt,Ft)):(this._y=Math.atan2(-Bt,_t),this._z=0);break;case"ZXY":this._x=Math.asin(di(Gt,-1,1)),Math.abs(Gt)<.9999999?(this._y=Math.atan2(-Bt,dr),this._z=Math.atan2(-Et,Ft)):(this._y=0,this._z=Math.atan2(Rt,_t));break;case"ZYX":this._y=Math.asin(-di(Bt,-1,1)),Math.abs(Bt)<.9999999?(this._x=Math.atan2(Gt,dr),this._z=Math.atan2(Rt,_t)):(this._x=0,this._z=Math.atan2(-Et,Ft));break;case"YZX":this._z=Math.asin(di(Rt,-1,1)),Math.abs(Rt)<.9999999?(this._x=Math.atan2(-Nt,Ft),this._y=Math.atan2(-Bt,_t)):(this._x=0,this._y=Math.atan2(At,dr));break;case"XZY":this._z=Math.asin(-di(Et,-1,1)),Math.abs(Et)<.9999999?(this._x=Math.atan2(Gt,Ft),this._y=Math.atan2(At,_t)):(this._x=Math.atan2(-Nt,dr),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+st)}return this._order=st,mt===!0&&this._onChangeCallback(),this}setFromQuaternion(nt,st,mt){return GT.makeRotationFromQuaternion(nt),this.setFromRotationMatrix(GT,st,mt)}setFromVector3(nt,st=this._order){return this.set(nt.x,nt.y,nt.z,st)}reorder(nt){return jT.setFromEuler(this),this.setFromQuaternion(jT,nt)}equals(nt){return nt._x===this._x&&nt._y===this._y&&nt._z===this._z&&nt._order===this._order}fromArray(nt){return this._x=nt[0],this._y=nt[1],this._z=nt[2],nt[3]!==void 0&&(this._order=nt[3]),this._onChangeCallback(),this}toArray(nt=[],st=0){return nt[st]=this._x,nt[st+1]=this._y,nt[st+2]=this._z,nt[st+3]=this._order,nt}_onChange(nt){return this._onChangeCallback=nt,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};ir.DEFAULT_ORDER="XYZ";var lp=class{constructor(){this.mask=1}set(nt){this.mask=(1<<nt|0)>>>0}enable(nt){this.mask|=1<<nt|0}enableAll(){this.mask=-1}toggle(nt){this.mask^=1<<nt|0}disable(nt){this.mask&=~(1<<nt|0)}disableAll(){this.mask=0}test(nt){return(this.mask&nt.mask)!==0}isEnabled(nt){return(this.mask&(1<<nt|0))!==0}},bV=0,HT=new E$6,yu=new Qe$1,ta=new ue$1,Cg=new E$6,Wf=new E$6,SV=new E$6,wV=new Qe$1,WT=new E$6(1,0,0),qT=new E$6(0,1,0),YT=new E$6(0,0,1),AV={type:"added"},XT={type:"removed"},Mt=class extends pr{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:bV++}),this.uuid=is(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Mt.DEFAULT_UP.clone();let nt=new E$6,st=new ir,mt=new Qe$1,gt=new E$6(1,1,1);function _t(){mt.setFromEuler(st,!1)}function Et(){st.setFromQuaternion(mt,void 0,!1)}st._onChange(_t),mt._onChange(Et),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:nt},rotation:{configurable:!0,enumerable:!0,value:st},quaternion:{configurable:!0,enumerable:!0,value:mt},scale:{configurable:!0,enumerable:!0,value:gt},modelViewMatrix:{value:new ue$1},normalMatrix:{value:new fr}}),this.matrix=new ue$1,this.matrixWorld=new ue$1,this.matrixAutoUpdate=Mt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Mt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new lp,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(nt){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(nt),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(nt){return this.quaternion.premultiply(nt),this}setRotationFromAxisAngle(nt,st){this.quaternion.setFromAxisAngle(nt,st)}setRotationFromEuler(nt){this.quaternion.setFromEuler(nt,!0)}setRotationFromMatrix(nt){this.quaternion.setFromRotationMatrix(nt)}setRotationFromQuaternion(nt){this.quaternion.copy(nt)}rotateOnAxis(nt,st){return yu.setFromAxisAngle(nt,st),this.quaternion.multiply(yu),this}rotateOnWorldAxis(nt,st){return yu.setFromAxisAngle(nt,st),this.quaternion.premultiply(yu),this}rotateX(nt){return this.rotateOnAxis(WT,nt)}rotateY(nt){return this.rotateOnAxis(qT,nt)}rotateZ(nt){return this.rotateOnAxis(YT,nt)}translateOnAxis(nt,st){return HT.copy(nt).applyQuaternion(this.quaternion),this.position.add(HT.multiplyScalar(st)),this}translateX(nt){return this.translateOnAxis(WT,nt)}translateY(nt){return this.translateOnAxis(qT,nt)}translateZ(nt){return this.translateOnAxis(YT,nt)}localToWorld(nt){return this.updateWorldMatrix(!0,!1),nt.applyMatrix4(this.matrixWorld)}worldToLocal(nt){return this.updateWorldMatrix(!0,!1),nt.applyMatrix4(ta.copy(this.matrixWorld).invert())}lookAt(nt,st,mt){nt.isVector3?Cg.copy(nt):Cg.set(nt,st,mt);let gt=this.parent;this.updateWorldMatrix(!0,!1),Wf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ta.lookAt(Wf,Cg,this.up):ta.lookAt(Cg,Wf,this.up),this.quaternion.setFromRotationMatrix(ta),gt&&(ta.extractRotation(gt.matrixWorld),yu.setFromRotationMatrix(ta),this.quaternion.premultiply(yu.invert()))}add(nt){if(arguments.length>1){for(let st=0;st<arguments.length;st++)this.add(arguments[st]);return this}return nt===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",nt),this):(nt&&nt.isObject3D?(nt.parent!==null&&nt.parent.remove(nt),nt.parent=this,this.children.push(nt),nt.dispatchEvent(AV)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",nt),this)}remove(nt){if(arguments.length>1){for(let mt=0;mt<arguments.length;mt++)this.remove(arguments[mt]);return this}let st=this.children.indexOf(nt);return st!==-1&&(nt.parent=null,this.children.splice(st,1),nt.dispatchEvent(XT)),this}removeFromParent(){let nt=this.parent;return nt!==null&&nt.remove(this),this}clear(){for(let nt=0;nt<this.children.length;nt++){let st=this.children[nt];st.parent=null,st.dispatchEvent(XT)}return this.children.length=0,this}attach(nt){return this.updateWorldMatrix(!0,!1),ta.copy(this.matrixWorld).invert(),nt.parent!==null&&(nt.parent.updateWorldMatrix(!0,!1),ta.multiply(nt.parent.matrixWorld)),nt.applyMatrix4(ta),this.add(nt),nt.updateWorldMatrix(!1,!0),this}getObjectById(nt){return this.getObjectByProperty("id",nt)}getObjectByName(nt){return this.getObjectByProperty("name",nt)}getObjectByProperty(nt,st){if(this[nt]===st)return this;for(let mt=0,gt=this.children.length;mt<gt;mt++){let _t=this.children[mt].getObjectByProperty(nt,st);if(_t!==void 0)return _t}}getObjectsByProperty(nt,st){let mt=[];this[nt]===st&&mt.push(this);for(let gt=0,_t=this.children.length;gt<_t;gt++){let Et=this.children[gt].getObjectsByProperty(nt,st);Et.length>0&&(mt=mt.concat(Et))}return mt}getWorldPosition(nt){return this.updateWorldMatrix(!0,!1),nt.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(nt){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wf,nt,SV),nt}getWorldScale(nt){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wf,wV,nt),nt}getWorldDirection(nt){this.updateWorldMatrix(!0,!1);let st=this.matrixWorld.elements;return nt.set(st[8],st[9],st[10]).normalize()}raycast(){}traverse(nt){nt(this);let st=this.children;for(let mt=0,gt=st.length;mt<gt;mt++)st[mt].traverse(nt)}traverseVisible(nt){if(this.visible===!1)return;nt(this);let st=this.children;for(let mt=0,gt=st.length;mt<gt;mt++)st[mt].traverseVisible(nt)}traverseAncestors(nt){let st=this.parent;st!==null&&(nt(st),st.traverseAncestors(nt))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(nt){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||nt)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,nt=!0);let st=this.children;for(let mt=0,gt=st.length;mt<gt;mt++){let _t=st[mt];(_t.matrixWorldAutoUpdate===!0||nt===!0)&&_t.updateMatrixWorld(nt)}}updateWorldMatrix(nt,st){let mt=this.parent;if(nt===!0&&mt!==null&&mt.matrixWorldAutoUpdate===!0&&mt.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),st===!0){let gt=this.children;for(let _t=0,Et=gt.length;_t<Et;_t++){let At=gt[_t];At.matrixWorldAutoUpdate===!0&&At.updateWorldMatrix(!1,!0)}}}toJSON(nt){let st=nt===void 0||typeof nt=="string",mt={};st&&(nt={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},mt.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let gt={};gt.uuid=this.uuid,gt.type=this.type,this.name!==""&&(gt.name=this.name),this.castShadow===!0&&(gt.castShadow=!0),this.receiveShadow===!0&&(gt.receiveShadow=!0),this.visible===!1&&(gt.visible=!1),this.frustumCulled===!1&&(gt.frustumCulled=!1),this.renderOrder!==0&&(gt.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(gt.userData=this.userData),gt.layers=this.layers.mask,gt.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(gt.matrixAutoUpdate=!1),this.isInstancedMesh&&(gt.type="InstancedMesh",gt.count=this.count,gt.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(gt.instanceColor=this.instanceColor.toJSON()));function _t(At,Rt){return At[Rt.uuid]===void 0&&(At[Rt.uuid]=Rt.toJSON(nt)),Rt.uuid}if(this.isScene)this.background&&(this.background.isColor?gt.background=this.background.toJSON():this.background.isTexture&&(gt.background=this.background.toJSON(nt).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(gt.environment=this.environment.toJSON(nt).uuid);else if(this.isMesh||this.isLine||this.isPoints){gt.geometry=_t(nt.geometries,this.geometry);let At=this.geometry.parameters;if(At!==void 0&&At.shapes!==void 0){let Rt=At.shapes;if(Array.isArray(Rt))for(let Ft=0,Nt=Rt.length;Ft<Nt;Ft++){let Bt=Rt[Ft];_t(nt.shapes,Bt)}else _t(nt.shapes,Rt)}}if(this.isSkinnedMesh&&(gt.bindMode=this.bindMode,gt.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(_t(nt.skeletons,this.skeleton),gt.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let At=[];for(let Rt=0,Ft=this.material.length;Rt<Ft;Rt++)At.push(_t(nt.materials,this.material[Rt]));gt.material=At}else gt.material=_t(nt.materials,this.material);if(this.children.length>0){gt.children=[];for(let At=0;At<this.children.length;At++)gt.children.push(this.children[At].toJSON(nt).object)}if(this.animations.length>0){gt.animations=[];for(let At=0;At<this.animations.length;At++){let Rt=this.animations[At];gt.animations.push(_t(nt.animations,Rt))}}if(st){let At=Et(nt.geometries),Rt=Et(nt.materials),Ft=Et(nt.textures),Nt=Et(nt.images),Bt=Et(nt.shapes),Gt=Et(nt.skeletons),dr=Et(nt.animations),Mr=Et(nt.nodes);At.length>0&&(mt.geometries=At),Rt.length>0&&(mt.materials=Rt),Ft.length>0&&(mt.textures=Ft),Nt.length>0&&(mt.images=Nt),Bt.length>0&&(mt.shapes=Bt),Gt.length>0&&(mt.skeletons=Gt),dr.length>0&&(mt.animations=dr),Mr.length>0&&(mt.nodes=Mr)}return mt.object=gt,mt;function Et(At){let Rt=[];for(let Ft in At){let Nt=At[Ft];delete Nt.metadata,Rt.push(Nt)}return Rt}}clone(nt){return new this.constructor().copy(this,nt)}copy(nt,st=!0){if(this.name=nt.name,this.up.copy(nt.up),this.position.copy(nt.position),this.rotation.order=nt.rotation.order,this.quaternion.copy(nt.quaternion),this.scale.copy(nt.scale),this.matrix.copy(nt.matrix),this.matrixWorld.copy(nt.matrixWorld),this.matrixAutoUpdate=nt.matrixAutoUpdate,this.matrixWorldNeedsUpdate=nt.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=nt.matrixWorldAutoUpdate,this.layers.mask=nt.layers.mask,this.visible=nt.visible,this.castShadow=nt.castShadow,this.receiveShadow=nt.receiveShadow,this.frustumCulled=nt.frustumCulled,this.renderOrder=nt.renderOrder,this.userData=JSON.parse(JSON.stringify(nt.userData)),st===!0)for(let mt=0;mt<nt.children.length;mt++){let gt=nt.children[mt];this.add(gt.clone())}return this}};Mt.DEFAULT_UP=new E$6(0,1,0);Mt.DEFAULT_MATRIX_AUTO_UPDATE=!0;Mt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var _s=new E$6,ra=new E$6,wS=new E$6,ia=new E$6,vu=new E$6,xu=new E$6,QT=new E$6,AS=new E$6,ES=new E$6,MS$1=new E$6,Cr=class{constructor(nt=new E$6,st=new E$6,mt=new E$6){this.a=nt,this.b=st,this.c=mt}static getNormal(nt,st,mt,gt){gt.subVectors(mt,st),_s.subVectors(nt,st),gt.cross(_s);let _t=gt.lengthSq();return _t>0?gt.multiplyScalar(1/Math.sqrt(_t)):gt.set(0,0,0)}static getBarycoord(nt,st,mt,gt,_t){_s.subVectors(gt,st),ra.subVectors(mt,st),wS.subVectors(nt,st);let Et=_s.dot(_s),At=_s.dot(ra),Rt=_s.dot(wS),Ft=ra.dot(ra),Nt=ra.dot(wS),Bt=Et*Ft-At*At;if(Bt===0)return _t.set(-2,-1,-1);let Gt=1/Bt,dr=(Ft*Rt-At*Nt)*Gt,Mr=(Et*Nt-At*Rt)*Gt;return _t.set(1-dr-Mr,Mr,dr)}static containsPoint(nt,st,mt,gt){return this.getBarycoord(nt,st,mt,gt,ia),ia.x>=0&&ia.y>=0&&ia.x+ia.y<=1}static getUV(nt,st,mt,gt,_t,Et,At,Rt){return this.getBarycoord(nt,st,mt,gt,ia),Rt.set(0,0),Rt.addScaledVector(_t,ia.x),Rt.addScaledVector(Et,ia.y),Rt.addScaledVector(At,ia.z),Rt}static isFrontFacing(nt,st,mt,gt){return _s.subVectors(mt,st),ra.subVectors(nt,st),_s.cross(ra).dot(gt)<0}set(nt,st,mt){return this.a.copy(nt),this.b.copy(st),this.c.copy(mt),this}setFromPointsAndIndices(nt,st,mt,gt){return this.a.copy(nt[st]),this.b.copy(nt[mt]),this.c.copy(nt[gt]),this}setFromAttributeAndIndices(nt,st,mt,gt){return this.a.fromBufferAttribute(nt,st),this.b.fromBufferAttribute(nt,mt),this.c.fromBufferAttribute(nt,gt),this}clone(){return new this.constructor().copy(this)}copy(nt){return this.a.copy(nt.a),this.b.copy(nt.b),this.c.copy(nt.c),this}getArea(){return _s.subVectors(this.c,this.b),ra.subVectors(this.a,this.b),_s.cross(ra).length()*.5}getMidpoint(nt){return nt.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(nt){return Cr.getNormal(this.a,this.b,this.c,nt)}getPlane(nt){return nt.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(nt,st){return Cr.getBarycoord(nt,this.a,this.b,this.c,st)}getUV(nt,st,mt,gt,_t){return Cr.getUV(nt,this.a,this.b,this.c,st,mt,gt,_t)}containsPoint(nt){return Cr.containsPoint(nt,this.a,this.b,this.c)}isFrontFacing(nt){return Cr.isFrontFacing(this.a,this.b,this.c,nt)}intersectsBox(nt){return nt.intersectsTriangle(this)}closestPointToPoint(nt,st){let mt=this.a,gt=this.b,_t=this.c,Et,At;vu.subVectors(gt,mt),xu.subVectors(_t,mt),AS.subVectors(nt,mt);let Rt=vu.dot(AS),Ft=xu.dot(AS);if(Rt<=0&&Ft<=0)return st.copy(mt);ES.subVectors(nt,gt);let Nt=vu.dot(ES),Bt=xu.dot(ES);if(Nt>=0&&Bt<=Nt)return st.copy(gt);let Gt=Rt*Bt-Nt*Ft;if(Gt<=0&&Rt>=0&&Nt<=0)return Et=Rt/(Rt-Nt),st.copy(mt).addScaledVector(vu,Et);MS$1.subVectors(nt,_t);let dr=vu.dot(MS$1),Mr=xu.dot(MS$1);if(Mr>=0&&dr<=Mr)return st.copy(_t);let Tr=dr*Ft-Rt*Mr;if(Tr<=0&&Ft>=0&&Mr<=0)return At=Ft/(Ft-Mr),st.copy(mt).addScaledVector(xu,At);let zr=Nt*Mr-dr*Bt;if(zr<=0&&Bt-Nt>=0&&dr-Mr>=0)return QT.subVectors(_t,gt),At=(Bt-Nt)/(Bt-Nt+(dr-Mr)),st.copy(gt).addScaledVector(QT,At);let Fr=1/(zr+Tr+Gt);return Et=Tr*Fr,At=Gt*Fr,st.copy(mt).addScaledVector(vu,Et).addScaledVector(xu,At)}equals(nt){return nt.a.equals(this.a)&&nt.b.equals(this.b)&&nt.c.equals(this.c)}},EV=0,fc=class extends pr{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:EV++}),this.uuid=is(),this.name="",this.type="Material",this.blending=Ya,this.side=Hn,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=kC,this.blendDst=GC,this.blendEquation=Tu,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=zS,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=tV,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=uS,this.stencilZFail=uS,this.stencilZPass=uS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(nt){this._alphaTest>0!=nt>0&&this.version++,this._alphaTest=nt}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(nt){if(nt!==void 0)for(let st in nt){let mt=nt[st];if(mt===void 0){console.warn("THREE.Material: '"+st+"' parameter is undefined.");continue}let gt=this[st];if(gt===void 0){console.warn("THREE."+this.type+": '"+st+"' is not a property of this material.");continue}gt&&gt.isColor?gt.set(mt):gt&&gt.isVector3&&mt&&mt.isVector3?gt.copy(mt):this[st]=mt}}toJSON(nt){let st=nt===void 0||typeof nt=="string";st&&(nt={textures:{},images:{}});let mt={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};mt.uuid=this.uuid,mt.type=this.type,this.name!==""&&(mt.name=this.name),this.color&&this.color.isColor&&(mt.color=this.color.getHex()),this.roughness!==void 0&&(mt.roughness=this.roughness),this.metalness!==void 0&&(mt.metalness=this.metalness),this.sheen!==void 0&&(mt.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(mt.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(mt.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(mt.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(mt.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(mt.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(mt.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(mt.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(mt.shininess=this.shininess),this.clearcoat!==void 0&&(mt.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(mt.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(mt.clearcoatMap=this.clearcoatMap.toJSON(nt).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(mt.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(nt).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(mt.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(nt).uuid,mt.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(mt.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(mt.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(mt.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(mt.iridescenceMap=this.iridescenceMap.toJSON(nt).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(mt.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(nt).uuid),this.map&&this.map.isTexture&&(mt.map=this.map.toJSON(nt).uuid),this.matcap&&this.matcap.isTexture&&(mt.matcap=this.matcap.toJSON(nt).uuid),this.alphaMap&&this.alphaMap.isTexture&&(mt.alphaMap=this.alphaMap.toJSON(nt).uuid),this.lightMap&&this.lightMap.isTexture&&(mt.lightMap=this.lightMap.toJSON(nt).uuid,mt.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(mt.aoMap=this.aoMap.toJSON(nt).uuid,mt.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(mt.bumpMap=this.bumpMap.toJSON(nt).uuid,mt.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(mt.normalMap=this.normalMap.toJSON(nt).uuid,mt.normalMapType=this.normalMapType,mt.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(mt.displacementMap=this.displacementMap.toJSON(nt).uuid,mt.displacementScale=this.displacementScale,mt.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(mt.roughnessMap=this.roughnessMap.toJSON(nt).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(mt.metalnessMap=this.metalnessMap.toJSON(nt).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(mt.emissiveMap=this.emissiveMap.toJSON(nt).uuid),this.specularMap&&this.specularMap.isTexture&&(mt.specularMap=this.specularMap.toJSON(nt).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(mt.specularIntensityMap=this.specularIntensityMap.toJSON(nt).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(mt.specularColorMap=this.specularColorMap.toJSON(nt).uuid),this.envMap&&this.envMap.isTexture&&(mt.envMap=this.envMap.toJSON(nt).uuid,this.combine!==void 0&&(mt.combine=this.combine)),this.envMapIntensity!==void 0&&(mt.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(mt.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(mt.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(mt.gradientMap=this.gradientMap.toJSON(nt).uuid),this.transmission!==void 0&&(mt.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(mt.transmissionMap=this.transmissionMap.toJSON(nt).uuid),this.thickness!==void 0&&(mt.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(mt.thicknessMap=this.thicknessMap.toJSON(nt).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(mt.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(mt.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(mt.size=this.size),this.shadowSide!==null&&(mt.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(mt.sizeAttenuation=this.sizeAttenuation),this.blending!==Ya&&(mt.blending=this.blending),this.side!==Hn&&(mt.side=this.side),this.vertexColors&&(mt.vertexColors=!0),this.opacity<1&&(mt.opacity=this.opacity),this.transparent===!0&&(mt.transparent=this.transparent),mt.depthFunc=this.depthFunc,mt.depthTest=this.depthTest,mt.depthWrite=this.depthWrite,mt.colorWrite=this.colorWrite,mt.stencilWrite=this.stencilWrite,mt.stencilWriteMask=this.stencilWriteMask,mt.stencilFunc=this.stencilFunc,mt.stencilRef=this.stencilRef,mt.stencilFuncMask=this.stencilFuncMask,mt.stencilFail=this.stencilFail,mt.stencilZFail=this.stencilZFail,mt.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(mt.rotation=this.rotation),this.polygonOffset===!0&&(mt.polygonOffset=!0),this.polygonOffsetFactor!==0&&(mt.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(mt.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(mt.linewidth=this.linewidth),this.dashSize!==void 0&&(mt.dashSize=this.dashSize),this.gapSize!==void 0&&(mt.gapSize=this.gapSize),this.scale!==void 0&&(mt.scale=this.scale),this.dithering===!0&&(mt.dithering=!0),this.alphaTest>0&&(mt.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(mt.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(mt.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(mt.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(mt.wireframe=this.wireframe),this.wireframeLinewidth>1&&(mt.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(mt.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(mt.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(mt.flatShading=this.flatShading),this.visible===!1&&(mt.visible=!1),this.toneMapped===!1&&(mt.toneMapped=!1),this.fog===!1&&(mt.fog=!1),Object.keys(this.userData).length>0&&(mt.userData=this.userData);function gt(_t){let Et=[];for(let At in _t){let Rt=_t[At];delete Rt.metadata,Et.push(Rt)}return Et}if(st){let _t=gt(nt.textures),Et=gt(nt.images);_t.length>0&&(mt.textures=_t),Et.length>0&&(mt.images=Et)}return mt}clone(){return new this.constructor().copy(this)}copy(nt){this.name=nt.name,this.blending=nt.blending,this.side=nt.side,this.vertexColors=nt.vertexColors,this.opacity=nt.opacity,this.transparent=nt.transparent,this.blendSrc=nt.blendSrc,this.blendDst=nt.blendDst,this.blendEquation=nt.blendEquation,this.blendSrcAlpha=nt.blendSrcAlpha,this.blendDstAlpha=nt.blendDstAlpha,this.blendEquationAlpha=nt.blendEquationAlpha,this.depthFunc=nt.depthFunc,this.depthTest=nt.depthTest,this.depthWrite=nt.depthWrite,this.stencilWriteMask=nt.stencilWriteMask,this.stencilFunc=nt.stencilFunc,this.stencilRef=nt.stencilRef,this.stencilFuncMask=nt.stencilFuncMask,this.stencilFail=nt.stencilFail,this.stencilZFail=nt.stencilZFail,this.stencilZPass=nt.stencilZPass,this.stencilWrite=nt.stencilWrite;let st=nt.clippingPlanes,mt=null;if(st!==null){let gt=st.length;mt=new Array(gt);for(let _t=0;_t!==gt;++_t)mt[_t]=st[_t].clone()}return this.clippingPlanes=mt,this.clipIntersection=nt.clipIntersection,this.clipShadows=nt.clipShadows,this.shadowSide=nt.shadowSide,this.colorWrite=nt.colorWrite,this.precision=nt.precision,this.polygonOffset=nt.polygonOffset,this.polygonOffsetFactor=nt.polygonOffsetFactor,this.polygonOffsetUnits=nt.polygonOffsetUnits,this.dithering=nt.dithering,this.alphaTest=nt.alphaTest,this.alphaToCoverage=nt.alphaToCoverage,this.premultipliedAlpha=nt.premultipliedAlpha,this.forceSinglePass=nt.forceSinglePass,this.visible=nt.visible,this.toneMapped=nt.toneMapped,this.userData=JSON.parse(JSON.stringify(nt.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(nt){nt===!0&&this.version++}},on=class extends fc{constructor(nt){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new We$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=jC,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(nt)}copy(nt){return super.copy(nt),this.color.copy(nt.color),this.map=nt.map,this.lightMap=nt.lightMap,this.lightMapIntensity=nt.lightMapIntensity,this.aoMap=nt.aoMap,this.aoMapIntensity=nt.aoMapIntensity,this.specularMap=nt.specularMap,this.alphaMap=nt.alphaMap,this.envMap=nt.envMap,this.combine=nt.combine,this.reflectivity=nt.reflectivity,this.refractionRatio=nt.refractionRatio,this.wireframe=nt.wireframe,this.wireframeLinewidth=nt.wireframeLinewidth,this.wireframeLinecap=nt.wireframeLinecap,this.wireframeLinejoin=nt.wireframeLinejoin,this.fog=nt.fog,this}},hi=new E$6,Pg=new U$1,Xe$1=class{constructor(st,mt,gt=!1){if(Array.isArray(st))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=st,this.itemSize=mt,this.count=st!==void 0?st.length/mt:0,this.normalized=gt,this.usage=HS,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(st){st===!0&&this.version++}setUsage(st){return this.usage=st,this}copy(st){return this.name=st.name,this.array=new st.array.constructor(st.array),this.itemSize=st.itemSize,this.count=st.count,this.normalized=st.normalized,this.usage=st.usage,this}copyAt(st,mt,gt){st*=this.itemSize,gt*=mt.itemSize;for(let _t=0,Et=this.itemSize;_t<Et;_t++)this.array[st+_t]=mt.array[gt+_t];return this}copyArray(st){return this.array.set(st),this}applyMatrix3(st){if(this.itemSize===2)for(let mt=0,gt=this.count;mt<gt;mt++)Pg.fromBufferAttribute(this,mt),Pg.applyMatrix3(st),this.setXY(mt,Pg.x,Pg.y);else if(this.itemSize===3)for(let mt=0,gt=this.count;mt<gt;mt++)hi.fromBufferAttribute(this,mt),hi.applyMatrix3(st),this.setXYZ(mt,hi.x,hi.y,hi.z);return this}applyMatrix4(st){for(let mt=0,gt=this.count;mt<gt;mt++)hi.fromBufferAttribute(this,mt),hi.applyMatrix4(st),this.setXYZ(mt,hi.x,hi.y,hi.z);return this}applyNormalMatrix(st){for(let mt=0,gt=this.count;mt<gt;mt++)hi.fromBufferAttribute(this,mt),hi.applyNormalMatrix(st),this.setXYZ(mt,hi.x,hi.y,hi.z);return this}transformDirection(st){for(let mt=0,gt=this.count;mt<gt;mt++)hi.fromBufferAttribute(this,mt),hi.transformDirection(st),this.setXYZ(mt,hi.x,hi.y,hi.z);return this}set(st,mt=0){return this.array.set(st,mt),this}getX(st){let mt=this.array[st*this.itemSize];return this.normalized&&(mt=oa(mt,this.array)),mt}setX(st,mt){return this.normalized&&(mt=xr(mt,this.array)),this.array[st*this.itemSize]=mt,this}getY(st){let mt=this.array[st*this.itemSize+1];return this.normalized&&(mt=oa(mt,this.array)),mt}setY(st,mt){return this.normalized&&(mt=xr(mt,this.array)),this.array[st*this.itemSize+1]=mt,this}getZ(st){let mt=this.array[st*this.itemSize+2];return this.normalized&&(mt=oa(mt,this.array)),mt}setZ(st,mt){return this.normalized&&(mt=xr(mt,this.array)),this.array[st*this.itemSize+2]=mt,this}getW(st){let mt=this.array[st*this.itemSize+3];return this.normalized&&(mt=oa(mt,this.array)),mt}setW(st,mt){return this.normalized&&(mt=xr(mt,this.array)),this.array[st*this.itemSize+3]=mt,this}setXY(st,mt,gt){return st*=this.itemSize,this.normalized&&(mt=xr(mt,this.array),gt=xr(gt,this.array)),this.array[st+0]=mt,this.array[st+1]=gt,this}setXYZ(st,mt,gt,_t){return st*=this.itemSize,this.normalized&&(mt=xr(mt,this.array),gt=xr(gt,this.array),_t=xr(_t,this.array)),this.array[st+0]=mt,this.array[st+1]=gt,this.array[st+2]=_t,this}setXYZW(st,mt,gt,_t,Et){return st*=this.itemSize,this.normalized&&(mt=xr(mt,this.array),gt=xr(gt,this.array),_t=xr(_t,this.array),Et=xr(Et,this.array)),this.array[st+0]=mt,this.array[st+1]=gt,this.array[st+2]=_t,this.array[st+3]=Et,this}onUpload(st){return this.onUploadCallback=st,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let st={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(st.name=this.name),this.usage!==HS&&(st.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(st.updateRange=this.updateRange),st}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},iy=class extends Xe$1{constructor(nt,st,mt){super(new Uint16Array(nt),st,mt)}},ho$1=class extends Xe$1{constructor(st,mt,gt){super(new Uint32Array(st),mt,gt)}},Me$1=class extends Xe$1{constructor(st,mt,gt){super(new Float32Array(st),mt,gt)}},MV=0,rs=new ue$1,TS=new Mt,bu=new E$6,jn=new jt,qf=new jt,Ri=new E$6,_e$1=class extends pr{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:MV++}),this.uuid=is(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(st){return Array.isArray(st)?this.index=new(XC(st)?ho$1:iy)(st,1):this.index=st,this}getAttribute(st){return this.attributes[st]}setAttribute(st,mt){return this.attributes[st]=mt,this}deleteAttribute(st){return delete this.attributes[st],this}hasAttribute(st){return this.attributes[st]!==void 0}addGroup(st,mt,gt=0){this.groups.push({start:st,count:mt,materialIndex:gt})}clearGroups(){this.groups=[]}setDrawRange(st,mt){this.drawRange.start=st,this.drawRange.count=mt}applyMatrix4(st){let mt=this.attributes.position;mt!==void 0&&(mt.applyMatrix4(st),mt.needsUpdate=!0);let gt=this.attributes.normal;if(gt!==void 0){let Et=new fr().getNormalMatrix(st);gt.applyNormalMatrix(Et),gt.needsUpdate=!0}let _t=this.attributes.tangent;return _t!==void 0&&(_t.transformDirection(st),_t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(st){return rs.makeRotationFromQuaternion(st),this.applyMatrix4(rs),this}rotateX(st){return rs.makeRotationX(st),this.applyMatrix4(rs),this}rotateY(st){return rs.makeRotationY(st),this.applyMatrix4(rs),this}rotateZ(st){return rs.makeRotationZ(st),this.applyMatrix4(rs),this}translate(st,mt,gt){return rs.makeTranslation(st,mt,gt),this.applyMatrix4(rs),this}scale(st,mt,gt){return rs.makeScale(st,mt,gt),this.applyMatrix4(rs),this}lookAt(st){return TS.lookAt(st),TS.updateMatrix(),this.applyMatrix4(TS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(bu).negate(),this.translate(bu.x,bu.y,bu.z),this}setFromPoints(st){let mt=[];for(let gt=0,_t=st.length;gt<_t;gt++){let Et=st[gt];mt.push(Et.x,Et.y,Et.z||0)}return this.setAttribute("position",new Me$1(mt,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new jt);let st=this.attributes.position,mt=this.morphAttributes.position;if(st&&st.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new E$6(-1/0,-1/0,-1/0),new E$6(1/0,1/0,1/0));return}if(st!==void 0){if(this.boundingBox.setFromBufferAttribute(st),mt)for(let gt=0,_t=mt.length;gt<_t;gt++){let Et=mt[gt];jn.setFromBufferAttribute(Et),this.morphTargetsRelative?(Ri.addVectors(this.boundingBox.min,jn.min),this.boundingBox.expandByPoint(Ri),Ri.addVectors(this.boundingBox.max,jn.max),this.boundingBox.expandByPoint(Ri)):(this.boundingBox.expandByPoint(jn.min),this.boundingBox.expandByPoint(jn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Or);let st=this.attributes.position,mt=this.morphAttributes.position;if(st&&st.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new E$6,1/0);return}if(st){let gt=this.boundingSphere.center;if(jn.setFromBufferAttribute(st),mt)for(let Et=0,At=mt.length;Et<At;Et++){let Rt=mt[Et];qf.setFromBufferAttribute(Rt),this.morphTargetsRelative?(Ri.addVectors(jn.min,qf.min),jn.expandByPoint(Ri),Ri.addVectors(jn.max,qf.max),jn.expandByPoint(Ri)):(jn.expandByPoint(qf.min),jn.expandByPoint(qf.max))}jn.getCenter(gt);let _t=0;for(let Et=0,At=st.count;Et<At;Et++)Ri.fromBufferAttribute(st,Et),_t=Math.max(_t,gt.distanceToSquared(Ri));if(mt)for(let Et=0,At=mt.length;Et<At;Et++){let Rt=mt[Et],Ft=this.morphTargetsRelative;for(let Nt=0,Bt=Rt.count;Nt<Bt;Nt++)Ri.fromBufferAttribute(Rt,Nt),Ft&&(bu.fromBufferAttribute(st,Nt),Ri.add(bu)),_t=Math.max(_t,gt.distanceToSquared(Ri))}this.boundingSphere.radius=Math.sqrt(_t),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let st=this.index,mt=this.attributes;if(st===null||mt.position===void 0||mt.normal===void 0||mt.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let gt=st.array,_t=mt.position.array,Et=mt.normal.array,At=mt.uv.array,Rt=_t.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Xe$1(new Float32Array(4*Rt),4));let Ft=this.getAttribute("tangent").array,Nt=[],Bt=[];for(let Ko=0;Ko<Rt;Ko++)Nt[Ko]=new E$6,Bt[Ko]=new E$6;let Gt=new E$6,dr=new E$6,Mr=new E$6,Tr=new U$1,zr=new U$1,Fr=new U$1,Nr=new E$6,tn=new E$6;function rn(Ko,ds,Il){Gt.fromArray(_t,Ko*3),dr.fromArray(_t,ds*3),Mr.fromArray(_t,Il*3),Tr.fromArray(At,Ko*2),zr.fromArray(At,ds*2),Fr.fromArray(At,Il*2),dr.sub(Gt),Mr.sub(Gt),zr.sub(Tr),Fr.sub(Tr);let ru=1/(zr.x*Fr.y-Fr.x*zr.y);!isFinite(ru)||(Nr.copy(dr).multiplyScalar(Fr.y).addScaledVector(Mr,-zr.y).multiplyScalar(ru),tn.copy(Mr).multiplyScalar(zr.x).addScaledVector(dr,-Fr.x).multiplyScalar(ru),Nt[Ko].add(Nr),Nt[ds].add(Nr),Nt[Il].add(Nr),Bt[Ko].add(tn),Bt[ds].add(tn),Bt[Il].add(tn))}let Tn=this.groups;Tn.length===0&&(Tn=[{start:0,count:gt.length}]);for(let Ko=0,ds=Tn.length;Ko<ds;++Ko){let Il=Tn[Ko],ru=Il.start,uu=Il.count;for(let p0=ru,X1=ru+uu;p0<X1;p0+=3)rn(gt[p0+0],gt[p0+1],gt[p0+2])}let $n=new E$6,un=new E$6,es=new E$6,kn=new E$6;function ts(Ko){es.fromArray(Et,Ko*3),kn.copy(es);let ds=Nt[Ko];$n.copy(ds),$n.sub(es.multiplyScalar(es.dot(ds))).normalize(),un.crossVectors(kn,ds);let Il=un.dot(Bt[Ko])<0?-1:1;Ft[Ko*4]=$n.x,Ft[Ko*4+1]=$n.y,Ft[Ko*4+2]=$n.z,Ft[Ko*4+3]=Il}for(let Ko=0,ds=Tn.length;Ko<ds;++Ko){let Il=Tn[Ko],ru=Il.start,uu=Il.count;for(let p0=ru,X1=ru+uu;p0<X1;p0+=3)ts(gt[p0+0]),ts(gt[p0+1]),ts(gt[p0+2])}}computeVertexNormals(){let st=this.index,mt=this.getAttribute("position");if(mt!==void 0){let gt=this.getAttribute("normal");if(gt===void 0)gt=new Xe$1(new Float32Array(mt.count*3),3),this.setAttribute("normal",gt);else for(let dr=0,Mr=gt.count;dr<Mr;dr++)gt.setXYZ(dr,0,0,0);let _t=new E$6,Et=new E$6,At=new E$6,Rt=new E$6,Ft=new E$6,Nt=new E$6,Bt=new E$6,Gt=new E$6;if(st)for(let dr=0,Mr=st.count;dr<Mr;dr+=3){let Tr=st.getX(dr+0),zr=st.getX(dr+1),Fr=st.getX(dr+2);_t.fromBufferAttribute(mt,Tr),Et.fromBufferAttribute(mt,zr),At.fromBufferAttribute(mt,Fr),Bt.subVectors(At,Et),Gt.subVectors(_t,Et),Bt.cross(Gt),Rt.fromBufferAttribute(gt,Tr),Ft.fromBufferAttribute(gt,zr),Nt.fromBufferAttribute(gt,Fr),Rt.add(Bt),Ft.add(Bt),Nt.add(Bt),gt.setXYZ(Tr,Rt.x,Rt.y,Rt.z),gt.setXYZ(zr,Ft.x,Ft.y,Ft.z),gt.setXYZ(Fr,Nt.x,Nt.y,Nt.z)}else for(let dr=0,Mr=mt.count;dr<Mr;dr+=3)_t.fromBufferAttribute(mt,dr+0),Et.fromBufferAttribute(mt,dr+1),At.fromBufferAttribute(mt,dr+2),Bt.subVectors(At,Et),Gt.subVectors(_t,Et),Bt.cross(Gt),gt.setXYZ(dr+0,Bt.x,Bt.y,Bt.z),gt.setXYZ(dr+1,Bt.x,Bt.y,Bt.z),gt.setXYZ(dr+2,Bt.x,Bt.y,Bt.z);this.normalizeNormals(),gt.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let st=this.attributes.normal;for(let mt=0,gt=st.count;mt<gt;mt++)Ri.fromBufferAttribute(st,mt),Ri.normalize(),st.setXYZ(mt,Ri.x,Ri.y,Ri.z)}toNonIndexed(){function st(Rt,Ft){let Nt=Rt.array,Bt=Rt.itemSize,Gt=Rt.normalized,dr=new Nt.constructor(Ft.length*Bt),Mr=0,Tr=0;for(let zr=0,Fr=Ft.length;zr<Fr;zr++){Rt.isInterleavedBufferAttribute?Mr=Ft[zr]*Rt.data.stride+Rt.offset:Mr=Ft[zr]*Bt;for(let Nr=0;Nr<Bt;Nr++)dr[Tr++]=Nt[Mr++]}return new Xe$1(dr,Bt,Gt)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let mt=new _e$1,gt=this.index.array,_t=this.attributes;for(let Rt in _t){let Ft=_t[Rt],Nt=st(Ft,gt);mt.setAttribute(Rt,Nt)}let Et=this.morphAttributes;for(let Rt in Et){let Ft=[],Nt=Et[Rt];for(let Bt=0,Gt=Nt.length;Bt<Gt;Bt++){let dr=Nt[Bt],Mr=st(dr,gt);Ft.push(Mr)}mt.morphAttributes[Rt]=Ft}mt.morphTargetsRelative=this.morphTargetsRelative;let At=this.groups;for(let Rt=0,Ft=At.length;Rt<Ft;Rt++){let Nt=At[Rt];mt.addGroup(Nt.start,Nt.count,Nt.materialIndex)}return mt}toJSON(){let st={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(st.uuid=this.uuid,st.type=this.type,this.name!==""&&(st.name=this.name),Object.keys(this.userData).length>0&&(st.userData=this.userData),this.parameters!==void 0){let Ft=this.parameters;for(let Nt in Ft)Ft[Nt]!==void 0&&(st[Nt]=Ft[Nt]);return st}st.data={attributes:{}};let mt=this.index;mt!==null&&(st.data.index={type:mt.array.constructor.name,array:Array.prototype.slice.call(mt.array)});let gt=this.attributes;for(let Ft in gt){let Nt=gt[Ft];st.data.attributes[Ft]=Nt.toJSON(st.data)}let _t={},Et=!1;for(let Ft in this.morphAttributes){let Nt=this.morphAttributes[Ft],Bt=[];for(let Gt=0,dr=Nt.length;Gt<dr;Gt++){let Mr=Nt[Gt];Bt.push(Mr.toJSON(st.data))}Bt.length>0&&(_t[Ft]=Bt,Et=!0)}Et&&(st.data.morphAttributes=_t,st.data.morphTargetsRelative=this.morphTargetsRelative);let At=this.groups;At.length>0&&(st.data.groups=JSON.parse(JSON.stringify(At)));let Rt=this.boundingSphere;return Rt!==null&&(st.data.boundingSphere={center:Rt.center.toArray(),radius:Rt.radius}),st}clone(){return new this.constructor().copy(this)}copy(st){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let mt={};this.name=st.name;let gt=st.index;gt!==null&&this.setIndex(gt.clone(mt));let _t=st.attributes;for(let Nt in _t){let Bt=_t[Nt];this.setAttribute(Nt,Bt.clone(mt))}let Et=st.morphAttributes;for(let Nt in Et){let Bt=[],Gt=Et[Nt];for(let dr=0,Mr=Gt.length;dr<Mr;dr++)Bt.push(Gt[dr].clone(mt));this.morphAttributes[Nt]=Bt}this.morphTargetsRelative=st.morphTargetsRelative;let At=st.groups;for(let Nt=0,Bt=At.length;Nt<Bt;Nt++){let Gt=At[Nt];this.addGroup(Gt.start,Gt.count,Gt.materialIndex)}let Rt=st.boundingBox;Rt!==null&&(this.boundingBox=Rt.clone());let Ft=st.boundingSphere;return Ft!==null&&(this.boundingSphere=Ft.clone()),this.drawRange.start=st.drawRange.start,this.drawRange.count=st.drawRange.count,this.userData=st.userData,st.parameters!==void 0&&(this.parameters=Object.assign({},st.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},KT=new ue$1,Su=new Rs,CS=new Or,Yf=new E$6,Xf=new E$6,Qf=new E$6,PS=new E$6,_g=new E$6,Dg=new U$1,Ig=new U$1,Og=new U$1,_S=new E$6,Rg=new E$6,Ut=class extends Mt{constructor(nt=new _e$1,st=new on){super(),this.isMesh=!0,this.type="Mesh",this.geometry=nt,this.material=st,this.updateMorphTargets()}copy(nt,st){return super.copy(nt,st),nt.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=nt.morphTargetInfluences.slice()),nt.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},nt.morphTargetDictionary)),this.material=nt.material,this.geometry=nt.geometry,this}updateMorphTargets(){let nt=this.geometry.morphAttributes,st=Object.keys(nt);if(st.length>0){let mt=nt[st[0]];if(mt!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let gt=0,_t=mt.length;gt<_t;gt++){let Et=mt[gt].name||String(gt);this.morphTargetInfluences.push(0),this.morphTargetDictionary[Et]=gt}}}}getVertexPosition(nt,st){let mt=this.geometry,gt=mt.attributes.position,_t=mt.morphAttributes.position,Et=mt.morphTargetsRelative;st.fromBufferAttribute(gt,nt);let At=this.morphTargetInfluences;if(_t&&At){_g.set(0,0,0);for(let Rt=0,Ft=_t.length;Rt<Ft;Rt++){let Nt=At[Rt],Bt=_t[Rt];Nt!==0&&(PS.fromBufferAttribute(Bt,nt),Et?_g.addScaledVector(PS,Nt):_g.addScaledVector(PS.sub(st),Nt))}st.add(_g)}return this.isSkinnedMesh&&this.boneTransform(nt,st),st}raycast(nt,st){let mt=this.geometry,gt=this.material,_t=this.matrixWorld;if(gt===void 0||(mt.boundingSphere===null&&mt.computeBoundingSphere(),CS.copy(mt.boundingSphere),CS.applyMatrix4(_t),nt.ray.intersectsSphere(CS)===!1)||(KT.copy(_t).invert(),Su.copy(nt.ray).applyMatrix4(KT),mt.boundingBox!==null&&Su.intersectsBox(mt.boundingBox)===!1))return;let Et,At=mt.index,Rt=mt.attributes.position,Ft=mt.attributes.uv,Nt=mt.attributes.uv2,Bt=mt.groups,Gt=mt.drawRange;if(At!==null)if(Array.isArray(gt))for(let dr=0,Mr=Bt.length;dr<Mr;dr++){let Tr=Bt[dr],zr=gt[Tr.materialIndex],Fr=Math.max(Tr.start,Gt.start),Nr=Math.min(At.count,Math.min(Tr.start+Tr.count,Gt.start+Gt.count));for(let tn=Fr,rn=Nr;tn<rn;tn+=3){let Tn=At.getX(tn),$n=At.getX(tn+1),un=At.getX(tn+2);Et=Lg(this,zr,nt,Su,Ft,Nt,Tn,$n,un),Et&&(Et.faceIndex=Math.floor(tn/3),Et.face.materialIndex=Tr.materialIndex,st.push(Et))}}else{let dr=Math.max(0,Gt.start),Mr=Math.min(At.count,Gt.start+Gt.count);for(let Tr=dr,zr=Mr;Tr<zr;Tr+=3){let Fr=At.getX(Tr),Nr=At.getX(Tr+1),tn=At.getX(Tr+2);Et=Lg(this,gt,nt,Su,Ft,Nt,Fr,Nr,tn),Et&&(Et.faceIndex=Math.floor(Tr/3),st.push(Et))}}else if(Rt!==void 0)if(Array.isArray(gt))for(let dr=0,Mr=Bt.length;dr<Mr;dr++){let Tr=Bt[dr],zr=gt[Tr.materialIndex],Fr=Math.max(Tr.start,Gt.start),Nr=Math.min(Rt.count,Math.min(Tr.start+Tr.count,Gt.start+Gt.count));for(let tn=Fr,rn=Nr;tn<rn;tn+=3){let Tn=tn,$n=tn+1,un=tn+2;Et=Lg(this,zr,nt,Su,Ft,Nt,Tn,$n,un),Et&&(Et.faceIndex=Math.floor(tn/3),Et.face.materialIndex=Tr.materialIndex,st.push(Et))}}else{let dr=Math.max(0,Gt.start),Mr=Math.min(Rt.count,Gt.start+Gt.count);for(let Tr=dr,zr=Mr;Tr<zr;Tr+=3){let Fr=Tr,Nr=Tr+1,tn=Tr+2;Et=Lg(this,gt,nt,Su,Ft,Nt,Fr,Nr,tn),Et&&(Et.faceIndex=Math.floor(Tr/3),st.push(Et))}}}};function TV(nt,st,mt,gt,_t,Et,At,Rt){let Ft;if(st.side===pi?Ft=gt.intersectTriangle(At,Et,_t,!0,Rt):Ft=gt.intersectTriangle(_t,Et,At,st.side===Hn,Rt),Ft===null)return null;Rg.copy(Rt),Rg.applyMatrix4(nt.matrixWorld);let Nt=mt.ray.origin.distanceTo(Rg);return Nt<mt.near||Nt>mt.far?null:{distance:Nt,point:Rg.clone(),object:nt}}function Lg(nt,st,mt,gt,_t,Et,At,Rt,Ft){nt.getVertexPosition(At,Yf),nt.getVertexPosition(Rt,Xf),nt.getVertexPosition(Ft,Qf);let Nt=TV(nt,st,mt,gt,Yf,Xf,Qf,_S);if(Nt){_t&&(Dg.fromBufferAttribute(_t,At),Ig.fromBufferAttribute(_t,Rt),Og.fromBufferAttribute(_t,Ft),Nt.uv=Cr.getUV(_S,Yf,Xf,Qf,Dg,Ig,Og,new U$1)),Et&&(Dg.fromBufferAttribute(Et,At),Ig.fromBufferAttribute(Et,Rt),Og.fromBufferAttribute(Et,Ft),Nt.uv2=Cr.getUV(_S,Yf,Xf,Qf,Dg,Ig,Og,new U$1));let Bt={a:At,b:Rt,c:Ft,normal:new E$6,materialIndex:0};Cr.getNormal(Yf,Xf,Qf,Bt.normal),Nt.face=Bt}return Nt}var mi=class extends _e$1{constructor(nt=1,st=1,mt=1,gt=1,_t=1,Et=1){super(),this.type="BoxGeometry",this.parameters={width:nt,height:st,depth:mt,widthSegments:gt,heightSegments:_t,depthSegments:Et};let At=this;gt=Math.floor(gt),_t=Math.floor(_t),Et=Math.floor(Et);let Rt=[],Ft=[],Nt=[],Bt=[],Gt=0,dr=0;Mr("z","y","x",-1,-1,mt,st,nt,Et,_t,0),Mr("z","y","x",1,-1,mt,st,-nt,Et,_t,1),Mr("x","z","y",1,1,nt,mt,st,gt,Et,2),Mr("x","z","y",1,-1,nt,mt,-st,gt,Et,3),Mr("x","y","z",1,-1,nt,st,mt,gt,_t,4),Mr("x","y","z",-1,-1,nt,st,-mt,gt,_t,5),this.setIndex(Rt),this.setAttribute("position",new Me$1(Ft,3)),this.setAttribute("normal",new Me$1(Nt,3)),this.setAttribute("uv",new Me$1(Bt,2));function Mr(Tr,zr,Fr,Nr,tn,rn,Tn,$n,un,es,kn){let ts=rn/un,Ko=Tn/es,ds=rn/2,Il=Tn/2,ru=$n/2,uu=un+1,p0=es+1,X1=0,q0=0,W0=new E$6;for(let hu=0;hu<p0;hu++){let a1=hu*Ko-Il;for(let Vx=0;Vx<uu;Vx++){let t0=Vx*ts-ds;W0[Tr]=t0*Nr,W0[zr]=a1*tn,W0[Fr]=ru,Ft.push(W0.x,W0.y,W0.z),W0[Tr]=0,W0[zr]=0,W0[Fr]=$n>0?1:-1,Nt.push(W0.x,W0.y,W0.z),Bt.push(Vx/un),Bt.push(1-hu/es),X1+=1}}for(let hu=0;hu<es;hu++)for(let a1=0;a1<un;a1++){let Vx=Gt+a1+uu*hu,t0=Gt+a1+uu*(hu+1),cu=Gt+(a1+1)+uu*(hu+1),lu=Gt+(a1+1)+uu*hu;Rt.push(Vx,t0,lu),Rt.push(t0,cu,lu),q0+=6}At.addGroup(dr,q0,kn),dr+=q0,Gt+=X1}}static fromJSON(nt){return new mi(nt.width,nt.height,nt.depth,nt.widthSegments,nt.heightSegments,nt.depthSegments)}};function Ou(nt){let st={};for(let mt in nt){st[mt]={};for(let gt in nt[mt]){let _t=nt[mt][gt];_t&&(_t.isColor||_t.isMatrix3||_t.isMatrix4||_t.isVector2||_t.isVector3||_t.isVector4||_t.isTexture||_t.isQuaternion)?st[mt][gt]=_t.clone():Array.isArray(_t)?st[mt][gt]=_t.slice():st[mt][gt]=_t}}return st}function pn(nt){let st={};for(let mt=0;mt<nt.length;mt++){let gt=Ou(nt[mt]);for(let _t in gt)st[_t]=gt[_t]}return st}function CV(nt){let st=[];for(let mt=0;mt<nt.length;mt++)st.push(nt[mt].clone());return st}function KC(nt){return nt.getRenderTarget()===null&&nt.outputEncoding===at$1?co:sp}var Bs={clone:Ou,merge:pn},PV=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,_V=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,it$1=class extends fc{constructor(st){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=PV,this.fragmentShader=_V,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,st!==void 0&&this.setValues(st)}copy(st){return super.copy(st),this.fragmentShader=st.fragmentShader,this.vertexShader=st.vertexShader,this.uniforms=Ou(st.uniforms),this.uniformsGroups=CV(st.uniformsGroups),this.defines=Object.assign({},st.defines),this.wireframe=st.wireframe,this.wireframeLinewidth=st.wireframeLinewidth,this.fog=st.fog,this.lights=st.lights,this.clipping=st.clipping,this.extensions=Object.assign({},st.extensions),this.glslVersion=st.glslVersion,this}toJSON(st){let mt=super.toJSON(st);mt.glslVersion=this.glslVersion,mt.uniforms={};for(let _t in this.uniforms){let Et=this.uniforms[_t].value;Et&&Et.isTexture?mt.uniforms[_t]={type:"t",value:Et.toJSON(st).uuid}:Et&&Et.isColor?mt.uniforms[_t]={type:"c",value:Et.getHex()}:Et&&Et.isVector2?mt.uniforms[_t]={type:"v2",value:Et.toArray()}:Et&&Et.isVector3?mt.uniforms[_t]={type:"v3",value:Et.toArray()}:Et&&Et.isVector4?mt.uniforms[_t]={type:"v4",value:Et.toArray()}:Et&&Et.isMatrix3?mt.uniforms[_t]={type:"m3",value:Et.toArray()}:Et&&Et.isMatrix4?mt.uniforms[_t]={type:"m4",value:Et.toArray()}:mt.uniforms[_t]={value:Et}}Object.keys(this.defines).length>0&&(mt.defines=this.defines),mt.vertexShader=this.vertexShader,mt.fragmentShader=this.fragmentShader;let gt={};for(let _t in this.extensions)this.extensions[_t]===!0&&(gt[_t]=!0);return Object.keys(gt).length>0&&(mt.extensions=gt),mt}},qn=class extends Mt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ue$1,this.projectionMatrix=new ue$1,this.projectionMatrixInverse=new ue$1}copy(nt,st){return super.copy(nt,st),this.matrixWorldInverse.copy(nt.matrixWorldInverse),this.projectionMatrix.copy(nt.projectionMatrix),this.projectionMatrixInverse.copy(nt.projectionMatrixInverse),this}getWorldDirection(nt){this.updateWorldMatrix(!0,!1);let st=this.matrixWorld.elements;return nt.set(-st[8],-st[9],-st[10]).normalize()}updateMatrixWorld(nt){super.updateMatrixWorld(nt),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(nt,st){super.updateWorldMatrix(nt,st),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},$r=class extends qn{constructor(nt=50,st=1,mt=.1,gt=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=nt,this.zoom=1,this.near=mt,this.far=gt,this.focus=10,this.aspect=st,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(nt,st){return super.copy(nt,st),this.fov=nt.fov,this.zoom=nt.zoom,this.near=nt.near,this.far=nt.far,this.focus=nt.focus,this.aspect=nt.aspect,this.view=nt.view===null?null:Object.assign({},nt.view),this.filmGauge=nt.filmGauge,this.filmOffset=nt.filmOffset,this}setFocalLength(nt){let st=.5*this.getFilmHeight()/nt;this.fov=op*2*Math.atan(st),this.updateProjectionMatrix()}getFocalLength(){let nt=Math.tan(ep*.5*this.fov);return .5*this.getFilmHeight()/nt}getEffectiveFOV(){return op*2*Math.atan(Math.tan(ep*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(nt,st,mt,gt,_t,Et){this.aspect=nt/st,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=nt,this.view.fullHeight=st,this.view.offsetX=mt,this.view.offsetY=gt,this.view.width=_t,this.view.height=Et,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let nt=this.near,st=nt*Math.tan(ep*.5*this.fov)/this.zoom,mt=2*st,gt=this.aspect*mt,_t=-.5*gt,Et=this.view;if(this.view!==null&&this.view.enabled){let Rt=Et.fullWidth,Ft=Et.fullHeight;_t+=Et.offsetX*gt/Rt,st-=Et.offsetY*mt/Ft,gt*=Et.width/Rt,mt*=Et.height/Ft}let At=this.filmOffset;At!==0&&(_t+=nt*At/this.getFilmWidth()),this.projectionMatrix.makePerspective(_t,_t+gt,st,st-mt,nt,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(nt){let st=super.toJSON(nt);return st.object.fov=this.fov,st.object.zoom=this.zoom,st.object.near=this.near,st.object.far=this.far,st.object.focus=this.focus,st.object.aspect=this.aspect,this.view!==null&&(st.object.view=Object.assign({},this.view)),st.object.filmGauge=this.filmGauge,st.object.filmOffset=this.filmOffset,st}},wu=-90,Au=1,YS=class extends Mt{constructor(nt,st,mt){super(),this.type="CubeCamera",this.renderTarget=mt;let gt=new $r(wu,Au,nt,st);gt.layers=this.layers,gt.up.set(0,1,0),gt.lookAt(1,0,0),this.add(gt);let _t=new $r(wu,Au,nt,st);_t.layers=this.layers,_t.up.set(0,1,0),_t.lookAt(-1,0,0),this.add(_t);let Et=new $r(wu,Au,nt,st);Et.layers=this.layers,Et.up.set(0,0,-1),Et.lookAt(0,1,0),this.add(Et);let At=new $r(wu,Au,nt,st);At.layers=this.layers,At.up.set(0,0,1),At.lookAt(0,-1,0),this.add(At);let Rt=new $r(wu,Au,nt,st);Rt.layers=this.layers,Rt.up.set(0,1,0),Rt.lookAt(0,0,1),this.add(Rt);let Ft=new $r(wu,Au,nt,st);Ft.layers=this.layers,Ft.up.set(0,1,0),Ft.lookAt(0,0,-1),this.add(Ft)}update(nt,st){this.parent===null&&this.updateMatrixWorld();let mt=this.renderTarget,[gt,_t,Et,At,Rt,Ft]=this.children,Nt=nt.getRenderTarget(),Bt=nt.toneMapping,Gt=nt.xr.enabled;nt.toneMapping=Is,nt.xr.enabled=!1;let dr=mt.texture.generateMipmaps;mt.texture.generateMipmaps=!1,nt.setRenderTarget(mt,0),nt.render(st,gt),nt.setRenderTarget(mt,1),nt.render(st,_t),nt.setRenderTarget(mt,2),nt.render(st,Et),nt.setRenderTarget(mt,3),nt.render(st,At),nt.setRenderTarget(mt,4),nt.render(st,Rt),mt.texture.generateMipmaps=dr,nt.setRenderTarget(mt,5),nt.render(st,Ft),nt.setRenderTarget(Nt),nt.toneMapping=Bt,nt.xr.enabled=Gt,mt.texture.needsPMREMUpdate=!0}},Ru=class extends $t{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt){nt=nt!==void 0?nt:[],st=st!==void 0?st:Qa,super(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(nt){this.image=nt}},XS=class extends dt$1{constructor(nt=1,st={}){super(nt,nt,st),this.isWebGLCubeRenderTarget=!0;let mt={width:nt,height:nt,depth:1},gt=[mt,mt,mt,mt,mt,mt];this.texture=new Ru(gt,st.mapping,st.wrapS,st.wrapT,st.magFilter,st.minFilter,st.format,st.type,st.anisotropy,st.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=st.generateMipmaps!==void 0?st.generateMipmaps:!1,this.texture.minFilter=st.minFilter!==void 0?st.minFilter:rt$1}fromEquirectangularTexture(nt,st){this.texture.type=st.type,this.texture.encoding=st.encoding,this.texture.generateMipmaps=st.generateMipmaps,this.texture.minFilter=st.minFilter,this.texture.magFilter=st.magFilter;let mt={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},gt=new mi(5,5,5),_t=new it$1({name:"CubemapFromEquirect",uniforms:Ou(mt.uniforms),vertexShader:mt.vertexShader,fragmentShader:mt.fragmentShader,side:pi,blending:Jt});_t.uniforms.tEquirect.value=st;let Et=new Ut(gt,_t),At=st.minFilter;return st.minFilter===dc&&(st.minFilter=rt$1),new YS(1,10,this).update(nt,Et),st.minFilter=At,Et.geometry.dispose(),Et.material.dispose(),this}clear(nt,st,mt,gt){let _t=nt.getRenderTarget();for(let Et=0;Et<6;Et++)nt.setRenderTarget(this,Et),nt.clear(st,mt,gt);nt.setRenderTarget(_t)}},DS=new E$6,DV=new E$6,IV=new fr,Vr=class{constructor(nt=new E$6(1,0,0),st=0){this.isPlane=!0,this.normal=nt,this.constant=st}set(nt,st){return this.normal.copy(nt),this.constant=st,this}setComponents(nt,st,mt,gt){return this.normal.set(nt,st,mt),this.constant=gt,this}setFromNormalAndCoplanarPoint(nt,st){return this.normal.copy(nt),this.constant=-st.dot(this.normal),this}setFromCoplanarPoints(nt,st,mt){let gt=DS.subVectors(mt,st).cross(DV.subVectors(nt,st)).normalize();return this.setFromNormalAndCoplanarPoint(gt,nt),this}copy(nt){return this.normal.copy(nt.normal),this.constant=nt.constant,this}normalize(){let nt=1/this.normal.length();return this.normal.multiplyScalar(nt),this.constant*=nt,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(nt){return this.normal.dot(nt)+this.constant}distanceToSphere(nt){return this.distanceToPoint(nt.center)-nt.radius}projectPoint(nt,st){return st.copy(this.normal).multiplyScalar(-this.distanceToPoint(nt)).add(nt)}intersectLine(nt,st){let mt=nt.delta(DS),gt=this.normal.dot(mt);if(gt===0)return this.distanceToPoint(nt.start)===0?st.copy(nt.start):null;let _t=-(nt.start.dot(this.normal)+this.constant)/gt;return _t<0||_t>1?null:st.copy(mt).multiplyScalar(_t).add(nt.start)}intersectsLine(nt){let st=this.distanceToPoint(nt.start),mt=this.distanceToPoint(nt.end);return st<0&&mt>0||mt<0&&st>0}intersectsBox(nt){return nt.intersectsPlane(this)}intersectsSphere(nt){return nt.intersectsPlane(this)}coplanarPoint(nt){return nt.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(nt,st){let mt=st||IV.getNormalMatrix(nt),gt=this.coplanarPoint(DS).applyMatrix4(nt),_t=this.normal.applyMatrix3(mt).normalize();return this.constant=-gt.dot(_t),this}translate(nt){return this.constant-=nt.dot(this.normal),this}equals(nt){return nt.normal.equals(this.normal)&&nt.constant===this.constant}clone(){return new this.constructor().copy(this)}},Eu=new Or,Bg=new E$6,cp=class{constructor(nt=new Vr,st=new Vr,mt=new Vr,gt=new Vr,_t=new Vr,Et=new Vr){this.planes=[nt,st,mt,gt,_t,Et]}set(nt,st,mt,gt,_t,Et){let At=this.planes;return At[0].copy(nt),At[1].copy(st),At[2].copy(mt),At[3].copy(gt),At[4].copy(_t),At[5].copy(Et),this}copy(nt){let st=this.planes;for(let mt=0;mt<6;mt++)st[mt].copy(nt.planes[mt]);return this}setFromProjectionMatrix(nt){let st=this.planes,mt=nt.elements,gt=mt[0],_t=mt[1],Et=mt[2],At=mt[3],Rt=mt[4],Ft=mt[5],Nt=mt[6],Bt=mt[7],Gt=mt[8],dr=mt[9],Mr=mt[10],Tr=mt[11],zr=mt[12],Fr=mt[13],Nr=mt[14],tn=mt[15];return st[0].setComponents(At-gt,Bt-Rt,Tr-Gt,tn-zr).normalize(),st[1].setComponents(At+gt,Bt+Rt,Tr+Gt,tn+zr).normalize(),st[2].setComponents(At+_t,Bt+Ft,Tr+dr,tn+Fr).normalize(),st[3].setComponents(At-_t,Bt-Ft,Tr-dr,tn-Fr).normalize(),st[4].setComponents(At-Et,Bt-Nt,Tr-Mr,tn-Nr).normalize(),st[5].setComponents(At+Et,Bt+Nt,Tr+Mr,tn+Nr).normalize(),this}intersectsObject(nt){let st=nt.geometry;return st.boundingSphere===null&&st.computeBoundingSphere(),Eu.copy(st.boundingSphere).applyMatrix4(nt.matrixWorld),this.intersectsSphere(Eu)}intersectsSprite(nt){return Eu.center.set(0,0,0),Eu.radius=.7071067811865476,Eu.applyMatrix4(nt.matrixWorld),this.intersectsSphere(Eu)}intersectsSphere(nt){let st=this.planes,mt=nt.center,gt=-nt.radius;for(let _t=0;_t<6;_t++)if(st[_t].distanceToPoint(mt)<gt)return!1;return!0}intersectsBox(nt){let st=this.planes;for(let mt=0;mt<6;mt++){let gt=st[mt];if(Bg.x=gt.normal.x>0?nt.max.x:nt.min.x,Bg.y=gt.normal.y>0?nt.max.y:nt.min.y,Bg.z=gt.normal.z>0?nt.max.z:nt.min.z,gt.distanceToPoint(Bg)<0)return!1}return!0}containsPoint(nt){let st=this.planes;for(let mt=0;mt<6;mt++)if(st[mt].distanceToPoint(nt)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function ZC(){let nt=null,st=!1,mt=null,gt=null;function _t(Et,At){mt(Et,At),gt=nt.requestAnimationFrame(_t)}return{start:function(){st!==!0&&mt!==null&&(gt=nt.requestAnimationFrame(_t),st=!0)},stop:function(){nt.cancelAnimationFrame(gt),st=!1},setAnimationLoop:function(Et){mt=Et},setContext:function(Et){nt=Et}}}function OV(nt,st){let mt=st.isWebGL2,gt=new WeakMap;function _t(Nt,Bt){let Gt=Nt.array,dr=Nt.usage,Mr=nt.createBuffer();nt.bindBuffer(Bt,Mr),nt.bufferData(Bt,Gt,dr),Nt.onUploadCallback();let Tr;if(Gt instanceof Float32Array)Tr=5126;else if(Gt instanceof Uint16Array)if(Nt.isFloat16BufferAttribute)if(mt)Tr=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else Tr=5123;else if(Gt instanceof Int16Array)Tr=5122;else if(Gt instanceof Uint32Array)Tr=5125;else if(Gt instanceof Int32Array)Tr=5124;else if(Gt instanceof Int8Array)Tr=5120;else if(Gt instanceof Uint8Array)Tr=5121;else if(Gt instanceof Uint8ClampedArray)Tr=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+Gt);return{buffer:Mr,type:Tr,bytesPerElement:Gt.BYTES_PER_ELEMENT,version:Nt.version}}function Et(Nt,Bt,Gt){let dr=Bt.array,Mr=Bt.updateRange;nt.bindBuffer(Gt,Nt),Mr.count===-1?nt.bufferSubData(Gt,0,dr):(mt?nt.bufferSubData(Gt,Mr.offset*dr.BYTES_PER_ELEMENT,dr,Mr.offset,Mr.count):nt.bufferSubData(Gt,Mr.offset*dr.BYTES_PER_ELEMENT,dr.subarray(Mr.offset,Mr.offset+Mr.count)),Mr.count=-1),Bt.onUploadCallback()}function At(Nt){return Nt.isInterleavedBufferAttribute&&(Nt=Nt.data),gt.get(Nt)}function Rt(Nt){Nt.isInterleavedBufferAttribute&&(Nt=Nt.data);let Bt=gt.get(Nt);Bt&&(nt.deleteBuffer(Bt.buffer),gt.delete(Nt))}function Ft(Nt,Bt){if(Nt.isGLBufferAttribute){let dr=gt.get(Nt);(!dr||dr.version<Nt.version)&&gt.set(Nt,{buffer:Nt.buffer,type:Nt.type,bytesPerElement:Nt.elementSize,version:Nt.version});return}Nt.isInterleavedBufferAttribute&&(Nt=Nt.data);let Gt=gt.get(Nt);Gt===void 0?gt.set(Nt,_t(Nt,Bt)):Gt.version<Nt.version&&(Et(Gt.buffer,Nt,Bt),Gt.version=Nt.version)}return{get:At,remove:Rt,update:Ft}}var Li=class extends _e$1{constructor(nt=1,st=1,mt=1,gt=1){super(),this.type="PlaneGeometry",this.parameters={width:nt,height:st,widthSegments:mt,heightSegments:gt};let _t=nt/2,Et=st/2,At=Math.floor(mt),Rt=Math.floor(gt),Ft=At+1,Nt=Rt+1,Bt=nt/At,Gt=st/Rt,dr=[],Mr=[],Tr=[],zr=[];for(let Fr=0;Fr<Nt;Fr++){let Nr=Fr*Gt-Et;for(let tn=0;tn<Ft;tn++){let rn=tn*Bt-_t;Mr.push(rn,-Nr,0),Tr.push(0,0,1),zr.push(tn/At),zr.push(1-Fr/Rt)}}for(let Fr=0;Fr<Rt;Fr++)for(let Nr=0;Nr<At;Nr++){let tn=Nr+Ft*Fr,rn=Nr+Ft*(Fr+1),Tn=Nr+1+Ft*(Fr+1),$n=Nr+1+Ft*Fr;dr.push(tn,rn,$n),dr.push(rn,Tn,$n)}this.setIndex(dr),this.setAttribute("position",new Me$1(Mr,3)),this.setAttribute("normal",new Me$1(Tr,3)),this.setAttribute("uv",new Me$1(zr,2))}static fromJSON(nt){return new Li(nt.width,nt.height,nt.widthSegments,nt.heightSegments)}},RV=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,LV=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,BV=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,NV=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,FV=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,VV=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,UV="vec3 transformed = vec3( position );",zV=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,kV=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,GV=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,jV=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,HV=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,WV=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,qV=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,YV=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,XV=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,QV=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,KV=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,ZV=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,JV=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,$V=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,eU=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,tU=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,rU=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,iU=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,nU=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,sU="gl_FragColor = linearToOutputTexel( gl_FragColor );",oU=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,aU=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,lU=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,cU=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,uU=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,hU=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,dU=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fU=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,pU=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,mU=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gU=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,yU=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,vU=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,xU=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,bU=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,SU=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,wU=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,AU=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,EU=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,MU=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,TU=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,CU=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,PU=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,_U=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,DU=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,IU=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,OU=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,RU=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,LU=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,BU=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,NU=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,FU=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,VU=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,UU=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,zU=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,kU=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,GU=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,jU=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,HU=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,WU=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,qU=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,YU=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,XU=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,QU=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,KU=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,ZU=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,JU=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,$U=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,ez=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,tz=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,rz=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,iz=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,nz=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,sz=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,oz=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,az=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,lz=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,cz=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,uz=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,hz=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,dz=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,fz=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,pz=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,mz=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,gz=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,yz=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,vz=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,xz=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,bz=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Sz=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,wz=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,Az=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,Ez=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,Mz=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,Tz=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Cz=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Pz=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,_z=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Dz=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Iz=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Oz=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Rz=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Lz=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Bz=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Nz=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Fz=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Vz=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Uz=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,zz=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,kz=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Gz=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,jz=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Hz=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Wz=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,qz=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Yz=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Xz=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Qz=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Kz=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Zz=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Jz=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,$z=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ek=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,tk=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,rk=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ik=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,nk=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sk=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,ok=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ak=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lk=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ck=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,uk=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,xt={alphamap_fragment:RV,alphamap_pars_fragment:LV,alphatest_fragment:BV,alphatest_pars_fragment:NV,aomap_fragment:FV,aomap_pars_fragment:VV,begin_vertex:UV,beginnormal_vertex:zV,bsdfs:kV,iridescence_fragment:GV,bumpmap_pars_fragment:jV,clipping_planes_fragment:HV,clipping_planes_pars_fragment:WV,clipping_planes_pars_vertex:qV,clipping_planes_vertex:YV,color_fragment:XV,color_pars_fragment:QV,color_pars_vertex:KV,color_vertex:ZV,common:JV,cube_uv_reflection_fragment:$V,defaultnormal_vertex:eU,displacementmap_pars_vertex:tU,displacementmap_vertex:rU,emissivemap_fragment:iU,emissivemap_pars_fragment:nU,encodings_fragment:sU,encodings_pars_fragment:oU,envmap_fragment:aU,envmap_common_pars_fragment:lU,envmap_pars_fragment:cU,envmap_pars_vertex:uU,envmap_physical_pars_fragment:wU,envmap_vertex:hU,fog_vertex:dU,fog_pars_vertex:fU,fog_fragment:pU,fog_pars_fragment:mU,gradientmap_pars_fragment:gU,lightmap_fragment:yU,lightmap_pars_fragment:vU,lights_lambert_fragment:xU,lights_lambert_pars_fragment:bU,lights_pars_begin:SU,lights_toon_fragment:AU,lights_toon_pars_fragment:EU,lights_phong_fragment:MU,lights_phong_pars_fragment:TU,lights_physical_fragment:CU,lights_physical_pars_fragment:PU,lights_fragment_begin:_U,lights_fragment_maps:DU,lights_fragment_end:IU,logdepthbuf_fragment:OU,logdepthbuf_pars_fragment:RU,logdepthbuf_pars_vertex:LU,logdepthbuf_vertex:BU,map_fragment:NU,map_pars_fragment:FU,map_particle_fragment:VU,map_particle_pars_fragment:UU,metalnessmap_fragment:zU,metalnessmap_pars_fragment:kU,morphcolor_vertex:GU,morphnormal_vertex:jU,morphtarget_pars_vertex:HU,morphtarget_vertex:WU,normal_fragment_begin:qU,normal_fragment_maps:YU,normal_pars_fragment:XU,normal_pars_vertex:QU,normal_vertex:KU,normalmap_pars_fragment:ZU,clearcoat_normal_fragment_begin:JU,clearcoat_normal_fragment_maps:$U,clearcoat_pars_fragment:ez,iridescence_pars_fragment:tz,output_fragment:rz,packing:iz,premultiplied_alpha_fragment:nz,project_vertex:sz,dithering_fragment:oz,dithering_pars_fragment:az,roughnessmap_fragment:lz,roughnessmap_pars_fragment:cz,shadowmap_pars_fragment:uz,shadowmap_pars_vertex:hz,shadowmap_vertex:dz,shadowmask_pars_fragment:fz,skinbase_vertex:pz,skinning_pars_vertex:mz,skinning_vertex:gz,skinnormal_vertex:yz,specularmap_fragment:vz,specularmap_pars_fragment:xz,tonemapping_fragment:bz,tonemapping_pars_fragment:Sz,transmission_fragment:wz,transmission_pars_fragment:Az,uv_pars_fragment:Ez,uv_pars_vertex:Mz,uv_vertex:Tz,uv2_pars_fragment:Cz,uv2_pars_vertex:Pz,uv2_vertex:_z,worldpos_vertex:Dz,background_vert:Iz,background_frag:Oz,backgroundCube_vert:Rz,backgroundCube_frag:Lz,cube_vert:Bz,cube_frag:Nz,depth_vert:Fz,depth_frag:Vz,distanceRGBA_vert:Uz,distanceRGBA_frag:zz,equirect_vert:kz,equirect_frag:Gz,linedashed_vert:jz,linedashed_frag:Hz,meshbasic_vert:Wz,meshbasic_frag:qz,meshlambert_vert:Yz,meshlambert_frag:Xz,meshmatcap_vert:Qz,meshmatcap_frag:Kz,meshnormal_vert:Zz,meshnormal_frag:Jz,meshphong_vert:$z,meshphong_frag:ek,meshphysical_vert:tk,meshphysical_frag:rk,meshtoon_vert:ik,meshtoon_frag:nk,points_vert:sk,points_frag:ok,shadow_vert:ak,shadow_frag:lk,sprite_vert:ck,sprite_frag:uk},De$1={common:{diffuse:{value:new We$1(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new fr},uv2Transform:{value:new fr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new U$1(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new We$1(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new We$1(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new fr}},sprite:{diffuse:{value:new We$1(16777215)},opacity:{value:1},center:{value:new U$1(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new fr}}},uo={basic:{uniforms:pn([De$1.common,De$1.specularmap,De$1.envmap,De$1.aomap,De$1.lightmap,De$1.fog]),vertexShader:xt.meshbasic_vert,fragmentShader:xt.meshbasic_frag},lambert:{uniforms:pn([De$1.common,De$1.specularmap,De$1.envmap,De$1.aomap,De$1.lightmap,De$1.emissivemap,De$1.bumpmap,De$1.normalmap,De$1.displacementmap,De$1.fog,De$1.lights,{emissive:{value:new We$1(0)}}]),vertexShader:xt.meshlambert_vert,fragmentShader:xt.meshlambert_frag},phong:{uniforms:pn([De$1.common,De$1.specularmap,De$1.envmap,De$1.aomap,De$1.lightmap,De$1.emissivemap,De$1.bumpmap,De$1.normalmap,De$1.displacementmap,De$1.fog,De$1.lights,{emissive:{value:new We$1(0)},specular:{value:new We$1(1118481)},shininess:{value:30}}]),vertexShader:xt.meshphong_vert,fragmentShader:xt.meshphong_frag},standard:{uniforms:pn([De$1.common,De$1.envmap,De$1.aomap,De$1.lightmap,De$1.emissivemap,De$1.bumpmap,De$1.normalmap,De$1.displacementmap,De$1.roughnessmap,De$1.metalnessmap,De$1.fog,De$1.lights,{emissive:{value:new We$1(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:xt.meshphysical_vert,fragmentShader:xt.meshphysical_frag},toon:{uniforms:pn([De$1.common,De$1.aomap,De$1.lightmap,De$1.emissivemap,De$1.bumpmap,De$1.normalmap,De$1.displacementmap,De$1.gradientmap,De$1.fog,De$1.lights,{emissive:{value:new We$1(0)}}]),vertexShader:xt.meshtoon_vert,fragmentShader:xt.meshtoon_frag},matcap:{uniforms:pn([De$1.common,De$1.bumpmap,De$1.normalmap,De$1.displacementmap,De$1.fog,{matcap:{value:null}}]),vertexShader:xt.meshmatcap_vert,fragmentShader:xt.meshmatcap_frag},points:{uniforms:pn([De$1.points,De$1.fog]),vertexShader:xt.points_vert,fragmentShader:xt.points_frag},dashed:{uniforms:pn([De$1.common,De$1.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:xt.linedashed_vert,fragmentShader:xt.linedashed_frag},depth:{uniforms:pn([De$1.common,De$1.displacementmap]),vertexShader:xt.depth_vert,fragmentShader:xt.depth_frag},normal:{uniforms:pn([De$1.common,De$1.bumpmap,De$1.normalmap,De$1.displacementmap,{opacity:{value:1}}]),vertexShader:xt.meshnormal_vert,fragmentShader:xt.meshnormal_frag},sprite:{uniforms:pn([De$1.sprite,De$1.fog]),vertexShader:xt.sprite_vert,fragmentShader:xt.sprite_frag},background:{uniforms:{uvTransform:{value:new fr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:xt.background_vert,fragmentShader:xt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:xt.backgroundCube_vert,fragmentShader:xt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:xt.cube_vert,fragmentShader:xt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:xt.equirect_vert,fragmentShader:xt.equirect_frag},distanceRGBA:{uniforms:pn([De$1.common,De$1.displacementmap,{referencePosition:{value:new E$6},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:xt.distanceRGBA_vert,fragmentShader:xt.distanceRGBA_frag},shadow:{uniforms:pn([De$1.lights,De$1.fog,{color:{value:new We$1(0)},opacity:{value:1}}]),vertexShader:xt.shadow_vert,fragmentShader:xt.shadow_frag}};uo.physical={uniforms:pn([uo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new U$1(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new We$1(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new U$1},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new We$1(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new We$1(1,1,1)},specularColorMap:{value:null}}]),vertexShader:xt.meshphysical_vert,fragmentShader:xt.meshphysical_frag};var Ng={r:0,b:0,g:0};function hk(nt,st,mt,gt,_t,Et,At){let Rt=new We$1(0),Ft=Et===!0?0:1,Nt,Bt,Gt=null,dr=0,Mr=null;function Tr(Fr,Nr){let tn=!1,rn=Nr.isScene===!0?Nr.background:null;rn&&rn.isTexture&&(rn=(Nr.backgroundBlurriness>0?mt:st).get(rn));let Tn=nt.xr,$n=Tn.getSession&&Tn.getSession();$n&&$n.environmentBlendMode==="additive"&&(rn=null),rn===null?zr(Rt,Ft):rn&&rn.isColor&&(zr(rn,1),tn=!0),(nt.autoClear||tn)&&nt.clear(nt.autoClearColor,nt.autoClearDepth,nt.autoClearStencil),rn&&(rn.isCubeTexture||rn.mapping===Zu)?(Bt===void 0&&(Bt=new Ut(new mi(1,1,1),new it$1({name:"BackgroundCubeMaterial",uniforms:Ou(uo.backgroundCube.uniforms),vertexShader:uo.backgroundCube.vertexShader,fragmentShader:uo.backgroundCube.fragmentShader,side:pi,depthTest:!1,depthWrite:!1,fog:!1})),Bt.geometry.deleteAttribute("normal"),Bt.geometry.deleteAttribute("uv"),Bt.onBeforeRender=function(un,es,kn){this.matrixWorld.copyPosition(kn.matrixWorld)},Object.defineProperty(Bt.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),_t.update(Bt)),Bt.material.uniforms.envMap.value=rn,Bt.material.uniforms.flipEnvMap.value=rn.isCubeTexture&&rn.isRenderTargetTexture===!1?-1:1,Bt.material.uniforms.backgroundBlurriness.value=Nr.backgroundBlurriness,Bt.material.uniforms.backgroundIntensity.value=Nr.backgroundIntensity,Bt.material.toneMapped=rn.encoding!==at$1,(Gt!==rn||dr!==rn.version||Mr!==nt.toneMapping)&&(Bt.material.needsUpdate=!0,Gt=rn,dr=rn.version,Mr=nt.toneMapping),Bt.layers.enableAll(),Fr.unshift(Bt,Bt.geometry,Bt.material,0,0,null)):rn&&rn.isTexture&&(Nt===void 0&&(Nt=new Ut(new Li(2,2),new it$1({name:"BackgroundMaterial",uniforms:Ou(uo.background.uniforms),vertexShader:uo.background.vertexShader,fragmentShader:uo.background.fragmentShader,side:Hn,depthTest:!1,depthWrite:!1,fog:!1})),Nt.geometry.deleteAttribute("normal"),Object.defineProperty(Nt.material,"map",{get:function(){return this.uniforms.t2D.value}}),_t.update(Nt)),Nt.material.uniforms.t2D.value=rn,Nt.material.uniforms.backgroundIntensity.value=Nr.backgroundIntensity,Nt.material.toneMapped=rn.encoding!==at$1,rn.matrixAutoUpdate===!0&&rn.updateMatrix(),Nt.material.uniforms.uvTransform.value.copy(rn.matrix),(Gt!==rn||dr!==rn.version||Mr!==nt.toneMapping)&&(Nt.material.needsUpdate=!0,Gt=rn,dr=rn.version,Mr=nt.toneMapping),Nt.layers.enableAll(),Fr.unshift(Nt,Nt.geometry,Nt.material,0,0,null))}function zr(Fr,Nr){Fr.getRGB(Ng,KC(nt)),gt.buffers.color.setClear(Ng.r,Ng.g,Ng.b,Nr,At)}return{getClearColor:function(){return Rt},setClearColor:function(Fr,Nr=1){Rt.set(Fr),Ft=Nr,zr(Rt,Ft)},getClearAlpha:function(){return Ft},setClearAlpha:function(Fr){Ft=Fr,zr(Rt,Ft)},render:Tr}}function dk(nt,st,mt,gt){let _t=nt.getParameter(34921),Et=gt.isWebGL2?null:st.get("OES_vertex_array_object"),At=gt.isWebGL2||Et!==null,Rt={},Ft=Fr(null),Nt=Ft,Bt=!1;function Gt(uu,p0,X1,q0,W0){let hu=!1;if(At){let a1=zr(q0,X1,p0);Nt!==a1&&(Nt=a1,Mr(Nt.object)),hu=Nr(uu,q0,X1,W0),hu&&tn(uu,q0,X1,W0)}else{let a1=p0.wireframe===!0;(Nt.geometry!==q0.id||Nt.program!==X1.id||Nt.wireframe!==a1)&&(Nt.geometry=q0.id,Nt.program=X1.id,Nt.wireframe=a1,hu=!0)}W0!==null&&mt.update(W0,34963),(hu||Bt)&&(Bt=!1,kn(uu,p0,X1,q0),W0!==null&&nt.bindBuffer(34963,mt.get(W0).buffer))}function dr(){return gt.isWebGL2?nt.createVertexArray():Et.createVertexArrayOES()}function Mr(uu){return gt.isWebGL2?nt.bindVertexArray(uu):Et.bindVertexArrayOES(uu)}function Tr(uu){return gt.isWebGL2?nt.deleteVertexArray(uu):Et.deleteVertexArrayOES(uu)}function zr(uu,p0,X1){let q0=X1.wireframe===!0,W0=Rt[uu.id];W0===void 0&&(W0={},Rt[uu.id]=W0);let hu=W0[p0.id];hu===void 0&&(hu={},W0[p0.id]=hu);let a1=hu[q0];return a1===void 0&&(a1=Fr(dr()),hu[q0]=a1),a1}function Fr(uu){let p0=[],X1=[],q0=[];for(let W0=0;W0<_t;W0++)p0[W0]=0,X1[W0]=0,q0[W0]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:p0,enabledAttributes:X1,attributeDivisors:q0,object:uu,attributes:{},index:null}}function Nr(uu,p0,X1,q0){let W0=Nt.attributes,hu=p0.attributes,a1=0,Vx=X1.getAttributes();for(let t0 in Vx)if(Vx[t0].location>=0){let cu=W0[t0],lu=hu[t0];if(lu===void 0&&(t0==="instanceMatrix"&&uu.instanceMatrix&&(lu=uu.instanceMatrix),t0==="instanceColor"&&uu.instanceColor&&(lu=uu.instanceColor)),cu===void 0||cu.attribute!==lu||lu&&cu.data!==lu.data)return!0;a1++}return Nt.attributesNum!==a1||Nt.index!==q0}function tn(uu,p0,X1,q0){let W0={},hu=p0.attributes,a1=0,Vx=X1.getAttributes();for(let t0 in Vx)if(Vx[t0].location>=0){let cu=hu[t0];cu===void 0&&(t0==="instanceMatrix"&&uu.instanceMatrix&&(cu=uu.instanceMatrix),t0==="instanceColor"&&uu.instanceColor&&(cu=uu.instanceColor));let lu={};lu.attribute=cu,cu&&cu.data&&(lu.data=cu.data),W0[t0]=lu,a1++}Nt.attributes=W0,Nt.attributesNum=a1,Nt.index=q0}function rn(){let uu=Nt.newAttributes;for(let p0=0,X1=uu.length;p0<X1;p0++)uu[p0]=0}function Tn(uu){$n(uu,0)}function $n(uu,p0){let X1=Nt.newAttributes,q0=Nt.enabledAttributes,W0=Nt.attributeDivisors;X1[uu]=1,q0[uu]===0&&(nt.enableVertexAttribArray(uu),q0[uu]=1),W0[uu]!==p0&&((gt.isWebGL2?nt:st.get("ANGLE_instanced_arrays"))[gt.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](uu,p0),W0[uu]=p0)}function un(){let uu=Nt.newAttributes,p0=Nt.enabledAttributes;for(let X1=0,q0=p0.length;X1<q0;X1++)p0[X1]!==uu[X1]&&(nt.disableVertexAttribArray(X1),p0[X1]=0)}function es(uu,p0,X1,q0,W0,hu){gt.isWebGL2===!0&&(X1===5124||X1===5125)?nt.vertexAttribIPointer(uu,p0,X1,W0,hu):nt.vertexAttribPointer(uu,p0,X1,q0,W0,hu)}function kn(uu,p0,X1,q0){if(gt.isWebGL2===!1&&(uu.isInstancedMesh||q0.isInstancedBufferGeometry)&&st.get("ANGLE_instanced_arrays")===null)return;rn();let W0=q0.attributes,hu=X1.getAttributes(),a1=p0.defaultAttributeValues;for(let Vx in hu){let t0=hu[Vx];if(t0.location>=0){let cu=W0[Vx];if(cu===void 0&&(Vx==="instanceMatrix"&&uu.instanceMatrix&&(cu=uu.instanceMatrix),Vx==="instanceColor"&&uu.instanceColor&&(cu=uu.instanceColor)),cu!==void 0){let lu=cu.normalized,b0=cu.itemSize,l1=mt.get(cu);if(l1===void 0)continue;let LE=l1.buffer,eS=l1.type,SA=l1.bytesPerElement;if(cu.isInterleavedBufferAttribute){let o$=cu.data,h$=o$.stride,d$=cu.offset;if(o$.isInstancedInterleavedBuffer){for(let y$=0;y$<t0.locationSize;y$++)$n(t0.location+y$,o$.meshPerAttribute);uu.isInstancedMesh!==!0&&q0._maxInstanceCount===void 0&&(q0._maxInstanceCount=o$.meshPerAttribute*o$.count)}else for(let y$=0;y$<t0.locationSize;y$++)Tn(t0.location+y$);nt.bindBuffer(34962,LE);for(let y$=0;y$<t0.locationSize;y$++)es(t0.location+y$,b0/t0.locationSize,eS,lu,h$*SA,(d$+b0/t0.locationSize*y$)*SA)}else{if(cu.isInstancedBufferAttribute){for(let o$=0;o$<t0.locationSize;o$++)$n(t0.location+o$,cu.meshPerAttribute);uu.isInstancedMesh!==!0&&q0._maxInstanceCount===void 0&&(q0._maxInstanceCount=cu.meshPerAttribute*cu.count)}else for(let o$=0;o$<t0.locationSize;o$++)Tn(t0.location+o$);nt.bindBuffer(34962,LE);for(let o$=0;o$<t0.locationSize;o$++)es(t0.location+o$,b0/t0.locationSize,eS,lu,b0*SA,b0/t0.locationSize*o$*SA)}}else if(a1!==void 0){let lu=a1[Vx];if(lu!==void 0)switch(lu.length){case 2:nt.vertexAttrib2fv(t0.location,lu);break;case 3:nt.vertexAttrib3fv(t0.location,lu);break;case 4:nt.vertexAttrib4fv(t0.location,lu);break;default:nt.vertexAttrib1fv(t0.location,lu)}}}}un()}function ts(){Il();for(let uu in Rt){let p0=Rt[uu];for(let X1 in p0){let q0=p0[X1];for(let W0 in q0)Tr(q0[W0].object),delete q0[W0];delete p0[X1]}delete Rt[uu]}}function Ko(uu){if(Rt[uu.id]===void 0)return;let p0=Rt[uu.id];for(let X1 in p0){let q0=p0[X1];for(let W0 in q0)Tr(q0[W0].object),delete q0[W0];delete p0[X1]}delete Rt[uu.id]}function ds(uu){for(let p0 in Rt){let X1=Rt[p0];if(X1[uu.id]===void 0)continue;let q0=X1[uu.id];for(let W0 in q0)Tr(q0[W0].object),delete q0[W0];delete X1[uu.id]}}function Il(){ru(),Bt=!0,Nt!==Ft&&(Nt=Ft,Mr(Nt.object))}function ru(){Ft.geometry=null,Ft.program=null,Ft.wireframe=!1}return{setup:Gt,reset:Il,resetDefaultState:ru,dispose:ts,releaseStatesOfGeometry:Ko,releaseStatesOfProgram:ds,initAttributes:rn,enableAttribute:Tn,disableUnusedAttributes:un}}function fk(nt,st,mt,gt){let _t=gt.isWebGL2,Et;function At(Nt){Et=Nt}function Rt(Nt,Bt){nt.drawArrays(Et,Nt,Bt),mt.update(Bt,Et,1)}function Ft(Nt,Bt,Gt){if(Gt===0)return;let dr,Mr;if(_t)dr=nt,Mr="drawArraysInstanced";else if(dr=st.get("ANGLE_instanced_arrays"),Mr="drawArraysInstancedANGLE",dr===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}dr[Mr](Et,Nt,Bt,Gt),mt.update(Bt,Et,Gt)}this.setMode=At,this.render=Rt,this.renderInstances=Ft}function pk(nt,st,mt){let gt;function _t(){if(gt!==void 0)return gt;if(st.has("EXT_texture_filter_anisotropic")===!0){let es=st.get("EXT_texture_filter_anisotropic");gt=nt.getParameter(es.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else gt=0;return gt}function Et(es){if(es==="highp"){if(nt.getShaderPrecisionFormat(35633,36338).precision>0&&nt.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";es="mediump"}return es==="mediump"&&nt.getShaderPrecisionFormat(35633,36337).precision>0&&nt.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let At=typeof WebGL2RenderingContext<"u"&&nt instanceof WebGL2RenderingContext,Rt=mt.precision!==void 0?mt.precision:"highp",Ft=Et(Rt);Ft!==Rt&&(console.warn("THREE.WebGLRenderer:",Rt,"not supported, using",Ft,"instead."),Rt=Ft);let Nt=At||st.has("WEBGL_draw_buffers"),Bt=mt.logarithmicDepthBuffer===!0,Gt=nt.getParameter(34930),dr=nt.getParameter(35660),Mr=nt.getParameter(3379),Tr=nt.getParameter(34076),zr=nt.getParameter(34921),Fr=nt.getParameter(36347),Nr=nt.getParameter(36348),tn=nt.getParameter(36349),rn=dr>0,Tn=At||st.has("OES_texture_float"),$n=rn&&Tn,un=At?nt.getParameter(36183):0;return{isWebGL2:At,drawBuffers:Nt,getMaxAnisotropy:_t,getMaxPrecision:Et,precision:Rt,logarithmicDepthBuffer:Bt,maxTextures:Gt,maxVertexTextures:dr,maxTextureSize:Mr,maxCubemapSize:Tr,maxAttributes:zr,maxVertexUniforms:Fr,maxVaryings:Nr,maxFragmentUniforms:tn,vertexTextures:rn,floatFragmentTextures:Tn,floatVertexTextures:$n,maxSamples:un}}function mk(nt){let st=this,mt=null,gt=0,_t=!1,Et=!1,At=new Vr,Rt=new fr,Ft={value:null,needsUpdate:!1};this.uniform=Ft,this.numPlanes=0,this.numIntersection=0,this.init=function(Gt,dr){let Mr=Gt.length!==0||dr||gt!==0||_t;return _t=dr,gt=Gt.length,Mr},this.beginShadows=function(){Et=!0,Bt(null)},this.endShadows=function(){Et=!1},this.setGlobalState=function(Gt,dr){mt=Bt(Gt,dr,0)},this.setState=function(Gt,dr,Mr){let Tr=Gt.clippingPlanes,zr=Gt.clipIntersection,Fr=Gt.clipShadows,Nr=nt.get(Gt);if(!_t||Tr===null||Tr.length===0||Et&&!Fr)Et?Bt(null):Nt();else{let tn=Et?0:gt,rn=tn*4,Tn=Nr.clippingState||null;Ft.value=Tn,Tn=Bt(Tr,dr,rn,Mr);for(let $n=0;$n!==rn;++$n)Tn[$n]=mt[$n];Nr.clippingState=Tn,this.numIntersection=zr?this.numPlanes:0,this.numPlanes+=tn}};function Nt(){Ft.value!==mt&&(Ft.value=mt,Ft.needsUpdate=gt>0),st.numPlanes=gt,st.numIntersection=0}function Bt(Gt,dr,Mr,Tr){let zr=Gt!==null?Gt.length:0,Fr=null;if(zr!==0){if(Fr=Ft.value,Tr!==!0||Fr===null){let Nr=Mr+zr*4,tn=dr.matrixWorldInverse;Rt.getNormalMatrix(tn),(Fr===null||Fr.length<Nr)&&(Fr=new Float32Array(Nr));for(let rn=0,Tn=Mr;rn!==zr;++rn,Tn+=4)At.copy(Gt[rn]).applyMatrix4(tn,Rt),At.normal.toArray(Fr,Tn),Fr[Tn+3]=At.constant}Ft.value=Fr,Ft.needsUpdate=!0}return st.numPlanes=zr,st.numIntersection=0,Fr}}function gk(nt){let st=new WeakMap;function mt(At,Rt){return Rt===kS?At.mapping=Qa:Rt===GS&&(At.mapping=Ka),At}function gt(At){if(At&&At.isTexture&&At.isRenderTargetTexture===!1){let Rt=At.mapping;if(Rt===kS||Rt===GS)if(st.has(At)){let Ft=st.get(At).texture;return mt(Ft,At.mapping)}else{let Ft=At.image;if(Ft&&Ft.height>0){let Nt=new XS(Ft.height/2);return Nt.fromEquirectangularTexture(nt,At),st.set(At,Nt),At.addEventListener("dispose",_t),mt(Nt.texture,At.mapping)}else return null}}return At}function _t(At){let Rt=At.target;Rt.removeEventListener("dispose",_t);let Ft=st.get(Rt);Ft!==void 0&&(st.delete(Rt),Ft.dispose())}function Et(){st=new WeakMap}return{get:gt,dispose:Et}}var Ja=class extends qn{constructor(nt=-1,st=1,mt=1,gt=-1,_t=.1,Et=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=nt,this.right=st,this.top=mt,this.bottom=gt,this.near=_t,this.far=Et,this.updateProjectionMatrix()}copy(nt,st){return super.copy(nt,st),this.left=nt.left,this.right=nt.right,this.top=nt.top,this.bottom=nt.bottom,this.near=nt.near,this.far=nt.far,this.zoom=nt.zoom,this.view=nt.view===null?null:Object.assign({},nt.view),this}setViewOffset(nt,st,mt,gt,_t,Et){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=nt,this.view.fullHeight=st,this.view.offsetX=mt,this.view.offsetY=gt,this.view.width=_t,this.view.height=Et,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let nt=(this.right-this.left)/(2*this.zoom),st=(this.top-this.bottom)/(2*this.zoom),mt=(this.right+this.left)/2,gt=(this.top+this.bottom)/2,_t=mt-nt,Et=mt+nt,At=gt+st,Rt=gt-st;if(this.view!==null&&this.view.enabled){let Ft=(this.right-this.left)/this.view.fullWidth/this.zoom,Nt=(this.top-this.bottom)/this.view.fullHeight/this.zoom;_t+=Ft*this.view.offsetX,Et=_t+Ft*this.view.width,At-=Nt*this.view.offsetY,Rt=At-Nt*this.view.height}this.projectionMatrix.makeOrthographic(_t,Et,At,Rt,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(nt){let st=super.toJSON(nt);return st.object.zoom=this.zoom,st.object.left=this.left,st.object.right=this.right,st.object.top=this.top,st.object.bottom=this.bottom,st.object.near=this.near,st.object.far=this.far,this.view!==null&&(st.object.view=Object.assign({},this.view)),st}},_u=4,ZT=[.125,.215,.35,.446,.526,.582],cc=20,IS=new Ja,JT=new We$1,OS=null,lc=(1+Math.sqrt(5))/2,Mu=1/lc,$T=[new E$6(1,1,1),new E$6(-1,1,1),new E$6(1,1,-1),new E$6(-1,1,-1),new E$6(0,lc,Mu),new E$6(0,lc,-Mu),new E$6(Mu,0,lc),new E$6(-Mu,0,lc),new E$6(lc,Mu,0),new E$6(-lc,Mu,0)],ny=class{constructor(nt){this._renderer=nt,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(nt,st=0,mt=.1,gt=100){OS=this._renderer.getRenderTarget(),this._setSize(256);let _t=this._allocateTargets();return _t.depthBuffer=!0,this._sceneToCubeUV(nt,mt,gt,_t),st>0&&this._blur(_t,0,0,st),this._applyPMREM(_t),this._cleanup(_t),_t}fromEquirectangular(nt,st=null){return this._fromTexture(nt,st)}fromCubemap(nt,st=null){return this._fromTexture(nt,st)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=rC(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=tC(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(nt){this._lodMax=Math.floor(Math.log2(nt)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let nt=0;nt<this._lodPlanes.length;nt++)this._lodPlanes[nt].dispose()}_cleanup(nt){this._renderer.setRenderTarget(OS),nt.scissorTest=!1,Fg(nt,0,0,nt.width,nt.height)}_fromTexture(nt,st){nt.mapping===Qa||nt.mapping===Ka?this._setSize(nt.image.length===0?16:nt.image[0].width||nt.image[0].image.width):this._setSize(nt.image.width/4),OS=this._renderer.getRenderTarget();let mt=st||this._allocateTargets();return this._textureToCubeUV(nt,mt),this._applyPMREM(mt),this._cleanup(mt),mt}_allocateTargets(){let nt=3*Math.max(this._cubeSize,112),st=4*this._cubeSize,mt={magFilter:rt$1,minFilter:rt$1,generateMipmaps:!1,type:Wn,format:qr,encoding:mn,depthBuffer:!1},gt=eC(nt,st,mt);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==nt||this._pingPongRenderTarget.height!==st){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=eC(nt,st,mt);let{_lodMax:_t}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=yk(_t)),this._blurMaterial=vk(_t,nt,st)}return gt}_compileMaterial(nt){let st=new Ut(this._lodPlanes[0],nt);this._renderer.compile(st,IS)}_sceneToCubeUV(nt,st,mt,gt){let _t=new $r(90,1,st,mt),Et=[1,-1,1,1,1,1],At=[1,1,1,-1,-1,-1],Rt=this._renderer,Ft=Rt.autoClear,Nt=Rt.toneMapping;Rt.getClearColor(JT),Rt.toneMapping=Is,Rt.autoClear=!1;let Bt=new on({name:"PMREM.Background",side:pi,depthWrite:!1,depthTest:!1}),Gt=new Ut(new mi,Bt),dr=!1,Mr=nt.background;Mr?Mr.isColor&&(Bt.color.copy(Mr),nt.background=null,dr=!0):(Bt.color.copy(JT),dr=!0);for(let Tr=0;Tr<6;Tr++){let zr=Tr%3;zr===0?(_t.up.set(0,Et[Tr],0),_t.lookAt(At[Tr],0,0)):zr===1?(_t.up.set(0,0,Et[Tr]),_t.lookAt(0,At[Tr],0)):(_t.up.set(0,Et[Tr],0),_t.lookAt(0,0,At[Tr]));let Fr=this._cubeSize;Fg(gt,zr*Fr,Tr>2?Fr:0,Fr,Fr),Rt.setRenderTarget(gt),dr&&Rt.render(Gt,_t),Rt.render(nt,_t)}Gt.geometry.dispose(),Gt.material.dispose(),Rt.toneMapping=Nt,Rt.autoClear=Ft,nt.background=Mr}_textureToCubeUV(nt,st){let mt=this._renderer,gt=nt.mapping===Qa||nt.mapping===Ka;gt?(this._cubemapMaterial===null&&(this._cubemapMaterial=rC()),this._cubemapMaterial.uniforms.flipEnvMap.value=nt.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=tC());let _t=gt?this._cubemapMaterial:this._equirectMaterial,Et=new Ut(this._lodPlanes[0],_t),At=_t.uniforms;At.envMap.value=nt;let Rt=this._cubeSize;Fg(st,0,0,3*Rt,2*Rt),mt.setRenderTarget(st),mt.render(Et,IS)}_applyPMREM(nt){let st=this._renderer,mt=st.autoClear;st.autoClear=!1;for(let gt=1;gt<this._lodPlanes.length;gt++){let _t=Math.sqrt(this._sigmas[gt]*this._sigmas[gt]-this._sigmas[gt-1]*this._sigmas[gt-1]),Et=$T[(gt-1)%$T.length];this._blur(nt,gt-1,gt,_t,Et)}st.autoClear=mt}_blur(nt,st,mt,gt,_t){let Et=this._pingPongRenderTarget;this._halfBlur(nt,Et,st,mt,gt,"latitudinal",_t),this._halfBlur(Et,nt,mt,mt,gt,"longitudinal",_t)}_halfBlur(nt,st,mt,gt,_t,Et,At){let Rt=this._renderer,Ft=this._blurMaterial;Et!=="latitudinal"&&Et!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let Nt=3,Bt=new Ut(this._lodPlanes[gt],Ft),Gt=Ft.uniforms,dr=this._sizeLods[mt]-1,Mr=isFinite(_t)?Math.PI/(2*dr):2*Math.PI/(2*cc-1),Tr=_t/Mr,zr=isFinite(_t)?1+Math.floor(Nt*Tr):cc;zr>cc&&console.warn(`sigmaRadians, ${_t}, is too large and will clip, as it requested ${zr} samples when the maximum is set to ${cc}`);let Fr=[],Nr=0;for(let un=0;un<cc;++un){let es=un/Tr,kn=Math.exp(-es*es/2);Fr.push(kn),un===0?Nr+=kn:un<zr&&(Nr+=2*kn)}for(let un=0;un<Fr.length;un++)Fr[un]=Fr[un]/Nr;Gt.envMap.value=nt.texture,Gt.samples.value=zr,Gt.weights.value=Fr,Gt.latitudinal.value=Et==="latitudinal",At&&(Gt.poleAxis.value=At);let{_lodMax:tn}=this;Gt.dTheta.value=Mr,Gt.mipInt.value=tn-mt;let rn=this._sizeLods[gt],Tn=3*rn*(gt>tn-_u?gt-tn+_u:0),$n=4*(this._cubeSize-rn);Fg(st,Tn,$n,3*rn,2*rn),Rt.setRenderTarget(st),Rt.render(Bt,IS)}};function yk(nt){let st=[],mt=[],gt=[],_t=nt,Et=nt-_u+1+ZT.length;for(let At=0;At<Et;At++){let Rt=Math.pow(2,_t);mt.push(Rt);let Ft=1/Rt;At>nt-_u?Ft=ZT[At-nt+_u-1]:At===0&&(Ft=0),gt.push(Ft);let Nt=1/(Rt-2),Bt=-Nt,Gt=1+Nt,dr=[Bt,Bt,Gt,Bt,Gt,Gt,Bt,Bt,Gt,Gt,Bt,Gt],Mr=6,Tr=6,zr=3,Fr=2,Nr=1,tn=new Float32Array(zr*Tr*Mr),rn=new Float32Array(Fr*Tr*Mr),Tn=new Float32Array(Nr*Tr*Mr);for(let un=0;un<Mr;un++){let es=un%3*2/3-1,kn=un>2?0:-1,ts=[es,kn,0,es+2/3,kn,0,es+2/3,kn+1,0,es,kn,0,es+2/3,kn+1,0,es,kn+1,0];tn.set(ts,zr*Tr*un),rn.set(dr,Fr*Tr*un);let Ko=[un,un,un,un,un,un];Tn.set(Ko,Nr*Tr*un)}let $n=new _e$1;$n.setAttribute("position",new Xe$1(tn,zr)),$n.setAttribute("uv",new Xe$1(rn,Fr)),$n.setAttribute("faceIndex",new Xe$1(Tn,Nr)),st.push($n),_t>_u&&_t--}return{lodPlanes:st,sizeLods:mt,sigmas:gt}}function eC(nt,st,mt){let gt=new dt$1(nt,st,mt);return gt.texture.mapping=Zu,gt.texture.name="PMREM.cubeUv",gt.scissorTest=!0,gt}function Fg(nt,st,mt,gt,_t){nt.viewport.set(st,mt,gt,_t),nt.scissor.set(st,mt,gt,_t)}function vk(nt,st,mt){let gt=new Float32Array(cc),_t=new E$6(0,1,0);return new it$1({name:"SphericalGaussianBlur",defines:{n:cc,CUBEUV_TEXEL_WIDTH:1/st,CUBEUV_TEXEL_HEIGHT:1/mt,CUBEUV_MAX_MIP:`${nt}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:gt},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:_t}},vertexShader:Pw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Jt,depthTest:!1,depthWrite:!1})}function tC(){return new it$1({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Pw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Jt,depthTest:!1,depthWrite:!1})}function rC(){return new it$1({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Pw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Jt,depthTest:!1,depthWrite:!1})}function Pw(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function xk(nt){let st=new WeakMap,mt=null;function gt(Rt){if(Rt&&Rt.isTexture){let Ft=Rt.mapping,Nt=Ft===kS||Ft===GS,Bt=Ft===Qa||Ft===Ka;if(Nt||Bt)if(Rt.isRenderTargetTexture&&Rt.needsPMREMUpdate===!0){Rt.needsPMREMUpdate=!1;let Gt=st.get(Rt);return mt===null&&(mt=new ny(nt)),Gt=Nt?mt.fromEquirectangular(Rt,Gt):mt.fromCubemap(Rt,Gt),st.set(Rt,Gt),Gt.texture}else{if(st.has(Rt))return st.get(Rt).texture;{let Gt=Rt.image;if(Nt&&Gt&&Gt.height>0||Bt&&Gt&&_t(Gt)){mt===null&&(mt=new ny(nt));let dr=Nt?mt.fromEquirectangular(Rt):mt.fromCubemap(Rt);return st.set(Rt,dr),Rt.addEventListener("dispose",Et),dr.texture}else return null}}}return Rt}function _t(Rt){let Ft=0,Nt=6;for(let Bt=0;Bt<Nt;Bt++)Rt[Bt]!==void 0&&Ft++;return Ft===Nt}function Et(Rt){let Ft=Rt.target;Ft.removeEventListener("dispose",Et);let Nt=st.get(Ft);Nt!==void 0&&(st.delete(Ft),Nt.dispose())}function At(){st=new WeakMap,mt!==null&&(mt.dispose(),mt=null)}return{get:gt,dispose:At}}function bk(nt){let st={};function mt(gt){if(st[gt]!==void 0)return st[gt];let _t;switch(gt){case"WEBGL_depth_texture":_t=nt.getExtension("WEBGL_depth_texture")||nt.getExtension("MOZ_WEBGL_depth_texture")||nt.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":_t=nt.getExtension("EXT_texture_filter_anisotropic")||nt.getExtension("MOZ_EXT_texture_filter_anisotropic")||nt.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":_t=nt.getExtension("WEBGL_compressed_texture_s3tc")||nt.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||nt.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":_t=nt.getExtension("WEBGL_compressed_texture_pvrtc")||nt.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:_t=nt.getExtension(gt)}return st[gt]=_t,_t}return{has:function(gt){return mt(gt)!==null},init:function(gt){gt.isWebGL2?mt("EXT_color_buffer_float"):(mt("WEBGL_depth_texture"),mt("OES_texture_float"),mt("OES_texture_half_float"),mt("OES_texture_half_float_linear"),mt("OES_standard_derivatives"),mt("OES_element_index_uint"),mt("OES_vertex_array_object"),mt("ANGLE_instanced_arrays")),mt("OES_texture_float_linear"),mt("EXT_color_buffer_half_float"),mt("WEBGL_multisampled_render_to_texture")},get:function(gt){let _t=mt(gt);return _t===null&&console.warn("THREE.WebGLRenderer: "+gt+" extension not supported."),_t}}}function Sk(nt,st,mt,gt){let _t={},Et=new WeakMap;function At(Gt){let dr=Gt.target;dr.index!==null&&st.remove(dr.index);for(let Tr in dr.attributes)st.remove(dr.attributes[Tr]);dr.removeEventListener("dispose",At),delete _t[dr.id];let Mr=Et.get(dr);Mr&&(st.remove(Mr),Et.delete(dr)),gt.releaseStatesOfGeometry(dr),dr.isInstancedBufferGeometry===!0&&delete dr._maxInstanceCount,mt.memory.geometries--}function Rt(Gt,dr){return _t[dr.id]===!0||(dr.addEventListener("dispose",At),_t[dr.id]=!0,mt.memory.geometries++),dr}function Ft(Gt){let dr=Gt.attributes;for(let Tr in dr)st.update(dr[Tr],34962);let Mr=Gt.morphAttributes;for(let Tr in Mr){let zr=Mr[Tr];for(let Fr=0,Nr=zr.length;Fr<Nr;Fr++)st.update(zr[Fr],34962)}}function Nt(Gt){let dr=[],Mr=Gt.index,Tr=Gt.attributes.position,zr=0;if(Mr!==null){let tn=Mr.array;zr=Mr.version;for(let rn=0,Tn=tn.length;rn<Tn;rn+=3){let $n=tn[rn+0],un=tn[rn+1],es=tn[rn+2];dr.push($n,un,un,es,es,$n)}}else{let tn=Tr.array;zr=Tr.version;for(let rn=0,Tn=tn.length/3-1;rn<Tn;rn+=3){let $n=rn+0,un=rn+1,es=rn+2;dr.push($n,un,un,es,es,$n)}}let Fr=new(XC(dr)?ho$1:iy)(dr,1);Fr.version=zr;let Nr=Et.get(Gt);Nr&&st.remove(Nr),Et.set(Gt,Fr)}function Bt(Gt){let dr=Et.get(Gt);if(dr){let Mr=Gt.index;Mr!==null&&dr.version<Mr.version&&Nt(Gt)}else Nt(Gt);return Et.get(Gt)}return{get:Rt,update:Ft,getWireframeAttribute:Bt}}function wk(nt,st,mt,gt){let _t=gt.isWebGL2,Et;function At(dr){Et=dr}let Rt,Ft;function Nt(dr){Rt=dr.type,Ft=dr.bytesPerElement}function Bt(dr,Mr){nt.drawElements(Et,Mr,Rt,dr*Ft),mt.update(Mr,Et,1)}function Gt(dr,Mr,Tr){if(Tr===0)return;let zr,Fr;if(_t)zr=nt,Fr="drawElementsInstanced";else if(zr=st.get("ANGLE_instanced_arrays"),Fr="drawElementsInstancedANGLE",zr===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}zr[Fr](Et,Mr,Rt,dr*Ft,Tr),mt.update(Mr,Et,Tr)}this.setMode=At,this.setIndex=Nt,this.render=Bt,this.renderInstances=Gt}function Ak(nt){let st={geometries:0,textures:0},mt={frame:0,calls:0,triangles:0,points:0,lines:0};function gt(Et,At,Rt){switch(mt.calls++,At){case 4:mt.triangles+=Rt*(Et/3);break;case 1:mt.lines+=Rt*(Et/2);break;case 3:mt.lines+=Rt*(Et-1);break;case 2:mt.lines+=Rt*Et;break;case 0:mt.points+=Rt*Et;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",At);break}}function _t(){mt.frame++,mt.calls=0,mt.triangles=0,mt.points=0,mt.lines=0}return{memory:st,render:mt,programs:null,autoReset:!0,reset:_t,update:gt}}function Ek(nt,st){return nt[0]-st[0]}function Mk(nt,st){return Math.abs(st[1])-Math.abs(nt[1])}function Tk(nt,st,mt){let gt={},_t=new Float32Array(8),Et=new WeakMap,At=new Ze$1,Rt=[];for(let Nt=0;Nt<8;Nt++)Rt[Nt]=[Nt,0];function Ft(Nt,Bt,Gt,dr){let Mr=Nt.morphTargetInfluences;if(st.isWebGL2===!0){let Tr=Bt.morphAttributes.position||Bt.morphAttributes.normal||Bt.morphAttributes.color,zr=Tr!==void 0?Tr.length:0,Fr=Et.get(Bt);if(Fr===void 0||Fr.count!==zr){let rn=function(){uu.dispose(),Et.delete(Bt),Bt.removeEventListener("dispose",rn)};Fr!==void 0&&Fr.texture.dispose();let Tn=Bt.morphAttributes.position!==void 0,$n=Bt.morphAttributes.normal!==void 0,un=Bt.morphAttributes.color!==void 0,es=Bt.morphAttributes.position||[],kn=Bt.morphAttributes.normal||[],ts=Bt.morphAttributes.color||[],Ko=0;Tn===!0&&(Ko=1),$n===!0&&(Ko=2),un===!0&&(Ko=3);let ds=Bt.attributes.position.count*Ko,Il=1;ds>st.maxTextureSize&&(Il=Math.ceil(ds/st.maxTextureSize),ds=st.maxTextureSize);let ru=new Float32Array(ds*Il*4*zr),uu=new ey(ru,ds,Il,zr);uu.type=br,uu.needsUpdate=!0;let p0=Ko*4;for(let X1=0;X1<zr;X1++){let q0=es[X1],W0=kn[X1],hu=ts[X1],a1=ds*Il*4*X1;for(let Vx=0;Vx<q0.count;Vx++){let t0=Vx*p0;Tn===!0&&(At.fromBufferAttribute(q0,Vx),ru[a1+t0+0]=At.x,ru[a1+t0+1]=At.y,ru[a1+t0+2]=At.z,ru[a1+t0+3]=0),$n===!0&&(At.fromBufferAttribute(W0,Vx),ru[a1+t0+4]=At.x,ru[a1+t0+5]=At.y,ru[a1+t0+6]=At.z,ru[a1+t0+7]=0),un===!0&&(At.fromBufferAttribute(hu,Vx),ru[a1+t0+8]=At.x,ru[a1+t0+9]=At.y,ru[a1+t0+10]=At.z,ru[a1+t0+11]=hu.itemSize===4?At.w:1)}}Fr={count:zr,texture:uu,size:new U$1(ds,Il)},Et.set(Bt,Fr),Bt.addEventListener("dispose",rn)}let Nr=0;for(let rn=0;rn<Mr.length;rn++)Nr+=Mr[rn];let tn=Bt.morphTargetsRelative?1:1-Nr;dr.getUniforms().setValue(nt,"morphTargetBaseInfluence",tn),dr.getUniforms().setValue(nt,"morphTargetInfluences",Mr),dr.getUniforms().setValue(nt,"morphTargetsTexture",Fr.texture,mt),dr.getUniforms().setValue(nt,"morphTargetsTextureSize",Fr.size)}else{let Tr=Mr===void 0?0:Mr.length,zr=gt[Bt.id];if(zr===void 0||zr.length!==Tr){zr=[];for(let Tn=0;Tn<Tr;Tn++)zr[Tn]=[Tn,0];gt[Bt.id]=zr}for(let Tn=0;Tn<Tr;Tn++){let $n=zr[Tn];$n[0]=Tn,$n[1]=Mr[Tn]}zr.sort(Mk);for(let Tn=0;Tn<8;Tn++)Tn<Tr&&zr[Tn][1]?(Rt[Tn][0]=zr[Tn][0],Rt[Tn][1]=zr[Tn][1]):(Rt[Tn][0]=Number.MAX_SAFE_INTEGER,Rt[Tn][1]=0);Rt.sort(Ek);let Fr=Bt.morphAttributes.position,Nr=Bt.morphAttributes.normal,tn=0;for(let Tn=0;Tn<8;Tn++){let $n=Rt[Tn],un=$n[0],es=$n[1];un!==Number.MAX_SAFE_INTEGER&&es?(Fr&&Bt.getAttribute("morphTarget"+Tn)!==Fr[un]&&Bt.setAttribute("morphTarget"+Tn,Fr[un]),Nr&&Bt.getAttribute("morphNormal"+Tn)!==Nr[un]&&Bt.setAttribute("morphNormal"+Tn,Nr[un]),_t[Tn]=es,tn+=es):(Fr&&Bt.hasAttribute("morphTarget"+Tn)===!0&&Bt.deleteAttribute("morphTarget"+Tn),Nr&&Bt.hasAttribute("morphNormal"+Tn)===!0&&Bt.deleteAttribute("morphNormal"+Tn),_t[Tn]=0)}let rn=Bt.morphTargetsRelative?1:1-tn;dr.getUniforms().setValue(nt,"morphTargetBaseInfluence",rn),dr.getUniforms().setValue(nt,"morphTargetInfluences",_t)}}return{update:Ft}}function Ck(nt,st,mt,gt){let _t=new WeakMap;function Et(Ft){let Nt=gt.render.frame,Bt=Ft.geometry,Gt=st.get(Ft,Bt);return _t.get(Gt)!==Nt&&(st.update(Gt),_t.set(Gt,Nt)),Ft.isInstancedMesh&&(Ft.hasEventListener("dispose",Rt)===!1&&Ft.addEventListener("dispose",Rt),mt.update(Ft.instanceMatrix,34962),Ft.instanceColor!==null&&mt.update(Ft.instanceColor,34962)),Gt}function At(){_t=new WeakMap}function Rt(Ft){let Nt=Ft.target;Nt.removeEventListener("dispose",Rt),mt.remove(Nt.instanceMatrix),Nt.instanceColor!==null&&mt.remove(Nt.instanceColor)}return{update:Et,dispose:At}}var JC=new $t,$C=new ey,eP=new ty,tP=new Ru,iC=[],nC=[],sC=new Float32Array(16),oC=new Float32Array(9),aC=new Float32Array(4);function $u(nt,st,mt){let gt=nt[0];if(gt<=0||gt>0)return nt;let _t=st*mt,Et=iC[_t];if(Et===void 0&&(Et=new Float32Array(_t),iC[_t]=Et),st!==0){gt.toArray(Et,0);for(let At=1,Rt=0;At!==st;++At)Rt+=mt,nt[At].toArray(Et,Rt)}return Et}function Ai(nt,st){if(nt.length!==st.length)return!1;for(let mt=0,gt=nt.length;mt<gt;mt++)if(nt[mt]!==st[mt])return!1;return!0}function Ei(nt,st){for(let mt=0,gt=st.length;mt<gt;mt++)nt[mt]=st[mt]}function Ey(nt,st){let mt=nC[st];mt===void 0&&(mt=new Int32Array(st),nC[st]=mt);for(let gt=0;gt!==st;++gt)mt[gt]=nt.allocateTextureUnit();return mt}function Pk(nt,st){let mt=this.cache;mt[0]!==st&&(nt.uniform1f(this.addr,st),mt[0]=st)}function _k(nt,st){let mt=this.cache;if(st.x!==void 0)(mt[0]!==st.x||mt[1]!==st.y)&&(nt.uniform2f(this.addr,st.x,st.y),mt[0]=st.x,mt[1]=st.y);else{if(Ai(mt,st))return;nt.uniform2fv(this.addr,st),Ei(mt,st)}}function Dk(nt,st){let mt=this.cache;if(st.x!==void 0)(mt[0]!==st.x||mt[1]!==st.y||mt[2]!==st.z)&&(nt.uniform3f(this.addr,st.x,st.y,st.z),mt[0]=st.x,mt[1]=st.y,mt[2]=st.z);else if(st.r!==void 0)(mt[0]!==st.r||mt[1]!==st.g||mt[2]!==st.b)&&(nt.uniform3f(this.addr,st.r,st.g,st.b),mt[0]=st.r,mt[1]=st.g,mt[2]=st.b);else{if(Ai(mt,st))return;nt.uniform3fv(this.addr,st),Ei(mt,st)}}function Ik(nt,st){let mt=this.cache;if(st.x!==void 0)(mt[0]!==st.x||mt[1]!==st.y||mt[2]!==st.z||mt[3]!==st.w)&&(nt.uniform4f(this.addr,st.x,st.y,st.z,st.w),mt[0]=st.x,mt[1]=st.y,mt[2]=st.z,mt[3]=st.w);else{if(Ai(mt,st))return;nt.uniform4fv(this.addr,st),Ei(mt,st)}}function Ok(nt,st){let mt=this.cache,gt=st.elements;if(gt===void 0){if(Ai(mt,st))return;nt.uniformMatrix2fv(this.addr,!1,st),Ei(mt,st)}else{if(Ai(mt,gt))return;aC.set(gt),nt.uniformMatrix2fv(this.addr,!1,aC),Ei(mt,gt)}}function Rk(nt,st){let mt=this.cache,gt=st.elements;if(gt===void 0){if(Ai(mt,st))return;nt.uniformMatrix3fv(this.addr,!1,st),Ei(mt,st)}else{if(Ai(mt,gt))return;oC.set(gt),nt.uniformMatrix3fv(this.addr,!1,oC),Ei(mt,gt)}}function Lk(nt,st){let mt=this.cache,gt=st.elements;if(gt===void 0){if(Ai(mt,st))return;nt.uniformMatrix4fv(this.addr,!1,st),Ei(mt,st)}else{if(Ai(mt,gt))return;sC.set(gt),nt.uniformMatrix4fv(this.addr,!1,sC),Ei(mt,gt)}}function Bk(nt,st){let mt=this.cache;mt[0]!==st&&(nt.uniform1i(this.addr,st),mt[0]=st)}function Nk(nt,st){let mt=this.cache;if(st.x!==void 0)(mt[0]!==st.x||mt[1]!==st.y)&&(nt.uniform2i(this.addr,st.x,st.y),mt[0]=st.x,mt[1]=st.y);else{if(Ai(mt,st))return;nt.uniform2iv(this.addr,st),Ei(mt,st)}}function Fk(nt,st){let mt=this.cache;if(st.x!==void 0)(mt[0]!==st.x||mt[1]!==st.y||mt[2]!==st.z)&&(nt.uniform3i(this.addr,st.x,st.y,st.z),mt[0]=st.x,mt[1]=st.y,mt[2]=st.z);else{if(Ai(mt,st))return;nt.uniform3iv(this.addr,st),Ei(mt,st)}}function Vk(nt,st){let mt=this.cache;if(st.x!==void 0)(mt[0]!==st.x||mt[1]!==st.y||mt[2]!==st.z||mt[3]!==st.w)&&(nt.uniform4i(this.addr,st.x,st.y,st.z,st.w),mt[0]=st.x,mt[1]=st.y,mt[2]=st.z,mt[3]=st.w);else{if(Ai(mt,st))return;nt.uniform4iv(this.addr,st),Ei(mt,st)}}function Uk(nt,st){let mt=this.cache;mt[0]!==st&&(nt.uniform1ui(this.addr,st),mt[0]=st)}function zk(nt,st){let mt=this.cache;if(st.x!==void 0)(mt[0]!==st.x||mt[1]!==st.y)&&(nt.uniform2ui(this.addr,st.x,st.y),mt[0]=st.x,mt[1]=st.y);else{if(Ai(mt,st))return;nt.uniform2uiv(this.addr,st),Ei(mt,st)}}function kk(nt,st){let mt=this.cache;if(st.x!==void 0)(mt[0]!==st.x||mt[1]!==st.y||mt[2]!==st.z)&&(nt.uniform3ui(this.addr,st.x,st.y,st.z),mt[0]=st.x,mt[1]=st.y,mt[2]=st.z);else{if(Ai(mt,st))return;nt.uniform3uiv(this.addr,st),Ei(mt,st)}}function Gk(nt,st){let mt=this.cache;if(st.x!==void 0)(mt[0]!==st.x||mt[1]!==st.y||mt[2]!==st.z||mt[3]!==st.w)&&(nt.uniform4ui(this.addr,st.x,st.y,st.z,st.w),mt[0]=st.x,mt[1]=st.y,mt[2]=st.z,mt[3]=st.w);else{if(Ai(mt,st))return;nt.uniform4uiv(this.addr,st),Ei(mt,st)}}function jk(nt,st,mt){let gt=this.cache,_t=mt.allocateTextureUnit();gt[0]!==_t&&(nt.uniform1i(this.addr,_t),gt[0]=_t),mt.setTexture2D(st||JC,_t)}function Hk(nt,st,mt){let gt=this.cache,_t=mt.allocateTextureUnit();gt[0]!==_t&&(nt.uniform1i(this.addr,_t),gt[0]=_t),mt.setTexture3D(st||eP,_t)}function Wk(nt,st,mt){let gt=this.cache,_t=mt.allocateTextureUnit();gt[0]!==_t&&(nt.uniform1i(this.addr,_t),gt[0]=_t),mt.setTextureCube(st||tP,_t)}function qk(nt,st,mt){let gt=this.cache,_t=mt.allocateTextureUnit();gt[0]!==_t&&(nt.uniform1i(this.addr,_t),gt[0]=_t),mt.setTexture2DArray(st||$C,_t)}function Yk(nt){switch(nt){case 5126:return Pk;case 35664:return _k;case 35665:return Dk;case 35666:return Ik;case 35674:return Ok;case 35675:return Rk;case 35676:return Lk;case 5124:case 35670:return Bk;case 35667:case 35671:return Nk;case 35668:case 35672:return Fk;case 35669:case 35673:return Vk;case 5125:return Uk;case 36294:return zk;case 36295:return kk;case 36296:return Gk;case 35678:case 36198:case 36298:case 36306:case 35682:return jk;case 35679:case 36299:case 36307:return Hk;case 35680:case 36300:case 36308:case 36293:return Wk;case 36289:case 36303:case 36311:case 36292:return qk}}function Xk(nt,st){nt.uniform1fv(this.addr,st)}function Qk(nt,st){let mt=$u(st,this.size,2);nt.uniform2fv(this.addr,mt)}function Kk(nt,st){let mt=$u(st,this.size,3);nt.uniform3fv(this.addr,mt)}function Zk(nt,st){let mt=$u(st,this.size,4);nt.uniform4fv(this.addr,mt)}function Jk(nt,st){let mt=$u(st,this.size,4);nt.uniformMatrix2fv(this.addr,!1,mt)}function $k(nt,st){let mt=$u(st,this.size,9);nt.uniformMatrix3fv(this.addr,!1,mt)}function eG(nt,st){let mt=$u(st,this.size,16);nt.uniformMatrix4fv(this.addr,!1,mt)}function tG(nt,st){nt.uniform1iv(this.addr,st)}function rG(nt,st){nt.uniform2iv(this.addr,st)}function iG(nt,st){nt.uniform3iv(this.addr,st)}function nG(nt,st){nt.uniform4iv(this.addr,st)}function sG(nt,st){nt.uniform1uiv(this.addr,st)}function oG(nt,st){nt.uniform2uiv(this.addr,st)}function aG(nt,st){nt.uniform3uiv(this.addr,st)}function lG(nt,st){nt.uniform4uiv(this.addr,st)}function cG(nt,st,mt){let gt=this.cache,_t=st.length,Et=Ey(mt,_t);Ai(gt,Et)||(nt.uniform1iv(this.addr,Et),Ei(gt,Et));for(let At=0;At!==_t;++At)mt.setTexture2D(st[At]||JC,Et[At])}function uG(nt,st,mt){let gt=this.cache,_t=st.length,Et=Ey(mt,_t);Ai(gt,Et)||(nt.uniform1iv(this.addr,Et),Ei(gt,Et));for(let At=0;At!==_t;++At)mt.setTexture3D(st[At]||eP,Et[At])}function hG(nt,st,mt){let gt=this.cache,_t=st.length,Et=Ey(mt,_t);Ai(gt,Et)||(nt.uniform1iv(this.addr,Et),Ei(gt,Et));for(let At=0;At!==_t;++At)mt.setTextureCube(st[At]||tP,Et[At])}function dG(nt,st,mt){let gt=this.cache,_t=st.length,Et=Ey(mt,_t);Ai(gt,Et)||(nt.uniform1iv(this.addr,Et),Ei(gt,Et));for(let At=0;At!==_t;++At)mt.setTexture2DArray(st[At]||$C,Et[At])}function fG(nt){switch(nt){case 5126:return Xk;case 35664:return Qk;case 35665:return Kk;case 35666:return Zk;case 35674:return Jk;case 35675:return $k;case 35676:return eG;case 5124:case 35670:return tG;case 35667:case 35671:return rG;case 35668:case 35672:return iG;case 35669:case 35673:return nG;case 5125:return sG;case 36294:return oG;case 36295:return aG;case 36296:return lG;case 35678:case 36198:case 36298:case 36306:case 35682:return cG;case 35679:case 36299:case 36307:return uG;case 35680:case 36300:case 36308:case 36293:return hG;case 36289:case 36303:case 36311:case 36292:return dG}}var QS=class{constructor(nt,st,mt){this.id=nt,this.addr=mt,this.cache=[],this.setValue=Yk(st.type)}},KS=class{constructor(nt,st,mt){this.id=nt,this.addr=mt,this.cache=[],this.size=st.size,this.setValue=fG(st.type)}},ZS=class{constructor(nt){this.id=nt,this.seq=[],this.map={}}setValue(nt,st,mt){let gt=this.seq;for(let _t=0,Et=gt.length;_t!==Et;++_t){let At=gt[_t];At.setValue(nt,st[At.id],mt)}}},RS=/(\w+)(\])?(\[|\.)?/g;function lC(nt,st){nt.seq.push(st),nt.map[st.id]=st}function pG(nt,st,mt){let gt=nt.name,_t=gt.length;for(RS.lastIndex=0;;){let Et=RS.exec(gt),At=RS.lastIndex,Rt=Et[1],Ft=Et[2]==="]",Nt=Et[3];if(Ft&&(Rt=Rt|0),Nt===void 0||Nt==="["&&At+2===_t){lC(mt,Nt===void 0?new QS(Rt,nt,st):new KS(Rt,nt,st));break}else{let Bt=mt.map[Rt];Bt===void 0&&(Bt=new ZS(Rt),lC(mt,Bt)),mt=Bt}}}var Iu=class{constructor(nt,st){this.seq=[],this.map={};let mt=nt.getProgramParameter(st,35718);for(let gt=0;gt<mt;++gt){let _t=nt.getActiveUniform(st,gt),Et=nt.getUniformLocation(st,_t.name);pG(_t,Et,this)}}setValue(nt,st,mt,gt){let _t=this.map[st];_t!==void 0&&_t.setValue(nt,mt,gt)}setOptional(nt,st,mt){let gt=st[mt];gt!==void 0&&this.setValue(nt,mt,gt)}static upload(nt,st,mt,gt){for(let _t=0,Et=st.length;_t!==Et;++_t){let At=st[_t],Rt=mt[At.id];Rt.needsUpdate!==!1&&At.setValue(nt,Rt.value,gt)}}static seqWithValue(nt,st){let mt=[];for(let gt=0,_t=nt.length;gt!==_t;++gt){let Et=nt[gt];Et.id in st&&mt.push(Et)}return mt}};function cC(nt,st,mt){let gt=nt.createShader(st);return nt.shaderSource(gt,mt),nt.compileShader(gt),gt}var mG=0;function gG(nt,st){let mt=nt.split(`
`),gt=[],_t=Math.max(st-6,0),Et=Math.min(st+6,mt.length);for(let At=_t;At<Et;At++){let Rt=At+1;gt.push(`${Rt===st?">":" "} ${Rt}: ${mt[At]}`)}return gt.join(`
`)}function yG(nt){switch(nt){case mn:return["Linear","( value )"];case at$1:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",nt),["Linear","( value )"]}}function uC(nt,st,mt){let gt=nt.getShaderParameter(st,35713),_t=nt.getShaderInfoLog(st).trim();if(gt&&_t==="")return"";let Et=/ERROR: 0:(\d+)/.exec(_t);if(Et){let At=parseInt(Et[1]);return mt.toUpperCase()+`

`+_t+`

`+gG(nt.getShaderSource(st),At)}else return _t}function vG(nt,st){let mt=yG(st);return"vec4 "+nt+"( vec4 value ) { return LinearTo"+mt[0]+mt[1]+"; }"}function xG(nt,st){let mt;switch(st){case RF:mt="Linear";break;case LF:mt="Reinhard";break;case BF:mt="OptimizedCineon";break;case NF:mt="ACESFilmic";break;case FF:mt="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",st),mt="Linear"}return"vec3 "+nt+"( vec3 color ) { return "+mt+"ToneMapping( color ); }"}function bG(nt){return[nt.extensionDerivatives||nt.envMapCubeUVHeight||nt.bumpMap||nt.tangentSpaceNormalMap||nt.clearcoatNormalMap||nt.flatShading||nt.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(nt.extensionFragDepth||nt.logarithmicDepthBuffer)&&nt.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",nt.extensionDrawBuffers&&nt.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(nt.extensionShaderTextureLOD||nt.envMap||nt.transmission)&&nt.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter($f).join(`
`)}function SG(nt){let st=[];for(let mt in nt){let gt=nt[mt];gt!==!1&&st.push("#define "+mt+" "+gt)}return st.join(`
`)}function wG(nt,st){let mt={},gt=nt.getProgramParameter(st,35721);for(let _t=0;_t<gt;_t++){let Et=nt.getActiveAttrib(st,_t),At=Et.name,Rt=1;Et.type===35674&&(Rt=2),Et.type===35675&&(Rt=3),Et.type===35676&&(Rt=4),mt[At]={type:Et.type,location:nt.getAttribLocation(st,At),locationSize:Rt}}return mt}function $f(nt){return nt!==""}function hC(nt,st){let mt=st.numSpotLightShadows+st.numSpotLightMaps-st.numSpotLightShadowsWithMaps;return nt.replace(/NUM_DIR_LIGHTS/g,st.numDirLights).replace(/NUM_SPOT_LIGHTS/g,st.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,st.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,mt).replace(/NUM_RECT_AREA_LIGHTS/g,st.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,st.numPointLights).replace(/NUM_HEMI_LIGHTS/g,st.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,st.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,st.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,st.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,st.numPointLightShadows)}function dC(nt,st){return nt.replace(/NUM_CLIPPING_PLANES/g,st.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,st.numClippingPlanes-st.numClipIntersection)}var AG=/^[ \t]*#include +<([\w\d./]+)>/gm;function JS(nt){return nt.replace(AG,EG)}function EG(nt,st){let mt=xt[st];if(mt===void 0)throw new Error("Can not resolve #include <"+st+">");return JS(mt)}var MG=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function fC(nt){return nt.replace(MG,TG)}function TG(nt,st,mt,gt){let _t="";for(let Et=parseInt(st);Et<parseInt(mt);Et++)_t+=gt.replace(/\[\s*i\s*\]/g,"[ "+Et+" ]").replace(/UNROLLED_LOOP_INDEX/g,Et);return _t}function pC(nt){let st="precision "+nt.precision+` float;
precision `+nt.precision+" int;";return nt.precision==="highp"?st+=`
#define HIGH_PRECISION`:nt.precision==="mediump"?st+=`
#define MEDIUM_PRECISION`:nt.precision==="lowp"&&(st+=`
#define LOW_PRECISION`),st}function CG(nt){let st="SHADOWMAP_TYPE_BASIC";return nt.shadowMapType===Ay?st="SHADOWMAP_TYPE_PCF":nt.shadowMapType===hF?st="SHADOWMAP_TYPE_PCF_SOFT":nt.shadowMapType===Jf&&(st="SHADOWMAP_TYPE_VSM"),st}function PG(nt){let st="ENVMAP_TYPE_CUBE";if(nt.envMap)switch(nt.envMapMode){case Qa:case Ka:st="ENVMAP_TYPE_CUBE";break;case Zu:st="ENVMAP_TYPE_CUBE_UV";break}return st}function _G(nt){let st="ENVMAP_MODE_REFLECTION";if(nt.envMap)switch(nt.envMapMode){case Ka:st="ENVMAP_MODE_REFRACTION";break}return st}function DG(nt){let st="ENVMAP_BLENDING_NONE";if(nt.envMap)switch(nt.combine){case jC:st="ENVMAP_BLENDING_MULTIPLY";break;case IF:st="ENVMAP_BLENDING_MIX";break;case OF:st="ENVMAP_BLENDING_ADD";break}return st}function IG(nt){let st=nt.envMapCubeUVHeight;if(st===null)return null;let mt=Math.log2(st)-2,gt=1/st;return{texelWidth:1/(3*Math.max(Math.pow(2,mt),7*16)),texelHeight:gt,maxMip:mt}}function OG(nt,st,mt,gt){let _t=nt.getContext(),Et=mt.defines,At=mt.vertexShader,Rt=mt.fragmentShader,Ft=CG(mt),Nt=PG(mt),Bt=_G(mt),Gt=DG(mt),dr=IG(mt),Mr=mt.isWebGL2?"":bG(mt),Tr=SG(Et),zr=_t.createProgram(),Fr,Nr,tn=mt.glslVersion?"#version "+mt.glslVersion+`
`:"";mt.isRawShaderMaterial?(Fr=[Tr].filter($f).join(`
`),Fr.length>0&&(Fr+=`
`),Nr=[Mr,Tr].filter($f).join(`
`),Nr.length>0&&(Nr+=`
`)):(Fr=[pC(mt),"#define SHADER_NAME "+mt.shaderName,Tr,mt.instancing?"#define USE_INSTANCING":"",mt.instancingColor?"#define USE_INSTANCING_COLOR":"",mt.supportsVertexTextures?"#define VERTEX_TEXTURES":"",mt.useFog&&mt.fog?"#define USE_FOG":"",mt.useFog&&mt.fogExp2?"#define FOG_EXP2":"",mt.map?"#define USE_MAP":"",mt.envMap?"#define USE_ENVMAP":"",mt.envMap?"#define "+Bt:"",mt.lightMap?"#define USE_LIGHTMAP":"",mt.aoMap?"#define USE_AOMAP":"",mt.emissiveMap?"#define USE_EMISSIVEMAP":"",mt.bumpMap?"#define USE_BUMPMAP":"",mt.normalMap?"#define USE_NORMALMAP":"",mt.normalMap&&mt.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",mt.normalMap&&mt.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",mt.clearcoatMap?"#define USE_CLEARCOATMAP":"",mt.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",mt.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",mt.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",mt.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",mt.displacementMap&&mt.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",mt.specularMap?"#define USE_SPECULARMAP":"",mt.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",mt.specularColorMap?"#define USE_SPECULARCOLORMAP":"",mt.roughnessMap?"#define USE_ROUGHNESSMAP":"",mt.metalnessMap?"#define USE_METALNESSMAP":"",mt.alphaMap?"#define USE_ALPHAMAP":"",mt.transmission?"#define USE_TRANSMISSION":"",mt.transmissionMap?"#define USE_TRANSMISSIONMAP":"",mt.thicknessMap?"#define USE_THICKNESSMAP":"",mt.sheenColorMap?"#define USE_SHEENCOLORMAP":"",mt.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",mt.vertexTangents?"#define USE_TANGENT":"",mt.vertexColors?"#define USE_COLOR":"",mt.vertexAlphas?"#define USE_COLOR_ALPHA":"",mt.vertexUvs?"#define USE_UV":"",mt.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",mt.flatShading?"#define FLAT_SHADED":"",mt.skinning?"#define USE_SKINNING":"",mt.morphTargets?"#define USE_MORPHTARGETS":"",mt.morphNormals&&mt.flatShading===!1?"#define USE_MORPHNORMALS":"",mt.morphColors&&mt.isWebGL2?"#define USE_MORPHCOLORS":"",mt.morphTargetsCount>0&&mt.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",mt.morphTargetsCount>0&&mt.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+mt.morphTextureStride:"",mt.morphTargetsCount>0&&mt.isWebGL2?"#define MORPHTARGETS_COUNT "+mt.morphTargetsCount:"",mt.doubleSided?"#define DOUBLE_SIDED":"",mt.flipSided?"#define FLIP_SIDED":"",mt.shadowMapEnabled?"#define USE_SHADOWMAP":"",mt.shadowMapEnabled?"#define "+Ft:"",mt.sizeAttenuation?"#define USE_SIZEATTENUATION":"",mt.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",mt.logarithmicDepthBuffer&&mt.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter($f).join(`
`),Nr=[Mr,pC(mt),"#define SHADER_NAME "+mt.shaderName,Tr,mt.useFog&&mt.fog?"#define USE_FOG":"",mt.useFog&&mt.fogExp2?"#define FOG_EXP2":"",mt.map?"#define USE_MAP":"",mt.matcap?"#define USE_MATCAP":"",mt.envMap?"#define USE_ENVMAP":"",mt.envMap?"#define "+Nt:"",mt.envMap?"#define "+Bt:"",mt.envMap?"#define "+Gt:"",dr?"#define CUBEUV_TEXEL_WIDTH "+dr.texelWidth:"",dr?"#define CUBEUV_TEXEL_HEIGHT "+dr.texelHeight:"",dr?"#define CUBEUV_MAX_MIP "+dr.maxMip+".0":"",mt.lightMap?"#define USE_LIGHTMAP":"",mt.aoMap?"#define USE_AOMAP":"",mt.emissiveMap?"#define USE_EMISSIVEMAP":"",mt.bumpMap?"#define USE_BUMPMAP":"",mt.normalMap?"#define USE_NORMALMAP":"",mt.normalMap&&mt.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",mt.normalMap&&mt.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",mt.clearcoat?"#define USE_CLEARCOAT":"",mt.clearcoatMap?"#define USE_CLEARCOATMAP":"",mt.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",mt.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",mt.iridescence?"#define USE_IRIDESCENCE":"",mt.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",mt.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",mt.specularMap?"#define USE_SPECULARMAP":"",mt.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",mt.specularColorMap?"#define USE_SPECULARCOLORMAP":"",mt.roughnessMap?"#define USE_ROUGHNESSMAP":"",mt.metalnessMap?"#define USE_METALNESSMAP":"",mt.alphaMap?"#define USE_ALPHAMAP":"",mt.alphaTest?"#define USE_ALPHATEST":"",mt.sheen?"#define USE_SHEEN":"",mt.sheenColorMap?"#define USE_SHEENCOLORMAP":"",mt.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",mt.transmission?"#define USE_TRANSMISSION":"",mt.transmissionMap?"#define USE_TRANSMISSIONMAP":"",mt.thicknessMap?"#define USE_THICKNESSMAP":"",mt.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",mt.vertexTangents?"#define USE_TANGENT":"",mt.vertexColors||mt.instancingColor?"#define USE_COLOR":"",mt.vertexAlphas?"#define USE_COLOR_ALPHA":"",mt.vertexUvs?"#define USE_UV":"",mt.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",mt.gradientMap?"#define USE_GRADIENTMAP":"",mt.flatShading?"#define FLAT_SHADED":"",mt.doubleSided?"#define DOUBLE_SIDED":"",mt.flipSided?"#define FLIP_SIDED":"",mt.shadowMapEnabled?"#define USE_SHADOWMAP":"",mt.shadowMapEnabled?"#define "+Ft:"",mt.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",mt.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",mt.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",mt.logarithmicDepthBuffer&&mt.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",mt.toneMapping!==Is?"#define TONE_MAPPING":"",mt.toneMapping!==Is?xt.tonemapping_pars_fragment:"",mt.toneMapping!==Is?xG("toneMapping",mt.toneMapping):"",mt.dithering?"#define DITHERING":"",mt.opaque?"#define OPAQUE":"",xt.encodings_pars_fragment,vG("linearToOutputTexel",mt.outputEncoding),mt.useDepthPacking?"#define DEPTH_PACKING "+mt.depthPacking:"",`
`].filter($f).join(`
`)),At=JS(At),At=hC(At,mt),At=dC(At,mt),Rt=JS(Rt),Rt=hC(Rt,mt),Rt=dC(Rt,mt),At=fC(At),Rt=fC(Rt),mt.isWebGL2&&mt.isRawShaderMaterial!==!0&&(tn=`#version 300 es
`,Fr=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+Fr,Nr=["#define varying in",mt.glslVersion===UT?"":"layout(location = 0) out highp vec4 pc_fragColor;",mt.glslVersion===UT?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+Nr);let rn=tn+Fr+At,Tn=tn+Nr+Rt,$n=cC(_t,35633,rn),un=cC(_t,35632,Tn);if(_t.attachShader(zr,$n),_t.attachShader(zr,un),mt.index0AttributeName!==void 0?_t.bindAttribLocation(zr,0,mt.index0AttributeName):mt.morphTargets===!0&&_t.bindAttribLocation(zr,0,"position"),_t.linkProgram(zr),nt.debug.checkShaderErrors){let ts=_t.getProgramInfoLog(zr).trim(),Ko=_t.getShaderInfoLog($n).trim(),ds=_t.getShaderInfoLog(un).trim(),Il=!0,ru=!0;if(_t.getProgramParameter(zr,35714)===!1){Il=!1;let uu=uC(_t,$n,"vertex"),p0=uC(_t,un,"fragment");console.error("THREE.WebGLProgram: Shader Error "+_t.getError()+" - VALIDATE_STATUS "+_t.getProgramParameter(zr,35715)+`

Program Info Log: `+ts+`
`+uu+`
`+p0)}else ts!==""?console.warn("THREE.WebGLProgram: Program Info Log:",ts):(Ko===""||ds==="")&&(ru=!1);ru&&(this.diagnostics={runnable:Il,programLog:ts,vertexShader:{log:Ko,prefix:Fr},fragmentShader:{log:ds,prefix:Nr}})}_t.deleteShader($n),_t.deleteShader(un);let es;this.getUniforms=function(){return es===void 0&&(es=new Iu(_t,zr)),es};let kn;return this.getAttributes=function(){return kn===void 0&&(kn=wG(_t,zr)),kn},this.destroy=function(){gt.releaseStatesOfProgram(this),_t.deleteProgram(zr),this.program=void 0},this.name=mt.shaderName,this.id=mG++,this.cacheKey=st,this.usedTimes=1,this.program=zr,this.vertexShader=$n,this.fragmentShader=un,this}var RG=0,$S=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(nt){let st=nt.vertexShader,mt=nt.fragmentShader,gt=this._getShaderStage(st),_t=this._getShaderStage(mt),Et=this._getShaderCacheForMaterial(nt);return Et.has(gt)===!1&&(Et.add(gt),gt.usedTimes++),Et.has(_t)===!1&&(Et.add(_t),_t.usedTimes++),this}remove(nt){let st=this.materialCache.get(nt);for(let mt of st)mt.usedTimes--,mt.usedTimes===0&&this.shaderCache.delete(mt.code);return this.materialCache.delete(nt),this}getVertexShaderID(nt){return this._getShaderStage(nt.vertexShader).id}getFragmentShaderID(nt){return this._getShaderStage(nt.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(nt){let st=this.materialCache,mt=st.get(nt);return mt===void 0&&(mt=new Set,st.set(nt,mt)),mt}_getShaderStage(nt){let st=this.shaderCache,mt=st.get(nt);return mt===void 0&&(mt=new ew(nt),st.set(nt,mt)),mt}},ew=class{constructor(nt){this.id=RG++,this.code=nt,this.usedTimes=0}};function LG(nt,st,mt,gt,_t,Et,At){let Rt=new lp,Ft=new $S,Nt=[],Bt=_t.isWebGL2,Gt=_t.logarithmicDepthBuffer,dr=_t.vertexTextures,Mr=_t.precision,Tr={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function zr(kn,ts,Ko,ds,Il){let ru=ds.fog,uu=Il.geometry,p0=kn.isMeshStandardMaterial?ds.environment:null,X1=(kn.isMeshStandardMaterial?mt:st).get(kn.envMap||p0),q0=X1&&X1.mapping===Zu?X1.image.height:null,W0=Tr[kn.type];kn.precision!==null&&(Mr=_t.getMaxPrecision(kn.precision),Mr!==kn.precision&&console.warn("THREE.WebGLProgram.getParameters:",kn.precision,"not supported, using",Mr,"instead."));let hu=uu.morphAttributes.position||uu.morphAttributes.normal||uu.morphAttributes.color,a1=hu!==void 0?hu.length:0,Vx=0;uu.morphAttributes.position!==void 0&&(Vx=1),uu.morphAttributes.normal!==void 0&&(Vx=2),uu.morphAttributes.color!==void 0&&(Vx=3);let t0,cu,lu,b0;if(W0){let o$=uo[W0];t0=o$.vertexShader,cu=o$.fragmentShader}else t0=kn.vertexShader,cu=kn.fragmentShader,Ft.update(kn),lu=Ft.getVertexShaderID(kn),b0=Ft.getFragmentShaderID(kn);let l1=nt.getRenderTarget(),LE=kn.alphaTest>0,eS=kn.clearcoat>0,SA=kn.iridescence>0;return{isWebGL2:Bt,shaderID:W0,shaderName:kn.type,vertexShader:t0,fragmentShader:cu,defines:kn.defines,customVertexShaderID:lu,customFragmentShaderID:b0,isRawShaderMaterial:kn.isRawShaderMaterial===!0,glslVersion:kn.glslVersion,precision:Mr,instancing:Il.isInstancedMesh===!0,instancingColor:Il.isInstancedMesh===!0&&Il.instanceColor!==null,supportsVertexTextures:dr,outputEncoding:l1===null?nt.outputEncoding:l1.isXRRenderTarget===!0?l1.texture.encoding:mn,map:!!kn.map,matcap:!!kn.matcap,envMap:!!X1,envMapMode:X1&&X1.mapping,envMapCubeUVHeight:q0,lightMap:!!kn.lightMap,aoMap:!!kn.aoMap,emissiveMap:!!kn.emissiveMap,bumpMap:!!kn.bumpMap,normalMap:!!kn.normalMap,objectSpaceNormalMap:kn.normalMapType===eV,tangentSpaceNormalMap:kn.normalMapType===$F,decodeVideoTexture:!!kn.map&&kn.map.isVideoTexture===!0&&kn.map.encoding===at$1,clearcoat:eS,clearcoatMap:eS&&!!kn.clearcoatMap,clearcoatRoughnessMap:eS&&!!kn.clearcoatRoughnessMap,clearcoatNormalMap:eS&&!!kn.clearcoatNormalMap,iridescence:SA,iridescenceMap:SA&&!!kn.iridescenceMap,iridescenceThicknessMap:SA&&!!kn.iridescenceThicknessMap,displacementMap:!!kn.displacementMap,roughnessMap:!!kn.roughnessMap,metalnessMap:!!kn.metalnessMap,specularMap:!!kn.specularMap,specularIntensityMap:!!kn.specularIntensityMap,specularColorMap:!!kn.specularColorMap,opaque:kn.transparent===!1&&kn.blending===Ya,alphaMap:!!kn.alphaMap,alphaTest:LE,gradientMap:!!kn.gradientMap,sheen:kn.sheen>0,sheenColorMap:!!kn.sheenColorMap,sheenRoughnessMap:!!kn.sheenRoughnessMap,transmission:kn.transmission>0,transmissionMap:!!kn.transmissionMap,thicknessMap:!!kn.thicknessMap,combine:kn.combine,vertexTangents:!!kn.normalMap&&!!uu.attributes.tangent,vertexColors:kn.vertexColors,vertexAlphas:kn.vertexColors===!0&&!!uu.attributes.color&&uu.attributes.color.itemSize===4,vertexUvs:!!kn.map||!!kn.bumpMap||!!kn.normalMap||!!kn.specularMap||!!kn.alphaMap||!!kn.emissiveMap||!!kn.roughnessMap||!!kn.metalnessMap||!!kn.clearcoatMap||!!kn.clearcoatRoughnessMap||!!kn.clearcoatNormalMap||!!kn.iridescenceMap||!!kn.iridescenceThicknessMap||!!kn.displacementMap||!!kn.transmissionMap||!!kn.thicknessMap||!!kn.specularIntensityMap||!!kn.specularColorMap||!!kn.sheenColorMap||!!kn.sheenRoughnessMap,uvsVertexOnly:!(kn.map||kn.bumpMap||kn.normalMap||kn.specularMap||kn.alphaMap||kn.emissiveMap||kn.roughnessMap||kn.metalnessMap||kn.clearcoatNormalMap||kn.iridescenceMap||kn.iridescenceThicknessMap||kn.transmission>0||kn.transmissionMap||kn.thicknessMap||kn.specularIntensityMap||kn.specularColorMap||kn.sheen>0||kn.sheenColorMap||kn.sheenRoughnessMap)&&!!kn.displacementMap,fog:!!ru,useFog:kn.fog===!0,fogExp2:ru&&ru.isFogExp2,flatShading:!!kn.flatShading,sizeAttenuation:kn.sizeAttenuation,logarithmicDepthBuffer:Gt,skinning:Il.isSkinnedMesh===!0,morphTargets:uu.morphAttributes.position!==void 0,morphNormals:uu.morphAttributes.normal!==void 0,morphColors:uu.morphAttributes.color!==void 0,morphTargetsCount:a1,morphTextureStride:Vx,numDirLights:ts.directional.length,numPointLights:ts.point.length,numSpotLights:ts.spot.length,numSpotLightMaps:ts.spotLightMap.length,numRectAreaLights:ts.rectArea.length,numHemiLights:ts.hemi.length,numDirLightShadows:ts.directionalShadowMap.length,numPointLightShadows:ts.pointShadowMap.length,numSpotLightShadows:ts.spotShadowMap.length,numSpotLightShadowsWithMaps:ts.numSpotLightShadowsWithMaps,numClippingPlanes:At.numPlanes,numClipIntersection:At.numIntersection,dithering:kn.dithering,shadowMapEnabled:nt.shadowMap.enabled&&Ko.length>0,shadowMapType:nt.shadowMap.type,toneMapping:kn.toneMapped?nt.toneMapping:Is,physicallyCorrectLights:nt.physicallyCorrectLights,premultipliedAlpha:kn.premultipliedAlpha,doubleSided:kn.side===fi,flipSided:kn.side===pi,useDepthPacking:!!kn.depthPacking,depthPacking:kn.depthPacking||0,index0AttributeName:kn.index0AttributeName,extensionDerivatives:kn.extensions&&kn.extensions.derivatives,extensionFragDepth:kn.extensions&&kn.extensions.fragDepth,extensionDrawBuffers:kn.extensions&&kn.extensions.drawBuffers,extensionShaderTextureLOD:kn.extensions&&kn.extensions.shaderTextureLOD,rendererExtensionFragDepth:Bt||gt.has("EXT_frag_depth"),rendererExtensionDrawBuffers:Bt||gt.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:Bt||gt.has("EXT_shader_texture_lod"),customProgramCacheKey:kn.customProgramCacheKey()}}function Fr(kn){let ts=[];if(kn.shaderID?ts.push(kn.shaderID):(ts.push(kn.customVertexShaderID),ts.push(kn.customFragmentShaderID)),kn.defines!==void 0)for(let Ko in kn.defines)ts.push(Ko),ts.push(kn.defines[Ko]);return kn.isRawShaderMaterial===!1&&(Nr(ts,kn),tn(ts,kn),ts.push(nt.outputEncoding)),ts.push(kn.customProgramCacheKey),ts.join()}function Nr(kn,ts){kn.push(ts.precision),kn.push(ts.outputEncoding),kn.push(ts.envMapMode),kn.push(ts.envMapCubeUVHeight),kn.push(ts.combine),kn.push(ts.vertexUvs),kn.push(ts.fogExp2),kn.push(ts.sizeAttenuation),kn.push(ts.morphTargetsCount),kn.push(ts.morphAttributeCount),kn.push(ts.numDirLights),kn.push(ts.numPointLights),kn.push(ts.numSpotLights),kn.push(ts.numSpotLightMaps),kn.push(ts.numHemiLights),kn.push(ts.numRectAreaLights),kn.push(ts.numDirLightShadows),kn.push(ts.numPointLightShadows),kn.push(ts.numSpotLightShadows),kn.push(ts.numSpotLightShadowsWithMaps),kn.push(ts.shadowMapType),kn.push(ts.toneMapping),kn.push(ts.numClippingPlanes),kn.push(ts.numClipIntersection),kn.push(ts.depthPacking)}function tn(kn,ts){Rt.disableAll(),ts.isWebGL2&&Rt.enable(0),ts.supportsVertexTextures&&Rt.enable(1),ts.instancing&&Rt.enable(2),ts.instancingColor&&Rt.enable(3),ts.map&&Rt.enable(4),ts.matcap&&Rt.enable(5),ts.envMap&&Rt.enable(6),ts.lightMap&&Rt.enable(7),ts.aoMap&&Rt.enable(8),ts.emissiveMap&&Rt.enable(9),ts.bumpMap&&Rt.enable(10),ts.normalMap&&Rt.enable(11),ts.objectSpaceNormalMap&&Rt.enable(12),ts.tangentSpaceNormalMap&&Rt.enable(13),ts.clearcoat&&Rt.enable(14),ts.clearcoatMap&&Rt.enable(15),ts.clearcoatRoughnessMap&&Rt.enable(16),ts.clearcoatNormalMap&&Rt.enable(17),ts.iridescence&&Rt.enable(18),ts.iridescenceMap&&Rt.enable(19),ts.iridescenceThicknessMap&&Rt.enable(20),ts.displacementMap&&Rt.enable(21),ts.specularMap&&Rt.enable(22),ts.roughnessMap&&Rt.enable(23),ts.metalnessMap&&Rt.enable(24),ts.gradientMap&&Rt.enable(25),ts.alphaMap&&Rt.enable(26),ts.alphaTest&&Rt.enable(27),ts.vertexColors&&Rt.enable(28),ts.vertexAlphas&&Rt.enable(29),ts.vertexUvs&&Rt.enable(30),ts.vertexTangents&&Rt.enable(31),ts.uvsVertexOnly&&Rt.enable(32),kn.push(Rt.mask),Rt.disableAll(),ts.fog&&Rt.enable(0),ts.useFog&&Rt.enable(1),ts.flatShading&&Rt.enable(2),ts.logarithmicDepthBuffer&&Rt.enable(3),ts.skinning&&Rt.enable(4),ts.morphTargets&&Rt.enable(5),ts.morphNormals&&Rt.enable(6),ts.morphColors&&Rt.enable(7),ts.premultipliedAlpha&&Rt.enable(8),ts.shadowMapEnabled&&Rt.enable(9),ts.physicallyCorrectLights&&Rt.enable(10),ts.doubleSided&&Rt.enable(11),ts.flipSided&&Rt.enable(12),ts.useDepthPacking&&Rt.enable(13),ts.dithering&&Rt.enable(14),ts.specularIntensityMap&&Rt.enable(15),ts.specularColorMap&&Rt.enable(16),ts.transmission&&Rt.enable(17),ts.transmissionMap&&Rt.enable(18),ts.thicknessMap&&Rt.enable(19),ts.sheen&&Rt.enable(20),ts.sheenColorMap&&Rt.enable(21),ts.sheenRoughnessMap&&Rt.enable(22),ts.decodeVideoTexture&&Rt.enable(23),ts.opaque&&Rt.enable(24),kn.push(Rt.mask)}function rn(kn){let ts=Tr[kn.type],Ko;if(ts){let ds=uo[ts];Ko=Bs.clone(ds.uniforms)}else Ko=kn.uniforms;return Ko}function Tn(kn,ts){let Ko;for(let ds=0,Il=Nt.length;ds<Il;ds++){let ru=Nt[ds];if(ru.cacheKey===ts){Ko=ru,++Ko.usedTimes;break}}return Ko===void 0&&(Ko=new OG(nt,ts,kn,Et),Nt.push(Ko)),Ko}function $n(kn){if(--kn.usedTimes===0){let ts=Nt.indexOf(kn);Nt[ts]=Nt[Nt.length-1],Nt.pop(),kn.destroy()}}function un(kn){Ft.remove(kn)}function es(){Ft.dispose()}return{getParameters:zr,getProgramCacheKey:Fr,getUniforms:rn,acquireProgram:Tn,releaseProgram:$n,releaseShaderCache:un,programs:Nt,dispose:es}}function BG(){let nt=new WeakMap;function st(Et){let At=nt.get(Et);return At===void 0&&(At={},nt.set(Et,At)),At}function mt(Et){nt.delete(Et)}function gt(Et,At,Rt){nt.get(Et)[At]=Rt}function _t(){nt=new WeakMap}return{get:st,remove:mt,update:gt,dispose:_t}}function NG(nt,st){return nt.groupOrder!==st.groupOrder?nt.groupOrder-st.groupOrder:nt.renderOrder!==st.renderOrder?nt.renderOrder-st.renderOrder:nt.material.id!==st.material.id?nt.material.id-st.material.id:nt.z!==st.z?nt.z-st.z:nt.id-st.id}function mC(nt,st){return nt.groupOrder!==st.groupOrder?nt.groupOrder-st.groupOrder:nt.renderOrder!==st.renderOrder?nt.renderOrder-st.renderOrder:nt.z!==st.z?st.z-nt.z:nt.id-st.id}function gC(){let nt=[],st=0,mt=[],gt=[],_t=[];function Et(){st=0,mt.length=0,gt.length=0,_t.length=0}function At(Gt,dr,Mr,Tr,zr,Fr){let Nr=nt[st];return Nr===void 0?(Nr={id:Gt.id,object:Gt,geometry:dr,material:Mr,groupOrder:Tr,renderOrder:Gt.renderOrder,z:zr,group:Fr},nt[st]=Nr):(Nr.id=Gt.id,Nr.object=Gt,Nr.geometry=dr,Nr.material=Mr,Nr.groupOrder=Tr,Nr.renderOrder=Gt.renderOrder,Nr.z=zr,Nr.group=Fr),st++,Nr}function Rt(Gt,dr,Mr,Tr,zr,Fr){let Nr=At(Gt,dr,Mr,Tr,zr,Fr);Mr.transmission>0?gt.push(Nr):Mr.transparent===!0?_t.push(Nr):mt.push(Nr)}function Ft(Gt,dr,Mr,Tr,zr,Fr){let Nr=At(Gt,dr,Mr,Tr,zr,Fr);Mr.transmission>0?gt.unshift(Nr):Mr.transparent===!0?_t.unshift(Nr):mt.unshift(Nr)}function Nt(Gt,dr){mt.length>1&&mt.sort(Gt||NG),gt.length>1&&gt.sort(dr||mC),_t.length>1&&_t.sort(dr||mC)}function Bt(){for(let Gt=st,dr=nt.length;Gt<dr;Gt++){let Mr=nt[Gt];if(Mr.id===null)break;Mr.id=null,Mr.object=null,Mr.geometry=null,Mr.material=null,Mr.group=null}}return{opaque:mt,transmissive:gt,transparent:_t,init:Et,push:Rt,unshift:Ft,finish:Bt,sort:Nt}}function FG(){let nt=new WeakMap;function st(gt,_t){let Et=nt.get(gt),At;return Et===void 0?(At=new gC,nt.set(gt,[At])):_t>=Et.length?(At=new gC,Et.push(At)):At=Et[_t],At}function mt(){nt=new WeakMap}return{get:st,dispose:mt}}function VG(){let nt={};return{get:function(st){if(nt[st.id]!==void 0)return nt[st.id];let mt;switch(st.type){case"DirectionalLight":mt={direction:new E$6,color:new We$1};break;case"SpotLight":mt={position:new E$6,direction:new E$6,color:new We$1,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":mt={position:new E$6,color:new We$1,distance:0,decay:0};break;case"HemisphereLight":mt={direction:new E$6,skyColor:new We$1,groundColor:new We$1};break;case"RectAreaLight":mt={color:new We$1,position:new E$6,halfWidth:new E$6,halfHeight:new E$6};break}return nt[st.id]=mt,mt}}}function UG(){let nt={};return{get:function(st){if(nt[st.id]!==void 0)return nt[st.id];let mt;switch(st.type){case"DirectionalLight":mt={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new U$1};break;case"SpotLight":mt={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new U$1};break;case"PointLight":mt={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new U$1,shadowCameraNear:1,shadowCameraFar:1e3};break}return nt[st.id]=mt,mt}}}var zG=0;function kG(nt,st){return(st.castShadow?2:0)-(nt.castShadow?2:0)+(st.map?1:0)-(nt.map?1:0)}function GG(nt,st){let mt=new VG,gt=UG(),_t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let Bt=0;Bt<9;Bt++)_t.probe.push(new E$6);let Et=new E$6,At=new ue$1,Rt=new ue$1;function Ft(Bt,Gt){let dr=0,Mr=0,Tr=0;for(let ds=0;ds<9;ds++)_t.probe[ds].set(0,0,0);let zr=0,Fr=0,Nr=0,tn=0,rn=0,Tn=0,$n=0,un=0,es=0,kn=0;Bt.sort(kG);let ts=Gt!==!0?Math.PI:1;for(let ds=0,Il=Bt.length;ds<Il;ds++){let ru=Bt[ds],uu=ru.color,p0=ru.intensity,X1=ru.distance,q0=ru.shadow&&ru.shadow.map?ru.shadow.map.texture:null;if(ru.isAmbientLight)dr+=uu.r*p0*ts,Mr+=uu.g*p0*ts,Tr+=uu.b*p0*ts;else if(ru.isLightProbe)for(let W0=0;W0<9;W0++)_t.probe[W0].addScaledVector(ru.sh.coefficients[W0],p0);else if(ru.isDirectionalLight){let W0=mt.get(ru);if(W0.color.copy(ru.color).multiplyScalar(ru.intensity*ts),ru.castShadow){let hu=ru.shadow,a1=gt.get(ru);a1.shadowBias=hu.bias,a1.shadowNormalBias=hu.normalBias,a1.shadowRadius=hu.radius,a1.shadowMapSize=hu.mapSize,_t.directionalShadow[zr]=a1,_t.directionalShadowMap[zr]=q0,_t.directionalShadowMatrix[zr]=ru.shadow.matrix,Tn++}_t.directional[zr]=W0,zr++}else if(ru.isSpotLight){let W0=mt.get(ru);W0.position.setFromMatrixPosition(ru.matrixWorld),W0.color.copy(uu).multiplyScalar(p0*ts),W0.distance=X1,W0.coneCos=Math.cos(ru.angle),W0.penumbraCos=Math.cos(ru.angle*(1-ru.penumbra)),W0.decay=ru.decay,_t.spot[Nr]=W0;let hu=ru.shadow;if(ru.map&&(_t.spotLightMap[es]=ru.map,es++,hu.updateMatrices(ru),ru.castShadow&&kn++),_t.spotLightMatrix[Nr]=hu.matrix,ru.castShadow){let a1=gt.get(ru);a1.shadowBias=hu.bias,a1.shadowNormalBias=hu.normalBias,a1.shadowRadius=hu.radius,a1.shadowMapSize=hu.mapSize,_t.spotShadow[Nr]=a1,_t.spotShadowMap[Nr]=q0,un++}Nr++}else if(ru.isRectAreaLight){let W0=mt.get(ru);W0.color.copy(uu).multiplyScalar(p0),W0.halfWidth.set(ru.width*.5,0,0),W0.halfHeight.set(0,ru.height*.5,0),_t.rectArea[tn]=W0,tn++}else if(ru.isPointLight){let W0=mt.get(ru);if(W0.color.copy(ru.color).multiplyScalar(ru.intensity*ts),W0.distance=ru.distance,W0.decay=ru.decay,ru.castShadow){let hu=ru.shadow,a1=gt.get(ru);a1.shadowBias=hu.bias,a1.shadowNormalBias=hu.normalBias,a1.shadowRadius=hu.radius,a1.shadowMapSize=hu.mapSize,a1.shadowCameraNear=hu.camera.near,a1.shadowCameraFar=hu.camera.far,_t.pointShadow[Fr]=a1,_t.pointShadowMap[Fr]=q0,_t.pointShadowMatrix[Fr]=ru.shadow.matrix,$n++}_t.point[Fr]=W0,Fr++}else if(ru.isHemisphereLight){let W0=mt.get(ru);W0.skyColor.copy(ru.color).multiplyScalar(p0*ts),W0.groundColor.copy(ru.groundColor).multiplyScalar(p0*ts),_t.hemi[rn]=W0,rn++}}tn>0&&(st.isWebGL2||nt.has("OES_texture_float_linear")===!0?(_t.rectAreaLTC1=De$1.LTC_FLOAT_1,_t.rectAreaLTC2=De$1.LTC_FLOAT_2):nt.has("OES_texture_half_float_linear")===!0?(_t.rectAreaLTC1=De$1.LTC_HALF_1,_t.rectAreaLTC2=De$1.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),_t.ambient[0]=dr,_t.ambient[1]=Mr,_t.ambient[2]=Tr;let Ko=_t.hash;(Ko.directionalLength!==zr||Ko.pointLength!==Fr||Ko.spotLength!==Nr||Ko.rectAreaLength!==tn||Ko.hemiLength!==rn||Ko.numDirectionalShadows!==Tn||Ko.numPointShadows!==$n||Ko.numSpotShadows!==un||Ko.numSpotMaps!==es)&&(_t.directional.length=zr,_t.spot.length=Nr,_t.rectArea.length=tn,_t.point.length=Fr,_t.hemi.length=rn,_t.directionalShadow.length=Tn,_t.directionalShadowMap.length=Tn,_t.pointShadow.length=$n,_t.pointShadowMap.length=$n,_t.spotShadow.length=un,_t.spotShadowMap.length=un,_t.directionalShadowMatrix.length=Tn,_t.pointShadowMatrix.length=$n,_t.spotLightMatrix.length=un+es-kn,_t.spotLightMap.length=es,_t.numSpotLightShadowsWithMaps=kn,Ko.directionalLength=zr,Ko.pointLength=Fr,Ko.spotLength=Nr,Ko.rectAreaLength=tn,Ko.hemiLength=rn,Ko.numDirectionalShadows=Tn,Ko.numPointShadows=$n,Ko.numSpotShadows=un,Ko.numSpotMaps=es,_t.version=zG++)}function Nt(Bt,Gt){let dr=0,Mr=0,Tr=0,zr=0,Fr=0,Nr=Gt.matrixWorldInverse;for(let tn=0,rn=Bt.length;tn<rn;tn++){let Tn=Bt[tn];if(Tn.isDirectionalLight){let $n=_t.directional[dr];$n.direction.setFromMatrixPosition(Tn.matrixWorld),Et.setFromMatrixPosition(Tn.target.matrixWorld),$n.direction.sub(Et),$n.direction.transformDirection(Nr),dr++}else if(Tn.isSpotLight){let $n=_t.spot[Tr];$n.position.setFromMatrixPosition(Tn.matrixWorld),$n.position.applyMatrix4(Nr),$n.direction.setFromMatrixPosition(Tn.matrixWorld),Et.setFromMatrixPosition(Tn.target.matrixWorld),$n.direction.sub(Et),$n.direction.transformDirection(Nr),Tr++}else if(Tn.isRectAreaLight){let $n=_t.rectArea[zr];$n.position.setFromMatrixPosition(Tn.matrixWorld),$n.position.applyMatrix4(Nr),Rt.identity(),At.copy(Tn.matrixWorld),At.premultiply(Nr),Rt.extractRotation(At),$n.halfWidth.set(Tn.width*.5,0,0),$n.halfHeight.set(0,Tn.height*.5,0),$n.halfWidth.applyMatrix4(Rt),$n.halfHeight.applyMatrix4(Rt),zr++}else if(Tn.isPointLight){let $n=_t.point[Mr];$n.position.setFromMatrixPosition(Tn.matrixWorld),$n.position.applyMatrix4(Nr),Mr++}else if(Tn.isHemisphereLight){let $n=_t.hemi[Fr];$n.direction.setFromMatrixPosition(Tn.matrixWorld),$n.direction.transformDirection(Nr),Fr++}}}return{setup:Ft,setupView:Nt,state:_t}}function yC(nt,st){let mt=new GG(nt,st),gt=[],_t=[];function Et(){gt.length=0,_t.length=0}function At(Bt){gt.push(Bt)}function Rt(Bt){_t.push(Bt)}function Ft(Bt){mt.setup(gt,Bt)}function Nt(Bt){mt.setupView(gt,Bt)}return{init:Et,state:{lightsArray:gt,shadowsArray:_t,lights:mt},setupLights:Ft,setupLightsView:Nt,pushLight:At,pushShadow:Rt}}function jG(nt,st){let mt=new WeakMap;function gt(Et,At=0){let Rt=mt.get(Et),Ft;return Rt===void 0?(Ft=new yC(nt,st),mt.set(Et,[Ft])):At>=Rt.length?(Ft=new yC(nt,st),Rt.push(Ft)):Ft=Rt[At],Ft}function _t(){mt=new WeakMap}return{get:gt,dispose:_t}}var up=class extends fc{constructor(nt){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Bi,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(nt)}copy(nt){return super.copy(nt),this.depthPacking=nt.depthPacking,this.map=nt.map,this.alphaMap=nt.alphaMap,this.displacementMap=nt.displacementMap,this.displacementScale=nt.displacementScale,this.displacementBias=nt.displacementBias,this.wireframe=nt.wireframe,this.wireframeLinewidth=nt.wireframeLinewidth,this}},tw=class extends fc{constructor(nt){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new E$6,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(nt)}copy(nt){return super.copy(nt),this.referencePosition.copy(nt.referencePosition),this.nearDistance=nt.nearDistance,this.farDistance=nt.farDistance,this.map=nt.map,this.alphaMap=nt.alphaMap,this.displacementMap=nt.displacementMap,this.displacementScale=nt.displacementScale,this.displacementBias=nt.displacementBias,this}},HG=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,WG=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function qG(nt,st,mt){let gt=new cp,_t=new U$1,Et=new U$1,At=new Ze$1,Rt=new up({depthPacking:Tw}),Ft=new tw,Nt={},Bt=mt.maxTextureSize,Gt={[Hn]:pi,[pi]:Hn,[fi]:fi},dr=new it$1({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new U$1},radius:{value:4}},vertexShader:HG,fragmentShader:WG}),Mr=dr.clone();Mr.defines.HORIZONTAL_PASS=1;let Tr=new _e$1;Tr.setAttribute("position",new Xe$1(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let zr=new Ut(Tr,dr),Fr=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Ay,this.render=function(Tn,$n,un){if(Fr.enabled===!1||Fr.autoUpdate===!1&&Fr.needsUpdate===!1||Tn.length===0)return;let es=nt.getRenderTarget(),kn=nt.getActiveCubeFace(),ts=nt.getActiveMipmapLevel(),Ko=nt.state;Ko.setBlending(Jt),Ko.buffers.color.setClear(1,1,1,1),Ko.buffers.depth.setTest(!0),Ko.setScissorTest(!1);for(let ds=0,Il=Tn.length;ds<Il;ds++){let ru=Tn[ds],uu=ru.shadow;if(uu===void 0){console.warn("THREE.WebGLShadowMap:",ru,"has no shadow.");continue}if(uu.autoUpdate===!1&&uu.needsUpdate===!1)continue;_t.copy(uu.mapSize);let p0=uu.getFrameExtents();if(_t.multiply(p0),Et.copy(uu.mapSize),(_t.x>Bt||_t.y>Bt)&&(_t.x>Bt&&(Et.x=Math.floor(Bt/p0.x),_t.x=Et.x*p0.x,uu.mapSize.x=Et.x),_t.y>Bt&&(Et.y=Math.floor(Bt/p0.y),_t.y=Et.y*p0.y,uu.mapSize.y=Et.y)),uu.map===null){let q0=this.type!==Jf?{minFilter:Vt,magFilter:Vt}:{};uu.map=new dt$1(_t.x,_t.y,q0),uu.map.texture.name=ru.name+".shadowMap",uu.camera.updateProjectionMatrix()}nt.setRenderTarget(uu.map),nt.clear();let X1=uu.getViewportCount();for(let q0=0;q0<X1;q0++){let W0=uu.getViewport(q0);At.set(Et.x*W0.x,Et.y*W0.y,Et.x*W0.z,Et.y*W0.w),Ko.viewport(At),uu.updateMatrices(ru,q0),gt=uu.getFrustum(),rn($n,un,uu.camera,ru,this.type)}uu.isPointLightShadow!==!0&&this.type===Jf&&Nr(uu,un),uu.needsUpdate=!1}Fr.needsUpdate=!1,nt.setRenderTarget(es,kn,ts)};function Nr(Tn,$n){let un=st.update(zr);dr.defines.VSM_SAMPLES!==Tn.blurSamples&&(dr.defines.VSM_SAMPLES=Tn.blurSamples,Mr.defines.VSM_SAMPLES=Tn.blurSamples,dr.needsUpdate=!0,Mr.needsUpdate=!0),Tn.mapPass===null&&(Tn.mapPass=new dt$1(_t.x,_t.y)),dr.uniforms.shadow_pass.value=Tn.map.texture,dr.uniforms.resolution.value=Tn.mapSize,dr.uniforms.radius.value=Tn.radius,nt.setRenderTarget(Tn.mapPass),nt.clear(),nt.renderBufferDirect($n,null,un,dr,zr,null),Mr.uniforms.shadow_pass.value=Tn.mapPass.texture,Mr.uniforms.resolution.value=Tn.mapSize,Mr.uniforms.radius.value=Tn.radius,nt.setRenderTarget(Tn.map),nt.clear(),nt.renderBufferDirect($n,null,un,Mr,zr,null)}function tn(Tn,$n,un,es,kn,ts){let Ko=null,ds=un.isPointLight===!0?Tn.customDistanceMaterial:Tn.customDepthMaterial;if(ds!==void 0)Ko=ds;else if(Ko=un.isPointLight===!0?Ft:Rt,nt.localClippingEnabled&&$n.clipShadows===!0&&Array.isArray($n.clippingPlanes)&&$n.clippingPlanes.length!==0||$n.displacementMap&&$n.displacementScale!==0||$n.alphaMap&&$n.alphaTest>0||$n.map&&$n.alphaTest>0){let Il=Ko.uuid,ru=$n.uuid,uu=Nt[Il];uu===void 0&&(uu={},Nt[Il]=uu);let p0=uu[ru];p0===void 0&&(p0=Ko.clone(),uu[ru]=p0),Ko=p0}return Ko.visible=$n.visible,Ko.wireframe=$n.wireframe,ts===Jf?Ko.side=$n.shadowSide!==null?$n.shadowSide:$n.side:Ko.side=$n.shadowSide!==null?$n.shadowSide:Gt[$n.side],Ko.alphaMap=$n.alphaMap,Ko.alphaTest=$n.alphaTest,Ko.map=$n.map,Ko.clipShadows=$n.clipShadows,Ko.clippingPlanes=$n.clippingPlanes,Ko.clipIntersection=$n.clipIntersection,Ko.displacementMap=$n.displacementMap,Ko.displacementScale=$n.displacementScale,Ko.displacementBias=$n.displacementBias,Ko.wireframeLinewidth=$n.wireframeLinewidth,Ko.linewidth=$n.linewidth,un.isPointLight===!0&&Ko.isMeshDistanceMaterial===!0&&(Ko.referencePosition.setFromMatrixPosition(un.matrixWorld),Ko.nearDistance=es,Ko.farDistance=kn),Ko}function rn(Tn,$n,un,es,kn){if(Tn.visible===!1)return;if(Tn.layers.test($n.layers)&&(Tn.isMesh||Tn.isLine||Tn.isPoints)&&(Tn.castShadow||Tn.receiveShadow&&kn===Jf)&&(!Tn.frustumCulled||gt.intersectsObject(Tn))){Tn.modelViewMatrix.multiplyMatrices(un.matrixWorldInverse,Tn.matrixWorld);let Ko=st.update(Tn),ds=Tn.material;if(Array.isArray(ds)){let Il=Ko.groups;for(let ru=0,uu=Il.length;ru<uu;ru++){let p0=Il[ru],X1=ds[p0.materialIndex];if(X1&&X1.visible){let q0=tn(Tn,X1,es,un.near,un.far,kn);nt.renderBufferDirect(un,null,Ko,q0,Tn,p0)}}}else if(ds.visible){let Il=tn(Tn,ds,es,un.near,un.far,kn);nt.renderBufferDirect(un,null,Ko,Il,Tn,null)}}let ts=Tn.children;for(let Ko=0,ds=ts.length;Ko<ds;Ko++)rn(ts[Ko],$n,un,es,kn)}}function YG(nt,st,mt){let gt=mt.isWebGL2;function _t(){let w$=!1,B$=new Ze$1,r$=null,O$=new Ze$1(0,0,0,0);return{setMask:function(Z$){r$!==Z$&&!w$&&(nt.colorMask(Z$,Z$,Z$,Z$),r$=Z$)},setLocked:function(Z$){w$=Z$},setClear:function(Z$,mL,P7,L9,f$){f$===!0&&(Z$*=L9,mL*=L9,P7*=L9),B$.set(Z$,mL,P7,L9),O$.equals(B$)===!1&&(nt.clearColor(Z$,mL,P7,L9),O$.copy(B$))},reset:function(){w$=!1,r$=null,O$.set(-1,0,0,0)}}}function Et(){let w$=!1,B$=null,r$=null,O$=null;return{setTest:function(Z$){Z$?LE(2929):eS(2929)},setMask:function(Z$){B$!==Z$&&!w$&&(nt.depthMask(Z$),B$=Z$)},setFunc:function(Z$){if(r$!==Z$){switch(Z$){case EF:nt.depthFunc(512);break;case MF:nt.depthFunc(519);break;case TF:nt.depthFunc(513);break;case zS:nt.depthFunc(515);break;case CF:nt.depthFunc(514);break;case PF:nt.depthFunc(518);break;case _F:nt.depthFunc(516);break;case DF:nt.depthFunc(517);break;default:nt.depthFunc(515)}r$=Z$}},setLocked:function(Z$){w$=Z$},setClear:function(Z$){O$!==Z$&&(nt.clearDepth(Z$),O$=Z$)},reset:function(){w$=!1,B$=null,r$=null,O$=null}}}function At(){let w$=!1,B$=null,r$=null,O$=null,Z$=null,mL=null,P7=null,L9=null,f$=null;return{setTest:function(l$){w$||(l$?LE(2960):eS(2960))},setMask:function(l$){B$!==l$&&!w$&&(nt.stencilMask(l$),B$=l$)},setFunc:function(l$,T$,q$){(r$!==l$||O$!==T$||Z$!==q$)&&(nt.stencilFunc(l$,T$,q$),r$=l$,O$=T$,Z$=q$)},setOp:function(l$,T$,q$){(mL!==l$||P7!==T$||L9!==q$)&&(nt.stencilOp(l$,T$,q$),mL=l$,P7=T$,L9=q$)},setLocked:function(l$){w$=l$},setClear:function(l$){f$!==l$&&(nt.clearStencil(l$),f$=l$)},reset:function(){w$=!1,B$=null,r$=null,O$=null,Z$=null,mL=null,P7=null,L9=null,f$=null}}}let Rt=new _t,Ft=new Et,Nt=new At,Bt=new WeakMap,Gt=new WeakMap,dr={},Mr={},Tr=new WeakMap,zr=[],Fr=null,Nr=!1,tn=null,rn=null,Tn=null,$n=null,un=null,es=null,kn=null,ts=!1,Ko=null,ds=null,Il=null,ru=null,uu=null,p0=nt.getParameter(35661),X1=!1,q0=0,W0=nt.getParameter(7938);W0.indexOf("WebGL")!==-1?(q0=parseFloat(/^WebGL (\d)/.exec(W0)[1]),X1=q0>=1):W0.indexOf("OpenGL ES")!==-1&&(q0=parseFloat(/^OpenGL ES (\d)/.exec(W0)[1]),X1=q0>=2);let hu=null,a1={},Vx=nt.getParameter(3088),t0=nt.getParameter(2978),cu=new Ze$1().fromArray(Vx),lu=new Ze$1().fromArray(t0);function b0(w$,B$,r$){let O$=new Uint8Array(4),Z$=nt.createTexture();nt.bindTexture(w$,Z$),nt.texParameteri(w$,10241,9728),nt.texParameteri(w$,10240,9728);for(let mL=0;mL<r$;mL++)nt.texImage2D(B$+mL,0,6408,1,1,0,6408,5121,O$);return Z$}let l1={};l1[3553]=b0(3553,3553,1),l1[34067]=b0(34067,34069,6),Rt.setClear(0,0,0,1),Ft.setClear(1),Nt.setClear(0),LE(2929),Ft.setFunc(zS),x$(!1),v$(cT),LE(2884),R$(Jt);function LE(w$){dr[w$]!==!0&&(nt.enable(w$),dr[w$]=!0)}function eS(w$){dr[w$]!==!1&&(nt.disable(w$),dr[w$]=!1)}function SA(w$,B$){return Mr[w$]!==B$?(nt.bindFramebuffer(w$,B$),Mr[w$]=B$,gt&&(w$===36009&&(Mr[36160]=B$),w$===36160&&(Mr[36009]=B$)),!0):!1}function o$(w$,B$){let r$=zr,O$=!1;if(w$)if(r$=Tr.get(B$),r$===void 0&&(r$=[],Tr.set(B$,r$)),w$.isWebGLMultipleRenderTargets){let Z$=w$.texture;if(r$.length!==Z$.length||r$[0]!==36064){for(let mL=0,P7=Z$.length;mL<P7;mL++)r$[mL]=36064+mL;r$.length=Z$.length,O$=!0}}else r$[0]!==36064&&(r$[0]=36064,O$=!0);else r$[0]!==1029&&(r$[0]=1029,O$=!0);O$&&(mt.isWebGL2?nt.drawBuffers(r$):st.get("WEBGL_draw_buffers").drawBuffersWEBGL(r$))}function h$(w$){return Fr!==w$?(nt.useProgram(w$),Fr=w$,!0):!1}let d$={[Tu]:32774,[fF]:32778,[pF]:32779};if(gt)d$[fT]=32775,d$[pT]=32776;else{let w$=st.get("EXT_blend_minmax");w$!==null&&(d$[fT]=w$.MIN_EXT,d$[pT]=w$.MAX_EXT)}let y$={[mF]:0,[gF]:1,[yF]:768,[kC]:770,[AF]:776,[SF]:774,[xF]:772,[vF]:769,[GC]:771,[wF]:775,[bF]:773};function R$(w$,B$,r$,O$,Z$,mL,P7,L9){if(w$===Jt){Nr===!0&&(eS(3042),Nr=!1);return}if(Nr===!1&&(LE(3042),Nr=!0),w$!==dF){if(w$!==tn||L9!==ts){if((rn!==Tu||un!==Tu)&&(nt.blendEquation(32774),rn=Tu,un=Tu),L9)switch(w$){case Ya:nt.blendFuncSeparate(1,771,1,771);break;case uT:nt.blendFunc(1,1);break;case hT:nt.blendFuncSeparate(0,769,0,1);break;case dT:nt.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",w$);break}else switch(w$){case Ya:nt.blendFuncSeparate(770,771,1,771);break;case uT:nt.blendFunc(770,1);break;case hT:nt.blendFuncSeparate(0,769,0,1);break;case dT:nt.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",w$);break}Tn=null,$n=null,es=null,kn=null,tn=w$,ts=L9}return}Z$=Z$||B$,mL=mL||r$,P7=P7||O$,(B$!==rn||Z$!==un)&&(nt.blendEquationSeparate(d$[B$],d$[Z$]),rn=B$,un=Z$),(r$!==Tn||O$!==$n||mL!==es||P7!==kn)&&(nt.blendFuncSeparate(y$[r$],y$[O$],y$[mL],y$[P7]),Tn=r$,$n=O$,es=mL,kn=P7),tn=w$,ts=!1}function M$(w$,B$){w$.side===fi?eS(2884):LE(2884);let r$=w$.side===pi;B$&&(r$=!r$),x$(r$),w$.blending===Ya&&w$.transparent===!1?R$(Jt):R$(w$.blending,w$.blendEquation,w$.blendSrc,w$.blendDst,w$.blendEquationAlpha,w$.blendSrcAlpha,w$.blendDstAlpha,w$.premultipliedAlpha),Ft.setFunc(w$.depthFunc),Ft.setTest(w$.depthTest),Ft.setMask(w$.depthWrite),Rt.setMask(w$.colorWrite);let O$=w$.stencilWrite;Nt.setTest(O$),O$&&(Nt.setMask(w$.stencilWriteMask),Nt.setFunc(w$.stencilFunc,w$.stencilRef,w$.stencilFuncMask),Nt.setOp(w$.stencilFail,w$.stencilZFail,w$.stencilZPass)),wA(w$.polygonOffset,w$.polygonOffsetFactor,w$.polygonOffsetUnits),w$.alphaToCoverage===!0?LE(32926):eS(32926)}function x$(w$){Ko!==w$&&(w$?nt.frontFace(2304):nt.frontFace(2305),Ko=w$)}function v$(w$){w$!==cF?(LE(2884),w$!==ds&&(w$===cT?nt.cullFace(1029):w$===uF?nt.cullFace(1028):nt.cullFace(1032))):eS(2884),ds=w$}function rS(w$){w$!==Il&&(X1&&nt.lineWidth(w$),Il=w$)}function wA(w$,B$,r$){w$?(LE(32823),(ru!==B$||uu!==r$)&&(nt.polygonOffset(B$,r$),ru=B$,uu=r$)):eS(32823)}function g$(w$){w$?LE(3089):eS(3089)}function S$(w$){w$===void 0&&(w$=33984+p0-1),hu!==w$&&(nt.activeTexture(w$),hu=w$)}function tA(w$,B$,r$){r$===void 0&&(hu===null?r$=33984+p0-1:r$=hu);let O$=a1[r$];O$===void 0&&(O$={type:void 0,texture:void 0},a1[r$]=O$),(O$.type!==w$||O$.texture!==B$)&&(hu!==r$&&(nt.activeTexture(r$),hu=r$),nt.bindTexture(w$,B$||l1[w$]),O$.type=w$,O$.texture=B$)}function tS(){let w$=a1[hu];w$!==void 0&&w$.type!==void 0&&(nt.bindTexture(w$.type,null),w$.type=void 0,w$.texture=void 0)}function m$(){try{nt.compressedTexImage2D.apply(nt,arguments)}catch(w$){console.error("THREE.WebGLState:",w$)}}function u$(){try{nt.compressedTexImage3D.apply(nt,arguments)}catch(w$){console.error("THREE.WebGLState:",w$)}}function UE(){try{nt.texSubImage2D.apply(nt,arguments)}catch(w$){console.error("THREE.WebGLState:",w$)}}function F$(){try{nt.texSubImage3D.apply(nt,arguments)}catch(w$){console.error("THREE.WebGLState:",w$)}}function EI(){try{nt.compressedTexSubImage2D.apply(nt,arguments)}catch(w$){console.error("THREE.WebGLState:",w$)}}function pR(){try{nt.compressedTexSubImage3D.apply(nt,arguments)}catch(w$){console.error("THREE.WebGLState:",w$)}}function X$(){try{nt.texStorage2D.apply(nt,arguments)}catch(w$){console.error("THREE.WebGLState:",w$)}}function J$(){try{nt.texStorage3D.apply(nt,arguments)}catch(w$){console.error("THREE.WebGLState:",w$)}}function gD(){try{nt.texImage2D.apply(nt,arguments)}catch(w$){console.error("THREE.WebGLState:",w$)}}function fL(){try{nt.texImage3D.apply(nt,arguments)}catch(w$){console.error("THREE.WebGLState:",w$)}}function I7(w$){cu.equals(w$)===!1&&(nt.scissor(w$.x,w$.y,w$.z,w$.w),cu.copy(w$))}function j$(w$){lu.equals(w$)===!1&&(nt.viewport(w$.x,w$.y,w$.z,w$.w),lu.copy(w$))}function _$(w$,B$){let r$=Gt.get(B$);r$===void 0&&(r$=new WeakMap,Gt.set(B$,r$));let O$=r$.get(w$);O$===void 0&&(O$=nt.getUniformBlockIndex(B$,w$.name),r$.set(w$,O$))}function I$(w$,B$){let r$=Gt.get(B$).get(w$);Bt.get(B$)!==r$&&(nt.uniformBlockBinding(B$,r$,w$.__bindingPointIndex),Bt.set(B$,r$))}function GL(){nt.disable(3042),nt.disable(2884),nt.disable(2929),nt.disable(32823),nt.disable(3089),nt.disable(2960),nt.disable(32926),nt.blendEquation(32774),nt.blendFunc(1,0),nt.blendFuncSeparate(1,0,1,0),nt.colorMask(!0,!0,!0,!0),nt.clearColor(0,0,0,0),nt.depthMask(!0),nt.depthFunc(513),nt.clearDepth(1),nt.stencilMask(4294967295),nt.stencilFunc(519,0,4294967295),nt.stencilOp(7680,7680,7680),nt.clearStencil(0),nt.cullFace(1029),nt.frontFace(2305),nt.polygonOffset(0,0),nt.activeTexture(33984),nt.bindFramebuffer(36160,null),gt===!0&&(nt.bindFramebuffer(36009,null),nt.bindFramebuffer(36008,null)),nt.useProgram(null),nt.lineWidth(1),nt.scissor(0,0,nt.canvas.width,nt.canvas.height),nt.viewport(0,0,nt.canvas.width,nt.canvas.height),dr={},hu=null,a1={},Mr={},Tr=new WeakMap,zr=[],Fr=null,Nr=!1,tn=null,rn=null,Tn=null,$n=null,un=null,es=null,kn=null,ts=!1,Ko=null,ds=null,Il=null,ru=null,uu=null,cu.set(0,0,nt.canvas.width,nt.canvas.height),lu.set(0,0,nt.canvas.width,nt.canvas.height),Rt.reset(),Ft.reset(),Nt.reset()}return{buffers:{color:Rt,depth:Ft,stencil:Nt},enable:LE,disable:eS,bindFramebuffer:SA,drawBuffers:o$,useProgram:h$,setBlending:R$,setMaterial:M$,setFlipSided:x$,setCullFace:v$,setLineWidth:rS,setPolygonOffset:wA,setScissorTest:g$,activeTexture:S$,bindTexture:tA,unbindTexture:tS,compressedTexImage2D:m$,compressedTexImage3D:u$,texImage2D:gD,texImage3D:fL,updateUBOMapping:_$,uniformBlockBinding:I$,texStorage2D:X$,texStorage3D:J$,texSubImage2D:UE,texSubImage3D:F$,compressedTexSubImage2D:EI,compressedTexSubImage3D:pR,scissor:I7,viewport:j$,reset:GL}}function XG(nt,st,mt,gt,_t,Et,At){let Rt=_t.isWebGL2,Ft=_t.maxTextures,Nt=_t.maxCubemapSize,Bt=_t.maxTextureSize,Gt=_t.maxSamples,dr=st.has("WEBGL_multisampled_render_to_texture")?st.get("WEBGL_multisampled_render_to_texture"):null,Mr=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),Tr=new WeakMap,zr,Fr=new WeakMap,Nr=!1;try{Nr=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function tn(tA,tS){return Nr?new OffscreenCanvas(tA,tS):ap("canvas")}function rn(tA,tS,m$,u$){let UE=1;if((tA.width>u$||tA.height>u$)&&(UE=u$/Math.max(tA.width,tA.height)),UE<1||tS===!0)if(typeof HTMLImageElement<"u"&&tA instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&tA instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&tA instanceof ImageBitmap){let F$=tS?Zg:Math.floor,EI=F$(UE*tA.width),pR=F$(UE*tA.height);zr===void 0&&(zr=tn(EI,pR));let X$=m$?tn(EI,pR):zr;return X$.width=EI,X$.height=pR,X$.getContext("2d").drawImage(tA,0,0,EI,pR),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+tA.width+"x"+tA.height+") to ("+EI+"x"+pR+")."),X$}else return"data"in tA&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+tA.width+"x"+tA.height+")."),tA;return tA}function Tn(tA){return qS(tA.width)&&qS(tA.height)}function $n(tA){return Rt?!1:tA.wrapS!==Xt||tA.wrapT!==Xt||tA.minFilter!==Vt&&tA.minFilter!==rt$1}function un(tA,tS){return tA.generateMipmaps&&tS&&tA.minFilter!==Vt&&tA.minFilter!==rt$1}function es(tA){nt.generateMipmap(tA)}function kn(tA,tS,m$,u$,UE=!1){if(Rt===!1)return tS;if(tA!==null){if(nt[tA]!==void 0)return nt[tA];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+tA+"'")}let F$=tS;return tS===6403&&(m$===5126&&(F$=33326),m$===5131&&(F$=33325),m$===5121&&(F$=33321)),tS===33319&&(m$===5126&&(F$=33328),m$===5131&&(F$=33327),m$===5121&&(F$=33323)),tS===6408&&(m$===5126&&(F$=34836),m$===5131&&(F$=34842),m$===5121&&(F$=u$===at$1&&UE===!1?35907:32856),m$===32819&&(F$=32854),m$===32820&&(F$=32855)),(F$===33325||F$===33326||F$===33327||F$===33328||F$===34842||F$===34836)&&st.get("EXT_color_buffer_float"),F$}function ts(tA,tS,m$){return un(tA,m$)===!0||tA.isFramebufferTexture&&tA.minFilter!==Vt&&tA.minFilter!==rt$1?Math.log2(Math.max(tS.width,tS.height))+1:tA.mipmaps!==void 0&&tA.mipmaps.length>0?tA.mipmaps.length:tA.isCompressedTexture&&Array.isArray(tA.image)?tS.mipmaps.length:1}function Ko(tA){return tA===Vt||tA===mT||tA===iS?9728:9729}function ds(tA){let tS=tA.target;tS.removeEventListener("dispose",ds),ru(tS),tS.isVideoTexture&&Tr.delete(tS)}function Il(tA){let tS=tA.target;tS.removeEventListener("dispose",Il),p0(tS)}function ru(tA){let tS=gt.get(tA);if(tS.__webglInit===void 0)return;let m$=tA.source,u$=Fr.get(m$);if(u$){let UE=u$[tS.__cacheKey];UE.usedTimes--,UE.usedTimes===0&&uu(tA),Object.keys(u$).length===0&&Fr.delete(m$)}gt.remove(tA)}function uu(tA){let tS=gt.get(tA);nt.deleteTexture(tS.__webglTexture);let m$=tA.source,u$=Fr.get(m$);delete u$[tS.__cacheKey],At.memory.textures--}function p0(tA){let tS=tA.texture,m$=gt.get(tA),u$=gt.get(tS);if(u$.__webglTexture!==void 0&&(nt.deleteTexture(u$.__webglTexture),At.memory.textures--),tA.depthTexture&&tA.depthTexture.dispose(),tA.isWebGLCubeRenderTarget)for(let UE=0;UE<6;UE++)nt.deleteFramebuffer(m$.__webglFramebuffer[UE]),m$.__webglDepthbuffer&&nt.deleteRenderbuffer(m$.__webglDepthbuffer[UE]);else{if(nt.deleteFramebuffer(m$.__webglFramebuffer),m$.__webglDepthbuffer&&nt.deleteRenderbuffer(m$.__webglDepthbuffer),m$.__webglMultisampledFramebuffer&&nt.deleteFramebuffer(m$.__webglMultisampledFramebuffer),m$.__webglColorRenderbuffer)for(let UE=0;UE<m$.__webglColorRenderbuffer.length;UE++)m$.__webglColorRenderbuffer[UE]&&nt.deleteRenderbuffer(m$.__webglColorRenderbuffer[UE]);m$.__webglDepthRenderbuffer&&nt.deleteRenderbuffer(m$.__webglDepthRenderbuffer)}if(tA.isWebGLMultipleRenderTargets)for(let UE=0,F$=tS.length;UE<F$;UE++){let EI=gt.get(tS[UE]);EI.__webglTexture&&(nt.deleteTexture(EI.__webglTexture),At.memory.textures--),gt.remove(tS[UE])}gt.remove(tS),gt.remove(tA)}let X1=0;function q0(){X1=0}function W0(){let tA=X1;return tA>=Ft&&console.warn("THREE.WebGLTextures: Trying to use "+tA+" texture units while this GPU supports only "+Ft),X1+=1,tA}function hu(tA){let tS=[];return tS.push(tA.wrapS),tS.push(tA.wrapT),tS.push(tA.wrapR||0),tS.push(tA.magFilter),tS.push(tA.minFilter),tS.push(tA.anisotropy),tS.push(tA.internalFormat),tS.push(tA.format),tS.push(tA.type),tS.push(tA.generateMipmaps),tS.push(tA.premultiplyAlpha),tS.push(tA.flipY),tS.push(tA.unpackAlignment),tS.push(tA.encoding),tS.join()}function a1(tA,tS){let m$=gt.get(tA);if(tA.isVideoTexture&&g$(tA),tA.isRenderTargetTexture===!1&&tA.version>0&&m$.__version!==tA.version){let u$=tA.image;if(u$===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(u$.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{eS(m$,tA,tS);return}}mt.bindTexture(3553,m$.__webglTexture,33984+tS)}function Vx(tA,tS){let m$=gt.get(tA);if(tA.version>0&&m$.__version!==tA.version){eS(m$,tA,tS);return}mt.bindTexture(35866,m$.__webglTexture,33984+tS)}function t0(tA,tS){let m$=gt.get(tA);if(tA.version>0&&m$.__version!==tA.version){eS(m$,tA,tS);return}mt.bindTexture(32879,m$.__webglTexture,33984+tS)}function cu(tA,tS){let m$=gt.get(tA);if(tA.version>0&&m$.__version!==tA.version){SA(m$,tA,tS);return}mt.bindTexture(34067,m$.__webglTexture,33984+tS)}let lu={[Os]:10497,[Xt]:33071,[jS]:33648},b0={[Vt]:9728,[mT]:9984,[iS]:9986,[rt$1]:9729,[VF]:9985,[dc]:9987};function l1(tA,tS,m$){if(m$?(nt.texParameteri(tA,10242,lu[tS.wrapS]),nt.texParameteri(tA,10243,lu[tS.wrapT]),(tA===32879||tA===35866)&&nt.texParameteri(tA,32882,lu[tS.wrapR]),nt.texParameteri(tA,10240,b0[tS.magFilter]),nt.texParameteri(tA,10241,b0[tS.minFilter])):(nt.texParameteri(tA,10242,33071),nt.texParameteri(tA,10243,33071),(tA===32879||tA===35866)&&nt.texParameteri(tA,32882,33071),(tS.wrapS!==Xt||tS.wrapT!==Xt)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),nt.texParameteri(tA,10240,Ko(tS.magFilter)),nt.texParameteri(tA,10241,Ko(tS.minFilter)),tS.minFilter!==Vt&&tS.minFilter!==rt$1&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),st.has("EXT_texture_filter_anisotropic")===!0){let u$=st.get("EXT_texture_filter_anisotropic");if(tS.magFilter===Vt||tS.minFilter!==iS&&tS.minFilter!==dc||tS.type===br&&st.has("OES_texture_float_linear")===!1||Rt===!1&&tS.type===Wn&&st.has("OES_texture_half_float_linear")===!1)return;(tS.anisotropy>1||gt.get(tS).__currentAnisotropy)&&(nt.texParameterf(tA,u$.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(tS.anisotropy,_t.getMaxAnisotropy())),gt.get(tS).__currentAnisotropy=tS.anisotropy)}}function LE(tA,tS){let m$=!1;tA.__webglInit===void 0&&(tA.__webglInit=!0,tS.addEventListener("dispose",ds));let u$=tS.source,UE=Fr.get(u$);UE===void 0&&(UE={},Fr.set(u$,UE));let F$=hu(tS);if(F$!==tA.__cacheKey){UE[F$]===void 0&&(UE[F$]={texture:nt.createTexture(),usedTimes:0},At.memory.textures++,m$=!0),UE[F$].usedTimes++;let EI=UE[tA.__cacheKey];EI!==void 0&&(UE[tA.__cacheKey].usedTimes--,EI.usedTimes===0&&uu(tS)),tA.__cacheKey=F$,tA.__webglTexture=UE[F$].texture}return m$}function eS(tA,tS,m$){let u$=3553;(tS.isDataArrayTexture||tS.isCompressedArrayTexture)&&(u$=35866),tS.isData3DTexture&&(u$=32879);let UE=LE(tA,tS),F$=tS.source;mt.bindTexture(u$,tA.__webglTexture,33984+m$);let EI=gt.get(F$);if(F$.version!==EI.__version||UE===!0){mt.activeTexture(33984+m$),nt.pixelStorei(37440,tS.flipY),nt.pixelStorei(37441,tS.premultiplyAlpha),nt.pixelStorei(3317,tS.unpackAlignment),nt.pixelStorei(37443,0);let pR=$n(tS)&&Tn(tS.image)===!1,X$=rn(tS.image,pR,!1,Bt);X$=S$(tS,X$);let J$=Tn(X$)||Rt,gD=Et.convert(tS.format,tS.encoding),fL=Et.convert(tS.type),I7=kn(tS.internalFormat,gD,fL,tS.encoding,tS.isVideoTexture);l1(u$,tS,J$);let j$,_$=tS.mipmaps,I$=Rt&&tS.isVideoTexture!==!0,GL=EI.__version===void 0||UE===!0,w$=ts(tS,X$,J$);if(tS.isDepthTexture)I7=6402,Rt?tS.type===br?I7=36012:tS.type===Ds?I7=33190:tS.type===Xa?I7=35056:I7=33189:tS.type===br&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),tS.format===uc&&I7===6402&&tS.type!==WC&&tS.type!==Ds&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),tS.type=Ds,fL=Et.convert(tS.type)),tS.format===Za&&I7===6402&&(I7=34041,tS.type!==Xa&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),tS.type=Xa,fL=Et.convert(tS.type))),GL&&(I$?mt.texStorage2D(3553,1,I7,X$.width,X$.height):mt.texImage2D(3553,0,I7,X$.width,X$.height,0,gD,fL,null));else if(tS.isDataTexture)if(_$.length>0&&J$){I$&&GL&&mt.texStorage2D(3553,w$,I7,_$[0].width,_$[0].height);for(let B$=0,r$=_$.length;B$<r$;B$++)j$=_$[B$],I$?mt.texSubImage2D(3553,B$,0,0,j$.width,j$.height,gD,fL,j$.data):mt.texImage2D(3553,B$,I7,j$.width,j$.height,0,gD,fL,j$.data);tS.generateMipmaps=!1}else I$?(GL&&mt.texStorage2D(3553,w$,I7,X$.width,X$.height),mt.texSubImage2D(3553,0,0,0,X$.width,X$.height,gD,fL,X$.data)):mt.texImage2D(3553,0,I7,X$.width,X$.height,0,gD,fL,X$.data);else if(tS.isCompressedTexture)if(tS.isCompressedArrayTexture){I$&&GL&&mt.texStorage3D(35866,w$,I7,_$[0].width,_$[0].height,X$.depth);for(let B$=0,r$=_$.length;B$<r$;B$++)j$=_$[B$],tS.format!==qr?gD!==null?I$?mt.compressedTexSubImage3D(35866,B$,0,0,0,j$.width,j$.height,X$.depth,gD,j$.data,0,0):mt.compressedTexImage3D(35866,B$,I7,j$.width,j$.height,X$.depth,0,j$.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):I$?mt.texSubImage3D(35866,B$,0,0,0,j$.width,j$.height,X$.depth,gD,fL,j$.data):mt.texImage3D(35866,B$,I7,j$.width,j$.height,X$.depth,0,gD,fL,j$.data)}else{I$&&GL&&mt.texStorage2D(3553,w$,I7,_$[0].width,_$[0].height);for(let B$=0,r$=_$.length;B$<r$;B$++)j$=_$[B$],tS.format!==qr?gD!==null?I$?mt.compressedTexSubImage2D(3553,B$,0,0,j$.width,j$.height,gD,j$.data):mt.compressedTexImage2D(3553,B$,I7,j$.width,j$.height,0,j$.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):I$?mt.texSubImage2D(3553,B$,0,0,j$.width,j$.height,gD,fL,j$.data):mt.texImage2D(3553,B$,I7,j$.width,j$.height,0,gD,fL,j$.data)}else if(tS.isDataArrayTexture)I$?(GL&&mt.texStorage3D(35866,w$,I7,X$.width,X$.height,X$.depth),mt.texSubImage3D(35866,0,0,0,0,X$.width,X$.height,X$.depth,gD,fL,X$.data)):mt.texImage3D(35866,0,I7,X$.width,X$.height,X$.depth,0,gD,fL,X$.data);else if(tS.isData3DTexture)I$?(GL&&mt.texStorage3D(32879,w$,I7,X$.width,X$.height,X$.depth),mt.texSubImage3D(32879,0,0,0,0,X$.width,X$.height,X$.depth,gD,fL,X$.data)):mt.texImage3D(32879,0,I7,X$.width,X$.height,X$.depth,0,gD,fL,X$.data);else if(tS.isFramebufferTexture){if(GL)if(I$)mt.texStorage2D(3553,w$,I7,X$.width,X$.height);else{let B$=X$.width,r$=X$.height;for(let O$=0;O$<w$;O$++)mt.texImage2D(3553,O$,I7,B$,r$,0,gD,fL,null),B$>>=1,r$>>=1}}else if(_$.length>0&&J$){I$&&GL&&mt.texStorage2D(3553,w$,I7,_$[0].width,_$[0].height);for(let B$=0,r$=_$.length;B$<r$;B$++)j$=_$[B$],I$?mt.texSubImage2D(3553,B$,0,0,gD,fL,j$):mt.texImage2D(3553,B$,I7,gD,fL,j$);tS.generateMipmaps=!1}else I$?(GL&&mt.texStorage2D(3553,w$,I7,X$.width,X$.height),mt.texSubImage2D(3553,0,0,0,gD,fL,X$)):mt.texImage2D(3553,0,I7,gD,fL,X$);un(tS,J$)&&es(u$),EI.__version=F$.version,tS.onUpdate&&tS.onUpdate(tS)}tA.__version=tS.version}function SA(tA,tS,m$){if(tS.image.length!==6)return;let u$=LE(tA,tS),UE=tS.source;mt.bindTexture(34067,tA.__webglTexture,33984+m$);let F$=gt.get(UE);if(UE.version!==F$.__version||u$===!0){mt.activeTexture(33984+m$),nt.pixelStorei(37440,tS.flipY),nt.pixelStorei(37441,tS.premultiplyAlpha),nt.pixelStorei(3317,tS.unpackAlignment),nt.pixelStorei(37443,0);let EI=tS.isCompressedTexture||tS.image[0].isCompressedTexture,pR=tS.image[0]&&tS.image[0].isDataTexture,X$=[];for(let B$=0;B$<6;B$++)!EI&&!pR?X$[B$]=rn(tS.image[B$],!1,!0,Nt):X$[B$]=pR?tS.image[B$].image:tS.image[B$],X$[B$]=S$(tS,X$[B$]);let J$=X$[0],gD=Tn(J$)||Rt,fL=Et.convert(tS.format,tS.encoding),I7=Et.convert(tS.type),j$=kn(tS.internalFormat,fL,I7,tS.encoding),_$=Rt&&tS.isVideoTexture!==!0,I$=F$.__version===void 0||u$===!0,GL=ts(tS,J$,gD);l1(34067,tS,gD);let w$;if(EI){_$&&I$&&mt.texStorage2D(34067,GL,j$,J$.width,J$.height);for(let B$=0;B$<6;B$++){w$=X$[B$].mipmaps;for(let r$=0;r$<w$.length;r$++){let O$=w$[r$];tS.format!==qr?fL!==null?_$?mt.compressedTexSubImage2D(34069+B$,r$,0,0,O$.width,O$.height,fL,O$.data):mt.compressedTexImage2D(34069+B$,r$,j$,O$.width,O$.height,0,O$.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):_$?mt.texSubImage2D(34069+B$,r$,0,0,O$.width,O$.height,fL,I7,O$.data):mt.texImage2D(34069+B$,r$,j$,O$.width,O$.height,0,fL,I7,O$.data)}}}else{w$=tS.mipmaps,_$&&I$&&(w$.length>0&&GL++,mt.texStorage2D(34067,GL,j$,X$[0].width,X$[0].height));for(let B$=0;B$<6;B$++)if(pR){_$?mt.texSubImage2D(34069+B$,0,0,0,X$[B$].width,X$[B$].height,fL,I7,X$[B$].data):mt.texImage2D(34069+B$,0,j$,X$[B$].width,X$[B$].height,0,fL,I7,X$[B$].data);for(let r$=0;r$<w$.length;r$++){let O$=w$[r$].image[B$].image;_$?mt.texSubImage2D(34069+B$,r$+1,0,0,O$.width,O$.height,fL,I7,O$.data):mt.texImage2D(34069+B$,r$+1,j$,O$.width,O$.height,0,fL,I7,O$.data)}}else{_$?mt.texSubImage2D(34069+B$,0,0,0,fL,I7,X$[B$]):mt.texImage2D(34069+B$,0,j$,fL,I7,X$[B$]);for(let r$=0;r$<w$.length;r$++){let O$=w$[r$];_$?mt.texSubImage2D(34069+B$,r$+1,0,0,fL,I7,O$.image[B$]):mt.texImage2D(34069+B$,r$+1,j$,fL,I7,O$.image[B$])}}}un(tS,gD)&&es(34067),F$.__version=UE.version,tS.onUpdate&&tS.onUpdate(tS)}tA.__version=tS.version}function o$(tA,tS,m$,u$,UE){let F$=Et.convert(m$.format,m$.encoding),EI=Et.convert(m$.type),pR=kn(m$.internalFormat,F$,EI,m$.encoding);gt.get(tS).__hasExternalTextures||(UE===32879||UE===35866?mt.texImage3D(UE,0,pR,tS.width,tS.height,tS.depth,0,F$,EI,null):mt.texImage2D(UE,0,pR,tS.width,tS.height,0,F$,EI,null)),mt.bindFramebuffer(36160,tA),wA(tS)?dr.framebufferTexture2DMultisampleEXT(36160,u$,UE,gt.get(m$).__webglTexture,0,rS(tS)):(UE===3553||UE>=34069&&UE<=34074)&&nt.framebufferTexture2D(36160,u$,UE,gt.get(m$).__webglTexture,0),mt.bindFramebuffer(36160,null)}function h$(tA,tS,m$){if(nt.bindRenderbuffer(36161,tA),tS.depthBuffer&&!tS.stencilBuffer){let u$=33189;if(m$||wA(tS)){let UE=tS.depthTexture;UE&&UE.isDepthTexture&&(UE.type===br?u$=36012:UE.type===Ds&&(u$=33190));let F$=rS(tS);wA(tS)?dr.renderbufferStorageMultisampleEXT(36161,F$,u$,tS.width,tS.height):nt.renderbufferStorageMultisample(36161,F$,u$,tS.width,tS.height)}else nt.renderbufferStorage(36161,u$,tS.width,tS.height);nt.framebufferRenderbuffer(36160,36096,36161,tA)}else if(tS.depthBuffer&&tS.stencilBuffer){let u$=rS(tS);m$&&wA(tS)===!1?nt.renderbufferStorageMultisample(36161,u$,35056,tS.width,tS.height):wA(tS)?dr.renderbufferStorageMultisampleEXT(36161,u$,35056,tS.width,tS.height):nt.renderbufferStorage(36161,34041,tS.width,tS.height),nt.framebufferRenderbuffer(36160,33306,36161,tA)}else{let u$=tS.isWebGLMultipleRenderTargets===!0?tS.texture:[tS.texture];for(let UE=0;UE<u$.length;UE++){let F$=u$[UE],EI=Et.convert(F$.format,F$.encoding),pR=Et.convert(F$.type),X$=kn(F$.internalFormat,EI,pR,F$.encoding),J$=rS(tS);m$&&wA(tS)===!1?nt.renderbufferStorageMultisample(36161,J$,X$,tS.width,tS.height):wA(tS)?dr.renderbufferStorageMultisampleEXT(36161,J$,X$,tS.width,tS.height):nt.renderbufferStorage(36161,X$,tS.width,tS.height)}}nt.bindRenderbuffer(36161,null)}function d$(tA,tS){if(tS&&tS.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(mt.bindFramebuffer(36160,tA),!(tS.depthTexture&&tS.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!gt.get(tS.depthTexture).__webglTexture||tS.depthTexture.image.width!==tS.width||tS.depthTexture.image.height!==tS.height)&&(tS.depthTexture.image.width=tS.width,tS.depthTexture.image.height=tS.height,tS.depthTexture.needsUpdate=!0),a1(tS.depthTexture,0);let m$=gt.get(tS.depthTexture).__webglTexture,u$=rS(tS);if(tS.depthTexture.format===uc)wA(tS)?dr.framebufferTexture2DMultisampleEXT(36160,36096,3553,m$,0,u$):nt.framebufferTexture2D(36160,36096,3553,m$,0);else if(tS.depthTexture.format===Za)wA(tS)?dr.framebufferTexture2DMultisampleEXT(36160,33306,3553,m$,0,u$):nt.framebufferTexture2D(36160,33306,3553,m$,0);else throw new Error("Unknown depthTexture format")}function y$(tA){let tS=gt.get(tA),m$=tA.isWebGLCubeRenderTarget===!0;if(tA.depthTexture&&!tS.__autoAllocateDepthBuffer){if(m$)throw new Error("target.depthTexture not supported in Cube render targets");d$(tS.__webglFramebuffer,tA)}else if(m$){tS.__webglDepthbuffer=[];for(let u$=0;u$<6;u$++)mt.bindFramebuffer(36160,tS.__webglFramebuffer[u$]),tS.__webglDepthbuffer[u$]=nt.createRenderbuffer(),h$(tS.__webglDepthbuffer[u$],tA,!1)}else mt.bindFramebuffer(36160,tS.__webglFramebuffer),tS.__webglDepthbuffer=nt.createRenderbuffer(),h$(tS.__webglDepthbuffer,tA,!1);mt.bindFramebuffer(36160,null)}function R$(tA,tS,m$){let u$=gt.get(tA);tS!==void 0&&o$(u$.__webglFramebuffer,tA,tA.texture,36064,3553),m$!==void 0&&y$(tA)}function M$(tA){let tS=tA.texture,m$=gt.get(tA),u$=gt.get(tS);tA.addEventListener("dispose",Il),tA.isWebGLMultipleRenderTargets!==!0&&(u$.__webglTexture===void 0&&(u$.__webglTexture=nt.createTexture()),u$.__version=tS.version,At.memory.textures++);let UE=tA.isWebGLCubeRenderTarget===!0,F$=tA.isWebGLMultipleRenderTargets===!0,EI=Tn(tA)||Rt;if(UE){m$.__webglFramebuffer=[];for(let pR=0;pR<6;pR++)m$.__webglFramebuffer[pR]=nt.createFramebuffer()}else{if(m$.__webglFramebuffer=nt.createFramebuffer(),F$)if(_t.drawBuffers){let pR=tA.texture;for(let X$=0,J$=pR.length;X$<J$;X$++){let gD=gt.get(pR[X$]);gD.__webglTexture===void 0&&(gD.__webglTexture=nt.createTexture(),At.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(Rt&&tA.samples>0&&wA(tA)===!1){let pR=F$?tS:[tS];m$.__webglMultisampledFramebuffer=nt.createFramebuffer(),m$.__webglColorRenderbuffer=[],mt.bindFramebuffer(36160,m$.__webglMultisampledFramebuffer);for(let X$=0;X$<pR.length;X$++){let J$=pR[X$];m$.__webglColorRenderbuffer[X$]=nt.createRenderbuffer(),nt.bindRenderbuffer(36161,m$.__webglColorRenderbuffer[X$]);let gD=Et.convert(J$.format,J$.encoding),fL=Et.convert(J$.type),I7=kn(J$.internalFormat,gD,fL,J$.encoding,tA.isXRRenderTarget===!0),j$=rS(tA);nt.renderbufferStorageMultisample(36161,j$,I7,tA.width,tA.height),nt.framebufferRenderbuffer(36160,36064+X$,36161,m$.__webglColorRenderbuffer[X$])}nt.bindRenderbuffer(36161,null),tA.depthBuffer&&(m$.__webglDepthRenderbuffer=nt.createRenderbuffer(),h$(m$.__webglDepthRenderbuffer,tA,!0)),mt.bindFramebuffer(36160,null)}}if(UE){mt.bindTexture(34067,u$.__webglTexture),l1(34067,tS,EI);for(let pR=0;pR<6;pR++)o$(m$.__webglFramebuffer[pR],tA,tS,36064,34069+pR);un(tS,EI)&&es(34067),mt.unbindTexture()}else if(F$){let pR=tA.texture;for(let X$=0,J$=pR.length;X$<J$;X$++){let gD=pR[X$],fL=gt.get(gD);mt.bindTexture(3553,fL.__webglTexture),l1(3553,gD,EI),o$(m$.__webglFramebuffer,tA,gD,36064+X$,3553),un(gD,EI)&&es(3553)}mt.unbindTexture()}else{let pR=3553;(tA.isWebGL3DRenderTarget||tA.isWebGLArrayRenderTarget)&&(Rt?pR=tA.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),mt.bindTexture(pR,u$.__webglTexture),l1(pR,tS,EI),o$(m$.__webglFramebuffer,tA,tS,36064,pR),un(tS,EI)&&es(pR),mt.unbindTexture()}tA.depthBuffer&&y$(tA)}function x$(tA){let tS=Tn(tA)||Rt,m$=tA.isWebGLMultipleRenderTargets===!0?tA.texture:[tA.texture];for(let u$=0,UE=m$.length;u$<UE;u$++){let F$=m$[u$];if(un(F$,tS)){let EI=tA.isWebGLCubeRenderTarget?34067:3553,pR=gt.get(F$).__webglTexture;mt.bindTexture(EI,pR),es(EI),mt.unbindTexture()}}}function v$(tA){if(Rt&&tA.samples>0&&wA(tA)===!1){let tS=tA.isWebGLMultipleRenderTargets?tA.texture:[tA.texture],m$=tA.width,u$=tA.height,UE=16384,F$=[],EI=tA.stencilBuffer?33306:36096,pR=gt.get(tA),X$=tA.isWebGLMultipleRenderTargets===!0;if(X$)for(let J$=0;J$<tS.length;J$++)mt.bindFramebuffer(36160,pR.__webglMultisampledFramebuffer),nt.framebufferRenderbuffer(36160,36064+J$,36161,null),mt.bindFramebuffer(36160,pR.__webglFramebuffer),nt.framebufferTexture2D(36009,36064+J$,3553,null,0);mt.bindFramebuffer(36008,pR.__webglMultisampledFramebuffer),mt.bindFramebuffer(36009,pR.__webglFramebuffer);for(let J$=0;J$<tS.length;J$++){F$.push(36064+J$),tA.depthBuffer&&F$.push(EI);let gD=pR.__ignoreDepthValues!==void 0?pR.__ignoreDepthValues:!1;if(gD===!1&&(tA.depthBuffer&&(UE|=256),tA.stencilBuffer&&(UE|=1024)),X$&&nt.framebufferRenderbuffer(36008,36064,36161,pR.__webglColorRenderbuffer[J$]),gD===!0&&(nt.invalidateFramebuffer(36008,[EI]),nt.invalidateFramebuffer(36009,[EI])),X$){let fL=gt.get(tS[J$]).__webglTexture;nt.framebufferTexture2D(36009,36064,3553,fL,0)}nt.blitFramebuffer(0,0,m$,u$,0,0,m$,u$,UE,9728),Mr&&nt.invalidateFramebuffer(36008,F$)}if(mt.bindFramebuffer(36008,null),mt.bindFramebuffer(36009,null),X$)for(let J$=0;J$<tS.length;J$++){mt.bindFramebuffer(36160,pR.__webglMultisampledFramebuffer),nt.framebufferRenderbuffer(36160,36064+J$,36161,pR.__webglColorRenderbuffer[J$]);let gD=gt.get(tS[J$]).__webglTexture;mt.bindFramebuffer(36160,pR.__webglFramebuffer),nt.framebufferTexture2D(36009,36064+J$,3553,gD,0)}mt.bindFramebuffer(36009,pR.__webglMultisampledFramebuffer)}}function rS(tA){return Math.min(Gt,tA.samples)}function wA(tA){let tS=gt.get(tA);return Rt&&tA.samples>0&&st.has("WEBGL_multisampled_render_to_texture")===!0&&tS.__useRenderToTexture!==!1}function g$(tA){let tS=At.render.frame;Tr.get(tA)!==tS&&(Tr.set(tA,tS),tA.update())}function S$(tA,tS){let m$=tA.encoding,u$=tA.format,UE=tA.type;return tA.isCompressedTexture===!0||tA.isVideoTexture===!0||tA.format===WS||m$!==mn&&(m$===at$1?Rt===!1?st.has("EXT_sRGB")===!0&&u$===qr?(tA.format=WS,tA.minFilter=rt$1,tA.generateMipmaps=!1):tS=Jg.sRGBToLinear(tS):(u$!==qr||UE!==_r)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",m$)),tS}this.allocateTextureUnit=W0,this.resetTextureUnits=q0,this.setTexture2D=a1,this.setTexture2DArray=Vx,this.setTexture3D=t0,this.setTextureCube=cu,this.rebindTextures=R$,this.setupRenderTarget=M$,this.updateRenderTargetMipmap=x$,this.updateMultisampleRenderTarget=v$,this.setupDepthRenderbuffer=y$,this.setupFrameBufferTexture=o$,this.useMultisampledRTT=wA}function QG(nt,st,mt){let gt=mt.isWebGL2;function _t(Et,At=null){let Rt;if(Et===_r)return 5121;if(Et===GF)return 32819;if(Et===jF)return 32820;if(Et===UF)return 5120;if(Et===zF)return 5122;if(Et===WC)return 5123;if(Et===kF)return 5124;if(Et===Ds)return 5125;if(Et===br)return 5126;if(Et===Wn)return gt?5131:(Rt=st.get("OES_texture_half_float"),Rt!==null?Rt.HALF_FLOAT_OES:null);if(Et===HF)return 6406;if(Et===qr)return 6408;if(Et===WF)return 6409;if(Et===qF)return 6410;if(Et===uc)return 6402;if(Et===Za)return 34041;if(Et===WS)return Rt=st.get("EXT_sRGB"),Rt!==null?Rt.SRGB_ALPHA_EXT:null;if(Et===YF)return 6403;if(Et===XF)return 36244;if(Et===Ju)return 33319;if(Et===QF)return 33320;if(Et===ww)return 36249;if(Et===nS||Et===sS||Et===oS||Et===aS)if(At===at$1)if(Rt=st.get("WEBGL_compressed_texture_s3tc_srgb"),Rt!==null){if(Et===nS)return Rt.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(Et===sS)return Rt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(Et===oS)return Rt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(Et===aS)return Rt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(Rt=st.get("WEBGL_compressed_texture_s3tc"),Rt!==null){if(Et===nS)return Rt.COMPRESSED_RGB_S3TC_DXT1_EXT;if(Et===sS)return Rt.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(Et===oS)return Rt.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(Et===aS)return Rt.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(Et===gT||Et===yT||Et===vT||Et===xT)if(Rt=st.get("WEBGL_compressed_texture_pvrtc"),Rt!==null){if(Et===gT)return Rt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(Et===yT)return Rt.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(Et===vT)return Rt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(Et===xT)return Rt.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(Et===KF)return Rt=st.get("WEBGL_compressed_texture_etc1"),Rt!==null?Rt.COMPRESSED_RGB_ETC1_WEBGL:null;if(Et===bT||Et===ST)if(Rt=st.get("WEBGL_compressed_texture_etc"),Rt!==null){if(Et===bT)return At===at$1?Rt.COMPRESSED_SRGB8_ETC2:Rt.COMPRESSED_RGB8_ETC2;if(Et===ST)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:Rt.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(Et===wT||Et===AT||Et===ET||Et===MT||Et===TT||Et===CT||Et===PT||Et===_T||Et===DT||Et===IT||Et===OT||Et===RT||Et===LT||Et===BT)if(Rt=st.get("WEBGL_compressed_texture_astc"),Rt!==null){if(Et===wT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:Rt.COMPRESSED_RGBA_ASTC_4x4_KHR;if(Et===AT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:Rt.COMPRESSED_RGBA_ASTC_5x4_KHR;if(Et===ET)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:Rt.COMPRESSED_RGBA_ASTC_5x5_KHR;if(Et===MT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:Rt.COMPRESSED_RGBA_ASTC_6x5_KHR;if(Et===TT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:Rt.COMPRESSED_RGBA_ASTC_6x6_KHR;if(Et===CT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:Rt.COMPRESSED_RGBA_ASTC_8x5_KHR;if(Et===PT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:Rt.COMPRESSED_RGBA_ASTC_8x6_KHR;if(Et===_T)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:Rt.COMPRESSED_RGBA_ASTC_8x8_KHR;if(Et===DT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:Rt.COMPRESSED_RGBA_ASTC_10x5_KHR;if(Et===IT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:Rt.COMPRESSED_RGBA_ASTC_10x6_KHR;if(Et===OT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:Rt.COMPRESSED_RGBA_ASTC_10x8_KHR;if(Et===RT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:Rt.COMPRESSED_RGBA_ASTC_10x10_KHR;if(Et===LT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:Rt.COMPRESSED_RGBA_ASTC_12x10_KHR;if(Et===BT)return At===at$1?Rt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:Rt.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(Et===lS)if(Rt=st.get("EXT_texture_compression_bptc"),Rt!==null){if(Et===lS)return At===at$1?Rt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:Rt.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(Et===ZF||Et===NT||Et===FT||Et===VT)if(Rt=st.get("EXT_texture_compression_rgtc"),Rt!==null){if(Et===lS)return Rt.COMPRESSED_RED_RGTC1_EXT;if(Et===NT)return Rt.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(Et===FT)return Rt.COMPRESSED_RED_GREEN_RGTC2_EXT;if(Et===VT)return Rt.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return Et===Xa?gt?34042:(Rt=st.get("WEBGL_depth_texture"),Rt!==null?Rt.UNSIGNED_INT_24_8_WEBGL:null):nt[Et]!==void 0?nt[Et]:null}return{convert:_t}}var rw=class extends $r{constructor(nt=[]){super(),this.isArrayCamera=!0,this.cameras=nt}},sn=class extends Mt{constructor(){super(),this.isGroup=!0,this.type="Group"}},KG={type:"move"},rp=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new sn,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new sn,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new E$6,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new E$6),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new sn,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new E$6,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new E$6),this._grip}dispatchEvent(nt){return this._targetRay!==null&&this._targetRay.dispatchEvent(nt),this._grip!==null&&this._grip.dispatchEvent(nt),this._hand!==null&&this._hand.dispatchEvent(nt),this}connect(nt){if(nt&&nt.hand){let st=this._hand;if(st)for(let mt of nt.hand.values())this._getHandJoint(st,mt)}return this.dispatchEvent({type:"connected",data:nt}),this}disconnect(nt){return this.dispatchEvent({type:"disconnected",data:nt}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(nt,st,mt){let gt=null,_t=null,Et=null,At=this._targetRay,Rt=this._grip,Ft=this._hand;if(nt&&st.session.visibilityState!=="visible-blurred"){if(Ft&&nt.hand){Et=!0;for(let Tr of nt.hand.values()){let zr=st.getJointPose(Tr,mt),Fr=this._getHandJoint(Ft,Tr);zr!==null&&(Fr.matrix.fromArray(zr.transform.matrix),Fr.matrix.decompose(Fr.position,Fr.rotation,Fr.scale),Fr.jointRadius=zr.radius),Fr.visible=zr!==null}let Nt=Ft.joints["index-finger-tip"],Bt=Ft.joints["thumb-tip"],Gt=Nt.position.distanceTo(Bt.position),dr=.02,Mr=.005;Ft.inputState.pinching&&Gt>dr+Mr?(Ft.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:nt.handedness,target:this})):!Ft.inputState.pinching&&Gt<=dr-Mr&&(Ft.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:nt.handedness,target:this}))}else Rt!==null&&nt.gripSpace&&(_t=st.getPose(nt.gripSpace,mt),_t!==null&&(Rt.matrix.fromArray(_t.transform.matrix),Rt.matrix.decompose(Rt.position,Rt.rotation,Rt.scale),_t.linearVelocity?(Rt.hasLinearVelocity=!0,Rt.linearVelocity.copy(_t.linearVelocity)):Rt.hasLinearVelocity=!1,_t.angularVelocity?(Rt.hasAngularVelocity=!0,Rt.angularVelocity.copy(_t.angularVelocity)):Rt.hasAngularVelocity=!1));At!==null&&(gt=st.getPose(nt.targetRaySpace,mt),gt===null&&_t!==null&&(gt=_t),gt!==null&&(At.matrix.fromArray(gt.transform.matrix),At.matrix.decompose(At.position,At.rotation,At.scale),gt.linearVelocity?(At.hasLinearVelocity=!0,At.linearVelocity.copy(gt.linearVelocity)):At.hasLinearVelocity=!1,gt.angularVelocity?(At.hasAngularVelocity=!0,At.angularVelocity.copy(gt.angularVelocity)):At.hasAngularVelocity=!1,this.dispatchEvent(KG)))}return At!==null&&(At.visible=gt!==null),Rt!==null&&(Rt.visible=_t!==null),Ft!==null&&(Ft.visible=Et!==null),this}_getHandJoint(nt,st){if(nt.joints[st.jointName]===void 0){let mt=new sn;mt.matrixAutoUpdate=!1,mt.visible=!1,nt.joints[st.jointName]=mt,nt.add(mt)}return nt.joints[st.jointName]}},ns=class extends $t{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt){if(Nt=Nt!==void 0?Nt:uc,Nt!==uc&&Nt!==Za)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");mt===void 0&&Nt===uc&&(mt=Ds),mt===void 0&&Nt===Za&&(mt=Xa),super(null,gt,_t,Et,At,Rt,Nt,mt,Ft),this.isDepthTexture=!0,this.image={width:nt,height:st},this.magFilter=At!==void 0?At:Vt,this.minFilter=Rt!==void 0?Rt:Vt,this.flipY=!1,this.generateMipmaps=!1}},iw=class extends pr{constructor(nt,st){super();let mt=this,gt=null,_t=1,Et=null,At="local-floor",Rt=1,Ft=null,Nt=null,Bt=null,Gt=null,dr=null,Mr=null,Tr=st.getContextAttributes(),zr=null,Fr=null,Nr=[],tn=[],rn=new Set,Tn=new Map,$n=new $r;$n.layers.enable(1),$n.viewport=new Ze$1;let un=new $r;un.layers.enable(2),un.viewport=new Ze$1;let es=[$n,un],kn=new rw;kn.layers.enable(1),kn.layers.enable(2);let ts=null,Ko=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Vx){let t0=Nr[Vx];return t0===void 0&&(t0=new rp,Nr[Vx]=t0),t0.getTargetRaySpace()},this.getControllerGrip=function(Vx){let t0=Nr[Vx];return t0===void 0&&(t0=new rp,Nr[Vx]=t0),t0.getGripSpace()},this.getHand=function(Vx){let t0=Nr[Vx];return t0===void 0&&(t0=new rp,Nr[Vx]=t0),t0.getHandSpace()};function ds(Vx){let t0=tn.indexOf(Vx.inputSource);if(t0===-1)return;let cu=Nr[t0];cu!==void 0&&cu.dispatchEvent({type:Vx.type,data:Vx.inputSource})}function Il(){gt.removeEventListener("select",ds),gt.removeEventListener("selectstart",ds),gt.removeEventListener("selectend",ds),gt.removeEventListener("squeeze",ds),gt.removeEventListener("squeezestart",ds),gt.removeEventListener("squeezeend",ds),gt.removeEventListener("end",Il),gt.removeEventListener("inputsourceschange",ru);for(let Vx=0;Vx<Nr.length;Vx++){let t0=tn[Vx];t0!==null&&(tn[Vx]=null,Nr[Vx].disconnect(t0))}ts=null,Ko=null,nt.setRenderTarget(zr),dr=null,Gt=null,Bt=null,gt=null,Fr=null,a1.stop(),mt.isPresenting=!1,mt.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Vx){_t=Vx,mt.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Vx){At=Vx,mt.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return Ft||Et},this.setReferenceSpace=function(Vx){Ft=Vx},this.getBaseLayer=function(){return Gt!==null?Gt:dr},this.getBinding=function(){return Bt},this.getFrame=function(){return Mr},this.getSession=function(){return gt},this.setSession=async function(Vx){if(gt=Vx,gt!==null){if(zr=nt.getRenderTarget(),gt.addEventListener("select",ds),gt.addEventListener("selectstart",ds),gt.addEventListener("selectend",ds),gt.addEventListener("squeeze",ds),gt.addEventListener("squeezestart",ds),gt.addEventListener("squeezeend",ds),gt.addEventListener("end",Il),gt.addEventListener("inputsourceschange",ru),Tr.xrCompatible!==!0&&await st.makeXRCompatible(),gt.renderState.layers===void 0||nt.capabilities.isWebGL2===!1){let t0={antialias:gt.renderState.layers===void 0?Tr.antialias:!0,alpha:Tr.alpha,depth:Tr.depth,stencil:Tr.stencil,framebufferScaleFactor:_t};dr=new XRWebGLLayer(gt,st,t0),gt.updateRenderState({baseLayer:dr}),Fr=new dt$1(dr.framebufferWidth,dr.framebufferHeight,{format:qr,type:_r,encoding:nt.outputEncoding,stencilBuffer:Tr.stencil})}else{let t0=null,cu=null,lu=null;Tr.depth&&(lu=Tr.stencil?35056:33190,t0=Tr.stencil?Za:uc,cu=Tr.stencil?Xa:Ds);let b0={colorFormat:32856,depthFormat:lu,scaleFactor:_t};Bt=new XRWebGLBinding(gt,st),Gt=Bt.createProjectionLayer(b0),gt.updateRenderState({layers:[Gt]}),Fr=new dt$1(Gt.textureWidth,Gt.textureHeight,{format:qr,type:_r,depthTexture:new ns(Gt.textureWidth,Gt.textureHeight,cu,void 0,void 0,void 0,void 0,void 0,void 0,t0),stencilBuffer:Tr.stencil,encoding:nt.outputEncoding,samples:Tr.antialias?4:0});let l1=nt.properties.get(Fr);l1.__ignoreDepthValues=Gt.ignoreDepthValues}Fr.isXRRenderTarget=!0,this.setFoveation(Rt),Ft=null,Et=await gt.requestReferenceSpace(At),a1.setContext(gt),a1.start(),mt.isPresenting=!0,mt.dispatchEvent({type:"sessionstart"})}};function ru(Vx){for(let t0=0;t0<Vx.removed.length;t0++){let cu=Vx.removed[t0],lu=tn.indexOf(cu);lu>=0&&(tn[lu]=null,Nr[lu].disconnect(cu))}for(let t0=0;t0<Vx.added.length;t0++){let cu=Vx.added[t0],lu=tn.indexOf(cu);if(lu===-1){for(let l1=0;l1<Nr.length;l1++)if(l1>=tn.length){tn.push(cu),lu=l1;break}else if(tn[l1]===null){tn[l1]=cu,lu=l1;break}if(lu===-1)break}let b0=Nr[lu];b0&&b0.connect(cu)}}let uu=new E$6,p0=new E$6;function X1(Vx,t0,cu){uu.setFromMatrixPosition(t0.matrixWorld),p0.setFromMatrixPosition(cu.matrixWorld);let lu=uu.distanceTo(p0),b0=t0.projectionMatrix.elements,l1=cu.projectionMatrix.elements,LE=b0[14]/(b0[10]-1),eS=b0[14]/(b0[10]+1),SA=(b0[9]+1)/b0[5],o$=(b0[9]-1)/b0[5],h$=(b0[8]-1)/b0[0],d$=(l1[8]+1)/l1[0],y$=LE*h$,R$=LE*d$,M$=lu/(-h$+d$),x$=M$*-h$;t0.matrixWorld.decompose(Vx.position,Vx.quaternion,Vx.scale),Vx.translateX(x$),Vx.translateZ(M$),Vx.matrixWorld.compose(Vx.position,Vx.quaternion,Vx.scale),Vx.matrixWorldInverse.copy(Vx.matrixWorld).invert();let v$=LE+M$,rS=eS+M$,wA=y$-x$,g$=R$+(lu-x$),S$=SA*eS/rS*v$,tA=o$*eS/rS*v$;Vx.projectionMatrix.makePerspective(wA,g$,S$,tA,v$,rS)}function q0(Vx,t0){t0===null?Vx.matrixWorld.copy(Vx.matrix):Vx.matrixWorld.multiplyMatrices(t0.matrixWorld,Vx.matrix),Vx.matrixWorldInverse.copy(Vx.matrixWorld).invert()}this.updateCamera=function(Vx){if(gt===null)return;kn.near=un.near=$n.near=Vx.near,kn.far=un.far=$n.far=Vx.far,(ts!==kn.near||Ko!==kn.far)&&(gt.updateRenderState({depthNear:kn.near,depthFar:kn.far}),ts=kn.near,Ko=kn.far);let t0=Vx.parent,cu=kn.cameras;q0(kn,t0);for(let b0=0;b0<cu.length;b0++)q0(cu[b0],t0);kn.matrixWorld.decompose(kn.position,kn.quaternion,kn.scale),Vx.matrix.copy(kn.matrix),Vx.matrix.decompose(Vx.position,Vx.quaternion,Vx.scale);let lu=Vx.children;for(let b0=0,l1=lu.length;b0<l1;b0++)lu[b0].updateMatrixWorld(!0);cu.length===2?X1(kn,$n,un):kn.projectionMatrix.copy($n.projectionMatrix)},this.getCamera=function(){return kn},this.getFoveation=function(){if(!(Gt===null&&dr===null))return Rt},this.setFoveation=function(Vx){Rt=Vx,Gt!==null&&(Gt.fixedFoveation=Vx),dr!==null&&dr.fixedFoveation!==void 0&&(dr.fixedFoveation=Vx)},this.getPlanes=function(){return rn};let W0=null;function hu(Vx,t0){if(Nt=t0.getViewerPose(Ft||Et),Mr=t0,Nt!==null){let cu=Nt.views;dr!==null&&(nt.setRenderTargetFramebuffer(Fr,dr.framebuffer),nt.setRenderTarget(Fr));let lu=!1;cu.length!==kn.cameras.length&&(kn.cameras.length=0,lu=!0);for(let b0=0;b0<cu.length;b0++){let l1=cu[b0],LE=null;if(dr!==null)LE=dr.getViewport(l1);else{let SA=Bt.getViewSubImage(Gt,l1);LE=SA.viewport,b0===0&&(nt.setRenderTargetTextures(Fr,SA.colorTexture,Gt.ignoreDepthValues?void 0:SA.depthStencilTexture),nt.setRenderTarget(Fr))}let eS=es[b0];eS===void 0&&(eS=new $r,eS.layers.enable(b0),eS.viewport=new Ze$1,es[b0]=eS),eS.matrix.fromArray(l1.transform.matrix),eS.projectionMatrix.fromArray(l1.projectionMatrix),eS.viewport.set(LE.x,LE.y,LE.width,LE.height),b0===0&&kn.matrix.copy(eS.matrix),lu===!0&&kn.cameras.push(eS)}}for(let cu=0;cu<Nr.length;cu++){let lu=tn[cu],b0=Nr[cu];lu!==null&&b0!==void 0&&b0.update(lu,t0,Ft||Et)}if(W0&&W0(Vx,t0),t0.detectedPlanes){mt.dispatchEvent({type:"planesdetected",data:t0.detectedPlanes});let cu=null;for(let lu of rn)t0.detectedPlanes.has(lu)||(cu===null&&(cu=[]),cu.push(lu));if(cu!==null)for(let lu of cu)rn.delete(lu),Tn.delete(lu),mt.dispatchEvent({type:"planeremoved",data:lu});for(let lu of t0.detectedPlanes)if(!rn.has(lu))rn.add(lu),Tn.set(lu,t0.lastChangedTime),mt.dispatchEvent({type:"planeadded",data:lu});else{let b0=Tn.get(lu);lu.lastChangedTime>b0&&(Tn.set(lu,lu.lastChangedTime),mt.dispatchEvent({type:"planechanged",data:lu}))}}Mr=null}let a1=new ZC;a1.setAnimationLoop(hu),this.setAnimationLoop=function(Vx){W0=Vx},this.dispose=function(){}}};function ZG(nt,st){function mt(zr,Fr){Fr.color.getRGB(zr.fogColor.value,KC(nt)),Fr.isFog?(zr.fogNear.value=Fr.near,zr.fogFar.value=Fr.far):Fr.isFogExp2&&(zr.fogDensity.value=Fr.density)}function gt(zr,Fr,Nr,tn,rn){Fr.isMeshBasicMaterial||Fr.isMeshLambertMaterial?_t(zr,Fr):Fr.isMeshToonMaterial?(_t(zr,Fr),Bt(zr,Fr)):Fr.isMeshPhongMaterial?(_t(zr,Fr),Nt(zr,Fr)):Fr.isMeshStandardMaterial?(_t(zr,Fr),Gt(zr,Fr),Fr.isMeshPhysicalMaterial&&dr(zr,Fr,rn)):Fr.isMeshMatcapMaterial?(_t(zr,Fr),Mr(zr,Fr)):Fr.isMeshDepthMaterial?_t(zr,Fr):Fr.isMeshDistanceMaterial?(_t(zr,Fr),Tr(zr,Fr)):Fr.isMeshNormalMaterial?_t(zr,Fr):Fr.isLineBasicMaterial?(Et(zr,Fr),Fr.isLineDashedMaterial&&At(zr,Fr)):Fr.isPointsMaterial?Rt(zr,Fr,Nr,tn):Fr.isSpriteMaterial?Ft(zr,Fr):Fr.isShadowMaterial?(zr.color.value.copy(Fr.color),zr.opacity.value=Fr.opacity):Fr.isShaderMaterial&&(Fr.uniformsNeedUpdate=!1)}function _t(zr,Fr){zr.opacity.value=Fr.opacity,Fr.color&&zr.diffuse.value.copy(Fr.color),Fr.emissive&&zr.emissive.value.copy(Fr.emissive).multiplyScalar(Fr.emissiveIntensity),Fr.map&&(zr.map.value=Fr.map),Fr.alphaMap&&(zr.alphaMap.value=Fr.alphaMap),Fr.bumpMap&&(zr.bumpMap.value=Fr.bumpMap,zr.bumpScale.value=Fr.bumpScale,Fr.side===pi&&(zr.bumpScale.value*=-1)),Fr.displacementMap&&(zr.displacementMap.value=Fr.displacementMap,zr.displacementScale.value=Fr.displacementScale,zr.displacementBias.value=Fr.displacementBias),Fr.emissiveMap&&(zr.emissiveMap.value=Fr.emissiveMap),Fr.normalMap&&(zr.normalMap.value=Fr.normalMap,zr.normalScale.value.copy(Fr.normalScale),Fr.side===pi&&zr.normalScale.value.negate()),Fr.specularMap&&(zr.specularMap.value=Fr.specularMap),Fr.alphaTest>0&&(zr.alphaTest.value=Fr.alphaTest);let Nr=st.get(Fr).envMap;if(Nr&&(zr.envMap.value=Nr,zr.flipEnvMap.value=Nr.isCubeTexture&&Nr.isRenderTargetTexture===!1?-1:1,zr.reflectivity.value=Fr.reflectivity,zr.ior.value=Fr.ior,zr.refractionRatio.value=Fr.refractionRatio),Fr.lightMap){zr.lightMap.value=Fr.lightMap;let Tn=nt.physicallyCorrectLights!==!0?Math.PI:1;zr.lightMapIntensity.value=Fr.lightMapIntensity*Tn}Fr.aoMap&&(zr.aoMap.value=Fr.aoMap,zr.aoMapIntensity.value=Fr.aoMapIntensity);let tn;Fr.map?tn=Fr.map:Fr.specularMap?tn=Fr.specularMap:Fr.displacementMap?tn=Fr.displacementMap:Fr.normalMap?tn=Fr.normalMap:Fr.bumpMap?tn=Fr.bumpMap:Fr.roughnessMap?tn=Fr.roughnessMap:Fr.metalnessMap?tn=Fr.metalnessMap:Fr.alphaMap?tn=Fr.alphaMap:Fr.emissiveMap?tn=Fr.emissiveMap:Fr.clearcoatMap?tn=Fr.clearcoatMap:Fr.clearcoatNormalMap?tn=Fr.clearcoatNormalMap:Fr.clearcoatRoughnessMap?tn=Fr.clearcoatRoughnessMap:Fr.iridescenceMap?tn=Fr.iridescenceMap:Fr.iridescenceThicknessMap?tn=Fr.iridescenceThicknessMap:Fr.specularIntensityMap?tn=Fr.specularIntensityMap:Fr.specularColorMap?tn=Fr.specularColorMap:Fr.transmissionMap?tn=Fr.transmissionMap:Fr.thicknessMap?tn=Fr.thicknessMap:Fr.sheenColorMap?tn=Fr.sheenColorMap:Fr.sheenRoughnessMap&&(tn=Fr.sheenRoughnessMap),tn!==void 0&&(tn.isWebGLRenderTarget&&(tn=tn.texture),tn.matrixAutoUpdate===!0&&tn.updateMatrix(),zr.uvTransform.value.copy(tn.matrix));let rn;Fr.aoMap?rn=Fr.aoMap:Fr.lightMap&&(rn=Fr.lightMap),rn!==void 0&&(rn.isWebGLRenderTarget&&(rn=rn.texture),rn.matrixAutoUpdate===!0&&rn.updateMatrix(),zr.uv2Transform.value.copy(rn.matrix))}function Et(zr,Fr){zr.diffuse.value.copy(Fr.color),zr.opacity.value=Fr.opacity}function At(zr,Fr){zr.dashSize.value=Fr.dashSize,zr.totalSize.value=Fr.dashSize+Fr.gapSize,zr.scale.value=Fr.scale}function Rt(zr,Fr,Nr,tn){zr.diffuse.value.copy(Fr.color),zr.opacity.value=Fr.opacity,zr.size.value=Fr.size*Nr,zr.scale.value=tn*.5,Fr.map&&(zr.map.value=Fr.map),Fr.alphaMap&&(zr.alphaMap.value=Fr.alphaMap),Fr.alphaTest>0&&(zr.alphaTest.value=Fr.alphaTest);let rn;Fr.map?rn=Fr.map:Fr.alphaMap&&(rn=Fr.alphaMap),rn!==void 0&&(rn.matrixAutoUpdate===!0&&rn.updateMatrix(),zr.uvTransform.value.copy(rn.matrix))}function Ft(zr,Fr){zr.diffuse.value.copy(Fr.color),zr.opacity.value=Fr.opacity,zr.rotation.value=Fr.rotation,Fr.map&&(zr.map.value=Fr.map),Fr.alphaMap&&(zr.alphaMap.value=Fr.alphaMap),Fr.alphaTest>0&&(zr.alphaTest.value=Fr.alphaTest);let Nr;Fr.map?Nr=Fr.map:Fr.alphaMap&&(Nr=Fr.alphaMap),Nr!==void 0&&(Nr.matrixAutoUpdate===!0&&Nr.updateMatrix(),zr.uvTransform.value.copy(Nr.matrix))}function Nt(zr,Fr){zr.specular.value.copy(Fr.specular),zr.shininess.value=Math.max(Fr.shininess,1e-4)}function Bt(zr,Fr){Fr.gradientMap&&(zr.gradientMap.value=Fr.gradientMap)}function Gt(zr,Fr){zr.roughness.value=Fr.roughness,zr.metalness.value=Fr.metalness,Fr.roughnessMap&&(zr.roughnessMap.value=Fr.roughnessMap),Fr.metalnessMap&&(zr.metalnessMap.value=Fr.metalnessMap),st.get(Fr).envMap&&(zr.envMapIntensity.value=Fr.envMapIntensity)}function dr(zr,Fr,Nr){zr.ior.value=Fr.ior,Fr.sheen>0&&(zr.sheenColor.value.copy(Fr.sheenColor).multiplyScalar(Fr.sheen),zr.sheenRoughness.value=Fr.sheenRoughness,Fr.sheenColorMap&&(zr.sheenColorMap.value=Fr.sheenColorMap),Fr.sheenRoughnessMap&&(zr.sheenRoughnessMap.value=Fr.sheenRoughnessMap)),Fr.clearcoat>0&&(zr.clearcoat.value=Fr.clearcoat,zr.clearcoatRoughness.value=Fr.clearcoatRoughness,Fr.clearcoatMap&&(zr.clearcoatMap.value=Fr.clearcoatMap),Fr.clearcoatRoughnessMap&&(zr.clearcoatRoughnessMap.value=Fr.clearcoatRoughnessMap),Fr.clearcoatNormalMap&&(zr.clearcoatNormalScale.value.copy(Fr.clearcoatNormalScale),zr.clearcoatNormalMap.value=Fr.clearcoatNormalMap,Fr.side===pi&&zr.clearcoatNormalScale.value.negate())),Fr.iridescence>0&&(zr.iridescence.value=Fr.iridescence,zr.iridescenceIOR.value=Fr.iridescenceIOR,zr.iridescenceThicknessMinimum.value=Fr.iridescenceThicknessRange[0],zr.iridescenceThicknessMaximum.value=Fr.iridescenceThicknessRange[1],Fr.iridescenceMap&&(zr.iridescenceMap.value=Fr.iridescenceMap),Fr.iridescenceThicknessMap&&(zr.iridescenceThicknessMap.value=Fr.iridescenceThicknessMap)),Fr.transmission>0&&(zr.transmission.value=Fr.transmission,zr.transmissionSamplerMap.value=Nr.texture,zr.transmissionSamplerSize.value.set(Nr.width,Nr.height),Fr.transmissionMap&&(zr.transmissionMap.value=Fr.transmissionMap),zr.thickness.value=Fr.thickness,Fr.thicknessMap&&(zr.thicknessMap.value=Fr.thicknessMap),zr.attenuationDistance.value=Fr.attenuationDistance,zr.attenuationColor.value.copy(Fr.attenuationColor)),zr.specularIntensity.value=Fr.specularIntensity,zr.specularColor.value.copy(Fr.specularColor),Fr.specularIntensityMap&&(zr.specularIntensityMap.value=Fr.specularIntensityMap),Fr.specularColorMap&&(zr.specularColorMap.value=Fr.specularColorMap)}function Mr(zr,Fr){Fr.matcap&&(zr.matcap.value=Fr.matcap)}function Tr(zr,Fr){zr.referencePosition.value.copy(Fr.referencePosition),zr.nearDistance.value=Fr.nearDistance,zr.farDistance.value=Fr.farDistance}return{refreshFogUniforms:mt,refreshMaterialUniforms:gt}}function JG(nt,st,mt,gt){let _t={},Et={},At=[],Rt=mt.isWebGL2?nt.getParameter(35375):0;function Ft(tn,rn){let Tn=rn.program;gt.uniformBlockBinding(tn,Tn)}function Nt(tn,rn){let Tn=_t[tn.id];Tn===void 0&&(Tr(tn),Tn=Bt(tn),_t[tn.id]=Tn,tn.addEventListener("dispose",Fr));let $n=rn.program;gt.updateUBOMapping(tn,$n);let un=st.render.frame;Et[tn.id]!==un&&(dr(tn),Et[tn.id]=un)}function Bt(tn){let rn=Gt();tn.__bindingPointIndex=rn;let Tn=nt.createBuffer(),$n=tn.__size,un=tn.usage;return nt.bindBuffer(35345,Tn),nt.bufferData(35345,$n,un),nt.bindBuffer(35345,null),nt.bindBufferBase(35345,rn,Tn),Tn}function Gt(){for(let tn=0;tn<Rt;tn++)if(At.indexOf(tn)===-1)return At.push(tn),tn;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function dr(tn){let rn=_t[tn.id],Tn=tn.uniforms,$n=tn.__cache;nt.bindBuffer(35345,rn);for(let un=0,es=Tn.length;un<es;un++){let kn=Tn[un];if(Mr(kn,un,$n)===!0){let ts=kn.__offset,Ko=Array.isArray(kn.value)?kn.value:[kn.value],ds=0;for(let Il=0;Il<Ko.length;Il++){let ru=Ko[Il],uu=zr(ru);typeof ru=="number"?(kn.__data[0]=ru,nt.bufferSubData(35345,ts+ds,kn.__data)):ru.isMatrix3?(kn.__data[0]=ru.elements[0],kn.__data[1]=ru.elements[1],kn.__data[2]=ru.elements[2],kn.__data[3]=ru.elements[0],kn.__data[4]=ru.elements[3],kn.__data[5]=ru.elements[4],kn.__data[6]=ru.elements[5],kn.__data[7]=ru.elements[0],kn.__data[8]=ru.elements[6],kn.__data[9]=ru.elements[7],kn.__data[10]=ru.elements[8],kn.__data[11]=ru.elements[0]):(ru.toArray(kn.__data,ds),ds+=uu.storage/Float32Array.BYTES_PER_ELEMENT)}nt.bufferSubData(35345,ts,kn.__data)}}nt.bindBuffer(35345,null)}function Mr(tn,rn,Tn){let $n=tn.value;if(Tn[rn]===void 0){if(typeof $n=="number")Tn[rn]=$n;else{let un=Array.isArray($n)?$n:[$n],es=[];for(let kn=0;kn<un.length;kn++)es.push(un[kn].clone());Tn[rn]=es}return!0}else if(typeof $n=="number"){if(Tn[rn]!==$n)return Tn[rn]=$n,!0}else{let un=Array.isArray(Tn[rn])?Tn[rn]:[Tn[rn]],es=Array.isArray($n)?$n:[$n];for(let kn=0;kn<un.length;kn++){let ts=un[kn];if(ts.equals(es[kn])===!1)return ts.copy(es[kn]),!0}}return!1}function Tr(tn){let rn=tn.uniforms,Tn=0,$n=16,un=0;for(let es=0,kn=rn.length;es<kn;es++){let ts=rn[es],Ko={boundary:0,storage:0},ds=Array.isArray(ts.value)?ts.value:[ts.value];for(let Il=0,ru=ds.length;Il<ru;Il++){let uu=ds[Il],p0=zr(uu);Ko.boundary+=p0.boundary,Ko.storage+=p0.storage}if(ts.__data=new Float32Array(Ko.storage/Float32Array.BYTES_PER_ELEMENT),ts.__offset=Tn,es>0){un=Tn%$n;let Il=$n-un;un!==0&&Il-Ko.boundary<0&&(Tn+=$n-un,ts.__offset=Tn)}Tn+=Ko.storage}return un=Tn%$n,un>0&&(Tn+=$n-un),tn.__size=Tn,tn.__cache={},this}function zr(tn){let rn={boundary:0,storage:0};return typeof tn=="number"?(rn.boundary=4,rn.storage=4):tn.isVector2?(rn.boundary=8,rn.storage=8):tn.isVector3||tn.isColor?(rn.boundary=16,rn.storage=12):tn.isVector4?(rn.boundary=16,rn.storage=16):tn.isMatrix3?(rn.boundary=48,rn.storage=48):tn.isMatrix4?(rn.boundary=64,rn.storage=64):tn.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",tn),rn}function Fr(tn){let rn=tn.target;rn.removeEventListener("dispose",Fr);let Tn=At.indexOf(rn.__bindingPointIndex);At.splice(Tn,1),nt.deleteBuffer(_t[rn.id]),delete _t[rn.id],delete Et[rn.id]}function Nr(){for(let tn in _t)nt.deleteBuffer(_t[tn]);At=[],_t={},Et={}}return{bind:Ft,update:Nt,dispose:Nr}}function $G(){let nt=ap("canvas");return nt.style.display="block",nt}function _w(nt={}){this.isWebGLRenderer=!0;let st=nt.canvas!==void 0?nt.canvas:$G(),mt=nt.context!==void 0?nt.context:null,gt=nt.depth!==void 0?nt.depth:!0,_t=nt.stencil!==void 0?nt.stencil:!0,Et=nt.antialias!==void 0?nt.antialias:!1,At=nt.premultipliedAlpha!==void 0?nt.premultipliedAlpha:!0,Rt=nt.preserveDrawingBuffer!==void 0?nt.preserveDrawingBuffer:!1,Ft=nt.powerPreference!==void 0?nt.powerPreference:"default",Nt=nt.failIfMajorPerformanceCaveat!==void 0?nt.failIfMajorPerformanceCaveat:!1,Bt;mt!==null?Bt=mt.getContextAttributes().alpha:Bt=nt.alpha!==void 0?nt.alpha:!1;let Gt=null,dr=null,Mr=[],Tr=[];this.domElement=st,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=mn,this.physicallyCorrectLights=!1,this.toneMapping=Is,this.toneMappingExposure=1;let zr=this,Fr=!1,Nr=0,tn=0,rn=null,Tn=-1,$n=null,un=new Ze$1,es=new Ze$1,kn=null,ts=st.width,Ko=st.height,ds=1,Il=null,ru=null,uu=new Ze$1(0,0,ts,Ko),p0=new Ze$1(0,0,ts,Ko),X1=!1,q0=new cp,W0=!1,hu=!1,a1=null,Vx=new ue$1,t0=new U$1,cu=new E$6,lu={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function b0(){return rn===null?ds:1}let l1=mt;function LE(s$,C$){for(let Y$=0;Y$<s$.length;Y$++){let P$=s$[Y$],N$=st.getContext(P$,C$);if(N$!==null)return N$}return null}try{let s$={alpha:!0,depth:gt,stencil:_t,antialias:Et,premultipliedAlpha:At,preserveDrawingBuffer:Rt,powerPreference:Ft,failIfMajorPerformanceCaveat:Nt};if("setAttribute"in st&&st.setAttribute("data-engine",`three.js r${la}`),st.addEventListener("webglcontextlost",I7,!1),st.addEventListener("webglcontextrestored",j$,!1),st.addEventListener("webglcontextcreationerror",_$,!1),l1===null){let C$=["webgl2","webgl","experimental-webgl"];if(zr.isWebGL1Renderer===!0&&C$.shift(),l1=LE(C$,s$),l1===null)throw LE(C$)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}l1.getShaderPrecisionFormat===void 0&&(l1.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(s$){throw console.error("THREE.WebGLRenderer: "+s$.message),s$}let eS,SA,o$,h$,d$,y$,R$,M$,x$,v$,rS,wA,g$,S$,tA,tS,m$,u$,UE,F$,EI,pR,X$,J$;function gD(){eS=new bk(l1),SA=new pk(l1,eS,nt),eS.init(SA),pR=new QG(l1,eS,SA),o$=new YG(l1,eS,SA),h$=new Ak,d$=new BG,y$=new XG(l1,eS,o$,d$,SA,pR,h$),R$=new gk(zr),M$=new xk(zr),x$=new OV(l1,SA),X$=new dk(l1,eS,x$,SA),v$=new Sk(l1,x$,h$,X$),rS=new Ck(l1,v$,x$,h$),UE=new Tk(l1,SA,y$),tS=new mk(d$),wA=new LG(zr,R$,M$,eS,SA,X$,tS),g$=new ZG(zr,d$),S$=new FG,tA=new jG(eS,SA),u$=new hk(zr,R$,M$,o$,rS,Bt,At),m$=new qG(zr,rS,SA),J$=new JG(l1,h$,SA,o$),F$=new fk(l1,eS,h$,SA),EI=new wk(l1,eS,h$,SA),h$.programs=wA.programs,zr.capabilities=SA,zr.extensions=eS,zr.properties=d$,zr.renderLists=S$,zr.shadowMap=m$,zr.state=o$,zr.info=h$}gD();let fL=new iw(zr,l1);this.xr=fL,this.getContext=function(){return l1},this.getContextAttributes=function(){return l1.getContextAttributes()},this.forceContextLoss=function(){let s$=eS.get("WEBGL_lose_context");s$&&s$.loseContext()},this.forceContextRestore=function(){let s$=eS.get("WEBGL_lose_context");s$&&s$.restoreContext()},this.getPixelRatio=function(){return ds},this.setPixelRatio=function(s$){s$!==void 0&&(ds=s$,this.setSize(ts,Ko,!1))},this.getSize=function(s$){return s$.set(ts,Ko)},this.setSize=function(s$,C$,Y$){if(fL.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ts=s$,Ko=C$,st.width=Math.floor(s$*ds),st.height=Math.floor(C$*ds),Y$!==!1&&(st.style.width=s$+"px",st.style.height=C$+"px"),this.setViewport(0,0,s$,C$)},this.getDrawingBufferSize=function(s$){return s$.set(ts*ds,Ko*ds).floor()},this.setDrawingBufferSize=function(s$,C$,Y$){ts=s$,Ko=C$,ds=Y$,st.width=Math.floor(s$*Y$),st.height=Math.floor(C$*Y$),this.setViewport(0,0,s$,C$)},this.getCurrentViewport=function(s$){return s$.copy(un)},this.getViewport=function(s$){return s$.copy(uu)},this.setViewport=function(s$,C$,Y$,P$){s$.isVector4?uu.set(s$.x,s$.y,s$.z,s$.w):uu.set(s$,C$,Y$,P$),o$.viewport(un.copy(uu).multiplyScalar(ds).floor())},this.getScissor=function(s$){return s$.copy(p0)},this.setScissor=function(s$,C$,Y$,P$){s$.isVector4?p0.set(s$.x,s$.y,s$.z,s$.w):p0.set(s$,C$,Y$,P$),o$.scissor(es.copy(p0).multiplyScalar(ds).floor())},this.getScissorTest=function(){return X1},this.setScissorTest=function(s$){o$.setScissorTest(X1=s$)},this.setOpaqueSort=function(s$){Il=s$},this.setTransparentSort=function(s$){ru=s$},this.getClearColor=function(s$){return s$.copy(u$.getClearColor())},this.setClearColor=function(){u$.setClearColor.apply(u$,arguments)},this.getClearAlpha=function(){return u$.getClearAlpha()},this.setClearAlpha=function(){u$.setClearAlpha.apply(u$,arguments)},this.clear=function(s$=!0,C$=!0,Y$=!0){let P$=0;s$&&(P$|=16384),C$&&(P$|=256),Y$&&(P$|=1024),l1.clear(P$)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){st.removeEventListener("webglcontextlost",I7,!1),st.removeEventListener("webglcontextrestored",j$,!1),st.removeEventListener("webglcontextcreationerror",_$,!1),S$.dispose(),tA.dispose(),d$.dispose(),R$.dispose(),M$.dispose(),rS.dispose(),X$.dispose(),J$.dispose(),wA.dispose(),fL.dispose(),fL.removeEventListener("sessionstart",O$),fL.removeEventListener("sessionend",Z$),a1&&(a1.dispose(),a1=null),mL.stop()};function I7(s$){s$.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Fr=!0}function j$(){console.log("THREE.WebGLRenderer: Context Restored."),Fr=!1;let s$=h$.autoReset,C$=m$.enabled,Y$=m$.autoUpdate,P$=m$.needsUpdate,N$=m$.type;gD(),h$.autoReset=s$,m$.enabled=C$,m$.autoUpdate=Y$,m$.needsUpdate=P$,m$.type=N$}function _$(s$){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",s$.statusMessage)}function I$(s$){let C$=s$.target;C$.removeEventListener("dispose",I$),GL(C$)}function GL(s$){w$(s$),d$.remove(s$)}function w$(s$){let C$=d$.get(s$).programs;C$!==void 0&&(C$.forEach(function(Y$){wA.releaseProgram(Y$)}),s$.isShaderMaterial&&wA.releaseShaderCache(s$))}this.renderBufferDirect=function(s$,C$,Y$,P$,N$,H3){C$===null&&(C$=lu);let D7=N$.isMesh&&N$.matrixWorld.determinant()<0,Tq=gR(s$,C$,Y$,P$,N$);o$.setMaterial(P$,D7);let Cq=Y$.index,PK=1;P$.wireframe===!0&&(Cq=v$.getWireframeAttribute(Y$),PK=2);let Nq=Y$.drawRange,DK=Y$.attributes.position,yK=Nq.start*PK,hee=(Nq.start+Nq.count)*PK;H3!==null&&(yK=Math.max(yK,H3.start*PK),hee=Math.min(hee,(H3.start+H3.count)*PK)),Cq!==null?(yK=Math.max(yK,0),hee=Math.min(hee,Cq.count)):DK!=null&&(yK=Math.max(yK,0),hee=Math.min(hee,DK.count));let Cee=hee-yK;if(Cee<0||Cee===1/0)return;X$.setup(N$,P$,Tq,Y$,Cq);let Oee,fee=F$;if(Cq!==null&&(Oee=x$.get(Cq),fee=EI,fee.setIndex(Oee)),N$.isMesh)P$.wireframe===!0?(o$.setLineWidth(P$.wireframeLinewidth*b0()),fee.setMode(1)):fee.setMode(4);else if(N$.isLine){let GQ=P$.linewidth;GQ===void 0&&(GQ=1),o$.setLineWidth(GQ*b0()),N$.isLineSegments?fee.setMode(1):N$.isLineLoop?fee.setMode(2):fee.setMode(3)}else N$.isPoints?fee.setMode(0):N$.isSprite&&fee.setMode(4);if(N$.isInstancedMesh)fee.renderInstances(yK,Cee,N$.count);else if(Y$.isInstancedBufferGeometry){let GQ=Y$._maxInstanceCount!==void 0?Y$._maxInstanceCount:1/0,Tee=Math.min(Y$.instanceCount,GQ);fee.renderInstances(yK,Cee,Tee)}else fee.render(yK,Cee)},this.compile=function(s$,C$){function Y$(P$,N$,H3){P$.transparent===!0&&P$.side===fi&&P$.forceSinglePass===!1?(P$.side=pi,P$.needsUpdate=!0,q$(P$,N$,H3),P$.side=Hn,P$.needsUpdate=!0,q$(P$,N$,H3),P$.side=fi):q$(P$,N$,H3)}dr=tA.get(s$),dr.init(),Tr.push(dr),s$.traverseVisible(function(P$){P$.isLight&&P$.layers.test(C$.layers)&&(dr.pushLight(P$),P$.castShadow&&dr.pushShadow(P$))}),dr.setupLights(zr.physicallyCorrectLights),s$.traverse(function(P$){let N$=P$.material;if(N$)if(Array.isArray(N$))for(let H3=0;H3<N$.length;H3++){let D7=N$[H3];Y$(D7,s$,P$)}else Y$(N$,s$,P$)}),Tr.pop(),dr=null};let B$=null;function r$(s$){B$&&B$(s$)}function O$(){mL.stop()}function Z$(){mL.start()}let mL=new ZC;mL.setAnimationLoop(r$),typeof self<"u"&&mL.setContext(self),this.setAnimationLoop=function(s$){B$=s$,fL.setAnimationLoop(s$),s$===null?mL.stop():mL.start()},fL.addEventListener("sessionstart",O$),fL.addEventListener("sessionend",Z$),this.render=function(s$,C$){if(C$!==void 0&&C$.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Fr===!0)return;s$.matrixWorldAutoUpdate===!0&&s$.updateMatrixWorld(),C$.parent===null&&C$.matrixWorldAutoUpdate===!0&&C$.updateMatrixWorld(),fL.enabled===!0&&fL.isPresenting===!0&&(fL.cameraAutoUpdate===!0&&fL.updateCamera(C$),C$=fL.getCamera()),s$.isScene===!0&&s$.onBeforeRender(zr,s$,C$,rn),dr=tA.get(s$,Tr.length),dr.init(),Tr.push(dr),Vx.multiplyMatrices(C$.projectionMatrix,C$.matrixWorldInverse),q0.setFromProjectionMatrix(Vx),hu=this.localClippingEnabled,W0=tS.init(this.clippingPlanes,hu),Gt=S$.get(s$,Mr.length),Gt.init(),Mr.push(Gt),P7(s$,C$,0,zr.sortObjects),Gt.finish(),zr.sortObjects===!0&&Gt.sort(Il,ru),W0===!0&&tS.beginShadows();let Y$=dr.state.shadowsArray;if(m$.render(Y$,s$,C$),W0===!0&&tS.endShadows(),this.info.autoReset===!0&&this.info.reset(),u$.render(Gt,s$),dr.setupLights(zr.physicallyCorrectLights),C$.isArrayCamera){let P$=C$.cameras;for(let N$=0,H3=P$.length;N$<H3;N$++){let D7=P$[N$];L9(Gt,s$,D7,D7.viewport)}}else L9(Gt,s$,C$);rn!==null&&(y$.updateMultisampleRenderTarget(rn),y$.updateRenderTargetMipmap(rn)),s$.isScene===!0&&s$.onAfterRender(zr,s$,C$),X$.resetDefaultState(),Tn=-1,$n=null,Tr.pop(),Tr.length>0?dr=Tr[Tr.length-1]:dr=null,Mr.pop(),Mr.length>0?Gt=Mr[Mr.length-1]:Gt=null};function P7(s$,C$,Y$,P$){if(s$.visible===!1)return;if(s$.layers.test(C$.layers)){if(s$.isGroup)Y$=s$.renderOrder;else if(s$.isLOD)s$.autoUpdate===!0&&s$.update(C$);else if(s$.isLight)dr.pushLight(s$),s$.castShadow&&dr.pushShadow(s$);else if(s$.isSprite){if(!s$.frustumCulled||q0.intersectsSprite(s$)){P$&&cu.setFromMatrixPosition(s$.matrixWorld).applyMatrix4(Vx);let H3=rS.update(s$),D7=s$.material;D7.visible&&Gt.push(s$,H3,D7,Y$,cu.z,null)}}else if((s$.isMesh||s$.isLine||s$.isPoints)&&(s$.isSkinnedMesh&&s$.skeleton.frame!==h$.render.frame&&(s$.skeleton.update(),s$.skeleton.frame=h$.render.frame),!s$.frustumCulled||q0.intersectsObject(s$))){P$&&cu.setFromMatrixPosition(s$.matrixWorld).applyMatrix4(Vx);let H3=rS.update(s$),D7=s$.material;if(Array.isArray(D7)){let Tq=H3.groups;for(let Cq=0,PK=Tq.length;Cq<PK;Cq++){let Nq=Tq[Cq],DK=D7[Nq.materialIndex];DK&&DK.visible&&Gt.push(s$,H3,DK,Y$,cu.z,Nq)}}else D7.visible&&Gt.push(s$,H3,D7,Y$,cu.z,null)}}let N$=s$.children;for(let H3=0,D7=N$.length;H3<D7;H3++)P7(N$[H3],C$,Y$,P$)}function L9(s$,C$,Y$,P$){let N$=s$.opaque,H3=s$.transmissive,D7=s$.transparent;dr.setupLightsView(Y$),W0===!0&&tS.setGlobalState(zr.clippingPlanes,Y$),H3.length>0&&f$(N$,C$,Y$),P$&&o$.viewport(un.copy(P$)),N$.length>0&&l$(N$,C$,Y$),H3.length>0&&l$(H3,C$,Y$),D7.length>0&&l$(D7,C$,Y$),o$.buffers.depth.setTest(!0),o$.buffers.depth.setMask(!0),o$.buffers.color.setMask(!0),o$.setPolygonOffset(!1)}function f$(s$,C$,Y$){let P$=SA.isWebGL2;a1===null&&(a1=new dt$1(1,1,{generateMipmaps:!0,type:eS.has("EXT_color_buffer_half_float")?Wn:_r,minFilter:dc,samples:P$&&Et===!0?4:0})),zr.getDrawingBufferSize(t0),P$?a1.setSize(t0.x,t0.y):a1.setSize(Zg(t0.x),Zg(t0.y));let N$=zr.getRenderTarget();zr.setRenderTarget(a1),zr.clear();let H3=zr.toneMapping;zr.toneMapping=Is,l$(s$,C$,Y$),zr.toneMapping=H3,y$.updateMultisampleRenderTarget(a1),y$.updateRenderTargetMipmap(a1),zr.setRenderTarget(N$)}function l$(s$,C$,Y$){let P$=C$.isScene===!0?C$.overrideMaterial:null;for(let N$=0,H3=s$.length;N$<H3;N$++){let D7=s$[N$],Tq=D7.object,Cq=D7.geometry,PK=P$===null?D7.material:P$,Nq=D7.group;Tq.layers.test(Y$.layers)&&T$(Tq,C$,Y$,Cq,PK,Nq)}}function T$(s$,C$,Y$,P$,N$,H3){s$.onBeforeRender(zr,C$,Y$,P$,N$,H3),s$.modelViewMatrix.multiplyMatrices(Y$.matrixWorldInverse,s$.matrixWorld),s$.normalMatrix.getNormalMatrix(s$.modelViewMatrix),N$.onBeforeRender(zr,C$,Y$,P$,s$,H3),N$.transparent===!0&&N$.side===fi&&N$.forceSinglePass===!1?(N$.side=pi,N$.needsUpdate=!0,zr.renderBufferDirect(Y$,C$,P$,N$,s$,H3),N$.side=Hn,N$.needsUpdate=!0,zr.renderBufferDirect(Y$,C$,P$,N$,s$,H3),N$.side=fi):zr.renderBufferDirect(Y$,C$,P$,N$,s$,H3),s$.onAfterRender(zr,C$,Y$,P$,N$,H3)}function q$(s$,C$,Y$){C$.isScene!==!0&&(C$=lu);let P$=d$.get(s$),N$=dr.state.lights,H3=dr.state.shadowsArray,D7=N$.state.version,Tq=wA.getParameters(s$,N$.state,H3,C$,Y$),Cq=wA.getProgramCacheKey(Tq),PK=P$.programs;P$.environment=s$.isMeshStandardMaterial?C$.environment:null,P$.fog=C$.fog,P$.envMap=(s$.isMeshStandardMaterial?M$:R$).get(s$.envMap||P$.environment),PK===void 0&&(s$.addEventListener("dispose",I$),PK=new Map,P$.programs=PK);let Nq=PK.get(Cq);if(Nq!==void 0){if(P$.currentProgram===Nq&&P$.lightsStateVersion===D7)return Q$(s$,Tq),Nq}else Tq.uniforms=wA.getUniforms(s$),s$.onBuild(Y$,Tq,zr),s$.onBeforeCompile(Tq,zr),Nq=wA.acquireProgram(Tq,Cq),PK.set(Cq,Nq),P$.uniforms=Tq.uniforms;let DK=P$.uniforms;(!s$.isShaderMaterial&&!s$.isRawShaderMaterial||s$.clipping===!0)&&(DK.clippingPlanes=tS.uniform),Q$(s$,Tq),P$.needsLights=Pq(s$),P$.lightsStateVersion=D7,P$.needsLights&&(DK.ambientLightColor.value=N$.state.ambient,DK.lightProbe.value=N$.state.probe,DK.directionalLights.value=N$.state.directional,DK.directionalLightShadows.value=N$.state.directionalShadow,DK.spotLights.value=N$.state.spot,DK.spotLightShadows.value=N$.state.spotShadow,DK.rectAreaLights.value=N$.state.rectArea,DK.ltc_1.value=N$.state.rectAreaLTC1,DK.ltc_2.value=N$.state.rectAreaLTC2,DK.pointLights.value=N$.state.point,DK.pointLightShadows.value=N$.state.pointShadow,DK.hemisphereLights.value=N$.state.hemi,DK.directionalShadowMap.value=N$.state.directionalShadowMap,DK.directionalShadowMatrix.value=N$.state.directionalShadowMatrix,DK.spotShadowMap.value=N$.state.spotShadowMap,DK.spotLightMatrix.value=N$.state.spotLightMatrix,DK.spotLightMap.value=N$.state.spotLightMap,DK.pointShadowMap.value=N$.state.pointShadowMap,DK.pointShadowMatrix.value=N$.state.pointShadowMatrix);let yK=Nq.getUniforms(),hee=Iu.seqWithValue(yK.seq,DK);return P$.currentProgram=Nq,P$.uniformsList=hee,Nq}function Q$(s$,C$){let Y$=d$.get(s$);Y$.outputEncoding=C$.outputEncoding,Y$.instancing=C$.instancing,Y$.skinning=C$.skinning,Y$.morphTargets=C$.morphTargets,Y$.morphNormals=C$.morphNormals,Y$.morphColors=C$.morphColors,Y$.morphTargetsCount=C$.morphTargetsCount,Y$.numClippingPlanes=C$.numClippingPlanes,Y$.numIntersection=C$.numClipIntersection,Y$.vertexAlphas=C$.vertexAlphas,Y$.vertexTangents=C$.vertexTangents,Y$.toneMapping=C$.toneMapping}function gR(s$,C$,Y$,P$,N$){C$.isScene!==!0&&(C$=lu),y$.resetTextureUnits();let H3=C$.fog,D7=P$.isMeshStandardMaterial?C$.environment:null,Tq=rn===null?zr.outputEncoding:rn.isXRRenderTarget===!0?rn.texture.encoding:mn,Cq=(P$.isMeshStandardMaterial?M$:R$).get(P$.envMap||D7),PK=P$.vertexColors===!0&&!!Y$.attributes.color&&Y$.attributes.color.itemSize===4,Nq=!!P$.normalMap&&!!Y$.attributes.tangent,DK=!!Y$.morphAttributes.position,yK=!!Y$.morphAttributes.normal,hee=!!Y$.morphAttributes.color,Cee=P$.toneMapped?zr.toneMapping:Is,Oee=Y$.morphAttributes.position||Y$.morphAttributes.normal||Y$.morphAttributes.color,fee=Oee!==void 0?Oee.length:0,GQ=d$.get(P$),Tee=dr.state.lights;if(W0===!0&&(hu===!0||s$!==$n)){let p$=s$===$n&&P$.id===Tn;tS.setState(P$,s$,p$)}let YQ=!1;P$.version===GQ.__version?(GQ.needsLights&&GQ.lightsStateVersion!==Tee.state.version||GQ.outputEncoding!==Tq||N$.isInstancedMesh&&GQ.instancing===!1||!N$.isInstancedMesh&&GQ.instancing===!0||N$.isSkinnedMesh&&GQ.skinning===!1||!N$.isSkinnedMesh&&GQ.skinning===!0||GQ.envMap!==Cq||P$.fog===!0&&GQ.fog!==H3||GQ.numClippingPlanes!==void 0&&(GQ.numClippingPlanes!==tS.numPlanes||GQ.numIntersection!==tS.numIntersection)||GQ.vertexAlphas!==PK||GQ.vertexTangents!==Nq||GQ.morphTargets!==DK||GQ.morphNormals!==yK||GQ.morphColors!==hee||GQ.toneMapping!==Cee||SA.isWebGL2===!0&&GQ.morphTargetsCount!==fee)&&(YQ=!0):(YQ=!0,GQ.__version=P$.version);let kee=GQ.currentProgram;YQ===!0&&(kee=q$(P$,C$,N$));let Nee=!1,zee=!1,Ree=!1,AA=kee.getUniforms(),c$=GQ.uniforms;if(o$.useProgram(kee.program)&&(Nee=!0,zee=!0,Ree=!0),P$.id!==Tn&&(Tn=P$.id,zee=!0),Nee||$n!==s$){if(AA.setValue(l1,"projectionMatrix",s$.projectionMatrix),SA.logarithmicDepthBuffer&&AA.setValue(l1,"logDepthBufFC",2/(Math.log(s$.far+1)/Math.LN2)),$n!==s$&&($n=s$,zee=!0,Ree=!0),P$.isShaderMaterial||P$.isMeshPhongMaterial||P$.isMeshToonMaterial||P$.isMeshStandardMaterial||P$.envMap){let p$=AA.map.cameraPosition;p$!==void 0&&p$.setValue(l1,cu.setFromMatrixPosition(s$.matrixWorld))}(P$.isMeshPhongMaterial||P$.isMeshToonMaterial||P$.isMeshLambertMaterial||P$.isMeshBasicMaterial||P$.isMeshStandardMaterial||P$.isShaderMaterial)&&AA.setValue(l1,"isOrthographic",s$.isOrthographicCamera===!0),(P$.isMeshPhongMaterial||P$.isMeshToonMaterial||P$.isMeshLambertMaterial||P$.isMeshBasicMaterial||P$.isMeshStandardMaterial||P$.isShaderMaterial||P$.isShadowMaterial||N$.isSkinnedMesh)&&AA.setValue(l1,"viewMatrix",s$.matrixWorldInverse)}if(N$.isSkinnedMesh){AA.setOptional(l1,N$,"bindMatrix"),AA.setOptional(l1,N$,"bindMatrixInverse");let p$=N$.skeleton;p$&&(SA.floatVertexTextures?(p$.boneTexture===null&&p$.computeBoneTexture(),AA.setValue(l1,"boneTexture",p$.boneTexture,y$),AA.setValue(l1,"boneTextureSize",p$.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let $$=Y$.morphAttributes;if(($$.position!==void 0||$$.normal!==void 0||$$.color!==void 0&&SA.isWebGL2===!0)&&UE.update(N$,Y$,P$,kee),(zee||GQ.receiveShadow!==N$.receiveShadow)&&(GQ.receiveShadow=N$.receiveShadow,AA.setValue(l1,"receiveShadow",N$.receiveShadow)),P$.isMeshGouraudMaterial&&P$.envMap!==null&&(c$.envMap.value=Cq,c$.flipEnvMap.value=Cq.isCubeTexture&&Cq.isRenderTargetTexture===!1?-1:1),zee&&(AA.setValue(l1,"toneMappingExposure",zr.toneMappingExposure),GQ.needsLights&&kI(c$,Ree),H3&&P$.fog===!0&&g$.refreshFogUniforms(c$,H3),g$.refreshMaterialUniforms(c$,P$,ds,Ko,a1),Iu.upload(l1,GQ.uniformsList,c$,y$)),P$.isShaderMaterial&&P$.uniformsNeedUpdate===!0&&(Iu.upload(l1,GQ.uniformsList,c$,y$),P$.uniformsNeedUpdate=!1),P$.isSpriteMaterial&&AA.setValue(l1,"center",N$.center),AA.setValue(l1,"modelViewMatrix",N$.modelViewMatrix),AA.setValue(l1,"normalMatrix",N$.normalMatrix),AA.setValue(l1,"modelMatrix",N$.matrixWorld),N$.previousModelViewMatrix&&AA.setValue(l1,"previousModelViewMatrix",N$.previousModelViewMatrix),s$.previousProjectionMatrix&&AA.setValue(l1,"previousProjectionMatrix",s$.previousProjectionMatrix),P$.isShaderMaterial||P$.isRawShaderMaterial){let p$=P$.uniformsGroups;for(let H$=0,Q9=p$.length;H$<Q9;H$++)if(SA.isWebGL2){let Lee=p$[H$];J$.update(Lee,kee),J$.bind(Lee,kee)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return kee}function kI(s$,C$){s$.ambientLightColor.needsUpdate=C$,s$.lightProbe.needsUpdate=C$,s$.directionalLights.needsUpdate=C$,s$.directionalLightShadows.needsUpdate=C$,s$.pointLights.needsUpdate=C$,s$.pointLightShadows.needsUpdate=C$,s$.spotLights.needsUpdate=C$,s$.spotLightShadows.needsUpdate=C$,s$.rectAreaLights.needsUpdate=C$,s$.hemisphereLights.needsUpdate=C$}function Pq(s$){return s$.isMeshLambertMaterial||s$.isMeshToonMaterial||s$.isMeshPhongMaterial||s$.isMeshStandardMaterial||s$.isShadowMaterial||s$.isShaderMaterial&&s$.lights===!0}this.getActiveCubeFace=function(){return Nr},this.getActiveMipmapLevel=function(){return tn},this.getRenderTarget=function(){return rn},this.setRenderTargetTextures=function(s$,C$,Y$){d$.get(s$.texture).__webglTexture=C$,d$.get(s$.depthTexture).__webglTexture=Y$;let P$=d$.get(s$);P$.__hasExternalTextures=!0,P$.__hasExternalTextures&&(P$.__autoAllocateDepthBuffer=Y$===void 0,P$.__autoAllocateDepthBuffer||eS.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),P$.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(s$,C$){let Y$=d$.get(s$);Y$.__webglFramebuffer=C$,Y$.__useDefaultFramebuffer=C$===void 0},this.setRenderTarget=function(s$,C$=0,Y$=0){rn=s$,Nr=C$,tn=Y$;let P$=!0,N$=null,H3=!1,D7=!1;if(s$){let Tq=d$.get(s$);Tq.__useDefaultFramebuffer!==void 0?(o$.bindFramebuffer(36160,null),P$=!1):Tq.__webglFramebuffer===void 0?y$.setupRenderTarget(s$):Tq.__hasExternalTextures&&y$.rebindTextures(s$,d$.get(s$.texture).__webglTexture,d$.get(s$.depthTexture).__webglTexture);let Cq=s$.texture;(Cq.isData3DTexture||Cq.isDataArrayTexture||Cq.isCompressedArrayTexture)&&(D7=!0);let PK=d$.get(s$).__webglFramebuffer;s$.isWebGLCubeRenderTarget?(N$=PK[C$],H3=!0):SA.isWebGL2&&s$.samples>0&&y$.useMultisampledRTT(s$)===!1?N$=d$.get(s$).__webglMultisampledFramebuffer:N$=PK,un.copy(s$.viewport),es.copy(s$.scissor),kn=s$.scissorTest}else un.copy(uu).multiplyScalar(ds).floor(),es.copy(p0).multiplyScalar(ds).floor(),kn=X1;if(o$.bindFramebuffer(36160,N$)&&SA.drawBuffers&&P$&&o$.drawBuffers(s$,N$),o$.viewport(un),o$.scissor(es),o$.setScissorTest(kn),H3){let Tq=d$.get(s$.texture);l1.framebufferTexture2D(36160,36064,34069+C$,Tq.__webglTexture,Y$)}else if(D7){let Tq=d$.get(s$.texture),Cq=C$||0;l1.framebufferTextureLayer(36160,36064,Tq.__webglTexture,Y$||0,Cq)}Tn=-1},this.readRenderTargetPixels=function(s$,C$,Y$,P$,N$,H3,D7){if(!(s$&&s$.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Tq=d$.get(s$).__webglFramebuffer;if(s$.isWebGLCubeRenderTarget&&D7!==void 0&&(Tq=Tq[D7]),Tq){o$.bindFramebuffer(36160,Tq);try{let Cq=s$.texture,PK=Cq.format,Nq=Cq.type;if(PK!==qr&&pR.convert(PK)!==l1.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let DK=Nq===Wn&&(eS.has("EXT_color_buffer_half_float")||SA.isWebGL2&&eS.has("EXT_color_buffer_float"));if(Nq!==_r&&pR.convert(Nq)!==l1.getParameter(35738)&&!(Nq===br&&(SA.isWebGL2||eS.has("OES_texture_float")||eS.has("WEBGL_color_buffer_float")))&&!DK){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}C$>=0&&C$<=s$.width-P$&&Y$>=0&&Y$<=s$.height-N$&&l1.readPixels(C$,Y$,P$,N$,pR.convert(PK),pR.convert(Nq),H3)}finally{let Cq=rn!==null?d$.get(rn).__webglFramebuffer:null;o$.bindFramebuffer(36160,Cq)}}},this.copyFramebufferToTexture=function(s$,C$,Y$=0){let P$=Math.pow(2,-Y$),N$=Math.floor(C$.image.width*P$),H3=Math.floor(C$.image.height*P$);y$.setTexture2D(C$,0),l1.copyTexSubImage2D(3553,Y$,0,0,s$.x,s$.y,N$,H3),o$.unbindTexture()},this.copyTextureToTexture=function(s$,C$,Y$,P$=0){let N$=C$.image.width,H3=C$.image.height,D7=pR.convert(Y$.format),Tq=pR.convert(Y$.type);y$.setTexture2D(Y$,0),l1.pixelStorei(37440,Y$.flipY),l1.pixelStorei(37441,Y$.premultiplyAlpha),l1.pixelStorei(3317,Y$.unpackAlignment),C$.isDataTexture?l1.texSubImage2D(3553,P$,s$.x,s$.y,N$,H3,D7,Tq,C$.image.data):C$.isCompressedTexture?l1.compressedTexSubImage2D(3553,P$,s$.x,s$.y,C$.mipmaps[0].width,C$.mipmaps[0].height,D7,C$.mipmaps[0].data):l1.texSubImage2D(3553,P$,s$.x,s$.y,D7,Tq,C$.image),P$===0&&Y$.generateMipmaps&&l1.generateMipmap(3553),o$.unbindTexture()},this.copyTextureToTexture3D=function(s$,C$,Y$,P$,N$=0){if(zr.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let H3=s$.max.x-s$.min.x+1,D7=s$.max.y-s$.min.y+1,Tq=s$.max.z-s$.min.z+1,Cq=pR.convert(P$.format),PK=pR.convert(P$.type),Nq;if(P$.isData3DTexture)y$.setTexture3D(P$,0),Nq=32879;else if(P$.isDataArrayTexture)y$.setTexture2DArray(P$,0),Nq=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}l1.pixelStorei(37440,P$.flipY),l1.pixelStorei(37441,P$.premultiplyAlpha),l1.pixelStorei(3317,P$.unpackAlignment);let DK=l1.getParameter(3314),yK=l1.getParameter(32878),hee=l1.getParameter(3316),Cee=l1.getParameter(3315),Oee=l1.getParameter(32877),fee=Y$.isCompressedTexture?Y$.mipmaps[0]:Y$.image;l1.pixelStorei(3314,fee.width),l1.pixelStorei(32878,fee.height),l1.pixelStorei(3316,s$.min.x),l1.pixelStorei(3315,s$.min.y),l1.pixelStorei(32877,s$.min.z),Y$.isDataTexture||Y$.isData3DTexture?l1.texSubImage3D(Nq,N$,C$.x,C$.y,C$.z,H3,D7,Tq,Cq,PK,fee.data):Y$.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),l1.compressedTexSubImage3D(Nq,N$,C$.x,C$.y,C$.z,H3,D7,Tq,Cq,fee.data)):l1.texSubImage3D(Nq,N$,C$.x,C$.y,C$.z,H3,D7,Tq,Cq,PK,fee),l1.pixelStorei(3314,DK),l1.pixelStorei(32878,yK),l1.pixelStorei(3316,hee),l1.pixelStorei(3315,Cee),l1.pixelStorei(32877,Oee),N$===0&&P$.generateMipmaps&&l1.generateMipmap(Nq),o$.unbindTexture()},this.initTexture=function(s$){s$.isCubeTexture?y$.setTextureCube(s$,0):s$.isData3DTexture?y$.setTexture3D(s$,0):s$.isDataArrayTexture||s$.isCompressedArrayTexture?y$.setTexture2DArray(s$,0):y$.setTexture2D(s$,0),o$.unbindTexture()},this.resetState=function(){Nr=0,tn=0,rn=null,o$.reset(),X$.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var nw=class extends _w{};nw.prototype.isWebGL1Renderer=!0;var Lu=class{constructor(nt,st=1,mt=1e3){this.isFog=!0,this.name="",this.color=new We$1(nt),this.near=st,this.far=mt}clone(){return new Lu(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},ei=class extends Mt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(nt,st){return super.copy(nt,st),nt.background!==null&&(this.background=nt.background.clone()),nt.environment!==null&&(this.environment=nt.environment.clone()),nt.fog!==null&&(this.fog=nt.fog.clone()),this.backgroundBlurriness=nt.backgroundBlurriness,this.backgroundIntensity=nt.backgroundIntensity,nt.overrideMaterial!==null&&(this.overrideMaterial=nt.overrideMaterial.clone()),this.matrixAutoUpdate=nt.matrixAutoUpdate,this}toJSON(nt){let st=super.toJSON(nt);return this.fog!==null&&(st.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(st.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(st.object.backgroundIntensity=this.backgroundIntensity),st}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(nt){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=nt}},sy=class{constructor(nt,st){this.isInterleavedBuffer=!0,this.array=nt,this.stride=st,this.count=nt!==void 0?nt.length/st:0,this.usage=HS,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=is()}onUploadCallback(){}set needsUpdate(nt){nt===!0&&this.version++}setUsage(nt){return this.usage=nt,this}copy(nt){return this.array=new nt.array.constructor(nt.array),this.count=nt.count,this.stride=nt.stride,this.usage=nt.usage,this}copyAt(nt,st,mt){nt*=this.stride,mt*=st.stride;for(let gt=0,_t=this.stride;gt<_t;gt++)this.array[nt+gt]=st.array[mt+gt];return this}set(nt,st=0){return this.array.set(nt,st),this}clone(nt){nt.arrayBuffers===void 0&&(nt.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=is()),nt.arrayBuffers[this.array.buffer._uuid]===void 0&&(nt.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let st=new this.array.constructor(nt.arrayBuffers[this.array.buffer._uuid]),mt=new this.constructor(st,this.stride);return mt.setUsage(this.usage),mt}onUpload(nt){return this.onUploadCallback=nt,this}toJSON(nt){return nt.arrayBuffers===void 0&&(nt.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=is()),nt.arrayBuffers[this.array.buffer._uuid]===void 0&&(nt.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},fn=new E$6,pc=class{constructor(nt,st,mt,gt=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=nt,this.itemSize=st,this.offset=mt,this.normalized=gt}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(nt){this.data.needsUpdate=nt}applyMatrix4(nt){for(let st=0,mt=this.data.count;st<mt;st++)fn.fromBufferAttribute(this,st),fn.applyMatrix4(nt),this.setXYZ(st,fn.x,fn.y,fn.z);return this}applyNormalMatrix(nt){for(let st=0,mt=this.count;st<mt;st++)fn.fromBufferAttribute(this,st),fn.applyNormalMatrix(nt),this.setXYZ(st,fn.x,fn.y,fn.z);return this}transformDirection(nt){for(let st=0,mt=this.count;st<mt;st++)fn.fromBufferAttribute(this,st),fn.transformDirection(nt),this.setXYZ(st,fn.x,fn.y,fn.z);return this}setX(nt,st){return this.normalized&&(st=xr(st,this.array)),this.data.array[nt*this.data.stride+this.offset]=st,this}setY(nt,st){return this.normalized&&(st=xr(st,this.array)),this.data.array[nt*this.data.stride+this.offset+1]=st,this}setZ(nt,st){return this.normalized&&(st=xr(st,this.array)),this.data.array[nt*this.data.stride+this.offset+2]=st,this}setW(nt,st){return this.normalized&&(st=xr(st,this.array)),this.data.array[nt*this.data.stride+this.offset+3]=st,this}getX(nt){let st=this.data.array[nt*this.data.stride+this.offset];return this.normalized&&(st=oa(st,this.array)),st}getY(nt){let st=this.data.array[nt*this.data.stride+this.offset+1];return this.normalized&&(st=oa(st,this.array)),st}getZ(nt){let st=this.data.array[nt*this.data.stride+this.offset+2];return this.normalized&&(st=oa(st,this.array)),st}getW(nt){let st=this.data.array[nt*this.data.stride+this.offset+3];return this.normalized&&(st=oa(st,this.array)),st}setXY(nt,st,mt){return nt=nt*this.data.stride+this.offset,this.normalized&&(st=xr(st,this.array),mt=xr(mt,this.array)),this.data.array[nt+0]=st,this.data.array[nt+1]=mt,this}setXYZ(nt,st,mt,gt){return nt=nt*this.data.stride+this.offset,this.normalized&&(st=xr(st,this.array),mt=xr(mt,this.array),gt=xr(gt,this.array)),this.data.array[nt+0]=st,this.data.array[nt+1]=mt,this.data.array[nt+2]=gt,this}setXYZW(nt,st,mt,gt,_t){return nt=nt*this.data.stride+this.offset,this.normalized&&(st=xr(st,this.array),mt=xr(mt,this.array),gt=xr(gt,this.array),_t=xr(_t,this.array)),this.data.array[nt+0]=st,this.data.array[nt+1]=mt,this.data.array[nt+2]=gt,this.data.array[nt+3]=_t,this}clone(nt){if(nt===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let st=[];for(let mt=0;mt<this.count;mt++){let gt=mt*this.data.stride+this.offset;for(let _t=0;_t<this.itemSize;_t++)st.push(this.data.array[gt+_t])}return new Xe$1(new this.array.constructor(st),this.itemSize,this.normalized)}else return nt.interleavedBuffers===void 0&&(nt.interleavedBuffers={}),nt.interleavedBuffers[this.data.uuid]===void 0&&(nt.interleavedBuffers[this.data.uuid]=this.data.clone(nt)),new pc(nt.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(nt){if(nt===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let st=[];for(let mt=0;mt<this.count;mt++){let gt=mt*this.data.stride+this.offset;for(let _t=0;_t<this.itemSize;_t++)st.push(this.data.array[gt+_t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:st,normalized:this.normalized}}else return nt.interleavedBuffers===void 0&&(nt.interleavedBuffers={}),nt.interleavedBuffers[this.data.uuid]===void 0&&(nt.interleavedBuffers[this.data.uuid]=this.data.toJSON(nt)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},hp=class extends Mt{constructor(){super(),this.isBone=!0,this.type="Bone"}},gi=class extends $t{constructor(nt=null,st=1,mt=1,gt,_t,Et,At,Rt,Ft=Vt,Nt=Vt,Bt,Gt){super(null,Et,At,Rt,Ft,Nt,gt,_t,Bt,Gt),this.isDataTexture=!0,this.image={data:nt,width:st,height:mt},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},vC=new ue$1,e4=new ue$1,$a=class{constructor(nt=[],st=[]){this.uuid=is(),this.bones=nt.slice(0),this.boneInverses=st,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let nt=this.bones,st=this.boneInverses;if(this.boneMatrices=new Float32Array(nt.length*16),st.length===0)this.calculateInverses();else if(nt.length!==st.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let mt=0,gt=this.bones.length;mt<gt;mt++)this.boneInverses.push(new ue$1)}}calculateInverses(){this.boneInverses.length=0;for(let nt=0,st=this.bones.length;nt<st;nt++){let mt=new ue$1;this.bones[nt]&&mt.copy(this.bones[nt].matrixWorld).invert(),this.boneInverses.push(mt)}}pose(){for(let nt=0,st=this.bones.length;nt<st;nt++){let mt=this.bones[nt];mt&&mt.matrixWorld.copy(this.boneInverses[nt]).invert()}for(let nt=0,st=this.bones.length;nt<st;nt++){let mt=this.bones[nt];mt&&(mt.parent&&mt.parent.isBone?(mt.matrix.copy(mt.parent.matrixWorld).invert(),mt.matrix.multiply(mt.matrixWorld)):mt.matrix.copy(mt.matrixWorld),mt.matrix.decompose(mt.position,mt.quaternion,mt.scale))}}update(){let nt=this.bones,st=this.boneInverses,mt=this.boneMatrices,gt=this.boneTexture;for(let _t=0,Et=nt.length;_t<Et;_t++){let At=nt[_t]?nt[_t].matrixWorld:e4;vC.multiplyMatrices(At,st[_t]),vC.toArray(mt,_t*16)}gt!==null&&(gt.needsUpdate=!0)}clone(){return new $a(this.bones,this.boneInverses)}computeBoneTexture(){let nt=Math.sqrt(this.bones.length*4);nt=YC(nt),nt=Math.max(nt,4);let st=new Float32Array(nt*nt*4);st.set(this.boneMatrices);let mt=new gi(st,nt,nt,qr,br);return mt.needsUpdate=!0,this.boneMatrices=st,this.boneTexture=mt,this.boneTextureSize=nt,this}getBoneByName(nt){for(let st=0,mt=this.bones.length;st<mt;st++){let gt=this.bones[st];if(gt.name===nt)return gt}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(nt,st){this.uuid=nt.uuid;for(let mt=0,gt=nt.bones.length;mt<gt;mt++){let _t=nt.bones[mt],Et=st[_t];Et===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",_t),Et=new hp),this.bones.push(Et),this.boneInverses.push(new ue$1().fromArray(nt.boneInverses[mt]))}return this.init(),this}toJSON(){let nt={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};nt.uuid=this.uuid;let st=this.bones,mt=this.boneInverses;for(let gt=0,_t=st.length;gt<_t;gt++){let Et=st[gt];nt.bones.push(Et.uuid);let At=mt[gt];nt.boneInverses.push(At.toArray())}return nt}},fo$1=class extends Xe$1{constructor(st,mt,gt,_t=1){super(st,mt,gt),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=_t}copy(st){return super.copy(st),this.meshPerAttribute=st.meshPerAttribute,this}toJSON(){let st=super.toJSON();return st.meshPerAttribute=this.meshPerAttribute,st.isInstancedBufferAttribute=!0,st}},xC=new ue$1,bC=new ue$1,Vg=[],t4=new ue$1,Kf=new Ut,oy=class extends Ut{constructor(nt,st,mt){super(nt,st),this.isInstancedMesh=!0,this.instanceMatrix=new fo$1(new Float32Array(mt*16),16),this.instanceColor=null,this.count=mt,this.frustumCulled=!1;for(let gt=0;gt<mt;gt++)this.setMatrixAt(gt,t4)}copy(nt,st){return super.copy(nt,st),this.instanceMatrix.copy(nt.instanceMatrix),nt.instanceColor!==null&&(this.instanceColor=nt.instanceColor.clone()),this.count=nt.count,this}getColorAt(nt,st){st.fromArray(this.instanceColor.array,nt*3)}getMatrixAt(nt,st){st.fromArray(this.instanceMatrix.array,nt*16)}raycast(nt,st){let mt=this.matrixWorld,gt=this.count;if(Kf.geometry=this.geometry,Kf.material=this.material,Kf.material!==void 0)for(let _t=0;_t<gt;_t++){this.getMatrixAt(_t,xC),bC.multiplyMatrices(mt,xC),Kf.matrixWorld=bC,Kf.raycast(nt,Vg);for(let Et=0,At=Vg.length;Et<At;Et++){let Rt=Vg[Et];Rt.instanceId=_t,Rt.object=this,st.push(Rt)}Vg.length=0}}setColorAt(nt,st){this.instanceColor===null&&(this.instanceColor=new fo$1(new Float32Array(this.instanceMatrix.count*3),3)),st.toArray(this.instanceColor.array,nt*3)}setMatrixAt(nt,st){st.toArray(this.instanceMatrix.array,nt*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},ss=class extends fc{constructor(nt){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new We$1(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(nt)}copy(nt){return super.copy(nt),this.color.copy(nt.color),this.linewidth=nt.linewidth,this.linecap=nt.linecap,this.linejoin=nt.linejoin,this.fog=nt.fog,this}},SC=new E$6,wC=new E$6,AC=new ue$1,LS=new Rs,Ug=new Or,mc=class extends Mt{constructor(nt=new _e$1,st=new ss){super(),this.isLine=!0,this.type="Line",this.geometry=nt,this.material=st,this.updateMorphTargets()}copy(nt,st){return super.copy(nt,st),this.material=nt.material,this.geometry=nt.geometry,this}computeLineDistances(){let nt=this.geometry;if(nt.index===null){let st=nt.attributes.position,mt=[0];for(let gt=1,_t=st.count;gt<_t;gt++)SC.fromBufferAttribute(st,gt-1),wC.fromBufferAttribute(st,gt),mt[gt]=mt[gt-1],mt[gt]+=SC.distanceTo(wC);nt.setAttribute("lineDistance",new Me$1(mt,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(nt,st){let mt=this.geometry,gt=this.matrixWorld,_t=nt.params.Line.threshold,Et=mt.drawRange;if(mt.boundingSphere===null&&mt.computeBoundingSphere(),Ug.copy(mt.boundingSphere),Ug.applyMatrix4(gt),Ug.radius+=_t,nt.ray.intersectsSphere(Ug)===!1)return;AC.copy(gt).invert(),LS.copy(nt.ray).applyMatrix4(AC);let At=_t/((this.scale.x+this.scale.y+this.scale.z)/3),Rt=At*At,Ft=new E$6,Nt=new E$6,Bt=new E$6,Gt=new E$6,dr=this.isLineSegments?2:1,Mr=mt.index,Tr=mt.attributes.position;if(Mr!==null){let zr=Math.max(0,Et.start),Fr=Math.min(Mr.count,Et.start+Et.count);for(let Nr=zr,tn=Fr-1;Nr<tn;Nr+=dr){let rn=Mr.getX(Nr),Tn=Mr.getX(Nr+1);if(Ft.fromBufferAttribute(Tr,rn),Nt.fromBufferAttribute(Tr,Tn),LS.distanceSqToSegment(Ft,Nt,Gt,Bt)>Rt)continue;Gt.applyMatrix4(this.matrixWorld);let $n=nt.ray.origin.distanceTo(Gt);$n<nt.near||$n>nt.far||st.push({distance:$n,point:Bt.clone().applyMatrix4(this.matrixWorld),index:Nr,face:null,faceIndex:null,object:this})}}else{let zr=Math.max(0,Et.start),Fr=Math.min(Tr.count,Et.start+Et.count);for(let Nr=zr,tn=Fr-1;Nr<tn;Nr+=dr){if(Ft.fromBufferAttribute(Tr,Nr),Nt.fromBufferAttribute(Tr,Nr+1),LS.distanceSqToSegment(Ft,Nt,Gt,Bt)>Rt)continue;Gt.applyMatrix4(this.matrixWorld);let rn=nt.ray.origin.distanceTo(Gt);rn<nt.near||rn>nt.far||st.push({distance:rn,point:Bt.clone().applyMatrix4(this.matrixWorld),index:Nr,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let nt=this.geometry.morphAttributes,st=Object.keys(nt);if(st.length>0){let mt=nt[st[0]];if(mt!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let gt=0,_t=mt.length;gt<_t;gt++){let Et=mt[gt].name||String(gt);this.morphTargetInfluences.push(0),this.morphTargetDictionary[Et]=gt}}}}},EC=new E$6,MC=new E$6,el=class extends mc{constructor(nt,st){super(nt,st),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let nt=this.geometry;if(nt.index===null){let st=nt.attributes.position,mt=[];for(let gt=0,_t=st.count;gt<_t;gt+=2)EC.fromBufferAttribute(st,gt),MC.fromBufferAttribute(st,gt+1),mt[gt]=gt===0?0:mt[gt-1],mt[gt+1]=mt[gt]+EC.distanceTo(MC);nt.setAttribute("lineDistance",new Me$1(mt,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},ay=class extends $t{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft){super(nt,st,mt,gt,_t,Et,At,Rt,Ft),this.isVideoTexture=!0,this.minFilter=Et!==void 0?Et:rt$1,this.magFilter=_t!==void 0?_t:rt$1,this.generateMipmaps=!1;let Nt=this;function Bt(){Nt.needsUpdate=!0,nt.requestVideoFrameCallback(Bt)}"requestVideoFrameCallback"in nt&&nt.requestVideoFrameCallback(Bt)}clone(){return new this.constructor(this.image).copy(this)}update(){let nt=this.image;!("requestVideoFrameCallback"in nt)&&nt.readyState>=nt.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},ly=class extends $t{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft){super(nt,st,mt,gt,_t,Et,At,Rt,Ft),this.isCanvasTexture=!0,this.needsUpdate=!0}},os=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(nt,st){let mt=this.getUtoTmapping(nt);return this.getPoint(mt,st)}getPoints(nt=5){let st=[];for(let mt=0;mt<=nt;mt++)st.push(this.getPoint(mt/nt));return st}getSpacedPoints(nt=5){let st=[];for(let mt=0;mt<=nt;mt++)st.push(this.getPointAt(mt/nt));return st}getLength(){let nt=this.getLengths();return nt[nt.length-1]}getLengths(nt=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===nt+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let st=[],mt,gt=this.getPoint(0),_t=0;st.push(0);for(let Et=1;Et<=nt;Et++)mt=this.getPoint(Et/nt),_t+=mt.distanceTo(gt),st.push(_t),gt=mt;return this.cacheArcLengths=st,st}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(nt,st){let mt=this.getLengths(),gt=0,_t=mt.length,Et;st?Et=st:Et=nt*mt[_t-1];let At=0,Rt=_t-1,Ft;for(;At<=Rt;)if(gt=Math.floor(At+(Rt-At)/2),Ft=mt[gt]-Et,Ft<0)At=gt+1;else if(Ft>0)Rt=gt-1;else{Rt=gt;break}if(gt=Rt,mt[gt]===Et)return gt/(_t-1);let Nt=mt[gt],Bt=mt[gt+1]-Nt,Gt=(Et-Nt)/Bt;return(gt+Gt)/(_t-1)}getTangent(nt,st){let mt=nt-1e-4,gt=nt+1e-4;mt<0&&(mt=0),gt>1&&(gt=1);let _t=this.getPoint(mt),Et=this.getPoint(gt),At=st||(_t.isVector2?new U$1:new E$6);return At.copy(Et).sub(_t).normalize(),At}getTangentAt(nt,st){let mt=this.getUtoTmapping(nt);return this.getTangent(mt,st)}computeFrenetFrames(nt,st){let mt=new E$6,gt=[],_t=[],Et=[],At=new E$6,Rt=new ue$1;for(let dr=0;dr<=nt;dr++){let Mr=dr/nt;gt[dr]=this.getTangentAt(Mr,new E$6)}_t[0]=new E$6,Et[0]=new E$6;let Ft=Number.MAX_VALUE,Nt=Math.abs(gt[0].x),Bt=Math.abs(gt[0].y),Gt=Math.abs(gt[0].z);Nt<=Ft&&(Ft=Nt,mt.set(1,0,0)),Bt<=Ft&&(Ft=Bt,mt.set(0,1,0)),Gt<=Ft&&mt.set(0,0,1),At.crossVectors(gt[0],mt).normalize(),_t[0].crossVectors(gt[0],At),Et[0].crossVectors(gt[0],_t[0]);for(let dr=1;dr<=nt;dr++){if(_t[dr]=_t[dr-1].clone(),Et[dr]=Et[dr-1].clone(),At.crossVectors(gt[dr-1],gt[dr]),At.length()>Number.EPSILON){At.normalize();let Mr=Math.acos(di(gt[dr-1].dot(gt[dr]),-1,1));_t[dr].applyMatrix4(Rt.makeRotationAxis(At,Mr))}Et[dr].crossVectors(gt[dr],_t[dr])}if(st===!0){let dr=Math.acos(di(_t[0].dot(_t[nt]),-1,1));dr/=nt,gt[0].dot(At.crossVectors(_t[0],_t[nt]))>0&&(dr=-dr);for(let Mr=1;Mr<=nt;Mr++)_t[Mr].applyMatrix4(Rt.makeRotationAxis(gt[Mr],dr*Mr)),Et[Mr].crossVectors(gt[Mr],_t[Mr])}return{tangents:gt,normals:_t,binormals:Et}}clone(){return new this.constructor().copy(this)}copy(nt){return this.arcLengthDivisions=nt.arcLengthDivisions,this}toJSON(){let nt={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return nt.arcLengthDivisions=this.arcLengthDivisions,nt.type=this.type,nt}fromJSON(nt){return this.arcLengthDivisions=nt.arcLengthDivisions,this}},gc=class extends os{constructor(nt=0,st=0,mt=1,gt=1,_t=0,Et=Math.PI*2,At=!1,Rt=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=nt,this.aY=st,this.xRadius=mt,this.yRadius=gt,this.aStartAngle=_t,this.aEndAngle=Et,this.aClockwise=At,this.aRotation=Rt}getPoint(nt,st){let mt=st||new U$1,gt=Math.PI*2,_t=this.aEndAngle-this.aStartAngle,Et=Math.abs(_t)<Number.EPSILON;for(;_t<0;)_t+=gt;for(;_t>gt;)_t-=gt;_t<Number.EPSILON&&(Et?_t=0:_t=gt),this.aClockwise===!0&&!Et&&(_t===gt?_t=-gt:_t=_t-gt);let At=this.aStartAngle+nt*_t,Rt=this.aX+this.xRadius*Math.cos(At),Ft=this.aY+this.yRadius*Math.sin(At);if(this.aRotation!==0){let Nt=Math.cos(this.aRotation),Bt=Math.sin(this.aRotation),Gt=Rt-this.aX,dr=Ft-this.aY;Rt=Gt*Nt-dr*Bt+this.aX,Ft=Gt*Bt+dr*Nt+this.aY}return mt.set(Rt,Ft)}copy(nt){return super.copy(nt),this.aX=nt.aX,this.aY=nt.aY,this.xRadius=nt.xRadius,this.yRadius=nt.yRadius,this.aStartAngle=nt.aStartAngle,this.aEndAngle=nt.aEndAngle,this.aClockwise=nt.aClockwise,this.aRotation=nt.aRotation,this}toJSON(){let nt=super.toJSON();return nt.aX=this.aX,nt.aY=this.aY,nt.xRadius=this.xRadius,nt.yRadius=this.yRadius,nt.aStartAngle=this.aStartAngle,nt.aEndAngle=this.aEndAngle,nt.aClockwise=this.aClockwise,nt.aRotation=this.aRotation,nt}fromJSON(nt){return super.fromJSON(nt),this.aX=nt.aX,this.aY=nt.aY,this.xRadius=nt.xRadius,this.yRadius=nt.yRadius,this.aStartAngle=nt.aStartAngle,this.aEndAngle=nt.aEndAngle,this.aClockwise=nt.aClockwise,this.aRotation=nt.aRotation,this}},sw=class extends gc{constructor(nt,st,mt,gt,_t,Et){super(nt,st,mt,mt,gt,_t,Et),this.isArcCurve=!0,this.type="ArcCurve"}};function Dw(){let nt=0,st=0,mt=0,gt=0;function _t(Et,At,Rt,Ft){nt=Et,st=Rt,mt=-3*Et+3*At-2*Rt-Ft,gt=2*Et-2*At+Rt+Ft}return{initCatmullRom:function(Et,At,Rt,Ft,Nt){_t(At,Rt,Nt*(Rt-Et),Nt*(Ft-At))},initNonuniformCatmullRom:function(Et,At,Rt,Ft,Nt,Bt,Gt){let dr=(At-Et)/Nt-(Rt-Et)/(Nt+Bt)+(Rt-At)/Bt,Mr=(Rt-At)/Bt-(Ft-At)/(Bt+Gt)+(Ft-Rt)/Gt;dr*=Bt,Mr*=Bt,_t(At,Rt,dr,Mr)},calc:function(Et){let At=Et*Et,Rt=At*Et;return nt+st*Et+mt*At+gt*Rt}}}var zg=new E$6,BS=new Dw,NS=new Dw,FS=new Dw,ow=class extends os{constructor(nt=[],st=!1,mt="centripetal",gt=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=nt,this.closed=st,this.curveType=mt,this.tension=gt}getPoint(nt,st=new E$6){let mt=st,gt=this.points,_t=gt.length,Et=(_t-(this.closed?0:1))*nt,At=Math.floor(Et),Rt=Et-At;this.closed?At+=At>0?0:(Math.floor(Math.abs(At)/_t)+1)*_t:Rt===0&&At===_t-1&&(At=_t-2,Rt=1);let Ft,Nt;this.closed||At>0?Ft=gt[(At-1)%_t]:(zg.subVectors(gt[0],gt[1]).add(gt[0]),Ft=zg);let Bt=gt[At%_t],Gt=gt[(At+1)%_t];if(this.closed||At+2<_t?Nt=gt[(At+2)%_t]:(zg.subVectors(gt[_t-1],gt[_t-2]).add(gt[_t-1]),Nt=zg),this.curveType==="centripetal"||this.curveType==="chordal"){let dr=this.curveType==="chordal"?.5:.25,Mr=Math.pow(Ft.distanceToSquared(Bt),dr),Tr=Math.pow(Bt.distanceToSquared(Gt),dr),zr=Math.pow(Gt.distanceToSquared(Nt),dr);Tr<1e-4&&(Tr=1),Mr<1e-4&&(Mr=Tr),zr<1e-4&&(zr=Tr),BS.initNonuniformCatmullRom(Ft.x,Bt.x,Gt.x,Nt.x,Mr,Tr,zr),NS.initNonuniformCatmullRom(Ft.y,Bt.y,Gt.y,Nt.y,Mr,Tr,zr),FS.initNonuniformCatmullRom(Ft.z,Bt.z,Gt.z,Nt.z,Mr,Tr,zr)}else this.curveType==="catmullrom"&&(BS.initCatmullRom(Ft.x,Bt.x,Gt.x,Nt.x,this.tension),NS.initCatmullRom(Ft.y,Bt.y,Gt.y,Nt.y,this.tension),FS.initCatmullRom(Ft.z,Bt.z,Gt.z,Nt.z,this.tension));return mt.set(BS.calc(Rt),NS.calc(Rt),FS.calc(Rt)),mt}copy(nt){super.copy(nt),this.points=[];for(let st=0,mt=nt.points.length;st<mt;st++){let gt=nt.points[st];this.points.push(gt.clone())}return this.closed=nt.closed,this.curveType=nt.curveType,this.tension=nt.tension,this}toJSON(){let nt=super.toJSON();nt.points=[];for(let st=0,mt=this.points.length;st<mt;st++){let gt=this.points[st];nt.points.push(gt.toArray())}return nt.closed=this.closed,nt.curveType=this.curveType,nt.tension=this.tension,nt}fromJSON(nt){super.fromJSON(nt),this.points=[];for(let st=0,mt=nt.points.length;st<mt;st++){let gt=nt.points[st];this.points.push(new E$6().fromArray(gt))}return this.closed=nt.closed,this.curveType=nt.curveType,this.tension=nt.tension,this}};function TC(nt,st,mt,gt,_t){let Et=(gt-st)*.5,At=(_t-mt)*.5,Rt=nt*nt,Ft=nt*Rt;return(2*mt-2*gt+Et+At)*Ft+(-3*mt+3*gt-2*Et-At)*Rt+Et*nt+mt}function r4(nt,st){let mt=1-nt;return mt*mt*st}function i4(nt,st){return 2*(1-nt)*nt*st}function n4(nt,st){return nt*nt*st}function ip(nt,st,mt,gt){return r4(nt,st)+i4(nt,mt)+n4(nt,gt)}function s4(nt,st){let mt=1-nt;return mt*mt*mt*st}function o4(nt,st){let mt=1-nt;return 3*mt*mt*nt*st}function a4(nt,st){return 3*(1-nt)*nt*nt*st}function l4(nt,st){return nt*nt*nt*st}function np(nt,st,mt,gt,_t){return s4(nt,st)+o4(nt,mt)+a4(nt,gt)+l4(nt,_t)}var an=class extends os{constructor(nt=new U$1,st=new U$1,mt=new U$1,gt=new U$1){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=nt,this.v1=st,this.v2=mt,this.v3=gt}getPoint(nt,st=new U$1){let mt=st,gt=this.v0,_t=this.v1,Et=this.v2,At=this.v3;return mt.set(np(nt,gt.x,_t.x,Et.x,At.x),np(nt,gt.y,_t.y,Et.y,At.y)),mt}copy(nt){return super.copy(nt),this.v0.copy(nt.v0),this.v1.copy(nt.v1),this.v2.copy(nt.v2),this.v3.copy(nt.v3),this}toJSON(){let nt=super.toJSON();return nt.v0=this.v0.toArray(),nt.v1=this.v1.toArray(),nt.v2=this.v2.toArray(),nt.v3=this.v3.toArray(),nt}fromJSON(nt){return super.fromJSON(nt),this.v0.fromArray(nt.v0),this.v1.fromArray(nt.v1),this.v2.fromArray(nt.v2),this.v3.fromArray(nt.v3),this}},yc=class extends os{constructor(nt=new E$6,st=new E$6,mt=new E$6,gt=new E$6){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=nt,this.v1=st,this.v2=mt,this.v3=gt}getPoint(nt,st=new E$6){let mt=st,gt=this.v0,_t=this.v1,Et=this.v2,At=this.v3;return mt.set(np(nt,gt.x,_t.x,Et.x,At.x),np(nt,gt.y,_t.y,Et.y,At.y),np(nt,gt.z,_t.z,Et.z,At.z)),mt}copy(nt){return super.copy(nt),this.v0.copy(nt.v0),this.v1.copy(nt.v1),this.v2.copy(nt.v2),this.v3.copy(nt.v3),this}toJSON(){let nt=super.toJSON();return nt.v0=this.v0.toArray(),nt.v1=this.v1.toArray(),nt.v2=this.v2.toArray(),nt.v3=this.v3.toArray(),nt}fromJSON(nt){return super.fromJSON(nt),this.v0.fromArray(nt.v0),this.v1.fromArray(nt.v1),this.v2.fromArray(nt.v2),this.v3.fromArray(nt.v3),this}},ln=class extends os{constructor(nt=new U$1,st=new U$1){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=nt,this.v2=st}getPoint(nt,st=new U$1){let mt=st;return nt===1?mt.copy(this.v2):(mt.copy(this.v2).sub(this.v1),mt.multiplyScalar(nt).add(this.v1)),mt}getPointAt(nt,st){return this.getPoint(nt,st)}getTangent(nt,st){let mt=st||new U$1;return mt.copy(this.v2).sub(this.v1).normalize(),mt}copy(nt){return super.copy(nt),this.v1.copy(nt.v1),this.v2.copy(nt.v2),this}toJSON(){let nt=super.toJSON();return nt.v1=this.v1.toArray(),nt.v2=this.v2.toArray(),nt}fromJSON(nt){return super.fromJSON(nt),this.v1.fromArray(nt.v1),this.v2.fromArray(nt.v2),this}},dp=class extends os{constructor(nt=new E$6,st=new E$6){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=nt,this.v2=st}getPoint(nt,st=new E$6){let mt=st;return nt===1?mt.copy(this.v2):(mt.copy(this.v2).sub(this.v1),mt.multiplyScalar(nt).add(this.v1)),mt}getPointAt(nt,st){return this.getPoint(nt,st)}copy(nt){return super.copy(nt),this.v1.copy(nt.v1),this.v2.copy(nt.v2),this}toJSON(){let nt=super.toJSON();return nt.v1=this.v1.toArray(),nt.v2=this.v2.toArray(),nt}fromJSON(nt){return super.fromJSON(nt),this.v1.fromArray(nt.v1),this.v2.fromArray(nt.v2),this}},Yn=class extends os{constructor(nt=new U$1,st=new U$1,mt=new U$1){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=nt,this.v1=st,this.v2=mt}getPoint(nt,st=new U$1){let mt=st,gt=this.v0,_t=this.v1,Et=this.v2;return mt.set(ip(nt,gt.x,_t.x,Et.x),ip(nt,gt.y,_t.y,Et.y)),mt}copy(nt){return super.copy(nt),this.v0.copy(nt.v0),this.v1.copy(nt.v1),this.v2.copy(nt.v2),this}toJSON(){let nt=super.toJSON();return nt.v0=this.v0.toArray(),nt.v1=this.v1.toArray(),nt.v2=this.v2.toArray(),nt}fromJSON(nt){return super.fromJSON(nt),this.v0.fromArray(nt.v0),this.v1.fromArray(nt.v1),this.v2.fromArray(nt.v2),this}},aw=class extends os{constructor(nt=new E$6,st=new E$6,mt=new E$6){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=nt,this.v1=st,this.v2=mt}getPoint(nt,st=new E$6){let mt=st,gt=this.v0,_t=this.v1,Et=this.v2;return mt.set(ip(nt,gt.x,_t.x,Et.x),ip(nt,gt.y,_t.y,Et.y),ip(nt,gt.z,_t.z,Et.z)),mt}copy(nt){return super.copy(nt),this.v0.copy(nt.v0),this.v1.copy(nt.v1),this.v2.copy(nt.v2),this}toJSON(){let nt=super.toJSON();return nt.v0=this.v0.toArray(),nt.v1=this.v1.toArray(),nt.v2=this.v2.toArray(),nt}fromJSON(nt){return super.fromJSON(nt),this.v0.fromArray(nt.v0),this.v1.fromArray(nt.v1),this.v2.fromArray(nt.v2),this}},Bu=class extends os{constructor(nt=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=nt}getPoint(nt,st=new U$1){let mt=st,gt=this.points,_t=(gt.length-1)*nt,Et=Math.floor(_t),At=_t-Et,Rt=gt[Et===0?Et:Et-1],Ft=gt[Et],Nt=gt[Et>gt.length-2?gt.length-1:Et+1],Bt=gt[Et>gt.length-3?gt.length-1:Et+2];return mt.set(TC(At,Rt.x,Ft.x,Nt.x,Bt.x),TC(At,Rt.y,Ft.y,Nt.y,Bt.y)),mt}copy(nt){super.copy(nt),this.points=[];for(let st=0,mt=nt.points.length;st<mt;st++){let gt=nt.points[st];this.points.push(gt.clone())}return this}toJSON(){let nt=super.toJSON();nt.points=[];for(let st=0,mt=this.points.length;st<mt;st++){let gt=this.points[st];nt.points.push(gt.toArray())}return nt}fromJSON(nt){super.fromJSON(nt),this.points=[];for(let st=0,mt=nt.points.length;st<mt;st++){let gt=nt.points[st];this.points.push(new U$1().fromArray(gt))}return this}},c4=Object.freeze({__proto__:null,ArcCurve:sw,CatmullRomCurve3:ow,CubicBezierCurve:an,CubicBezierCurve3:yc,EllipseCurve:gc,LineCurve:ln,LineCurve3:dp,QuadraticBezierCurve:Yn,QuadraticBezierCurve3:aw,SplineCurve:Bu}),fp=class extends os{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(nt){this.curves.push(nt)}closePath(){let nt=this.curves[0].getPoint(0),st=this.curves[this.curves.length-1].getPoint(1);nt.equals(st)||this.curves.push(new ln(st,nt))}getPoint(nt,st){let mt=nt*this.getLength(),gt=this.getCurveLengths(),_t=0;for(;_t<gt.length;){if(gt[_t]>=mt){let Et=gt[_t]-mt,At=this.curves[_t],Rt=At.getLength(),Ft=Rt===0?0:1-Et/Rt;return At.getPointAt(Ft,st)}_t++}return null}getLength(){let nt=this.getCurveLengths();return nt[nt.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let nt=[],st=0;for(let mt=0,gt=this.curves.length;mt<gt;mt++)st+=this.curves[mt].getLength(),nt.push(st);return this.cacheLengths=nt,nt}getSpacedPoints(nt=40){let st=[];for(let mt=0;mt<=nt;mt++)st.push(this.getPoint(mt/nt));return this.autoClose&&st.push(st[0]),st}getPoints(nt=12){let st=[],mt;for(let gt=0,_t=this.curves;gt<_t.length;gt++){let Et=_t[gt],At=Et.isEllipseCurve?nt*2:Et.isLineCurve||Et.isLineCurve3?1:Et.isSplineCurve?nt*Et.points.length:nt,Rt=Et.getPoints(At);for(let Ft=0;Ft<Rt.length;Ft++){let Nt=Rt[Ft];mt&&mt.equals(Nt)||(st.push(Nt),mt=Nt)}}return this.autoClose&&st.length>1&&!st[st.length-1].equals(st[0])&&st.push(st[0]),st}copy(nt){super.copy(nt),this.curves=[];for(let st=0,mt=nt.curves.length;st<mt;st++){let gt=nt.curves[st];this.curves.push(gt.clone())}return this.autoClose=nt.autoClose,this}toJSON(){let nt=super.toJSON();nt.autoClose=this.autoClose,nt.curves=[];for(let st=0,mt=this.curves.length;st<mt;st++){let gt=this.curves[st];nt.curves.push(gt.toJSON())}return nt}fromJSON(nt){super.fromJSON(nt),this.autoClose=nt.autoClose,this.curves=[];for(let st=0,mt=nt.curves.length;st<mt;st++){let gt=nt.curves[st];this.curves.push(new c4[gt.type]().fromJSON(gt))}return this}},vc=class extends fp{constructor(nt){super(),this.type="Path",this.currentPoint=new U$1,nt&&this.setFromPoints(nt)}setFromPoints(nt){this.moveTo(nt[0].x,nt[0].y);for(let st=1,mt=nt.length;st<mt;st++)this.lineTo(nt[st].x,nt[st].y);return this}moveTo(nt,st){return this.currentPoint.set(nt,st),this}lineTo(nt,st){let mt=new ln(this.currentPoint.clone(),new U$1(nt,st));return this.curves.push(mt),this.currentPoint.set(nt,st),this}quadraticCurveTo(nt,st,mt,gt){let _t=new Yn(this.currentPoint.clone(),new U$1(nt,st),new U$1(mt,gt));return this.curves.push(_t),this.currentPoint.set(mt,gt),this}bezierCurveTo(nt,st,mt,gt,_t,Et){let At=new an(this.currentPoint.clone(),new U$1(nt,st),new U$1(mt,gt),new U$1(_t,Et));return this.curves.push(At),this.currentPoint.set(_t,Et),this}splineThru(nt){let st=[this.currentPoint.clone()].concat(nt),mt=new Bu(st);return this.curves.push(mt),this.currentPoint.copy(nt[nt.length-1]),this}arc(nt,st,mt,gt,_t,Et){let At=this.currentPoint.x,Rt=this.currentPoint.y;return this.absarc(nt+At,st+Rt,mt,gt,_t,Et),this}absarc(nt,st,mt,gt,_t,Et){return this.absellipse(nt,st,mt,mt,gt,_t,Et),this}ellipse(nt,st,mt,gt,_t,Et,At,Rt){let Ft=this.currentPoint.x,Nt=this.currentPoint.y;return this.absellipse(nt+Ft,st+Nt,mt,gt,_t,Et,At,Rt),this}absellipse(nt,st,mt,gt,_t,Et,At,Rt){let Ft=new gc(nt,st,mt,gt,_t,Et,At,Rt);if(this.curves.length>0){let Bt=Ft.getPoint(0);Bt.equals(this.currentPoint)||this.lineTo(Bt.x,Bt.y)}this.curves.push(Ft);let Nt=Ft.getPoint(1);return this.currentPoint.copy(Nt),this}copy(nt){return super.copy(nt),this.currentPoint.copy(nt.currentPoint),this}toJSON(){let nt=super.toJSON();return nt.currentPoint=this.currentPoint.toArray(),nt}fromJSON(nt){return super.fromJSON(nt),this.currentPoint.fromArray(nt.currentPoint),this}},Nu=class extends _e$1{constructor(nt=[new U$1(0,-.5),new U$1(.5,0),new U$1(0,.5)],st=12,mt=0,gt=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:nt,segments:st,phiStart:mt,phiLength:gt},st=Math.floor(st),gt=di(gt,0,Math.PI*2);let _t=[],Et=[],At=[],Rt=[],Ft=[],Nt=1/st,Bt=new E$6,Gt=new U$1,dr=new E$6,Mr=new E$6,Tr=new E$6,zr=0,Fr=0;for(let Nr=0;Nr<=nt.length-1;Nr++)switch(Nr){case 0:zr=nt[Nr+1].x-nt[Nr].x,Fr=nt[Nr+1].y-nt[Nr].y,dr.x=Fr*1,dr.y=-zr,dr.z=Fr*0,Tr.copy(dr),dr.normalize(),Rt.push(dr.x,dr.y,dr.z);break;case nt.length-1:Rt.push(Tr.x,Tr.y,Tr.z);break;default:zr=nt[Nr+1].x-nt[Nr].x,Fr=nt[Nr+1].y-nt[Nr].y,dr.x=Fr*1,dr.y=-zr,dr.z=Fr*0,Mr.copy(dr),dr.x+=Tr.x,dr.y+=Tr.y,dr.z+=Tr.z,dr.normalize(),Rt.push(dr.x,dr.y,dr.z),Tr.copy(Mr)}for(let Nr=0;Nr<=st;Nr++){let tn=mt+Nr*Nt*gt,rn=Math.sin(tn),Tn=Math.cos(tn);for(let $n=0;$n<=nt.length-1;$n++){Bt.x=nt[$n].x*rn,Bt.y=nt[$n].y,Bt.z=nt[$n].x*Tn,Et.push(Bt.x,Bt.y,Bt.z),Gt.x=Nr/st,Gt.y=$n/(nt.length-1),At.push(Gt.x,Gt.y);let un=Rt[3*$n+0]*rn,es=Rt[3*$n+1],kn=Rt[3*$n+0]*Tn;Ft.push(un,es,kn)}}for(let Nr=0;Nr<st;Nr++)for(let tn=0;tn<nt.length-1;tn++){let rn=tn+Nr*nt.length,Tn=rn,$n=rn+nt.length,un=rn+nt.length+1,es=rn+1;_t.push(Tn,$n,es),_t.push(un,es,$n)}this.setIndex(_t),this.setAttribute("position",new Me$1(Et,3)),this.setAttribute("uv",new Me$1(At,2)),this.setAttribute("normal",new Me$1(Ft,3))}static fromJSON(nt){return new Nu(nt.points,nt.segments,nt.phiStart,nt.phiLength)}},xc=class extends _e$1{constructor(nt=1,st=1,mt=1,gt=32,_t=1,Et=!1,At=0,Rt=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:nt,radiusBottom:st,height:mt,radialSegments:gt,heightSegments:_t,openEnded:Et,thetaStart:At,thetaLength:Rt};let Ft=this;gt=Math.floor(gt),_t=Math.floor(_t);let Nt=[],Bt=[],Gt=[],dr=[],Mr=0,Tr=[],zr=mt/2,Fr=0;Nr(),Et===!1&&(nt>0&&tn(!0),st>0&&tn(!1)),this.setIndex(Nt),this.setAttribute("position",new Me$1(Bt,3)),this.setAttribute("normal",new Me$1(Gt,3)),this.setAttribute("uv",new Me$1(dr,2));function Nr(){let rn=new E$6,Tn=new E$6,$n=0,un=(st-nt)/mt;for(let es=0;es<=_t;es++){let kn=[],ts=es/_t,Ko=ts*(st-nt)+nt;for(let ds=0;ds<=gt;ds++){let Il=ds/gt,ru=Il*Rt+At,uu=Math.sin(ru),p0=Math.cos(ru);Tn.x=Ko*uu,Tn.y=-ts*mt+zr,Tn.z=Ko*p0,Bt.push(Tn.x,Tn.y,Tn.z),rn.set(uu,un,p0).normalize(),Gt.push(rn.x,rn.y,rn.z),dr.push(Il,1-ts),kn.push(Mr++)}Tr.push(kn)}for(let es=0;es<gt;es++)for(let kn=0;kn<_t;kn++){let ts=Tr[kn][es],Ko=Tr[kn+1][es],ds=Tr[kn+1][es+1],Il=Tr[kn][es+1];Nt.push(ts,Ko,Il),Nt.push(Ko,ds,Il),$n+=6}Ft.addGroup(Fr,$n,0),Fr+=$n}function tn(rn){let Tn=Mr,$n=new U$1,un=new E$6,es=0,kn=rn===!0?nt:st,ts=rn===!0?1:-1;for(let ds=1;ds<=gt;ds++)Bt.push(0,zr*ts,0),Gt.push(0,ts,0),dr.push(.5,.5),Mr++;let Ko=Mr;for(let ds=0;ds<=gt;ds++){let Il=ds/gt*Rt+At,ru=Math.cos(Il),uu=Math.sin(Il);un.x=kn*uu,un.y=zr*ts,un.z=kn*ru,Bt.push(un.x,un.y,un.z),Gt.push(0,ts,0),$n.x=ru*.5+.5,$n.y=uu*.5*ts+.5,dr.push($n.x,$n.y),Mr++}for(let ds=0;ds<gt;ds++){let Il=Tn+ds,ru=Ko+ds;rn===!0?Nt.push(ru,ru+1,Il):Nt.push(ru+1,ru,Il),es+=3}Ft.addGroup(Fr,es,rn===!0?1:2),Fr+=es}}static fromJSON(nt){return new xc(nt.radiusTop,nt.radiusBottom,nt.height,nt.radialSegments,nt.heightSegments,nt.openEnded,nt.thetaStart,nt.thetaLength)}},tl=class extends xc{constructor(nt=1,st=1,mt=32,gt=1,_t=!1,Et=0,At=Math.PI*2){super(0,nt,st,mt,gt,_t,Et,At),this.type="ConeGeometry",this.parameters={radius:nt,height:st,radialSegments:mt,heightSegments:gt,openEnded:_t,thetaStart:Et,thetaLength:At}}static fromJSON(nt){return new tl(nt.radius,nt.height,nt.radialSegments,nt.heightSegments,nt.openEnded,nt.thetaStart,nt.thetaLength)}},Fu=class extends _e$1{constructor(nt=[],st=[],mt=1,gt=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:nt,indices:st,radius:mt,detail:gt};let _t=[],Et=[];At(gt),Ft(mt),Nt(),this.setAttribute("position",new Me$1(_t,3)),this.setAttribute("normal",new Me$1(_t.slice(),3)),this.setAttribute("uv",new Me$1(Et,2)),gt===0?this.computeVertexNormals():this.normalizeNormals();function At(Nr){let tn=new E$6,rn=new E$6,Tn=new E$6;for(let $n=0;$n<st.length;$n+=3)dr(st[$n+0],tn),dr(st[$n+1],rn),dr(st[$n+2],Tn),Rt(tn,rn,Tn,Nr)}function Rt(Nr,tn,rn,Tn){let $n=Tn+1,un=[];for(let es=0;es<=$n;es++){un[es]=[];let kn=Nr.clone().lerp(rn,es/$n),ts=tn.clone().lerp(rn,es/$n),Ko=$n-es;for(let ds=0;ds<=Ko;ds++)ds===0&&es===$n?un[es][ds]=kn:un[es][ds]=kn.clone().lerp(ts,ds/Ko)}for(let es=0;es<$n;es++)for(let kn=0;kn<2*($n-es)-1;kn++){let ts=Math.floor(kn/2);kn%2===0?(Gt(un[es][ts+1]),Gt(un[es+1][ts]),Gt(un[es][ts])):(Gt(un[es][ts+1]),Gt(un[es+1][ts+1]),Gt(un[es+1][ts]))}}function Ft(Nr){let tn=new E$6;for(let rn=0;rn<_t.length;rn+=3)tn.x=_t[rn+0],tn.y=_t[rn+1],tn.z=_t[rn+2],tn.normalize().multiplyScalar(Nr),_t[rn+0]=tn.x,_t[rn+1]=tn.y,_t[rn+2]=tn.z}function Nt(){let Nr=new E$6;for(let tn=0;tn<_t.length;tn+=3){Nr.x=_t[tn+0],Nr.y=_t[tn+1],Nr.z=_t[tn+2];let rn=zr(Nr)/2/Math.PI+.5,Tn=Fr(Nr)/Math.PI+.5;Et.push(rn,1-Tn)}Mr(),Bt()}function Bt(){for(let Nr=0;Nr<Et.length;Nr+=6){let tn=Et[Nr+0],rn=Et[Nr+2],Tn=Et[Nr+4],$n=Math.max(tn,rn,Tn),un=Math.min(tn,rn,Tn);$n>.9&&un<.1&&(tn<.2&&(Et[Nr+0]+=1),rn<.2&&(Et[Nr+2]+=1),Tn<.2&&(Et[Nr+4]+=1))}}function Gt(Nr){_t.push(Nr.x,Nr.y,Nr.z)}function dr(Nr,tn){let rn=Nr*3;tn.x=nt[rn+0],tn.y=nt[rn+1],tn.z=nt[rn+2]}function Mr(){let Nr=new E$6,tn=new E$6,rn=new E$6,Tn=new E$6,$n=new U$1,un=new U$1,es=new U$1;for(let kn=0,ts=0;kn<_t.length;kn+=9,ts+=6){Nr.set(_t[kn+0],_t[kn+1],_t[kn+2]),tn.set(_t[kn+3],_t[kn+4],_t[kn+5]),rn.set(_t[kn+6],_t[kn+7],_t[kn+8]),$n.set(Et[ts+0],Et[ts+1]),un.set(Et[ts+2],Et[ts+3]),es.set(Et[ts+4],Et[ts+5]),Tn.copy(Nr).add(tn).add(rn).divideScalar(3);let Ko=zr(Tn);Tr($n,ts+0,Nr,Ko),Tr(un,ts+2,tn,Ko),Tr(es,ts+4,rn,Ko)}}function Tr(Nr,tn,rn,Tn){Tn<0&&Nr.x===1&&(Et[tn]=Nr.x-1),rn.x===0&&rn.z===0&&(Et[tn]=Tn/2/Math.PI+.5)}function zr(Nr){return Math.atan2(Nr.z,-Nr.x)}function Fr(Nr){return Math.atan2(-Nr.y,Math.sqrt(Nr.x*Nr.x+Nr.z*Nr.z))}}static fromJSON(nt){return new Fu(nt.vertices,nt.indices,nt.radius,nt.details)}},Vu=class extends Fu{constructor(nt=1,st=0){let mt=(1+Math.sqrt(5))/2,gt=1/mt,_t=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-gt,-mt,0,-gt,mt,0,gt,-mt,0,gt,mt,-gt,-mt,0,-gt,mt,0,gt,-mt,0,gt,mt,0,-mt,0,-gt,mt,0,-gt,-mt,0,gt,mt,0,gt],Et=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(_t,Et,nt,st),this.type="DodecahedronGeometry",this.parameters={radius:nt,detail:st}}static fromJSON(nt){return new Vu(nt.radius,nt.detail)}},aa=class extends vc{constructor(nt){super(nt),this.uuid=is(),this.type="Shape",this.holes=[]}getPointsHoles(nt){let st=[];for(let mt=0,gt=this.holes.length;mt<gt;mt++)st[mt]=this.holes[mt].getPoints(nt);return st}extractPoints(nt){return{shape:this.getPoints(nt),holes:this.getPointsHoles(nt)}}copy(nt){super.copy(nt),this.holes=[];for(let st=0,mt=nt.holes.length;st<mt;st++){let gt=nt.holes[st];this.holes.push(gt.clone())}return this}toJSON(){let nt=super.toJSON();nt.uuid=this.uuid,nt.holes=[];for(let st=0,mt=this.holes.length;st<mt;st++){let gt=this.holes[st];nt.holes.push(gt.toJSON())}return nt}fromJSON(nt){super.fromJSON(nt),this.uuid=nt.uuid,this.holes=[];for(let st=0,mt=nt.holes.length;st<mt;st++){let gt=nt.holes[st];this.holes.push(new vc().fromJSON(gt))}return this}},u4={triangulate:function(nt,st,mt=2){let gt=st&&st.length,_t=gt?st[0]*mt:nt.length,Et=rP(nt,0,_t,mt,!0),At=[];if(!Et||Et.next===Et.prev)return At;let Rt,Ft,Nt,Bt,Gt,dr,Mr;if(gt&&(Et=m4(nt,st,Et,mt)),nt.length>80*mt){Rt=Nt=nt[0],Ft=Bt=nt[1];for(let Tr=mt;Tr<_t;Tr+=mt)Gt=nt[Tr],dr=nt[Tr+1],Gt<Rt&&(Rt=Gt),dr<Ft&&(Ft=dr),Gt>Nt&&(Nt=Gt),dr>Bt&&(Bt=dr);Mr=Math.max(Nt-Rt,Bt-Ft),Mr=Mr!==0?32767/Mr:0}return pp(Et,At,mt,Rt,Ft,Mr,0),At}};function rP(nt,st,mt,gt,_t){let Et,At;if(_t===T4(nt,st,mt,gt)>0)for(Et=st;Et<mt;Et+=gt)At=CC(Et,nt[Et],nt[Et+1],At);else for(Et=mt-gt;Et>=st;Et-=gt)At=CC(Et,nt[Et],nt[Et+1],At);return At&&My(At,At.next)&&(gp(At),At=At.next),At}function bc(nt,st){if(!nt)return nt;st||(st=nt);let mt=nt,gt;do if(gt=!1,!mt.steiner&&(My(mt,mt.next)||Ur(mt.prev,mt,mt.next)===0)){if(gp(mt),mt=st=mt.prev,mt===mt.next)break;gt=!0}else mt=mt.next;while(gt||mt!==st);return st}function pp(nt,st,mt,gt,_t,Et,At){if(!nt)return;!At&&Et&&b4(nt,gt,_t,Et);let Rt=nt,Ft,Nt;for(;nt.prev!==nt.next;){if(Ft=nt.prev,Nt=nt.next,Et?d4(nt,gt,_t,Et):h4(nt)){st.push(Ft.i/mt|0),st.push(nt.i/mt|0),st.push(Nt.i/mt|0),gp(nt),nt=Nt.next,Rt=Nt.next;continue}if(nt=Nt,nt===Rt){At?At===1?(nt=f4(bc(nt),st,mt),pp(nt,st,mt,gt,_t,Et,2)):At===2&&p4(nt,st,mt,gt,_t,Et):pp(bc(nt),st,mt,gt,_t,Et,1);break}}}function h4(nt){let st=nt.prev,mt=nt,gt=nt.next;if(Ur(st,mt,gt)>=0)return!1;let _t=st.x,Et=mt.x,At=gt.x,Rt=st.y,Ft=mt.y,Nt=gt.y,Bt=_t<Et?_t<At?_t:At:Et<At?Et:At,Gt=Rt<Ft?Rt<Nt?Rt:Nt:Ft<Nt?Ft:Nt,dr=_t>Et?_t>At?_t:At:Et>At?Et:At,Mr=Rt>Ft?Rt>Nt?Rt:Nt:Ft>Nt?Ft:Nt,Tr=gt.next;for(;Tr!==st;){if(Tr.x>=Bt&&Tr.x<=dr&&Tr.y>=Gt&&Tr.y<=Mr&&Du(_t,Rt,Et,Ft,At,Nt,Tr.x,Tr.y)&&Ur(Tr.prev,Tr,Tr.next)>=0)return!1;Tr=Tr.next}return!0}function d4(nt,st,mt,gt){let _t=nt.prev,Et=nt,At=nt.next;if(Ur(_t,Et,At)>=0)return!1;let Rt=_t.x,Ft=Et.x,Nt=At.x,Bt=_t.y,Gt=Et.y,dr=At.y,Mr=Rt<Ft?Rt<Nt?Rt:Nt:Ft<Nt?Ft:Nt,Tr=Bt<Gt?Bt<dr?Bt:dr:Gt<dr?Gt:dr,zr=Rt>Ft?Rt>Nt?Rt:Nt:Ft>Nt?Ft:Nt,Fr=Bt>Gt?Bt>dr?Bt:dr:Gt>dr?Gt:dr,Nr=lw(Mr,Tr,st,mt,gt),tn=lw(zr,Fr,st,mt,gt),rn=nt.prevZ,Tn=nt.nextZ;for(;rn&&rn.z>=Nr&&Tn&&Tn.z<=tn;){if(rn.x>=Mr&&rn.x<=zr&&rn.y>=Tr&&rn.y<=Fr&&rn!==_t&&rn!==At&&Du(Rt,Bt,Ft,Gt,Nt,dr,rn.x,rn.y)&&Ur(rn.prev,rn,rn.next)>=0||(rn=rn.prevZ,Tn.x>=Mr&&Tn.x<=zr&&Tn.y>=Tr&&Tn.y<=Fr&&Tn!==_t&&Tn!==At&&Du(Rt,Bt,Ft,Gt,Nt,dr,Tn.x,Tn.y)&&Ur(Tn.prev,Tn,Tn.next)>=0))return!1;Tn=Tn.nextZ}for(;rn&&rn.z>=Nr;){if(rn.x>=Mr&&rn.x<=zr&&rn.y>=Tr&&rn.y<=Fr&&rn!==_t&&rn!==At&&Du(Rt,Bt,Ft,Gt,Nt,dr,rn.x,rn.y)&&Ur(rn.prev,rn,rn.next)>=0)return!1;rn=rn.prevZ}for(;Tn&&Tn.z<=tn;){if(Tn.x>=Mr&&Tn.x<=zr&&Tn.y>=Tr&&Tn.y<=Fr&&Tn!==_t&&Tn!==At&&Du(Rt,Bt,Ft,Gt,Nt,dr,Tn.x,Tn.y)&&Ur(Tn.prev,Tn,Tn.next)>=0)return!1;Tn=Tn.nextZ}return!0}function f4(nt,st,mt){let gt=nt;do{let _t=gt.prev,Et=gt.next.next;!My(_t,Et)&&iP(_t,gt,gt.next,Et)&&mp(_t,Et)&&mp(Et,_t)&&(st.push(_t.i/mt|0),st.push(gt.i/mt|0),st.push(Et.i/mt|0),gp(gt),gp(gt.next),gt=nt=Et),gt=gt.next}while(gt!==nt);return bc(gt)}function p4(nt,st,mt,gt,_t,Et){let At=nt;do{let Rt=At.next.next;for(;Rt!==At.prev;){if(At.i!==Rt.i&&A4(At,Rt)){let Ft=nP(At,Rt);At=bc(At,At.next),Ft=bc(Ft,Ft.next),pp(At,st,mt,gt,_t,Et,0),pp(Ft,st,mt,gt,_t,Et,0);return}Rt=Rt.next}At=At.next}while(At!==nt)}function m4(nt,st,mt,gt){let _t=[],Et,At,Rt,Ft,Nt;for(Et=0,At=st.length;Et<At;Et++)Rt=st[Et]*gt,Ft=Et<At-1?st[Et+1]*gt:nt.length,Nt=rP(nt,Rt,Ft,gt,!1),Nt===Nt.next&&(Nt.steiner=!0),_t.push(w4(Nt));for(_t.sort(g4),Et=0;Et<_t.length;Et++)mt=y4(_t[Et],mt);return mt}function g4(nt,st){return nt.x-st.x}function y4(nt,st){let mt=v4(nt,st);if(!mt)return st;let gt=nP(mt,nt);return bc(gt,gt.next),bc(mt,mt.next)}function v4(nt,st){let mt=st,gt=-1/0,_t,Et=nt.x,At=nt.y;do{if(At<=mt.y&&At>=mt.next.y&&mt.next.y!==mt.y){let dr=mt.x+(At-mt.y)*(mt.next.x-mt.x)/(mt.next.y-mt.y);if(dr<=Et&&dr>gt&&(gt=dr,_t=mt.x<mt.next.x?mt:mt.next,dr===Et))return _t}mt=mt.next}while(mt!==st);if(!_t)return null;let Rt=_t,Ft=_t.x,Nt=_t.y,Bt=1/0,Gt;mt=_t;do Et>=mt.x&&mt.x>=Ft&&Et!==mt.x&&Du(At<Nt?Et:gt,At,Ft,Nt,At<Nt?gt:Et,At,mt.x,mt.y)&&(Gt=Math.abs(At-mt.y)/(Et-mt.x),mp(mt,nt)&&(Gt<Bt||Gt===Bt&&(mt.x>_t.x||mt.x===_t.x&&x4(_t,mt)))&&(_t=mt,Bt=Gt)),mt=mt.next;while(mt!==Rt);return _t}function x4(nt,st){return Ur(nt.prev,nt,st.prev)<0&&Ur(st.next,nt,nt.next)<0}function b4(nt,st,mt,gt){let _t=nt;do _t.z===0&&(_t.z=lw(_t.x,_t.y,st,mt,gt)),_t.prevZ=_t.prev,_t.nextZ=_t.next,_t=_t.next;while(_t!==nt);_t.prevZ.nextZ=null,_t.prevZ=null,S4(_t)}function S4(nt){let st,mt,gt,_t,Et,At,Rt,Ft,Nt=1;do{for(mt=nt,nt=null,Et=null,At=0;mt;){for(At++,gt=mt,Rt=0,st=0;st<Nt&&(Rt++,gt=gt.nextZ,!!gt);st++);for(Ft=Nt;Rt>0||Ft>0&&gt;)Rt!==0&&(Ft===0||!gt||mt.z<=gt.z)?(_t=mt,mt=mt.nextZ,Rt--):(_t=gt,gt=gt.nextZ,Ft--),Et?Et.nextZ=_t:nt=_t,_t.prevZ=Et,Et=_t;mt=gt}Et.nextZ=null,Nt*=2}while(At>1);return nt}function lw(nt,st,mt,gt,_t){return nt=(nt-mt)*_t|0,st=(st-gt)*_t|0,nt=(nt|nt<<8)&16711935,nt=(nt|nt<<4)&252645135,nt=(nt|nt<<2)&858993459,nt=(nt|nt<<1)&1431655765,st=(st|st<<8)&16711935,st=(st|st<<4)&252645135,st=(st|st<<2)&858993459,st=(st|st<<1)&1431655765,nt|st<<1}function w4(nt){let st=nt,mt=nt;do(st.x<mt.x||st.x===mt.x&&st.y<mt.y)&&(mt=st),st=st.next;while(st!==nt);return mt}function Du(nt,st,mt,gt,_t,Et,At,Rt){return(_t-At)*(st-Rt)>=(nt-At)*(Et-Rt)&&(nt-At)*(gt-Rt)>=(mt-At)*(st-Rt)&&(mt-At)*(Et-Rt)>=(_t-At)*(gt-Rt)}function A4(nt,st){return nt.next.i!==st.i&&nt.prev.i!==st.i&&!E4(nt,st)&&(mp(nt,st)&&mp(st,nt)&&M4(nt,st)&&(Ur(nt.prev,nt,st.prev)||Ur(nt,st.prev,st))||My(nt,st)&&Ur(nt.prev,nt,nt.next)>0&&Ur(st.prev,st,st.next)>0)}function Ur(nt,st,mt){return(st.y-nt.y)*(mt.x-st.x)-(st.x-nt.x)*(mt.y-st.y)}function My(nt,st){return nt.x===st.x&&nt.y===st.y}function iP(nt,st,mt,gt){let _t=Gg(Ur(nt,st,mt)),Et=Gg(Ur(nt,st,gt)),At=Gg(Ur(mt,gt,nt)),Rt=Gg(Ur(mt,gt,st));return!!(_t!==Et&&At!==Rt||_t===0&&kg(nt,mt,st)||Et===0&&kg(nt,gt,st)||At===0&&kg(mt,nt,gt)||Rt===0&&kg(mt,st,gt))}function kg(nt,st,mt){return st.x<=Math.max(nt.x,mt.x)&&st.x>=Math.min(nt.x,mt.x)&&st.y<=Math.max(nt.y,mt.y)&&st.y>=Math.min(nt.y,mt.y)}function Gg(nt){return nt>0?1:nt<0?-1:0}function E4(nt,st){let mt=nt;do{if(mt.i!==nt.i&&mt.next.i!==nt.i&&mt.i!==st.i&&mt.next.i!==st.i&&iP(mt,mt.next,nt,st))return!0;mt=mt.next}while(mt!==nt);return!1}function mp(nt,st){return Ur(nt.prev,nt,nt.next)<0?Ur(nt,st,nt.next)>=0&&Ur(nt,nt.prev,st)>=0:Ur(nt,st,nt.prev)<0||Ur(nt,nt.next,st)<0}function M4(nt,st){let mt=nt,gt=!1,_t=(nt.x+st.x)/2,Et=(nt.y+st.y)/2;do mt.y>Et!=mt.next.y>Et&&mt.next.y!==mt.y&&_t<(mt.next.x-mt.x)*(Et-mt.y)/(mt.next.y-mt.y)+mt.x&&(gt=!gt),mt=mt.next;while(mt!==nt);return gt}function nP(nt,st){let mt=new cw(nt.i,nt.x,nt.y),gt=new cw(st.i,st.x,st.y),_t=nt.next,Et=st.prev;return nt.next=st,st.prev=nt,mt.next=_t,_t.prev=mt,gt.next=mt,mt.prev=gt,Et.next=gt,gt.prev=Et,gt}function CC(nt,st,mt,gt){let _t=new cw(nt,st,mt);return gt?(_t.next=gt.next,_t.prev=gt,gt.next.prev=_t,gt.next=_t):(_t.prev=_t,_t.next=_t),_t}function gp(nt){nt.next.prev=nt.prev,nt.prev.next=nt.next,nt.prevZ&&(nt.prevZ.nextZ=nt.nextZ),nt.nextZ&&(nt.nextZ.prevZ=nt.prevZ)}function cw(nt,st,mt){this.i=nt,this.x=st,this.y=mt,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T4(nt,st,mt,gt){let _t=0;for(let Et=st,At=mt-gt;Et<mt;Et+=gt)_t+=(nt[At]-nt[Et])*(nt[Et+1]+nt[At+1]),At=Et;return _t}var Uu=class{static area(nt){let st=nt.length,mt=0;for(let gt=st-1,_t=0;_t<st;gt=_t++)mt+=nt[gt].x*nt[_t].y-nt[_t].x*nt[gt].y;return mt*.5}static isClockWise(nt){return Uu.area(nt)<0}static triangulateShape(nt,st){let mt=[],gt=[],_t=[];PC(nt),_C(mt,nt);let Et=nt.length;st.forEach(PC);for(let Rt=0;Rt<st.length;Rt++)gt.push(Et),Et+=st[Rt].length,_C(mt,st[Rt]);let At=u4.triangulate(mt,gt);for(let Rt=0;Rt<At.length;Rt+=3)_t.push(At.slice(Rt,Rt+3));return _t}};function PC(nt){let st=nt.length;st>2&&nt[st-1].equals(nt[0])&&nt.pop()}function _C(nt,st){for(let mt=0;mt<st.length;mt++)nt.push(st[mt].x),nt.push(st[mt].y)}var zu=class extends Fu{constructor(nt=1,st=0){let mt=(1+Math.sqrt(5))/2,gt=[-1,mt,0,1,mt,0,-1,-mt,0,1,-mt,0,0,-1,mt,0,1,mt,0,-1,-mt,0,1,-mt,mt,0,-1,mt,0,1,-mt,0,-1,-mt,0,1],_t=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(gt,_t,nt,st),this.type="IcosahedronGeometry",this.parameters={radius:nt,detail:st}}static fromJSON(nt){return new zu(nt.radius,nt.detail)}},Ls=class extends _e$1{constructor(nt=1,st=32,mt=16,gt=0,_t=Math.PI*2,Et=0,At=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:nt,widthSegments:st,heightSegments:mt,phiStart:gt,phiLength:_t,thetaStart:Et,thetaLength:At},st=Math.max(3,Math.floor(st)),mt=Math.max(2,Math.floor(mt));let Rt=Math.min(Et+At,Math.PI),Ft=0,Nt=[],Bt=new E$6,Gt=new E$6,dr=[],Mr=[],Tr=[],zr=[];for(let Fr=0;Fr<=mt;Fr++){let Nr=[],tn=Fr/mt,rn=0;Fr==0&&Et==0?rn=.5/st:Fr==mt&&Rt==Math.PI&&(rn=-.5/st);for(let Tn=0;Tn<=st;Tn++){let $n=Tn/st;Bt.x=-nt*Math.cos(gt+$n*_t)*Math.sin(Et+tn*At),Bt.y=nt*Math.cos(Et+tn*At),Bt.z=nt*Math.sin(gt+$n*_t)*Math.sin(Et+tn*At),Mr.push(Bt.x,Bt.y,Bt.z),Gt.copy(Bt).normalize(),Tr.push(Gt.x,Gt.y,Gt.z),zr.push($n+rn,1-tn),Nr.push(Ft++)}Nt.push(Nr)}for(let Fr=0;Fr<mt;Fr++)for(let Nr=0;Nr<st;Nr++){let tn=Nt[Fr][Nr+1],rn=Nt[Fr][Nr],Tn=Nt[Fr+1][Nr],$n=Nt[Fr+1][Nr+1];(Fr!==0||Et>0)&&dr.push(tn,rn,$n),(Fr!==mt-1||Rt<Math.PI)&&dr.push(rn,Tn,$n)}this.setIndex(dr),this.setAttribute("position",new Me$1(Mr,3)),this.setAttribute("normal",new Me$1(Tr,3)),this.setAttribute("uv",new Me$1(zr,2))}static fromJSON(nt){return new Ls(nt.radius,nt.widthSegments,nt.heightSegments,nt.phiStart,nt.phiLength,nt.thetaStart,nt.thetaLength)}},ku=class extends _e$1{constructor(nt=1,st=.4,mt=12,gt=48,_t=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:nt,tube:st,radialSegments:mt,tubularSegments:gt,arc:_t},mt=Math.floor(mt),gt=Math.floor(gt);let Et=[],At=[],Rt=[],Ft=[],Nt=new E$6,Bt=new E$6,Gt=new E$6;for(let dr=0;dr<=mt;dr++)for(let Mr=0;Mr<=gt;Mr++){let Tr=Mr/gt*_t,zr=dr/mt*Math.PI*2;Bt.x=(nt+st*Math.cos(zr))*Math.cos(Tr),Bt.y=(nt+st*Math.cos(zr))*Math.sin(Tr),Bt.z=st*Math.sin(zr),At.push(Bt.x,Bt.y,Bt.z),Nt.x=nt*Math.cos(Tr),Nt.y=nt*Math.sin(Tr),Gt.subVectors(Bt,Nt).normalize(),Rt.push(Gt.x,Gt.y,Gt.z),Ft.push(Mr/gt),Ft.push(dr/mt)}for(let dr=1;dr<=mt;dr++)for(let Mr=1;Mr<=gt;Mr++){let Tr=(gt+1)*dr+Mr-1,zr=(gt+1)*(dr-1)+Mr-1,Fr=(gt+1)*(dr-1)+Mr,Nr=(gt+1)*dr+Mr;Et.push(Tr,zr,Nr),Et.push(zr,Fr,Nr)}this.setIndex(Et),this.setAttribute("position",new Me$1(At,3)),this.setAttribute("normal",new Me$1(Rt,3)),this.setAttribute("uv",new Me$1(Ft,2))}static fromJSON(nt){return new ku(nt.radius,nt.tube,nt.radialSegments,nt.tubularSegments,nt.arc)}},Gu=class extends _e$1{constructor(nt=1,st=.4,mt=64,gt=8,_t=2,Et=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:nt,tube:st,tubularSegments:mt,radialSegments:gt,p:_t,q:Et},mt=Math.floor(mt),gt=Math.floor(gt);let At=[],Rt=[],Ft=[],Nt=[],Bt=new E$6,Gt=new E$6,dr=new E$6,Mr=new E$6,Tr=new E$6,zr=new E$6,Fr=new E$6;for(let tn=0;tn<=mt;++tn){let rn=tn/mt*_t*Math.PI*2;Nr(rn,_t,Et,nt,dr),Nr(rn+.01,_t,Et,nt,Mr),zr.subVectors(Mr,dr),Fr.addVectors(Mr,dr),Tr.crossVectors(zr,Fr),Fr.crossVectors(Tr,zr),Tr.normalize(),Fr.normalize();for(let Tn=0;Tn<=gt;++Tn){let $n=Tn/gt*Math.PI*2,un=-st*Math.cos($n),es=st*Math.sin($n);Bt.x=dr.x+(un*Fr.x+es*Tr.x),Bt.y=dr.y+(un*Fr.y+es*Tr.y),Bt.z=dr.z+(un*Fr.z+es*Tr.z),Rt.push(Bt.x,Bt.y,Bt.z),Gt.subVectors(Bt,dr).normalize(),Ft.push(Gt.x,Gt.y,Gt.z),Nt.push(tn/mt),Nt.push(Tn/gt)}}for(let tn=1;tn<=mt;tn++)for(let rn=1;rn<=gt;rn++){let Tn=(gt+1)*(tn-1)+(rn-1),$n=(gt+1)*tn+(rn-1),un=(gt+1)*tn+rn,es=(gt+1)*(tn-1)+rn;At.push(Tn,$n,es),At.push($n,un,es)}this.setIndex(At),this.setAttribute("position",new Me$1(Rt,3)),this.setAttribute("normal",new Me$1(Ft,3)),this.setAttribute("uv",new Me$1(Nt,2));function Nr(tn,rn,Tn,$n,un){let es=Math.cos(tn),kn=Math.sin(tn),ts=Tn/rn*tn,Ko=Math.cos(ts);un.x=$n*(2+Ko)*.5*es,un.y=$n*(2+Ko)*kn*.5,un.z=$n*Math.sin(ts)*.5}}static fromJSON(nt){return new Gu(nt.radius,nt.tube,nt.tubularSegments,nt.radialSegments,nt.p,nt.q)}};function qa(nt,st,mt){return sP(nt)?new nt.constructor(nt.subarray(st,mt!==void 0?mt:nt.length)):nt.slice(st,mt)}function jg(nt,st,mt){return!nt||nt.constructor===st?nt:typeof st.BYTES_PER_ELEMENT=="number"?new st(nt):Array.prototype.slice.call(nt)}function sP(nt){return ArrayBuffer.isView(nt)&&!(nt instanceof DataView)}function C4(nt){function st(_t,Et){return nt[_t]-nt[Et]}let mt=nt.length,gt=new Array(mt);for(let _t=0;_t!==mt;++_t)gt[_t]=_t;return gt.sort(st),gt}function DC(nt,st,mt){let gt=nt.length,_t=new nt.constructor(gt);for(let Et=0,At=0;At!==gt;++Et){let Rt=mt[Et]*st;for(let Ft=0;Ft!==st;++Ft)_t[At++]=nt[Rt+Ft]}return _t}function oP(nt,st,mt,gt){let _t=1,Et=nt[0];for(;Et!==void 0&&Et[gt]===void 0;)Et=nt[_t++];if(Et===void 0)return;let At=Et[gt];if(At!==void 0)if(Array.isArray(At))do At=Et[gt],At!==void 0&&(st.push(Et.time),mt.push.apply(mt,At)),Et=nt[_t++];while(Et!==void 0);else if(At.toArray!==void 0)do At=Et[gt],At!==void 0&&(st.push(Et.time),At.toArray(mt,mt.length)),Et=nt[_t++];while(Et!==void 0);else do At=Et[gt],At!==void 0&&(st.push(Et.time),mt.push(At)),Et=nt[_t++];while(Et!==void 0)}var ju=class{constructor(nt,st,mt,gt){this.parameterPositions=nt,this._cachedIndex=0,this.resultBuffer=gt!==void 0?gt:new st.constructor(mt),this.sampleValues=st,this.valueSize=mt,this.settings=null,this.DefaultSettings_={}}evaluate(nt){let st=this.parameterPositions,mt=this._cachedIndex,gt=st[mt],_t=st[mt-1];e:{t:{let Et;i:{r:if(!(nt<gt)){for(let At=mt+2;;){if(gt===void 0){if(nt<_t)break r;return mt=st.length,this._cachedIndex=mt,this.copySampleValue_(mt-1)}if(mt===At)break;if(_t=gt,gt=st[++mt],nt<gt)break t}Et=st.length;break i}if(!(nt>=_t)){let At=st[1];nt<At&&(mt=2,_t=At);for(let Rt=mt-2;;){if(_t===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(mt===Rt)break;if(gt=_t,_t=st[--mt-1],nt>=_t)break t}Et=mt,mt=0;break i}break e}for(;mt<Et;){let At=mt+Et>>>1;nt<st[At]?Et=At:mt=At+1}if(gt=st[mt],_t=st[mt-1],_t===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(gt===void 0)return mt=st.length,this._cachedIndex=mt,this.copySampleValue_(mt-1)}this._cachedIndex=mt,this.intervalChanged_(mt,_t,gt)}return this.interpolate_(mt,_t,nt,gt)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(nt){let st=this.resultBuffer,mt=this.sampleValues,gt=this.valueSize,_t=nt*gt;for(let Et=0;Et!==gt;++Et)st[Et]=mt[_t+Et];return st}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},uw=class extends ju{constructor(nt,st,mt,gt){super(nt,st,mt,gt),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Cu,endingEnd:Cu}}intervalChanged_(nt,st,mt){let gt=this.parameterPositions,_t=nt-2,Et=nt+1,At=gt[_t],Rt=gt[Et];if(At===void 0)switch(this.getSettings_().endingStart){case Pu:_t=nt,At=2*st-mt;break;case Kg:_t=gt.length-2,At=st+gt[_t]-gt[_t+1];break;default:_t=nt,At=mt}if(Rt===void 0)switch(this.getSettings_().endingEnd){case Pu:Et=nt,Rt=2*mt-st;break;case Kg:Et=1,Rt=mt+gt[1]-gt[0];break;default:Et=nt-1,Rt=st}let Ft=(mt-st)*.5,Nt=this.valueSize;this._weightPrev=Ft/(st-At),this._weightNext=Ft/(Rt-mt),this._offsetPrev=_t*Nt,this._offsetNext=Et*Nt}interpolate_(nt,st,mt,gt){let _t=this.resultBuffer,Et=this.sampleValues,At=this.valueSize,Rt=nt*At,Ft=Rt-At,Nt=this._offsetPrev,Bt=this._offsetNext,Gt=this._weightPrev,dr=this._weightNext,Mr=(mt-st)/(gt-st),Tr=Mr*Mr,zr=Tr*Mr,Fr=-Gt*zr+2*Gt*Tr-Gt*Mr,Nr=(1+Gt)*zr+(-1.5-2*Gt)*Tr+(-.5+Gt)*Mr+1,tn=(-1-dr)*zr+(1.5+dr)*Tr+.5*Mr,rn=dr*zr-dr*Tr;for(let Tn=0;Tn!==At;++Tn)_t[Tn]=Fr*Et[Nt+Tn]+Nr*Et[Ft+Tn]+tn*Et[Rt+Tn]+rn*Et[Bt+Tn];return _t}},cy=class extends ju{constructor(nt,st,mt,gt){super(nt,st,mt,gt)}interpolate_(nt,st,mt,gt){let _t=this.resultBuffer,Et=this.sampleValues,At=this.valueSize,Rt=nt*At,Ft=Rt-At,Nt=(mt-st)/(gt-st),Bt=1-Nt;for(let Gt=0;Gt!==At;++Gt)_t[Gt]=Et[Ft+Gt]*Bt+Et[Rt+Gt]*Nt;return _t}},hw=class extends ju{constructor(nt,st,mt,gt){super(nt,st,mt,gt)}interpolate_(nt){return this.copySampleValue_(nt-1)}},as=class{constructor(nt,st,mt,gt){if(nt===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(st===void 0||st.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+nt);this.name=nt,this.times=jg(st,this.TimeBufferType),this.values=jg(mt,this.ValueBufferType),this.setInterpolation(gt||this.DefaultInterpolation)}static toJSON(nt){let st=nt.constructor,mt;if(st.toJSON!==this.toJSON)mt=st.toJSON(nt);else{mt={name:nt.name,times:jg(nt.times,Array),values:jg(nt.values,Array)};let gt=nt.getInterpolation();gt!==nt.DefaultInterpolation&&(mt.interpolation=gt)}return mt.type=nt.ValueTypeName,mt}InterpolantFactoryMethodDiscrete(nt){return new hw(this.times,this.values,this.getValueSize(),nt)}InterpolantFactoryMethodLinear(nt){return new cy(this.times,this.values,this.getValueSize(),nt)}InterpolantFactoryMethodSmooth(nt){return new uw(this.times,this.values,this.getValueSize(),nt)}setInterpolation(nt){let st;switch(nt){case Xg:st=this.InterpolantFactoryMethodDiscrete;break;case Qg:st=this.InterpolantFactoryMethodLinear;break;case cS:st=this.InterpolantFactoryMethodSmooth;break}if(st===void 0){let mt="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(nt!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(mt);return console.warn("THREE.KeyframeTrack:",mt),this}return this.createInterpolant=st,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Xg;case this.InterpolantFactoryMethodLinear:return Qg;case this.InterpolantFactoryMethodSmooth:return cS}}getValueSize(){return this.values.length/this.times.length}shift(nt){if(nt!==0){let st=this.times;for(let mt=0,gt=st.length;mt!==gt;++mt)st[mt]+=nt}return this}scale(nt){if(nt!==1){let st=this.times;for(let mt=0,gt=st.length;mt!==gt;++mt)st[mt]*=nt}return this}trim(nt,st){let mt=this.times,gt=mt.length,_t=0,Et=gt-1;for(;_t!==gt&&mt[_t]<nt;)++_t;for(;Et!==-1&&mt[Et]>st;)--Et;if(++Et,_t!==0||Et!==gt){_t>=Et&&(Et=Math.max(Et,1),_t=Et-1);let At=this.getValueSize();this.times=qa(mt,_t,Et),this.values=qa(this.values,_t*At,Et*At)}return this}validate(){let nt=!0,st=this.getValueSize();st-Math.floor(st)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),nt=!1);let mt=this.times,gt=this.values,_t=mt.length;_t===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),nt=!1);let Et=null;for(let At=0;At!==_t;At++){let Rt=mt[At];if(typeof Rt=="number"&&isNaN(Rt)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,At,Rt),nt=!1;break}if(Et!==null&&Et>Rt){console.error("THREE.KeyframeTrack: Out of order keys.",this,At,Rt,Et),nt=!1;break}Et=Rt}if(gt!==void 0&&sP(gt))for(let At=0,Rt=gt.length;At!==Rt;++At){let Ft=gt[At];if(isNaN(Ft)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,At,Ft),nt=!1;break}}return nt}optimize(){let nt=qa(this.times),st=qa(this.values),mt=this.getValueSize(),gt=this.getInterpolation()===cS,_t=nt.length-1,Et=1;for(let At=1;At<_t;++At){let Rt=!1,Ft=nt[At],Nt=nt[At+1];if(Ft!==Nt&&(At!==1||Ft!==nt[0]))if(gt)Rt=!0;else{let Bt=At*mt,Gt=Bt-mt,dr=Bt+mt;for(let Mr=0;Mr!==mt;++Mr){let Tr=st[Bt+Mr];if(Tr!==st[Gt+Mr]||Tr!==st[dr+Mr]){Rt=!0;break}}}if(Rt){if(At!==Et){nt[Et]=nt[At];let Bt=At*mt,Gt=Et*mt;for(let dr=0;dr!==mt;++dr)st[Gt+dr]=st[Bt+dr]}++Et}}if(_t>0){nt[Et]=nt[_t];for(let At=_t*mt,Rt=Et*mt,Ft=0;Ft!==mt;++Ft)st[Rt+Ft]=st[At+Ft];++Et}return Et!==nt.length?(this.times=qa(nt,0,Et),this.values=qa(st,0,Et*mt)):(this.times=nt,this.values=st),this}clone(){let nt=qa(this.times,0),st=qa(this.values,0),mt=this.constructor,gt=new mt(this.name,nt,st);return gt.createInterpolant=this.createInterpolant,gt}};as.prototype.TimeBufferType=Float32Array;as.prototype.ValueBufferType=Float32Array;as.prototype.DefaultInterpolation=Qg;var rl=class extends as{};rl.prototype.ValueTypeName="bool";rl.prototype.ValueBufferType=Array;rl.prototype.DefaultInterpolation=Xg;rl.prototype.InterpolantFactoryMethodLinear=void 0;rl.prototype.InterpolantFactoryMethodSmooth=void 0;var uy=class extends as{};uy.prototype.ValueTypeName="color";var Hu=class extends as{};Hu.prototype.ValueTypeName="number";var dw=class extends ju{constructor(nt,st,mt,gt){super(nt,st,mt,gt)}interpolate_(nt,st,mt,gt){let _t=this.resultBuffer,Et=this.sampleValues,At=this.valueSize,Rt=(mt-st)/(gt-st),Ft=nt*At;for(let Nt=Ft+At;Ft!==Nt;Ft+=4)Qe$1.slerpFlat(_t,0,Et,Ft-At,Et,Ft,Rt);return _t}},Sc=class extends as{InterpolantFactoryMethodLinear(nt){return new dw(this.times,this.values,this.getValueSize(),nt)}};Sc.prototype.ValueTypeName="quaternion";Sc.prototype.DefaultInterpolation=Qg;Sc.prototype.InterpolantFactoryMethodSmooth=void 0;var il=class extends as{};il.prototype.ValueTypeName="string";il.prototype.ValueBufferType=Array;il.prototype.DefaultInterpolation=Xg;il.prototype.InterpolantFactoryMethodLinear=void 0;il.prototype.InterpolantFactoryMethodSmooth=void 0;var Wu=class extends as{};Wu.prototype.ValueTypeName="vector";var qu=class{constructor(nt,st=-1,mt,gt=Mw){this.name=nt,this.tracks=mt,this.duration=st,this.blendMode=gt,this.uuid=is(),this.duration<0&&this.resetDuration()}static parse(nt){let st=[],mt=nt.tracks,gt=1/(nt.fps||1);for(let Et=0,At=mt.length;Et!==At;++Et)st.push(_4(mt[Et]).scale(gt));let _t=new this(nt.name,nt.duration,st,nt.blendMode);return _t.uuid=nt.uuid,_t}static toJSON(nt){let st=[],mt=nt.tracks,gt={name:nt.name,duration:nt.duration,tracks:st,uuid:nt.uuid,blendMode:nt.blendMode};for(let _t=0,Et=mt.length;_t!==Et;++_t)st.push(as.toJSON(mt[_t]));return gt}static CreateFromMorphTargetSequence(nt,st,mt,gt){let _t=st.length,Et=[];for(let At=0;At<_t;At++){let Rt=[],Ft=[];Rt.push((At+_t-1)%_t,At,(At+1)%_t),Ft.push(0,1,0);let Nt=C4(Rt);Rt=DC(Rt,1,Nt),Ft=DC(Ft,1,Nt),!gt&&Rt[0]===0&&(Rt.push(_t),Ft.push(Ft[0])),Et.push(new Hu(".morphTargetInfluences["+st[At].name+"]",Rt,Ft).scale(1/mt))}return new this(nt,-1,Et)}static findByName(nt,st){let mt=nt;if(!Array.isArray(nt)){let gt=nt;mt=gt.geometry&&gt.geometry.animations||gt.animations}for(let gt=0;gt<mt.length;gt++)if(mt[gt].name===st)return mt[gt];return null}static CreateClipsFromMorphTargetSequences(nt,st,mt){let gt={},_t=/^([\w-]*?)([\d]+)$/;for(let At=0,Rt=nt.length;At<Rt;At++){let Ft=nt[At],Nt=Ft.name.match(_t);if(Nt&&Nt.length>1){let Bt=Nt[1],Gt=gt[Bt];Gt||(gt[Bt]=Gt=[]),Gt.push(Ft)}}let Et=[];for(let At in gt)Et.push(this.CreateFromMorphTargetSequence(At,gt[At],st,mt));return Et}static parseAnimation(nt,st){if(!nt)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let mt=function(Nt,Bt,Gt,dr,Mr){if(Gt.length!==0){let Tr=[],zr=[];oP(Gt,Tr,zr,dr),Tr.length!==0&&Mr.push(new Nt(Bt,Tr,zr))}},gt=[],_t=nt.name||"default",Et=nt.fps||30,At=nt.blendMode,Rt=nt.length||-1,Ft=nt.hierarchy||[];for(let Nt=0;Nt<Ft.length;Nt++){let Bt=Ft[Nt].keys;if(!(!Bt||Bt.length===0))if(Bt[0].morphTargets){let Gt={},dr;for(dr=0;dr<Bt.length;dr++)if(Bt[dr].morphTargets)for(let Mr=0;Mr<Bt[dr].morphTargets.length;Mr++)Gt[Bt[dr].morphTargets[Mr]]=-1;for(let Mr in Gt){let Tr=[],zr=[];for(let Fr=0;Fr!==Bt[dr].morphTargets.length;++Fr){let Nr=Bt[dr];Tr.push(Nr.time),zr.push(Nr.morphTarget===Mr?1:0)}gt.push(new Hu(".morphTargetInfluence["+Mr+"]",Tr,zr))}Rt=Gt.length*Et}else{let Gt=".bones["+st[Nt].name+"]";mt(Wu,Gt+".position",Bt,"pos",gt),mt(Sc,Gt+".quaternion",Bt,"rot",gt),mt(Wu,Gt+".scale",Bt,"scl",gt)}}return gt.length===0?null:new this(_t,Rt,gt,At)}resetDuration(){let nt=this.tracks,st=0;for(let mt=0,gt=nt.length;mt!==gt;++mt){let _t=this.tracks[mt];st=Math.max(st,_t.times[_t.times.length-1])}return this.duration=st,this}trim(){for(let nt=0;nt<this.tracks.length;nt++)this.tracks[nt].trim(0,this.duration);return this}validate(){let nt=!0;for(let st=0;st<this.tracks.length;st++)nt=nt&&this.tracks[st].validate();return nt}optimize(){for(let nt=0;nt<this.tracks.length;nt++)this.tracks[nt].optimize();return this}clone(){let nt=[];for(let st=0;st<this.tracks.length;st++)nt.push(this.tracks[st].clone());return new this.constructor(this.name,this.duration,nt,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function P4(nt){switch(nt.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Hu;case"vector":case"vector2":case"vector3":case"vector4":return Wu;case"color":return uy;case"quaternion":return Sc;case"bool":case"boolean":return rl;case"string":return il}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+nt)}function _4(nt){if(nt.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let st=P4(nt.type);if(nt.times===void 0){let mt=[],gt=[];oP(nt.keys,mt,gt,"value"),nt.times=mt,nt.values=gt}return st.parse!==void 0?st.parse(nt):new st(nt.name,nt.times,nt.values,nt.interpolation)}var hy={enabled:!1,files:{},add:function(nt,st){this.enabled!==!1&&(this.files[nt]=st)},get:function(nt){if(this.enabled!==!1)return this.files[nt]},remove:function(nt){delete this.files[nt]},clear:function(){this.files={}}},yp=class{constructor(nt,st,mt){let gt=this,_t=!1,Et=0,At=0,Rt,Ft=[];this.onStart=void 0,this.onLoad=nt,this.onProgress=st,this.onError=mt,this.itemStart=function(Nt){At++,_t===!1&&gt.onStart!==void 0&&gt.onStart(Nt,Et,At),_t=!0},this.itemEnd=function(Nt){Et++,gt.onProgress!==void 0&&gt.onProgress(Nt,Et,At),Et===At&&(_t=!1,gt.onLoad!==void 0&&gt.onLoad())},this.itemError=function(Nt){gt.onError!==void 0&&gt.onError(Nt)},this.resolveURL=function(Nt){return Rt?Rt(Nt):Nt},this.setURLModifier=function(Nt){return Rt=Nt,this},this.addHandler=function(Nt,Bt){return Ft.push(Nt,Bt),this},this.removeHandler=function(Nt){let Bt=Ft.indexOf(Nt);return Bt!==-1&&Ft.splice(Bt,2),this},this.getHandler=function(Nt){for(let Bt=0,Gt=Ft.length;Bt<Gt;Bt+=2){let dr=Ft[Bt],Mr=Ft[Bt+1];if(dr.global&&(dr.lastIndex=0),dr.test(Nt))return Mr}return null}}},D4=new yp,nl=class{constructor(nt){this.manager=nt!==void 0?nt:D4,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(nt,st){let mt=this;return new Promise(function(gt,_t){mt.load(nt,gt,st,_t)})}parse(){}setCrossOrigin(nt){return this.crossOrigin=nt,this}setWithCredentials(nt){return this.withCredentials=nt,this}setPath(nt){return this.path=nt,this}setResourcePath(nt){return this.resourcePath=nt,this}setRequestHeader(nt){return this.requestHeader=nt,this}},na={},fw=class extends Error{constructor(nt,st){super(nt),this.response=st}},Yu=class extends nl{constructor(nt){super(nt)}load(nt,st,mt,gt){nt===void 0&&(nt=""),this.path!==void 0&&(nt=this.path+nt),nt=this.manager.resolveURL(nt);let _t=hy.get(nt);if(_t!==void 0)return this.manager.itemStart(nt),setTimeout(()=>{st&&st(_t),this.manager.itemEnd(nt)},0),_t;if(na[nt]!==void 0){na[nt].push({onLoad:st,onProgress:mt,onError:gt});return}na[nt]=[],na[nt].push({onLoad:st,onProgress:mt,onError:gt});let Et=new Request(nt,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),At=this.mimeType,Rt=this.responseType;fetch(Et).then(Ft=>{if(Ft.status===200||Ft.status===0){if(Ft.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||Ft.body===void 0||Ft.body.getReader===void 0)return Ft;let Nt=na[nt],Bt=Ft.body.getReader(),Gt=Ft.headers.get("Content-Length")||Ft.headers.get("X-File-Size"),dr=Gt?parseInt(Gt):0,Mr=dr!==0,Tr=0,zr=new ReadableStream({start(Fr){Nr();function Nr(){Bt.read().then(({done:tn,value:rn})=>{if(tn)Fr.close();else{Tr+=rn.byteLength;let Tn=new ProgressEvent("progress",{lengthComputable:Mr,loaded:Tr,total:dr});for(let $n=0,un=Nt.length;$n<un;$n++){let es=Nt[$n];es.onProgress&&es.onProgress(Tn)}Fr.enqueue(rn),Nr()}})}}});return new Response(zr)}else throw new fw(`fetch for "${Ft.url}" responded with ${Ft.status}: ${Ft.statusText}`,Ft)}).then(Ft=>{switch(Rt){case"arraybuffer":return Ft.arrayBuffer();case"blob":return Ft.blob();case"document":return Ft.text().then(Nt=>new DOMParser().parseFromString(Nt,At));case"json":return Ft.json();default:if(At===void 0)return Ft.text();{let Nt=/charset="?([^;"\s]*)"?/i.exec(At),Bt=Nt&&Nt[1]?Nt[1].toLowerCase():void 0,Gt=new TextDecoder(Bt);return Ft.arrayBuffer().then(dr=>Gt.decode(dr))}}}).then(Ft=>{hy.add(nt,Ft);let Nt=na[nt];delete na[nt];for(let Bt=0,Gt=Nt.length;Bt<Gt;Bt++){let dr=Nt[Bt];dr.onLoad&&dr.onLoad(Ft)}}).catch(Ft=>{let Nt=na[nt];if(Nt===void 0)throw this.manager.itemError(nt),Ft;delete na[nt];for(let Bt=0,Gt=Nt.length;Bt<Gt;Bt++){let dr=Nt[Bt];dr.onError&&dr.onError(Ft)}this.manager.itemError(nt)}).finally(()=>{this.manager.itemEnd(nt)}),this.manager.itemStart(nt)}setResponseType(nt){return this.responseType=nt,this}setMimeType(nt){return this.mimeType=nt,this}},pw=class extends nl{constructor(nt){super(nt)}load(nt,st,mt,gt){this.path!==void 0&&(nt=this.path+nt),nt=this.manager.resolveURL(nt);let _t=this,Et=hy.get(nt);if(Et!==void 0)return _t.manager.itemStart(nt),setTimeout(function(){st&&st(Et),_t.manager.itemEnd(nt)},0),Et;let At=ap("img");function Rt(){Nt(),hy.add(nt,this),st&&st(this),_t.manager.itemEnd(nt)}function Ft(Bt){Nt(),gt&&gt(Bt),_t.manager.itemError(nt),_t.manager.itemEnd(nt)}function Nt(){At.removeEventListener("load",Rt,!1),At.removeEventListener("error",Ft,!1)}return At.addEventListener("load",Rt,!1),At.addEventListener("error",Ft,!1),nt.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(At.crossOrigin=this.crossOrigin),_t.manager.itemStart(nt),At.src=nt,At}},dy=class extends nl{constructor(nt){super(nt)}load(nt,st,mt,gt){let _t=new $t,Et=new pw(this.manager);return Et.setCrossOrigin(this.crossOrigin),Et.setPath(this.path),Et.load(nt,function(At){_t.image=At,_t.needsUpdate=!0,st!==void 0&&st(_t)},mt,gt),_t}},sl=class extends Mt{constructor(nt,st=1){super(),this.isLight=!0,this.type="Light",this.color=new We$1(nt),this.intensity=st}dispose(){}copy(nt,st){return super.copy(nt,st),this.color.copy(nt.color),this.intensity=nt.intensity,this}toJSON(nt){let st=super.toJSON(nt);return st.object.color=this.color.getHex(),st.object.intensity=this.intensity,this.groundColor!==void 0&&(st.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(st.object.distance=this.distance),this.angle!==void 0&&(st.object.angle=this.angle),this.decay!==void 0&&(st.object.decay=this.decay),this.penumbra!==void 0&&(st.object.penumbra=this.penumbra),this.shadow!==void 0&&(st.object.shadow=this.shadow.toJSON()),st}},fy=class extends sl{constructor(nt,st,mt){super(nt,mt),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Mt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new We$1(st)}copy(nt,st){return super.copy(nt,st),this.groundColor.copy(nt.groundColor),this}},VS=new ue$1,IC=new E$6,OC=new E$6,vp=class{constructor(nt){this.camera=nt,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new U$1(512,512),this.map=null,this.mapPass=null,this.matrix=new ue$1,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new cp,this._frameExtents=new U$1(1,1),this._viewportCount=1,this._viewports=[new Ze$1(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(nt){let st=this.camera,mt=this.matrix;IC.setFromMatrixPosition(nt.matrixWorld),st.position.copy(IC),OC.setFromMatrixPosition(nt.target.matrixWorld),st.lookAt(OC),st.updateMatrixWorld(),VS.multiplyMatrices(st.projectionMatrix,st.matrixWorldInverse),this._frustum.setFromProjectionMatrix(VS),mt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),mt.multiply(VS)}getViewport(nt){return this._viewports[nt]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(nt){return this.camera=nt.camera.clone(),this.bias=nt.bias,this.radius=nt.radius,this.mapSize.copy(nt.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let nt={};return this.bias!==0&&(nt.bias=this.bias),this.normalBias!==0&&(nt.normalBias=this.normalBias),this.radius!==1&&(nt.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(nt.mapSize=this.mapSize.toArray()),nt.camera=this.camera.toJSON(!1).object,delete nt.camera.matrix,nt}},mw=class extends vp{constructor(){super(new $r(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(nt){let st=this.camera,mt=op*2*nt.angle*this.focus,gt=this.mapSize.width/this.mapSize.height,_t=nt.distance||st.far;(mt!==st.fov||gt!==st.aspect||_t!==st.far)&&(st.fov=mt,st.aspect=gt,st.far=_t,st.updateProjectionMatrix()),super.updateMatrices(nt)}copy(nt){return super.copy(nt),this.focus=nt.focus,this}},py=class extends sl{constructor(nt,st,mt=0,gt=Math.PI/3,_t=0,Et=2){super(nt,st),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Mt.DEFAULT_UP),this.updateMatrix(),this.target=new Mt,this.distance=mt,this.angle=gt,this.penumbra=_t,this.decay=Et,this.map=null,this.shadow=new mw}get power(){return this.intensity*Math.PI}set power(nt){this.intensity=nt/Math.PI}dispose(){this.shadow.dispose()}copy(nt,st){return super.copy(nt,st),this.distance=nt.distance,this.angle=nt.angle,this.penumbra=nt.penumbra,this.decay=nt.decay,this.target=nt.target.clone(),this.shadow=nt.shadow.clone(),this}},RC=new ue$1,Zf=new E$6,US=new E$6,gw=class extends vp{constructor(){super(new $r(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new U$1(4,2),this._viewportCount=6,this._viewports=[new Ze$1(2,1,1,1),new Ze$1(0,1,1,1),new Ze$1(3,1,1,1),new Ze$1(1,1,1,1),new Ze$1(3,0,1,1),new Ze$1(1,0,1,1)],this._cubeDirections=[new E$6(1,0,0),new E$6(-1,0,0),new E$6(0,0,1),new E$6(0,0,-1),new E$6(0,1,0),new E$6(0,-1,0)],this._cubeUps=[new E$6(0,1,0),new E$6(0,1,0),new E$6(0,1,0),new E$6(0,1,0),new E$6(0,0,1),new E$6(0,0,-1)]}updateMatrices(nt,st=0){let mt=this.camera,gt=this.matrix,_t=nt.distance||mt.far;_t!==mt.far&&(mt.far=_t,mt.updateProjectionMatrix()),Zf.setFromMatrixPosition(nt.matrixWorld),mt.position.copy(Zf),US.copy(mt.position),US.add(this._cubeDirections[st]),mt.up.copy(this._cubeUps[st]),mt.lookAt(US),mt.updateMatrixWorld(),gt.makeTranslation(-Zf.x,-Zf.y,-Zf.z),RC.multiplyMatrices(mt.projectionMatrix,mt.matrixWorldInverse),this._frustum.setFromProjectionMatrix(RC)}},my=class extends sl{constructor(nt,st,mt=0,gt=2){super(nt,st),this.isPointLight=!0,this.type="PointLight",this.distance=mt,this.decay=gt,this.shadow=new gw}get power(){return this.intensity*4*Math.PI}set power(nt){this.intensity=nt/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(nt,st){return super.copy(nt,st),this.distance=nt.distance,this.decay=nt.decay,this.shadow=nt.shadow.clone(),this}},yw=class extends vp{constructor(){super(new Ja(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},gy=class extends sl{constructor(nt,st){super(nt,st),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Mt.DEFAULT_UP),this.updateMatrix(),this.target=new Mt,this.shadow=new yw}dispose(){this.shadow.dispose()}copy(nt){return super.copy(nt),this.target=nt.target.clone(),this.shadow=nt.shadow.clone(),this}},xp=class extends _e$1{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(nt){return super.copy(nt),this.instanceCount=nt.instanceCount,this}toJSON(){let nt=super.toJSON();return nt.instanceCount=this.instanceCount,nt.isInstancedBufferGeometry=!0,nt}},Xu=class extends nl{constructor(nt){super(nt)}load(nt,st,mt,gt){let _t=this,Et=new Yu(_t.manager);Et.setPath(_t.path),Et.setRequestHeader(_t.requestHeader),Et.setWithCredentials(_t.withCredentials),Et.load(nt,function(At){try{st(_t.parse(JSON.parse(At)))}catch(Rt){gt?gt(Rt):console.error(Rt),_t.manager.itemError(nt)}},mt,gt)}parse(nt){let st={},mt={};function gt(Gt,dr){if(st[dr]!==void 0)return st[dr];let Mr=Gt.interleavedBuffers[dr],Tr=_t(Gt,Mr.buffer),zr=xg(Mr.type,Tr),Fr=new sy(zr,Mr.stride);return Fr.uuid=Mr.uuid,st[dr]=Fr,Fr}function _t(Gt,dr){if(mt[dr]!==void 0)return mt[dr];let Mr=Gt.arrayBuffers[dr],Tr=new Uint32Array(Mr).buffer;return mt[dr]=Tr,Tr}let Et=nt.isInstancedBufferGeometry?new xp:new _e$1,At=nt.data.index;if(At!==void 0){let Gt=xg(At.type,At.array);Et.setIndex(new Xe$1(Gt,1))}let Rt=nt.data.attributes;for(let Gt in Rt){let dr=Rt[Gt],Mr;if(dr.isInterleavedBufferAttribute){let Tr=gt(nt.data,dr.data);Mr=new pc(Tr,dr.itemSize,dr.offset,dr.normalized)}else{let Tr=xg(dr.type,dr.array),zr=dr.isInstancedBufferAttribute?fo$1:Xe$1;Mr=new zr(Tr,dr.itemSize,dr.normalized)}dr.name!==void 0&&(Mr.name=dr.name),dr.usage!==void 0&&Mr.setUsage(dr.usage),dr.updateRange!==void 0&&(Mr.updateRange.offset=dr.updateRange.offset,Mr.updateRange.count=dr.updateRange.count),Et.setAttribute(Gt,Mr)}let Ft=nt.data.morphAttributes;if(Ft)for(let Gt in Ft){let dr=Ft[Gt],Mr=[];for(let Tr=0,zr=dr.length;Tr<zr;Tr++){let Fr=dr[Tr],Nr;if(Fr.isInterleavedBufferAttribute){let tn=gt(nt.data,Fr.data);Nr=new pc(tn,Fr.itemSize,Fr.offset,Fr.normalized)}else{let tn=xg(Fr.type,Fr.array);Nr=new Xe$1(tn,Fr.itemSize,Fr.normalized)}Fr.name!==void 0&&(Nr.name=Fr.name),Mr.push(Nr)}Et.morphAttributes[Gt]=Mr}nt.data.morphTargetsRelative&&(Et.morphTargetsRelative=!0);let Nt=nt.data.groups||nt.data.drawcalls||nt.data.offsets;if(Nt!==void 0)for(let Gt=0,dr=Nt.length;Gt!==dr;++Gt){let Mr=Nt[Gt];Et.addGroup(Mr.start,Mr.count,Mr.materialIndex)}let Bt=nt.data.boundingSphere;if(Bt!==void 0){let Gt=new E$6;Bt.center!==void 0&&Gt.fromArray(Bt.center),Et.boundingSphere=new Or(Gt,Bt.radius)}return nt.name&&(Et.name=nt.name),nt.userData&&(Et.userData=nt.userData),Et}},yy=class{constructor(nt=!0){this.autoStart=nt,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=LC(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let nt=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let st=LC();nt=(st-this.oldTime)/1e3,this.oldTime=st,this.elapsedTime+=nt}return nt}};function LC(){return(typeof performance>"u"?Date:performance).now()}var vw=class{constructor(nt,st,mt){this.binding=nt,this.valueSize=mt;let gt,_t,Et;switch(st){case"quaternion":gt=this._slerp,_t=this._slerpAdditive,Et=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(mt*6),this._workIndex=5;break;case"string":case"bool":gt=this._select,_t=this._select,Et=this._setAdditiveIdentityOther,this.buffer=new Array(mt*5);break;default:gt=this._lerp,_t=this._lerpAdditive,Et=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(mt*5)}this._mixBufferRegion=gt,this._mixBufferRegionAdditive=_t,this._setIdentity=Et,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(nt,st){let mt=this.buffer,gt=this.valueSize,_t=nt*gt+gt,Et=this.cumulativeWeight;if(Et===0){for(let At=0;At!==gt;++At)mt[_t+At]=mt[At];Et=st}else{Et+=st;let At=st/Et;this._mixBufferRegion(mt,_t,0,At,gt)}this.cumulativeWeight=Et}accumulateAdditive(nt){let st=this.buffer,mt=this.valueSize,gt=mt*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(st,gt,0,nt,mt),this.cumulativeWeightAdditive+=nt}apply(nt){let st=this.valueSize,mt=this.buffer,gt=nt*st+st,_t=this.cumulativeWeight,Et=this.cumulativeWeightAdditive,At=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,_t<1){let Rt=st*this._origIndex;this._mixBufferRegion(mt,gt,Rt,1-_t,st)}Et>0&&this._mixBufferRegionAdditive(mt,gt,this._addIndex*st,1,st);for(let Rt=st,Ft=st+st;Rt!==Ft;++Rt)if(mt[Rt]!==mt[Rt+st]){At.setValue(mt,gt);break}}saveOriginalState(){let nt=this.binding,st=this.buffer,mt=this.valueSize,gt=mt*this._origIndex;nt.getValue(st,gt);for(let _t=mt,Et=gt;_t!==Et;++_t)st[_t]=st[gt+_t%mt];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let nt=this.valueSize*3;this.binding.setValue(this.buffer,nt)}_setAdditiveIdentityNumeric(){let nt=this._addIndex*this.valueSize,st=nt+this.valueSize;for(let mt=nt;mt<st;mt++)this.buffer[mt]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let nt=this._origIndex*this.valueSize,st=this._addIndex*this.valueSize;for(let mt=0;mt<this.valueSize;mt++)this.buffer[st+mt]=this.buffer[nt+mt]}_select(nt,st,mt,gt,_t){if(gt>=.5)for(let Et=0;Et!==_t;++Et)nt[st+Et]=nt[mt+Et]}_slerp(nt,st,mt,gt){Qe$1.slerpFlat(nt,st,nt,st,nt,mt,gt)}_slerpAdditive(nt,st,mt,gt,_t){let Et=this._workIndex*_t;Qe$1.multiplyQuaternionsFlat(nt,Et,nt,st,nt,mt),Qe$1.slerpFlat(nt,st,nt,st,nt,Et,gt)}_lerp(nt,st,mt,gt,_t){let Et=1-gt;for(let At=0;At!==_t;++At){let Rt=st+At;nt[Rt]=nt[Rt]*Et+nt[mt+At]*gt}}_lerpAdditive(nt,st,mt,gt,_t){for(let Et=0;Et!==_t;++Et){let At=st+Et;nt[At]=nt[At]+nt[mt+Et]*gt}}},Iw="\\[\\]\\.:\\/",I4=new RegExp("["+Iw+"]","g"),Ow="[^"+Iw+"]",O4="[^"+Iw.replace("\\.","")+"]",R4=/((?:WC+[\/:])*)/.source.replace("WC",Ow),L4=/(WCOD+)?/.source.replace("WCOD",O4),B4=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Ow),N4=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Ow),F4=new RegExp("^"+R4+L4+B4+N4+"$"),V4=["material","materials","bones","map"],xw=class{constructor(nt,st,mt){let gt=mt||Zt.parseTrackName(st);this._targetGroup=nt,this._bindings=nt.subscribe_(st,gt)}getValue(nt,st){this.bind();let mt=this._targetGroup.nCachedObjects_,gt=this._bindings[mt];gt!==void 0&&gt.getValue(nt,st)}setValue(nt,st){let mt=this._bindings;for(let gt=this._targetGroup.nCachedObjects_,_t=mt.length;gt!==_t;++gt)mt[gt].setValue(nt,st)}bind(){let nt=this._bindings;for(let st=this._targetGroup.nCachedObjects_,mt=nt.length;st!==mt;++st)nt[st].bind()}unbind(){let nt=this._bindings;for(let st=this._targetGroup.nCachedObjects_,mt=nt.length;st!==mt;++st)nt[st].unbind()}},Zt=class{constructor(nt,st,mt){this.path=st,this.parsedPath=mt||Zt.parseTrackName(st),this.node=Zt.findNode(nt,this.parsedPath.nodeName)||nt,this.rootNode=nt,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(nt,st,mt){return nt&&nt.isAnimationObjectGroup?new Zt.Composite(nt,st,mt):new Zt(nt,st,mt)}static sanitizeNodeName(nt){return nt.replace(/\s/g,"_").replace(I4,"")}static parseTrackName(nt){let st=F4.exec(nt);if(st===null)throw new Error("PropertyBinding: Cannot parse trackName: "+nt);let mt={nodeName:st[2],objectName:st[3],objectIndex:st[4],propertyName:st[5],propertyIndex:st[6]},gt=mt.nodeName&&mt.nodeName.lastIndexOf(".");if(gt!==void 0&&gt!==-1){let _t=mt.nodeName.substring(gt+1);V4.indexOf(_t)!==-1&&(mt.nodeName=mt.nodeName.substring(0,gt),mt.objectName=_t)}if(mt.propertyName===null||mt.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+nt);return mt}static findNode(nt,st){if(st===void 0||st===""||st==="."||st===-1||st===nt.name||st===nt.uuid)return nt;if(nt.skeleton){let mt=nt.skeleton.getBoneByName(st);if(mt!==void 0)return mt}if(nt.children){let mt=function(_t){for(let Et=0;Et<_t.length;Et++){let At=_t[Et];if(At.name===st||At.uuid===st)return At;let Rt=mt(At.children);if(Rt)return Rt}return null},gt=mt(nt.children);if(gt)return gt}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(nt,st){nt[st]=this.targetObject[this.propertyName]}_getValue_array(nt,st){let mt=this.resolvedProperty;for(let gt=0,_t=mt.length;gt!==_t;++gt)nt[st++]=mt[gt]}_getValue_arrayElement(nt,st){nt[st]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(nt,st){this.resolvedProperty.toArray(nt,st)}_setValue_direct(nt,st){this.targetObject[this.propertyName]=nt[st]}_setValue_direct_setNeedsUpdate(nt,st){this.targetObject[this.propertyName]=nt[st],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(nt,st){this.targetObject[this.propertyName]=nt[st],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(nt,st){let mt=this.resolvedProperty;for(let gt=0,_t=mt.length;gt!==_t;++gt)mt[gt]=nt[st++]}_setValue_array_setNeedsUpdate(nt,st){let mt=this.resolvedProperty;for(let gt=0,_t=mt.length;gt!==_t;++gt)mt[gt]=nt[st++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(nt,st){let mt=this.resolvedProperty;for(let gt=0,_t=mt.length;gt!==_t;++gt)mt[gt]=nt[st++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(nt,st){this.resolvedProperty[this.propertyIndex]=nt[st]}_setValue_arrayElement_setNeedsUpdate(nt,st){this.resolvedProperty[this.propertyIndex]=nt[st],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(nt,st){this.resolvedProperty[this.propertyIndex]=nt[st],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(nt,st){this.resolvedProperty.fromArray(nt,st)}_setValue_fromArray_setNeedsUpdate(nt,st){this.resolvedProperty.fromArray(nt,st),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(nt,st){this.resolvedProperty.fromArray(nt,st),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(nt,st){this.bind(),this.getValue(nt,st)}_setValue_unbound(nt,st){this.bind(),this.setValue(nt,st)}bind(){let nt=this.node,st=this.parsedPath,mt=st.objectName,gt=st.propertyName,_t=st.propertyIndex;if(nt||(nt=Zt.findNode(this.rootNode,st.nodeName)||this.rootNode,this.node=nt),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!nt){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(mt){let Ft=st.objectIndex;switch(mt){case"materials":if(!nt.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!nt.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}nt=nt.material.materials;break;case"bones":if(!nt.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}nt=nt.skeleton.bones;for(let Nt=0;Nt<nt.length;Nt++)if(nt[Nt].name===Ft){Ft=Nt;break}break;case"map":if("map"in nt){nt=nt.map;break}if(!nt.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!nt.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}nt=nt.material.map;break;default:if(nt[mt]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}nt=nt[mt]}if(Ft!==void 0){if(nt[Ft]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,nt);return}nt=nt[Ft]}}let Et=nt[gt];if(Et===void 0){let Ft=st.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+Ft+"."+gt+" but it wasn't found.",nt);return}let At=this.Versioning.None;this.targetObject=nt,nt.needsUpdate!==void 0?At=this.Versioning.NeedsUpdate:nt.matrixWorldNeedsUpdate!==void 0&&(At=this.Versioning.MatrixWorldNeedsUpdate);let Rt=this.BindingType.Direct;if(_t!==void 0){if(gt==="morphTargetInfluences"){if(!nt.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!nt.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}nt.morphTargetDictionary[_t]!==void 0&&(_t=nt.morphTargetDictionary[_t])}Rt=this.BindingType.ArrayElement,this.resolvedProperty=Et,this.propertyIndex=_t}else Et.fromArray!==void 0&&Et.toArray!==void 0?(Rt=this.BindingType.HasFromToArray,this.resolvedProperty=Et):Array.isArray(Et)?(Rt=this.BindingType.EntireArray,this.resolvedProperty=Et):this.propertyName=gt;this.getValue=this.GetterByBindingType[Rt],this.setValue=this.SetterByBindingTypeAndVersioning[Rt][At]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Zt.Composite=xw;Zt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Zt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Zt.prototype.GetterByBindingType=[Zt.prototype._getValue_direct,Zt.prototype._getValue_array,Zt.prototype._getValue_arrayElement,Zt.prototype._getValue_toArray];Zt.prototype.SetterByBindingTypeAndVersioning=[[Zt.prototype._setValue_direct,Zt.prototype._setValue_direct_setNeedsUpdate,Zt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Zt.prototype._setValue_array,Zt.prototype._setValue_array_setNeedsUpdate,Zt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Zt.prototype._setValue_arrayElement,Zt.prototype._setValue_arrayElement_setNeedsUpdate,Zt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Zt.prototype._setValue_fromArray,Zt.prototype._setValue_fromArray_setNeedsUpdate,Zt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var bw=class{constructor(nt,st,mt=null,gt=st.blendMode){this._mixer=nt,this._clip=st,this._localRoot=mt,this.blendMode=gt;let _t=st.tracks,Et=_t.length,At=new Array(Et),Rt={endingStart:Cu,endingEnd:Cu};for(let Ft=0;Ft!==Et;++Ft){let Nt=_t[Ft].createInterpolant(null);At[Ft]=Nt,Nt.settings=Rt}this._interpolantSettings=Rt,this._interpolants=At,this._propertyBindings=new Array(Et),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ew,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(nt){return this._startTime=nt,this}setLoop(nt,st){return this.loop=nt,this.repetitions=st,this}setEffectiveWeight(nt){return this.weight=nt,this._effectiveWeight=this.enabled?nt:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(nt){return this._scheduleFading(nt,0,1)}fadeOut(nt){return this._scheduleFading(nt,1,0)}crossFadeFrom(nt,st,mt){if(nt.fadeOut(st),this.fadeIn(st),mt){let gt=this._clip.duration,_t=nt._clip.duration,Et=_t/gt,At=gt/_t;nt.warp(1,Et,st),this.warp(At,1,st)}return this}crossFadeTo(nt,st,mt){return nt.crossFadeFrom(this,st,mt)}stopFading(){let nt=this._weightInterpolant;return nt!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(nt)),this}setEffectiveTimeScale(nt){return this.timeScale=nt,this._effectiveTimeScale=this.paused?0:nt,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(nt){return this.timeScale=this._clip.duration/nt,this.stopWarping()}syncWith(nt){return this.time=nt.time,this.timeScale=nt.timeScale,this.stopWarping()}halt(nt){return this.warp(this._effectiveTimeScale,0,nt)}warp(nt,st,mt){let gt=this._mixer,_t=gt.time,Et=this.timeScale,At=this._timeScaleInterpolant;At===null&&(At=gt._lendControlInterpolant(),this._timeScaleInterpolant=At);let Rt=At.parameterPositions,Ft=At.sampleValues;return Rt[0]=_t,Rt[1]=_t+mt,Ft[0]=nt/Et,Ft[1]=st/Et,this}stopWarping(){let nt=this._timeScaleInterpolant;return nt!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(nt)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(nt,st,mt,gt){if(!this.enabled){this._updateWeight(nt);return}let _t=this._startTime;if(_t!==null){let Rt=(nt-_t)*mt;Rt<0||mt===0?st=0:(this._startTime=null,st=mt*Rt)}st*=this._updateTimeScale(nt);let Et=this._updateTime(st),At=this._updateWeight(nt);if(At>0){let Rt=this._interpolants,Ft=this._propertyBindings;switch(this.blendMode){case JF:for(let Nt=0,Bt=Rt.length;Nt!==Bt;++Nt)Rt[Nt].evaluate(Et),Ft[Nt].accumulateAdditive(At);break;case Mw:default:for(let Nt=0,Bt=Rt.length;Nt!==Bt;++Nt)Rt[Nt].evaluate(Et),Ft[Nt].accumulate(gt,At)}}}_updateWeight(nt){let st=0;if(this.enabled){st=this.weight;let mt=this._weightInterpolant;if(mt!==null){let gt=mt.evaluate(nt)[0];st*=gt,nt>mt.parameterPositions[1]&&(this.stopFading(),gt===0&&(this.enabled=!1))}}return this._effectiveWeight=st,st}_updateTimeScale(nt){let st=0;if(!this.paused){st=this.timeScale;let mt=this._timeScaleInterpolant;if(mt!==null){let gt=mt.evaluate(nt)[0];st*=gt,nt>mt.parameterPositions[1]&&(this.stopWarping(),st===0?this.paused=!0:this.timeScale=st)}}return this._effectiveTimeScale=st,st}_updateTime(nt){let st=this._clip.duration,mt=this.loop,gt=this.time+nt,_t=this._loopCount,Et=mt===Sp;if(nt===0)return _t===-1?gt:Et&&(_t&1)===1?st-gt:gt;if(mt===Aw){_t===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(gt>=st)gt=st;else if(gt<0)gt=0;else{this.time=gt;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=gt,this._mixer.dispatchEvent({type:"finished",action:this,direction:nt<0?-1:1})}}else{if(_t===-1&&(nt>=0?(_t=0,this._setEndings(!0,this.repetitions===0,Et)):this._setEndings(this.repetitions===0,!0,Et)),gt>=st||gt<0){let At=Math.floor(gt/st);gt-=st*At,_t+=Math.abs(At);let Rt=this.repetitions-_t;if(Rt<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,gt=nt>0?st:0,this.time=gt,this._mixer.dispatchEvent({type:"finished",action:this,direction:nt>0?1:-1});else{if(Rt===1){let Ft=nt<0;this._setEndings(Ft,!Ft,Et)}else this._setEndings(!1,!1,Et);this._loopCount=_t,this.time=gt,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:At})}}else this.time=gt;if(Et&&(_t&1)===1)return st-gt}return gt}_setEndings(nt,st,mt){let gt=this._interpolantSettings;mt?(gt.endingStart=Pu,gt.endingEnd=Pu):(nt?gt.endingStart=this.zeroSlopeAtStart?Pu:Cu:gt.endingStart=Kg,st?gt.endingEnd=this.zeroSlopeAtEnd?Pu:Cu:gt.endingEnd=Kg)}_scheduleFading(nt,st,mt){let gt=this._mixer,_t=gt.time,Et=this._weightInterpolant;Et===null&&(Et=gt._lendControlInterpolant(),this._weightInterpolant=Et);let At=Et.parameterPositions,Rt=Et.sampleValues;return At[0]=_t,Rt[0]=st,At[1]=_t+nt,Rt[1]=mt,this}},U4=new Float32Array(1),vy=class extends pr{constructor(nt){super(),this._root=nt,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(nt,st){let mt=nt._localRoot||this._root,gt=nt._clip.tracks,_t=gt.length,Et=nt._propertyBindings,At=nt._interpolants,Rt=mt.uuid,Ft=this._bindingsByRootAndName,Nt=Ft[Rt];Nt===void 0&&(Nt={},Ft[Rt]=Nt);for(let Bt=0;Bt!==_t;++Bt){let Gt=gt[Bt],dr=Gt.name,Mr=Nt[dr];if(Mr!==void 0)++Mr.referenceCount,Et[Bt]=Mr;else{if(Mr=Et[Bt],Mr!==void 0){Mr._cacheIndex===null&&(++Mr.referenceCount,this._addInactiveBinding(Mr,Rt,dr));continue}let Tr=st&&st._propertyBindings[Bt].binding.parsedPath;Mr=new vw(Zt.create(mt,dr,Tr),Gt.ValueTypeName,Gt.getValueSize()),++Mr.referenceCount,this._addInactiveBinding(Mr,Rt,dr),Et[Bt]=Mr}At[Bt].resultBuffer=Mr.buffer}}_activateAction(nt){if(!this._isActiveAction(nt)){if(nt._cacheIndex===null){let mt=(nt._localRoot||this._root).uuid,gt=nt._clip.uuid,_t=this._actionsByClip[gt];this._bindAction(nt,_t&&_t.knownActions[0]),this._addInactiveAction(nt,gt,mt)}let st=nt._propertyBindings;for(let mt=0,gt=st.length;mt!==gt;++mt){let _t=st[mt];_t.useCount++===0&&(this._lendBinding(_t),_t.saveOriginalState())}this._lendAction(nt)}}_deactivateAction(nt){if(this._isActiveAction(nt)){let st=nt._propertyBindings;for(let mt=0,gt=st.length;mt!==gt;++mt){let _t=st[mt];--_t.useCount===0&&(_t.restoreOriginalState(),this._takeBackBinding(_t))}this._takeBackAction(nt)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let nt=this;this.stats={actions:{get total(){return nt._actions.length},get inUse(){return nt._nActiveActions}},bindings:{get total(){return nt._bindings.length},get inUse(){return nt._nActiveBindings}},controlInterpolants:{get total(){return nt._controlInterpolants.length},get inUse(){return nt._nActiveControlInterpolants}}}}_isActiveAction(nt){let st=nt._cacheIndex;return st!==null&&st<this._nActiveActions}_addInactiveAction(nt,st,mt){let gt=this._actions,_t=this._actionsByClip,Et=_t[st];if(Et===void 0)Et={knownActions:[nt],actionByRoot:{}},nt._byClipCacheIndex=0,_t[st]=Et;else{let At=Et.knownActions;nt._byClipCacheIndex=At.length,At.push(nt)}nt._cacheIndex=gt.length,gt.push(nt),Et.actionByRoot[mt]=nt}_removeInactiveAction(nt){let st=this._actions,mt=st[st.length-1],gt=nt._cacheIndex;mt._cacheIndex=gt,st[gt]=mt,st.pop(),nt._cacheIndex=null;let _t=nt._clip.uuid,Et=this._actionsByClip,At=Et[_t],Rt=At.knownActions,Ft=Rt[Rt.length-1],Nt=nt._byClipCacheIndex;Ft._byClipCacheIndex=Nt,Rt[Nt]=Ft,Rt.pop(),nt._byClipCacheIndex=null;let Bt=At.actionByRoot,Gt=(nt._localRoot||this._root).uuid;delete Bt[Gt],Rt.length===0&&delete Et[_t],this._removeInactiveBindingsForAction(nt)}_removeInactiveBindingsForAction(nt){let st=nt._propertyBindings;for(let mt=0,gt=st.length;mt!==gt;++mt){let _t=st[mt];--_t.referenceCount===0&&this._removeInactiveBinding(_t)}}_lendAction(nt){let st=this._actions,mt=nt._cacheIndex,gt=this._nActiveActions++,_t=st[gt];nt._cacheIndex=gt,st[gt]=nt,_t._cacheIndex=mt,st[mt]=_t}_takeBackAction(nt){let st=this._actions,mt=nt._cacheIndex,gt=--this._nActiveActions,_t=st[gt];nt._cacheIndex=gt,st[gt]=nt,_t._cacheIndex=mt,st[mt]=_t}_addInactiveBinding(nt,st,mt){let gt=this._bindingsByRootAndName,_t=this._bindings,Et=gt[st];Et===void 0&&(Et={},gt[st]=Et),Et[mt]=nt,nt._cacheIndex=_t.length,_t.push(nt)}_removeInactiveBinding(nt){let st=this._bindings,mt=nt.binding,gt=mt.rootNode.uuid,_t=mt.path,Et=this._bindingsByRootAndName,At=Et[gt],Rt=st[st.length-1],Ft=nt._cacheIndex;Rt._cacheIndex=Ft,st[Ft]=Rt,st.pop(),delete At[_t],Object.keys(At).length===0&&delete Et[gt]}_lendBinding(nt){let st=this._bindings,mt=nt._cacheIndex,gt=this._nActiveBindings++,_t=st[gt];nt._cacheIndex=gt,st[gt]=nt,_t._cacheIndex=mt,st[mt]=_t}_takeBackBinding(nt){let st=this._bindings,mt=nt._cacheIndex,gt=--this._nActiveBindings,_t=st[gt];nt._cacheIndex=gt,st[gt]=nt,_t._cacheIndex=mt,st[mt]=_t}_lendControlInterpolant(){let nt=this._controlInterpolants,st=this._nActiveControlInterpolants++,mt=nt[st];return mt===void 0&&(mt=new cy(new Float32Array(2),new Float32Array(2),1,U4),mt.__cacheIndex=st,nt[st]=mt),mt}_takeBackControlInterpolant(nt){let st=this._controlInterpolants,mt=nt.__cacheIndex,gt=--this._nActiveControlInterpolants,_t=st[gt];nt.__cacheIndex=gt,st[gt]=nt,_t.__cacheIndex=mt,st[mt]=_t}clipAction(nt,st,mt){let gt=st||this._root,_t=gt.uuid,Et=typeof nt=="string"?qu.findByName(gt,nt):nt,At=Et!==null?Et.uuid:nt,Rt=this._actionsByClip[At],Ft=null;if(mt===void 0&&(Et!==null?mt=Et.blendMode:mt=Mw),Rt!==void 0){let Bt=Rt.actionByRoot[_t];if(Bt!==void 0&&Bt.blendMode===mt)return Bt;Ft=Rt.knownActions[0],Et===null&&(Et=Ft._clip)}if(Et===null)return null;let Nt=new bw(this,Et,st,mt);return this._bindAction(Nt,Ft),this._addInactiveAction(Nt,At,_t),Nt}existingAction(nt,st){let mt=st||this._root,gt=mt.uuid,_t=typeof nt=="string"?qu.findByName(mt,nt):nt,Et=_t?_t.uuid:nt,At=this._actionsByClip[Et];return At!==void 0&&At.actionByRoot[gt]||null}stopAllAction(){let nt=this._actions,st=this._nActiveActions;for(let mt=st-1;mt>=0;--mt)nt[mt].stop();return this}update(nt){nt*=this.timeScale;let st=this._actions,mt=this._nActiveActions,gt=this.time+=nt,_t=Math.sign(nt),Et=this._accuIndex^=1;for(let Ft=0;Ft!==mt;++Ft)st[Ft]._update(gt,nt,_t,Et);let At=this._bindings,Rt=this._nActiveBindings;for(let Ft=0;Ft!==Rt;++Ft)At[Ft].apply(Et);return this}setTime(nt){this.time=0;for(let st=0;st<this._actions.length;st++)this._actions[st].time=0;return this.update(nt)}getRoot(){return this._root}uncacheClip(nt){let st=this._actions,mt=nt.uuid,gt=this._actionsByClip,_t=gt[mt];if(_t!==void 0){let Et=_t.knownActions;for(let At=0,Rt=Et.length;At!==Rt;++At){let Ft=Et[At];this._deactivateAction(Ft);let Nt=Ft._cacheIndex,Bt=st[st.length-1];Ft._cacheIndex=null,Ft._byClipCacheIndex=null,Bt._cacheIndex=Nt,st[Nt]=Bt,st.pop(),this._removeInactiveBindingsForAction(Ft)}delete gt[mt]}}uncacheRoot(nt){let st=nt.uuid,mt=this._actionsByClip;for(let Et in mt){let At=mt[Et].actionByRoot,Rt=At[st];Rt!==void 0&&(this._deactivateAction(Rt),this._removeInactiveAction(Rt))}let gt=this._bindingsByRootAndName,_t=gt[st];if(_t!==void 0)for(let Et in _t){let At=_t[Et];At.restoreOriginalState(),this._removeInactiveBinding(At)}}uncacheAction(nt,st){let mt=this.existingAction(nt,st);mt!==null&&(this._deactivateAction(mt),this._removeInactiveAction(mt))}},le$1=class{constructor(st){this.value=st}clone(){return new le$1(this.value.clone===void 0?this.value:this.value.clone())}},Qu=class{constructor(nt,st,mt=0,gt=1/0){this.ray=new Rs(nt,st),this.near=mt,this.far=gt,this.camera=null,this.layers=new lp,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(nt,st){this.ray.set(nt,st)}setFromCamera(nt,st){st.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(st.matrixWorld),this.ray.direction.set(nt.x,nt.y,.5).unproject(st).sub(this.ray.origin).normalize(),this.camera=st):st.isOrthographicCamera?(this.ray.origin.set(nt.x,nt.y,(st.near+st.far)/(st.near-st.far)).unproject(st),this.ray.direction.set(0,0,-1).transformDirection(st.matrixWorld),this.camera=st):console.error("THREE.Raycaster: Unsupported camera type: "+st.type)}intersectObject(nt,st=!0,mt=[]){return Sw(nt,this,mt,st),mt.sort(BC),mt}intersectObjects(nt,st=!0,mt=[]){for(let gt=0,_t=nt.length;gt<_t;gt++)Sw(nt[gt],this,mt,st);return mt.sort(BC),mt}};function BC(nt,st){return nt.distance-st.distance}function Sw(nt,st,mt,gt){if(nt.layers.test(st.layers)&&nt.raycast(st,mt),gt===!0){let _t=nt.children;for(let Et=0,At=_t.length;Et<At;Et++)Sw(_t[Et],st,mt,!0)}}var bp=class{constructor(nt=1,st=0,mt=0){return this.radius=nt,this.phi=st,this.theta=mt,this}set(nt,st,mt){return this.radius=nt,this.phi=st,this.theta=mt,this}copy(nt){return this.radius=nt.radius,this.phi=nt.phi,this.theta=nt.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(nt){return this.setFromCartesianCoords(nt.x,nt.y,nt.z)}setFromCartesianCoords(nt,st,mt){return this.radius=Math.sqrt(nt*nt+st*st+mt*mt),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(nt,mt),this.phi=Math.acos(di(st/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},NC=new U$1,Ku=class{constructor(nt=new U$1(1/0,1/0),st=new U$1(-1/0,-1/0)){this.isBox2=!0,this.min=nt,this.max=st}set(nt,st){return this.min.copy(nt),this.max.copy(st),this}setFromPoints(nt){this.makeEmpty();for(let st=0,mt=nt.length;st<mt;st++)this.expandByPoint(nt[st]);return this}setFromCenterAndSize(nt,st){let mt=NC.copy(st).multiplyScalar(.5);return this.min.copy(nt).sub(mt),this.max.copy(nt).add(mt),this}clone(){return new this.constructor().copy(this)}copy(nt){return this.min.copy(nt.min),this.max.copy(nt.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(nt){return this.isEmpty()?nt.set(0,0):nt.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(nt){return this.isEmpty()?nt.set(0,0):nt.subVectors(this.max,this.min)}expandByPoint(nt){return this.min.min(nt),this.max.max(nt),this}expandByVector(nt){return this.min.sub(nt),this.max.add(nt),this}expandByScalar(nt){return this.min.addScalar(-nt),this.max.addScalar(nt),this}containsPoint(nt){return!(nt.x<this.min.x||nt.x>this.max.x||nt.y<this.min.y||nt.y>this.max.y)}containsBox(nt){return this.min.x<=nt.min.x&&nt.max.x<=this.max.x&&this.min.y<=nt.min.y&&nt.max.y<=this.max.y}getParameter(nt,st){return st.set((nt.x-this.min.x)/(this.max.x-this.min.x),(nt.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(nt){return!(nt.max.x<this.min.x||nt.min.x>this.max.x||nt.max.y<this.min.y||nt.min.y>this.max.y)}clampPoint(nt,st){return st.copy(nt).clamp(this.min,this.max)}distanceToPoint(nt){return NC.copy(nt).clamp(this.min,this.max).sub(nt).length()}intersect(nt){return this.min.max(nt.min),this.max.min(nt.max),this}union(nt){return this.min.min(nt.min),this.max.max(nt.max),this}translate(nt){return this.min.add(nt),this.max.add(nt),this}equals(nt){return nt.min.equals(this.min)&&nt.max.equals(this.max)}},FC=new E$6,Hg=new E$6,Mi=class{constructor(nt=new E$6,st=new E$6){this.start=nt,this.end=st}set(nt,st){return this.start.copy(nt),this.end.copy(st),this}copy(nt){return this.start.copy(nt.start),this.end.copy(nt.end),this}getCenter(nt){return nt.addVectors(this.start,this.end).multiplyScalar(.5)}delta(nt){return nt.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(nt,st){return this.delta(st).multiplyScalar(nt).add(this.start)}closestPointToPointParameter(nt,st){FC.subVectors(nt,this.start),Hg.subVectors(this.end,this.start);let mt=Hg.dot(Hg),gt=Hg.dot(FC)/mt;return st&&(gt=di(gt,0,1)),gt}closestPointToPoint(nt,st,mt){let gt=this.closestPointToPointParameter(nt,st);return this.delta(mt).multiplyScalar(gt).add(this.start)}applyMatrix4(nt){return this.start.applyMatrix4(nt),this.end.applyMatrix4(nt),this}equals(nt){return nt.start.equals(this.start)&&nt.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},VC=new E$6,xy=class extends Mt{constructor(nt,st){super(),this.light=nt,this.matrix=nt.matrixWorld,this.matrixAutoUpdate=!1,this.color=st,this.type="SpotLightHelper";let mt=new _e$1,gt=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let Et=0,At=1,Rt=32;Et<Rt;Et++,At++){let Ft=Et/Rt*Math.PI*2,Nt=At/Rt*Math.PI*2;gt.push(Math.cos(Ft),Math.sin(Ft),1,Math.cos(Nt),Math.sin(Nt),1)}mt.setAttribute("position",new Me$1(gt,3));let _t=new ss({fog:!1,toneMapped:!1});this.cone=new el(mt,_t),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let nt=this.light.distance?this.light.distance:1e3,st=nt*Math.tan(this.light.angle);this.cone.scale.set(st,st,nt),VC.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(VC),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},by=class extends Ut{constructor(nt,st,mt){let gt=new Ls(st,4,2),_t=new on({wireframe:!0,fog:!1,toneMapped:!1});super(gt,_t),this.light=nt,this.color=mt,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},UC=new E$6,Wg=new E$6,zC=new E$6,Sy=class extends Mt{constructor(nt,st,mt){super(),this.light=nt,this.matrix=nt.matrixWorld,this.matrixAutoUpdate=!1,this.color=mt,this.type="DirectionalLightHelper",st===void 0&&(st=1);let gt=new _e$1;gt.setAttribute("position",new Me$1([-st,st,0,st,st,0,st,-st,0,-st,-st,0,-st,st,0],3));let _t=new ss({fog:!1,toneMapped:!1});this.lightPlane=new mc(gt,_t),this.add(this.lightPlane),gt=new _e$1,gt.setAttribute("position",new Me$1([0,0,0,0,0,1],3)),this.targetLine=new mc(gt,_t),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),UC.setFromMatrixPosition(this.light.matrixWorld),Wg.setFromMatrixPosition(this.light.target.matrixWorld),zC.subVectors(Wg,UC),this.lightPlane.lookAt(Wg),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Wg),this.targetLine.scale.z=zC.length()}},qg=new E$6,Wr=new qn,ol=class extends el{constructor(nt){let st=new _e$1,mt=new ss({color:16777215,vertexColors:!0,toneMapped:!1}),gt=[],_t=[],Et={};At("n1","n2"),At("n2","n4"),At("n4","n3"),At("n3","n1"),At("f1","f2"),At("f2","f4"),At("f4","f3"),At("f3","f1"),At("n1","f1"),At("n2","f2"),At("n3","f3"),At("n4","f4"),At("p","n1"),At("p","n2"),At("p","n3"),At("p","n4"),At("u1","u2"),At("u2","u3"),At("u3","u1"),At("c","t"),At("p","c"),At("cn1","cn2"),At("cn3","cn4"),At("cf1","cf2"),At("cf3","cf4");function At(Mr,Tr){Rt(Mr),Rt(Tr)}function Rt(Mr){gt.push(0,0,0),_t.push(0,0,0),Et[Mr]===void 0&&(Et[Mr]=[]),Et[Mr].push(gt.length/3-1)}st.setAttribute("position",new Me$1(gt,3)),st.setAttribute("color",new Me$1(_t,3)),super(st,mt),this.type="CameraHelper",this.camera=nt,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=nt.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=Et,this.update();let Ft=new We$1(16755200),Nt=new We$1(16711680),Bt=new We$1(43775),Gt=new We$1(16777215),dr=new We$1(3355443);this.setColors(Ft,Nt,Bt,Gt,dr)}setColors(nt,st,mt,gt,_t){let Et=this.geometry.getAttribute("color");Et.setXYZ(0,nt.r,nt.g,nt.b),Et.setXYZ(1,nt.r,nt.g,nt.b),Et.setXYZ(2,nt.r,nt.g,nt.b),Et.setXYZ(3,nt.r,nt.g,nt.b),Et.setXYZ(4,nt.r,nt.g,nt.b),Et.setXYZ(5,nt.r,nt.g,nt.b),Et.setXYZ(6,nt.r,nt.g,nt.b),Et.setXYZ(7,nt.r,nt.g,nt.b),Et.setXYZ(8,nt.r,nt.g,nt.b),Et.setXYZ(9,nt.r,nt.g,nt.b),Et.setXYZ(10,nt.r,nt.g,nt.b),Et.setXYZ(11,nt.r,nt.g,nt.b),Et.setXYZ(12,nt.r,nt.g,nt.b),Et.setXYZ(13,nt.r,nt.g,nt.b),Et.setXYZ(14,nt.r,nt.g,nt.b),Et.setXYZ(15,nt.r,nt.g,nt.b),Et.setXYZ(16,nt.r,nt.g,nt.b),Et.setXYZ(17,nt.r,nt.g,nt.b),Et.setXYZ(18,nt.r,nt.g,nt.b),Et.setXYZ(19,nt.r,nt.g,nt.b),Et.setXYZ(20,nt.r,nt.g,nt.b),Et.setXYZ(21,nt.r,nt.g,nt.b),Et.setXYZ(22,nt.r,nt.g,nt.b),Et.setXYZ(23,nt.r,nt.g,nt.b),Et.setXYZ(24,st.r,st.g,st.b),Et.setXYZ(25,st.r,st.g,st.b),Et.setXYZ(26,st.r,st.g,st.b),Et.setXYZ(27,st.r,st.g,st.b),Et.setXYZ(28,st.r,st.g,st.b),Et.setXYZ(29,st.r,st.g,st.b),Et.setXYZ(30,st.r,st.g,st.b),Et.setXYZ(31,st.r,st.g,st.b),Et.setXYZ(32,mt.r,mt.g,mt.b),Et.setXYZ(33,mt.r,mt.g,mt.b),Et.setXYZ(34,mt.r,mt.g,mt.b),Et.setXYZ(35,mt.r,mt.g,mt.b),Et.setXYZ(36,mt.r,mt.g,mt.b),Et.setXYZ(37,mt.r,mt.g,mt.b),Et.setXYZ(38,gt.r,gt.g,gt.b),Et.setXYZ(39,gt.r,gt.g,gt.b),Et.setXYZ(40,_t.r,_t.g,_t.b),Et.setXYZ(41,_t.r,_t.g,_t.b),Et.setXYZ(42,_t.r,_t.g,_t.b),Et.setXYZ(43,_t.r,_t.g,_t.b),Et.setXYZ(44,_t.r,_t.g,_t.b),Et.setXYZ(45,_t.r,_t.g,_t.b),Et.setXYZ(46,_t.r,_t.g,_t.b),Et.setXYZ(47,_t.r,_t.g,_t.b),Et.setXYZ(48,_t.r,_t.g,_t.b),Et.setXYZ(49,_t.r,_t.g,_t.b),Et.needsUpdate=!0}update(){let nt=this.geometry,st=this.pointMap,mt=1,gt=1;Wr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Jr("c",st,nt,Wr,0,0,-1),Jr("t",st,nt,Wr,0,0,1),Jr("n1",st,nt,Wr,-mt,-gt,-1),Jr("n2",st,nt,Wr,mt,-gt,-1),Jr("n3",st,nt,Wr,-mt,gt,-1),Jr("n4",st,nt,Wr,mt,gt,-1),Jr("f1",st,nt,Wr,-mt,-gt,1),Jr("f2",st,nt,Wr,mt,-gt,1),Jr("f3",st,nt,Wr,-mt,gt,1),Jr("f4",st,nt,Wr,mt,gt,1),Jr("u1",st,nt,Wr,mt*.7,gt*1.1,-1),Jr("u2",st,nt,Wr,-mt*.7,gt*1.1,-1),Jr("u3",st,nt,Wr,0,gt*2,-1),Jr("cf1",st,nt,Wr,-mt,0,1),Jr("cf2",st,nt,Wr,mt,0,1),Jr("cf3",st,nt,Wr,0,-gt,1),Jr("cf4",st,nt,Wr,0,gt,1),Jr("cn1",st,nt,Wr,-mt,0,-1),Jr("cn2",st,nt,Wr,mt,0,-1),Jr("cn3",st,nt,Wr,0,-gt,-1),Jr("cn4",st,nt,Wr,0,gt,-1),nt.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Jr(nt,st,mt,gt,_t,Et,At){qg.set(_t,Et,At).unproject(gt);let Rt=st[nt];if(Rt!==void 0){let Ft=mt.getAttribute("position");for(let Nt=0,Bt=Rt.length;Nt<Bt;Nt++)Ft.setXYZ(Rt[Nt],qg.x,qg.y,qg.z)}}var al=class extends el{constructor(nt,st=16776960){let mt=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),gt=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],_t=new _e$1;_t.setIndex(new Xe$1(mt,1)),_t.setAttribute("position",new Me$1(gt,3)),super(_t,new ss({color:st,toneMapped:!1})),this.box=nt,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(nt){let st=this.box;st.isEmpty()||(st.getCenter(this.position),st.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(nt))}dispose(){this.geometry.dispose(),this.material.dispose()}},wy=class extends el{constructor(nt=1){let st=[0,0,0,nt,0,0,0,0,0,0,nt,0,0,0,0,0,0,nt],mt=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],gt=new _e$1;gt.setAttribute("position",new Me$1(st,3)),gt.setAttribute("color",new Me$1(mt,3));let _t=new ss({vertexColors:!0,toneMapped:!1});super(gt,_t),this.type="AxesHelper"}setColors(nt,st,mt){let gt=new We$1,_t=this.geometry.attributes.color.array;return gt.set(nt),gt.toArray(_t,0),gt.toArray(_t,3),gt.set(st),gt.toArray(_t,6),gt.toArray(_t,9),gt.set(mt),gt.toArray(_t,12),gt.toArray(_t,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},sa=z4();function z4(){let nt=new ArrayBuffer(4),st=new Float32Array(nt),mt=new Uint32Array(nt),gt=new Uint32Array(512),_t=new Uint32Array(512);for(let Ft=0;Ft<256;++Ft){let Nt=Ft-127;Nt<-27?(gt[Ft]=0,gt[Ft|256]=32768,_t[Ft]=24,_t[Ft|256]=24):Nt<-14?(gt[Ft]=1024>>-Nt-14,gt[Ft|256]=1024>>-Nt-14|32768,_t[Ft]=-Nt-1,_t[Ft|256]=-Nt-1):Nt<=15?(gt[Ft]=Nt+15<<10,gt[Ft|256]=Nt+15<<10|32768,_t[Ft]=13,_t[Ft|256]=13):Nt<128?(gt[Ft]=31744,gt[Ft|256]=64512,_t[Ft]=24,_t[Ft|256]=24):(gt[Ft]=31744,gt[Ft|256]=64512,_t[Ft]=13,_t[Ft|256]=13)}let Et=new Uint32Array(2048),At=new Uint32Array(64),Rt=new Uint32Array(64);for(let Ft=1;Ft<1024;++Ft){let Nt=Ft<<13,Bt=0;for(;!(Nt&8388608);)Nt<<=1,Bt-=8388608;Nt&=-8388609,Bt+=947912704,Et[Ft]=Nt|Bt}for(let Ft=1024;Ft<2048;++Ft)Et[Ft]=939524096+(Ft-1024<<13);for(let Ft=1;Ft<31;++Ft)At[Ft]=Ft<<23;At[31]=1199570944,At[32]=2147483648;for(let Ft=33;Ft<63;++Ft)At[Ft]=2147483648+(Ft-32<<23);At[63]=3347054592;for(let Ft=1;Ft<64;++Ft)Ft!==32&&(Rt[Ft]=1024);return{floatView:st,uint32View:mt,baseTable:gt,shiftTable:_t,mantissaTable:Et,exponentTable:At,offsetTable:Rt}}function k4(nt){Math.abs(nt)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),nt=di(nt,-65504,65504),sa.floatView[0]=nt;let st=sa.uint32View[0],mt=st>>23&511;return sa.baseTable[mt]+((st&8388607)>>sa.shiftTable[mt])}function G4(nt){let st=nt>>10;return sa.uint32View[0]=sa.mantissaTable[sa.offsetTable[st]+(nt&1023)]+sa.exponentTable[st],sa.floatView[0]}var aP=Object.freeze({__proto__:null,fromHalfFloat:G4,toHalfFloat:k4});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:la}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=la);var eh=".",wp=Symbol("target"),Rw=Symbol("unsubscribe");function Ap(nt){return nt instanceof Date||nt instanceof Set||nt instanceof Map||nt instanceof WeakSet||nt instanceof WeakMap||ArrayBuffer.isView(nt)}function lP(nt){return(typeof nt=="object"?nt===null:typeof nt!="function")||nt instanceof RegExp}var Qn=Array.isArray;function wc(nt){return typeof nt=="symbol"}var j4={after:(nt,st)=>Qn(nt)?nt.slice(st.length):st===""?nt:nt.slice(st.length+1),concat:(nt,st)=>Qn(nt)?(nt=[...nt],st&&nt.push(st),nt):st&&st.toString!==void 0?(nt!==""&&(nt+=eh),wc(st)?nt+st.toString():nt+st):nt,initial:nt=>{if(Qn(nt))return nt.slice(0,-1);if(nt==="")return nt;let st=nt.lastIndexOf(eh);return st===-1?"":nt.slice(0,st)},last:nt=>{if(Qn(nt))return nt[nt.length-1]||"";if(nt==="")return nt;let st=nt.lastIndexOf(eh);return st===-1?nt:nt.slice(st+1)},walk:(nt,st)=>{if(Qn(nt))for(let mt of nt)st(mt);else if(nt!==""){let mt=0,gt=nt.indexOf(eh);if(gt===-1)st(nt);else for(;mt<nt.length;)gt===-1&&(gt=nt.length),st(nt.slice(mt,gt)),mt=gt+1,gt=nt.indexOf(eh,mt)}},get(nt,st){return this.walk(st,mt=>{nt&&(nt=nt[mt])}),nt}},gn=j4;function Lw(nt){return typeof nt=="object"&&typeof nt.next=="function"}function Bw(nt,st,mt,gt,_t){let Et=nt.next;if(st.name==="entries")nt.next=function(){let At=Et.call(this);return At.done===!1&&(At.value[0]=_t(At.value[0],st,At.value[0],gt),At.value[1]=_t(At.value[1],st,At.value[0],gt)),At};else if(st.name==="values"){let At=mt[wp].keys();nt.next=function(){let Rt=Et.call(this);return Rt.done===!1&&(Rt.value=_t(Rt.value,st,At.next().value,gt)),Rt}}else nt.next=function(){let At=Et.call(this);return At.done===!1&&(At.value=_t(At.value,st,At.value,gt)),At};return nt}function Ty(nt,st,mt){return nt.isUnsubscribed||st.ignoreSymbols&&wc(mt)||st.ignoreUnderscores&&mt.charAt(0)==="_"||"ignoreKeys"in st&&st.ignoreKeys.includes(mt)}var Ep=class{constructor(nt){this._equals=nt,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(nt){let st=this._getDescriptorCache(),mt=st.get(nt);return mt===void 0&&(mt={},st.set(nt,mt)),mt}_getOwnPropertyDescriptor(nt,st){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(nt,st);let mt=this._getProperties(nt),gt=mt[st];return gt===void 0&&(gt=Reflect.getOwnPropertyDescriptor(nt,st),mt[st]=gt),gt}getProxy(nt,st,mt,gt){if(this.isUnsubscribed)return nt;let _t=nt[gt],Et=_t||nt;this._pathCache.set(Et,st);let At=this._proxyCache.get(Et);return At===void 0&&(At=_t===void 0?new Proxy(nt,mt):nt,this._proxyCache.set(Et,At)),At}getPath(nt){return this.isUnsubscribed?void 0:this._pathCache.get(nt)}isDetached(nt,st){return!Object.is(nt,gn.get(st,this.getPath(nt)))}defineProperty(nt,st,mt){return Reflect.defineProperty(nt,st,mt)?(this.isUnsubscribed||(this._getProperties(nt)[st]=mt),!0):!1}setProperty(nt,st,mt,gt,_t){if(!this._equals(_t,mt)||!(st in nt)){let Et=this._getOwnPropertyDescriptor(nt,st);return Et!==void 0&&"set"in Et?Reflect.set(nt,st,mt,gt):Reflect.set(nt,st,mt)}return!0}deleteProperty(nt,st,mt){if(Reflect.deleteProperty(nt,st)){if(!this.isUnsubscribed){let gt=this._getDescriptorCache().get(nt);gt&&(delete gt[st],this._pathCache.delete(mt))}return!0}return!1}isSameDescriptor(nt,st,mt){let gt=this._getOwnPropertyDescriptor(st,mt);return nt!==void 0&&gt!==void 0&&Object.is(nt.value,gt.value)&&(nt.writable||!1)===(gt.writable||!1)&&(nt.enumerable||!1)===(gt.enumerable||!1)&&(nt.configurable||!1)===(gt.configurable||!1)&&nt.get===gt.get&&nt.set===gt.set}isGetInvariant(nt,st){let mt=this._getOwnPropertyDescriptor(nt,st);return mt!==void 0&&mt.configurable!==!0&&mt.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function th(nt){return toString.call(nt)==="[object Object]"}function rh(){return!0}function ll(nt,st){return nt.length!==st.length||nt.some((mt,gt)=>st[gt]!==mt)}var Cy=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),H4=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),Nw={push:rh,pop:rh,shift:rh,unshift:rh,copyWithin:ll,reverse:ll,sort:ll,splice:ll,flat:ll,fill:ll},cP=new Set([...Cy,...H4,...Object.keys(Nw)]);function ih(nt,st){if(nt.size!==st.size)return!0;for(let mt of nt)if(!st.has(mt))return!0;return!1}var Fw=["keys","values","entries"],Vw=new Set(["has","toString"]),Uw={add:ih,clear:ih,delete:ih,forEach:ih},uP=new Set([...Vw,...Object.keys(Uw),...Fw]);function nh(nt,st){if(nt.size!==st.size)return!0;let mt;for(let[gt,_t]of nt)if(mt=st.get(gt),mt!==_t||mt===void 0&&!st.has(gt))return!0;return!1}var W4=new Set([...Vw,"get"]),zw={set:nh,clear:nh,delete:nh,forEach:nh},hP=new Set([...W4,...Object.keys(zw),...Fw]),Ni=class{constructor(nt,st,mt,gt){this._path=st,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=gt,this._changes=gt?[]:null,this.clone=st===void 0?nt:this._shallowClone(nt)}static isHandledMethod(nt){return Cy.has(nt)}_shallowClone(nt){let st=nt;if(th(nt))st={...nt};else if(Qn(nt))st=[...nt];else if(nt instanceof Date)st=new Date(nt);else if(nt instanceof Set)st=new Set([...nt].map(mt=>this._shallowClone(mt)));else if(nt instanceof Map){st=new Map;for(let[mt,gt]of nt.entries())st.set(mt,this._shallowClone(gt))}return this._clonedCache.add(st),st}preferredThisArg(nt,st,mt,gt){return nt?(Qn(gt)?this._onIsChanged=Nw[st]:gt instanceof Set?this._onIsChanged=Uw[st]:gt instanceof Map&&(this._onIsChanged=zw[st]),gt):mt}update(nt,st,mt){let gt=gn.after(nt,this._path);if(st!=="length"){let _t=this.clone;gn.walk(gt,Et=>{_t&&_t[Et]&&(this._clonedCache.has(_t[Et])||(_t[Et]=this._shallowClone(_t[Et])),_t=_t[Et])}),this._hasOnValidate&&this._changes.push({path:gt,property:st,previous:mt}),_t&&_t[st]&&(_t[st]=mt)}this._isChanged=!0}undo(nt){let st;for(let mt=this._changes.length-1;mt!==-1;mt--)st=this._changes[mt],gn.get(nt,st.path)[st.property]=st.previous}isChanged(nt){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,nt)}},sh=class extends Ni{static isHandledMethod(nt){return cP.has(nt)}},Mp=class extends Ni{undo(nt){nt.setTime(this.clone.getTime())}isChanged(nt,st){return!st(this.clone.valueOf(),nt.valueOf())}},oh=class extends Ni{static isHandledMethod(nt){return uP.has(nt)}undo(nt){for(let st of this.clone)nt.add(st);for(let st of nt)this.clone.has(st)||nt.delete(st)}},ah=class extends Ni{static isHandledMethod(nt){return hP.has(nt)}undo(nt){for(let[st,mt]of this.clone.entries())nt.set(st,mt);for(let st of nt.keys())this.clone.has(st)||nt.delete(st)}},Tp=class extends Ni{constructor(nt,st,mt,gt){super(void 0,st,mt,gt),this._arg1=mt[0],this._weakValue=nt.has(this._arg1)}isChanged(nt){return this._weakValue!==nt.has(this._arg1)}undo(nt){this._weakValue&&!nt.has(this._arg1)?nt.add(this._arg1):nt.delete(this._arg1)}},Cp=class extends Ni{constructor(nt,st,mt,gt){super(void 0,st,mt,gt),this._weakKey=mt[0],this._weakHas=nt.has(this._weakKey),this._weakValue=nt.get(this._weakKey)}isChanged(nt){return this._weakValue!==nt.get(this._weakKey)}undo(nt){let st=nt.has(this._weakKey);this._weakHas&&!st?nt.set(this._weakKey,this._weakValue):!this._weakHas&&st?nt.delete(this._weakKey):this._weakValue!==nt.get(this._weakKey)&&nt.set(this._weakKey,this._weakValue)}},Ns=class{constructor(nt){this._stack=[],this._hasOnValidate=nt}static isHandledType(nt){return th(nt)||Qn(nt)||Ap(nt)}static isHandledMethod(nt,st){return th(nt)?Ni.isHandledMethod(st):Qn(nt)?sh.isHandledMethod(st):nt instanceof Set?oh.isHandledMethod(st):nt instanceof Map?ah.isHandledMethod(st):Ap(nt)}get isCloning(){return this._stack.length>0}start(nt,st,mt){let gt=Ni;Qn(nt)?gt=sh:nt instanceof Date?gt=Mp:nt instanceof Set?gt=oh:nt instanceof Map?gt=ah:nt instanceof WeakSet?gt=Tp:nt instanceof WeakMap&&(gt=Cp),this._stack.push(new gt(nt,st,mt,this._hasOnValidate))}update(nt,st,mt){this._stack[this._stack.length-1].update(nt,st,mt)}preferredThisArg(nt,st,mt){let{name:gt}=nt,_t=Ns.isHandledMethod(mt,gt);return this._stack[this._stack.length-1].preferredThisArg(_t,gt,st,mt)}isChanged(nt,st,mt){return this._stack[this._stack.length-1].isChanged(nt,st,mt)}undo(nt){this._previousClone!==void 0&&this._previousClone.undo(nt)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},q4={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},kw=(nt,st,mt={})=>{mt={...q4,...mt};let gt=Symbol("ProxyTarget"),{equals:_t,isShallow:Et,ignoreDetached:At,details:Rt}=mt,Ft=new Ep(_t),Nt=typeof mt.onValidate=="function",Bt=new Ns(Nt),Gt=(tn,rn,Tn,$n,un)=>!Nt||Bt.isCloning||mt.onValidate(gn.concat(Ft.getPath(tn),rn),Tn,$n,un)===!0,dr=(tn,rn,Tn,$n)=>{!Ty(Ft,mt,rn)&&!(At&&Ft.isDetached(tn,nt))&&Mr(Ft.getPath(tn),rn,Tn,$n)},Mr=(tn,rn,Tn,$n,un)=>{Bt.isCloning?Bt.update(tn,rn,$n):st(gn.concat(tn,rn),Tn,$n,un)},Tr=tn=>tn&&(tn[gt]||tn),zr=(tn,rn,Tn,$n)=>lP(tn)||Tn==="constructor"||Et&&!Ns.isHandledMethod(rn,Tn)||Ty(Ft,mt,Tn)||Ft.isGetInvariant(rn,Tn)||At&&Ft.isDetached(rn,nt)?tn:($n===void 0&&($n=Ft.getPath(rn)),Ft.getProxy(tn,gn.concat($n,Tn),Fr,gt)),Fr={get(tn,rn,Tn){if(wc(rn)){if(rn===gt||rn===wp)return tn;if(rn===Rw&&!Ft.isUnsubscribed&&Ft.getPath(tn).length===0)return Ft.unsubscribe(),tn}let $n=Ap(tn)?Reflect.get(tn,rn):Reflect.get(tn,rn,Tn);return zr($n,tn,rn)},set(tn,rn,Tn,$n){Tn=Tr(Tn);let un=tn[gt]||tn,es=un[rn];if(_t(es,Tn)&&rn in tn)return!0;let kn=Gt(tn,rn,Tn,es);return kn&&Ft.setProperty(un,rn,Tn,$n,es)?(dr(tn,rn,tn[rn],es),!0):!kn},defineProperty(tn,rn,Tn){if(!Ft.isSameDescriptor(Tn,tn,rn)){let $n=tn[rn];Gt(tn,rn,Tn.value,$n)&&Ft.defineProperty(tn,rn,Tn,$n)&&dr(tn,rn,Tn.value,$n)}return!0},deleteProperty(tn,rn){if(!Reflect.has(tn,rn))return!0;let Tn=Reflect.get(tn,rn),$n=Gt(tn,rn,void 0,Tn);return $n&&Ft.deleteProperty(tn,rn,Tn)?(dr(tn,rn,void 0,Tn),!0):!$n},apply(tn,rn,Tn){let $n=rn[gt]||rn;if(Ft.isUnsubscribed)return Reflect.apply(tn,$n,Tn);if((Rt===!1||Rt!==!0&&!Rt.includes(tn.name))&&Ns.isHandledType($n)){let un=gn.initial(Ft.getPath(tn)),es=Ns.isHandledMethod($n,tn.name);Bt.start($n,un,Tn);let kn=Reflect.apply(tn,Bt.preferredThisArg(tn,rn,$n),es?Tn.map(ds=>Tr(ds)):Tn),ts=Bt.isChanged($n,_t),Ko=Bt.stop();if(Ns.isHandledType(kn)&&es&&(rn instanceof Map&&tn.name==="get"&&(un=gn.concat(un,Tn[0])),kn=Ft.getProxy(kn,un,Fr)),ts){let ds={name:tn.name,args:Tn,result:kn},Il=Bt.isCloning?gn.initial(un):un,ru=Bt.isCloning?gn.last(un):"";Gt(gn.get(nt,Il),ru,$n,Ko,ds)?Mr(Il,ru,$n,Ko,ds):Bt.undo($n)}return(rn instanceof Map||rn instanceof Set)&&Lw(kn)?Bw(kn,tn,rn,un,zr):kn}return Reflect.apply(tn,rn,Tn)}},Nr=Ft.getProxy(nt,mt.pathAsArray?[]:"",Fr);return st=st.bind(Nr),Nt&&(mt.onValidate=mt.onValidate.bind(Nr)),Nr};kw.target=nt=>nt&&nt[wp]||nt;kw.unsubscribe=nt=>nt[Rw]||nt;var Gw=kw,Y4=typeof global=="object"&&global&&global.Object===Object&&global,Py=Y4,X4=typeof self=="object"&&self&&self.Object===Object&&self,Q4=Py||X4||Function("return this")(),Yr=Q4,K4=Yr.Symbol,Fi=K4,dP=Object.prototype,Z4=dP.hasOwnProperty,J4=dP.toString,Pp=Fi?Fi.toStringTag:void 0;function $4(nt){var st=Z4.call(nt,Pp),mt=nt[Pp];try{nt[Pp]=void 0;var gt=!0}catch{}var _t=J4.call(nt);return gt&&(st?nt[Pp]=mt:delete nt[Pp]),_t}var fP=$4,ej=Object.prototype,tj=ej.toString;function rj(nt){return tj.call(nt)}var pP=rj,ij="[object Null]",nj="[object Undefined]",mP=Fi?Fi.toStringTag:void 0;function sj(nt){return nt==null?nt===void 0?nj:ij:mP&&mP in Object(nt)?fP(nt):pP(nt)}var Kn=sj;function oj(nt){return nt!=null&&typeof nt=="object"}var Wi=oj,aj="[object Symbol]";function lj(nt){return typeof nt=="symbol"||Wi(nt)&&Kn(nt)==aj}var po=lj;function cj(nt,st){for(var mt=-1,gt=nt==null?0:nt.length,_t=Array(gt);++mt<gt;)_t[mt]=st(nt[mt],mt,nt);return _t}var _y=cj,uj=Array.isArray,Ti=uj,hj=1/0,gP=Fi?Fi.prototype:void 0,yP=gP?gP.toString:void 0;function vP(nt){if(typeof nt=="string")return nt;if(Ti(nt))return _y(nt,vP)+"";if(po(nt))return yP?yP.call(nt):"";var st=nt+"";return st=="0"&&1/nt==-hj?"-0":st}var xP=vP,dj=/\s/;function fj(nt){for(var st=nt.length;st--&&dj.test(nt.charAt(st)););return st}var bP=fj,pj=/^\s+/;function mj(nt){return nt&&nt.slice(0,bP(nt)+1).replace(pj,"")}var SP=mj;function gj(nt){var st=typeof nt;return nt!=null&&(st=="object"||st=="function")}var yi=gj,wP=NaN,yj=/^[-+]0x[0-9a-f]+$/i,vj=/^0b[01]+$/i,xj=/^0o[0-7]+$/i,bj=parseInt;function Sj(nt){if(typeof nt=="number")return nt;if(po(nt))return wP;if(yi(nt)){var st=typeof nt.valueOf=="function"?nt.valueOf():nt;nt=yi(st)?st+"":st}if(typeof nt!="string")return nt===0?nt:+nt;nt=SP(nt);var mt=vj.test(nt);return mt||xj.test(nt)?bj(nt.slice(2),mt?2:8):yj.test(nt)?wP:+nt}var jw=Sj;function wj(nt){return nt}var Dy=wj,Aj="[object AsyncFunction]",Ej="[object Function]",Mj="[object GeneratorFunction]",Tj="[object Proxy]";function Cj(nt){if(!yi(nt))return!1;var st=Kn(nt);return st==Ej||st==Mj||st==Aj||st==Tj}var Iy=Cj,Pj=Yr["__core-js_shared__"],Oy=Pj,AP=function(){var nt=/[^.]+$/.exec(Oy&&Oy.keys&&Oy.keys.IE_PROTO||"");return nt?"Symbol(src)_1."+nt:""}();function _j(nt){return!!AP&&AP in nt}var EP=_j,Dj=Function.prototype,Ij=Dj.toString;function Oj(nt){if(nt!=null){try{return Ij.call(nt)}catch{}try{return nt+""}catch{}}return""}var ca=Oj,Rj=/[\\^$.*+?()[\]{}|]/g,Lj=/^\[object .+?Constructor\]$/,Bj=Function.prototype,Nj=Object.prototype,Fj=Bj.toString,Vj=Nj.hasOwnProperty,Uj=RegExp("^"+Fj.call(Vj).replace(Rj,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function zj(nt){if(!yi(nt)||EP(nt))return!1;var st=Iy(nt)?Uj:Lj;return st.test(ca(nt))}var MP=zj;function kj(nt,st){return nt==null?void 0:nt[st]}var TP=kj;function Gj(nt,st){var mt=TP(nt,st);return MP(mt)?mt:void 0}var Cn=Gj,jj=Cn(Yr,"WeakMap"),Ry=jj,CP=Object.create,Hj=function(){function nt(){}return function(st){if(!yi(st))return{};if(CP)return CP(st);nt.prototype=st;var mt=new nt;return nt.prototype=void 0,mt}}(),PP=Hj;function Wj(nt,st,mt){switch(mt.length){case 0:return nt.call(st);case 1:return nt.call(st,mt[0]);case 2:return nt.call(st,mt[0],mt[1]);case 3:return nt.call(st,mt[0],mt[1],mt[2])}return nt.apply(st,mt)}var _P=Wj;function qj(nt,st){var mt=-1,gt=nt.length;for(st||(st=Array(gt));++mt<gt;)st[mt]=nt[mt];return st}var DP=qj,Yj=800,Xj=16,Qj=Date.now;function Kj(nt){var st=0,mt=0;return function(){var gt=Qj(),_t=Xj-(gt-mt);if(mt=gt,_t>0){if(++st>=Yj)return arguments[0]}else st=0;return nt.apply(void 0,arguments)}}var IP=Kj;function Zj(nt){return function(){return nt}}var OP=Zj,Jj=function(){try{var nt=Cn(Object,"defineProperty");return nt({},"",{}),nt}catch{}}(),lh=Jj,$j=lh?function(nt,st){return lh(nt,"toString",{configurable:!0,enumerable:!1,value:OP(st),writable:!0})}:Dy,RP=$j,eH=IP(RP),LP=eH;function tH(nt,st){for(var mt=-1,gt=nt==null?0:nt.length;++mt<gt&&st(nt[mt],mt,nt)!==!1;);return nt}var BP=tH,rH=9007199254740991,iH=/^(?:0|[1-9]\d*)$/;function nH(nt,st){var mt=typeof nt;return st=st??rH,!!st&&(mt=="number"||mt!="symbol"&&iH.test(nt))&&nt>-1&&nt%1==0&&nt<st}var ch=nH;function sH(nt,st,mt){st=="__proto__"&&lh?lh(nt,st,{configurable:!0,enumerable:!0,value:mt,writable:!0}):nt[st]=mt}var Ly=sH;function oH(nt,st){return nt===st||nt!==nt&&st!==st}var uh=oH,aH=Object.prototype,lH=aH.hasOwnProperty;function cH(nt,st,mt){var gt=nt[st];(!(lH.call(nt,st)&&uh(gt,mt))||mt===void 0&&!(st in nt))&&Ly(nt,st,mt)}var hh=cH;function uH(nt,st,mt,gt){var _t=!mt;mt||(mt={});for(var Et=-1,At=st.length;++Et<At;){var Rt=st[Et],Ft=gt?gt(mt[Rt],nt[Rt],Rt,mt,nt):void 0;Ft===void 0&&(Ft=nt[Rt]),_t?Ly(mt,Rt,Ft):hh(mt,Rt,Ft)}return mt}var mo$2=uH,NP=Math.max;function hH(nt,st,mt){return st=NP(st===void 0?nt.length-1:st,0),function(){for(var gt=arguments,_t=-1,Et=NP(gt.length-st,0),At=Array(Et);++_t<Et;)At[_t]=gt[st+_t];_t=-1;for(var Rt=Array(st+1);++_t<st;)Rt[_t]=gt[_t];return Rt[st]=mt(At),_P(nt,this,Rt)}}var FP=hH,dH=9007199254740991;function fH(nt){return typeof nt=="number"&&nt>-1&&nt%1==0&&nt<=dH}var dh=fH;function pH(nt){return nt!=null&&dh(nt.length)&&!Iy(nt)}var By=pH,mH=Object.prototype;function gH(nt){var st=nt&&nt.constructor,mt=typeof st=="function"&&st.prototype||mH;return nt===mt}var fh=gH;function yH(nt,st){for(var mt=-1,gt=Array(nt);++mt<nt;)gt[mt]=st(mt);return gt}var VP=yH,vH="[object Arguments]";function xH(nt){return Wi(nt)&&Kn(nt)==vH}var Hw=xH,UP=Object.prototype,bH=UP.hasOwnProperty,SH=UP.propertyIsEnumerable,wH=Hw(function(){return arguments}())?Hw:function(nt){return Wi(nt)&&bH.call(nt,"callee")&&!SH.call(nt,"callee")},ph=wH;function AH(){return!1}var zP=AH,jP=typeof exports=="object"&&exports&&!exports.nodeType&&exports,kP=jP&&typeof module=="object"&&module&&!module.nodeType&&module,EH=kP&&kP.exports===jP,GP=EH?Yr.Buffer:void 0,MH=GP?GP.isBuffer:void 0,TH=MH||zP,Ac=TH,CH="[object Arguments]",PH="[object Array]",_H="[object Boolean]",DH="[object Date]",IH="[object Error]",OH="[object Function]",RH="[object Map]",LH="[object Number]",BH="[object Object]",NH="[object RegExp]",FH="[object Set]",VH="[object String]",UH="[object WeakMap]",zH="[object ArrayBuffer]",kH="[object DataView]",GH="[object Float32Array]",jH="[object Float64Array]",HH="[object Int8Array]",WH="[object Int16Array]",qH="[object Int32Array]",YH="[object Uint8Array]",XH="[object Uint8ClampedArray]",QH="[object Uint16Array]",KH="[object Uint32Array]",Dr={};Dr[GH]=Dr[jH]=Dr[HH]=Dr[WH]=Dr[qH]=Dr[YH]=Dr[XH]=Dr[QH]=Dr[KH]=!0;Dr[CH]=Dr[PH]=Dr[zH]=Dr[_H]=Dr[kH]=Dr[DH]=Dr[IH]=Dr[OH]=Dr[RH]=Dr[LH]=Dr[BH]=Dr[NH]=Dr[FH]=Dr[VH]=Dr[UH]=!1;function ZH(nt){return Wi(nt)&&dh(nt.length)&&!!Dr[Kn(nt)]}var HP=ZH;function JH(nt){return function(st){return nt(st)}}var mh=JH,WP=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_p=WP&&typeof module=="object"&&module&&!module.nodeType&&module,$H=_p&&_p.exports===WP,Ww=$H&&Py.process,e5=function(){try{var nt=_p&&_p.require&&_p.require("util").types;return nt||Ww&&Ww.binding&&Ww.binding("util")}catch{}}(),ua=e5,qP=ua&&ua.isTypedArray,t5=qP?mh(qP):HP,Ny=t5,r5=Object.prototype,i5=r5.hasOwnProperty;function n5(nt,st){var mt=Ti(nt),gt=!mt&&ph(nt),_t=!mt&&!gt&&Ac(nt),Et=!mt&&!gt&&!_t&&Ny(nt),At=mt||gt||_t||Et,Rt=At?VP(nt.length,String):[],Ft=Rt.length;for(var Nt in nt)(st||i5.call(nt,Nt))&&!(At&&(Nt=="length"||_t&&(Nt=="offset"||Nt=="parent")||Et&&(Nt=="buffer"||Nt=="byteLength"||Nt=="byteOffset")||ch(Nt,Ft)))&&Rt.push(Nt);return Rt}var Fy=n5;function s5(nt,st){return function(mt){return nt(st(mt))}}var Vy=s5,o5=Vy(Object.keys,Object),YP=o5,a5=Object.prototype,l5=a5.hasOwnProperty;function c5(nt){if(!fh(nt))return YP(nt);var st=[];for(var mt in Object(nt))l5.call(nt,mt)&&mt!="constructor"&&st.push(mt);return st}var XP=c5;function u5(nt){return By(nt)?Fy(nt):XP(nt)}var gh=u5;function h5(nt){var st=[];if(nt!=null)for(var mt in Object(nt))st.push(mt);return st}var QP=h5,d5=Object.prototype,f5=d5.hasOwnProperty;function p5(nt){if(!yi(nt))return QP(nt);var st=fh(nt),mt=[];for(var gt in nt)gt=="constructor"&&(st||!f5.call(nt,gt))||mt.push(gt);return mt}var KP=p5;function m5(nt){return By(nt)?Fy(nt,!0):KP(nt)}var ls=m5,g5=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,y5=/^\w*$/;function v5(nt,st){if(Ti(nt))return!1;var mt=typeof nt;return mt=="number"||mt=="symbol"||mt=="boolean"||nt==null||po(nt)?!0:y5.test(nt)||!g5.test(nt)||st!=null&&nt in Object(st)}var ZP=v5,x5=Cn(Object,"create"),ha=x5;function b5(){this.__data__=ha?ha(null):{},this.size=0}var JP=b5;function S5(nt){var st=this.has(nt)&&delete this.__data__[nt];return this.size-=st?1:0,st}var $P=S5,w5="__lodash_hash_undefined__",A5=Object.prototype,E5=A5.hasOwnProperty;function M5(nt){var st=this.__data__;if(ha){var mt=st[nt];return mt===w5?void 0:mt}return E5.call(st,nt)?st[nt]:void 0}var e_=M5,T5=Object.prototype,C5=T5.hasOwnProperty;function P5(nt){var st=this.__data__;return ha?st[nt]!==void 0:C5.call(st,nt)}var t_=P5,_5="__lodash_hash_undefined__";function D5(nt,st){var mt=this.__data__;return this.size+=this.has(nt)?0:1,mt[nt]=ha&&st===void 0?_5:st,this}var r_=D5;function yh(nt){var st=-1,mt=nt==null?0:nt.length;for(this.clear();++st<mt;){var gt=nt[st];this.set(gt[0],gt[1])}}yh.prototype.clear=JP;yh.prototype.delete=$P;yh.prototype.get=e_;yh.prototype.has=t_;yh.prototype.set=r_;var qw=yh;function I5(){this.__data__=[],this.size=0}var i_=I5;function O5(nt,st){for(var mt=nt.length;mt--;)if(uh(nt[mt][0],st))return mt;return-1}var cl=O5,R5=Array.prototype,L5=R5.splice;function B5(nt){var st=this.__data__,mt=cl(st,nt);if(mt<0)return!1;var gt=st.length-1;return mt==gt?st.pop():L5.call(st,mt,1),--this.size,!0}var n_=B5;function N5(nt){var st=this.__data__,mt=cl(st,nt);return mt<0?void 0:st[mt][1]}var s_=N5;function F5(nt){return cl(this.__data__,nt)>-1}var o_=F5;function V5(nt,st){var mt=this.__data__,gt=cl(mt,nt);return gt<0?(++this.size,mt.push([nt,st])):mt[gt][1]=st,this}var a_=V5;function vh(nt){var st=-1,mt=nt==null?0:nt.length;for(this.clear();++st<mt;){var gt=nt[st];this.set(gt[0],gt[1])}}vh.prototype.clear=i_;vh.prototype.delete=n_;vh.prototype.get=s_;vh.prototype.has=o_;vh.prototype.set=a_;var ul=vh,U5=Cn(Yr,"Map"),hl=U5;function z5(){this.size=0,this.__data__={hash:new qw,map:new(hl||ul),string:new qw}}var l_=z5;function k5(nt){var st=typeof nt;return st=="string"||st=="number"||st=="symbol"||st=="boolean"?nt!=="__proto__":nt===null}var c_=k5;function G5(nt,st){var mt=nt.__data__;return c_(st)?mt[typeof st=="string"?"string":"hash"]:mt.map}var dl=G5;function j5(nt){var st=dl(this,nt).delete(nt);return this.size-=st?1:0,st}var u_=j5;function H5(nt){return dl(this,nt).get(nt)}var h_=H5;function W5(nt){return dl(this,nt).has(nt)}var d_=W5;function q5(nt,st){var mt=dl(this,nt),gt=mt.size;return mt.set(nt,st),this.size+=mt.size==gt?0:1,this}var f_=q5;function xh(nt){var st=-1,mt=nt==null?0:nt.length;for(this.clear();++st<mt;){var gt=nt[st];this.set(gt[0],gt[1])}}xh.prototype.clear=l_;xh.prototype.delete=u_;xh.prototype.get=h_;xh.prototype.has=d_;xh.prototype.set=f_;var Ec=xh,Y5="Expected a function";function Yw(nt,st){if(typeof nt!="function"||st!=null&&typeof st!="function")throw new TypeError(Y5);var mt=function(){var gt=arguments,_t=st?st.apply(this,gt):gt[0],Et=mt.cache;if(Et.has(_t))return Et.get(_t);var At=nt.apply(this,gt);return mt.cache=Et.set(_t,At)||Et,At};return mt.cache=new(Yw.Cache||Ec),mt}Yw.Cache=Ec;var p_=Yw,X5=500;function Q5(nt){var st=p_(nt,function(gt){return mt.size===X5&&mt.clear(),gt}),mt=st.cache;return st}var m_=Q5,K5=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Z5=/\\(\\)?/g,J5=m_(function(nt){var st=[];return nt.charCodeAt(0)===46&&st.push(""),nt.replace(K5,function(mt,gt,_t,Et){st.push(_t?Et.replace(Z5,"$1"):gt||mt)}),st}),g_=J5;function $5(nt){return nt==null?"":xP(nt)}var y_=$5;function eW(nt,st){return Ti(nt)?nt:ZP(nt,st)?[nt]:g_(y_(nt))}var cs=eW,tW=1/0;function rW(nt){if(typeof nt=="string"||po(nt))return nt;var st=nt+"";return st=="0"&&1/nt==-tW?"-0":st}var fl=rW;function iW(nt,st){st=cs(st,nt);for(var mt=0,gt=st.length;nt!=null&&mt<gt;)nt=nt[fl(st[mt++])];return mt&&mt==gt?nt:void 0}var Uy=iW;function nW(nt,st){for(var mt=-1,gt=st.length,_t=nt.length;++mt<gt;)nt[_t+mt]=st[mt];return nt}var bh=nW,v_=Fi?Fi.isConcatSpreadable:void 0;function sW(nt){return Ti(nt)||ph(nt)||!!(v_&&nt&&nt[v_])}var x_=sW;function b_(nt,st,mt,gt,_t){var Et=-1,At=nt.length;for(mt||(mt=x_),_t||(_t=[]);++Et<At;){var Rt=nt[Et];st>0&&mt(Rt)?st>1?b_(Rt,st-1,mt,gt,_t):bh(_t,Rt):gt||(_t[_t.length]=Rt)}return _t}var S_=b_;function oW(nt){var st=nt==null?0:nt.length;return st?S_(nt,1):[]}var w_=oW;function aW(nt){return LP(FP(nt,void 0,w_),nt+"")}var zy=aW,lW=Vy(Object.getPrototypeOf,Object),Sh=lW,cW="[object Object]",uW=Function.prototype,hW=Object.prototype,A_=uW.toString,dW=hW.hasOwnProperty,fW=A_.call(Object);function pW(nt){if(!Wi(nt)||Kn(nt)!=cW)return!1;var st=Sh(nt);if(st===null)return!0;var mt=dW.call(st,"constructor")&&st.constructor;return typeof mt=="function"&&mt instanceof mt&&A_.call(mt)==fW}var E_=pW;function mW(nt,st,mt){var gt=-1,_t=nt.length;st<0&&(st=-st>_t?0:_t+st),mt=mt>_t?_t:mt,mt<0&&(mt+=_t),_t=st>mt?0:mt-st>>>0,st>>>=0;for(var Et=Array(_t);++gt<_t;)Et[gt]=nt[gt+st];return Et}var M_=mW;function gW(){this.__data__=new ul,this.size=0}var T_=gW;function yW(nt){var st=this.__data__,mt=st.delete(nt);return this.size=st.size,mt}var C_=yW;function vW(nt){return this.__data__.get(nt)}var P_=vW;function xW(nt){return this.__data__.has(nt)}var __=xW,bW=200;function SW(nt,st){var mt=this.__data__;if(mt instanceof ul){var gt=mt.__data__;if(!hl||gt.length<bW-1)return gt.push([nt,st]),this.size=++mt.size,this;mt=this.__data__=new Ec(gt)}return mt.set(nt,st),this.size=mt.size,this}var D_=SW;function wh(nt){var st=this.__data__=new ul(nt);this.size=st.size}wh.prototype.clear=T_;wh.prototype.delete=C_;wh.prototype.get=P_;wh.prototype.has=__;wh.prototype.set=D_;var Ah=wh;function wW(nt,st){return nt&&mo$2(st,gh(st),nt)}var I_=wW;function AW(nt,st){return nt&&mo$2(st,ls(st),nt)}var O_=AW,N_=typeof exports=="object"&&exports&&!exports.nodeType&&exports,R_=N_&&typeof module=="object"&&module&&!module.nodeType&&module,EW=R_&&R_.exports===N_,L_=EW?Yr.Buffer:void 0,B_=L_?L_.allocUnsafe:void 0;function MW(nt,st){if(st)return nt.slice();var mt=nt.length,gt=B_?B_(mt):new nt.constructor(mt);return nt.copy(gt),gt}var F_=MW;function TW(nt,st){for(var mt=-1,gt=nt==null?0:nt.length,_t=0,Et=[];++mt<gt;){var At=nt[mt];st(At,mt,nt)&&(Et[_t++]=At)}return Et}var V_=TW;function CW(){return[]}var ky=CW,PW=Object.prototype,_W=PW.propertyIsEnumerable,U_=Object.getOwnPropertySymbols,DW=U_?function(nt){return nt==null?[]:(nt=Object(nt),V_(U_(nt),function(st){return _W.call(nt,st)}))}:ky,Eh=DW;function IW(nt,st){return mo$2(nt,Eh(nt),st)}var z_=IW,OW=Object.getOwnPropertySymbols,RW=OW?function(nt){for(var st=[];nt;)bh(st,Eh(nt)),nt=Sh(nt);return st}:ky,Gy=RW;function LW(nt,st){return mo$2(nt,Gy(nt),st)}var k_=LW;function BW(nt,st,mt){var gt=st(nt);return Ti(nt)?gt:bh(gt,mt(nt))}var jy=BW;function NW(nt){return jy(nt,gh,Eh)}var Dp=NW;function FW(nt){return jy(nt,ls,Gy)}var Hy=FW,VW=Cn(Yr,"DataView"),Wy=VW,UW=Cn(Yr,"Promise"),qy=UW,zW=Cn(Yr,"Set"),Yy=zW,G_="[object Map]",kW="[object Object]",j_="[object Promise]",H_="[object Set]",W_="[object WeakMap]",q_="[object DataView]",GW=ca(Wy),jW=ca(hl),HW=ca(qy),WW=ca(Yy),qW=ca(Ry),Mc=Kn;(Wy&&Mc(new Wy(new ArrayBuffer(1)))!=q_||hl&&Mc(new hl)!=G_||qy&&Mc(qy.resolve())!=j_||Yy&&Mc(new Yy)!=H_||Ry&&Mc(new Ry)!=W_)&&(Mc=function(nt){var st=Kn(nt),mt=st==kW?nt.constructor:void 0,gt=mt?ca(mt):"";if(gt)switch(gt){case GW:return q_;case jW:return G_;case HW:return j_;case WW:return H_;case qW:return W_}return st});var da=Mc,YW=Object.prototype,XW=YW.hasOwnProperty;function QW(nt){var st=nt.length,mt=new nt.constructor(st);return st&&typeof nt[0]=="string"&&XW.call(nt,"index")&&(mt.index=nt.index,mt.input=nt.input),mt}var Y_=QW,KW=Yr.Uint8Array,Mh=KW;function ZW(nt){var st=new nt.constructor(nt.byteLength);return new Mh(st).set(new Mh(nt)),st}var Th=ZW;function JW(nt,st){var mt=st?Th(nt.buffer):nt.buffer;return new nt.constructor(mt,nt.byteOffset,nt.byteLength)}var X_=JW,$W=/\w*$/;function e6(nt){var st=new nt.constructor(nt.source,$W.exec(nt));return st.lastIndex=nt.lastIndex,st}var Q_=e6,K_=Fi?Fi.prototype:void 0,Z_=K_?K_.valueOf:void 0;function t6(nt){return Z_?Object(Z_.call(nt)):{}}var J_=t6;function r6(nt,st){var mt=st?Th(nt.buffer):nt.buffer;return new nt.constructor(mt,nt.byteOffset,nt.length)}var $_=r6,i6="[object Boolean]",n6="[object Date]",s6="[object Map]",o6="[object Number]",a6="[object RegExp]",l6="[object Set]",c6="[object String]",u6="[object Symbol]",h6="[object ArrayBuffer]",d6="[object DataView]",f6="[object Float32Array]",p6="[object Float64Array]",m6="[object Int8Array]",g6="[object Int16Array]",y6="[object Int32Array]",v6="[object Uint8Array]",x6="[object Uint8ClampedArray]",b6="[object Uint16Array]",S6="[object Uint32Array]";function w6(nt,st,mt){var gt=nt.constructor;switch(st){case h6:return Th(nt);case i6:case n6:return new gt(+nt);case d6:return X_(nt,mt);case f6:case p6:case m6:case g6:case y6:case v6:case x6:case b6:case S6:return $_(nt,mt);case s6:return new gt;case o6:case c6:return new gt(nt);case a6:return Q_(nt);case l6:return new gt;case u6:return J_(nt)}}var e2=w6;function A6(nt){return typeof nt.constructor=="function"&&!fh(nt)?PP(Sh(nt)):{}}var t2=A6,E6="[object Map]";function M6(nt){return Wi(nt)&&da(nt)==E6}var r2=M6,i2=ua&&ua.isMap,T6=i2?mh(i2):r2,n2=T6,C6="[object Set]";function P6(nt){return Wi(nt)&&da(nt)==C6}var s2=P6,o2=ua&&ua.isSet,_6=o2?mh(o2):s2,a2=_6,D6=1,I6=2,O6=4,l2="[object Arguments]",R6="[object Array]",L6="[object Boolean]",B6="[object Date]",N6="[object Error]",c2="[object Function]",F6="[object GeneratorFunction]",V6="[object Map]",U6="[object Number]",u2="[object Object]",z6="[object RegExp]",k6="[object Set]",G6="[object String]",j6="[object Symbol]",H6="[object WeakMap]",W6="[object ArrayBuffer]",q6="[object DataView]",Y6="[object Float32Array]",X6="[object Float64Array]",Q6="[object Int8Array]",K6="[object Int16Array]",Z6="[object Int32Array]",J6="[object Uint8Array]",$6="[object Uint8ClampedArray]",e8="[object Uint16Array]",t8="[object Uint32Array]",Pr={};Pr[l2]=Pr[R6]=Pr[W6]=Pr[q6]=Pr[L6]=Pr[B6]=Pr[Y6]=Pr[X6]=Pr[Q6]=Pr[K6]=Pr[Z6]=Pr[V6]=Pr[U6]=Pr[u2]=Pr[z6]=Pr[k6]=Pr[G6]=Pr[j6]=Pr[J6]=Pr[$6]=Pr[e8]=Pr[t8]=!0;Pr[N6]=Pr[c2]=Pr[H6]=!1;function Xy(nt,st,mt,gt,_t,Et){var At,Rt=st&D6,Ft=st&I6,Nt=st&O6;if(mt&&(At=_t?mt(nt,gt,_t,Et):mt(nt)),At!==void 0)return At;if(!yi(nt))return nt;var Bt=Ti(nt);if(Bt){if(At=Y_(nt),!Rt)return DP(nt,At)}else{var Gt=da(nt),dr=Gt==c2||Gt==F6;if(Ac(nt))return F_(nt,Rt);if(Gt==u2||Gt==l2||dr&&!_t){if(At=Ft||dr?{}:t2(nt),!Rt)return Ft?k_(nt,O_(At,nt)):z_(nt,I_(At,nt))}else{if(!Pr[Gt])return _t?nt:{};At=e2(nt,Gt,Rt)}}Et||(Et=new Ah);var Mr=Et.get(nt);if(Mr)return Mr;Et.set(nt,At),a2(nt)?nt.forEach(function(Fr){At.add(Xy(Fr,st,mt,Fr,nt,Et))}):n2(nt)&&nt.forEach(function(Fr,Nr){At.set(Nr,Xy(Fr,st,mt,Nr,nt,Et))});var Tr=Nt?Ft?Hy:Dp:Ft?ls:gh,zr=Bt?void 0:Tr(nt);return BP(zr||nt,function(Fr,Nr){zr&&(Nr=Fr,Fr=nt[Nr]),hh(At,Nr,Xy(Fr,st,mt,Nr,nt,Et))}),At}var Qy=Xy,r8=1,i8=4;function n8(nt){return Qy(nt,r8|i8)}var fa=n8,s8="__lodash_hash_undefined__";function o8(nt){return this.__data__.set(nt,s8),this}var h2=o8;function a8(nt){return this.__data__.has(nt)}var d2=a8;function Ky(nt){var st=-1,mt=nt==null?0:nt.length;for(this.__data__=new Ec;++st<mt;)this.add(nt[st])}Ky.prototype.add=Ky.prototype.push=h2;Ky.prototype.has=d2;var f2=Ky;function l8(nt,st){for(var mt=-1,gt=nt==null?0:nt.length;++mt<gt;)if(st(nt[mt],mt,nt))return!0;return!1}var p2=l8;function c8(nt,st){return nt.has(st)}var m2=c8,u8=1,h8=2;function d8(nt,st,mt,gt,_t,Et){var At=mt&u8,Rt=nt.length,Ft=st.length;if(Rt!=Ft&&!(At&&Ft>Rt))return!1;var Nt=Et.get(nt),Bt=Et.get(st);if(Nt&&Bt)return Nt==st&&Bt==nt;var Gt=-1,dr=!0,Mr=mt&h8?new f2:void 0;for(Et.set(nt,st),Et.set(st,nt);++Gt<Rt;){var Tr=nt[Gt],zr=st[Gt];if(gt)var Fr=At?gt(zr,Tr,Gt,st,nt,Et):gt(Tr,zr,Gt,nt,st,Et);if(Fr!==void 0){if(Fr)continue;dr=!1;break}if(Mr){if(!p2(st,function(Nr,tn){if(!m2(Mr,tn)&&(Tr===Nr||_t(Tr,Nr,mt,gt,Et)))return Mr.push(tn)})){dr=!1;break}}else if(!(Tr===zr||_t(Tr,zr,mt,gt,Et))){dr=!1;break}}return Et.delete(nt),Et.delete(st),dr}var Zy=d8;function f8(nt){var st=-1,mt=Array(nt.size);return nt.forEach(function(gt,_t){mt[++st]=[_t,gt]}),mt}var g2=f8;function p8(nt){var st=-1,mt=Array(nt.size);return nt.forEach(function(gt){mt[++st]=gt}),mt}var y2=p8,m8=1,g8=2,y8="[object Boolean]",v8="[object Date]",x8="[object Error]",b8="[object Map]",S8="[object Number]",w8="[object RegExp]",A8="[object Set]",E8="[object String]",M8="[object Symbol]",T8="[object ArrayBuffer]",C8="[object DataView]",v2=Fi?Fi.prototype:void 0,Xw=v2?v2.valueOf:void 0;function P8(nt,st,mt,gt,_t,Et,At){switch(mt){case C8:if(nt.byteLength!=st.byteLength||nt.byteOffset!=st.byteOffset)return!1;nt=nt.buffer,st=st.buffer;case T8:return!(nt.byteLength!=st.byteLength||!Et(new Mh(nt),new Mh(st)));case y8:case v8:case S8:return uh(+nt,+st);case x8:return nt.name==st.name&&nt.message==st.message;case w8:case E8:return nt==st+"";case b8:var Rt=g2;case A8:var Ft=gt&m8;if(Rt||(Rt=y2),nt.size!=st.size&&!Ft)return!1;var Nt=At.get(nt);if(Nt)return Nt==st;gt|=g8,At.set(nt,st);var Bt=Zy(Rt(nt),Rt(st),gt,_t,Et,At);return At.delete(nt),Bt;case M8:if(Xw)return Xw.call(nt)==Xw.call(st)}return!1}var x2=P8,_8=1,D8=Object.prototype,I8=D8.hasOwnProperty;function O8(nt,st,mt,gt,_t,Et){var At=mt&_8,Rt=Dp(nt),Ft=Rt.length,Nt=Dp(st),Bt=Nt.length;if(Ft!=Bt&&!At)return!1;for(var Gt=Ft;Gt--;){var dr=Rt[Gt];if(!(At?dr in st:I8.call(st,dr)))return!1}var Mr=Et.get(nt),Tr=Et.get(st);if(Mr&&Tr)return Mr==st&&Tr==nt;var zr=!0;Et.set(nt,st),Et.set(st,nt);for(var Fr=At;++Gt<Ft;){dr=Rt[Gt];var Nr=nt[dr],tn=st[dr];if(gt)var rn=At?gt(tn,Nr,dr,st,nt,Et):gt(Nr,tn,dr,nt,st,Et);if(!(rn===void 0?Nr===tn||_t(Nr,tn,mt,gt,Et):rn)){zr=!1;break}Fr||(Fr=dr=="constructor")}if(zr&&!Fr){var Tn=nt.constructor,$n=st.constructor;Tn!=$n&&"constructor"in nt&&"constructor"in st&&!(typeof Tn=="function"&&Tn instanceof Tn&&typeof $n=="function"&&$n instanceof $n)&&(zr=!1)}return Et.delete(nt),Et.delete(st),zr}var b2=O8,R8=1,S2="[object Arguments]",w2="[object Array]",Jy="[object Object]",L8=Object.prototype,A2=L8.hasOwnProperty;function B8(nt,st,mt,gt,_t,Et){var At=Ti(nt),Rt=Ti(st),Ft=At?w2:da(nt),Nt=Rt?w2:da(st);Ft=Ft==S2?Jy:Ft,Nt=Nt==S2?Jy:Nt;var Bt=Ft==Jy,Gt=Nt==Jy,dr=Ft==Nt;if(dr&&Ac(nt)){if(!Ac(st))return!1;At=!0,Bt=!1}if(dr&&!Bt)return Et||(Et=new Ah),At||Ny(nt)?Zy(nt,st,mt,gt,_t,Et):x2(nt,st,Ft,mt,gt,_t,Et);if(!(mt&R8)){var Mr=Bt&&A2.call(nt,"__wrapped__"),Tr=Gt&&A2.call(st,"__wrapped__");if(Mr||Tr){var zr=Mr?nt.value():nt,Fr=Tr?st.value():st;return Et||(Et=new Ah),_t(zr,Fr,mt,gt,Et)}}return dr?(Et||(Et=new Ah),b2(nt,st,mt,gt,_t,Et)):!1}var E2=B8;function M2(nt,st,mt,gt,_t){return nt===st?!0:nt==null||st==null||!Wi(nt)&&!Wi(st)?nt!==nt&&st!==st:E2(nt,st,mt,gt,M2,_t)}var T2=M2;function N8(nt,st){return nt!=null&&st in Object(nt)}var C2=N8;function F8(nt,st,mt){st=cs(st,nt);for(var gt=-1,_t=st.length,Et=!1;++gt<_t;){var At=fl(st[gt]);if(!(Et=nt!=null&&mt(nt,At)))break;nt=nt[At]}return Et||++gt!=_t?Et:(_t=nt==null?0:nt.length,!!_t&&dh(_t)&&ch(At,_t)&&(Ti(nt)||ph(nt)))}var P2=F8;function V8(nt,st){return nt!=null&&P2(nt,st,C2)}var _2=V8,U8=function(){return Yr.Date.now()},$y=U8,z8="Expected a function",k8=Math.max,G8=Math.min;function j8(nt,st,mt){var gt,_t,Et,At,Rt,Ft,Nt=0,Bt=!1,Gt=!1,dr=!0;if(typeof nt!="function")throw new TypeError(z8);st=jw(st)||0,yi(mt)&&(Bt=!!mt.leading,Gt="maxWait"in mt,Et=Gt?k8(jw(mt.maxWait)||0,st):Et,dr="trailing"in mt?!!mt.trailing:dr);function Mr(un){var es=gt,kn=_t;return gt=_t=void 0,Nt=un,At=nt.apply(kn,es),At}function Tr(un){return Nt=un,Rt=setTimeout(Nr,st),Bt?Mr(un):At}function zr(un){var es=un-Ft,kn=un-Nt,ts=st-es;return Gt?G8(ts,Et-kn):ts}function Fr(un){var es=un-Ft,kn=un-Nt;return Ft===void 0||es>=st||es<0||Gt&&kn>=Et}function Nr(){var un=$y();if(Fr(un))return tn(un);Rt=setTimeout(Nr,zr(un))}function tn(un){return Rt=void 0,dr&&gt?Mr(un):(gt=_t=void 0,At)}function rn(){Rt!==void 0&&clearTimeout(Rt),Nt=0,gt=Ft=_t=Rt=void 0}function Tn(){return Rt===void 0?At:tn($y())}function $n(){var un=$y(),es=Fr(un);if(gt=arguments,_t=this,Ft=un,es){if(Rt===void 0)return Tr(Ft);if(Gt)return clearTimeout(Rt),Rt=setTimeout(Nr,st),Mr(Ft)}return Rt===void 0&&(Rt=setTimeout(Nr,st)),At}return $n.cancel=rn,$n.flush=Tn,$n}var Tc=j8;function H8(nt){var st=nt==null?0:nt.length;return st?nt[st-1]:void 0}var D2=H8;function W8(nt,st){return nt>st}var I2=W8;function q8(nt,st){return st.length<2?nt:Uy(nt,M_(st,0,-1))}var O2=q8;function Y8(nt,st){return T2(nt,st)}var Cc=Y8;function X8(nt,st,mt){for(var gt=-1,_t=nt.length;++gt<_t;){var Et=nt[gt],At=st(Et);if(At!=null&&(Rt===void 0?At===At&&!po(At):mt(At,Rt)))var Rt=At,Ft=Et}return Ft}var R2=X8;function Q8(nt){return nt&&nt.length?R2(nt,Dy,I2):void 0}var Qw=Q8;function K8(nt,st){return st=cs(st,nt),nt=O2(nt,st),nt==null||delete nt[fl(D2(st))]}var L2=K8;function Z8(nt){return E_(nt)?void 0:nt}var B2=Z8,J8=1,$8=2,eq=4,tq=zy(function(nt,st){var mt={};if(nt==null)return mt;var gt=!1;st=_y(st,function(Et){return Et=cs(Et,nt),gt||(gt=Et.length>1),Et}),mo$2(nt,Hy(nt),mt),gt&&(mt=Qy(mt,J8|$8|eq,B2));for(var _t=st.length;_t--;)L2(mt,st[_t]);return mt}),Ch=tq;function rq(nt,st,mt,gt){if(!yi(nt))return nt;st=cs(st,nt);for(var _t=-1,Et=st.length,At=Et-1,Rt=nt;Rt!=null&&++_t<Et;){var Ft=fl(st[_t]),Nt=mt;if(Ft==="__proto__"||Ft==="constructor"||Ft==="prototype")return nt;if(_t!=At){var Bt=Rt[Ft];Nt=gt?gt(Bt,Ft,Rt):void 0,Nt===void 0&&(Nt=yi(Bt)?Bt:ch(st[_t+1])?[]:{})}hh(Rt,Ft,Nt),Rt=Rt[Ft]}return nt}var N2=rq;function iq(nt,st,mt){for(var gt=-1,_t=st.length,Et={};++gt<_t;){var At=st[gt],Rt=Uy(nt,At);mt(Rt,At)&&N2(Et,cs(At,nt),Rt)}return Et}var F2=iq;function nq(nt,st){return F2(nt,st,function(mt,gt){return _2(nt,gt)})}var V2=nq,sq=zy(function(nt,st){return nt==null?{}:V2(nt,st)}),Pn=sq,oq="Expected a function";function aq(nt,st,mt){var gt=!0,_t=!0;if(typeof nt!="function")throw new TypeError(oq);return yi(mt)&&(gt="leading"in mt?!!mt.leading:gt,_t="trailing"in mt?!!mt.trailing:_t),Tc(nt,st,{leading:gt,maxWait:st,trailing:_t})}var Kw=aq;function ev(nt){for(let st of Object.keys(nt))nt[st]===void 0&&delete nt[st];return nt}function qi(nt,st){return Object.setPrototypeOf(nt,st),nt}var lq=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),cq=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),uq=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||Ph&&"ontouchend"in document,hq=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,dq=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,fq=()=>{if(typeof window>"u")return!1;let nt=navigator.userAgent,st=navigator.vendor;return/Safari/i.test(nt)&&/Apple Computer/.test(st)},pq=()=>{if(typeof window>"u")return null;let nt=navigator.userAgent.match(/Version\/(\d+\.\d)/);return nt&&nt[1]},mq=()=>{if(typeof window>"u")return;let nt=new URLSearchParams(window.location.search).get("desktop-app-version");return nt?(window.localStorage.setItem("desktop-app-version",nt),nt):window.localStorage.getItem("desktop-app-version")??"0.0.6"},Zw=lq();Zw&&mq();var Ph=cq(),go=uq(),U2=hq(),Ci=dq(),Jw=fq(),z2=Number(pq());function tv(nt){return Array.isArray(nt)?nt:[nt]}function rv(nt,st){let mt=0;for(;mt<nt.length&&mt<st.length;){if(nt[mt]<st[mt])return-1;if(nt[mt]>st[mt])return 1;mt+=1}return mt!==st.length?-1:mt!==nt.length?1:0}function Ip(nt){return Ph?nt.metaKey:nt.ctrlKey}function k2(nt){return nt.wheelDeltaY===0||nt.deltaY===0?Ph&&nt.shiftKey&&Math.abs(nt.wheelDeltaX)>=120?!1:nt.wheelDeltaX?nt.wheelDeltaX===-3*nt.deltaX||nt.wheelDeltaX===-3*window.devicePixelRatio*nt.deltaX:nt.deltaMode===0:nt.wheelDeltaY?nt.wheelDeltaY===-3*nt.deltaY||nt.wheelDeltaY===-3*window.devicePixelRatio*nt.deltaY:nt.deltaMode===0}var Je$1=[],nv={},Op={},iv={};function G2(nt){Je$1.includes(nt)||Je$1.push(nt)}function _h(nt){delete nv[nt.pointerId];for(let st=0;st<Je$1.length;st++)if(Je$1[st].pointerId===nt.pointerId){Je$1.splice(st,1);break}}function j2(){Je$1.splice(0,Je$1.length)}function sv(nt){if(nt.pointerType!=="touch")return;let st=nv[nt.pointerId];st===void 0&&(st={x:0,y:0},nv[nt.pointerId]=st),st.x=nt.pageX,st.y=nt.pageY}function ov(nt){let st=nt.pointerId===Je$1[0].pointerId?Je$1[1]:Je$1[0];return nv[st.pointerId]}function H2(nt){Op[nt.key]=!0,iv[nt.key]=iv[nt.key]===void 0?1:iv[nt.key]+1}function W2(nt){if(Ph&&Op.Meta)for(let st in Op)Op[st]=!1;else Op[nt.key]=!1;iv={}}function q2(nt){nt.addEventListener("pointerdown",G2,!0),nt.addEventListener("pointerdown",sv,!0),nt.addEventListener("pointermove",sv,!0),nt.addEventListener("pointerup",_h,!0),nt.addEventListener("pointercancel",_h,!0),nt.addEventListener("pointerleave",_h,!0),window.addEventListener("keydown",H2,!0),window.addEventListener("keyup",W2,!0)}function Y2(nt){nt.removeEventListener("pointerdown",G2,!0),nt.removeEventListener("pointerdown",sv,!0),nt.removeEventListener("pointermove",sv,!0),nt.removeEventListener("pointerup",_h,!0),nt.removeEventListener("pointercancel",_h,!0),nt.removeEventListener("pointerleave",_h,!0),window.removeEventListener("keydown",H2,!0),window.removeEventListener("keyup",W2,!0)}var X2,Q2=new Promise(nt=>{X2=nt}),av;function K2(){if(av)return av;async function nt(){let st="https://unpkg.com/@splinetool/navmesh-wasm@1.9.30/build",mt=__vitePreload(()=>import("./navmesh-BFd9Mv4x.js"),[]),[gt,_t]=await Promise.all([mt,fetch(`${st}/navmesh.wasm`).then(Rt=>Rt.arrayBuffer())]),Et=gt.default,At=await Et({wasmBinary:_t});X2(At)}return av=nt(),av}var Z2,J2=new Promise(nt=>{Z2=nt}),lv;function $2(){if(lv)return lv;async function nt(){let st=await __vitePreload(()=>import("./physics-BM4kW-A5.js"),[]);await st.init(),Z2(st)}return lv=nt(),lv}var Ke$1=class{modifyById(st,mt){let gt=this;if(gt[st]===void 0)throw new Error("not expected");{let _t={...gt,[st]:mt};return Object.setPrototypeOf(_t,Ke$1.prototype),_t}}add(st,mt){var gt;return((gt=this.runOp({type:1,id:st,data:mt}))==null?void 0:gt.data)??this}runOp(st){let mt=this;if(st.type===1){let gt=mt[st.id],_t;gt===void 0?_t={type:2,id:st.id}:_t={type:1,id:st.id,data:gt};let{id:Et,data:At}=st,Rt={...mt,[Et]:At};return Object.setPrototypeOf(Rt,Ke$1.prototype),{data:Rt,actual:st,reverse:_t}}else if(st.type===2){let{id:gt}=st,_t=mt[gt];if(_t===void 0)return null;{let Et={...mt};return Object.setPrototypeOf(Et,Ke$1.prototype),delete Et[gt],{data:Et,actual:st,reverse:{type:1,id:gt,data:_t}}}}return null}};function Rp(nt){if(nt.deepFreeze!==void 0){nt.deepFreeze(nt);return}let st=Object.getOwnPropertyNames(nt);for(let mt of st){let gt=nt[mt];gt&&typeof gt=="object"&&Rp(gt)}return Object.freeze(nt)}function eD(nt,st){let mt=0;for(;mt<nt.length&&mt<st.length;){if(nt[mt]<st[mt])return-1;if(nt[mt]>st[mt])return 1;mt+=1}return mt!==st.length?-1:mt!==nt.length?1:0}var Dh=class extends Error{};function cv(nt){let st={...nt};return Object.setPrototypeOf(st,Object.getPrototypeOf(nt)),st}function yo$1(nt,st,mt){if(nt===void 0?st===void 0?(nt=0,st=10):nt=st-10:st===void 0&&(st=nt+10),nt>st){let Et=nt;nt=st,st=Et}let gt=[],_t=1/(mt+1);for(let Et=0;Et<mt;Et++){let At=nt+(st-nt)*(Et+.75+Math.random()*.5)*_t;gt.push(At)}return gt}function Ih(nt){return nt instanceof Uint8Array||nt instanceof Uint16Array||nt instanceof Uint32Array||nt instanceof Int8Array||nt instanceof Int16Array||nt instanceof Int32Array||nt instanceof Float32Array||nt instanceof Float64Array}function tD(){return typeof process<"u"}function rD(nt,st){for(let mt of nt)st(mt.id,mt.data)!==!0&&rD(mt.children,st)}function iD(nt,st){if(st(nt.id,nt.data)!==!0)for(let mt of nt.children)iD(mt,st)}var gr=class extends Array{constructor(...nt){super(...nt),Object.setPrototypeOf(this,gr.prototype)}deepFreeze(){let nt=0;for(;nt<this.length;)Rp(this[nt]),nt++}fillCaches0(nt,st){this.objCaches.set(nt.id,nt),this.parentCaches.set(nt.id,st);for(let mt of nt.children)this.fillCaches0(mt,nt.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let nt of this)this.fillCaches0(nt,null)}}randomId(){this.fillCaches();let nt=Array.from(this.objCaches.keys());if(nt.length!==0)return nt[Math.max(0,Math.floor(Math.random()*nt.length)-1)]}nonExistOrDescendantOf(nt,st){if(!this.has(nt))return!0;for(;nt;){let mt=this.parent(nt);if(mt===st)return!0;nt=mt}return!1}rootAcestor(nt){for(;nt;){let st=this.parent(nt);if(st)nt=st;else return nt}return nt}isDescendantOf(nt,st){for(;nt;){let mt=this.parent(nt);if(mt===st)return!0;nt=mt}return!1}data(nt){var st;return(st=this.get(nt))==null?void 0:st.data}has(nt){return this.childrenOf(nt)!==void 0}get(nt){return this.fillCaches(),this.objCaches.get(nt)}childrenOf(nt){var st;return nt===null?this:(st=this.get(nt))==null?void 0:st.children}traverseFrom(nt,st){if(nt===null)this.traverse(st);else{let mt=this.get(nt);mt&&iD(mt,st)}}traverse(nt){rD(this,nt)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(nt){return this.fillCaches(),this.parentCaches.get(nt)}childrenArray(nt){return nt===null?this:this.get(nt).children}modifyById(nt,st){if(this.get(nt)===void 0)throw new Error("not expected");{let mt=this.parent(nt),gt=this.childrenArray(mt),_t=gt.findIndex(At=>At.id===nt);if(_t<0)throw new Error("not expected");let Et=gt[_t];return gt=[...gt],gt[_t]={...Et,data:st},this.modifyArrayBy(mt,gt)}}modifyArrayBy(nt,st){let mt=nt,gt=st;for(;mt!==null;){let Et=gt,At=mt;if(mt=this.parent(mt),mt===void 0)throw new Error;gt=this.childrenArray(mt);let Rt=gt.findIndex(Ft=>Ft.id===At);if(Rt<0)throw new Error;gt=[...gt],gt[Rt]={...gt[Rt],children:Et}}Object.setPrototypeOf(gt,gr.prototype);let _t=gt;return _t.fillCaches(),_t}runOp(nt){switch(nt.type){case 7:return this.addOp(nt);case 8:return this.deleteOp(nt);case 9:return this.moveOp(nt)}return null}checkDuplicatedIdRec({id:nt,children:st}){if(this.get(nt)!==void 0)return!0;for(let mt of st)if(this.checkDuplicatedIdRec(mt))return!0;return!1}addOp(nt){let{parent:st,fi:mt,id:gt,data:_t,children:Et}=nt;if(st!==null&&this.get(st)===void 0||this.checkDuplicatedIdRec(nt))return null;{let At=st,Rt=this.childrenArray(At),Ft={fi:mt,id:gt,data:_t,children:Et};return Rt=[...Rt,Ft],Rt.sort((Nt,Bt)=>Nt.fi-Bt.fi),nt.localIndex=Rt.indexOf(Ft),{data:this.modifyArrayBy(At,Rt),actual:nt,reverse:{type:8,id:gt}}}}deleteOp(nt){let{id:st}=nt;if(this.get(st)===null)return null;{let mt=this.parent(st);if(mt===void 0)return null;let gt=this.childrenArray(mt),_t=gt.findIndex(At=>At.id===st);nt.localIndex=_t,gt=[...gt];let Et=gt.splice(_t,1)[0];return{data:this.modifyArrayBy(mt,gt),actual:nt,reverse:{type:7,...Et,parent:mt}}}}moveOp(nt){let{parent:st,fi:mt,id:gt}=nt;if(st!==null&&this.get(st)===void 0)return this.deleteOp({type:8,id:gt});if(st!==null){let Gt=st;for(;Gt!==null;){if(Gt===void 0)throw new Error;if(Gt===gt)throw new Dh("cyclic tree");Gt=this.parent(Gt)}}let _t=this.parent(gt);if(_t===void 0)return null;let Et=_t,At=this.childrenArray(_t),Rt=At.findIndex(Gt=>Gt.id===gt);At=[...At];let Ft=At.splice(Rt,1)[0],Nt=this.modifyArrayBy(_t,At);_t=st,At=Nt.childrenArray(_t);let Bt=Ft.fi;return Ft={...Ft,fi:mt},At=[...At,Ft],At.sort((Gt,dr)=>Gt.fi-dr.fi),nt.localIndex=At.indexOf(Ft),Nt=Nt.modifyArrayBy(_t,At),{data:Nt,actual:nt,reverse:{type:9,parent:Et,fi:Bt,id:gt}}}previous(nt,st){if(st===null){let gt=this.childrenArray(nt);return gt.length===0?null:gt[gt.length-1].id}let mt=null;for(let gt of this.childrenArray(nt)){if(gt.id===st)return mt;mt=gt.id}return null}traverseSortNext(nt){let st=this.parent(nt);if(st!==void 0){let mt=this.childrenArray(st),gt=mt.findIndex(_t=>_t.id===nt)+1;if(gt<mt.length)return mt[gt].id;if(st)return this.traverseSortNext(st)}}sortNext(nt){let st=this.childrenArray(nt);return st.length>0?st[0].id:this.traverseSortNext(nt)}traverseSortPrevious(nt){let st=this.childrenArray(nt);return st.length>0?this.traverseSortPrevious(st[st.length-1].id):nt}sortPrevious(nt){let st=this.parent(nt);if(st!==void 0){let mt=this.childrenArray(st),gt=mt.findIndex(_t=>_t.id===nt)-1;return gt>=0?this.traverseSortPrevious(mt[gt].id):st}}getAllSorted(nt){let st=[];for(let mt of nt){let gt=this.getWithSortKey(mt.id);gt!==void 0&&st.push({...mt,...gt})}st.sort((mt,gt)=>eD(mt.sortKey,gt.sortKey));for(let mt of st)delete mt.sortKey;return st}getWithSortKey(nt){var st=nt;let mt=[],gt=this.get(st),_t=gt;if(gt!==void 0){for(;st;)mt.splice(0,0,gt.fi),st=this.parent(st),st!==null&&(gt=this.get(st));return{..._t,sortKey:mt}}}insertBeforeHelper(nt,st,mt){return this.insertAfterHelper(nt,this.previous(nt,st),mt)}insertAfterHelper(nt,st,mt){let gt=this.childrenArray(nt);if(st===null){if(gt.length===0)return yo$1(0,mt,mt);{let _t=gt[0].fi;return yo$1(_t-mt,_t,mt)}}else{let _t=this.get(st);if(_t===void 0||this.parent(st)!==nt)throw new Error("illegal args");let Et=gt.find(At=>At.fi>_t.fi);if(Et===void 0){let At=gt[gt.length-1].fi;return yo$1(At,At+mt,mt)}else return yo$1(_t.fi,Et.fi,mt)}}},Oh;(nt=>{function st(mt,gt){if(gt.type!==0)return null;if(Array.isArray(mt)){let _t=gt.props,Et={},At=[...mt],Rt=!1;if(_t)for(let Ft of Object.keys(_t)){let Nt=parseInt(Ft);if(isNaN(Nt))throw new Error("wrong index");Et[Ft]=At[Nt],At[Nt]=_t[Ft],Rt=!0}return Rt?{data:At,actual:gt,reverse:{type:0,props:Et}}:null}else{let _t=gt.props,Et={},At={...mt},Rt=!1;if(_t)for(let Ft of Object.keys(_t)){Et[Ft]=At[Ft];let Nt=_t[Ft];Nt===void 0?delete At[Ft]:At[Ft]=Nt,Rt=!0}return Rt?{data:At,actual:gt,reverse:{type:0,props:Et}}:null}}nt.runOp=st})(Oh||(Oh={}));var Ue$1=class extends Array{constructor(...st){super(...st),Object.setPrototypeOf(this,Ue$1.prototype)}deepFreeze(){let st=0;for(;st<this.length;)Rp(this[st]),st++}fillCaches0(st){this.objCaches.set(st.id,st)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let st of this)this.fillCaches0(st)}}randomId(){this.fillCaches();let st=Array.from(this.objCaches.keys());if(st.length!==0)return st[Math.max(0,Math.floor(Math.random()*st.length)-1)]}data(st){var mt;return(mt=this.get(st))==null?void 0:mt.data}get(st){return this.fillCaches(),this.objCaches.get(st)}modifyById(st,mt){if(this.get(st)===void 0)throw new Error("not expected");{let gt=this,_t=gt.findIndex(At=>At.id===st);if(_t<0)throw new Error("not expected");let Et=gt[_t];return gt=[...gt],gt[_t]={...Et,data:mt},this.modifyArrayBy(gt)}}modifyArrayBy(st){Object.setPrototypeOf(st,Ue$1.prototype);let mt=st;return tD()||mt.fillCaches(),mt}runOp(st){switch(st.type){case 4:return this.addOp(st);case 5:return this.deleteOp(st);case 6:return this.moveOp(st)}return null}addOp(st){let{fi:mt,id:gt,data:_t}=st,Et=this,At={fi:mt,id:gt,data:_t};return Et=[...Et,At],Et.sort((Rt,Ft)=>Rt.fi-Ft.fi),st.localIndex=Et.indexOf(At),{data:this.modifyArrayBy(Et),actual:st,reverse:{type:5,id:gt}}}deleteOp(st){let{id:mt}=st,gt=this,_t=gt.findIndex(At=>At.id===mt);if(_t===-1)return null;st.localIndex=_t,gt=[...gt];let Et=gt.splice(_t,1)[0];return{data:this.modifyArrayBy(gt),actual:st,reverse:{type:4,...Et}}}moveOp(st){let{fi:mt,id:gt}=st,_t=this;_t=[..._t];let Et=_t.findIndex(Ft=>Ft.id===gt);if(Et===-1)return null;let At=_t[Et].fi,Rt={..._t[Et],fi:mt};return _t[Et]=Rt,_t.sort((Ft,Nt)=>Ft.fi-Nt.fi),st.localIndex=_t.indexOf(Rt),{data:this.modifyArrayBy(_t),actual:st,reverse:{type:6,fi:At,id:gt}}}previous(st){if(st===null)return this.length===0?null:this[this.length-1].id;let mt=null;for(let gt of this){if(gt.id===st)return mt;mt=gt.id}return null}insertBeforeHelper(st,mt){return this.insertAfterHelper(this.previous(st),mt)}insertAfterHelper(st,mt){let gt=this;if(st===null){if(gt.length===0)return yo$1(0,mt,mt);{let _t=gt[0].fi;return yo$1(_t-mt,_t,mt)}}else{let _t=this.get(st);if(_t===void 0)throw new Error("illegal args");let Et=gt.find(At=>At.fi>_t.fi);if(Et===void 0){let At=gt[gt.length-1].fi;return yo$1(At,At+mt,mt)}else return yo$1(_t.fi,Et.fi,mt)}}};function Rh(nt){return nt&&typeof nt=="object"&&nt instanceof yr}var yr=class{unusedFunOverridesTable(nt){}runOp(nt){let st=[],mt=this,gt=0,_t={};for(;gt<nt.path.length;){if(st.push(mt),mt=mt===void 0?void 0:mt[nt.path[gt]],mt!==void 0&&!Rh(mt))return null;gt+=1}mt=mt?cv(mt):new yr;for(let[Rt,Ft]of Object.entries(nt.props)){let Nt=mt[Rt];_t[Rt]=Nt,Ft===void 0?delete mt[Rt]:mt[Rt]=Ft}for(;gt>0;){if(Object.keys(mt).length===0){let Rt=st[gt-1];Rt&&(mt=cv(Rt),delete mt[nt.path[gt-1]])}else{let Rt=st[gt-1];if(Rt){let Ft=cv(Rt);Ft[nt.path[gt-1]]=mt,mt=Ft}else{let Ft=new yr;Ft[nt.path[gt-1]]=mt,mt=Ft}}gt-=1}let Et=Object.setPrototypeOf(mt,yr.prototype),At={...nt,props:_t};return{data:Et,actual:nt,reverse:At}}},vo;(nt=>{function st(_t,Et){return Lp(_t,Et)??_t}nt.apply=st;function mt(_t,Et){return e1(_t,Et)}nt.merge=mt;function gt(_t,Et){let At=0,Rt=Et.path,Ft=_t;for(;At<Rt.length&&Ft!==void 0;){if(Ft=Sr.zoomOnce(Ft,Rt[At]),Ft===void 0)return Et;if(!Rh(Ft))return;At+=1}if(Ft===void 0)return Et;if(Rh(Ft))if(Et.type===0){let Nt={...Et.props};for(let Bt of Object.keys(Ft))delete Nt[Bt];return{...Et,props:Nt}}else if(Et.type===1||Et.type===4||Et.type===7){let Nt=$w([Et],Ft);return Nt?(console.log(Nt),Nt):Et}else return Et}nt.filterOp=gt})(vo||(vo={}));function $w(nt,st){if(st===void 0)return;let mt=!1,gt=nt.map(_t=>{let Et=_t.id,At=Lp(_t.data,st[Et]);if(mt=mt||At!==void 0,At===void 0&&(At=_t.data),_t.children){let Rt=$w(_t.children,st);return Rt!==void 0?mt=!0:Rt=_t.children,{..._t,id:Et,data:At,children:Rt}}else return{..._t,id:Et,data:At}});if(mt)return gt}function gq(nt,st){if(st===void 0)return;let mt=!1,gt=nt.map(_t=>{let Et=_t.id,At=Lp(_t.data,st[Et]);return mt=mt||At!==void 0,At===void 0&&(At=_t.data),{..._t,id:Et,data:At}});if(mt)return Object.setPrototypeOf(gt,Object.getPrototypeOf(nt)),gt}function Lp(nt,st){if(!Rh(st))return st;if(nt instanceof gr){let mt=$w(nt,st);return mt!==void 0&&Object.setPrototypeOf(mt,Object.getPrototypeOf(nt)),mt}else{if(nt instanceof Ue$1)return gq(nt,st);if(Array.isArray(nt)){let mt=!1,gt=nt.map((_t,Et)=>{let At=Lp(_t,st[Et]);return mt=mt||At!==void 0,At===void 0&&(At=_t),At});return mt?(Object.setPrototypeOf(gt,Object.getPrototypeOf(nt)),gt):void 0}else{if(nt instanceof yr)return e1(nt,st);if(nt&&typeof nt=="object"){let mt={},gt=!1;for(let[_t,Et]of Object.entries(nt)){let At=Lp(Et,st[_t]);gt=gt||At!==void 0,At===void 0&&(At=Et),mt[_t]=At}return gt?(Object.setPrototypeOf(mt,Object.getPrototypeOf(nt)),mt):void 0}}}}function e1(nt,st){if(nt===void 0)return st;if(st===void 0)return nt;if(!Rh(st))return st;if(!Rh(nt))return vo.apply(nt,st);let mt=new Set;for(let _t of Object.keys(nt))mt.add(_t);for(let _t of Object.keys(st))mt.add(_t);let gt=new yr;for(let _t of mt){let Et=e1(nt===void 0?void 0:nt[_t],st===void 0?void 0:st[_t]);gt[_t]=Et}return gt}function nD(nt,st){let mt={cur:[],result:[],len:0};return nt=Bp(nt,st,mt)??nt,[nt,mt.result]}function uv(nt,st){return nt===null?null:(nt.cur[nt.len]=st,nt.len+=1,nt)}function hv(nt){nt&&(nt.len-=1)}function yq(nt){if(nt===null)return null;nt.result.push(nt.cur.slice(0,nt.len))}function sD(nt,st,mt){let gt=!1,_t=nt.map(Et=>{let At=Et.id,Rt=st[At];if(Rt!==void 0&&typeof Rt=="string"&&(gt=!0,At=Rt,mt!==null))throw new Error("not supported");let Ft=Bp(Et.data,st,uv(mt,At));hv(mt),gt=gt||Ft!==void 0,Ft===void 0&&(Ft=Et.data);let Nt=sD(Et.children,st,mt);return Nt!==void 0?gt=!0:Nt=Et.children,{...Et,id:At,data:Ft,children:Nt}});if(gt)return _t}function vq(nt,st,mt){let gt=!1,_t=nt.map(Et=>{let At=Et.id,Rt=st[At];if(Rt!==void 0&&typeof Rt=="string"&&(gt=!0,At=Rt,mt!==null))throw new Error("not supported");let Ft=Bp(Et.data,st,uv(mt,At));return hv(mt),gt=gt||Ft!==void 0,Ft===void 0&&(Ft=Et.data),{...Et,id:At,data:Ft}});if(gt)return Object.setPrototypeOf(_t,Object.getPrototypeOf(nt)),_t}function Bp(nt,st,mt){if(nt instanceof gr){let gt=sD(nt,st,mt);return gt!==void 0&&Object.setPrototypeOf(gt,Object.getPrototypeOf(nt)),gt}else{if(nt instanceof Ue$1)return vq(nt,st,mt);if(Array.isArray(nt)){let gt=!1,_t=nt.map((Et,At)=>{let Rt=Bp(Et,st,uv(mt,At));return hv(mt),gt=gt||Rt!==void 0,Rt===void 0&&(Rt=Et),Rt});return gt?(Object.setPrototypeOf(_t,Object.getPrototypeOf(nt)),_t):void 0}else if(nt&&typeof nt=="object"&&!Ih(nt)){let gt={},_t=!1;for(let[Et,At]of Object.entries(nt))if(Et!=="name"&&Et!=="variableId"){let Rt=st[Et];if(typeof Rt=="string"){if(mt!==null)throw new Error("not supported");_t=!0,Et=Rt}let Ft=Bp(At,st,uv(mt,Et));hv(mt),_t=_t||Ft!==void 0,Ft===void 0&&(Ft=At),gt[Et]=Ft}else gt[Et]=At;return _t?(Object.setPrototypeOf(gt,Object.getPrototypeOf(nt)),gt):void 0}else if(typeof nt=="string"){let gt=st[nt];return gt!==void 0&&yq(mt),gt}else return}}var Lh;(nt=>{function st(mt,gt){let _t=Sr.zoom(gt,mt.path);if(typeof _t=="object"){let Et={};for(let At of Object.keys(mt.props))Et[At]=_t[At];return{...mt,props:Et}}else return{...mt,props:{}}}nt.replaceProps=st})(Lh||(Lh={}));var Rr;(nt=>{function st(Ft,Nt){return{...Ft,path:Ft.path.slice(Nt)}}nt.drop=st;function mt(Ft,Nt){var Bt;return((Bt=gt(Ft,Nt))==null?void 0:Bt.data)??Ft}nt.applySimple=mt;function gt(Ft,Nt){var dr,Mr;let Bt=Nt.path;for(var Gt=[];;){let Tr;if(Ft instanceof yr&&Nt.type===0&&(Tr=Ft.runOp({...Nt,path:Bt.slice(Gt.length)}),Tr===null&&(Tr=void 0)),Tr===void 0&&Gt.length===Bt.length&&(Ft instanceof gr||Ft instanceof Ue$1||Ft instanceof Ke$1?Tr=Ft.runOp(Nt):Tr=Oh.runOp(Ft,Nt)),Tr!==void 0)if(Tr!==null){let Nr=Tr.data;for(let tn=Gt.length-1;tn>=0;tn--){let rn=Bt[tn],Tn=Gt[tn];if(Tn instanceof gr){if(typeof rn=="number")throw new Error("illegal arg");Nr=Tn.modifyById(rn,Nr)}else if(Tn instanceof Ue$1){if(typeof rn=="number")throw new Error("illegal arg");Nr=Tn.modifyById(rn,Nr)}else if(Tn instanceof Ke$1){if(typeof rn=="number")throw new Error("illegal arg");Nr=Tn.modifyById(rn,Nr)}else if(Tn instanceof yr){let $n={...Tn,[rn]:Nr};Nr=Object.setPrototypeOf($n,yr.prototype)}else if(typeof Tn=="object")if(Array.isArray(Tn)){if(typeof rn=="string"&&(rn=parseInt(rn),isNaN(rn)))throw new Error("Invalid path");let $n=Nr;Nr=[...Tn],Nr[rn]=$n}else Nr={...Tn,[rn]:Nr};else return null}return{data:Nr,actual:{...Tr.actual,path:Bt},reverse:{...Tr.reverse,path:Bt}}}else return null;let zr=Bt[Gt.length],Fr;if(Ft instanceof gr){if(typeof zr=="number")throw new Error("");Fr=(dr=Ft.get(zr))==null?void 0:dr.data}else if(Ft instanceof Ue$1){if(typeof zr=="number")throw new Error("");Fr=(Mr=Ft.get(zr))==null?void 0:Mr.data}else Ft!==null&&(Fr=Ft[zr]);if(Fr!==void 0)Gt.push(Ft),Ft=Fr;else return null}}nt.apply=gt;function _t(Ft,Nt){for(let Bt=0;Bt<Ft.length&&Bt<Nt.length;Bt++)if(Ft[Bt]!==Nt[Bt])return!0;return!1}nt.pathDisjoint=_t;function Et(Ft,Nt){if(Ft.length!==Nt.length)return!1;for(let Bt=0;Bt<Ft.length;Bt++)if(Ft[Bt]!==Nt[Bt])return!1;return!0}nt.pathEq=Et;function At(Ft,Nt){return _t(Ft.path,Nt.path)}nt.commutative=At;function Rt(Ft,Nt){return Ft.type===0&&Nt.type===0&&Et(Ft.path,Nt.path)?Object.keys(Ft.props).every(Bt=>Nt.props[Bt]!==void 0):!1}nt.subsumed=Rt})(Rr||(Rr={}));var Np;(nt=>{function st(){return[]}nt.empty=st;function mt(Nt,Bt){let Gt=[];for(let dr of Nt){let[Mr,...Tr]=dr.path;Mr===Bt&&Gt.push({...dr,path:Tr})}return Gt}nt.removePrefix=mt;function gt(Nt,Bt){return Nt.map(Gt=>({...Gt,path:[Bt,...Gt.path]}))}nt.addPrefix=gt;function _t(Nt,Bt){return[...Nt,...Bt]}nt.concat=_t;function Et(Nt,Bt){return[...Nt.filter(Gt=>!Bt.some(dr=>Rr.subsumed(Gt,dr))),...Bt]}nt.compress=Et;function At(Nt,Bt){return Nt.every(Gt=>Bt.every(dr=>Rr.commutative(Gt,dr)))}nt.commutative=At;function Rt(Nt,Bt){for(let Gt of Bt){let dr=Ft(Nt,Gt);dr!==null&&(Nt=dr.data)}return Nt}nt.applyAll=Rt;function Ft(Nt,Bt){var Gt=Nt;let dr=[],Mr=[];for(let Tr of Bt)try{if(Tr.type===3||Tr.type===5&&Tr.path[Tr.path.length-1]==="variables"){let zr,Fr,Nr;if(Tr.type===3?(zr=Sr.zoom(Gt,[...Tr.path,Tr.id]),Nr=Rr.apply(Gt,{...Tr,type:2})):(zr=Sr.zoom(Gt,[...Tr.path,Tr.id,"value"]),Nr=Rr.apply(Gt,Tr)),Nr!==null){Gt=Nr.data;let[tn,rn]=nD(Gt,{[Tr.id]:zr});Gt=tn;for(let Tn=0;Tn<rn.length;Tn++){let $n=rn[Tn],un=$n.pop();if(typeof un=="number"){let es=[un];for(let ts=Tn+1;ts<rn.length;ts++){let Ko=rn[ts],ds=Ko[Ko.length-1];if(typeof ds=="number"&&Sr.equal($n,Ko.slice(0,Ko.length-1)))es.push(ds),rn.splice(ts,1);else break}let kn=Sr.zoom(Gt,$n);Fr=kn.map((ts,Ko)=>es.includes(Ko)?Tr.id:ts),zr=kn,un=$n.pop()}else{if(un==="alphaOverride"||un==="alpha"){zr/=100;let es=zr,kn=Sr.zoom(Gt,$n.slice(0,$n.length-2)),ts=kn.layers.map(Ko=>Ko.id===$n[$n.length-1]?{...Ko,data:{...Ko.data,[un]:es}}:Ko);Object.setPrototypeOf(ts,Object.getPrototypeOf(kn.layers)),kn.layers=ts}Fr=Tr.id}dr.push({type:0,path:$n,props:{[un]:zr}}),Mr.push({type:0,path:$n,props:{[un]:Fr}})}Mr.push(Nr.reverse),dr.push(Nr.actual)}}else{let zr=Rr.apply(Gt,Tr);zr!==null&&(dr.push(zr.actual),Gt=zr.data,Mr.push(zr.reverse))}}catch(zr){if(zr instanceof Dh)return null;throw zr}return{data:Gt,actual:dr,reverse:Mr.reverse()}}nt.apply=Ft})(Np||(Np={}));var oD=Symbol(),xq=Symbol(),fv=Symbol(),Pc=class{reportOp(nt,st,mt=[]){let gt=this;if(st===null)return;gt._current=st.data;let _t=mt;for(;!(gt instanceof dv);){let Et=gt._path,At=gt._current;if(Et!==""&&_t.splice(0,0,Et),gt=gt._parent,gt===null)return;gt.update(Et,At)}gt.push(_t,nt,st.actual,st.reverse)}deleteChildren(nt){if(this._children){let st=this._children[nt];if(st){let mt=st[fv];mt&&mt(),delete this._children[nt]}}}},r1=class extends Pc{constructor(nt,st,mt){super(),this._parent=nt,this._path=st,this._current=mt}update(nt,st){if(Array.isArray(this._current)){if(typeof nt=="string"&&(nt=parseInt(nt),isNaN(nt)))throw new Error("Invalid path");this._current=[...this._current],this._current[nt]=st}else this._current={...this._current,[nt]:st}}runOp(nt){this.reportOp(nt,Oh.runOp(this._current,nt),nt.path)}},i1=class extends Pc{constructor(nt,st,mt){super(),this._parent=nt,this._path=st,this._current=mt}update(nt,st){this._current={...this._current,[nt]:st},Object.setPrototypeOf(this._current,Ke$1.prototype)}runOp(nt){this.reportOp(nt,this._current.runOp(nt))}},aD={get(nt,st){if(st===fv)return()=>{nt._parent=null};if(st===oD)return nt._current;if(st===xq)return nt;let{_current:mt,_children:gt}=nt;if(st==="push"&&Array.isArray(mt))throw new Error("not supported to expand array");let _t=gt===void 0?void 0:gt[st];if(_t!==void 0)return _t;let Et=mt[st],At=pv(nt,st,Et);return At!==Et?(gt===void 0&&(gt={},nt._children=gt),gt[st]=At,At):Et},has(nt,st){return st in nt._current},ownKeys(nt){return Reflect.ownKeys(nt._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(nt){return Object.getPrototypeOf(nt._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(nt,st){let mt=nt._current,gt=Reflect.getOwnPropertyDescriptor(mt,st);return gt&&{writable:!0,configurable:!0,enumerable:gt.enumerable,value:mt[st]}}},bq={...aD,set(nt,st,mt){let gt={type:0,props:{[st]:kr(mt)??mt}};return nt.deleteChildren(st),nt.runOp(gt),!0},deleteProperty(nt,st){let mt={type:0,props:{[st]:void 0}};return nt.deleteChildren(st),nt.runOp(mt),!0}},Sq={...aD,set(nt,st,mt){return mt===void 0?this.deleteProperty(nt,st):(nt.deleteChildren(st),nt.runOp({type:1,id:st,data:mt})),!0},deleteProperty(nt,st){return nt.runOp({type:2,id:st}),!0}},Bh=class extends Pc{constructor(nt,st,mt){super(),this._children={},this._parent=nt,this._path=st,this._current=mt,this[fv]=()=>{this._parent=null}}unproxy(){return this._current}update(nt,st){this._current=this._current.modifyById(nt,st)}runOp(nt){this.reportOp(nt,this._current.runOp(nt))}randomId(){return this._current.randomId()}isDescendantOf(nt,st){return this._current.isDescendantOf(nt,st)}childrenOf(nt){return this._current.childrenOf(nt)}traverse(nt){return this._current.traverse(nt)}get(nt){return this._current.get(nt)}parent(nt){return this._current.parent(nt)}traverse(nt){this._current.traverse((st,mt)=>{nt(st,this.data(st))})}data(nt){var At;let{_current:st,_children:mt}=this,gt=mt===void 0?void 0:mt[nt];if(gt!==void 0)return gt;let _t=(At=st.get(nt))==null?void 0:At.data,Et=pv(this,nt,_t);return Et!==_t?(mt===void 0&&(mt={},this._children=mt),mt[nt]=Et,Et):_t}add(nt,st,mt,gt,_t){this.runOp({type:7,parent:nt,fi:st,id:mt,data:gt,children:_t})}move(nt,st,mt){this.runOp({type:9,parent:nt,fi:st,id:mt})}insertAfter(nt,st,mt){let gt=this._current.insertAfterHelper(nt,st,mt.length);for(let _t=0;_t<mt.length;_t++){let Et=mt[_t];this.add(nt,gt[_t],Et.id,Et.data,Et.children)}}insertBefore(nt,st,mt){let gt=this._current.insertBeforeHelper(nt,st,mt.length);for(let _t=0;_t<mt.length;_t++){let Et=mt[_t];this.add(nt,gt[_t],Et.id,Et.data,Et.children)}}moveAfter(nt,st,mt){let gt=this._current.insertAfterHelper(nt,st,mt.length);for(let _t=0;_t<mt.length;_t++){let Et=mt[_t];this.move(nt,gt[_t],Et)}}moveBefore(nt,st,mt){let gt=this._current.insertBeforeHelper(nt,st,mt.length);for(let _t=0;_t<mt.length;_t++){let Et=mt[_t];this.move(nt,gt[_t],Et)}}delete(nt){this.deleteChildren(nt),this.runOp({type:8,id:nt})}sortNext(nt){return this._current.sortNext(nt)}sortPrevious(nt){return this._current.sortPrevious(nt)}getAllSorted(nt){return this._current.getAllSorted(nt)}},Nh=class extends Pc{constructor(nt,st,mt){super(),this._children={},this._parent=nt,this._path=st,this._current=mt,this[fv]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(nt){let st=this.length;for(let mt=0;mt<st;mt++){let gt=this._current[mt].id,_t=this._current[mt].fi;nt(this.data(this._current[mt].id),gt,_t)}}find(nt){let st=this.length;for(let mt=0;mt<st;mt++){let gt=this._current[mt].id;if(nt(this.data(gt),gt))return this.get(gt)}}update(nt,st){this._current=this._current.modifyById(nt,st)}randomId(){return this._current.randomId()}get(nt){return{...this._current.get(nt),data:this.data(nt)}}data(nt){var At;let{_current:st,_children:mt}=this,gt=mt===void 0?void 0:mt[nt];if(gt!==void 0)return gt;let _t=(At=st.get(nt))==null?void 0:At.data,Et=pv(this,nt,_t);return Et!==_t?(mt===void 0&&(mt={},this._children=mt),mt[nt]=Et,Et):_t}runOp(nt){this.reportOp(nt,this._current.runOp(nt))}add(nt,st,mt){this.runOp({type:4,fi:nt,id:st,data:mt})}move(nt,st){this.runOp({type:6,fi:nt,id:st})}insertAfter(nt,st){let mt=this._current.insertAfterHelper(nt,st.length);for(let gt=0;gt<st.length;gt++){let _t=st[gt];this.add(mt[gt],_t.id,_t.data)}}insertBefore(nt,st){let mt=this._current.insertBeforeHelper(nt,st.length);for(let gt=0;gt<st.length;gt++){let _t=st[gt];this.add(mt[gt],_t.id,_t.data)}}moveAfter(nt,st){let mt=this._current.insertAfterHelper(nt,st.length);for(let gt=0;gt<st.length;gt++){let _t=st[gt];this.move(mt[gt],_t)}}moveBefore(nt,st){let mt=this._current.insertBeforeHelper(nt,st.length);for(let gt=0;gt<st.length;gt++){let _t=st[gt];this.move(mt[gt],_t)}}delete(nt){this.deleteChildren(nt),this.runOp({type:5,id:nt})}};function t1(nt,st,mt){if(nt.length>0){let gt=nt[nt.length-1];if(gt.type===0&&st.type===0&&Sr.equal(gt.path,mt)){Object.assign(gt.props,st.props);return}}nt.push({...st,path:mt})}var dv=class extends Pc{constructor(nt){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=nt}update(nt,st){if(nt!=="")throw new Error("");this._current=st}push(nt,st,mt,gt){t1(this.ts,st,nt),t1(this.actual,mt,nt),t1(this.reverse,gt,nt)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function pv(nt,st,mt){return mt instanceof gr?new Bh(nt,st,mt):mt instanceof Ue$1?new Nh(nt,st,mt):mt instanceof Ke$1?new Proxy(new i1(nt,st,mt),Sq):mt!==null&&typeof mt=="object"?Ih(mt)?mt:new Proxy(new r1(nt,st,mt),bq):mt}function n1(nt){let st=new dv(nt);return[pv(st,"",nt),st]}function pl(nt,st){let[mt,gt]=n1(nt);return st(mt),gt.result()}function kr(nt){return nt instanceof Bh||nt instanceof Nh?nt._current:nt!==null&&typeof nt=="object"?nt[oD]:nt}var Sr;(nt=>{function st(Et,At){if(At.length===Et.length)for(var Rt=0;Rt<Et.length;){if(Et[Rt]!==At[Rt])return!1;Rt+=1}else return!1;return!0}nt.equal=st;function mt(Et,At,Rt){let Ft=_t(Rt,Et);if(Ft!==void 0&&typeof Ft=="object"&&Ft!==null){let Nt={...At};return Object.keys(Ft).forEach(Bt=>{delete Nt[Bt]}),Nt}else return At}nt.removeOverridden=mt;function gt(Et,At){if((Et instanceof gr||Et instanceof Bh)&&typeof At=="string"||(Et instanceof Ue$1||Et instanceof Nh)&&typeof At=="string")return Et.data(At);if(typeof At=="number"&&Array.isArray(Et)||typeof At=="string"&&typeof Et=="object"&&Et!==null)return Et[At]}nt.zoomOnce=gt;function _t(Et,At,Rt=0){for(;Rt<At.length&&Et!==void 0;)Et=gt(Et,At[Rt]),Rt+=1;return Et}nt.zoom=_t})(Sr||(Sr={}));function lD(nt,st){let mt=[];if(st.length===nt.length)for(var gt=0;gt<nt.length;){if(st[gt]==="*")mt.push(nt[gt]);else if(nt[gt]!==st[gt])return null;gt+=1}else return null;return mt}function Lt(nt,st){let mt=[];if(st.length<=nt.length)for(var gt=0;gt<st.length;){if(st[gt]==="*")mt.push(nt[gt]);else if(nt[gt]!==st[gt])return null;gt+=1}else return null;return mt}var mv=class{},Fp=class extends mv{constructor(nt){super(),this.id=nt}},Vp=class extends mv{constructor(nt){super(),this.data=nt}},o1;try{o1=new TextDecoder}catch{}var qe$1,gl,ne$1=0,_n={},Qt,ml,us=0,xo=0,Zn,pa,yn=[],nr,cD={useRecords:!1,mapsAsObjects:!0},Up=class{},u1=new Up;u1.name="MessagePack 0xC1";var Fh=!1,bo=class{constructor(nt){nt&&(nt.useRecords===!1&&nt.mapsAsObjects===void 0&&(nt.mapsAsObjects=!0),nt.structures?nt.structures.sharedLength=nt.structures.length:nt.getStructures&&((nt.structures=[]).uninitialized=!0,nt.structures.sharedLength=0)),Object.assign(this,nt)}unpack(nt,st){if(qe$1)return SD(()=>(yv(),this?this.unpack(nt,st):bo.prototype.unpack.call(cD,nt,st)));gl=st>-1?st:nt.length,ne$1=0,xo=0,ml=null,Zn=null,qe$1=nt;try{nr=nt.dataView||(nt.dataView=new DataView(nt.buffer,nt.byteOffset,nt.byteLength))}catch(mt){throw qe$1=null,nt instanceof Uint8Array?mt:new Error("Source must be a Uint8Array or Buffer but was a "+(nt&&typeof nt=="object"?nt.constructor.name:typeof nt))}if(this instanceof bo){if(_n=this,this.structures)return Qt=this.structures,gv();(!Qt||Qt.length>0)&&(Qt=[])}else _n=cD,(!Qt||Qt.length>0)&&(Qt=[]);return gv()}unpackMultiple(nt,st){let mt,gt=0;try{Fh=!0;let _t=nt.length,Et=this?this.unpack(nt,_t):bv.unpack(nt,_t);if(st){for(st(Et);ne$1<_t;)if(gt=ne$1,st(gv())===!1)return}else{for(mt=[Et];ne$1<_t;)gt=ne$1,mt.push(gv());return mt}}catch(_t){throw _t.lastPosition=gt,_t.values=mt,_t}finally{Fh=!1,yv()}}_mergeStructures(nt,st){nt=nt||[];for(let mt=0,gt=nt.length;mt<gt;mt++){let _t=nt[mt];_t&&(_t.isShared=!0,mt>=32&&(_t.highByte=mt-32>>5))}nt.sharedLength=nt.length;for(let mt in st||[])if(mt>=0){let gt=nt[mt],_t=st[mt];_t&&(gt&&((nt.restoreStructures||(nt.restoreStructures=[]))[mt]=gt),nt[mt]=_t)}return this.structures=nt}decode(nt,st){return this.unpack(nt,st)}};function gv(){try{if(!_n.trusted&&!Fh){let st=Qt.sharedLength||0;st<Qt.length&&(Qt.length=st)}let nt=Xr();if(ne$1==gl)Qt.restoreStructures&&uD(),Qt=null,qe$1=null,pa&&(pa=null);else if(ne$1>gl){let st=new Error("Unexpected end of MessagePack data");throw st.incomplete=!0,st}else if(!Fh)throw new Error("Data read, but end of buffer not reached");return nt}catch(nt){throw Qt.restoreStructures&&uD(),yv(),(nt instanceof RangeError||nt.message.startsWith("Unexpected end of buffer"))&&(nt.incomplete=!0),nt}}function uD(){for(let nt in Qt.restoreStructures)Qt[nt]=Qt.restoreStructures[nt];Qt.restoreStructures=null}function Xr(){let nt=qe$1[ne$1++];if(nt<160)if(nt<128){if(nt<64)return nt;{let st=Qt[nt&63]||_n.getStructures&&yD()[nt&63];return st?(st.read||(st.read=h1(st,nt&63)),st.read()):nt}}else if(nt<144)if(nt-=128,_n.mapsAsObjects){let st={};for(let mt=0;mt<nt;mt++)st[xD()]=Xr();return st}else{let st=new Map;for(let mt=0;mt<nt;mt++)st.set(Xr(),Xr());return st}else{nt-=144;let st=new Array(nt);for(let mt=0;mt<nt;mt++)st[mt]=Xr();return st}else if(nt<192){let st=nt-160;if(xo>=ne$1)return ml.slice(ne$1-us,(ne$1+=st)-us);if(xo==0&&gl<140){let mt=st<16?d1(st):vD(st);if(mt!=null)return mt}return c1(st)}else{let st;switch(nt){case 192:return null;case 193:return Zn?(st=Xr(),st>0?Zn[1].slice(Zn.position1,Zn.position1+=st):Zn[0].slice(Zn.position0,Zn.position0-=st)):u1;case 194:return!1;case 195:return!0;case 196:return s1(qe$1[ne$1++]);case 197:return st=nr.getUint16(ne$1),ne$1+=2,s1(st);case 198:return st=nr.getUint32(ne$1),ne$1+=4,s1(st);case 199:return _c(qe$1[ne$1++]);case 200:return st=nr.getUint16(ne$1),ne$1+=2,_c(st);case 201:return st=nr.getUint32(ne$1),ne$1+=4,_c(st);case 202:if(st=nr.getFloat32(ne$1),_n.useFloat32>2){let mt=xv[(qe$1[ne$1]&127)<<1|qe$1[ne$1+1]>>7];return ne$1+=4,(mt*st+(st>0?.5:-.5)>>0)/mt}return ne$1+=4,st;case 203:return st=nr.getFloat64(ne$1),ne$1+=8,st;case 204:return qe$1[ne$1++];case 205:return st=nr.getUint16(ne$1),ne$1+=2,st;case 206:return st=nr.getUint32(ne$1),ne$1+=4,st;case 207:return _n.int64AsNumber?(st=nr.getUint32(ne$1)*4294967296,st+=nr.getUint32(ne$1+4)):st=nr.getBigUint64(ne$1),ne$1+=8,st;case 208:return nr.getInt8(ne$1++);case 209:return st=nr.getInt16(ne$1),ne$1+=2,st;case 210:return st=nr.getInt32(ne$1),ne$1+=4,st;case 211:return _n.int64AsNumber?(st=nr.getInt32(ne$1)*4294967296,st+=nr.getUint32(ne$1+4)):st=nr.getBigInt64(ne$1),ne$1+=8,st;case 212:if(st=qe$1[ne$1++],st==114)return mD(qe$1[ne$1++]&63);{let mt=yn[st];if(mt)return mt.read?(ne$1++,mt.read(Xr())):mt.noBuffer?(ne$1++,mt()):mt(qe$1.subarray(ne$1,++ne$1));throw new Error("Unknown extension "+st)}case 213:return st=qe$1[ne$1],st==114?(ne$1++,mD(qe$1[ne$1++]&63,qe$1[ne$1++])):_c(2);case 214:return _c(4);case 215:return _c(8);case 216:return _c(16);case 217:return st=qe$1[ne$1++],xo>=ne$1?ml.slice(ne$1-us,(ne$1+=st)-us):Aq(st);case 218:return st=nr.getUint16(ne$1),ne$1+=2,xo>=ne$1?ml.slice(ne$1-us,(ne$1+=st)-us):Eq(st);case 219:return st=nr.getUint32(ne$1),ne$1+=4,xo>=ne$1?ml.slice(ne$1-us,(ne$1+=st)-us):Mq(st);case 220:return st=nr.getUint16(ne$1),ne$1+=2,dD(st);case 221:return st=nr.getUint32(ne$1),ne$1+=4,dD(st);case 222:return st=nr.getUint16(ne$1),ne$1+=2,fD(st);case 223:return st=nr.getUint32(ne$1),ne$1+=4,fD(st);default:if(nt>=224)return nt-256;if(nt===void 0){let mt=new Error("Unexpected end of MessagePack data");throw mt.incomplete=!0,mt}throw new Error("Unknown MessagePack token "+nt)}}}var wq=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function h1(nt,st){function mt(){if(mt.count++>2){let _t=nt.read=new Function("r","return function(){return {"+nt.map(Et=>wq.test(Et)?Et+":r()":"["+JSON.stringify(Et)+"]:r()").join(",")+"}}")(Xr);return nt.highByte===0&&(nt.read=hD(st,nt.read)),_t()}let gt={};for(let _t=0,Et=nt.length;_t<Et;_t++){let At=nt[_t];gt[At]=Xr()}return gt}return mt.count=0,nt.highByte===0?hD(st,mt):mt}var hD=(nt,st)=>function(){let mt=qe$1[ne$1++];if(mt===0)return st();let gt=nt<32?-(nt+(mt<<5)):nt+(mt<<5),_t=Qt[gt]||yD()[gt];if(!_t)throw new Error("Record id is not defined for "+gt);return _t.read||(_t.read=h1(_t,nt)),_t.read()};function yD(){let nt=SD(()=>(qe$1=null,_n.getStructures()));return Qt=_n._mergeStructures(nt,Qt)}var c1=vv,Aq=vv,Eq=vv,Mq=vv;function vv(nt){let st;if(nt<16&&(st=d1(nt)))return st;if(nt>64&&o1)return o1.decode(qe$1.subarray(ne$1,ne$1+=nt));let mt=ne$1+nt,gt=[];for(st="";ne$1<mt;){let _t=qe$1[ne$1++];if(!(_t&128))gt.push(_t);else if((_t&224)===192){let Et=qe$1[ne$1++]&63;gt.push((_t&31)<<6|Et)}else if((_t&240)===224){let Et=qe$1[ne$1++]&63,At=qe$1[ne$1++]&63;gt.push((_t&31)<<12|Et<<6|At)}else if((_t&248)===240){let Et=qe$1[ne$1++]&63,At=qe$1[ne$1++]&63,Rt=qe$1[ne$1++]&63,Ft=(_t&7)<<18|Et<<12|At<<6|Rt;Ft>65535&&(Ft-=65536,gt.push(Ft>>>10&1023|55296),Ft=56320|Ft&1023),gt.push(Ft)}else gt.push(_t);gt.length>=4096&&(st+=Vi.apply(String,gt),gt.length=0)}return gt.length>0&&(st+=Vi.apply(String,gt)),st}function dD(nt){let st=new Array(nt);for(let mt=0;mt<nt;mt++)st[mt]=Xr();return st}function fD(nt){if(_n.mapsAsObjects){let st={};for(let mt=0;mt<nt;mt++)st[xD()]=Xr();return st}else{let st=new Map;for(let mt=0;mt<nt;mt++)st.set(Xr(),Xr());return st}}var Vi=String.fromCharCode;function vD(nt){let st=ne$1,mt=new Array(nt);for(let gt=0;gt<nt;gt++){let _t=qe$1[ne$1++];if((_t&128)>0){ne$1=st;return}mt[gt]=_t}return Vi.apply(String,mt)}function d1(nt){if(nt<4)if(nt<2){if(nt===0)return"";{let st=qe$1[ne$1++];if((st&128)>1){ne$1-=1;return}return Vi(st)}}else{let st=qe$1[ne$1++],mt=qe$1[ne$1++];if((st&128)>0||(mt&128)>0){ne$1-=2;return}if(nt<3)return Vi(st,mt);let gt=qe$1[ne$1++];if((gt&128)>0){ne$1-=3;return}return Vi(st,mt,gt)}else{let st=qe$1[ne$1++],mt=qe$1[ne$1++],gt=qe$1[ne$1++],_t=qe$1[ne$1++];if((st&128)>0||(mt&128)>0||(gt&128)>0||(_t&128)>0){ne$1-=4;return}if(nt<6){if(nt===4)return Vi(st,mt,gt,_t);{let Et=qe$1[ne$1++];if((Et&128)>0){ne$1-=5;return}return Vi(st,mt,gt,_t,Et)}}else if(nt<8){let Et=qe$1[ne$1++],At=qe$1[ne$1++];if((Et&128)>0||(At&128)>0){ne$1-=6;return}if(nt<7)return Vi(st,mt,gt,_t,Et,At);let Rt=qe$1[ne$1++];if((Rt&128)>0){ne$1-=7;return}return Vi(st,mt,gt,_t,Et,At,Rt)}else{let Et=qe$1[ne$1++],At=qe$1[ne$1++],Rt=qe$1[ne$1++],Ft=qe$1[ne$1++];if((Et&128)>0||(At&128)>0||(Rt&128)>0||(Ft&128)>0){ne$1-=8;return}if(nt<10){if(nt===8)return Vi(st,mt,gt,_t,Et,At,Rt,Ft);{let Nt=qe$1[ne$1++];if((Nt&128)>0){ne$1-=9;return}return Vi(st,mt,gt,_t,Et,At,Rt,Ft,Nt)}}else if(nt<12){let Nt=qe$1[ne$1++],Bt=qe$1[ne$1++];if((Nt&128)>0||(Bt&128)>0){ne$1-=10;return}if(nt<11)return Vi(st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt);let Gt=qe$1[ne$1++];if((Gt&128)>0){ne$1-=11;return}return Vi(st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt)}else{let Nt=qe$1[ne$1++],Bt=qe$1[ne$1++],Gt=qe$1[ne$1++],dr=qe$1[ne$1++];if((Nt&128)>0||(Bt&128)>0||(Gt&128)>0||(dr&128)>0){ne$1-=12;return}if(nt<14){if(nt===12)return Vi(st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt,dr);{let Mr=qe$1[ne$1++];if((Mr&128)>0){ne$1-=13;return}return Vi(st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr)}}else{let Mr=qe$1[ne$1++],Tr=qe$1[ne$1++];if((Mr&128)>0||(Tr&128)>0){ne$1-=14;return}if(nt<15)return Vi(st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr);let zr=qe$1[ne$1++];if((zr&128)>0){ne$1-=15;return}return Vi(st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr)}}}}}function s1(nt){return _n.copyBuffers?Uint8Array.prototype.slice.call(qe$1,ne$1,ne$1+=nt):qe$1.subarray(ne$1,ne$1+=nt)}function _c(nt){let st=qe$1[ne$1++];if(yn[st])return yn[st](qe$1.subarray(ne$1,ne$1+=nt));throw new Error("Unknown extension type "+st)}var pD=new Array(4096);function xD(){let nt=qe$1[ne$1++];if(nt>=160&&nt<192){if(nt=nt-160,xo>=ne$1)return ml.slice(ne$1-us,(ne$1+=nt)-us);if(!(xo==0&&gl<180))return c1(nt)}else return ne$1--,Xr();let st=(nt<<5^(nt>1?nr.getUint16(ne$1):nt>0?qe$1[ne$1]:0))&4095,mt=pD[st],gt=ne$1,_t=ne$1+nt-3,Et,At=0;if(mt&&mt.bytes==nt){for(;gt<_t;){if(Et=nr.getUint32(gt),Et!=mt[At++]){gt=1879048192;break}gt+=4}for(_t+=3;gt<_t;)if(Et=qe$1[gt++],Et!=mt[At++]){gt=1879048192;break}if(gt===_t)return ne$1=gt,mt.string;_t-=3,gt=ne$1}for(mt=[],pD[st]=mt,mt.bytes=nt;gt<_t;)Et=nr.getUint32(gt),mt.push(Et),gt+=4;for(_t+=3;gt<_t;)Et=qe$1[gt++],mt.push(Et);let Rt=nt<16?d1(nt):vD(nt);return Rt!=null?mt.string=Rt:mt.string=c1(nt)}var mD=(nt,st)=>{var mt=Xr();let gt=nt;st!==void 0&&(nt=nt<32?-((st<<5)+nt):(st<<5)+nt,mt.highByte=st);let _t=Qt[nt];return _t&&_t.isShared&&((Qt.restoreStructures||(Qt.restoreStructures=[]))[nt]=_t),Qt[nt]=mt,mt.read=h1(mt,gt),mt.read()},bD=typeof self=="object"?self:global;yn[0]=()=>{};yn[0].noBuffer=!0;yn[101]=()=>{let nt=Xr();return(bD[nt[0]]||Error)(nt[1])};yn[105]=nt=>{let st=nr.getUint32(ne$1-4);pa||(pa=new Map);let mt=qe$1[ne$1],gt;mt>=144&&mt<160||mt==220||mt==221?gt=[]:gt={};let _t={target:gt};pa.set(st,_t);let Et=Xr();return _t.used?Object.assign(gt,Et):(_t.target=Et,Et)};yn[112]=nt=>{let st=nr.getUint32(ne$1-4),mt=pa.get(st);return mt.used=!0,mt.target};yn[115]=()=>new Set(Xr());var f1=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(nt=>nt+"Array");yn[116]=nt=>{let st=nt[0],mt=f1[st];if(!mt)throw new Error("Could not find typed array for code "+st);return new bD[mt](Uint8Array.prototype.slice.call(nt,1).buffer)};yn[120]=()=>{let nt=Xr();return new RegExp(nt[0],nt[1])};yn[98]=nt=>{let st=(nt[0]<<24)+(nt[1]<<16)+(nt[2]<<8)+nt[3],mt=ne$1;ne$1+=st-4,Zn=[Xr(),Xr()],Zn.position0=0,Zn.position1=0;let gt=ne$1;ne$1=mt;try{return Xr()}finally{ne$1=gt}};yn[255]=nt=>nt.length==4?new Date((nt[0]*16777216+(nt[1]<<16)+(nt[2]<<8)+nt[3])*1e3):nt.length==8?new Date(((nt[0]<<22)+(nt[1]<<14)+(nt[2]<<6)+(nt[3]>>2))/1e6+((nt[3]&3)*4294967296+nt[4]*16777216+(nt[5]<<16)+(nt[6]<<8)+nt[7])*1e3):nt.length==12?new Date(((nt[0]<<24)+(nt[1]<<16)+(nt[2]<<8)+nt[3])/1e6+((nt[4]&128?-281474976710656:0)+nt[6]*1099511627776+nt[7]*4294967296+nt[8]*16777216+(nt[9]<<16)+(nt[10]<<8)+nt[11])*1e3):new Date("invalid");function SD(nt){let st=gl,mt=ne$1,gt=us,_t=xo,Et=ml,At=pa,Rt=Zn,Ft=new Uint8Array(qe$1.slice(0,gl)),Nt=Qt,Bt=Qt.slice(0,Qt.length),Gt=_n,dr=Fh,Mr=nt();return gl=st,ne$1=mt,us=gt,xo=_t,ml=Et,pa=At,Zn=Rt,qe$1=Ft,Fh=dr,Qt=Nt,Qt.splice(0,Qt.length,...Bt),_n=Gt,nr=new DataView(qe$1.buffer,qe$1.byteOffset,qe$1.byteLength),Mr}function yv(){qe$1=null,pa=null,Qt=null}function wD(nt){nt.unpack?yn[nt.type]=nt.unpack:yn[nt.type]=nt}var xv=new Array(147);for(let nt=0;nt<256;nt++)xv[nt]=+("1e"+Math.floor(45.15-nt*.30103));var bv=new bo({useRecords:!1});bv.unpack;bv.unpackMultiple;bv.unpack;var _q=new Float32Array(1);new Uint8Array(_q.buffer,0,4);var wv;try{wv=new TextEncoder}catch{}var Av,m1,Ev=typeof Buffer<"u",p1=Ev?Buffer.allocUnsafeSlow:Uint8Array,TD=Ev?Buffer:Uint8Array,AD=Ev?4294967296:2144337920,Se$1,ti,he$1=0,So$1,wo=null,Dq=/[\u0080-\uFFFF]/,zp=Symbol("record-id"),Dc=class extends bo{constructor(nt){super(nt),this.offset=0;let st,mt,gt,_t,Et,At=0,Rt=TD.prototype.utf8Write?function(un,es,kn){return Se$1.utf8Write(un,es,kn)}:wv&&wv.encodeInto?function(un,es){return wv.encodeInto(un,Se$1.subarray(es)).written}:!1,Ft=this;nt||(nt={});let Nt=nt&&nt.sequential,Bt=nt.structures||nt.saveStructures,Gt=nt.maxSharedStructures;if(Gt==null&&(Gt=Bt?32:0),Gt>8160)throw new Error("Maximum maxSharedStructure is 8160");let dr=nt.maxOwnStructures;dr==null&&(dr=Bt?32:64),Nt&&!nt.saveStructures&&(this.structures=[]);let Mr=Gt>32||dr+Gt>64,Tr=Gt+64,zr=Gt+dr+64;if(zr>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let Fr=[],Nr=0,tn=0;this.pack=this.encode=function(un,es){if(Se$1||(Se$1=new p1(8192),ti=new DataView(Se$1.buffer,0,8192),he$1=0),So$1=Se$1.length-10,So$1-he$1<2048?(Se$1=new p1(Se$1.length),ti=new DataView(Se$1.buffer,0,Se$1.length),So$1=Se$1.length-10,he$1=0):he$1=he$1+7&2147483640,st=he$1,Et=Ft.structuredClone?new Map:null,Ft.bundleStrings?(wo=["",""],Se$1[he$1++]=214,Se$1[he$1++]=98,wo.position=he$1-st,he$1+=4):wo=null,mt=Ft.structures,mt){mt.uninitialized&&(mt=Ft._mergeStructures(Ft.getStructures()));let kn=mt.sharedLength||0;if(kn>Gt)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+mt.sharedLength);if(!mt.transitions){mt.transitions=Object.create(null);for(let ts=0;ts<kn;ts++){let Ko=mt[ts];if(!Ko)continue;let ds,Il=mt.transitions;for(let ru=0,uu=Ko.length;ru<uu;ru++){let p0=Ko[ru];ds=Il[p0],ds||(ds=Il[p0]=Object.create(null)),Il=ds}Il[zp]=ts+64}At=kn}Nt||(mt.nextId=kn+64)}gt&&(gt=!1),_t=mt||[];try{if(rn(un),wo){ti.setUint32(wo.position+st,he$1-wo.position-st);let kn=wo;wo=null,rn(kn[0]),rn(kn[1])}if(Ft.offset=he$1,Et&&Et.idsToInsert){he$1+=Et.idsToInsert.length*6,he$1>So$1&&$n(he$1),Ft.offset=he$1;let kn=Oq(Se$1.subarray(st,he$1),Et.idsToInsert);return Et=null,kn}return es&PD?(Se$1.start=st,Se$1.end=he$1,Se$1):Se$1.subarray(st,he$1)}finally{if(mt){if(tn<10&&tn++,Nr>1e4)mt.transitions=null,tn=0,Nr=0,Fr.length>0&&(Fr=[]);else if(Fr.length>0&&!Nt){for(let kn=0,ts=Fr.length;kn<ts;kn++)Fr[kn][zp]=0;Fr=[]}if(gt&&Ft.saveStructures){let kn=mt.sharedLength||Gt;mt.length>kn&&(mt=mt.slice(0,kn));let ts=Se$1.subarray(st,he$1);return Ft.saveStructures(mt,At)===!1?(Ft._mergeStructures(Ft.getStructures()),Ft.pack(un)):(At=kn,ts)}}es&Uq&&(he$1=st)}};let rn=un=>{he$1>So$1&&(Se$1=$n(he$1));var es=typeof un,kn;if(es==="string"){let ts=un.length;if(wo&&ts>=8&&ts<4096){let Il=Dq.test(un);wo[Il?0:1]+=un,Se$1[he$1++]=193,rn(Il?-ts:ts);return}let Ko;ts<32?Ko=1:ts<256?Ko=2:ts<65536?Ko=3:Ko=5;let ds=ts*3;if(he$1+ds>So$1&&(Se$1=$n(he$1+ds)),ts<64||!Rt){let Il,ru,uu,p0=he$1+Ko;for(Il=0;Il<ts;Il++)ru=un.charCodeAt(Il),ru<128?Se$1[p0++]=ru:ru<2048?(Se$1[p0++]=ru>>6|192,Se$1[p0++]=ru&63|128):(ru&64512)===55296&&((uu=un.charCodeAt(Il+1))&64512)===56320?(ru=65536+((ru&1023)<<10)+(uu&1023),Il++,Se$1[p0++]=ru>>18|240,Se$1[p0++]=ru>>12&63|128,Se$1[p0++]=ru>>6&63|128,Se$1[p0++]=ru&63|128):(Se$1[p0++]=ru>>12|224,Se$1[p0++]=ru>>6&63|128,Se$1[p0++]=ru&63|128);kn=p0-he$1-Ko}else kn=Rt(un,he$1+Ko,ds);kn<32?Se$1[he$1++]=160|kn:kn<256?(Ko<2&&Se$1.copyWithin(he$1+2,he$1+1,he$1+1+kn),Se$1[he$1++]=217,Se$1[he$1++]=kn):kn<65536?(Ko<3&&Se$1.copyWithin(he$1+3,he$1+2,he$1+2+kn),Se$1[he$1++]=218,Se$1[he$1++]=kn>>8,Se$1[he$1++]=kn&255):(Ko<5&&Se$1.copyWithin(he$1+5,he$1+3,he$1+3+kn),Se$1[he$1++]=219,ti.setUint32(he$1,kn),he$1+=4),he$1+=kn}else if(es==="number")if(un>>>0===un)un<64?Se$1[he$1++]=un:un<256?(Se$1[he$1++]=204,Se$1[he$1++]=un):un<65536?(Se$1[he$1++]=205,Se$1[he$1++]=un>>8,Se$1[he$1++]=un&255):(Se$1[he$1++]=206,ti.setUint32(he$1,un),he$1+=4);else if(un>>0===un)un>=-32?Se$1[he$1++]=256+un:un>=-128?(Se$1[he$1++]=208,Se$1[he$1++]=un+256):un>=-32768?(Se$1[he$1++]=209,ti.setInt16(he$1,un),he$1+=2):(Se$1[he$1++]=210,ti.setInt32(he$1,un),he$1+=4);else{let ts;if((ts=this.useFloat32)>0&&un<4294967296&&un>=-2147483648){Se$1[he$1++]=202,ti.setFloat32(he$1,un);let Ko;if(ts<4||(Ko=un*xv[(Se$1[he$1]&127)<<1|Se$1[he$1+1]>>7])>>0===Ko){he$1+=4;return}else he$1--}Se$1[he$1++]=203,ti.setFloat64(he$1,un),he$1+=8}else if(es==="object")if(!un)Se$1[he$1++]=192;else{if(Et){let Ko=Et.get(un);if(Ko){if(!Ko.id){let ds=Et.idsToInsert||(Et.idsToInsert=[]);Ko.id=ds.push(Ko)}Se$1[he$1++]=214,Se$1[he$1++]=112,ti.setUint32(he$1,Ko.id),he$1+=4;return}else Et.set(un,{offset:he$1-st})}let ts=un.constructor;if(ts===Object)Tn(un,!0);else if(ts===Array){kn=un.length,kn<16?Se$1[he$1++]=144|kn:kn<65536?(Se$1[he$1++]=220,Se$1[he$1++]=kn>>8,Se$1[he$1++]=kn&255):(Se$1[he$1++]=221,ti.setUint32(he$1,kn),he$1+=4);for(let Ko=0;Ko<kn;Ko++)rn(un[Ko])}else if(ts===Map){kn=un.size,kn<16?Se$1[he$1++]=128|kn:kn<65536?(Se$1[he$1++]=222,Se$1[he$1++]=kn>>8,Se$1[he$1++]=kn&255):(Se$1[he$1++]=223,ti.setUint32(he$1,kn),he$1+=4);for(let[Ko,ds]of un)rn(Ko),rn(ds)}else{for(let Ko=0,ds=Av.length;Ko<ds;Ko++){let Il=m1[Ko];if(un instanceof Il){let ru=Av[Ko];if(ru.write){ru.type&&(Se$1[he$1++]=212,Se$1[he$1++]=ru.type,Se$1[he$1++]=0),rn(ru.write.call(this,un));return}let uu=Se$1,p0=ti,X1=he$1;Se$1=null;let q0;try{q0=ru.pack.call(this,un,W0=>(Se$1=uu,uu=null,he$1+=W0,he$1>So$1&&$n(he$1),{target:Se$1,targetView:ti,position:he$1-W0}),rn)}finally{uu&&(Se$1=uu,ti=p0,he$1=X1,So$1=Se$1.length-10)}q0&&(q0.length+he$1>So$1&&$n(q0.length+he$1),he$1=Iq(q0,Se$1,he$1,ru.type));return}}Tn(un,!un.hasOwnProperty)}}else if(es==="boolean")Se$1[he$1++]=un?195:194;else if(es==="bigint"){if(un<BigInt(1)<<BigInt(63)&&un>=-(BigInt(1)<<BigInt(63)))Se$1[he$1++]=211,ti.setBigInt64(he$1,un);else if(un<BigInt(1)<<BigInt(64)&&un>0)Se$1[he$1++]=207,ti.setBigUint64(he$1,un);else if(this.largeBigIntToFloat)Se$1[he$1++]=203,ti.setFloat64(he$1,Number(un));else throw new RangeError(un+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");he$1+=8}else if(es==="undefined")this.encodeUndefinedAsNil?Se$1[he$1++]=192:(Se$1[he$1++]=212,Se$1[he$1++]=0,Se$1[he$1++]=0);else if(es==="function")rn(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+es)},Tn=this.useRecords===!1?this.variableMapSize?un=>{let es=Object.keys(un),kn=es.length;kn<16?Se$1[he$1++]=128|kn:kn<65536?(Se$1[he$1++]=222,Se$1[he$1++]=kn>>8,Se$1[he$1++]=kn&255):(Se$1[he$1++]=223,ti.setUint32(he$1,kn),he$1+=4);let ts;for(let Ko=0;Ko<kn;Ko++)rn(ts=es[Ko]),rn(un[ts])}:(un,es)=>{Se$1[he$1++]=222;let kn=he$1-st;he$1+=2;let ts=0;for(let Ko in un)(es||un.hasOwnProperty(Ko))&&(rn(Ko),rn(un[Ko]),ts++);Se$1[kn+++st]=ts>>8,Se$1[kn+st]=ts&255}:un=>{let es=Object.keys(un),kn,ts=_t.transitions||(_t.transitions=Object.create(null)),Ko=0;for(let Il=0,ru=es.length;Il<ru;Il++){let uu=es[Il];kn=ts[uu],kn||(kn=ts[uu]=Object.create(null),Ko++),ts=kn}let ds=ts[zp];if(ds)ds>=96&&Mr?(Se$1[he$1++]=((ds-=96)&31)+96,Se$1[he$1++]=ds>>5):Se$1[he$1++]=ds;else{ds=_t.nextId,ds||(ds=64),ds<Tr&&this.shouldShareStructure&&!this.shouldShareStructure(es)?(ds=_t.nextOwnId,ds<zr||(ds=Tr),_t.nextOwnId=ds+1):(ds>=zr&&(ds=Tr),_t.nextId=ds+1);let Il=es.highByte=ds>=96&&Mr?ds-96>>5:-1;ts[zp]=ds,_t[ds-64]=es,ds<Tr?(es.isShared=!0,_t.sharedLength=ds-63,gt=!0,Il>=0?(Se$1[he$1++]=(ds&31)+96,Se$1[he$1++]=Il):Se$1[he$1++]=ds):(Il>=0?(Se$1[he$1++]=213,Se$1[he$1++]=114,Se$1[he$1++]=(ds&31)+96,Se$1[he$1++]=Il):(Se$1[he$1++]=212,Se$1[he$1++]=114,Se$1[he$1++]=ds),Ko&&(Nr+=tn*Ko),Fr.length>=dr&&(Fr.shift()[zp]=0),Fr.push(ts),rn(es))}for(let Il=0,ru=es.length;Il<ru;Il++)rn(un[es[Il]])},$n=un=>{let es;if(un>16777216){if(un-st>AD)throw new Error("Packed buffer would be larger than maximum buffer size");es=Math.min(AD,Math.round(Math.max((un-st)*(un>67108864?1.25:2),4194304)/4096)*4096)}else es=(Math.max(un-st<<2,Se$1.length-1)>>12)+1<<12;let kn=new p1(es);return ti=new DataView(kn.buffer,0,es),Se$1.copy?Se$1.copy(kn,0,st,un):kn.set(Se$1.slice(st,un)),he$1-=st,st=0,So$1=kn.length-10,Se$1=kn}}useBuffer(nt){Se$1=nt,ti=new DataView(Se$1.buffer,Se$1.byteOffset,Se$1.byteLength),he$1=0}};m1=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Up];Av=[{pack(nt,st,mt){let gt=nt.getTime()/1e3;if((this.useTimestamp32||nt.getMilliseconds()===0)&&gt>=0&&gt<4294967296){let{target:_t,targetView:Et,position:At}=st(6);_t[At++]=214,_t[At++]=255,Et.setUint32(At,gt)}else if(gt>0&&gt<17179869184){let{target:_t,targetView:Et,position:At}=st(10);_t[At++]=215,_t[At++]=255,Et.setUint32(At,nt.getMilliseconds()*4e6+(gt/1e3/4294967296>>0)),Et.setUint32(At+4,gt)}else if(isNaN(gt)){if(this.onInvalidDate)return st(0),mt(this.onInvalidDate());let{target:_t,targetView:Et,position:At}=st(3);_t[At++]=212,_t[At++]=255,_t[At++]=255}else{let{target:_t,targetView:Et,position:At}=st(15);_t[At++]=199,_t[At++]=12,_t[At++]=255,Et.setUint32(At,nt.getMilliseconds()*1e6),Et.setBigInt64(At+4,BigInt(Math.floor(gt)))}}},{pack(nt,st,mt){let gt=Array.from(nt),{target:_t,position:Et}=st(this.structuredClone?3:0);this.structuredClone&&(_t[Et++]=212,_t[Et++]=115,_t[Et++]=0),mt(gt)}},{pack(nt,st,mt){let{target:gt,position:_t}=st(this.structuredClone?3:0);this.structuredClone&&(gt[_t++]=212,gt[_t++]=101,gt[_t++]=0),mt([nt.name,nt.message])}},{pack(nt,st,mt){let{target:gt,position:_t}=st(this.structuredClone?3:0);this.structuredClone&&(gt[_t++]=212,gt[_t++]=120,gt[_t++]=0),mt([nt.source,nt.flags])}},{pack(nt,st){this.structuredClone?ED(nt,16,st):MD(Ev?Buffer.from(nt):new Uint8Array(nt),st)}},{pack(nt,st){let mt=nt.constructor;mt!==TD&&this.structuredClone?ED(nt,f1.indexOf(mt.name),st):MD(nt,st)}},{pack(nt,st){let{target:mt,position:gt}=st(1);mt[gt]=193}}];function ED(nt,st,mt,gt){let _t=nt.byteLength;if(_t+1<256){var{target:Et,position:At}=mt(4+_t);Et[At++]=199,Et[At++]=_t+1}else if(_t+1<65536){var{target:Et,position:At}=mt(5+_t);Et[At++]=200,Et[At++]=_t+1>>8,Et[At++]=_t+1&255}else{var{target:Et,position:At,targetView:Rt}=mt(7+_t);Et[At++]=201,Rt.setUint32(At,_t+1),At+=4}Et[At++]=116,Et[At++]=st,Et.set(new Uint8Array(nt.buffer,nt.byteOffset,nt.byteLength),At)}function MD(nt,st){let mt=nt.byteLength;var gt,_t;if(mt<256){var{target:gt,position:_t}=st(mt+2);gt[_t++]=196,gt[_t++]=mt}else if(mt<65536){var{target:gt,position:_t}=st(mt+3);gt[_t++]=197,gt[_t++]=mt>>8,gt[_t++]=mt&255}else{var{target:gt,position:_t,targetView:Et}=st(mt+5);gt[_t++]=198,Et.setUint32(_t,mt),_t+=4}gt.set(nt,_t)}function Iq(nt,st,mt,gt){let _t=nt.length;switch(_t){case 1:st[mt++]=212;break;case 2:st[mt++]=213;break;case 4:st[mt++]=214;break;case 8:st[mt++]=215;break;case 16:st[mt++]=216;break;default:_t<256?(st[mt++]=199,st[mt++]=_t):_t<65536?(st[mt++]=200,st[mt++]=_t>>8,st[mt++]=_t&255):(st[mt++]=201,st[mt++]=_t>>24,st[mt++]=_t>>16&255,st[mt++]=_t>>8&255,st[mt++]=_t&255)}return st[mt++]=gt,st.set(nt,mt),mt+=_t,mt}function Oq(nt,st){let mt,gt=st.length*6,_t=nt.length-gt;for(st.sort((Et,At)=>Et.offset>At.offset?1:-1);mt=st.pop();){let Et=mt.offset,At=mt.id;nt.copyWithin(Et+gt,Et,_t),gt-=6;let Rt=Et+gt;nt[Rt++]=214,nt[Rt++]=105,nt[Rt++]=At>>24,nt[Rt++]=At>>16&255,nt[Rt++]=At>>8&255,nt[Rt++]=At&255,_t=Et}return nt}function yl(nt){if(nt.Class){if(!nt.pack&&!nt.write)throw new Error("Extension has no pack or write function");if(nt.pack&&!nt.type)throw new Error("Extension has no type (numeric code to identify the extension)");m1.unshift(nt.Class),Av.unshift(nt)}wD(nt)}var CD=new Dc({useRecords:!1});CD.pack;CD.pack;var PD=512,Uq=1024,_D=new Dc({structuredClone:!0});yl({Class:Ke$1.prototype.constructor,type:1,write(nt){return{...nt}},read(nt){return Object.setPrototypeOf(nt,Ke$1.prototype),nt}});yl({Class:Ue$1.prototype.constructor,type:2,write(nt){return[...nt]},read(nt){return Object.setPrototypeOf(nt,Ue$1.prototype),nt}});yl({Class:gr.prototype.constructor,type:3,write(nt){return[...nt]},read(nt){return Object.setPrototypeOf(nt,gr.prototype),nt}});yl({Class:Fp.prototype.constructor,type:4,write(nt){return nt.id},read(nt){return new Fp(nt)}});yl({Class:Vp.prototype.constructor,type:5,write(nt){return nt.data},read(nt){return new Vp(nt)}});yl({Class:yr.prototype.constructor,type:6,write(nt){return{...nt}},read(nt){return Object.setPrototypeOf(nt,yr.prototype),nt}});function zq(nt){var st=0;if(nt.length===0)return st;for(let mt=0;mt<nt.length;mt++){let gt=nt[mt];st=(st<<5)-st+gt,st=st&st}return st}function g1(nt){if(Ih(nt))return nt;if(Array.isArray(nt))return nt.map(g1);if(typeof nt=="object"&&nt!==null){let st={};for(let mt of Object.keys(nt).sort())st[mt]=g1(nt[mt]);return Object.setPrototypeOf(st,Object.getPrototypeOf(nt)),st}else return nt}var Mv;(nt=>{function st(_t){return _D.pack(_t)}nt.serialize=st;function mt(_t){return _D.unpack(_t)}nt.deserialize=mt;function gt(_t){return zq(st(g1(_t))).toString()}nt.checksum=gt})(Mv||(Mv={}));var DD;(nt=>{function st(gt){return gt.type==="Conditional"?gt.condition.type==="Distance"?"Distance":"StateChange":gt.type}nt.toEventUIType=st;function mt(gt){return gt==="Distance"||gt==="StateChange"?"Conditional":gt}nt.fromEventUIType=mt})(DD||(DD={}));function v1(nt){return nt==="MouseDown"||nt==="MouseUp"||nt==="KeyDown"||nt==="KeyUp"||nt==="Collision"||nt==="Trigger"}var Yi={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],API:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],WEBHOOK:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"]},ID;(nt=>{function st(gt){return gt.type==="MouseDown"||gt.type==="MouseUp"||gt.type==="MousePress"||gt.type==="KeyDown"||gt.type==="KeyUp"||gt.type==="KeyPress"}nt.is=st;function mt(gt){return gt==="MouseDown"||gt==="MouseUp"||gt==="MousePress"?{type:gt,mode:"Object",disabled:!1,actions:new Ue$1}:{type:gt,disabled:!1,key:void 0,actions:new Ue$1}}nt.defaultData=mt})(ID||(ID={}));var Tv;(nt=>{function st(mt){return{type:"Property",value:[mt??null,"position","x"]}}nt.propertyDefaultData=st,nt.valueDefaultData={type:"Literal",value:0}})(Tv||(Tv={}));var y1;(nt=>{function st(_t){return{type:"Comparison",operator:"==",lOperand:Tv.propertyDefaultData(_t),rOperand:{...Tv.valueDefaultData}}}nt.comparisonDefaultData=st;function mt(_t){return{type:"Distance",toObject:_t??null,fromObject:_t??null,distance:200}}nt.distanceDefaultData=mt;function gt(_t,Et){return{type:"State",object:_t??null,state:Et??null}}nt.stateDefaultData=gt})(y1||(y1={}));var OD;(nt=>{function st(mt){return mt.find(gt=>gt==="ifActions"||gt==="elseActions")!==void 0}nt.isConditionalSubActions=st})(OD||(OD={}));var RD;(nt=>{function st(gt){return gt.type==="Conditional"}nt.is=st;function mt(gt){return{type:"Conditional",disabled:!1,inActions:new Ue$1,outActions:new Ue$1,condition:y1.distanceDefaultData(gt)}}nt.defaultData=mt})(RD||(RD={}));var LD;(nt=>nt.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new Ue$1,drop:new Ue$1}})(LD||(LD={}));var Cv;(nt=>nt.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new Ue$1})(Cv||(Cv={}));var Pv;(nt=>nt.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(Pv||(Pv={}));var BD;(nt=>{function st(gt){return gt.type==="MouseHover"}nt.is=st;function mt(){return{type:"MouseHover",disabled:!1,actions:new Ue$1}}nt.defaultData=mt})(BD||(BD={}));var ND;(nt=>{function st(gt){return gt.type==="Scroll"}nt.is=st;function mt(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new Ue$1}}nt.defaultData=mt})(ND||(ND={}));var FD;(nt=>{function st(gt){return gt.type==="Start"}nt.is=st;function mt(){return{type:"Start",disabled:!1,actions:new Ue$1}}nt.defaultData=mt})(FD||(FD={}));var VD;(nt=>{function st(gt){return gt.type==="Collision"}nt.is=st;function mt(){return{type:"Collision",disabled:!1,target:"character",actions:new Ue$1}}nt.defaultData=mt})(VD||(VD={}));var UD;(nt=>{function st(gt){return gt.type==="Trigger"}nt.is=st;function mt(gt,_t){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new Ue$1,triggerZone:"box",position:_t.toArray(),rotation:[0,0,0],size:gt.toArray(),radius:gt.length()/2,helperVisible:!0}}nt.defaultData=mt})(UD||(UD={}));var _v;(nt=>{nt.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function st(At){return At.type==="Resize"}nt.is=st;function mt(At){return typeof At=="string"?At:"custom"}nt.sizeToDevice=mt;function gt(At){return typeof At=="string"?[...nt.defaultSizes[At]]:[...At]}nt.deviceToSize=gt;function _t(){let At={size:"mobile",operator:"<",actions:new Ue$1},Rt={size:"tablet",operator:"<",actions:new Ue$1},Ft={size:[...nt.defaultSizes.custom],operator:"<>",actions:new Ue$1},Nt=new Ue$1;return Nt.push({id:we$1.generateUUID(),fi:0,data:At},{id:we$1.generateUUID(),fi:1,data:Rt},{id:we$1.generateUUID(),fi:2,data:Ft}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:Nt}}nt.defaultData=_t;function Et(){return{size:[...nt.defaultSizes.custom],operator:"<>",actions:new Ue$1}}nt.defaultBreakpointData=Et})(_v||(_v={}));var Dv;(nt=>{nt.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]};function st(gt){return gt.type==="VariableChange"}nt.is=st;function mt(){return{disabled:!1,type:"VariableChange",actions:new Ue$1,variableId:"",objectId:null,property:"Position X"}}nt.defaultData=mt})(Dv||(Dv={}));var zD;(nt=>{function st(gt){return gt.type==="API"}nt.is=st;function mt(){return{disabled:!1,type:"API",successActions:new Ue$1,errorActions:new Ue$1,userAPIId:""}}nt.defaultData=mt})(zD||(zD={}));var kD;(nt=>{function st(gt){return gt.type==="WEBHOOK"}nt.is=st;function mt(){return{disabled:!1,type:"WEBHOOK",actions:new Ue$1,userWebhookId:""}}nt.defaultData=mt})(kD||(kD={}));var hs="personal camera",xl="a218fcc3-276b-49b9-b485-49037fd14f5f",WD=2960946,ii=5526619,Fs;(nt=>{function st(Tr,zr){return Tr[0]===zr[0]&&Tr[1]===zr[1]}nt.isEqual=st;function mt(Tr,zr,Fr){return[Tr[0]+(zr[0]-Tr[0])*Fr,Tr[1]+(zr[1]-Tr[1])*Fr]}nt.lerp=mt;function gt(Tr,zr){return[Tr[0]+zr[0],Tr[1]+zr[1]]}nt.add=gt;function _t(Tr,zr){return[Tr[0]-zr[0],Tr[1]-zr[1]]}nt.sub=_t;function Et(Tr,zr){return[Tr[0]*zr[0],Tr[1]*zr[1]]}nt.multiply=Et;function At(Tr,zr){return[Tr[0]/zr[0],Tr[1]/zr[1]]}nt.divide=At;function Rt(Tr,zr){return Math.pow(zr[0]-Tr[0],2)+Math.pow(zr[1]-Tr[1],2)}nt.distanceSquared=Rt;function Ft(Tr,zr){return Math.sqrt(Rt(Tr,zr))}nt.distance=Ft;function Nt(Tr,zr){return Tr[0]*zr[0]+Tr[1]*zr[1]}nt.dot=Nt;function Bt(Tr,zr){return[Tr[0]*zr,Tr[1]*zr]}nt.scalarMultiply=Bt;function Gt(Tr,zr,Fr){let Nr=nt.sub(zr,Tr),tn=nt.sub(Fr,Tr),rn=nt.dot(Nr,tn)/nt.dot(Nr,Nr),Tn=nt.scalarMultiply(Nr,rn);return nt.add(Tr,Tn)}nt.projectionOnto=Gt;function dr(Tr,zr,Fr){return Ft(Tr,Gt(Tr,zr,Fr))}nt.projectionOntoDistance=dr;function Mr(Tr,zr){return[(Tr[0]+zr[0])*.5,(Tr[1]+zr[1])*.5]}nt.center=Mr})(Fs||(Fs={}));var Ao;(nt=>{function st(Ft,Nt){return Ft[0]===Nt[0]&&Ft[1]===Nt[1]&&Ft[2]===Nt[2]}nt.isEqual=st;function mt(Ft,Nt){return[Ft[0]+Nt[0],Ft[1]+Nt[1],Ft[2]+Nt[2]]}nt.add=mt;function gt(Ft,Nt){return[Ft[0]-Nt[0],Ft[1]-Nt[1],Ft[2]-Nt[2]]}nt.sub=gt;function _t(Ft,Nt){return[Ft[0]/Nt[0],Ft[1]/Nt[1],Ft[2]/Nt[2]]}nt.div=_t;function Et(Ft,Nt){return[Ft[0]*Nt[0],Ft[1]*Nt[1],Ft[2]*Nt[2]]}nt.mul=Et;function At(Ft,Nt){return Math.hypot(Ft[0]-Nt[0],Ft[1]-Nt[1],Ft[2]-Nt[2])}nt.dist=At;function Rt(Ft,Nt,Bt){return[Ft[0]+(Nt[0]-Ft[0])*Bt,Ft[1]+(Nt[1]-Ft[1])*Bt,Ft[2]+(Nt[2]-Ft[2])*Bt]}nt.lerp=Rt})(Ao||(Ao={}));var kp;(nt=>{function st(gt,_t){return gt[0]===_t[0]&&gt[1]===_t[1]&&gt[2]===_t[2]&&gt[3]===_t[3]}nt.isEqual=st;function mt(gt,_t,Et){return[gt[0]+(_t[0]-gt[0])*Et,gt[1]+(_t[1]-gt[1])*Et,gt[2]+(_t[2]-gt[2])*Et,gt[3]+(_t[3]-gt[3])*Et]}nt.lerp=mt})(kp||(kp={}));var GD;(nt=>{let st=180/Math.PI,mt=Math.PI/180;function gt(Rt){return typeof Rt=="number"?Rt*st:Rt}function _t(Rt){return typeof Rt=="number"?Rt*mt:Rt}function Et(Rt){return[gt(Rt[0]),gt(Rt[1]),gt(Rt[2])]}nt.radToDeg=Et;function At(Rt){return[_t(Rt[0]),_t(Rt[1]),_t(Rt[2])]}nt.degToRad=At})(GD||(GD={}));var vl;(nt=>{nt.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function st(_t,Et){for(let At=0;At<16;At++)if(_t[At]!==Et[At])return!1;return!0}nt.isEqual=st;function mt(_t){return _t??nt.identity}nt.simplify=mt;function gt(_t,Et){let At=Et.slice(0);for(var Rt=0,Ft=Et.length;Rt<Ft;Rt+=3){let Nt=_t[3]*Et[Rt]+_t[7]*Et[Rt+1]+_t[11]*Et[Rt+2]+_t[15];At[Rt]=(_t[0]*Et[Rt]+_t[4]*Et[Rt+1]+_t[8]*Et[Rt+2]+_t[12])/Nt,At[Rt+1]=(_t[1]*Et[Rt]+_t[5]*Et[Rt+1]+_t[9]*Et[Rt+2]+_t[13])/Nt,At[Rt+2]=(_t[2]*Et[Rt]+_t[6]*Et[Rt+1]+_t[10]*Et[Rt+2]+_t[14])/Nt}return At}nt.applyMatrix4=gt})(vl||(vl={}));var ri;(nt=>{function st(Nt){return typeof Nt=="object"&&typeof Nt.r=="number"&&typeof Nt.g=="number"&&typeof Nt.b=="number"}nt.isRGB=st,nt.white={r:1,g:1,b:1},nt.red={r:1,g:0,b:0},nt.black={r:0,g:0,b:0};function mt(Nt){return{r:Math.round(Nt.r*255),g:Math.round(Nt.g*255),b:Math.round(Nt.b*255),a:1}}nt.toRgb255a1=mt;function gt(Nt){return{r:Nt.r,g:Nt.g,b:Nt.b}}nt.clone=gt;function _t(Nt){return Nt=Math.floor(Nt),{r:(Nt>>16&255)/255,g:(Nt>>8&255)/255,b:(Nt&255)/255}}nt.fromHex=_t;function Et(Nt){return Math.round(Nt.r*255)*65536+Math.round(Nt.g*255)*256+Math.round(Nt.b*255)}nt.toHex=Et;function At(Nt,Bt){return Nt.r===Bt.r&&Nt.g===Bt.g&&Nt.b===Bt.b}nt.equals=At;function Rt(Nt,Bt){return Nt.r.toFixed(2)===Bt.r.toFixed(2)&&Nt.g.toFixed(2)===Bt.g.toFixed(2)&&Nt.b.toFixed(2)===Bt.b.toFixed(2)}nt.equalsFixed=Rt;function Ft(Nt,Bt,Gt){return{r:Nt.r+(Bt.r-Nt.r)*Gt,g:Nt.g+(Bt.g-Nt.g)*Gt,b:Nt.b+(Bt.b-Nt.b)*Gt}}nt.lerp=Ft})(ri||(ri={}));var bt$1;(nt=>{nt.white={...ri.white,a:1},nt.transparent={...ri.white,a:0};function st(Ft){return{r:Ft[0],g:Ft[1],b:Ft[2],a:Ft[3]}}nt.from0to1=st;function mt(Ft,Nt){return{...ri.fromHex(Ft),a:Nt}}nt.fromHexAndA=mt;function gt(Ft){return{r:Math.round(Ft.r*255),g:Math.round(Ft.g*255),b:Math.round(Ft.b*255),a:Ft.a}}nt.toRgb255a1=gt;function _t(Ft,Nt){return ri.equals(Ft,Nt)&&Ft.a===Nt.a}nt.equals=_t;function Et(Ft,Nt){return ri.equalsFixed(Ft,Nt)&&Ft.a.toFixed(2)===Nt.a.toFixed(2)}nt.equalsFixed=Et;function At(Ft,Nt,Bt){return{r:Ft.r+(Nt.r-Ft.r)*Bt,g:Ft.g+(Nt.g-Ft.g)*Bt,b:Ft.b+(Nt.b-Ft.b)*Bt,a:Ft.a+(Nt.a-Ft.a)*Bt}}nt.lerp=At;function Rt({r:Ft,g:Nt,b:Bt,a:Gt}=nt.white){return`rgba(${Ft*255}, ${Nt*255}, ${Bt*255}, ${Gt})`}nt.toStyle=Rt})(bt$1||(bt$1={}));var Iv;(nt=>nt.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(Iv||(Iv={}));var jD;(nt=>nt.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(jD||(jD={}));var HD;(nt=>nt.defaultData={control1:[.5,0],control2:[.5,1]})(HD||(HD={}));var ma;(nt=>(nt.linear=[0,0,1,1],nt.ease=[.25,.1,.25,1],nt.easeIn=[.42,0,1,1],nt.easeOut=[0,0,.58,1],nt.easeInOut=[.42,0,.58,1]))(ma||(ma={}));function x1(nt){return typeof nt=="string"&&nt.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(nt):!1}var Vs;(nt=>{nt.all=["PerspectiveCamera","OrthographicCamera"];function st(mt){return nt.all.includes(mt)}nt.is=st})(Vs||(Vs={}));var bl;(nt=>{nt.DefaultUp=[0,1,0],nt.DefaultTargetOffset=1e3,nt.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:nt.DefaultUp,isUpVectorFlipped:!1,targetOffset:nt.DefaultTargetOffset};function st(mt){var gt,_t;return mt.type==="PerspectiveCamera"?((gt=mt.perspective)==null?void 0:gt.zoom)??1:((_t=mt.orthographic)==null?void 0:_t.zoom)??1}nt.getZoom=st})(bl||(bl={}));var Eo;(nt=>{function st(gt,_t=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(gt[0],gt[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[gt[0]+gt[0]*_t,0,0]},grid:{count:[2,2,2],size:gt.map(Et=>Et*(1+_t)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}nt.defaultData=st;function mt(gt,_t){let Et={...gt};if(b1.forEach(At=>{Object.assign(Et,{[At]:_t[At]??gt[At]})}),Et.radial={...gt.radial},_t.radial){let At=gt.radial,Rt=_t.radial;S1.forEach(Ft=>{Object.assign(Et.radial,{[Ft]:Rt[Ft]??At[Ft]})})}if(Et.linear={...gt.linear},_t.linear){let At=gt.linear,Rt=_t.linear;w1.forEach(Ft=>{Object.assign(Et.linear,{[Ft]:Rt[Ft]??At[Ft]})})}if(Et.grid={...gt.grid},_t.grid){let At=gt.grid,Rt=_t.grid;A1.forEach(Ft=>{Object.assign(Et.grid,{[Ft]:Rt[Ft]??At[Ft]})})}if(Et.toObject={...gt.toObject},_t.toObject){let At=gt.toObject,Rt=_t.toObject;E1.forEach(Ft=>{Object.assign(Et.toObject,{[Ft]:Rt[Ft]??At[Ft]})})}if(Et.randomnessObject={...gt.randomnessObject},_t.randomnessObject){let At=gt.randomnessObject,Rt=_t.randomnessObject;M1.forEach(Ft=>{Object.assign(Et.randomnessObject,{[Ft]:Rt[Ft]??At[Ft]})})}return Et}nt.merge=mt})(Eo||(Eo={}));var Ov;(nt=>{nt.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let st=["radial","linear","grid","toObject","randomnessObject"];function mt(gt,_t){let Et=[];gt.count!==void 0&&Et.push({type:0,path:_t,props:{count:gt.count}});for(let At of st){let Rt=gt[At];Rt&&Object.keys(Rt).length>0&&Et.push({type:0,path:[..._t,At],props:Rt})}return Et}nt.toOps=mt})(Ov||(Ov={}));var b1=["count"],S1=["radius","start","end","position","scale","rotation"],w1=["position","scale","rotation"],A1=["count","size"],E1=["count","position","scale","rotation"],M1=["strength","scale","rotation","position","movement","seed","freqScale"],Rv;(nt=>{nt.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function st(mt){return nt.all.includes(mt)}nt.is=st})(Rv||(Rv={}));var Lv;(nt=>{function st(gt){return mt(gt)}nt.defaultData=st;function mt(gt){if(gt==="PointLight")return{type:gt,color:bt$1.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(gt==="SpotLight")return{type:gt,color:bt$1.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(gt==="DirectionalLight")return{type:gt,color:bt$1.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(Lv||(Lv={}));var Vh;(nt=>(nt.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},nt.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},nt.defaultData={renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:nt.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1,...nt.defaultCollisionData}))(Vh||(Vh={}));var Sl;(nt=>nt.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(Sl||(Sl={}));var T1;(nt=>{nt.defaultData={castShadow:!0,receiveShadow:!0};function st(mt,gt){return mt.castShadow===gt.castShadow&&mt.receiveShadow===gt.receiveShadow}nt.equals=st})(T1||(T1={}));var C1;(nt=>{nt.defaultData={flatShading:!1,wireframe:!1,side:0};function st(mt,gt){return mt.flatShading===gt.flatShading&&mt.side===gt.side&&mt.wireframe===gt.wireframe}nt.equals=st})(C1||(C1={}));var Bv;(nt=>nt.defaultData={...C1.defaultData,...T1.defaultData})(Bv||(Bv={}));var qD;(nt=>{function st(mt,gt){var Et,At;let _t=[];if("material"in mt){let Rt=typeof mt.material=="string"?gt.materials[mt.material]??((Et=gt.lib.materials[mt.material])==null?void 0:Et.asset):mt.material;Rt&&_t.push(Rt)}else if("materials"in mt)for(let Rt of mt.materials){let Ft=typeof Rt=="string"?gt.materials[Rt]??((At=gt.lib.materials[Rt])==null?void 0:At.asset):Rt;Ft&&_t.push(Ft)}return _t}nt.getMaterialData=st})(qD||(qD={}));var Uh;(nt=>(nt.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},nt.maxSize=3e7))(Uh||(Uh={}));var YD;(nt=>{function st(mt){return mt==="texture"||mt==="video"||mt==="color"||mt==="depth"||mt==="normal"||mt==="gradient"||mt==="noise"||mt==="fresnel"||mt==="rainbow"||mt==="toon"||mt==="outline"||mt==="particle"||mt==="transmission"||mt==="matcap"||mt==="displace"||mt==="pattern"||mt==="light"}nt.is=st})(YD||(YD={}));function QD(nt){return nt.type!=="displace"}var XD;(nt=>{function st(mt){return mt==="phong"||mt==="toon"||mt==="lambert"||mt==="physical"}nt.is=st})(XD||(XD={}));var Nv=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],KD=["wrapping","image","video","name","minFilter","magFilter"],Gr;(nt=>{function st(Et,At){let{texture:Rt,...Ft}=At;if(Object.assign(Et,Ft),Rt){let Nt=Et.texture;Nt&&Object.assign(Nt,Rt)}}nt.patch=st;function mt(Et,At){return Et==="light"&&At?gt(At):_t(Et)}nt.defaultData=mt;function gt(Et){let At={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(Et){case"phong":return{...At,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...At,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...At,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...At,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function _t(Et){let At={alpha:1,mode:0,isMask:!1,visible:!0};switch(Et){case"texture":return{...At,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"video":return{...At,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:Uh.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"color":return{...At,type:"color",color:ri.fromHex(ii)};case"depth":return{...At,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...At,type:"normal",cnormal:[1,1,1]};case"gradient":return{...At,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...At,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...ri.fromHex(6710886),a:1},colorB:{...ri.fromHex(6710886),a:1},colorC:{...ri.fromHex(16777215),a:1},colorD:{...ri.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...At,type:"fresnel",color:bt$1.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...At,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...At,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:bt$1.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...At,type:"outline",outlineColor:bt$1.fromHexAndA(0,1),contourColor:bt$1.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...At,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}};case"transmission":return{...At,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...At,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...ri.fromHex(0),a:1},colorB:{...ri.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(Gr||(Gr={}));var Qr;(nt=>{function st(Bt){return!Bt.layers.some(Gt=>Gt.data.type==="texture"&&Gt.data.projection!==0||Gt.data.type==="depth"&&!Gt.data.isWorldSpace||Gt.data.type==="noise"||Gt.data.type==="displace")}nt.isMergable=st;function mt(Bt){let Gt="";return Bt.layers.forEach(dr=>{Object.entries(dr.data).forEach(([Mr,Tr])=>{Gt+=`${Mr}${Tr}`,Array.isArray(Tr)?Tr.forEach(zr=>Gt+=`${zr}`):typeof Tr=="object"?Object.values(Tr).forEach(zr=>{typeof zr=="number"?Gt+=`${zr.toFixed(4)}`:Gt+=`${zr}`}):Gt+=`${Tr}`})}),Gt}nt.getHash=mt;function gt(){return{layers:new Ue$1}}nt.defaultEmptyData=gt;function _t(Bt="layer1",Gt="layer2"){return At("phong",Bt,Gt)}nt.defaultData=_t;function Et(Bt,Gt){return{...Bt,name:Gt}}nt.withName=Et;function At(Bt,Gt="layer1",dr="layer2"){let Mr=new Ue$1;return Mr.push({fi:0,data:Gr.defaultData("light",Bt),id:Gt}),Mr.push({fi:1,data:Gr.defaultData("color"),id:dr}),{layers:Mr}}nt.defaultTwoLayerData=At;function Rt(Bt){let Gt=Gr.defaultData("texture");Bt&&Object.assign(Gt.texture,{image:Bt});let dr=new Ue$1;return dr.push({fi:0,data:Gt,id:"layer1"}),dr.push({fi:1,data:{...Gr.defaultData("transmission"),alpha:1},id:"layer2"}),dr.push({fi:2,data:{...Gr.defaultData("light","lambert"),alpha:0},id:"layer3"}),{layers:dr}}nt.defaultUIObjectMaterial=Rt;function Ft(Bt,Gt="phong",dr="layer1",Mr="layer2"){let Tr=Gr.defaultData("texture");Object.assign(Tr.texture,{image:Bt});let zr=new Ue$1;return zr.push({fi:0,data:Tr,id:dr}),zr.push({fi:1,data:Gr.defaultData("light",Gt),id:Mr}),{layers:zr}}nt.defaultTwoLayerTextureData=Ft;function Nt(Bt,Gt="phong",dr="layer1",Mr="layer2"){let Tr=Gr.defaultData("video");Object.assign(Tr.texture,{video:Bt});let zr=new Ue$1;return zr.push({fi:0,data:Tr,id:dr}),zr.push({fi:1,data:Gr.defaultData("light",Gt),id:Mr}),{layers:zr}}nt.defaultTwoLayerVideoTextureData=Nt})(Qr||(Qr={}));var zh;(nt=>{function st(){return{points:new Ue$1,roundness:0,shapeHoles:[],isClosed:!1}}nt.defaultData=st})(zh||(zh={}));var kh;(nt=>{function st(){return{points:new Ue$1,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}nt.defaultData=st})(kh||(kh={}));var P1={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},Fv;(nt=>{function st(mt,gt){let _t={...mt};return _1.forEach(Et=>{Object.assign(_t,{[Et]:gt[Et]??mt[Et]})}),_t}nt.merge=st})(Fv||(Fv={}));var Vv={shape:P1,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},_1=["depth","offset","angle","twist","startScale","endScale"],Gp;(nt=>{function st(gt){return gt==="PolygonGeometry"||gt==="RectangleGeometry"||gt==="StarGeometry"||gt==="TriangleGeometry"||gt==="EllipseGeometry"||gt==="UIGeometry"}nt.is2DParametricMesh=st;function mt(gt){return gt==="PolygonGeometry"||gt==="PolygonGeometry"||gt==="RectangleGeometry"||gt==="StarGeometry"||gt==="TriangleGeometry"||gt==="EllipseGeometry"||gt==="PathGeometry"||gt==="VectorGeometry"||gt==="ConeGeometry"||gt==="CubeGeometry"||gt==="CylinderGeometry"||gt==="DodecahedronGeometry"||gt==="HelixGeometry"||gt==="IcosahedronGeometry"||gt==="LatheGeometry"||gt==="PyramidGeometry"||gt==="SphereGeometry"||gt==="PlaneGeometry"||gt==="BackdropGeometry"||gt==="TorusGeometry"||gt==="TorusKnotGeometry"||gt==="BooleanGeometry"||gt==="TextGeometry"||gt==="InputGeometry"}nt.isParametricMesh=mt})(Gp||(Gp={}));var Uv;(nt=>{function st(mt,gt){let _t={...mt};return Object.assign(_t,gt),_t.type==="PathGeometry"&&"extrusion"in gt&&gt.extrusion&&(_t.extrusion={...mt.extrusion},Object.assign(_t.extrusion,Fv.merge(_t.extrusion,gt.extrusion))),_t}nt.merge=st})(Uv||(Uv={}));var ga;(nt=>{function st(mt){if(mt==="RectangleGeometry")return{width:320,height:320,type:mt,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(mt==="UIGeometry")return{type:mt,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if(mt==="PathGeometry")return{type:mt,width:1,height:1,depth:1,path:kh.defaultData(),extrusion:Vv};if(mt==="VectorGeometry")return{width:1,height:1,type:mt,subdivisions:12,shape:zh.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(mt==="BooleanGeometry")return{type:mt,operation:2,width:0,height:0,depth:0,phongAngle:35};if(mt==="TextGeometry")return{type:mt,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",editable:!1,extrudeBevelSize:0,extrudeBevelSegments:1};if(mt==="InputGeometry")return{...nt.defaultData("TextGeometry"),type:mt,editable:!0};if(mt==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}nt.defaultData=st})(ga||(ga={}));var zv=["width","height","depth"],kv;(nt=>nt.defaultData={enabled:!1,useBackgroundColor:!1,color:ri.white,near:.1,far:2e3})(kv||(kv={}));var Gh;(nt=>{let st={opacity:1,blendFunction:13,enabled:!1};nt.defaultData={enabled:!1,pixelation:{...st,blendFunction:16,granularity:15},bloom:{...st,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...st,offset:[2,2]},vignette:{...st,darkness:1,offset:0},hueSaturation:{...st,hue:3,saturation:0},brightnessContrast:{...st,brightness:.25,contrast:0},depthOfField:{...st,focusDistance:100,focalLength:20,bokehScale:5},noise:{...st,blendFunction:16}}})(Gh||(Gh={}));var D1;(nt=>nt.defaultData={softShadowQuality:"low"})(D1||(D1={}));var I1;(nt=>nt.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(I1||(I1={}));var O1;(nt=>nt.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(O1||(O1={}));var wl;(nt=>nt.defaultData={usePhysics:!1,gravity:-10})(wl||(wl={}));var R1;(nt=>nt.defaultData={playCamera:hs,gameControlObject:null})(R1||(R1={}));var Gv;(nt=>nt.defaultData={backgroundColor:bt$1.fromHexAndA(WD,1),postprocessing:Gh.defaultData,fog:kv.defaultData,globalPhysics:wl.defaultData,ambient:I1.defaultData,ao:O1.defaultData,shadow:D1.defaultData,publish:R1.defaultData})(Gv||(Gv={}));var jv;(nt=>nt.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95})(jv||(jv={}));var ZD;(nt=>{function st(gt){return gt==="Component"||gt==="Instance"}nt.isComponentRelated=st;function mt(gt){return gt==="Empty"||gt==="Instance"}nt.isEmptyOrComponent=mt})(ZD||(ZD={}));var jh;(nt=>{nt.identity={...Iv.identity,hiddenMatrix:vl.identity};function st(_t){return{position:_t.position,rotation:_t.rotation,scale:_t.scale,hiddenMatrix:_t.hiddenMatrix}}nt.fromObject=st;function mt(_t,Et){return{position:(Et==null?void 0:Et.position)||_t.position,rotation:(Et==null?void 0:Et.rotation)||_t.rotation,scale:(Et==null?void 0:Et.scale)||_t.scale,hiddenMatrix:(Et==null?void 0:Et.hiddenMatrix)||_t.hiddenMatrix}}nt.merge=mt;function gt(_t,Et){return ev({position:Ao.isEqual(_t.position,Et.position)?void 0:Et.position,rotation:Ao.isEqual(_t.rotation,Et.rotation)?void 0:Et.rotation,scale:Ao.isEqual(_t.scale,Et.scale)?null:Et.scale,hiddenMatrix:vl.isEqual(_t.hiddenMatrix,Et.hiddenMatrix)?void 0:Et.hiddenMatrix})}nt.diff=gt})(jh||(jh={}));var vi;(nt=>nt.defaultData={states:new Ue$1,events:new Ue$1,visible:!0,raycastLock:!1,physics:Sl.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...jh.identity,cloner:null})(vi||(vi={}));var Hv;(nt=>nt.defaultData={type:"Empty",...vi.defaultData})(Hv||(Hv={}));var JD;(nt=>nt.defaultData={type:"ParticleCollider",...jv.defaultData,...vi.defaultData})(JD||(JD={}));var $D;(nt=>nt.defaultData={type:"Component",...vi.defaultData})($D||($D={}));var eI;(nt=>nt.defaultData={type:"Particle",...vi.defaultData,...Vh.defaultData})(eI||(eI={}));var Al;(nt=>nt.defaultData={type:"Mesh",...vi.defaultData,...Bv.defaultData})(Al||(Al={}));var Ic;(nt=>nt.defaultData={...vi.defaultData,...jh.identity,position:[0,0,bl.DefaultTargetOffset],...bl.defaultData})(Ic||(Ic={}));var Wv;(nt=>{function st(mt){return{...vi.defaultData,...Lv.defaultData(mt)}}nt.defaultData=st,nt.defaultDirectionalLightData={...nt.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(Wv||(Wv={}));var Hh;(nt=>{function st(gt,_t,Et=0){for(;Et<_t.length;){let At=gt?gt[_t[Et]]:void 0;if(_t.length===Et+1)return At;if(At)gt=At.descendants,Et+=1;else return}}nt.resolveWithDes=st;function mt(gt,_t,Et=0){let At=st(gt,_t,Et);if(At){let Rt=Object.keys(At);if(Rt.length===1&&Rt[0]==="descendants")return}return At}nt.resolve=mt})(Hh||(Hh={}));var Mo;(nt=>{nt.rootOverrideProps=["physics","events"],nt.compositeNonOptionalOverrideProps=["geometry"],nt.compositeEntireOverrideOverrideProps=["material"];function st(gt,_t){return{...vi.defaultData,..._t,component:gt,overrides:new yr,physics:void 0,events:void 0,type:"Instance"}}nt.ofComponent=st;function mt(gt){let _t=jh.fromObject(gt.data);return st(gt.id,_t)}nt.fromComponentData=mt})(Mo||(Mo={}));var ya;(nt=>{nt.defaultData={type:"Page",...vi.defaultData,physics:{...Sl.defaultData,fusedBody:!1},...Gv.defaultData,camera:Ic.defaultData};function st(mt){return mt.uiScene!==void 0}nt.isUIPage=st})(ya||(ya={}));var qv;(nt=>(nt.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:vl.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:Sl.defaultData,states:new Ue$1,events:new Ue$1,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...bl.defaultData},nt.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},nt.defaultMeshObject={name:"Rectangle",...vi.defaultData,...Al.defaultData,geometry:ga.defaultData("RectangleGeometry"),material:Qr.defaultTwoLayerData("phong","layer1","layer2")},nt.defaultBooleanObject={name:"Boolean",...vi.defaultData,...Al.defaultData,geometry:ga.defaultData("BooleanGeometry"),material:Qr.defaultTwoLayerData("phong","layer1","layer2")},nt.defaultTextObject={name:"Text",...vi.defaultData,...Al.defaultData,geometry:ga.defaultData("TextGeometry"),material:Qr.defaultTwoLayerData("phong","layer1","layer2")},nt.defaultInputObject={name:"Input",...vi.defaultData,...Al.defaultData,geometry:ga.defaultData("InputGeometry"),material:Qr.defaultTwoLayerData("phong","layer1","layer2")}))(qv||(qv={}));var va;(nt=>{function st(Et,At){let Rt={name:At};return Et.type==="Mesh"?(Rt.geometry={},"material"in Et&&(Rt.material={layers:new yr}),"materials"in Et&&(Rt.materials=Et.materials.map(Ft=>({layers:new yr})))):Vs.is(Et.type)&&(Rt.perspective={},Rt.orthographic={}),Rt}nt.newEmpty=st;function mt(Et,At){if(At===void 0)return Et;let Rt={...Et};return"material"in Rt&&"material"in At&&At.material&&(Rt.material=pl(Rt.material,Ft=>{if(typeof Ft!="string")for(let[Nt,Bt]of Object.entries(At.material.layers)){let Gt=Ft.layers.data(Nt);Gt&&Gr.patch(Gt,Bt)}}).data),Rt.materials&&At.materials&&(Rt.materials=pl(Rt.materials,Ft=>{var Nt,Bt;for(let Gt=0;Gt<Rt.materials.length;Gt++){let dr=At.materials[Gt];if(typeof dr!="string")for(let[Mr,Tr]of Object.entries(dr.layers)){let zr=(Bt=(Nt=Ft[Gt])==null?void 0:Nt.layers)==null?void 0:Bt.data(Mr);zr&&Gr.patch(zr,Tr)}}}).data),Rt}function gt(Et,At){let Rt,Ft=[],Nt={orthographic:0,perspective:0,geometry:0};function Bt(Gt,dr){for(let[Mr,Tr]of Object.entries(dr.layers)){let{texture:zr,...Fr}=Tr;if(zr!==void 0&&Object.keys(zr).length>0){let Nr={path:[...Gt,"layers",Mr,"texture"],props:zr,type:0};Ft.push(Nr)}if(Object.keys(Fr).length>0){let Nr={path:[...Gt,"layers",Mr],props:Fr,type:0};Ft.push(Nr)}}}for(let[Gt,dr]of Object.entries(At))if(Gt!=="name")if(Gt==="cloner")Ft.push(...Ov.toOps(dr,["cloner"]));else if(Gt==="pathSnapping")Ft.push({path:[Gt],props:{slide:dr.slide,offset:dr.offset},type:0});else if(Gt==="material")Bt(["material"],dr);else if(Gt==="materials")for(let[Mr,Tr]of Object.entries(dr))Bt(["materials",Mr],Tr);else if(Nt[Gt]===0){if(Gt==="geometry"&&dr.extrusion!==void 0){let Mr={path:[Gt,"extrusion"],props:dr.extrusion,type:0};Ft.push(Mr),dr={...dr},delete dr.extrusion}if(Object.keys(dr).length>0){let Mr={path:[Gt],props:dr,type:0};Ft.push(Mr)}}else Rt===void 0&&(Rt={path:[],props:{},type:0},Ft.push(Rt)),Rt.props[Gt]=dr;return Ft}nt.toOps=gt;function _t(Et,At){var Ft,Nt,Bt,Gt,dr,Mr;if(At===void 0)return Et;let Rt={...Et};if(Object.assign(Rt,jh.merge(Rt,At)),Object.assign(Rt,{pathSnapping:Object.assign({},Rt.pathSnapping,{slide:((Ft=At.pathSnapping)==null?void 0:Ft.slide)??((Nt=Rt.pathSnapping)==null?void 0:Nt.slide)??0,offset:((Bt=At.pathSnapping)==null?void 0:Bt.offset)??((Gt=Rt.pathSnapping)==null?void 0:Gt.offset)??0})}),Vs.is(Et.type)){Rt.orthographic={...Rt.orthographic},Rt.perspective={...Rt.perspective};let Tr=At;((dr=Tr.orthographic)==null?void 0:dr.zoom)!==void 0&&(Rt.orthographic.zoom=Tr.orthographic.zoom),((Mr=Tr.perspective)==null?void 0:Mr.zoom)!==void 0&&(Rt.perspective.zoom=Tr.perspective.zoom),Tr.isUpVectorFlipped!==void 0&&(Rt.isUpVectorFlipped=Tr.isUpVectorFlipped),Tr.targetOffset!==void 0&&(Rt.targetOffset=Tr.targetOffset)}else if(Et.type==="Mesh")"geometry"in At&&Object.assign(Rt,{geometry:Uv.merge(Rt.geometry,At.geometry)}),(At.material||At.materials)&&(Rt=mt(Rt,At)),Rt.cloner&&"cloner"in At&&Object.assign(Rt,{cloner:Eo.merge(Rt.cloner,At.cloner)});else if(Et.type==="Empty")Rt.cloner&&"cloner"in At&&Object.assign(Rt,{cloner:Eo.merge(Rt.cloner,At.cloner)});else if(Rv.is(Et.type)){let Tr=At;Tr.intensity!==void 0&&(Rt.intensity=Tr.intensity),Tr.color!==void 0&&(typeof Tr.color=="string"?Rt.color=Tr.color:Rt.color=ri.clone(Tr.color))}return Rt}nt.patch=_t})(va||(va={}));var Wh;(nt=>nt.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(Wh||(Wh={}));var Us;(nt=>nt.defaultData={orbitControls:Wh.defaultData,playPage:xl,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((st,mt)=>{let gt=0,_t=0;return mt<5?_t=-30:mt<10&&(_t=30),mt===0||mt===10||mt===5?gt=30:(mt===4||mt===11||mt===9)&&(gt=-30),[120,[gt,_t],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1,imageQuality:70}},stopRaycast:!0,hdTransmission:!1})(Us||(Us={}));var L1;(nt=>nt.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(L1||(L1={}));var B1;(nt=>nt.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(B1||(B1={}));var xa;(nt=>(nt.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...L1.defaultData},isRandomSeed:!0,seed:nt.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:B1.defaultData}),nt.generateSeed=()=>Math.round(Math.random()*1e5)))(xa||(xa={}));var El;(nt=>{function st(gt){return gt.find(_t=>_t.data.type==="Page"&&_t.data.globalPhysics.usePhysics)!==void 0}nt.physicsEnabled=st;function mt(gt,_t,Et){gt.scene.objects.traverseFrom(_t,(At,Rt)=>{var Ft;if(Rt.type==="Instance"){let Nt=(Ft=qh.getComponentData(gt,Rt.component))==null?void 0:Ft.data;Nt&&Et(At,Rt,Nt.events)}else Et(At,Rt,Rt.events)})}nt.traverseModuleInstances=mt})(El||(El={}));var ba;(nt=>{nt.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",nt.defaultLight={fi:-1,data:Wv.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]};function st(_t=!0,Et=[]){let At=[],Rt=qv.defaultMeshObject;_t&&(At.push({...nt.defaultLight}),At.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:Rt,children:[]})),At.push(...Et);let Ft=new gr;return Ft.push({fi:1,id:xl,data:{...ya.defaultData,name:"Scene 1"},children:At}),Ft}nt.createDefaultObjectTreeWithPage=st,nt.defaultData={objects:st(),publish:Us.defaultData,styles:xa.defaultData()},nt.emptyDataWithoutPage=function(){return{objects:new gr,publish:Us.defaultData,styles:xa.defaultData()}},nt.emptyDataWithPage=function(_t=!0){return{objects:st(_t),publish:Us.defaultData,styles:xa.defaultData()}},nt.emptyData=function(){return{objects:new gr,publish:{...Us.defaultData},styles:xa.defaultData()}};function mt(_t){return{...nt.defaultData,objects:qi(_t,gr.prototype)}}nt.withObjs=mt;function gt(_t,Et){return mt([{id:_t,data:Et,children:[],fi:0}])}nt.withObj=gt})(ba||(ba={}));var Yh;(nt=>nt.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(Yh||(Yh={}));var Yv;(nt=>(nt.defaultData=st=>({url:st,name:"New Webhook",parametersSchemas:new Ue$1}),nt.defaultParameterValueByType=st=>st==="number"?0:st==="boolean"?!1:""))(Yv||(Yv={}));var tI;(nt=>nt.defaultData=(st,mt="GET")=>({url:st,method:mt,name:"New API",headers:new Ue$1,queries:new Ue$1,autoStart:!0}))(tI||(tI={}));var Lr;(nt=>{function st(At){return At.textValue!==void 0}nt.isTextValue=st;function mt(At){return typeof At=="number"}nt.isNumber=mt;function gt(At){return typeof At=="boolean"}nt.isBoolean=gt;function _t(At){return st(At)?"string":gt(At)?"boolean":"number"}nt.typeOfVariable=_t;function Et(At){return nt.isTextValue(At)?Array.isArray(At.textValue)?At.textValue.map(Rt=>Rt.toString().padStart(At.padding??2,"0")).join(At.deliminator??":")+(At.suffix!==void 0?" "+At.suffix:""):At.textValue.toString():nt.isBoolean(At)?At?"True":"False":nt.isNumber(At)?parseFloat(At.toFixed(3)).toString():At.toString()}nt.getDisplayedValue=Et})(Lr||(Lr={}));var N1;(nt=>nt.all=["images","videos","colors","audios","particles","fonts","materials","variables"])(N1||(N1={}));var rI;(nt=>nt.all=[...N1.all,"components"])(rI||(rI={}));var iI;(nt=>{function st(){return{images:new Ke$1,videos:new Ke$1,colors:new Ke$1,audios:new Ke$1,particles:new Ke$1,fonts:new Ke$1,materials:new Ke$1,components:new Ke$1,variables:new Ke$1,userAPIs:new Ke$1,userWebhooks:new Ke$1}}nt.defaultData=st})(iI||(iI={}));var zs;(nt=>{function st(){return{images:new Ke$1,videos:new Ke$1,colors:new Ke$1,audios:new Ke$1,particles:new Ke$1,fonts:new Ke$1,materials:new Ke$1,components:new Ke$1,variables:new Ke$1,userAPIs:new Ke$1,userWebhooks:new Ke$1}}nt.defaultData=st})(zs||(zs={}));var vn;(nt=>{function st(){let At={};return At["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},qi(At,Ke$1.prototype)}nt.defaultColors=st;function mt(){return qi({},Ke$1.prototype)}nt.defaultImages=mt;function gt(){return{catelogs:new Ke$1,materials:new Ke$1,images:new Ke$1,videos:new Ke$1,colors:new Ke$1,audios:new Ke$1,particles:new Ke$1,fonts:new Ke$1,variables:new Ue$1,userAPIs:new Ke$1,userWebhooks:new Ke$1,lib:zs.defaultData()}}nt.emptyData=gt;function _t(At){switch(At){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let Rt=[0,0,0];return{name:"Time",value:{textValue:Rt,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:Rt,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",At)}}nt.defaultVariables=_t;function Et(At,Rt){if(Rt.format==="HH:mm:ss"){let Ft=Math.floor(At/3600),Nt=Math.floor((At-Ft*3600)/60),Bt=Math.round(At-Ft*3600-Nt*60);return{textValue:[Ft,Nt,Bt]}}else if(Rt.format==="mm:ss"){let Ft=Math.floor(At/60),Nt=Math.round(At-Ft*60);return{textValue:[Ft,Nt]}}else return Rt.format==="number"?At=Math.round(At):At=Math.round(At*1e3)/1e3,At}nt.getFormattedTimerTime=Et})(vn||(vn={}));var Xh;(nt=>nt.list=["idle","move","jump","run"])(Xh||(Xh={}));var Qh;(nt=>(nt.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},nt.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX",""],["rotPosY",""],["rotNegX",""],["rotNegY",""],["jump","Space"],["run",""],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:nt.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new Ue$1,move:new Ue$1,jump:new Ue$1,run:new Ue$1},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:bt$1.fromHexAndA(3728051,1)}}))(Qh||(Qh={}));function nI(nt){nt.layers.forEach(st=>{if(st.type==="depth"&&st.colorA!==void 0){let mt=st.colorA,gt=st.colorB,_t=[[mt.r,mt.g,mt.b,mt.a],[gt.r,gt.g,gt.b,gt.a]],Et=[0,1];for(let Rt=2;Rt<10;Rt++)_t.push(_t[1]),Et.push(1);let At={...Pn(kr(st),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,st.near),far:Math.max(0,st.far),colors:_t,steps:Et,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(st,At)}else if(st.type==="depth"&&st.gradientType===1&&(st.near<0||st.far<0)){let mt={...kr(st),near:Math.max(st.near,0),far:Math.max(st.far,0)};Object.assign(st,mt)}})}function Sa(nt,st){Object.values(nt.shared.materials).forEach(mt=>st(mt))}function wa(nt,st){nt.scene.objects.traverse((mt,gt)=>{"materials"in gt?gt.materials.forEach((_t,Et)=>{_t===void 0&&(gt.materials[Et]=Qr.defaultData(),_t=gt.materials[Et]),typeof _t!="string"&&st(_t)}):"material"in gt?typeof gt.material!="string"&&(gt.material===void 0&&(gt.material=Qr.defaultData()),st(gt.material)):gt.type==="Mesh"&&(gt.material===void 0&&(gt.material=Qr.defaultData()),st(gt.material)),"overrides"in gt&&Object.values(gt.overrides).forEach(_t=>{_t.material&&typeof _t.material!="string"&&Object.getPrototypeOf(_t.material)!==yr.prototype&&st(_t.material)})})}function Gq(nt){Object.assign(nt.scene.publish,{orbitControls:{...Wh.defaultData,...kr(nt.scene.publish.orbitControls)}})}function jq(nt){Object.assign(nt.scene.publish.settings,{video:{...Us.defaultData.settings.video,...kr(nt.scene.publish.settings.video)}})}function Hq(nt){function st(mt){if(mt.layers){for(let gt of Object.values(mt.layers))if(gt){for(let[_t,Et]of Object.entries(gt))if((Nv.includes(_t)||typeof Et=="boolean")&&delete gt[_t],_t==="texture")for(let[At,Rt]of Object.entries(Et))(KD.includes(At)||typeof Rt=="boolean")&&delete Et[At]}}}nt.scene.objects.traverse((mt,gt)=>{gt.states.forEach(_t=>{let Et=_t;Et.material?st(Et.material):Et.materials&&Et.materials.forEach(At=>{st(At)})})})}function Wq(nt){nt.scene.publish.withBackground=!0}function qq(nt){nt.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function Yq(nt){nt.scene.objects.traverse((st,mt)=>{let gt=mt.cloner;gt&&(gt.radial.scale=gt.radial.scale.map(_t=>_t+1),gt.linear.scale=gt.linear.scale.map(_t=>_t+1))})}function Xq(nt){nt.scene.objects.traverse((st,mt)=>{let gt=mt.geometry;gt&&(gt.type==="DodecahedronGeometry"||gt.type==="IcosahedronGeometry")&&(gt.detail=Math.round(gt.detail))})}function Qq(nt){nt.scene.objects.traverse((st,mt)=>{let gt=nt.scene.objects.unproxy().parent(st);if(gt){let _t=kr(nt.scene.objects.data(gt));_t&&_t.type==="Mesh"&&_t.geometry.type==="BooleanGeometry"&&mt.type==="Mesh"&&(mt.visible=kr(mt).booleanExclude!==!0)}})}function Kq(nt){nt.scene.objects.traverse((st,mt)=>{if(mt.type==="Mesh"){let gt=mt;mt.geometry.type==="NonParametricGeometry"?gt.material!==void 0&&delete gt.material:gt.materials!==void 0&&delete gt.materials}})}function Zq(nt){function st(gt){Object.setPrototypeOf(gt,yr.prototype),gt.texture&&Object.setPrototypeOf(gt.texture,yr.prototype)}function mt(gt){Object.setPrototypeOf(gt,yr.prototype);for(let _t in gt)st(gt[_t])}nt.scene.objects.traverse((gt,_t)=>{_t.states.forEach(Et=>{let At=Et;if(At.material){let Rt=kr(At.material).layers;mt(Rt),At.material.layers=Rt}if(At.materials)for(let Rt=0;Rt<At.materials.length;Rt++){let Ft=At.materials[Rt],Nt=kr(Ft).layers;mt(Nt),Ft.layers=Nt}})})}function sI(nt){nt.layers===void 0&&Object.assign(nt,Qr.defaultTwoLayerData("lambert"))}function F1(nt){!nt.layers||nt.layers.forEach(st=>{if(st.type==="depth"&&st.colors.length===10){let mt=[...st.colors];mt.push(st.colors[9]);let gt=[...st.steps];gt.push(st.steps[9]);let _t={...kr(st),colors:mt,steps:gt};Object.assign(st,_t)}})}function Jq(nt){nt.scene.objects.traverse((st,mt)=>{mt.type==="Mesh"&&(mt.geometry.type==="BooleanGeometry"||mt.geometry.type==="SubdivGeometry")&&(mt.geometry.phongAngle=35)})}function oI(nt){nt.scene.objects.traverse((st,mt)=>{"materials"in mt?mt.materials.forEach(gt=>{typeof gt!="string"&&F1(gt)}):"material"in mt&&typeof mt.material!="string"&&F1(mt.material)}),Object.values(nt.shared.materials).forEach(st=>F1(st))}function $q(nt){nt.scene.environment.ambientLight.softShadows=!1,nt.scene.environment.ambientLight.softShadowQuality="low",nt.scene.objects.traverse((st,mt)=>{(mt.type==="DirectionalLight"||mt.type==="SpotLight")&&(mt.shadowResolution=1024,mt.shadowRadius=1,mt.depth=1e5)}),nt.shared.penumbraSize=new Array(5).fill(.5)}function e9(nt){nt.shared.audios=qi({},Ke$1.prototype)}function t9(nt){nt.shared.videos=qi({},Ke$1.prototype)}function r9(nt){let st=nt.shared.materials;Object.entries(st).forEach(([mt,gt])=>{if(!gt.layers){let _t={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(st,{[mt]:_t})}})}function i9(nt){Object.entries(kr(nt.shared.images)).filter(st=>st[1].asset===!1).map(st=>st[0]).forEach(st=>{delete nt.shared.images[st]}),Object.entries(kr(nt.shared.audios)).filter(st=>st[1].asset===!1).map(st=>st[0]).forEach(st=>{delete nt.shared.audios[st]})}function n9(nt){nt.scene.publish.settings.web.preload=!1}function aI(nt){nt.layers&&nt.layers.forEach(st=>{st.type==="depth"&&st.num!==void 0&&(st.colors=st.colors.slice(0,st.num),st.steps=st.steps.slice(0,st.num),delete st.num)})}function lI(nt){nt.layers&&nt.layers.forEach(st=>{QD(st)&&st.isMask===void 0&&(st.isMask=!1),(st.type==="texture"||st.type==="video")&&st.blending===void 0&&(st.blending=0),(st.type==="noise"||st.type==="displace"&&st.displacementType==="noise")&&(st.voronoiStyle===void 0&&(st.voronoiStyle=0),st.highCut===void 0&&(st.highCut=1),st.lowCut===void 0&&(st.lowCut=0),st.smoothness===void 0&&(st.smoothness=.3),st.seed===void 0&&(st.seed=0),st.quality===void 0&&(st.quality=1))})}function s9(nt){nt.shared.fonts=qi({},Ke$1.prototype)}function o9(nt){return nt.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(st=>st.charAt(0).toUpperCase()+st.slice(1)).join(" ")}function a9(nt){let st=[];nt.scene.objects.traverse((mt,gt)=>{let _t=gt;if(_t.type==="TextFrame"){let Et=Qr.defaultTwoLayerData("phong"),At=typeof _t.color=="string"?nt.shared.colors[_t.color]:_t.color;Et.layers[1].data.color={r:At.r,g:At.g,b:At.b},Et.layers[1].data.alpha=_t.alpha;let Rt=o9(_t.font);nt.shared.fonts[Rt]===void 0&&(nt.shared.fonts[Rt]={name:Rt});let Ft={name:_t.name,...vi.defaultData,...Al.defaultData,flatShading:!1,wireframe:!1,geometry:{...ga.defaultData("TextGeometry"),width:_t.width,height:_t.height,font:Rt,depth:0,horizontalAlign:_t.horizontalAlign,verticalAlign:_t.verticalAlign,fontSize:_t.fontSize*1.40625,lineHeight:_t.lineHeight/1.40625,letterSpacing:_t.letterSpacing-1,text:_t.text,textTransform:_t.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:Et,states:kr(_t.states),events:kr(_t.events),visible:_t.visible,raycastLock:_t.raycastLock,position:_t.position,rotation:_t.rotation,scale:_t.scale,hiddenMatrix:_t.hiddenMatrix},Nt=kr(nt.scene.objects).parent(mt);nt.scene.objects.insertAfter(Nt??null,mt,[{id:mt+"new",data:Ft,children:[]}]),st.push(mt)}}),st.forEach(mt=>{nt.scene.objects.delete(mt)})}function l9(nt){let st={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};nt.scene.objects.traverse((mt,gt)=>{gt.events.forEach(_t=>{if(st[Number(_t.type)])if(Object.assign(_t,{type:st[Number(_t.type)]}),_t.type==="Audio"&&"audioEvent"in _t&&(Object.assign(_t,{playAudio:_t.audioEvent}),delete _t.audioEvent),_t.type==="GameControl")Object.assign(_t,{gameActions:{idle:new Ue$1,move:new Ue$1,jump:new Ue$1}});else{let Et=new Ue$1;Object.assign(_t,{actions:Et}),(_t.type==="MouseDown"||_t.type==="MouseUp"||_t.type==="KeyDown"||_t.type==="KeyUp")&&"url"in _t&&Et.push({fi:0,id:we$1.generateUUID(),data:{type:"Link",url:_t.url,delay:0}}),"targets"in _t&&(_t.targets.forEach((At,Rt,Ft)=>{let Nt={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},Bt={easing:At.easing,duration:At.duration};At.easing===6?Object.assign(Bt,Pn(At,"mass","stiffness","damping","velocity")):At.easing===5&&Object.assign(Bt,{control1:{...At.control1},control2:{...At.control2}});let Gt={repeat:At.repeat?-1:0,delay:At.delay,delayDirection:At.delayDirection,direction:At.cycle&&At.rewind?"pingpong-rewind":At.cycle?"pingpong":"normal"},dr={state:At.state,...Gt,...Bt},Mr={allowSlerp:!0,type:"Transition",object:At.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new Ue$1({fi:0,id:we$1.generateUUID(),data:Nt},{fi:1,id:we$1.generateUUID(),data:dr})};Et.push({fi:Ft,id:Rt,data:Mr})}),delete _t.targets)}})})}function c9(nt){nt.scene.objects.traverse((st,mt)=>{function gt(_t,Et){var Ft;let At=new Ue$1,Rt=[];if(mt.events.forEach((Nt,Bt,Gt)=>{if(Nt.type==="Audio"&&Nt.trigger===Et){let dr;Rt.push(Bt),Nt.interaction==="play"?dr={...Pn(Nt,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in Nt?Nt.after:void 0,toggle:"after"in Nt?Nt.toggle:void 0,type:"Audio"}:(Nt.interaction==="pause"||Nt.interaction==="stop")&&(dr={...Pn(Nt,"interaction","delay","object","playAudio"),type:"Audio"}),dr&&At.push({fi:Gt,id:Bt,data:dr})}}),Rt.forEach(Nt=>mt.events.delete(Nt)),At.length){let Nt=(Ft=mt.events.find(Bt=>Bt.type===_t))==null?void 0:Ft.data;Nt?"actions"in Nt&&Nt.actions.insertBefore(null,At):mt.events.insertBefore(null,[{id:we$1.generateUUID(),data:{type:_t,actions:At}}])}}gt("Start","start"),gt("MouseDown","mouseDown"),gt("MouseUp","mouseUp"),gt("KeyDown","keyDown"),gt("KeyUp","keyUp")})}function cI(nt){var mt;let st=(mt=nt.layers.find(gt=>gt.type==="light"))==null?void 0:mt.data;if((st==null?void 0:st.category)==="basic"){let gt=Gr.defaultData("light","phong"),_t=st;Object.assign(_t,gt),_t.visible=!1}}function uI(nt){Sa(nt,cI),wa(nt,cI)}function u9(nt){nt.scene.objects.traverse((st,mt)=>{mt.type==="Mesh"&&mt.geometry.type==="SubdivGeometry"&&(mt.geometry.scaleBaked||(mt.geometry.scaleBaked=[1,1,1]))})}function h9(nt){nt.scene.objects.traverse((st,mt)=>{(mt.type==="Empty"||mt.type==="Mesh")&&mt.cloner&&!mt.cloner.randomnessObject&&!mt.cloner.toObject&&!mt.cloner.randomness&&(mt.cloner={...mt.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function d9(nt){nt.scene.objects.traverse((st,mt)=>{mt.type==="Mesh"&&mt.geometry.type==="NonParametricGeometry"&&!("material"in mt)&&!("materials"in mt)&&(mt.material=Qr.defaultTwoLayerData("phong"))})}function f9(nt){nt.scene.publish.orbitControls.autoZoom===void 0&&(nt.scene.publish.orbitControls.autoZoom=!1),nt.scene.objects.traverse((st,mt)=>{(mt.type==="OrthographicCamera"||mt.type==="PerspectiveCamera")&&(mt.orthographic.autoZoom===void 0&&(mt.orthographic.autoZoom=!1),mt.orthographic.autoZoomFrustumSize===void 0&&(mt.orthographic.autoZoomFrustumSize=790))})}function p9(nt){nt.scene.objects.traverse((st,mt)=>{mt.pathSnapping===void 0&&(mt.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),mt.pathSnapping.offset===void 0&&(mt.pathSnapping.offset=0)})}function m9(nt){nt.scene.publish.mouseEventTarget===void 0&&(nt.scene.publish.mouseEventTarget="canvas"),nt.scene.publish.settings.web.hint===void 0&&(nt.scene.publish.settings.web.hint=!1)}function g9(nt){let{video:st}=nt.scene.publish.settings;st.format==="gif"&&st.fps>48&&(st.fps=15)}function y9(nt){nt.scene.objects.traverse((st,mt)=>{mt.events.forEach(gt=>{gt.type==="GameControl"&&(gt.resetYPosition=Math.abs(gt.resetYPosition-mt.position[1]))})})}function v9(nt){let st=nt.scene.environment.usePhysics;nt.scene.objects.traverse((mt,gt)=>{st&&gt.physics===null?gt.collision=!1:gt.collision="visibility"})}function x9(nt){nt.scene.objects.traverse((st,mt)=>{mt.events.forEach(gt=>{gt.type==="GameControl"&&(gt.navmesh=Qh.defaultDataThirdPerson.navmesh)})})}function b9(nt){nt.scene.styles||(nt.scene.styles=xa.defaultData())}function hI(nt){nt.layers.forEach(st=>{st.type==="light"&&st.category!=="toon"&&st.occlusion===void 0&&(st.occlusion=!0)})}function S9(nt){nt.scene.environment.ambientLight.occlusion===void 0&&(nt.scene.environment.ambientLight.occlusion=!1),nt.scene.environment.ambientLight.aoFullRes===void 0&&(nt.scene.environment.ambientLight.aoFullRes=!1),nt.scene.environment.ambientLight.radius===void 0&&(nt.scene.environment.ambientLight.radius=256),nt.scene.environment.ambientLight.bias===void 0&&(nt.scene.environment.ambientLight.bias=.5),nt.scene.environment.ambientLight.aoColor===void 0&&(nt.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),wa(nt,hI),Sa(nt,hI)}function w9(nt){nt.scene.objects.traverse((st,mt)=>{mt.events.forEach(gt=>{gt.type==="GameControl"&&Object.assign(gt.gameActions,{run:new Ue$1})})})}function A9(nt){nt.scene.objects.traverse((st,mt)=>{mt.events.forEach(gt=>{gt.type==="GameControl"&&(gt.keyAssignments=[...gt.keyAssignments,["run",""],["none","Ctrl"]])})})}function dI(nt){nt.layers&&nt.layers.forEach(st=>{st.type==="light"&&st.bumpMapIntensity===void 0&&(st.bumpMapIntensity=5)})}function fI(nt,st){if(st<1&&(wa(nt,nI),Sa(nt,nI),nt.schema=1),st<2&&(Gq(nt),nt.schema=2),st<3&&(Hq(nt),nt.schema=3),st<4&&(Wq(nt),nt.schema=4),st<5&&(qq(nt),nt.schema=5),st<6&&(Yq(nt),nt.schema=6),st<7&&(Xq(nt),nt.schema=7),st<8&&(nt.schema=8),st<9&&(oI(nt),nt.schema=9),st<10&&(Jq(nt),nt.schema=10),st<11&&($q(nt),nt.schema=11),st<12&&(oI(nt),nt.schema=12),st<13&&(e9(nt),nt.schema=13),st<14&&(r9(nt),nt.schema=14),st<15&&(i9(nt),nt.schema=15),st<16&&(n9(nt),nt.schema=16),st<17&&(wa(nt,aI),Sa(nt,aI),nt.schema=17),st<18&&(wa(nt,sI),Sa(nt,sI),nt.schema=18),st<19&&(jq(nt),nt.schema=19),st<20&&(s9(nt),a9(nt),nt.schema=20),st<21&&(l9(nt),c9(nt),nt.schema=21),st<22&&(uI(nt),nt.schema=22),st<23&&(u9(nt),nt.schema=23),st<24&&(h9(nt),nt.schema=24),(st<25||nt.shared.videos===void 0)&&(t9(nt),st<25&&(nt.schema=25)),st<26&&(Qq(nt),nt.schema=26),st<27&&(Kq(nt),nt.schema=27),st<28&&(uI(nt),nt.schema=28),st<29&&(Zq(nt),nt.schema=29),st<30&&(d9(nt),nt.schema=30),st<31&&(f9(nt),nt.schema=31),st<33&&(p9(nt),nt.schema=33),st<34&&(m9(nt),nt.schema=34),st<35&&(g9(nt),nt.schema=35),st<36&&(y9(nt),nt.schema=36),st<37&&(v9(nt),nt.schema=37),st<38&&(wa(nt,lI),Sa(nt,lI),nt.schema=38),st<39&&(x9(nt),nt.schema=39),st<40&&(b9(nt),nt.schema=40),st<41&&(S9(nt),nt.schema=41),st<42&&(w9(nt),nt.schema=42),st<43&&(A9(nt),nt.schema=43),st<99){wa(nt,dI),Sa(nt,dI),nt.scene.publish.playCamera===null&&(nt.scene.publish.playCamera=hs);let mt=kr(nt.scene.objects),gt=nt.scene.objects;nt.scene.publish.playPage=xl,gt.insertBefore(null,null,[{id:xl,data:{...ya.defaultData,backgroundColor:nt.scene.backgroundColor,fog:nt.scene.fog,postprocessing:nt.scene.postprocessing,ao:Pn(nt.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:nt.scene.publish.playCamera,gameControlObject:nt.scene.publish.gameControlObject},shadow:Pn(nt.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...wl.defaultData,...Pn(nt.scene.environment,"usePhysics","gravity")},camera:kr(nt.scene.ownerCamera)??ya.defaultData.camera,name:"Scene"},children:[]}]);for(let At of mt)At.id!==ba.TRASH_CAN_ID&&gt.move(xl,At.fi,At.id);let _t=0,Et=0;nt.shared.penumbraSize&&nt.scene.objects.traverse((At,Rt)=>{Rt.type==="DirectionalLight"?(Rt.penumbraSize=nt.shared.penumbraSize[Math.min(_t,2)],_t+=1):Rt.type==="SpotLight"&&(Rt.penumbraSize=nt.shared.penumbraSize[3+Math.min(Et,1)],Et+=1),(Rt.physics===void 0||Rt.physics===null)&&Rt.type!=="Instance"&&(Rt.physics={},Object.assign(Rt.physics,Sl.defaultData)),Rt.physics!==void 0&&Rt.physics!==null&&(Rt.physics.enabled=Rt.collision??"visibility",delete Rt.collision)}),nt.schema=99}}function pI(nt){nt.layers&&nt.layers.forEach(st=>{st.type==="light"&&st.alphaOverride===void 0&&(st.alphaOverride=1)})}function E9(nt){nt.scene.objects.traverse((st,mt)=>{let gt=mt.geometry;gt&&gt.type==="PathGeometry"&&(gt.extrusion.capType="flat",gt.extrusion.bevel=50,gt.extrusion.bevelSides=6,gt.extrusion.shape.type==="Custom"&&(gt.extrusion.shape.shapeQuality="low"))})}function M9(nt){var st;Array.isArray(kr(nt.events))&&((st=nt.events)==null||st.forEach(mt=>{"disabled"in mt||(mt.disabled=!1),(mt.type==="MouseDown"||mt.type==="MouseUp"||mt.type==="MousePress")&&(mt.mode=mt.mode||"Object")}))}var Kh=180/Math.PI;function mI(nt){nt.rotation=nt.rotation.slice(0,3).map(st=>st*Kh)}function gI(nt){var mt,gt;mI(nt),nt.type==="Page"&&mI(nt.camera),(mt=nt.states)==null||mt.forEach(_t=>{_t.rotation===void 0||_t.rotation===null||(_t.rotation=_t.rotation.slice(0,3).map(Et=>Et*Kh))});let st=nt.geometry;st&&st.type==="SphereGeometry"&&(st.thetaLength=(st.thetaLength??180)*Kh),st&&st.type==="TorusGeometry"&&(st.arc=st.arc*Kh),st&&st.type==="PathGeometry"&&(st.extrusion.angle*=Kh,st.extrusion.twist*=Kh),nt.type==="Mesh"&&nt.geometry.type==="TextGeometry"&&(nt.geometry.text={textValue:nt.geometry.text}),Array.isArray(kr(nt.events))&&((gt=nt.events)==null||gt.forEach(_t=>{(_t.type==="MouseDown"||_t.type==="MouseUp"||_t.type==="MousePress"||_t.type==="KeyDown"||_t.type==="KeyUp"||_t.type==="KeyPress"||_t.type==="Collision"||_t.type==="Trigger")&&(_t.runMode=_t.toggle?"Toggle":"Repeat")}))}function T9(nt){nt.shared.variables=qi({},Ke$1.prototype)}function C9(nt){let st=kr(nt.shared.variables);nt.shared.variables=qi(Object.entries(st??{}).map(([mt,gt],_t)=>({fi:_t,id:mt,data:gt})),Ue$1.prototype)}var To=115;function yI(nt,st){st(nt.data);for(let mt of nt.children)yI(mt,st)}function P9(nt){let st=nt.schema??104;st!==To&&st<105&&(yI(nt.asset,gI),nt.schema=105)}function _9(nt){nt.shared.particles=qi({},Ke$1.prototype),nt.shared.lib&&(nt.shared.lib.particles=zs.defaultData().particles)}function D9(nt){nt.scene.objects.traverse((st,mt)=>{mt.type==="Particle"&&typeof mt.renderMaterial.size=="number"&&Object.assign(mt.renderMaterial,{size:[mt.renderMaterial.size,mt.renderMaterial.size]})})}function I9(nt){nt.scene.objects.traverse((st,mt)=>{mt.type==="Page"&&(mt.postprocessing.depthOfField.focusDistance=100,mt.postprocessing.depthOfField.focalLength=20,mt.postprocessing.depthOfField.bokehScale=5)})}function O9(nt){nt.scene.objects.traverse((st,mt)=>{var gt;Array.isArray(kr(mt.events))!==!1&&((gt=mt.events)==null||gt.forEach(_t=>{var At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr;let Et=_t.runMode;_t.type==="MouseDown"||_t.type==="MouseUp"||_t.type==="KeyDown"||_t.type==="KeyUp"||_t.type==="Collision"||_t.type==="Trigger"?(At=_t.actions)==null||At.forEach(Nr=>{Nr.type==="Transition"&&(Nr.runMode=Et??"Repeat"),(Nr.type==="Animation"||Nr.type==="SwitchCamera")&&(Nr.runMode=Et==="Toggle"?"Toggle":"Normal")}):_t.type==="MouseHover"||_t.type==="MousePress"||_t.type==="KeyPress"?(Rt=_t.actions)==null||Rt.forEach(Nr=>{(Nr.type==="Transition"||Nr.type==="Animation"||Nr.type==="SwitchCamera")&&(Nr.runMode="Toggle")}):_t.type==="GameControl"?(delete _t.actions,Object.keys(_t.gameActions).forEach(Nr=>{var tn;(tn=_t.gameActions[Nr])==null||tn.forEach(rn=>{rn.type==="Transition"&&(rn.runMode="Repeat"),rn.type==="Animation"&&(rn.runMode="Normal")})})):_t.type==="DragDrop"?(delete _t.actions,(Nt=(Ft=_t.dragDropActions)==null?void 0:Ft.drag)==null||Nt.forEach(Nr=>{(Nr.type==="Transition"||Nr.type==="Animation"||Nr.type==="SwitchCamera")&&(Nr.runMode="Toggle")}),(Gt=(Bt=_t.dragDropActions)==null?void 0:Bt.drop)==null||Gt.forEach(Nr=>{(Nr.type==="Transition"||Nr.type==="Animation"||Nr.type==="SwitchCamera")&&(Nr.runMode="Toggle")})):_t.type==="Resize"?(delete _t.actions,(dr=_t.breakpoints)==null||dr.forEach(Nr=>{var tn;(tn=Nr.actions)==null||tn.forEach(rn=>{(rn.type==="Transition"||rn.type==="Animation"||rn.type==="SwitchCamera")&&(rn.runMode="Toggle")})})):_t.type==="Start"?(Mr=_t.actions)==null||Mr.forEach(Nr=>{Nr.type==="Transition"&&(Nr.runMode="Once"),(Nr.type==="Animation"||Nr.type==="SwitchCamera")&&(Nr.runMode="Normal")}):_t.type==="VariableChange"||_t.type==="Scroll"?(Tr=_t.actions)==null||Tr.forEach(Nr=>{Nr.type==="Transition"&&(Nr.runMode="Repeat"),(Nr.type==="Animation"||Nr.type==="SwitchCamera")&&(Nr.runMode="Normal")}):_t.type==="Conditional"&&(delete _t.actions,(zr=_t.inActions)==null||zr.forEach(Nr=>{Nr.type==="Transition"&&(Nr.runMode="Repeat"),(Nr.type==="Animation"||Nr.type==="SwitchCamera")&&(Nr.runMode="Normal")}),(Fr=_t.outActions)==null||Fr.forEach(Nr=>{Nr.type==="Transition"&&(Nr.runMode="Repeat"),(Nr.type==="Animation"||Nr.type==="SwitchCamera")&&(Nr.runMode="Normal")}))}))})}function R9(nt){nt.shared.userAPIs=qi({},Ke$1.prototype),nt.shared.userWebhooks=qi({},Ke$1.prototype),nt.shared.lib&&(nt.shared.lib.userAPIs=zs.defaultData().userAPIs,nt.shared.lib.userWebhooks=zs.defaultData().userWebhooks)}function Xv(nt){let st=nt.schema??0;if(st!==To){console.warn("updating from ",st,"to ",To),fI(nt,st),st<100&&(nt.scene.publish.joystickSizeAndXYOffset===void 0&&(nt.scene.publish.joystickSizeAndXYOffset=Us.defaultData.joystickSizeAndXYOffset),nt.schema=100),st<101&&(wa(nt,pI),Sa(nt,pI),nt.schema=101),st<102&&(E9(nt),nt.schema=102),st<104&&(nt.shared.catelogs=new Ke$1,nt.shared.lib=zs.defaultData(),nt.schema=104),st<105&&(T9(nt),nt.scene.objects.traverse((mt,gt)=>{gI(gt)}),nt.schema=105);for(let mt of Object.values(nt.shared.lib.components))P9(mt);st<106&&(C9(nt),nt.schema=106),st<107&&(nt.shared.lib.variables=zs.defaultData().variables,nt.schema=107),st<109&&(_9(nt),nt.schema=109),st<110&&(D9(nt),nt.schema=110),st<111&&(nt.scene.objects.traverse((mt,gt)=>{M9(gt)}),nt.schema=111),st<112&&(I9(nt),nt.schema=112),st<113&&(O9(nt),nt.schema=113),st<114&&(nt.scene.publish.settings.web.imageQuality===void 0&&(nt.scene.publish.settings.web.imageQuality=70),nt.schema=114),st<115&&(R9(nt),nt.schema=115)}}var qh;(nt=>{nt.defaultData={schema:To,scene:ba.defaultData,frames:new Ke$1().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Yh.defaultData),shared:{...vn.emptyData(),colors:vn.defaultColors()}},nt.emptyDataForImports=function(){let Et=ba.emptyDataWithPage();return{schema:To,scene:Et,frames:new Ke$1().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Yh.defaultData),shared:{...vn.emptyData(),colors:vn.defaultColors(),images:vn.defaultImages()}}},nt.emptyData=function(){return{schema:To,scene:ba.emptyDataWithPage(),frames:new Ke$1().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Yh.defaultData),shared:vn.emptyData()}},nt.clipboard2dData=function(){return{schema:To,scene:ba.emptyData(),frames:new Ke$1,shared:vn.emptyData()}},nt.collabHelper={...Np,updateSchema(Et){return(Et.schema??0)<To?pl(Et,Xv):(Et.schema??0)-To}};function st(Et){let At=nt.collabHelper.updateSchema(Et);return typeof At=="number"?At===0?Et:null:At.data}nt.updateSchemaDirectly=st;function mt(Et){return{...Et,shared:{...Et.shared,lib:zs.defaultData()}}}nt.withoutLib=mt;function gt(Et,At){let Rt=Et.scene.objects.get(At);if(Rt&&Rt.data.type==="Component")return Rt;{let Ft=Et.shared.lib.components[At];if(Ft)return Ft.asset}}nt.getComponentData=gt;function _t(Et){let At=Object.values(Et.shared.userAPIs);for(let Rt of At){let Ft=Rt.headers;for(let Nt of Ft)if(Nt.data.key.toLowerCase()==="authorization"&&Nt.data.value!=="")return!0}return!1}nt.hasSensitiveData=_t})(qh||(qh={}));var Qv;(nt=>nt.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(Qv||(Qv={}));var vI;(nt=>{function st(mt){return!0}nt.is=st})(vI||(vI={}));var Kv;(nt=>{nt.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]};function st(gt,_t){return{position:(_t==null?void 0:_t.position)??gt.position,rotation:(_t==null?void 0:_t.rotation)??gt.rotation,scale:(_t==null?void 0:_t.scale)??gt.scale,shear:(_t==null?void 0:_t.shear)??gt.shear}}nt.merge=st;function mt(gt,_t){return ev({position:Fs.isEqual(gt.position,_t.position)?void 0:_t.position,rotation:gt.rotation===_t.rotation?void 0:_t.rotation,scale:Fs.isEqual(gt.scale,_t.scale)?void 0:_t.scale,shear:gt.shear&&_t.shear&&Fs.isEqual(gt.shear,_t.shear)?void 0:_t.shear})}nt.diff=mt})(Kv||(Kv={}));var V1;(nt=>nt.defaultData={horizontalConstraint:0,verticalConstraint:0})(V1||(V1={}));var xI;(nt=>nt.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8})(xI||(xI={}));var Zv;(nt=>nt.defaultData={opacity:1,fill:{color:bt$1.fromHexAndA(ii,1),enabled:!0},stroke:{color:bt$1.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:bt$1.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:bt$1.from0to1([0,0,0,1]),enabled:!1,spread:0}})(Zv||(Zv={}));var Aa;(nt=>{function st(At,Rt){return{name:Rt}}nt.newEmpty=st;function mt(At,Rt){if(Rt===void 0)return At;let Ft={...At},Nt=["width","height","cornerRadius"];for(let Bt of Nt)Bt in Ft&&Bt in Rt&&Rt[Bt]!==void 0&&Object.assign(Ft,{[Bt]:Rt[Bt]});return Ft}function gt(At,Rt){if(Rt===void 0)return At;let Ft={...At};return"fill"in Ft&&"fill"in Rt&&Rt.fill!==void 0&&Object.assign(Ft,{fill:{...Ft.fill,...Rt.fill}}),"stroke"in Ft&&"stroke"in Rt&&Rt.stroke!==void 0&&Object.assign(Ft,{stroke:{...Ft.stroke,...Rt.stroke}}),"layerBlur"in Ft&&"layerBlur"in Rt&&Rt.layerBlur!==void 0&&Object.assign(Ft,{layerBlur:{...Ft.layerBlur,...Rt.layerBlur}}),"backgroundBlur"in Ft&&"backgroundBlur"in Rt&&Rt.backgroundBlur!==void 0&&Object.assign(Ft,{backgroundBlur:{...Ft.backgroundBlur,...Rt.backgroundBlur}}),"dropShadow"in Ft&&"dropShadow"in Rt&&Rt.dropShadow!==void 0&&Object.assign(Ft,{dropShadow:{...Ft.dropShadow,...Rt.dropShadow}}),"innerShadow"in Ft&&"innerShadow"in Rt&&Rt.innerShadow!==void 0&&Object.assign(Ft,{innerShadow:{...Ft.innerShadow,...Rt.innerShadow}}),Ft}function _t(At,Rt){if(Rt===void 0)return At;let Ft={...At};return Object.assign(Ft,Kv.merge(Ft,Rt)),Ft=mt(Ft,Rt),Ft=gt(Ft,Rt),Ft}nt.patch=_t;function Et(At,Rt){let Ft,Nt=[];for(let[Bt,Gt]of Object.entries(Rt))Bt!=="name"&&(Ft===void 0&&(Ft={path:[],props:{},type:0},Nt.push(Ft)),Ft.props[Bt]=Gt);return Nt}nt.toOps=Et})(Aa||(Aa={}));var jp;(nt=>nt.defaultData={...Kv.defaultData,...V1.defaultData,states:new Ue$1,events:new Ue$1,visible:!0,raycastLock:!1})(jp||(jp={}));var Zh;(nt=>nt.defaultData={...jp.defaultData,...Zv.defaultData})(Zh||(Zh={}));var Jv;(nt=>nt.defaultData={cornerRadius:[0,0,0,0]})(Jv||(Jv={}));var U1;(nt=>nt.defaultData={...Zh.defaultData,type:"ellipse2d",width:100,height:100,name:"Ellipse"})(U1||(U1={}));var Jh;(nt=>nt.defaultData={...Zh.defaultData,...Jv.defaultData,type:"rectangle2d",width:100,height:100,name:"Rectangle"})(Jh||(Jh={}));var z1;(nt=>nt.defaultData={...Zh.defaultData,type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})(z1||(z1={}));var k1;(nt=>nt.defaultData={...Zh.defaultData,type:"path2d",path:"",name:"Path"})(k1||(k1={}));var bI;(nt=>{function st(mt){return mt.type==="ellipse2d"||mt.type==="rectangle2d"||mt.type==="text2d"||mt.type==="vector2d"||mt.type==="path2d"}nt.is=st})(bI||(bI={}));var Hp;(nt=>nt.defaultData={...jp.defaultData,name:"Group",type:"group2d"})(Hp||(Hp={}));var G1;(nt=>nt.defaultData=()=>({...jp.defaultData,...Jv.defaultData,...Zv.defaultData,name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:bt$1.fromHexAndA(4737101,1),enabled:!0},stroke:{color:bt$1.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}}))(G1||(G1={}));var Ea;(nt=>{function st(At){switch(At){case"rectangle2d":return{...Jh.defaultData};case"ellipse2d":return{...U1.defaultData};case"text2d":return{...z1.defaultData};case"vector2d":return{...Jh.defaultData};case"path2d":return{...k1.defaultData};case"frame2d":return{...G1.defaultData()};case"group2d":return{...Hp.defaultData}}}nt.defaultData=st;function mt(At){return"width"in At&&"height"in At?[typeof At.width=="number"?At.width*.5:0,typeof At.height=="number"?At.height*.5:0]:[0,0]}nt.getPivot=mt;function gt(At){return At.type==="rectangle2d"||At.type==="ellipse2d"||At.type==="text2d"||At.type==="frame2d"}nt.isResizeable=gt;function _t(At){return At.type==="frame2d"&&At.autoLayout!==void 0}nt.isAutoLayoutable=_t;function Et(At){return At.type==="rectangle2d"||At.type==="frame2d"}nt.hasCorners=Et})(Ea||(Ea={}));var $v;(nt=>(nt.defaultData={name:"UI",type:"scene2d",objects:new gr},nt.emptyData=function(){return{type:"scene2d",objects:new gr}}))($v||($v={}));function ks(nt,st=!1){let mt=nt[0].index!==null,gt=new Set(Object.keys(nt[0].attributes)),_t=new Set(Object.keys(nt[0].morphAttributes)),Et={},At={},Rt=nt[0].morphTargetsRelative,Ft=new _e$1,Nt=0;for(let Bt=0;Bt<nt.length;++Bt){let Gt=nt[Bt],dr=0;if(mt!==(Gt.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+Bt+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let Mr in Gt.attributes){if(!gt.has(Mr))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+Bt+'. All geometries must have compatible attributes; make sure "'+Mr+'" attribute exists among all geometries, or in none of them.'),null;Et[Mr]===void 0&&(Et[Mr]=[]),Et[Mr].push(Gt.attributes[Mr]),dr++}if(dr!==gt.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+Bt+". Make sure all geometries have the same number of attributes."),null;if(Rt!==Gt.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+Bt+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let Mr in Gt.morphAttributes){if(!_t.has(Mr))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+Bt+".  .morphAttributes must be consistent throughout all geometries."),null;At[Mr]===void 0&&(At[Mr]=[]),At[Mr].push(Gt.morphAttributes[Mr])}if(st){let Mr;if(mt)Mr=Gt.index.count;else if(Gt.attributes.position!==void 0)Mr=Gt.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+Bt+". The geometry must have either an index or a position attribute"),null;Ft.addGroup(Nt,Mr,Bt),Nt+=Mr}}if(mt){let Bt=0,Gt=[];for(let dr=0;dr<nt.length;++dr){let Mr=nt[dr].index;for(let Tr=0;Tr<Mr.count;++Tr)Gt.push(Mr.getX(Tr)+Bt);Bt+=nt[dr].attributes.position.count}Ft.setIndex(Gt)}for(let Bt in Et){let Gt=SI(Et[Bt]);if(!Gt)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+Bt+" attribute."),null;Ft.setAttribute(Bt,Gt)}for(let Bt in At){let Gt=At[Bt][0].length;if(Gt===0)break;Ft.morphAttributes=Ft.morphAttributes||{},Ft.morphAttributes[Bt]=[];for(let dr=0;dr<Gt;++dr){let Mr=[];for(let zr=0;zr<At[Bt].length;++zr)Mr.push(At[Bt][zr][dr]);let Tr=SI(Mr);if(!Tr)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+Bt+" morphAttribute."),null;Ft.morphAttributes[Bt].push(Tr)}}return Ft}function SI(nt){let st,mt,gt,_t=0;for(let Rt=0;Rt<nt.length;++Rt){let Ft=nt[Rt];if(Ft.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(st===void 0&&(st=Ft.array.constructor),st!==Ft.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(mt===void 0&&(mt=Ft.itemSize),mt!==Ft.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(gt===void 0&&(gt=Ft.normalized),gt!==Ft.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;_t+=Ft.array.length}let Et=new st(_t),At=0;for(let Rt=0;Rt<nt.length;++Rt)Et.set(nt[Rt].array,At),At+=nt[Rt].array.length;return new Xe$1(Et,mt,gt)}var wI=Math.pow(2,-24),Oc=class{constructor(){}};function fs(nt,st,mt){return mt.min.x=st[nt],mt.min.y=st[nt+1],mt.min.z=st[nt+2],mt.max.x=st[nt+3],mt.max.y=st[nt+4],mt.max.z=st[nt+5],mt}function j1(nt){let st=-1,mt=-1/0;for(let gt=0;gt<3;gt++){let _t=nt[gt+3]-nt[gt];_t>mt&&(mt=_t,st=gt)}return st}function H1(nt,st){st.set(nt)}function W1(nt,st,mt){let gt,_t;for(let Et=0;Et<3;Et++){let At=Et+3;gt=nt[Et],_t=st[Et],mt[Et]=gt<_t?gt:_t,gt=nt[At],_t=st[At],mt[At]=gt>_t?gt:_t}}function Wp(nt,st,mt){for(let gt=0;gt<3;gt++){let _t=st[nt+2*gt],Et=st[nt+2*gt+1],At=_t-Et,Rt=_t+Et;At<mt[gt]&&(mt[gt]=At),Rt>mt[gt+3]&&(mt[gt+3]=Rt)}}function $h(nt){let st=nt[3]-nt[0],mt=nt[4]-nt[1],gt=nt[5]-nt[2];return 2*(st*mt+mt*gt+gt*st)}function N9(nt,st){if(!nt.index){let mt=nt.attributes.position.count,gt=st.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,_t;mt>65535?_t=new Uint32Array(new gt(4*mt)):_t=new Uint16Array(new gt(2*mt)),nt.setIndex(new Xe$1(_t,1));for(let Et=0;Et<mt;Et++)_t[Et]=Et}}function F9(nt){if(!nt.groups||!nt.groups.length)return[{offset:0,count:nt.index.count/3}];let st=[],mt=new Set;for(let _t of nt.groups)mt.add(_t.start),mt.add(_t.start+_t.count);let gt=Array.from(mt.values()).sort((_t,Et)=>_t-Et);for(let _t=0;_t<gt.length-1;_t++){let Et=gt[_t],At=gt[_t+1];st.push({offset:Et/3,count:(At-Et)/3})}return st}function Y1(nt,st,mt,gt,_t=null){let Et=1/0,At=1/0,Rt=1/0,Ft=-1/0,Nt=-1/0,Bt=-1/0,Gt=1/0,dr=1/0,Mr=1/0,Tr=-1/0,zr=-1/0,Fr=-1/0,Nr=_t!==null;for(let tn=st*6,rn=(st+mt)*6;tn<rn;tn+=6){let Tn=nt[tn+0],$n=nt[tn+1],un=Tn-$n,es=Tn+$n;un<Et&&(Et=un),es>Ft&&(Ft=es),Nr&&Tn<Gt&&(Gt=Tn),Nr&&Tn>Tr&&(Tr=Tn);let kn=nt[tn+2],ts=nt[tn+3],Ko=kn-ts,ds=kn+ts;Ko<At&&(At=Ko),ds>Nt&&(Nt=ds),Nr&&kn<dr&&(dr=kn),Nr&&kn>zr&&(zr=kn);let Il=nt[tn+4],ru=nt[tn+5],uu=Il-ru,p0=Il+ru;uu<Rt&&(Rt=uu),p0>Bt&&(Bt=p0),Nr&&Il<Mr&&(Mr=Il),Nr&&Il>Fr&&(Fr=Il)}gt[0]=Et,gt[1]=At,gt[2]=Rt,gt[3]=Ft,gt[4]=Nt,gt[5]=Bt,Nr&&(_t[0]=Gt,_t[1]=dr,_t[2]=Mr,_t[3]=Tr,_t[4]=zr,_t[5]=Fr)}function V9(nt,st,mt,gt){let _t=1/0,Et=1/0,At=1/0,Rt=-1/0,Ft=-1/0,Nt=-1/0;for(let Bt=st*6,Gt=(st+mt)*6;Bt<Gt;Bt+=6){let dr=nt[Bt+0];dr<_t&&(_t=dr),dr>Rt&&(Rt=dr);let Mr=nt[Bt+2];Mr<Et&&(Et=Mr),Mr>Ft&&(Ft=Mr);let Tr=nt[Bt+4];Tr<At&&(At=Tr),Tr>Nt&&(Nt=Tr)}gt[0]=_t,gt[1]=Et,gt[2]=At,gt[3]=Rt,gt[4]=Ft,gt[5]=Nt}function U9(nt,st,mt,gt,_t){let Et=mt,At=mt+gt-1,Rt=_t.pos,Ft=_t.axis*2;for(;;){for(;Et<=At&&st[Et*6+Ft]<Rt;)Et++;for(;Et<=At&&st[At*6+Ft]>=Rt;)At--;if(Et<At){for(let Nt=0;Nt<3;Nt++){let Bt=nt[Et*3+Nt];nt[Et*3+Nt]=nt[At*3+Nt],nt[At*3+Nt]=Bt;let Gt=st[Et*6+Nt*2+0];st[Et*6+Nt*2+0]=st[At*6+Nt*2+0],st[At*6+Nt*2+0]=Gt;let dr=st[Et*6+Nt*2+1];st[Et*6+Nt*2+1]=st[At*6+Nt*2+1],st[At*6+Nt*2+1]=dr}Et++,At--}else return Et}}var Ma=32,z9=(nt,st)=>nt.candidate-st.candidate,Ml=new Array(Ma).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),e0=new Float32Array(6);function k9(nt,st,mt,gt,_t,Et){let At=-1,Rt=0;if(Et===0)At=j1(st),At!==-1&&(Rt=(st[At]+st[At+3])/2);else if(Et===1)At=j1(nt),At!==-1&&(Rt=G9(mt,gt,_t,At));else if(Et===2){let Ft=$h(nt),Nt=1.25*_t,Bt=gt*6,Gt=(gt+_t)*6;for(let dr=0;dr<3;dr++){let Mr=st[dr],Tr=(st[dr+3]-Mr)/Ma;if(_t<Ma/4){let zr=[...Ml];zr.length=_t;let Fr=0;for(let tn=Bt;tn<Gt;tn+=6,Fr++){let rn=zr[Fr];rn.candidate=mt[tn+2*dr],rn.count=0;let{bounds:Tn,leftCacheBounds:$n,rightCacheBounds:un}=rn;for(let es=0;es<3;es++)un[es]=1/0,un[es+3]=-1/0,$n[es]=1/0,$n[es+3]=-1/0,Tn[es]=1/0,Tn[es+3]=-1/0;Wp(tn,mt,Tn)}zr.sort(z9);let Nr=_t;for(let tn=0;tn<Nr;tn++){let rn=zr[tn];for(;tn+1<Nr&&zr[tn+1].candidate===rn.candidate;)zr.splice(tn+1,1),Nr--}for(let tn=Bt;tn<Gt;tn+=6){let rn=mt[tn+2*dr];for(let Tn=0;Tn<Nr;Tn++){let $n=zr[Tn];rn>=$n.candidate?Wp(tn,mt,$n.rightCacheBounds):(Wp(tn,mt,$n.leftCacheBounds),$n.count++)}}for(let tn=0;tn<Nr;tn++){let rn=zr[tn],Tn=rn.count,$n=_t-rn.count,un=rn.leftCacheBounds,es=rn.rightCacheBounds,kn=0;Tn!==0&&(kn=$h(un)/Ft);let ts=0;$n!==0&&(ts=$h(es)/Ft);let Ko=1+1.25*(kn*Tn+ts*$n);Ko<Nt&&(At=dr,Nt=Ko,Rt=rn.candidate)}}else{for(let Nr=0;Nr<Ma;Nr++){let tn=Ml[Nr];tn.count=0,tn.candidate=Mr+Tr+Nr*Tr;let rn=tn.bounds;for(let Tn=0;Tn<3;Tn++)rn[Tn]=1/0,rn[Tn+3]=-1/0}for(let Nr=Bt;Nr<Gt;Nr+=6){let tn=~~((mt[Nr+2*dr]-Mr)/Tr);tn>=Ma&&(tn=Ma-1);let rn=Ml[tn];rn.count++,Wp(Nr,mt,rn.bounds)}let zr=Ml[Ma-1];H1(zr.bounds,zr.rightCacheBounds);for(let Nr=Ma-2;Nr>=0;Nr--){let tn=Ml[Nr],rn=Ml[Nr+1];W1(tn.bounds,rn.rightCacheBounds,tn.rightCacheBounds)}let Fr=0;for(let Nr=0;Nr<Ma-1;Nr++){let tn=Ml[Nr],rn=tn.count,Tn=tn.bounds,$n=Ml[Nr+1].rightCacheBounds;rn!==0&&(Fr===0?H1(Tn,e0):W1(Tn,e0,e0)),Fr+=rn;let un=0,es=0;Fr!==0&&(un=$h(e0)/Ft);let kn=_t-Fr;kn!==0&&(es=$h($n)/Ft);let ts=1+1.25*(un*Fr+es*kn);ts<Nt&&(At=dr,Nt=ts,Rt=tn.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${Et} used.`);return{axis:At,pos:Rt}}function G9(nt,st,mt,gt){let _t=0;for(let Et=st,At=st+mt;Et<At;Et++)_t+=nt[Et*6+gt*2];return _t/mt}function j9(nt,st){let mt=nt.attributes.position,gt=nt.index.array,_t=gt.length/3,Et=new Float32Array(_t*6),At=mt.normalized,Rt=mt.array,Ft=mt.offset||0,Nt=3;mt.isInterleavedBufferAttribute&&(Nt=mt.data.stride);let Bt=["getX","getY","getZ"];for(let Gt=0;Gt<_t;Gt++){let dr=Gt*3,Mr=Gt*6,Tr,zr,Fr;At?(Tr=gt[dr+0],zr=gt[dr+1],Fr=gt[dr+2]):(Tr=gt[dr+0]*Nt+Ft,zr=gt[dr+1]*Nt+Ft,Fr=gt[dr+2]*Nt+Ft);for(let Nr=0;Nr<3;Nr++){let tn,rn,Tn;At?(tn=mt[Bt[Nr]](Tr),rn=mt[Bt[Nr]](zr),Tn=mt[Bt[Nr]](Fr)):(tn=Rt[Tr+Nr],rn=Rt[zr+Nr],Tn=Rt[Fr+Nr]);let $n=tn;rn<$n&&($n=rn),Tn<$n&&($n=Tn);let un=tn;rn>un&&(un=rn),Tn>un&&(un=Tn);let es=(un-$n)/2,kn=Nr*2;Et[Mr+kn+0]=$n+es,Et[Mr+kn+1]=es+(Math.abs($n)+es)*wI,$n<st[Nr]&&(st[Nr]=$n),un>st[Nr+3]&&(st[Nr+3]=un)}}return Et}function H9(nt,st){function mt(Nr){dr&&dr(Nr/Mr)}function gt(Nr,tn,rn,Tn=null,$n=0){if(!Tr&&$n>=Ft&&(Tr=!0,Nt&&(console.warn(`MeshBVH: Max depth of ${Ft} reached when generating BVH. Consider increasing maxDepth.`),console.warn(nt))),rn<=Bt||$n>=Ft)return mt(tn+rn),Nr.offset=tn,Nr.count=rn,Nr;let un=k9(Nr.boundingData,Tn,At,tn,rn,Gt);if(un.axis===-1)return mt(tn+rn),Nr.offset=tn,Nr.count=rn,Nr;let es=U9(Rt,At,tn,rn,un);if(es===tn||es===tn+rn)mt(tn+rn),Nr.offset=tn,Nr.count=rn;else{Nr.splitAxis=un.axis;let kn=new Oc,ts=tn,Ko=es-tn;Nr.left=kn,kn.boundingData=new Float32Array(6),Y1(At,ts,Ko,kn.boundingData,Et),gt(kn,ts,Ko,Et,$n+1);let ds=new Oc,Il=es,ru=rn-Ko;Nr.right=ds,ds.boundingData=new Float32Array(6),Y1(At,Il,ru,ds.boundingData,Et),gt(ds,Il,ru,Et,$n+1)}return Nr}N9(nt,st);let _t=new Float32Array(6),Et=new Float32Array(6),At=j9(nt,_t),Rt=nt.index.array,Ft=st.maxDepth,Nt=st.verbose,Bt=st.maxLeafTris,Gt=st.strategy,dr=st.onProgress,Mr=nt.index.count/3,Tr=!1,zr=[],Fr=F9(nt);if(Fr.length===1){let Nr=Fr[0],tn=new Oc;tn.boundingData=_t,V9(At,Nr.offset,Nr.count,Et),gt(tn,Nr.offset,Nr.count,Et),zr.push(tn)}else for(let Nr of Fr){let tn=new Oc;tn.boundingData=new Float32Array(6),Y1(At,Nr.offset,Nr.count,tn.boundingData,Et),gt(tn,Nr.offset,Nr.count,Et),zr.push(tn)}return zr}function MI(nt,st){let mt=H9(nt,st),gt,_t,Et,At=[],Rt=st.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let Bt=0;Bt<mt.length;Bt++){let Gt=mt[Bt],dr=Ft(Gt),Mr=new Rt(32*dr);gt=new Float32Array(Mr),_t=new Uint32Array(Mr),Et=new Uint16Array(Mr),Nt(0,Gt),At.push(Mr)}return At;function Ft(Bt){return Bt.count?1:1+Ft(Bt.left)+Ft(Bt.right)}function Nt(Bt,Gt){let dr=Bt/4,Mr=Bt/2,Tr=!!Gt.count,zr=Gt.boundingData;for(let Fr=0;Fr<6;Fr++)gt[dr+Fr]=zr[Fr];if(Tr){let Fr=Gt.offset,Nr=Gt.count;return _t[dr+6]=Fr,Et[Mr+14]=Nr,Et[Mr+15]=65535,Bt+32}else{let Fr=Gt.left,Nr=Gt.right,tn=Gt.splitAxis,rn;if(rn=Nt(Bt+32,Fr),rn/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return _t[dr+6]=rn/4,rn=Nt(rn,Nr),_t[dr+7]=tn,rn}}}var Dn=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(nt,st){let mt=1/0,gt=-1/0;for(let _t=0,Et=nt.length;_t<Et;_t++){let At=nt[_t][st];mt=At<mt?At:mt,gt=At>gt?At:gt}this.min=mt,this.max=gt}setFromPoints(nt,st){let mt=1/0,gt=-1/0;for(let _t=0,Et=st.length;_t<Et;_t++){let At=st[_t],Rt=nt.dot(At);mt=Rt<mt?Rt:mt,gt=Rt>gt?Rt:gt}this.min=mt,this.max=gt}isSeparated(nt){return this.min>nt.max||nt.min>this.max}};Dn.prototype.setFromBox=function(){let nt=new E$6;return function(st,mt){let gt=mt.min,_t=mt.max,Et=1/0,At=-1/0;for(let Rt=0;Rt<=1;Rt++)for(let Ft=0;Ft<=1;Ft++)for(let Nt=0;Nt<=1;Nt++){nt.x=gt.x*Rt+_t.x*(1-Rt),nt.y=gt.y*Ft+_t.y*(1-Ft),nt.z=gt.z*Nt+_t.z*(1-Nt);let Bt=st.dot(nt);Et=Math.min(Bt,Et),At=Math.max(Bt,At)}this.min=Et,this.max=At}}();var W9=function(){let nt=new E$6,st=new E$6,mt=new E$6;return function(gt,_t,Et){let At=gt.start,Rt=nt,Ft=_t.start,Nt=st;mt.subVectors(At,Ft),nt.subVectors(gt.end,gt.start),st.subVectors(_t.end,_t.start);let Bt=mt.dot(Nt),Gt=Nt.dot(Rt),dr=Nt.dot(Nt),Mr=mt.dot(Rt),Tr=Rt.dot(Rt)*dr-Gt*Gt,zr,Fr;Tr!==0?zr=(Bt*Gt-Mr*dr)/Tr:zr=0,Fr=(Bt+zr*Gt)/dr,Et.x=zr,Et.y=Fr}}(),qp=function(){let nt=new U$1,st=new E$6,mt=new E$6;return function(gt,_t,Et,At){W9(gt,_t,nt);let Rt=nt.x,Ft=nt.y;if(Rt>=0&&Rt<=1&&Ft>=0&&Ft<=1){gt.at(Rt,Et),_t.at(Ft,At);return}else if(Rt>=0&&Rt<=1){Ft<0?_t.at(0,At):_t.at(1,At),gt.closestPointToPoint(At,!0,Et);return}else if(Ft>=0&&Ft<=1){Rt<0?gt.at(0,Et):gt.at(1,Et),_t.closestPointToPoint(Et,!0,At);return}else{let Nt;Rt<0?Nt=gt.start:Nt=gt.end;let Bt;Ft<0?Bt=_t.start:Bt=_t.end;let Gt=st,dr=mt;if(gt.closestPointToPoint(Bt,!0,st),_t.closestPointToPoint(Nt,!0,mt),Gt.distanceToSquared(Bt)<=dr.distanceToSquared(Nt)){Et.copy(Gt),At.copy(Bt);return}else{Et.copy(Nt),At.copy(dr);return}}}}(),TI=function(){let nt=new E$6,st=new E$6,mt=new Vr,gt=new Mi;return function(_t,Et){let{radius:At,center:Rt}=_t,{a:Ft,b:Nt,c:Bt}=Et;if(gt.start=Ft,gt.end=Nt,gt.closestPointToPoint(Rt,!0,nt).distanceTo(Rt)<=At||(gt.start=Ft,gt.end=Bt,gt.closestPointToPoint(Rt,!0,nt).distanceTo(Rt)<=At)||(gt.start=Nt,gt.end=Bt,gt.closestPointToPoint(Rt,!0,nt).distanceTo(Rt)<=At))return!0;let Gt=Et.getPlane(mt);if(Math.abs(Gt.distanceToPoint(Rt))<=At){let dr=Gt.projectPoint(Rt,st);if(Et.containsPoint(dr))return!0}return!1}}(),q9=1e-15;function ed(nt){return Math.abs(nt)<q9}var In=class extends Cr{constructor(...nt){super(...nt),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new E$6),this.satBounds=new Array(4).fill().map(()=>new Dn),this.points=[this.a,this.b,this.c],this.sphere=new Or,this.plane=new Vr,this.needsUpdate=!0}intersectsSphere(nt){return TI(nt,this)}update(){let nt=this.a,st=this.b,mt=this.c,gt=this.points,_t=this.satAxes,Et=this.satBounds,At=_t[0],Rt=Et[0];this.getNormal(At),Rt.setFromPoints(At,gt);let Ft=_t[1],Nt=Et[1];Ft.subVectors(nt,st),Nt.setFromPoints(Ft,gt);let Bt=_t[2],Gt=Et[2];Bt.subVectors(st,mt),Gt.setFromPoints(Bt,gt);let dr=_t[3],Mr=Et[3];dr.subVectors(mt,nt),Mr.setFromPoints(dr,gt),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(At,nt),this.needsUpdate=!1}};In.prototype.closestPointToSegment=function(){let nt=new E$6,st=new E$6,mt=new Mi;return function(gt,_t=null,Et=null){let{start:At,end:Rt}=gt,Ft=this.points,Nt,Bt=1/0;for(let Gt=0;Gt<3;Gt++){let dr=(Gt+1)%3;mt.start.copy(Ft[Gt]),mt.end.copy(Ft[dr]),qp(mt,gt,nt,st),Nt=nt.distanceToSquared(st),Nt<Bt&&(Bt=Nt,_t&&_t.copy(nt),Et&&Et.copy(st))}return this.closestPointToPoint(At,nt),Nt=At.distanceToSquared(nt),Nt<Bt&&(Bt=Nt,_t&&_t.copy(nt),Et&&Et.copy(At)),this.closestPointToPoint(Rt,nt),Nt=Rt.distanceToSquared(nt),Nt<Bt&&(Bt=Nt,_t&&_t.copy(nt),Et&&Et.copy(Rt)),Math.sqrt(Bt)}}();In.prototype.intersectsTriangle=function(){let nt=new In,st=new Array(3),mt=new Array(3),gt=new Dn,_t=new Dn,Et=new E$6,At=new E$6,Rt=new E$6,Ft=new E$6,Nt=new Mi,Bt=new Mi,Gt=new Mi;return function(dr,Mr=null,Tr=!1){this.needsUpdate&&this.update(),dr.isExtendedTriangle?dr.needsUpdate&&dr.update():(nt.copy(dr),nt.update(),dr=nt);let zr=this.plane,Fr=dr.plane;if(Math.abs(zr.normal.dot(Fr.normal))>1-1e-10){let Nr=this.satBounds,tn=this.satAxes;mt[0]=dr.a,mt[1]=dr.b,mt[2]=dr.c;for(let $n=0;$n<4;$n++){let un=Nr[$n],es=tn[$n];if(gt.setFromPoints(es,mt),un.isSeparated(gt))return!1}let rn=dr.satBounds,Tn=dr.satAxes;st[0]=this.a,st[1]=this.b,st[2]=this.c;for(let $n=0;$n<4;$n++){let un=rn[$n],es=Tn[$n];if(gt.setFromPoints(es,st),un.isSeparated(gt))return!1}for(let $n=0;$n<4;$n++){let un=tn[$n];for(let es=0;es<4;es++){let kn=Tn[es];if(Et.crossVectors(un,kn),gt.setFromPoints(Et,st),_t.setFromPoints(Et,mt),gt.isSeparated(_t))return!1}}return Mr&&(Tr||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),Mr.start.set(0,0,0),Mr.end.set(0,0,0)),!0}else{let Nr=this.points,tn=!1,rn=0;for(let ru=0;ru<3;ru++){let uu=Nr[ru],p0=Nr[(ru+1)%3];Nt.start.copy(uu),Nt.end.copy(p0),Nt.delta(At);let X1=tn?Bt.start:Bt.end,q0=ed(Fr.distanceToPoint(uu));if(ed(Fr.normal.dot(At))&&q0){Bt.copy(Nt),rn=2;break}if((Fr.intersectLine(Nt,X1)||q0)&&!ed(X1.distanceTo(p0))){if(rn++,tn)break;tn=!0}}if(rn===1&&dr.containsPoint(Bt.end))return Mr&&(Mr.start.copy(Bt.end),Mr.end.copy(Bt.end)),!0;if(rn!==2)return!1;let Tn=dr.points,$n=!1,un=0;for(let ru=0;ru<3;ru++){let uu=Tn[ru],p0=Tn[(ru+1)%3];Nt.start.copy(uu),Nt.end.copy(p0),Nt.delta(Rt);let X1=$n?Gt.start:Gt.end,q0=ed(zr.distanceToPoint(uu));if(ed(zr.normal.dot(Rt))&&q0){Gt.copy(Nt),un=2;break}if((zr.intersectLine(Nt,X1)||q0)&&!ed(X1.distanceTo(p0))){if(un++,$n)break;$n=!0}}if(un===1&&this.containsPoint(Gt.end))return Mr&&(Mr.start.copy(Gt.end),Mr.end.copy(Gt.end)),!0;if(un!==2)return!1;if(Bt.delta(At),Gt.delta(Rt),At.dot(Rt)<0){let ru=Gt.start;Gt.start=Gt.end,Gt.end=ru}let es=Bt.start.dot(At),kn=Bt.end.dot(At),ts=Gt.start.dot(At),Ko=Gt.end.dot(At),ds=kn<ts,Il=es<Ko;return es!==Ko&&ts!==kn&&ds===Il?!1:(Mr&&(Ft.subVectors(Bt.start,Gt.start),Ft.dot(At)>0?Mr.start.copy(Bt.start):Mr.start.copy(Gt.start),Ft.subVectors(Bt.end,Gt.end),Ft.dot(At)<0?Mr.end.copy(Bt.end):Mr.end.copy(Gt.end)),!0)}}}();In.prototype.distanceToPoint=function(){let nt=new E$6;return function(st){return this.closestPointToPoint(st,nt),st.distanceTo(nt)}}();In.prototype.distanceToTriangle=function(){let nt=new E$6,st=new E$6,mt=["a","b","c"],gt=new Mi,_t=new Mi;return function(Et,At=null,Rt=null){let Ft=At||Rt?gt:null;if(this.intersectsTriangle(Et,Ft))return(At||Rt)&&(At&&Ft.getCenter(At),Rt&&Ft.getCenter(Rt)),0;let Nt=1/0;for(let Bt=0;Bt<3;Bt++){let Gt,dr=mt[Bt],Mr=Et[dr];this.closestPointToPoint(Mr,nt),Gt=Mr.distanceToSquared(nt),Gt<Nt&&(Nt=Gt,At&&At.copy(nt),Rt&&Rt.copy(Mr));let Tr=this[dr];Et.closestPointToPoint(Tr,nt),Gt=Tr.distanceToSquared(nt),Gt<Nt&&(Nt=Gt,At&&At.copy(Tr),Rt&&Rt.copy(nt))}for(let Bt=0;Bt<3;Bt++){let Gt=mt[Bt],dr=mt[(Bt+1)%3];gt.set(this[Gt],this[dr]);for(let Mr=0;Mr<3;Mr++){let Tr=mt[Mr],zr=mt[(Mr+1)%3];_t.set(Et[Tr],Et[zr]),qp(gt,_t,nt,st);let Fr=nt.distanceToSquared(st);Fr<Nt&&(Nt=Fr,At&&At.copy(nt),Rt&&Rt.copy(st))}}return Math.sqrt(Nt)}}();var On=class{constructor(nt,st,mt){this.isOrientedBox=!0,this.min=new E$6,this.max=new E$6,this.matrix=new ue$1,this.invMatrix=new ue$1,this.points=new Array(8).fill().map(()=>new E$6),this.satAxes=new Array(3).fill().map(()=>new E$6),this.satBounds=new Array(3).fill().map(()=>new Dn),this.alignedSatBounds=new Array(3).fill().map(()=>new Dn),this.needsUpdate=!1,nt&&this.min.copy(nt),st&&this.max.copy(st),mt&&this.matrix.copy(mt)}set(nt,st,mt){this.min.copy(nt),this.max.copy(st),this.matrix.copy(mt),this.needsUpdate=!0}copy(nt){this.min.copy(nt.min),this.max.copy(nt.max),this.matrix.copy(nt.matrix),this.needsUpdate=!0}};On.prototype.update=function(){return function(){let nt=this.matrix,st=this.min,mt=this.max,gt=this.points;for(let Ft=0;Ft<=1;Ft++)for(let Nt=0;Nt<=1;Nt++)for(let Bt=0;Bt<=1;Bt++){let Gt=1*Ft|2*Nt|4*Bt,dr=gt[Gt];dr.x=Ft?mt.x:st.x,dr.y=Nt?mt.y:st.y,dr.z=Bt?mt.z:st.z,dr.applyMatrix4(nt)}let _t=this.satBounds,Et=this.satAxes,At=gt[0];for(let Ft=0;Ft<3;Ft++){let Nt=Et[Ft],Bt=_t[Ft],Gt=1<<Ft,dr=gt[Gt];Nt.subVectors(At,dr),Bt.setFromPoints(Nt,gt)}let Rt=this.alignedSatBounds;Rt[0].setFromPointsField(gt,"x"),Rt[1].setFromPointsField(gt,"y"),Rt[2].setFromPointsField(gt,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();On.prototype.intersectsBox=function(){let nt=new Dn;return function(st){this.needsUpdate&&this.update();let mt=st.min,gt=st.max,_t=this.satBounds,Et=this.satAxes,At=this.alignedSatBounds;if(nt.min=mt.x,nt.max=gt.x,At[0].isSeparated(nt)||(nt.min=mt.y,nt.max=gt.y,At[1].isSeparated(nt))||(nt.min=mt.z,nt.max=gt.z,At[2].isSeparated(nt)))return!1;for(let Rt=0;Rt<3;Rt++){let Ft=Et[Rt],Nt=_t[Rt];if(nt.setFromBox(Ft,st),Nt.isSeparated(nt))return!1}return!0}}();On.prototype.intersectsTriangle=function(){let nt=new In,st=new Array(3),mt=new Dn,gt=new Dn,_t=new E$6;return function(Et){this.needsUpdate&&this.update(),Et.isExtendedTriangle?Et.needsUpdate&&Et.update():(nt.copy(Et),nt.update(),Et=nt);let At=this.satBounds,Rt=this.satAxes;st[0]=Et.a,st[1]=Et.b,st[2]=Et.c;for(let Gt=0;Gt<3;Gt++){let dr=At[Gt],Mr=Rt[Gt];if(mt.setFromPoints(Mr,st),dr.isSeparated(mt))return!1}let Ft=Et.satBounds,Nt=Et.satAxes,Bt=this.points;for(let Gt=0;Gt<3;Gt++){let dr=Ft[Gt],Mr=Nt[Gt];if(mt.setFromPoints(Mr,Bt),dr.isSeparated(mt))return!1}for(let Gt=0;Gt<3;Gt++){let dr=Rt[Gt];for(let Mr=0;Mr<4;Mr++){let Tr=Nt[Mr];if(_t.crossVectors(dr,Tr),mt.setFromPoints(_t,st),gt.setFromPoints(_t,Bt),mt.isSeparated(gt))return!1}}return!0}}();On.prototype.closestPointToPoint=function(){return function(nt,st){return this.needsUpdate&&this.update(),st.copy(nt).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),st}}();On.prototype.distanceToPoint=function(){let nt=new E$6;return function(st){return this.closestPointToPoint(st,nt),st.distanceTo(nt)}}();On.prototype.distanceToBox=function(){let nt=["x","y","z"],st=new Array(12).fill().map(()=>new Mi),mt=new Array(12).fill().map(()=>new Mi),gt=new E$6,_t=new E$6;return function(Et,At=0,Rt=null,Ft=null){if(this.needsUpdate&&this.update(),this.intersectsBox(Et))return(Rt||Ft)&&(Et.getCenter(_t),this.closestPointToPoint(_t,gt),Et.closestPointToPoint(gt,_t),Rt&&Rt.copy(gt),Ft&&Ft.copy(_t)),0;let Nt=At*At,Bt=Et.min,Gt=Et.max,dr=this.points,Mr=1/0;for(let zr=0;zr<8;zr++){let Fr=dr[zr];_t.copy(Fr).clamp(Bt,Gt);let Nr=Fr.distanceToSquared(_t);if(Nr<Mr&&(Mr=Nr,Rt&&Rt.copy(Fr),Ft&&Ft.copy(_t),Nr<Nt))return Math.sqrt(Nr)}let Tr=0;for(let zr=0;zr<3;zr++)for(let Fr=0;Fr<=1;Fr++)for(let Nr=0;Nr<=1;Nr++){let tn=(zr+1)%3,rn=(zr+2)%3,Tn=Fr<<tn|Nr<<rn,$n=1<<zr|Fr<<tn|Nr<<rn,un=dr[Tn],es=dr[$n];st[Tr].set(un,es);let kn=nt[zr],ts=nt[tn],Ko=nt[rn],ds=mt[Tr],Il=ds.start,ru=ds.end;Il[kn]=Bt[kn],Il[ts]=Fr?Bt[ts]:Gt[ts],Il[Ko]=Nr?Bt[Ko]:Gt[ts],ru[kn]=Gt[kn],ru[ts]=Fr?Bt[ts]:Gt[ts],ru[Ko]=Nr?Bt[Ko]:Gt[ts],Tr++}for(let zr=0;zr<=1;zr++)for(let Fr=0;Fr<=1;Fr++)for(let Nr=0;Nr<=1;Nr++){_t.x=zr?Gt.x:Bt.x,_t.y=Fr?Gt.y:Bt.y,_t.z=Nr?Gt.z:Bt.z,this.closestPointToPoint(_t,gt);let tn=_t.distanceToSquared(gt);if(tn<Mr&&(Mr=tn,Rt&&Rt.copy(gt),Ft&&Ft.copy(_t),tn<Nt))return Math.sqrt(tn)}for(let zr=0;zr<12;zr++){let Fr=st[zr];for(let Nr=0;Nr<12;Nr++){let tn=mt[Nr];qp(Fr,tn,gt,_t);let rn=gt.distanceToSquared(_t);if(rn<Mr&&(Mr=rn,Rt&&Rt.copy(gt),Ft&&Ft.copy(_t),rn<Nt))return Math.sqrt(rn)}}return Math.sqrt(Mr)}}();var td=new E$6,rd=new E$6,id=new E$6,r0=new U$1,i0=new U$1,n0=new U$1,CI=new E$6,PI=new E$6,_I=new E$6,s0=new E$6;function Y9(nt,st,mt,gt,_t,Et){let At;return Et===pi?At=nt.intersectTriangle(gt,mt,st,!0,_t):At=nt.intersectTriangle(st,mt,gt,Et!==fi,_t),At===null?null:{distance:nt.origin.distanceTo(_t),point:_t.clone()}}function X9(nt,st,mt,gt,_t,Et,At,Rt,Ft){td.fromBufferAttribute(st,Et),rd.fromBufferAttribute(st,At),id.fromBufferAttribute(st,Rt);let Nt=Y9(nt,td,rd,id,s0,Ft);if(Nt){gt&&(r0.fromBufferAttribute(gt,Et),i0.fromBufferAttribute(gt,At),n0.fromBufferAttribute(gt,Rt),Nt.uv=Cr.getInterpolation(s0,td,rd,id,r0,i0,n0,new U$1)),_t&&(r0.fromBufferAttribute(_t,Et),i0.fromBufferAttribute(_t,At),n0.fromBufferAttribute(_t,Rt),Nt.uv1=Cr.getInterpolation(s0,td,rd,id,r0,i0,n0,new U$1)),mt&&(CI.fromBufferAttribute(mt,Et),PI.fromBufferAttribute(mt,At),_I.fromBufferAttribute(mt,Rt),Nt.normal=Cr.getInterpolation(s0,td,rd,id,CI,PI,_I,new E$6),Nt.normal.dot(nt.direction)>0&&Nt.normal.multiplyScalar(-1));let Bt={a:Et,b:At,c:Rt,normal:new E$6,materialIndex:0};Cr.getNormal(td,rd,id,Bt.normal),Nt.face=Bt,Nt.faceIndex=Et}return Nt}function Q1(nt,st,mt,gt,_t){let Et=gt*3,At=nt.index.getX(Et),Rt=nt.index.getX(Et+1),Ft=nt.index.getX(Et+2),{position:Nt,normal:Bt,uv:Gt,uv1:dr}=nt.attributes,Mr=X9(mt,Nt,Bt,Gt,dr,At,Rt,Ft,st);return Mr?(Mr.faceIndex=gt,_t&&_t.push(Mr),Mr):null}function DI(nt,st,mt,gt,_t,Et){for(let At=gt,Rt=gt+_t;At<Rt;At++)Q1(nt,st,mt,At,Et)}function II(nt,st,mt,gt,_t){let Et=1/0,At=null;for(let Rt=gt,Ft=gt+_t;Rt<Ft;Rt++){let Nt=Q1(nt,st,mt,Rt);Nt&&Nt.distance<Et&&(At=Nt,Et=Nt.distance)}return At}function ps(nt,st,mt,gt){let _t=nt.a,Et=nt.b,At=nt.c,Rt=st,Ft=st+1,Nt=st+2;mt&&(Rt=mt.getX(st),Ft=mt.getX(st+1),Nt=mt.getX(st+2)),_t.x=gt.getX(Rt),_t.y=gt.getY(Rt),_t.z=gt.getZ(Rt),Et.x=gt.getX(Ft),Et.y=gt.getY(Ft),Et.z=gt.getZ(Ft),At.x=gt.getX(Nt),At.y=gt.getY(Nt),At.z=gt.getZ(Nt)}function K1(nt,st,mt,gt,_t,Et,At){let Rt=mt.index,Ft=mt.attributes.position;for(let Nt=nt,Bt=st+nt;Nt<Bt;Nt++)if(ps(At,Nt*3,Rt,Ft),At.needsUpdate=!0,gt(At,Nt,_t,Et))return!0;return!1}var nd=class{constructor(nt){this._getNewPrimitive=nt,this._primitives=[]}getPrimitive(){let nt=this._primitives;return nt.length===0?this._getNewPrimitive():nt.pop()}releasePrimitive(nt){this._primitives.push(nt)}};function Ta(nt,st){return st[nt+15]===65535}function Rc(nt,st){return st[nt+6]}function sd(nt,st){return st[nt+14]}function od(nt){return nt+8}function ad(nt,st){return st[nt+6]}function OI(nt,st){return st[nt+7]}var ld=new jt,a0=new E$6,K9=["x","y","z"];function l0(nt,st,mt,gt,_t){let Et=nt*2,At=cd,Rt=Tl,Ft=Cl;if(Ta(Et,Rt)){let Nt=Rc(nt,Ft),Bt=sd(Et,Rt);DI(st,mt,gt,Nt,Bt,_t)}else{let Nt=od(nt);u0(Nt,At,gt,a0)&&l0(Nt,st,mt,gt,_t);let Bt=ad(nt,Ft);u0(Bt,At,gt,a0)&&l0(Bt,st,mt,gt,_t)}}function c0(nt,st,mt,gt){let _t=nt*2,Et=cd,At=Tl,Rt=Cl;if(Ta(_t,At)){let Ft=Rc(nt,Rt),Nt=sd(_t,At);return II(st,mt,gt,Ft,Nt)}else{let Ft=OI(nt,Rt),Nt=K9[Ft],Bt=gt.direction[Nt]>=0,Gt,dr;Bt?(Gt=od(nt),dr=ad(nt,Rt)):(Gt=ad(nt,Rt),dr=od(nt));let Mr=u0(Gt,Et,gt,a0)?c0(Gt,st,mt,gt):null;if(Mr){let zr=Mr.point[Nt];if(Bt?zr<=Et[dr+Ft]:zr>=Et[dr+Ft+3])return Mr}let Tr=u0(dr,Et,gt,a0)?c0(dr,st,mt,gt):null;return Mr&&Tr?Mr.distance<=Tr.distance?Mr:Tr:Mr||Tr||null}}var RI=function(){let nt,st,mt=[],gt=new nd(()=>new jt);return function(...Et){nt=gt.getPrimitive(),st=gt.getPrimitive(),mt.push(nt,st);let At=_t(...Et);gt.releasePrimitive(nt),gt.releasePrimitive(st),mt.pop(),mt.pop();let Rt=mt.length;return Rt>0&&(st=mt[Rt-1],nt=mt[Rt-2]),At};function _t(Et,At,Rt,Ft,Nt=null,Bt=0,Gt=0){function dr(tn){let rn=tn*2,Tn=Tl,$n=Cl;for(;!Ta(rn,Tn);)tn=od(tn),rn=tn*2;return Rc(tn,$n)}function Mr(tn){let rn=tn*2,Tn=Tl,$n=Cl;for(;!Ta(rn,Tn);)tn=ad(tn,$n),rn=tn*2;return Rc(tn,$n)+sd(rn,Tn)}let Tr=Et*2,zr=cd,Fr=Tl,Nr=Cl;if(Ta(Tr,Fr)){let tn=Rc(Et,Nr),rn=sd(Tr,Fr);return fs(Et,zr,nt),Ft(tn,rn,!1,Gt,Bt+Et,nt)}else{let tn=od(Et),rn=ad(Et,Nr),Tn=tn,$n=rn,un,es,kn,ts;if(Nt&&(kn=nt,ts=st,fs(Tn,zr,kn),fs($n,zr,ts),un=Nt(kn),es=Nt(ts),es<un)){Tn=rn,$n=tn;let X1=un;un=es,es=X1,kn=ts}kn||(kn=nt,fs(Tn,zr,kn));let Ko=Ta(Tn*2,Fr),ds=Rt(kn,Ko,un,Gt+1,Bt+Tn),Il;if(ds===2){let X1=dr(Tn),q0=Mr(Tn)-X1;Il=Ft(X1,q0,!0,Gt+1,Bt+Tn,kn)}else Il=ds&&_t(Tn,At,Rt,Ft,Nt,Bt,Gt+1);if(Il)return!0;ts=st,fs($n,zr,ts);let ru=Ta($n*2,Fr),uu=Rt(ts,ru,es,Gt+1,Bt+$n),p0;if(uu===2){let X1=dr($n),q0=Mr($n)-X1;p0=Ft(X1,q0,!0,Gt+1,Bt+$n,ts)}else p0=uu&&_t($n,At,Rt,Ft,Nt,Bt,Gt+1);return!!p0}}}(),LI=function(){let nt=new In,st=new In,mt=new ue$1,gt=new On,_t=new On;return function Et(At,Rt,Ft,Nt,Bt=null){let Gt=At*2,dr=cd,Mr=Tl,Tr=Cl;if(Bt===null&&(Ft.boundingBox||Ft.computeBoundingBox(),gt.set(Ft.boundingBox.min,Ft.boundingBox.max,Nt),Bt=gt),Ta(Gt,Mr)){let zr=Rt,Fr=zr.index,Nr=zr.attributes.position,tn=Ft.index,rn=Ft.attributes.position,Tn=Rc(At,Tr),$n=sd(Gt,Mr);if(mt.copy(Nt).invert(),Ft.boundsTree)return fs(At,dr,_t),_t.matrix.copy(mt),_t.needsUpdate=!0,Ft.boundsTree.shapecast({intersectsBounds:un=>_t.intersectsBox(un),intersectsTriangle:un=>{un.a.applyMatrix4(Nt),un.b.applyMatrix4(Nt),un.c.applyMatrix4(Nt),un.needsUpdate=!0;for(let es=Tn*3,kn=($n+Tn)*3;es<kn;es+=3)if(ps(st,es,Fr,Nr),st.needsUpdate=!0,un.intersectsTriangle(st))return!0;return!1}});for(let un=Tn*3,es=$n+Tn*3;un<es;un+=3){ps(nt,un,Fr,Nr),nt.a.applyMatrix4(mt),nt.b.applyMatrix4(mt),nt.c.applyMatrix4(mt),nt.needsUpdate=!0;for(let kn=0,ts=tn.count;kn<ts;kn+=3)if(ps(st,kn,tn,rn),st.needsUpdate=!0,nt.intersectsTriangle(st))return!0}}else{let zr=At+8,Fr=Tr[At+6];return fs(zr,dr,ld),!!(Bt.intersectsBox(ld)&&Et(zr,Rt,Ft,Nt,Bt)||(fs(Fr,dr,ld),Bt.intersectsBox(ld)&&Et(Fr,Rt,Ft,Nt,Bt)))}}}();function u0(nt,st,mt,gt){return fs(nt,st,ld),mt.intersectBox(ld,gt)}var Z1=[],o0,cd,Tl,Cl;function ud(nt){o0&&Z1.push(o0),o0=nt,cd=new Float32Array(nt),Tl=new Uint16Array(nt),Cl=new Uint32Array(nt)}function Yp(){o0=null,cd=null,Tl=null,Cl=null,Z1.length&&ud(Z1.pop())}var J1=Symbol("skip tree generation"),$1=new jt,eA=new jt,hd=new ue$1,Lc=new On,Xp=new On,Qp=new E$6,h0=new E$6,Z9=new E$6,J9=new E$6,$9=new E$6,BI=new jt,Co=new nd(()=>new In),Po=class{static serialize(nt,st={}){if(st.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),Po.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});st={cloneBuffers:!0,...st};let mt=nt.geometry,gt=nt._roots,_t=mt.getIndex(),Et;return st.cloneBuffers?Et={roots:gt.map(At=>At.slice()),index:_t.array.slice()}:Et={roots:gt,index:_t.array},Et}static deserialize(nt,st,mt={}){if(typeof mt=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),Po.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});mt={setIndex:!0,...mt};let{index:gt,roots:_t}=nt,Et=new Po(st,{...mt,[J1]:!0});if(Et._roots=_t,mt.setIndex){let At=st.getIndex();if(At===null){let Rt=new Xe$1(nt.index,1,!1);st.setIndex(Rt)}else At.array!==gt&&(At.array.set(gt),At.needsUpdate=!0)}return Et}constructor(nt,st={}){if(nt.isBufferGeometry){if(nt.index&&nt.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(st=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[J1]:!1},st),st.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,st[J1]||(this._roots=MI(nt,st),!nt.boundingBox&&st.setBoundingBox&&(nt.boundingBox=this.getBoundingBox(new jt))),this.geometry=nt}refit(nt=null){nt&&Array.isArray(nt)&&(nt=new Set(nt));let st=this.geometry,mt=st.index.array,gt=st.attributes.position,_t,Et,At,Rt,Ft=0,Nt=this._roots;for(let Gt=0,dr=Nt.length;Gt<dr;Gt++)_t=Nt[Gt],Et=new Uint32Array(_t),At=new Uint16Array(_t),Rt=new Float32Array(_t),Bt(0,Ft),Ft+=_t.byteLength;function Bt(Gt,dr,Mr=!1){let Tr=Gt*2;if(At[Tr+15]===65535){let zr=Et[Gt+6],Fr=At[Tr+14],Nr=1/0,tn=1/0,rn=1/0,Tn=-1/0,$n=-1/0,un=-1/0;for(let es=3*zr,kn=3*(zr+Fr);es<kn;es++){let ts=mt[es],Ko=gt.getX(ts),ds=gt.getY(ts),Il=gt.getZ(ts);Ko<Nr&&(Nr=Ko),Ko>Tn&&(Tn=Ko),ds<tn&&(tn=ds),ds>$n&&($n=ds),Il<rn&&(rn=Il),Il>un&&(un=Il)}return Rt[Gt+0]!==Nr||Rt[Gt+1]!==tn||Rt[Gt+2]!==rn||Rt[Gt+3]!==Tn||Rt[Gt+4]!==$n||Rt[Gt+5]!==un?(Rt[Gt+0]=Nr,Rt[Gt+1]=tn,Rt[Gt+2]=rn,Rt[Gt+3]=Tn,Rt[Gt+4]=$n,Rt[Gt+5]=un,!0):!1}else{let zr=Gt+8,Fr=Et[Gt+6],Nr=zr+dr,tn=Fr+dr,rn=Mr,Tn=!1,$n=!1;nt?rn||(Tn=nt.has(Nr),$n=nt.has(tn),rn=!Tn&&!$n):(Tn=!0,$n=!0);let un=rn||Tn,es=rn||$n,kn=!1;un&&(kn=Bt(zr,dr,rn));let ts=!1;es&&(ts=Bt(Fr,dr,rn));let Ko=kn||ts;if(Ko)for(let ds=0;ds<3;ds++){let Il=zr+ds,ru=Fr+ds,uu=Rt[Il],p0=Rt[Il+3],X1=Rt[ru],q0=Rt[ru+3];Rt[Gt+ds]=uu<X1?uu:X1,Rt[Gt+ds+3]=p0>q0?p0:q0}return Ko}}}traverse(nt,st=0){let mt=this._roots[st],gt=new Uint32Array(mt),_t=new Uint16Array(mt);Et(0);function Et(At,Rt=0){let Ft=At*2,Nt=_t[Ft+15]===65535;if(Nt){let Bt=gt[At+6],Gt=_t[Ft+14];nt(Rt,Nt,new Float32Array(mt,At*4,6),Bt,Gt)}else{let Bt=At+8,Gt=gt[At+6],dr=gt[At+7];nt(Rt,Nt,new Float32Array(mt,At*4,6),dr)||(Et(Bt,Rt+1),Et(Gt,Rt+1))}}}raycast(nt,st=Hn){let mt=this._roots,gt=this.geometry,_t=[],Et=st.isMaterial,At=Array.isArray(st),Rt=gt.groups,Ft=Et?st.side:st;for(let Nt=0,Bt=mt.length;Nt<Bt;Nt++){let Gt=At?st[Rt[Nt].materialIndex].side:Ft,dr=_t.length;if(ud(mt[Nt]),l0(0,gt,Gt,nt,_t),Yp(),At){let Mr=Rt[Nt].materialIndex;for(let Tr=dr,zr=_t.length;Tr<zr;Tr++)_t[Tr].face.materialIndex=Mr}}return _t}raycastFirst(nt,st=Hn){let mt=this._roots,gt=this.geometry,_t=st.isMaterial,Et=Array.isArray(st),At=null,Rt=gt.groups,Ft=_t?st.side:st;for(let Nt=0,Bt=mt.length;Nt<Bt;Nt++){let Gt=Et?st[Rt[Nt].materialIndex].side:Ft;ud(mt[Nt]);let dr=c0(0,gt,Gt,nt);Yp(),dr!=null&&(At==null||dr.distance<At.distance)&&(At=dr,Et&&(dr.face.materialIndex=Rt[Nt].materialIndex))}return At}intersectsGeometry(nt,st){let mt=this.geometry,gt=!1;for(let _t of this._roots)if(ud(_t),gt=LI(0,mt,nt,st),Yp(),gt)break;return gt}shapecast(nt,st,mt){let gt=this.geometry;if(nt instanceof Function){if(st){let Gt=st;st=(dr,Mr,Tr,zr)=>{let Fr=Mr*3;return Gt(dr,Fr,Fr+1,Fr+2,Tr,zr)}}nt={boundsTraverseOrder:mt,intersectsBounds:nt,intersectsTriangle:st,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let _t=Co.getPrimitive(),{boundsTraverseOrder:Et,intersectsBounds:At,intersectsRange:Rt,intersectsTriangle:Ft}=nt;if(Rt&&Ft){let Gt=Rt;Rt=(dr,Mr,Tr,zr,Fr)=>Gt(dr,Mr,Tr,zr,Fr)?!0:K1(dr,Mr,gt,Ft,Tr,zr,_t)}else Rt||(Ft?Rt=(Gt,dr,Mr,Tr)=>K1(Gt,dr,gt,Ft,Mr,Tr,_t):Rt=(Gt,dr,Mr)=>Mr);let Nt=!1,Bt=0;for(let Gt of this._roots){if(ud(Gt),Nt=RI(0,gt,At,Rt,Et,Bt),Yp(),Nt)break;Bt+=Gt.byteLength}return Co.releasePrimitive(_t),Nt}bvhcast(nt,st,mt){let{intersectsRanges:gt,intersectsTriangles:_t}=mt,Et=this.geometry.index,At=this.geometry.attributes.position,Rt=nt.geometry.index,Ft=nt.geometry.attributes.position;hd.copy(st).invert();let Nt=Co.getPrimitive(),Bt=Co.getPrimitive();if(_t){let dr=function(Mr,Tr,zr,Fr,Nr,tn,rn,Tn){for(let $n=zr,un=zr+Fr;$n<un;$n++){ps(Bt,$n*3,Rt,Ft),Bt.a.applyMatrix4(st),Bt.b.applyMatrix4(st),Bt.c.applyMatrix4(st),Bt.needsUpdate=!0;for(let es=Mr,kn=Mr+Tr;es<kn;es++)if(ps(Nt,es*3,Et,At),Nt.needsUpdate=!0,_t(Nt,Bt,es,$n,Nr,tn,rn,Tn))return!0}return!1};if(gt){let Mr=gt;gt=function(Tr,zr,Fr,Nr,tn,rn,Tn,$n){return Mr(Tr,zr,Fr,Nr,tn,rn,Tn,$n)?!0:dr(Tr,zr,Fr,Nr,tn,rn,Tn,$n)}}else gt=dr}nt.getBoundingBox(eA),eA.applyMatrix4(st);let Gt=this.shapecast({intersectsBounds:dr=>eA.intersectsBox(dr),intersectsRange:(dr,Mr,Tr,zr,Fr,Nr)=>($1.copy(Nr),$1.applyMatrix4(hd),nt.shapecast({intersectsBounds:tn=>$1.intersectsBox(tn),intersectsRange:(tn,rn,Tn,$n,un)=>gt(dr,Mr,tn,rn,zr,Fr,$n,un)}))});return Co.releasePrimitive(Nt),Co.releasePrimitive(Bt),Gt}intersectsBox(nt,st){return Lc.set(nt.min,nt.max,st),Lc.needsUpdate=!0,this.shapecast({intersectsBounds:mt=>Lc.intersectsBox(mt),intersectsTriangle:mt=>Lc.intersectsTriangle(mt)})}intersectsSphere(nt){return this.shapecast({intersectsBounds:st=>nt.intersectsBox(st),intersectsTriangle:st=>st.intersectsSphere(nt)})}closestPointToGeometry(nt,st,mt={},gt={},_t=0,Et=1/0){nt.boundingBox||nt.computeBoundingBox(),Lc.set(nt.boundingBox.min,nt.boundingBox.max,st),Lc.needsUpdate=!0;let At=this.geometry,Rt=At.attributes.position,Ft=At.index,Nt=nt.attributes.position,Bt=nt.index,Gt=Co.getPrimitive(),dr=Co.getPrimitive(),Mr=h0,Tr=Z9,zr=null,Fr=null;gt&&(zr=J9,Fr=$9);let Nr=1/0,tn=null,rn=null;return hd.copy(st).invert(),Xp.matrix.copy(hd),this.shapecast({boundsTraverseOrder:Tn=>Lc.distanceToBox(Tn),intersectsBounds:(Tn,$n,un)=>un<Nr&&un<Et?($n&&(Xp.min.copy(Tn.min),Xp.max.copy(Tn.max),Xp.needsUpdate=!0),!0):!1,intersectsRange:(Tn,$n)=>{if(nt.boundsTree)return nt.boundsTree.shapecast({boundsTraverseOrder:un=>Xp.distanceToBox(un),intersectsBounds:(un,es,kn)=>kn<Nr&&kn<Et,intersectsRange:(un,es)=>{for(let kn=un*3,ts=(un+es)*3;kn<ts;kn+=3){ps(dr,kn,Bt,Nt),dr.a.applyMatrix4(st),dr.b.applyMatrix4(st),dr.c.applyMatrix4(st),dr.needsUpdate=!0;for(let Ko=Tn*3,ds=(Tn+$n)*3;Ko<ds;Ko+=3){ps(Gt,Ko,Ft,Rt),Gt.needsUpdate=!0;let Il=Gt.distanceToTriangle(dr,Mr,zr);if(Il<Nr&&(Tr.copy(Mr),Fr&&Fr.copy(zr),Nr=Il,tn=Ko/3,rn=kn/3),Il<_t)return!0}}}});{let un=Bt?Bt.count:Nt.count;for(let es=0,kn=un;es<kn;es+=3){ps(dr,es,Bt,Nt),dr.a.applyMatrix4(st),dr.b.applyMatrix4(st),dr.c.applyMatrix4(st),dr.needsUpdate=!0;for(let ts=Tn*3,Ko=(Tn+$n)*3;ts<Ko;ts+=3){ps(Gt,ts,Ft,Rt),Gt.needsUpdate=!0;let ds=Gt.distanceToTriangle(dr,Mr,zr);if(ds<Nr&&(Tr.copy(Mr),Fr&&Fr.copy(zr),Nr=ds,tn=ts/3,rn=es/3),ds<_t)return!0}}}}}),Co.releasePrimitive(Gt),Co.releasePrimitive(dr),Nr===1/0?null:(mt.point?mt.point.copy(Tr):mt.point=Tr.clone(),mt.distance=Nr,mt.faceIndex=tn,gt&&(gt.point?gt.point.copy(Fr):gt.point=Fr.clone(),gt.point.applyMatrix4(hd),Tr.applyMatrix4(hd),gt.distance=Tr.sub(gt.point).length(),gt.faceIndex=rn),mt)}closestPointToPoint(nt,st={},mt=0,gt=1/0){let _t=mt*mt,Et=gt*gt,At=1/0,Rt=null;if(this.shapecast({boundsTraverseOrder:Nt=>(Qp.copy(nt).clamp(Nt.min,Nt.max),Qp.distanceToSquared(nt)),intersectsBounds:(Nt,Bt,Gt)=>Gt<At&&Gt<Et,intersectsTriangle:(Nt,Bt)=>{Nt.closestPointToPoint(nt,Qp);let Gt=nt.distanceToSquared(Qp);return Gt<At&&(h0.copy(Qp),At=Gt,Rt=Bt),Gt<_t}}),At===1/0)return null;let Ft=Math.sqrt(At);return st.point?st.point.copy(h0):st.point=h0.clone(),st.distance=Ft,st.faceIndex=Rt,st}getBoundingBox(nt){return nt.makeEmpty(),this._roots.forEach(st=>{fs(0,new Float32Array(st),BI),nt.union(BI)}),nt}},tf=Jo(FI()),e7=.5*(Math.sqrt(3)-1),Kp=(3-Math.sqrt(3))/6,t7=1/3,_o=1/6,Zp=nt=>Math.floor(nt)|0,VI=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),rA=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function d0(nt=Math.random){let st=zI(nt),mt=new Float64Array(st).map(_t=>VI[_t%12*2]),gt=new Float64Array(st).map(_t=>VI[_t%12*2+1]);return function(_t,Et){let At=0,Rt=0,Ft=0,Nt=(_t+Et)*e7,Bt=Zp(_t+Nt),Gt=Zp(Et+Nt),dr=(Bt+Gt)*Kp,Mr=Bt-dr,Tr=Gt-dr,zr=_t-Mr,Fr=Et-Tr,Nr,tn;zr>Fr?(Nr=1,tn=0):(Nr=0,tn=1);let rn=zr-Nr+Kp,Tn=Fr-tn+Kp,$n=zr-1+2*Kp,un=Fr-1+2*Kp,es=Bt&255,kn=Gt&255,ts=.5-zr*zr-Fr*Fr;if(ts>=0){let Il=es+st[kn],ru=mt[Il],uu=gt[Il];ts*=ts,At=ts*ts*(ru*zr+uu*Fr)}let Ko=.5-rn*rn-Tn*Tn;if(Ko>=0){let Il=es+Nr+st[kn+tn],ru=mt[Il],uu=gt[Il];Ko*=Ko,Rt=Ko*Ko*(ru*rn+uu*Tn)}let ds=.5-$n*$n-un*un;if(ds>=0){let Il=es+1+st[kn+1],ru=mt[Il],uu=gt[Il];ds*=ds,Ft=ds*ds*(ru*$n+uu*un)}return 70*(At+Rt+Ft)}}function UI(nt=Math.random){let st=zI(nt),mt=new Float64Array(st).map(Et=>rA[Et%12*3]),gt=new Float64Array(st).map(Et=>rA[Et%12*3+1]),_t=new Float64Array(st).map(Et=>rA[Et%12*3+2]);return function(Et,At,Rt){let Ft,Nt,Bt,Gt,dr=(Et+At+Rt)*t7,Mr=Zp(Et+dr),Tr=Zp(At+dr),zr=Zp(Rt+dr),Fr=(Mr+Tr+zr)*_o,Nr=Mr-Fr,tn=Tr-Fr,rn=zr-Fr,Tn=Et-Nr,$n=At-tn,un=Rt-rn,es,kn,ts,Ko,ds,Il;Tn>=$n?$n>=un?(es=1,kn=0,ts=0,Ko=1,ds=1,Il=0):Tn>=un?(es=1,kn=0,ts=0,Ko=1,ds=0,Il=1):(es=0,kn=0,ts=1,Ko=1,ds=0,Il=1):$n<un?(es=0,kn=0,ts=1,Ko=0,ds=1,Il=1):Tn<un?(es=0,kn=1,ts=0,Ko=0,ds=1,Il=1):(es=0,kn=1,ts=0,Ko=1,ds=1,Il=0);let ru=Tn-es+_o,uu=$n-kn+_o,p0=un-ts+_o,X1=Tn-Ko+2*_o,q0=$n-ds+2*_o,W0=un-Il+2*_o,hu=Tn-1+3*_o,a1=$n-1+3*_o,Vx=un-1+3*_o,t0=Mr&255,cu=Tr&255,lu=zr&255,b0=.6-Tn*Tn-$n*$n-un*un;if(b0<0)Ft=0;else{let SA=t0+st[cu+st[lu]];b0*=b0,Ft=b0*b0*(mt[SA]*Tn+gt[SA]*$n+_t[SA]*un)}let l1=.6-ru*ru-uu*uu-p0*p0;if(l1<0)Nt=0;else{let SA=t0+es+st[cu+kn+st[lu+ts]];l1*=l1,Nt=l1*l1*(mt[SA]*ru+gt[SA]*uu+_t[SA]*p0)}let LE=.6-X1*X1-q0*q0-W0*W0;if(LE<0)Bt=0;else{let SA=t0+Ko+st[cu+ds+st[lu+Il]];LE*=LE,Bt=LE*LE*(mt[SA]*X1+gt[SA]*q0+_t[SA]*W0)}let eS=.6-hu*hu-a1*a1-Vx*Vx;if(eS<0)Gt=0;else{let SA=t0+1+st[cu+1+st[lu+1]];eS*=eS,Gt=eS*eS*(mt[SA]*hu+gt[SA]*a1+_t[SA]*Vx)}return 32*(Ft+Nt+Bt+Gt)}}function zI(nt){let st=new Uint8Array(512);for(let mt=0;mt<512/2;mt++)st[mt]=mt;for(let mt=0;mt<512/2-1;mt++){let gt=mt+~~(nt()*(256-mt)),_t=st[mt];st[mt]=st[gt],st[gt]=_t}for(let mt=256;mt<512;mt++)st[mt]=st[mt-256];return st}var Gs=new Cr,f0=class{constructor(nt){this.weightAttribute=null;let st=nt.geometry;if(!st.isBufferGeometry||st.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");st.index&&(st=st.toNonIndexed()),this.geometry=st,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let nt=this.positionAttribute,st=new Float32Array(nt.count/3);for(let gt=0;gt<nt.count;gt+=3){let _t=1;Gs.a.fromBufferAttribute(nt,gt),Gs.b.fromBufferAttribute(nt,gt+1),Gs.c.fromBufferAttribute(nt,gt+2),_t*=Gs.getArea(),st[gt/3]=_t}this.distribution=new Float32Array(nt.count/3);let mt=0;for(let gt=0;gt<st.length;gt++)mt+=st[gt],this.distribution[gt]=mt;return this}setRandomGenerator(nt){return this.randomFunction=nt,this}sample(nt,st){if(this.distribution){let mt=this.distribution[this.distribution.length-1],gt=this.binarySearch(this.randomFunction()*mt);return this.sampleFace(gt,nt,st)}}binarySearch(nt){if(!this.distribution)return 0;let st=this.distribution,mt=0,gt=st.length-1,_t=-1;for(;mt<=gt;){let Et=Math.ceil((mt+gt)/2);if(Et===0||st[Et-1]<=nt&&st[Et]>nt){_t=Et;break}else nt<st[Et]?gt=Et-1:mt=Et+1}return _t}sampleFace(nt,st,mt){let gt=this.randomFunction(),_t=this.randomFunction();return gt+_t>1&&(gt=1-gt,_t=1-_t),Gs.a.fromBufferAttribute(this.positionAttribute,nt*3),Gs.b.fromBufferAttribute(this.positionAttribute,nt*3+1),Gs.c.fromBufferAttribute(this.positionAttribute,nt*3+2),st.set(0,0,0).addScaledVector(Gs.a,gt).addScaledVector(Gs.b,_t).addScaledVector(Gs.c,1-(gt+_t)),Gs.getNormal(mt),this}},GI=Jo(iA()),r7=new ue$1,i7=new ue$1,n7=new ue$1,dd;(nt=>{function st(mt){return mt&&mt.__isSPEObject}nt.is=st})(dd||(dd={}));var fd=nt=>class extends nt{constructor(){super(...arguments),this.previousModelViewMatrix=new ue$1,this.copyPreviousMatrix=!0,this.hiddenMatrix=new ue$1,this.matrixWorldRigid=new ue$1,this.shearScale=new ue$1,this.shearScaleInv=new ue$1}get __isSPEObject(){return!0}isDescendantOf(st){st instanceof Mt&&(st=st.uuid);let mt=this;for(;mt.parent;){if(mt.parent.uuid===st)return!0;mt=mt.parent}return!1}updateMatrixWorld(st){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||st)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,st=!0);for(let mt of this.children)mt.updateMatrixWorld(st)}updateWorldMatrix(st,mt){let gt=this.parent;if(st&&gt!==null&&gt.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),mt)for(let _t of this.children)_t.updateWorldMatrix(!1,!0)}traverseChildren(st,mt=0){for(let gt of this.children)dd.is(gt)&&gt.traverseObject(st,mt+1)}traverseObject(st,mt=0){if(st(this,mt)!==!0)for(let gt of this.children)dd.is(gt)&&gt.traverseObject(st,mt+1)}updateMatrixWorldSVD(){let st=this.matrixWorld.elements,mt=[[st[0],st[4],st[8]],[st[1],st[5],st[9]],[st[2],st[6],st[10]]],{u:gt,v:_t,q:Et}=(0,GI.SVD)(mt),At=r7.set(gt[0][0],gt[0][1],gt[0][2],0,gt[1][0],gt[1][1],gt[1][2],0,gt[2][0],gt[2][1],gt[2][2],0,0,0,0,1),Rt=i7.set(_t[0][0],_t[0][1],_t[0][2],0,_t[1][0],_t[1][1],_t[1][2],0,_t[2][0],_t[2][1],_t[2][2],0,0,0,0,1),Ft=n7.copy(Rt).transpose();this.shearScale.makeScale(Et[0],Et[1],Et[2]).multiply(Ft).premultiply(Rt),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(At,Ft).copyPosition(this.matrixWorld),Et.every(Nt=>Math.abs(Et[0]-Nt)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(st,mt){this.updateWorldMatrix(!0,!1);let gt=new ue$1().copy(this.matrixWorld).invert();return st.parent!==null&&(st.parent.updateWorldMatrix(!0,!1),gt.multiply(st.parent.matrixWorld)),"hiddenMatrix"in st&&st.hiddenMatrix instanceof ue$1?st.hiddenMatrix.premultiply(gt):st.applyMatrix4(gt),st.updateWorldMatrix(!1,!1),this.add(st),mt!==void 0&&(this.children.pop(),this.children.splice(mt,0,st)),this}copy(st,mt=!1){return super.copy(st,mt),this.hasNonUniformScale=st.hasNonUniformScale,this}onAfterRender(st,mt,gt,_t,Et,At){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},nA=class extends fd(Mt){},s7=nt=>nt.type==="Mesh",Br=class extends nA{constructor(nt){super(),this.object=nt,this.matrixAutoUpdate=!1,this.hasNonUniformScale=nt.hasNonUniformScale}raycast(nt,st){}expand(){let nt=0,st=this.object.entityChildren(nt);for(;st;){let mt=this.children[nt];(mt==null?void 0:mt.object)!==st&&(mt&&this.remove(mt),mt=new Br(st),this.add(mt),this.children.splice(nt,0,this.children.pop()),mt.matrixWorldNeedsUpdate=!0,mt.matrixAutoUpdate=!1,mt.matrix=st.matrix,mt.hiddenMatrix=st.hiddenMatrix),mt.expand(),nt+=1,st=this.object.entityChildren(nt)}for(;this.children.length>nt;)this.remove(this.children[nt])}get visible(){var nt;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((nt=this.object.dataPatched.cloner)==null?void 0:nt.hideBase)===!0}set visible(nt){}get castShadow(){return this.object.castShadow}set castShadow(nt){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(nt){}get isMesh(){return s7(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(nt){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Bc=new E$6,Nc=new E$6,pd=new ue$1,HI=[new E$6(-1,1,1),new E$6(-1,-1,1),new E$6(1,-1,1),new E$6(1,1,1),new E$6(-1,1,-1),new E$6(-1,-1,-1),new E$6(1,-1,-1),new E$6(1,1,-1)],o7=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],a7=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],jI=(nt,st,mt)=>{nt.updateEntityBoxSize(Bc,Nc),pd.copy(st).multiply(nt.matrixWorld),Nc.x===0&&Nc.y===0&&Nc.z===0?mt.push(new E$6(Bc.x,Bc.y,Bc.z).applyMatrix4(pd)):HI.forEach(gt=>{mt.push(gt.clone().multiply(Nc).add(Bc).applyMatrix4(pd))})},Jp=class extends jt{constructor(){super(...arguments),this.matrix=new ue$1,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(nt){return super.copy(nt),this.matrix.copy(nt.matrix),this.vertices=nt.vertices.map(st=>st.clone()),this.faces=nt.faces.map(st=>st.clone()),this.edges=nt.edges.map(st=>st.clone()),this.centerEdges=nt.centerEdges.map(st=>st.clone()),this}setFromObjectSize(nt,st=!1){nt.updateWorldMatrix(!1,st),this.makeEmpty(),this.matrix.copy(nt.matrixWorld);let mt=new ue$1().copy(nt.matrixWorld).invert();return this.expandByObjectSize(nt,mt,st)}expandByObjectSize(nt,st,mt=!1){let gt=[];return mt===!0?nt.traverseEntity(_t=>{if(_t.visible||_t.cloner&&_t.data.visible){if(!("geometry"in _t)){gt.push(new E$6);return}jI(_t,st,gt)}}):jI(nt,st,gt),this.setFromPoints(gt)}getCenter(nt){return nt=super.getCenter(nt),nt.applyMatrix4(this.matrix),nt}getPositionToCenter(nt){return nt=super.getCenter(nt),nt.applyMatrix4(pd.copy(this.matrix).setPosition(0,0,0)),nt}computeVertices(){this.getSize(Nc).multiplyScalar(.5),this.getCenter(Bc),pd.copy(this.matrix).setPosition(Bc),this.vertices=HI.map(nt=>nt.clone().multiply(Nc).applyMatrix4(pd))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=o7.map(([nt,st])=>new Mi(this.vertices[nt],this.vertices[st])),this.centerEdges=this.edges.map(nt=>nt.getCenter(new E$6))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=a7.map(([nt,st])=>this.vertices[nt].clone().add(this.vertices[st]).multiplyScalar(.5))}},js={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},oA=class extends fp{constructor(){super()}getPoints(nt=12){let st=[],mt,gt=this.getCurveLengths(),_t=gt[gt.length-1]/gt.length;for(let Et=0,At=this.curves;Et<At.length;Et++){let Rt=At[Et],Ft=Et===0?gt[Et]:gt[Et]-gt[Et-1],Nt=Math.ceil(nt*Ft/_t),Bt=Rt.getPoints(Nt);for(let Gt=0;Gt<Bt.length;Gt++){let dr=Bt[Gt];mt&&mt.equals(dr)||(st.push(dr),mt=dr)}}return this.autoClose&&st.length>1&&!st[st.length-1].equals(st[0])&&st.push(st[0]),st}},aA=.001;function lA(nt,st,mt){return st.clone().sub(nt).cross(st.clone().sub(mt)).length()<=aA}function sA(nt,st){let mt=new E$6(...nt.position),gt=new E$6(...nt.controlNext.position),_t=new E$6(...st.controlPrevious.position),Et=new E$6(...st.position);return lA(mt,gt,Et)&&lA(mt,_t,Et)}function m0(nt){let st=nt.points.map(Bt=>new E$6(...Bt.data.position)),mt=[nt.points[0]],gt=new E$6(...mt[0].data.position);for(let Bt=0;Bt<nt.points.length-1;Bt++)lA(gt,st[Bt],st[Bt+1])||(mt.push(nt.points[Bt]),gt=st[Bt]);mt.push(nt.points[nt.points.length-1]);let _t=nt.isClosed,Et=mt.length-(_t?0:1),At=mt.length,Rt=[];for(let Bt=0;Bt<At;Bt++){let Gt=mt[Bt].data,dr=new E$6(...Gt.position),Mr=new E$6(...Gt.controlPrevious.position),Tr=new E$6(...Gt.controlNext.position),zr={position:dr,baseRoundness:Gt.roundness,controlPrevious:Mr,controlNext:Tr};if(Gt.roundness===0||!nt.isClosed&&(Bt===0||Bt===At-1)){Rt[Bt]={...zr,removedLength:0};continue}let Fr=_t&&Bt==0?At-1:Bt-1,Nr=_t&&Bt==At-1?0:Bt+1,tn=mt[Fr].data,rn=mt[Nr].data,Tn=new E$6(...tn.position),$n=new E$6(...rn.position),un=Tn.clone().sub(dr).normalize(),es=$n.clone().sub(dr).normalize();Object.assign(zr,{prevDir:un,nextDir:es});let kn=sA(tn,Gt),ts=sA(Gt,rn);if(!kn||!ts)Rt[Bt]={...zr,removedLength:0};else{let Ko=un.clone().add(es).normalize(),ds=Ko.clone().cross(un).length()/un.dot(Ko);Rt[Bt]={...zr,tan:ds,removedLength:Gt.roundness/ds}}}for(let Bt=0;Bt<Et;Bt++){let Gt=Bt,dr=_t&&Bt===At-1?0:Bt+1,Mr=Rt[Gt],Tr=Rt[dr];if(Mr.removedLength!==0||Tr.removedLength!==0){let zr=Mr.position.distanceTo(Tr.position);Mr.removedLength=Math.min(Mr.removedLength,zr/2),Tr.removedLength=Math.min(Tr.removedLength,zr/2)}}let Ft=[];for(let Bt=0;Bt<Et;Bt++){let Gt=Bt,dr=_t&&Bt===At-1?0:Bt+1,Mr=Rt[Gt],Tr=Rt[dr],zr=null;if(!sA(mt[Gt].data,mt[dr].data))Mr.position.distanceTo(Tr.position)>aA&&(zr=new yc(Mr.position,Mr.controlNext,Tr.controlPrevious,Tr.position));else{let Fr=Mr.position.clone(),Nr=Tr.position.clone();(Mr.removedLength!==0||Tr.removedLength!==0)&&(Mr.nextDir&&Fr.add(Mr.nextDir.clone().setLength(Mr.removedLength)),Tr.prevDir&&Nr.add(Tr.prevDir.clone().setLength(Tr.removedLength))),Fr.distanceTo(Nr)>aA&&(zr=new yc(Fr,Fr.clone().lerp(Nr,.3),Nr.clone().lerp(Fr,.3),Nr))}Ft[2*Bt+1]=zr}for(let Bt=0;Bt<At;Bt++){let Gt=Rt[Bt];if(Gt.removedLength===0){Ft[2*Bt]=null;continue}let dr=Gt.position,Mr=Gt.prevDir.clone().multiplyScalar(Gt.removedLength).add(dr),Tr=Gt.nextDir.clone().multiplyScalar(Gt.removedLength).add(dr),zr=Gt.tan*Gt.removedLength,Fr=Gt.prevDir.clone().add(Gt.nextDir).normalize(),Nr=Mr.clone().lerp(Tr,.5),tn=Mr.distanceTo(Tr)/2,rn=Fr.clone().multiplyScalar(Math.sqrt(Math.pow(zr,2)-Math.pow(tn,2))).add(Nr),Tn=Fr.clone().multiplyScalar(-zr).add(rn),$n=dr.distanceTo(Tn)/dr.distanceTo(Nr),un=Gt.prevDir.clone().multiplyScalar($n*dr.distanceTo(Mr)).add(dr),es=un.clone().lerp(Tn,2),kn=Mr.clone().lerp(un,4/3),ts=Tr.clone().lerp(es,4/3);Ft[2*Bt]=new yc(Mr,kn,ts,Tr)}let Nt=new oA;return Ft.forEach(Bt=>{Bt&&Nt.add(Bt)}),Nt}var yt;(nt=>{function st(mt){return mt&&mt.__isEntity}nt.is=st})(yt||(yt={}));var Do=nt=>yt.is(nt),l7={type:"completeState",isfromEntity:!0},c7=["x","y","z"],cA=new E$6,u7=new E$6().set(0,1,0),md=nt=>class extends fd(nt){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new Jp,this._recursiveBBox=new Jp,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(st){let mt=this.children[st];if(yt.is(mt))return mt}entityChildrenCount(){let st=this.children.length;for(;st--;)if(yt.is(this.children[st]))return st+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let st=this;for(;st.data.type!=="Instance";){let mt=st.parent;if(yt.is(mt))st=mt;else return}return st}forInstancesRec(st){this.instances.forEach(mt=>{mt.disposed||st(mt),mt.forInstancesRec(st)})}super_Entity(st,mt){typeof st=="string"&&(this.uuid=st),this.identity=st,this.data=mt,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(st,mt,gt=!1){if(!(this.data.states.length===0&&!gt)){for(let _t of this.data.states)va.toOps(this.data,_t.data).forEach(Et=>{let At=Lh.replaceProps(Et,this.data);this.dataPatched=this.data,this.updateByPatchedOp(At,this.data,mt)});if(st!==null){let _t=this.data.states.data(st);_t&&(this.dataPatched=va.patch(this.data,_t),va.toOps(this.data,_t).forEach(Et=>{this.updateByPatchedOp(Et,this.dataPatched,mt)}))}gt&&this.updateTransformState(this.dataPatched,mt),this.stateSelection=st,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(st,mt){st.setScalar(0),mt.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(st=>{Do(st)&&st.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(st=>{st.resetBBoxNeedsUpdateSelf()})}find(st){let mt;return this.traverseEntity(gt=>{gt.uuid===st&&(mt=gt)}),mt}traverseSortNextHelper(){let st=this.parent;if(st){let mt=st.children,gt=mt.indexOf(this)+1;if(yt.is(mt[gt]))return mt[gt];if(yt.is(st))return st.traverseSortNextHelper()}}sortNext(){let st=this.children;return this.children.length>0&&yt.is(this.children[0])?st[0]:this.traverseSortNextHelper()}goUp(st){let mt=this;for(;st>0&&mt!==null;)mt=mt.parent,st-=1;return mt}hasAnccestorOrSelf(st){return this===st||this.hasAnccestor(st)}hasAnccestor(st){let mt=this.parent;for(;mt;){if(st===mt)return!0;mt=mt.parent}return!1}countToAccestor(st){let mt=0,gt=this;for(;gt!==st;){if(gt===null)return-1;gt=gt.parent,mt+=1}return mt}forEachEntity(st){for(let mt of this.children)Do(mt)&&st(mt)}traverseEntityAncestors(st){this.traverseAncestors(mt=>{yt.is(mt)&&st(mt)})}traverseConcreteEntity(st,mt=0){if(st(this,mt)!==!0)for(let gt of this.children)Do(gt)&&gt.isConcreteEntity&&gt.traverseEntity(st,mt+1)}traverseEntity(st,mt=0){if(st(this,mt)!==!0)for(let gt of this.children)Do(gt)&&gt.traverseEntity(st,mt+1)}traverseVisibleEntity(st){st(this);for(let mt of this.children)Do(mt)&&mt.visible&&mt.traverseVisibleEntity(st)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(st){super.updateMatrixWorld(st),this.dispatchEvent({type:"updateMatrixWorld"})}copy(st,mt=!1){return super.copy(st,mt),this.dataPatched=st.dataPatched,this.raycastLock=st.raycastLock,this.scaleLock=st.scaleLock,this.hiddenMatrix.copy(st.hiddenMatrix),this}hasEntityChild(){return this.children.some(st=>Do(st))}isAncestorOf(st){if(this.uuid===st)return!1;let mt=!1;return this.traverseEntity(gt=>{gt.uuid===st&&(mt=!0)}),mt}toObjectTransformState(st=[]){this.updateWorldMatrix(!0,!1);let mt={position:this.position.toArray(),rotation:[this.rotation.x*we$1.RAD2DEG,this.rotation.y*we$1.RAD2DEG,this.rotation.z*we$1.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return Ch(mt,st)}getTransformValues(st,mt,gt){return mt[st].map((_t,Et)=>(gt==null?void 0:gt.shared.getVariable(_t,[this.uuid,st,c7[Et]]))??_t)}updateTransformState(st,mt){let gt=!1;return st.position&&(this.position.fromArray(this.getTransformValues("position",st,mt)),gt=!0),st.rotation&&(cA.fromArray(this.getTransformValues("rotation",st,mt)).multiplyScalar(we$1.DEG2RAD),this.rotation.setFromVector3(cA),gt=!0),st.scale&&(this.scale.fromArray(this.getTransformValues("scale",st,mt)),gt=!0),st.hiddenMatrix!==void 0&&(gt=!0,this.hiddenMatrix.fromArray(st.hiddenMatrix??vl.identity)),gt&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(_t=>{_t.invalidateClonerTransform(this)})),st.position&&st.rotation&&st.scale&&st.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),gt}onVariableUpdate(st=!1){if(st){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(mt=>{mt.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let st of this.children)yt.is(st)&&st.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(st=>{yt.is(st)&&st.disposeRecursively()})}toState(st=[]){let mt={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(st)};return Ch(mt,st)}updateByObjUpdateOp(st,mt){st!==void 0&&this.updateByOp({type:0,props:st,path:[]},{...this.data,...st},mt,!1)}updateByOp(st,mt,gt,_t){let Et=this.data;this.data=mt;let At=st,Rt=Lt(st.path,["states","*"]);if(Rt!==null){if(st.type===0){let[Ft]=Rt;if((this==null?void 0:this.stateSelection)===Ft){let Nt={...st.props};if(delete Nt.name,Object.values(st.props).some(Bt=>Bt===void 0)){let Bt=this.data;if(Bt!==void 0){let Gt=Sr.zoom(Bt,st.path.slice(2));if(Gt)for(let dr in st.props)st.props[dr]===void 0&&dr in Gt&&(Nt[dr]=Gt[dr])}}At={...st,props:Nt,path:st.path.slice(2)}}}}else if(st.type===0){let Ft=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(Ft!==void 0){if(st.props.name!==void 0&&Ft.name){let{name:Bt,...Gt}=Ft;Ft=Gt}if(st.props.material!==void 0&&"material"in Ft){let{material:Bt,...Gt}=Ft;Ft=Gt}let Nt=Sr.removeOverridden(st.path,st.props,Ft);At={...st,props:Nt}}}if(this.updateByPatchedOpBase(At,va.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),gt),Lt(st.path,["overrides"])){let Ft=[],Nt=[...st.path];for(Ft.push(Nt[1]),Nt.splice(0,2);Nt.length>0&&Nt[0]==="descendants";)Ft.push(Nt[1]),Nt.splice(0,2);if(Ft[Ft.length-1]===void 0){if(st.type===0)for(let Bt of Object.keys(st.props)){Ft[Ft.length-1]=Bt;let Gt=gt.scene.findInstance([this.uuid,...Ft]);Gt&&(Gt.overrideData=st.props[Bt],Gt.updateState(vo.apply(Gt.component.data,Gt.overrideData),gt))}}else{let Bt=gt.scene.findInstance([this.uuid,...Ft]);if(Bt){let Gt=Sr.zoom(Bt.component.data,Nt);if(st={...st,path:Nt},st.type===0){let dr=st.props;if(Gt)for(let[Mr,Tr]of Object.entries(st.props))Tr===void 0&&(dr===st.props&&(dr={...st.props}),dr[Mr]=Gt[Mr]);st={...st,props:dr}}Bt.overrideData=Hh.resolve(mt.overrides,Ft),Bt.updateByOp(st,Rr.applySimple(Bt.data,st),gt,!1)}}}else if(this.instances.length>0){let Ft;if(st.path.length===0&&st.type===0){let Nt;for(let Bt of Mo.rootOverrideProps)Bt in st.props&&(Nt===void 0&&(Nt={}),Nt[Bt]=st.props[Bt]);Nt&&(Ft={...st,props:Nt})}else for(let Nt of Mo.rootOverrideProps)if(Lt(st.path,[Nt])){Ft=st;break}Ft!==void 0&&this.instances.forEach(Nt=>{if(Nt.isInstanceRoot){let Bt=vo.filterOp(Nt.overrideData,Ft);Bt&&Nt.updateByOp(Bt,Rr.applySimple(Nt.data,Bt),gt,!0)}}),this.instances.forEach(Nt=>{if(!Nt.isInstanceRoot){let Bt=vo.filterOp(Nt.overrideData,st);if(Bt){let Gt;Et===Nt.data&&st===Bt?Gt=mt:Gt=Rr.applySimple(Nt.data,Bt),Nt.updateByOp(Bt,Gt,gt,!0)}}})}}updateByPatchedOpBase(st,mt,gt){if(this.dataPatched=mt,st.path.length===0&&st.type===0)st.props.type!==void 0&&!Vs.is(st.props.type)&&js.changeEntityProptotype(this,mt,gt);else if(st.path.length===1&&st.path[0]==="geometry"&&st.type===0&&"type"in st.props){js.changeEntityProptotype(this,mt,gt);for(let _t of this.children)yt.is(_t)&&_t.updateVisible(gt.scene)}this.updateByPatchedOp(st,mt,gt)}updateByPatchedOp(st,mt,gt){if(st.path.length===0&&st.type===0&&this.updateState(st.props,gt),Lt(st.path,["pathSnapping"])!==null&&this.updatePathSnapping(mt.pathSnapping),Lt(st.path,["cloner"])!==null){let _t=Rr.drop(st,1);_t.path.length===0&&_t.type===0&&_t.props.disabled===!0?this.setFromClonerState(null,gt):this.cloner?this.cloner.updateState(mt.cloner,gt.scene):(this.setFromClonerState(mt.cloner,gt),this.expandCloner(gt.scene)),this.updateVisible(gt.scene)}}updatePathSnapping(st=this.dataPatched.pathSnapping){this._updatedPathSnapping=st,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(st){var Tr,zr,Fr,Nr,tn;let mt=((Tr=this._updatedPathSnapping)==null?void 0:Tr.pathId)??this.dataPatched.pathSnapping.pathId,gt=((zr=this._updatedPathSnapping)==null?void 0:zr.slide)??this.dataPatched.pathSnapping.slide??0,_t=((Fr=this._updatedPathSnapping)==null?void 0:Fr.offset)??this.dataPatched.pathSnapping.offset??0,Et=((Nr=this._updatedPathSnapping)==null?void 0:Nr.orientation)??this.dataPatched.pathSnapping.orientation;if(mt===null)return;let At=st.find(mt);if(!At||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let Rt=At.data;if(Rt.geometry.path.points.length<=1)return;let Ft=m0(Rt.geometry.path),Nt=(gt+_t)%1;gt+_t===1&&Nt===0&&(Nt=1);let Bt=null;try{Bt=Ft.curves.length?Ft.getPointAt(Nt):null}catch{}if(Bt===null)return;let Gt=this.parent?(tn=this.parent)==null?void 0:tn.matrixWorld:new ue$1;At.updateMatrixWorld();let dr=new ue$1().multiplyMatrices(Gt.clone().invert(),At.matrixWorld);Bt.applyMatrix4(dr);let Mr={position:Bt.toArray(),rotation:Rt.rotation};if(Et==="tangential"){let rn=new ue$1().extractRotation(At.matrixWorld),Tn=Ft.getTangentAt(Nt).applyMatrix4(rn).add(Bt),$n=new ue$1().lookAt(Bt,Tn,u7),un=cA.setFromEuler(new ir().setFromRotationMatrix($n)).multiplyScalar(we$1.RAD2DEG);Mr={...Mr,rotation:un.toArray()}}this.updateTransformState(Mr),this.traverseEntity(rn=>{rn._cameraType&&rn.dispatchEvent(l7)})}updateVisible(st){var gt;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((gt=this.dataPatched.cloner)==null?void 0:gt.hideBase)!==!0),!st)return;let mt=!1;this.traverseEntity(_t=>{if(_t.data.type==="Splat")return mt=!0,!0}),mt&&st.reloadSplats()}updateState_Entity(st,mt){st.name!==void 0&&(this.name=st.name),st.raycastLock!==void 0&&(this.raycastLock=st.raycastLock),st.visible!==void 0&&(this.updateVisible(mt==null?void 0:mt.scene),this.resetBBoxNeedsUpdate()),mt&&"cloner"in st&&st.cloner!==void 0&&(this.setFromClonerState(st.cloner,mt),this.updateVisible(mt.scene)),this.updateTransformState(st,mt)}get attachedSurfaceCloners(){return this.children.filter(st=>st instanceof js.Cloner&&st.parameters.type==="toObject")}setFromClonerState(st,mt){this.disposed||(st===null||st.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new js.Cloner(this,st),mt.scene.addPendingExpandCloner(this)):this.cloner.updateState(st,mt.scene))}expandCloner(st){!this.disposed&&this.cloner&&this.cloner.expandClones(st)}invalidateClonerTransform(st){this.cloner&&this.cloner.invalidateTransform(st)}requestRender(){this.dispatchEvent({type:"requestRender"})}},g0=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},nt.parameters);mt.thetaLength=we$1.clamp(mt.thetaLength,0,360);let gt=mt.width/2,_t=mt.radiusTop??gt,Et=mt.radiusBottom??gt;return _t===Et?(_t=gt,Et=gt):_t>Et?(_t=gt,Et=Et*gt/_t):(_t=_t*gt/Et,Et=gt),{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??mt.width),radiusTop:_t,radiusBottom:Et})}}static build(nt){let{width:st,depth:mt,height:gt,radialSegments:_t,heightSegments:Et,openEnded:At,thetaStart:Rt,thetaLength:Ft,radiusTop:Nt,radiusBottom:Bt,cornerRadius:Gt,cornerSegments:dr,hollow:Mr}=nt.parameters,Tr;return Ft===0?(Tr=new _e$1,Tr.setAttribute("position",new Me$1([],3))):Gt||Mr?Tr=new $p(Nt,Bt,gt,_t,Et,At,Rt,Ft*Math.PI/180,Gt,Gt,dr,Mr):Tr=new xc(Nt,Bt,gt,_t,Et,At,Rt,Ft*Math.PI/180),Tr.scale(1,1,mt/st),Object.assign(Tr,{userData:{...nt,type:"CylinderGeometry"}})}};function Pl(nt,st,mt){mt.x=nt.x*st.x,mt.y=nt.y,mt.z=nt.x*st.y}function WI(nt){return new U$1(nt.y,-nt.x)}var $p=class extends _e$1{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt,dr=!1){super(),this.type="RoundedCylinderBufferGeometry",nt=nt!==void 0?nt:1,st=st!==void 0?st:1,mt=mt||1,gt=Math.floor(gt)||8,_t=Math.floor(_t)||1,Et=Et!==void 0?Et:!1,At=At!==void 0?At:0,Rt=Rt!==void 0?Rt:Math.PI*2,Et&&(Ft=0,Nt=0);let Mr=[],Tr=[],zr=[],Fr=[],Nr=0,tn=mt/2,rn=new E$6,Tn=new E$6;dr&&nt==0&&(nt=Ft),dr&&st==0&&(st=Nt);let $n=new U$1(nt,tn),un=new U$1(st,-tn),es=null,kn=null,ts=null,Ko=null,ds=$n.clone().sub(un),Il=0,ru=0,uu=0;Gt>0&&(Il=Math.min(nt,st)*(1-Gt),ru=nt-Il,uu=st-Il);let p0=$n.clone();p0.x-=Il;let X1=Math.PI-ds.angle(),q0=ds.angle(),W0=Math.tan(q0/2),hu=Math.tan(X1/2),a1=W0+hu,Vx=Gt?a1:hu,t0=Gt?a1:W0;if(Ft=Math.min(Ft,(nt-ru)/Vx,ds.length()/a1),Nt=Math.min(Nt,(st-uu)/t0,ds.length()/a1),Ft>0){let eS=Ft/W0;es=$n.clone().sub(new U$1(eS,Ft)),Gt&&(ts=es.clone(),ts.x-=Il-a1*Ft),$n.sub(ds.clone().setLength(eS))}if(Nt>0){let eS=Nt/hu;kn=un.clone().sub(new U$1(eS,-Nt)),un.add(ds.clone().setLength(eS)),Gt&&(Ko=kn.clone(),Ko.x-=Il-a1*Nt,p0.sub(ds.clone().setLength(eS)))}ds=$n.clone().sub(un);let cu=ds.length()<.5,lu=[];for(let eS=0;eS<=gt;eS++){let SA=[],o$=eS/gt,h$=o$*Rt+At,d$=new U$1(Math.sin(h$),Math.cos(h$));Ko&&kn?(b0(SA,o$,d$,X1,Nt,Ko,-1,!0),b0(SA,o$,d$,q0,Nt,kn,-1,!1)):kn?(l1(SA,d$,kn.x,0,-1),b0(SA,o$,d$,q0,Nt,kn,-1,!1)):Et||l1(SA,d$,st,uu,-1);let y$=WI(ds).normalize();if(Pl(y$,d$,rn),!cu)for(let R$=0;R$<=_t;R$++){let M$=R$/_t,x$=ds.clone().multiplyScalar(M$).add(un);Pl(x$,d$,Tn),Tr.push(Tn.x,Tn.y,Tn.z),zr.push(rn.x,rn.y,rn.z),Fr.push(o$,.5+Tn.y/mt),SA.push(Nr++)}if(ts&&es?(b0(SA,o$,d$,X1,Ft,es,1,!1),b0(SA,o$,d$,q0,Ft,ts,1,!0)):es?(b0(SA,o$,d$,X1,Ft,es,1,!1),l1(SA,d$,es.x,0,1)):Et||l1(SA,d$,nt,ru,1),Gt&&!cu){let R$=WI(ds).multiplyScalar(-1).normalize();Pl(R$,d$,rn);for(let M$=0;M$<=_t;M$++){let x$=M$/_t,v$=ds.clone().multiplyScalar(-x$).add(p0);Pl(v$,d$,Tn),Tr.push(Tn.x,Tn.y,Tn.z),zr.push(rn.x,rn.y,rn.z),Fr.push(o$,.5+Tn.y/mt),SA.push(Nr++)}}Gt&&!Et&&SA.push(SA[0]),lu.push(SA)}for(let eS=0;eS<lu.length-1;eS++)for(let SA=0;SA<lu[0].length-1;SA++){if(Et&&Gt&&SA==_t)continue;let o$=lu[eS][SA],h$=lu[eS+1][SA],d$=lu[eS+1][SA+1],y$=lu[eS][SA+1],R$=Tr[d$*3+0],M$=Tr[d$*3+2];Mr.push(o$,h$,y$),(R$!=0||M$!=0)&&Mr.push(h$,d$,y$)}Rt<Math.PI*2&&(LE(-1,lu[0],At),LE(1,lu[lu.length-1],At+Rt)),this.setIndex(Mr),this.setAttribute("position",new Me$1(Tr,3)),this.setAttribute("normal",new Me$1(zr,3)),this.setAttribute("uv",new Me$1(Fr,2));function b0(eS,SA,o$,h$,d$,y$,R$,M$){for(let x$=0;x$<Bt+1;x$++){let v$=x$/Bt,rS=R$<0?v$:1-v$;M$&&(rS-=1),rS*=h$;let wA=new U$1(Math.sin(rS),Math.cos(rS)*R$),g$=wA.clone().multiplyScalar(d$).add(y$);Pl(g$,o$,Tn),Tr.push(Tn.x,Tn.y,Tn.z),Pl(wA,o$,rn),zr.push(rn.x,rn.y,rn.z),Fr.push(SA,.5+Tn.y/mt),eS.push(Nr++)}}function l1(eS,SA,o$,h$,d$){let y$=new E$6,R$=new U$1,M$=[o$,h$];d$<0&&M$.reverse();for(let x$ of M$)R$.set(x$,tn*d$),Pl(R$,SA,y$),Tr.push(y$.x,y$.y,y$.z),zr.push(0,d$,0),Fr.push(.5,.5),eS.push(Nr++)}function LE(eS,SA,o$){let h$=new U$1(Math.sin(o$),Math.cos(o$)),d$=new U$1(-Math.cos(o$),Math.sin(o$)),y$=new E$6,R$=eS<0?(v$,rS,wA)=>Mr.push(v$,rS,wA):(v$,rS,wA)=>Mr.push(v$,wA,rS),M$=new U$1((nt+st+ru+uu)/4,0);Pl(M$,h$,y$),Tr.push(y$.x,y$.y,y$.z),zr.push(d$.x,0,d$.y),Fr.push(.5,.5);let x$=Nr++;for(let v$ of SA){let rS=Tr.slice(v$*3,v$*3+3);Tr.push(...rS),zr.push(d$.x,0,d$.y);let wA=Fr.slice(v$*2,v$*2+2);Fr.push(...wA),Nr++}for(let v$=x$+1;v$<Nr-1;v$++)R$(x$,v$,v$+1);R$(x$,Nr-1,x$+1)}}},qI=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},nt.parameters);return mt.thetaLength=we$1.clamp(mt.thetaLength,0,360),{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??mt.width)})}}static build(nt){let{width:st,depth:mt,height:gt,radialSegments:_t,heightSegments:Et,openEnded:At,thetaStart:Rt,thetaLength:Ft,cornerRadiusTop:Nt,cornerRadiusBottom:Bt,cornerSegments:Gt}=nt.parameters,dr;return Ft===0?(dr=new _e$1,dr.setAttribute("position",new Me$1([],3))):Nt>0||Bt>0||Ft<360?dr=new $p(0,st/2,gt,_t,Et,At,Rt,Ft*Math.PI/180,Nt,Bt,Gt,0,!0):dr=new tl(st/2,gt,_t,Et,At),dr.scale(1,1,mt/st),Object.assign(dr,{userData:{...nt,type:"ConeGeometry"}})}},YI=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},nt.parameters);return{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??mt.width)})}}static build(nt){let{width:st,height:mt,depth:gt,widthSegments:_t,heightSegments:Et,depthSegments:At,cornerRadius:Rt,cornerSegments:Ft}=nt.parameters,Nt;return Rt===0?Nt=new mi(st,mt,gt,_t,Et,At):Nt=new hA(st,mt,gt,_t,Et,At,Rt,Ft),Object.assign(Nt,{userData:{...nt,type:"CubeGeometry"}})}},uA=Math.PI/2,hA=class extends _e$1{constructor(nt=1,st=1,mt=1,gt=1,_t=1,Et=1,At=0,Rt=4){super(),this.type="BoxGeometry",gt=Math.floor(gt),_t=Math.floor(_t),Et=Math.floor(Et),Rt=Math.floor(Rt),At=Math.min(At,nt/2,st/2,mt/2);let Ft=[],Nt=[],Bt=[],Gt=[],dr=0;Mr("z","y","x",-1,-1,mt,st,nt,Et,_t),Mr("z","y","x",1,-1,mt,st,-nt,Et,_t),Mr("x","z","y",1,1,nt,mt,st,gt,Et),Mr("x","z","y",1,-1,nt,mt,-st,gt,Et),Mr("x","y","z",1,-1,nt,st,mt,gt,_t),Mr("x","y","z",-1,-1,nt,st,-mt,gt,_t),At>0&&(Tr("z","y","x",-1,-1,1,mt,st,nt,Et),Tr("z","y","x",1,-1,-1,mt,st,nt,Et),Tr("z","y","x",-1,1,-1,mt,st,nt,Et),Tr("z","y","x",1,1,1,mt,st,nt,Et),Tr("x","y","z",-1,-1,-1,nt,st,mt,gt),Tr("x","y","z",1,-1,1,nt,st,mt,gt),Tr("x","y","z",-1,1,1,nt,st,mt,gt),Tr("x","y","z",1,1,-1,nt,st,mt,gt),Tr("y","x","z",-1,-1,1,st,nt,mt,_t),Tr("y","x","z",1,-1,-1,st,nt,mt,_t),Tr("y","x","z",1,1,1,st,nt,mt,_t),Tr("y","x","z",-1,1,-1,st,nt,mt,_t),zr(1,1,1),zr(-1,1,1),zr(1,-1,1),zr(-1,-1,1),zr(1,1,-1),zr(-1,1,-1),zr(1,-1,-1),zr(-1,-1,-1)),this.setIndex(Ft),this.setAttribute("position",new Me$1(Nt,3)),this.setAttribute("normal",new Me$1(Bt,3)),this.setAttribute("uv",new Me$1(Gt,2));function Mr(Fr,Nr,tn,rn,Tn,$n,un,es,kn,ts){let Ko=($n-2*At)/kn,ds=(un-2*At)/ts,Il=$n/2-At,ru=un/2-At,uu=es/2,p0=kn+1,X1=ts+1,q0=0,W0=new E$6;for(let hu=0;hu<X1;hu++){let a1=hu*ds-ru;for(let Vx=0;Vx<p0;Vx++){let t0=Vx*Ko-Il;W0[Fr]=t0*rn,W0[Nr]=a1*Tn,W0[tn]=uu,Nt.push(W0.x,W0.y,W0.z),W0[Fr]=0,W0[Nr]=0,W0[tn]=es>0?1:-1,Bt.push(W0.x,W0.y,W0.z),Gt.push(Vx/kn),Gt.push(1-hu/ts),q0+=1}}for(let hu=0;hu<ts;hu++)for(let a1=0;a1<kn;a1++){let Vx=dr+a1+p0*hu,t0=dr+a1+p0*(hu+1),cu=dr+(a1+1)+p0*(hu+1),lu=dr+(a1+1)+p0*hu;Ft.push(Vx,t0,lu),Ft.push(t0,cu,lu)}dr+=q0}function Tr(Fr,Nr,tn,rn,Tn,$n,un,es,kn,ts){let Ko=(un-2*At)/ts,ds=un/2-At,Il=es/2-At,ru=kn/2,uu=ts+1,p0=0,X1=new E$6,q0=new E$6;for(let W0=0;W0<Rt+1;W0++){let hu=W0/Rt*uA,a1=Math.sin(hu)*At,Vx=(1-Math.cos(hu))*At,t0=Math.sin(hu),cu=Math.cos(hu);X1[Nr]=(Il+a1)*Tn,X1[tn]=(ru-Vx)*$n,q0[Fr]=0,q0[Nr]=t0*Math.sign(X1[Nr]),q0[tn]=cu*Math.sign(X1[tn]);for(let lu=0;lu<uu;lu++){let b0=lu*Ko-ds;X1[Fr]=b0*rn,Nt.push(X1.x,X1.y,X1.z),Bt.push(q0.x,q0.y,q0.z),Gt.push(lu/ts),Gt.push(0),p0+=1}}for(let W0=0;W0<Rt;W0++)for(let hu=0;hu<ts;hu++){let a1=dr+hu+uu*W0,Vx=dr+hu+uu*(W0+1),t0=dr+(hu+1)+uu*(W0+1),cu=dr+(hu+1)+uu*W0;Ft.push(a1,Vx,cu),Ft.push(Vx,t0,cu)}dr+=p0}function zr(Fr,Nr,tn){let rn=new E$6,Tn=new E$6(nt/2,st/2,mt/2);Tn.subScalar(At);let $n=[],un=Fr*Nr*tn>0?(kn,ts,Ko)=>Ft.push(kn,ts,Ko):(kn,ts,Ko)=>Ft.push(kn,Ko,ts);for(let kn=0;kn<=Rt;kn++){let ts=[],Ko=uA*(1-kn/Rt),ds=Math.cos(Ko),Il=Math.sin(Ko),ru=0;for(let uu=0;uu<=kn;uu++){let p0=Math.cos(ru),X1=Math.sin(ru);rn.x=ds*p0,rn.y=Il,rn.z=ds*X1;let q0=Tn.clone().addScaledVector(rn,At);Nt.push(Fr*q0.x,Nr*q0.y,tn*q0.z),Bt.push(Fr*rn.x,Nr*rn.y,tn*rn.z),Gt.push(0,0),ts.push(dr++),ru+=uA/kn}$n.push(ts)}let es=$n.length-1;for(let kn=0;kn<es;kn++){let ts=$n[kn],Ko=$n[kn+1],ds=ts.length-1;un(ts[0],Ko[1],Ko[0]);for(let Il=1;Il<=ds;Il++)un(ts[Il-1],ts[Il],Ko[Il]),un(ts[Il],Ko[Il+1],Ko[Il])}}}},_l=class extends _e$1{constructor(nt=[],st=[],mt="",gt=1,_t=.2,Et=4){super(),this.type="PolyhedronGeometryRound";let At=[],Rt=[],Ft=[];Nt(),Bt(),this.setAttribute("position",new Me$1(At,3)),this.setAttribute("normal",new Me$1(Ft,3)),this.setAttribute("uv",new Me$1(Rt,2));return;function Nt(){var q0;_t=Math.min(1-1e-5,_t),_t==0&&(Et=0);let Gt={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[mt],dr=new E$6,Mr=dr.clone(),Tr=new Cr,zr=_t*gt,Fr=gt-zr,Nr=Et+1,tn=new E$6,rn=(W0,hu)=>tn.subVectors(W0,hu).normalize(),Tn=(W0,hu)=>Array(W0).fill(void 0).map(hu),$n=Tn(nt.length/3,(W0,hu)=>new E$6().fromArray(nt,hu*3).setLength(gt)),un=[],es=1e6;for(let W0=0;W0<$n.length;W0++){let hu=$n[W0],a1=[],Vx,t0,cu,lu=1e10,b0=-1;for(;(b0=st.indexOf(W0,b0+1))!=-1;){let SA=b0-b0%3;Vx=st[SA+(b0+1)%3],t0=st[SA+(b0+2)%3],cu=hu.distanceToSquared($n[Vx]),lu=Math.min(lu,cu),a1.push([Vx,t0,cu])}lu+=1e-6;let l1=[],LE=0,eS=a1.length;for(let SA=0;SA<eS;SA++){[Vx,t0,cu]=a1[LE];let o$=((q0=un[Vx])==null?void 0:q0.includes(W0))==!0;cu<=lu&&l1.push(Vx+ +o$*es),LE=a1.findIndex(h$=>h$[0]==t0)}un.push(l1)}let kn=[];{let W0=0,hu=0,a1,Vx,t0=Gt==3;for(let cu=0;cu<=Et;cu++){a1=cu*(cu+1)/2,Vx=(cu+1)*(cu+2)/2;for(let lu=0;lu<Et-cu;lu++)[W0,hu]=[a1+lu+cu+2,Vx+lu+cu+3],kn.push(a1,Vx,...t0?[hu,a1]:[W0,Vx],hu,W0),[a1,Vx]=[W0,hu];kn.push(a1,Vx,a1+Et+2)}}let ts=dr.clone(),Ko=dr.clone(),ds=dr.clone(),Il=dr.clone(),ru=dr.clone(),uu=[],p0=Tn($n.length,()=>Tn(Gt,()=>dr.clone()));for(let W0=0;W0<$n.length;W0++){dr.copy($n[W0]).normalize(),ts.copy(dr).multiplyScalar(Fr);let hu=un[W0];for(let l1=0;l1<hu.length;l1++){let LE=hu[l1],eS=hu[(l1+1)%Gt];Tr.setFromPointsAndIndices($n,W0,LE%es,eS%es),Tr.b.sub(Tr.a).setLength(1e10).add(Tr.a),Tr.c.sub(Tr.a).setLength(1e10).add(Tr.a),Tr.closestPointToPoint(ts,p0[W0][l1])}let a1=[],Vx=[],t0=[],cu=new E$6;Et==0&&[...p0[W0]].reduce((l1,LE)=>l1.add(LE),cu).multiplyScalar(1/Gt);for(let l1=0;l1<Gt;l1++){let LE=[],eS=(l1-1+Gt)%Gt,SA=p0[W0][eS],o$=p0[W0][l1];dr.copy(SA).sub(ts),Mr.copy(o$).sub(ts);let h$=ts.angleTo(dr),d$=dr.angleTo(Mr),y$=Math.cos(h$)*zr;Et==0?Ko.copy(cu):Ko.copy(ts).setLength(Fr+y$),Vx.push(y$);let R$=[Ko,SA,o$];for(let M$=0;M$<2;M$++){let x$=R$[M$],v$=R$[M$+1];Il.subVectors(x$,ts),ru.subVectors(v$,ts),ds.crossVectors(Il,ru).normalize();for(let rS=0;rS<Nr;rS++){let wA=[h$,d$][M$]*rS/Nr;dr.copy(Il).applyAxisAngle(ds,wA).add(ts),a1.push(dr.clone()),M$&&(rn(dr,ts),LE.push([rS==0?x$:dr.clone(),tn.clone()]))}M$&&(rn(v$,ts),LE.push([v$,tn.clone()]))}t0.push(LE)}uu.push(t0);let lu=2*Nr,b0=2;for(let l1=0;l1<Gt;l1++){let LE=lu*l1,eS=lu*((l1+1)%Gt),SA=[a1[LE]];for(let h$=1;h$<Nr;h$++){Il=a1[LE+h$],ru=a1[eS+h$],SA.push(Il);for(let d$=1,y$=h$-b0+1;d$<=y$;d$++)dr.lerpVectors(Il,ru,d$/(y$+1)),dr.sub(ts).setLength(Vx[l1]).add(ts),SA.push(dr.clone());SA.push(ru)}for(let h$=0;h$<Nr;h$++)SA.push(a1[h$+Nr+LE]);SA.push(a1[eS+Nr]);let o$=kn.map(h$=>SA[h$]);At.push(...o$.map(h$=>[h$.x,h$.y,h$.z]).flat()),Ft.push(...o$.map(h$=>(rn(h$,ts),[tn.x,tn.y,tn.z])).flat())}}let X1=[];for(let W0=0;W0<un.length;W0++)for(let hu=0;hu<Gt;hu++){let a1=un[W0][hu];if(a1<es){let Vx=un[a1].findIndex(lu=>lu%es==W0),t0=uu[W0][hu],cu=uu[a1][Vx];for(let lu=0;lu<Nr;lu++){let b0=t0[lu],l1=cu[Nr-lu],LE=t0[lu+1],eS=cu[Nr-(lu+1)];[b0,l1,LE,LE,l1,eS].forEach(SA=>{At.push(SA[0].x,SA[0].y,SA[0].z),Ft.push(SA[1].x,SA[1].y,SA[1].z)})}X1.push(t0[0][0],cu[Nr][0],t0[Nr][0],cu[0][0])}}for(;X1.length;){let W0,hu,a1,Vx;[W0,hu]=X1.splice(0,2);let t0=[W0];for(;W0!=hu;)t0.push(hu),a1=X1.indexOf(hu),Vx=a1%2,hu=X1.splice(a1-Vx,2)[1-Vx];tn.subVectors(t0[0],t0[1]).cross(dr.subVectors(t0[0],t0[2])).normalize();let cu=tn.dot(t0[0])<0;cu&&tn.negate();for(let lu=1;lu<=t0.length-2;lu++)[t0[lu+ +cu],t0[lu+1-+cu],t0[0]].forEach(b0=>{At.push(b0.x,b0.y,b0.z),Ft.push(tn.x,tn.y,tn.z)})}}function Bt(){let Gt=new E$6;for(let un=0;un<At.length;un+=3){Gt.x=At[un+0],Gt.y=At[un+1],Gt.z=At[un+2];let es=Tn(Gt)/2/Math.PI+.5,kn=$n(Gt)/Math.PI+.5;Rt.push(es,1-kn)}let dr=new E$6,Mr=new E$6,Tr=new E$6,zr=new E$6,Fr=new U$1,Nr=new U$1,tn=new U$1,rn=(un,es,kn,ts)=>{ts<0&&un.x===1&&(Rt[es]=un.x-1),kn.x===0&&kn.z===0&&(Rt[es]=ts/2/Math.PI+.5)};for(let un=0,es=0;un<At.length;un+=9,es+=6){dr.set(At[un+0],At[un+1],At[un+2]),Mr.set(At[un+3],At[un+4],At[un+5]),Tr.set(At[un+6],At[un+7],At[un+8]),Fr.set(Rt[es+0],Rt[es+1]),Nr.set(Rt[es+2],Rt[es+3]),tn.set(Rt[es+4],Rt[es+5]),zr.copy(dr).add(Mr).add(Tr).divideScalar(3);let kn=Tn(zr);rn(Fr,es+0,dr,kn),rn(Nr,es+2,Mr,kn),rn(tn,es+4,Tr,kn)}for(let un=0;un<Rt.length;un+=6){let es=Rt[un+0],kn=Rt[un+2],ts=Rt[un+4],Ko=Math.max(es,kn,ts),ds=Math.min(es,kn,ts);Ko>.9&&ds<.1&&(es<.2&&(Rt[un+0]+=1),kn<.2&&(Rt[un+2]+=1),ts<.2&&(Rt[un+4]+=1))}function Tn(un){return Math.atan2(un.z,-un.x)}function $n(un){return Math.atan2(-un.y,Math.sqrt(un.x*un.x+un.z*un.z))}}}static fromJSON(nt){return new _l(nt.vertices,nt.indices,nt.radius,nt.corner,nt.cornerSides)}},XI=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,detail:0,corner:0,cornerSides:4},nt.parameters);return{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??mt.width)})}}static build(nt){let{width:st,height:mt,depth:gt,detail:_t,corner:Et,cornerSides:At}=nt.parameters,Rt=_t===0&&Et!==0?new em(st*.5,Et,At):new Vu(st*.5,_t);return Rt.scale(1,mt/st,gt/st),Object.assign(Rt,{userData:{...nt,type:"DodecahedronGeometry"}})}},em=class extends _l{constructor(nt=1,st=.2,mt=4){let gt=(1+Math.sqrt(5))/2,_t=1/gt,Et=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-_t,-gt,0,-_t,gt,0,_t,-gt,0,_t,gt,-_t,-gt,0,-_t,gt,0,_t,-gt,0,_t,gt,0,-gt,0,-_t,gt,0,-_t,-gt,0,_t,gt,0,_t],At=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],Rt="DodecahedronGeometry";super(Et,At,Rt,nt,st,mt),this.type=Rt}static fromJSON(nt){return new em(nt.radius,nt.corner,nt.cornerSides)}},tm=1e-12,gd=class{constructor(nt){this.position=new U$1,this.startPosition=new U$1,this.uuid=we$1.generateUUID(),this.position=nt.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(nt){this.position.copy(this.startPosition).add(nt)}copy(nt){return this.position.copy(nt.position),this.startPosition.copy(nt.startPosition),this}clone(){return new gd(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},yd=class extends gd{constructor(nt){super(nt.position),this.parent=nt}copy(nt){return super.copy(nt),this}clone(){return new yd(this.parent).copy(this)}},Hs=class extends gd{constructor(nt,st){super(st),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=nt,this.controls.push(new yd(this),new yd(this))}static create(nt,st){let mt=new Hs(nt,new U$1(...st.position));return mt.controls[0].position.set(...st.controlPrevious.position),mt.controls[1].position.set(...st.controlNext.position),mt.roundness=st.roundness,mt.areControlsDirectionsMirrored=st.areControlsDirectionsMirrored,mt}getOppositeControl(nt){let st=this.controls.indexOf(nt);return st===0?this.controls[1]:st===1?this.controls[0]:null}applyOffsetToControls(nt,st=1){for(let mt=0,gt=this.controls.length;mt<gt;mt++){let _t=this.controls[mt];this.position.distanceTo(_t.position)<=st?_t.position.copy(this.position):_t.applyOffset(nt)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(nt){return super.copy(nt),this.controls[0].copy(nt.controls[0]),this.controls[1].copy(nt.controls[1]),this.roundness=nt.roundness,this.uuid=nt.uuid,this}clone(){return new Hs(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var mt,gt;let nt=(mt=this.curveBefore)==null?void 0:mt.getTangentAt(1),st=(gt=this.curveAfter)==null?void 0:gt.getTangentAt(0);return[nt,st]}computeNormals(nt=new U$1,st=new U$1){let[mt,gt]=this.computeTangents();return mt&&gt&&(QI(mt,nt),QI(gt,st)),[nt,st]}computeTangent(nt=new U$1){let[st,mt]=this.computeTangents();return st&&mt&&nt.copy(st).add(mt).normalize(),nt}computeNormal(nt=new U$1){let[st,mt]=this.computeNormals();return nt.copy(st).add(mt).normalize(),nt}};function QI(nt,st=new U$1){let mt=nt.length();return st.set(-nt.y/mt,nt.x/mt)}var fA=nt=>nt,vd=new U$1,y0=new U$1,h7=new U$1,d7=new U$1,f7=new U$1,p7=new U$1,ZI=new E$6,JI=new E$6;function $I(nt){let st=new U$1;st.addVectors(nt.v0,vd.subVectors(nt.v1,nt.v0).multiplyScalar(2/3));let mt=new U$1;return mt.addVectors(nt.v2,y0.subVectors(nt.v1,nt.v2).multiplyScalar(2/3)),new an(nt.v0,st,mt,nt.v2)}function rm(nt,st,mt=Number.EPSILON){return Math.abs(nt-st)<mt}function m7(nt,st,mt=Number.EPSILON){return nt.distanceTo(st)<mt}function g7(nt,st,mt=Number.EPSILON){return nt.distanceTo(st)<mt}function pA(nt,st,mt){let gt=Math.sqrt(Math.pow(st.x-nt.x,2)+Math.pow(st.y-nt.y,2)),_t=Math.sqrt(Math.pow(st.x-mt.x,2)+Math.pow(st.y-mt.y,2)),Et=Math.sqrt(Math.pow(mt.x-nt.x,2)+Math.pow(mt.y-nt.y,2));return Math.acos((_t*_t+gt*gt-Et*Et)/(2*_t*gt))}function eO(nt,st,mt){return KI(nt,st)&&KI(st,mt)&&dA(nt.position,st.position,mt.position)}function dA(nt,st,mt){return vd.copy(st).sub(nt).cross(y0.copy(mt).sub(nt))===0}function tO(nt,st,mt,gt,_t){let Et=Math.sqrt(Math.pow(st.x-nt.x,2)+Math.pow(st.y-nt.y,2)),At=(nt.y+st.y)/2,Rt=(nt.x+st.x)/2,Ft=Math.sqrt(Math.pow(mt,2)-Math.pow(Et/2,2))*(nt.y-st.y)/Et,Nt=Math.sqrt(Math.pow(mt,2)-Math.pow(Et/2,2))*(st.x-nt.x)/Et;return gt.set(Rt+Ft,At+Nt),_t.set(Rt-Ft,At-Nt),[gt,_t]}function rO(nt,st,mt){let gt=nt.distanceTo(mt),_t=st.distanceTo(mt);return gt<_t?st:nt}function iO(nt,st,mt,gt,_t,Et){let At=st.x-nt.x,Rt=st.y-nt.y,Ft=mt.x-nt.x,Nt=mt.y-nt.y,Bt=Math.sqrt((At+Ft)*(At+Ft)+(Rt+Nt)*(Rt+Nt)),Gt;return pA(st,nt,mt)>Math.PI&&(Bt*=-1),rm(Nt,Rt)?Gt=(Rt+Nt)*(gt/Bt-.5)*8/3/(At-Ft):Gt=(At+Ft)*(gt/Bt-.5)*8/3/(Nt-Rt),_t.set(st.x-Gt*Rt,st.y+Gt*At),Et.set(mt.x+Gt*Nt,mt.y-Gt*Ft),[_t,Et]}function mA(nt,st){return nt.position.equals(nt.controls[1].position)&&st.position.equals(st.controls[0].position)}function KI(nt,st){return dA(nt.position,nt.controls[1].position,st.position)&&dA(nt.position,st.controls[0].position,st.position)}function nO(nt,st,mt,gt,_t=.5){let Et=vd.subVectors(st,nt).multiplyScalar(_t).add(nt),At=y0.subVectors(mt,st).multiplyScalar(_t).add(st),Rt=h7.subVectors(gt,mt).multiplyScalar(_t).add(mt),Ft=Et,Nt=d7.subVectors(At,Et).multiplyScalar(_t).add(Et),Bt=f7.subVectors(Rt,At).multiplyScalar(_t).add(At),Gt=Rt,dr=p7.subVectors(Bt,Nt).multiplyScalar(_t).add(Nt);return[nt.x,nt.y,Ft.x,Ft.y,Nt.x,Nt.y,dr.x,dr.y,Bt.x,Bt.y,Gt.x,Gt.y,gt.x,gt.y]}function sO(nt,st,mt=12,gt=!0){let _t=JI.set(0,0,0),Et,At=0;for(let Rt=0;Rt<st.length;Rt++){let Ft=fA(st[Rt]),Nt=vd,Bt=Dl(Ft,mt);for(let Gt=0;Gt<=Bt;Gt++)if(Ft instanceof an||Ft instanceof Yn||Ft instanceof ln){if(Ft.getPoint(Gt/Bt,Nt),_t.set(Nt.x,Nt.y,0),Et!==void 0&&g7(Et,_t))continue;Et===void 0&&(Et=ZI),Et.copy(_t),nt.setXYZ(At,_t.x,_t.y,_t.z),At++}}return gt&&At>1&&!(nt.getX(At-1)===nt.getX(0)&&nt.getY(At-1)===nt.getY(0)&&nt.getZ(At-1)===nt.getZ(0))&&(nt.setXYZ(At,nt.getX(0),nt.getY(0),nt.getZ(0)),At++),nt}function oO(nt,st,mt,gt=12,_t=!0){let Et=JI.set(0,0,0),At=0,Rt=[];for(let Ft=0;Ft<st.length;Ft++){if(mt[Ft]===!1)continue;let Nt,Bt=fA(st[Ft]),Gt=vd,dr=Dl(Bt,gt);Rt.push(dr);for(let Mr=0;Mr<=dr;Mr++)if(Bt instanceof an||Bt instanceof Yn||Bt instanceof ln){if(Bt.getPoint(Mr/dr,Gt),Et.set(Gt.x,Gt.y,0),Nt==null?void 0:Nt.equals(Et))continue;Nt===void 0?Nt=ZI:(nt.setXYZ(At,Nt.x,Nt.y,Nt.z),At++,nt.setXYZ(At,Et.x,Et.y,Et.z),At++),Nt.copy(Et)}}return _t&&At>1&&!(nt.getX(At-1)===nt.getX(0)&&nt.getY(At-1)===nt.getY(0)&&nt.getZ(At-1)===nt.getZ(0))&&(nt.setXYZ(At,nt.getX(0),nt.getY(0),nt.getZ(0)),At++),Rt}function gA(nt,st=12,mt=!1){let gt=[];for(let _t=0,Et=nt.length;_t<Et;_t++){let At=nt[_t],Rt=0;if(mt&&At.roundedCurveCorner!==void 0){let Ft=Dl(At.roundedCurveCorner,st)*.5;_t>0&&(gt[_t-1]+=Ft),Rt+=Ft}At.curveAfter!==void 0&&(Rt+=Dl(At.curveAfter,st)),gt.push(Rt)}return nt.length>0&&mt&&nt[0].roundedCurveCorner!==void 0&&(gt[nt.length-1]+=Dl(nt[0].roundedCurveCorner,st)*.5),gt}function Dl(nt,st=12){return nt&&nt instanceof gc?st*2:nt&&(nt instanceof ln||nt instanceof dp)?1:nt&&nt instanceof Bu?st*nt.points.length:st}function aO(nt,st,mt=12,gt=!0){let _t,Et=0;for(let At=0;At<st.length;At++){let Rt=fA(st[At]),Ft=Dl(Rt,mt),Nt=vd;for(let Bt=0;Bt<=Ft;Bt++)if(Rt instanceof an||Rt instanceof Yn||Rt instanceof ln){if(Rt.getPoint(Bt/Ft,Nt),_t!==void 0&&m7(_t,Nt,tm))continue;_t===void 0&&(_t=y0),_t.copy(Nt),nt.push(Nt.x,Nt.y),Et++}}return rm(nt[0],nt[nt.length-2],tm)&&rm(nt[1],nt[nt.length-1],tm)&&(nt.pop(),nt.pop()),gt&&Et>1&&!(rm(nt[Et-1],nt[1],tm)&&rm(nt[Et-2],nt[0],tm))&&(nt.push(nt[0],nt[1]),Et++),nt}var yA=new U$1,y7=new U$1,v7=new U$1,x7=new U$1,b7=new U$1,S7=new U$1,qt=class extends aa{constructor(nt=100,st=100){super(),this.points=[],this.shapeHoles=[],this.plane=new Vr(new E$6(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=we$1.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=nt,this._height=st}static createFromState(nt,st,mt){let gt=new qt;return gt.isClosed=nt.isClosed,gt.points=nt.points.map(_t=>Hs.create(_t.id,_t.data)),typeof nt.roundness=="number"&&(gt.roundness=nt.roundness),gt.shapeHoles=nt.shapeHoles.map(_t=>qt.createFromState(_t)),st!==void 0&&mt!==void 0&&gt.applySize(st,mt),gt.update(),gt}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(nt){if(this._roundness!==nt){this._roundness=nt;for(let st=0,mt=this.points.length;st<mt;st++)this.points[st].roundness=nt;this.needsUpdate=!0}}getPointsIndexesByIds(nt){return nt.map(st=>this.getPointIndexById(st)).filter(st=>st>=0)}getPointIndexById(nt){let st=this.points.length,mt=this.points.findIndex(gt=>gt.uuid===nt);if(mt<0){let gt=st;for(let _t=0,Et=this.shapeHoles.length;_t<Et;_t++){let At=this.shapeHoles[_t],Rt=At.points.length,Ft=At.getPointIndexById(nt);if(Ft<0)gt+=Rt;else return Ft+gt}}return mt}getLineIndexById(nt){return this.getPointIndexById(nt)}getBezierPoint(nt){if(nt<=this.points.length-1)return this.points[nt];if(this.shapeHoles.length>0){let st=this.points.length;for(let mt=0,gt=this.shapeHoles.length;mt<gt;mt++){let _t=this.shapeHoles[mt],Et=nt-st;if(Et<=_t.points.length-1)return _t.points[Et];st+=_t.points.length}}throw new Error("This shape does not have a point for this index: "+nt)}getBezierPointIndex(nt){let st=this.points.indexOf(nt);if(st>=0)return st;if(st=this.points.length,this.shapeHoles.length>0)for(let mt=0,gt=this.shapeHoles.length;mt<gt;mt++){let _t=this.shapeHoles[mt],Et=_t.points.indexOf(nt);if(Et>=0)return st+Et;st+=_t.points.length}return-1}getAllPoints(){let nt=[].concat(...this.shapeHoles.map(st=>st.points));return[...this.points,...nt]}applySize(nt,st){nt===0&&(nt=.001),st===0&&(st=.001),this._width=nt,this._height=st}applyScale(nt,st){let mt=yA.set(nt,st);for(let gt=0,_t=this.points.length;gt<_t;gt++){let Et=this.points[gt];Et.position.multiply(mt),Et.controls[0].position.multiply(mt),Et.controls[1].position.multiply(mt)}for(let gt=0,_t=this.shapeHoles.length;gt<_t;gt++)this.shapeHoles[gt].applyScale(nt,st);this._update()}createPoint(nt,st=0,mt=we$1.generateUUID()){let gt;nt instanceof U$1?gt=nt:gt=new U$1(nt,st);let _t=new Hs(mt,gt);return _t.roundness=this.roundness,_t}addPoint(nt){this.points.push(nt),this.needsUpdate=!0}addPointAt(nt,st){this.points.splice(st,0,nt),this.needsUpdate=!0}getPointByUuid(nt){for(let st=0,mt=this.points.length;st<mt;st++){let gt=this.points[st];if(gt.uuid===nt)return gt}for(let st=0,mt=this.shapeHoles.length;st<mt;st++){let gt=this.shapeHoles[st].getPointByUuid(nt);if(gt)return gt}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(nt){let st=this.points.indexOf(nt);st>=0&&this.points.splice(st,1),this.needsUpdate=!0}removePointById(nt){let st=this.points.find(mt=>mt.uuid===nt);st&&this.removePoint(st)}update(){for(let nt=0,st=this.shapeHoles.length;nt<st;nt++)this.shapeHoles[nt].update();this._update()}extractShapePointsToBuffer(nt,st=12,mt=!1){this.subdivision=st,this.curveDivisions===void 0&&this.computeCurveDivisions(st);let gt=mt?this.roundedCurveDivisions:this.curveDivisions;return sO(nt,mt?this.roundedCurves:this.curves,st,this.autoClose),gt.reduce((_t,Et)=>_t+Et,0)+1}computeCurveDivisions(nt=12){return this.curveDivisions=gA(this.points,nt,!1),this.roundedCurveDivisions=gA(this.points,nt,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(nt,st,mt=12){return oO(nt,this.curves,st,mt,this.autoClose).reduce((gt,_t)=>gt+_t,0)*2}extractShapePointsToFlatArray(nt,st=12){return this.subdivision=st,this.curveDivisions===void 0&&this.computeCurveDivisions(st),aO(nt,this.roundedCurves,st,this.autoClose)}getCurveIndexFromVertexId(nt,st=!1){let mt=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let gt=st?this.roundedCurveDivisions:this.curveDivisions,_t=0;st&&this.points[0].roundedCurveCorner!==void 0&&(_t=Dl(this.points[0].roundedCurveCorner,this.subdivision)*.5);let Et=nt-_t;Et<0&&(Et+=gt.reduce((At,Rt)=>At+Rt,0));for(let At=0,Rt=gt.length;At<Rt;At++){let Ft=gt[At];if(Et<mt+Ft)return[At,(Et-mt+1)/Ft];mt+=Ft}return[0,1]}getCurveT(nt,st,mt){let gt=this.points[nt],_t=this.points[nt>=this.points.length-1?0:nt+1],Et=this.curveDivisions,At=Et[nt];if(mA(gt,_t)){let Ft=gt.position.distanceTo(_t.position);return gt.position.distanceTo(yA.set(mt.x,mt.y))/Ft}let Rt=0;for(let Ft=0;Ft<nt;Ft++)Rt+=Et[Ft];return(st-Rt)/At}dispose(){}_applyCurveForPoint(nt,st){mA(st,nt)?this.lineTo(nt.position.x,nt.position.y):this.bezierCurveTo(st.controls[1].position.x,st.controls[1].position.y,nt.controls[0].position.x,nt.controls[0].position.y,nt.position.x,nt.position.y);let mt=this.curves[this.curves.length-1];nt.curveBefore=mt,st.curveAfter=mt;let gt=mt.clone();nt.roundedCurveBefore=gt,st.roundedCurveAfter=gt,nt.roundedCurveCorner=void 0,this.roundedCurves.push(gt)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let st=0,mt=this.points.length;st<mt;st++){let gt=this.points[st];if(st===0)this.moveTo(gt.position.x,gt.position.y);else{let _t=this.points[st-1];this._applyCurveForPoint(gt,_t)}}let nt=this.getLastPoint();if(nt!=null&&nt.curveAfter&&(nt.curveAfter=void 0),this.isClosed){let st=this.points[0],mt=this.points[this.points.length-1];this._applyCurveForPoint(st,mt)}if(this.points.length>2){let st=0;for(let mt=0,gt=this.points.length;mt<gt;mt++){let _t=this.points[mt],Et=this.points[mt-1]??this.points[this.points.length-1],At=this.points[mt+1]??this.points[0],Rt=_t.roundness,Ft=Et&&At&&eO(Et,_t,At);if(!_t.controlsMoved()&&Rt>0&&!Ft){let Nt=_t.curveBefore,Bt=_t.curveAfter;if(Nt===void 0||Bt===void 0)continue;let Gt=_t.roundedCurveBefore,dr=_t.roundedCurveAfter,Mr=Nt.getLength(),Tr=Bt.getLength(),zr=Math.min(Rt,Mr*.499),Fr=Math.min(Rt,Tr*.499),Nr=Math.min(zr,Fr),tn=1-Nr/Mr,rn=Nr/Tr,Tn=Nt.getPointAt(tn,yA),$n=Bt.getPointAt(rn,y7);this._subSplitCurve(Nt,Gt,tn,Tn,void 0),this._subSplitCurve(Bt,dr,rn,void 0,$n);let un;if(this.useCubicForRoundedCorners){let es=pA(Tn,_t.position,$n)/2,kn=Math.tan(es)*Tn.distanceTo(_t.position),[ts,Ko]=tO(Tn,$n,kn,v7,x7),ds=rO(ts,Ko,_t.position),[Il,ru]=iO(ds,Tn,$n,kn,b7,S7);un=new an(Tn.clone(),Il.clone(),ru.clone(),$n.clone())}else un=new Yn(Tn.clone(),_t.position.clone(),$n.clone());_t.roundedCurveCorner=un,this.roundedCurves.splice(mt+st,0,un),st++}}}}_subSplitCurve(nt,st,mt,gt,_t){if(nt instanceof ln)gt!==void 0&&st.v2.copy(gt),_t!==void 0&&st.v1.copy(_t);else{let Et=nt,At=st,Rt=Et.getUtoTmapping(mt,0),Ft=nO(Et.v0,Et.v1,Et.v2,Et.v3,Rt);return gt!==void 0&&(At.v0.set(Ft[0],Ft[1]),At.v1.set(Ft[2],Ft[3]),At.v2.set(Ft[4],Ft[5]),At.v3.set(Ft[6],Ft[7])),_t!==void 0&&(At.v0.set(Ft[6],Ft[7]),At.v1.set(Ft[8],Ft[9]),At.v2.set(Ft[10],Ft[11]),At.v3.set(Ft[12],Ft[13])),At}return st}clone(){let nt=new qt(this._width,this._height);return nt.points=this.points.map(st=>st.clone()),nt.isClosed=this.isClosed,nt.roundness=this.roundness,nt.isMesh2D=this.isMesh2D,nt.shapeHoles=this.shapeHoles.map(st=>st.clone()),nt}toJSON(){return{points:this.points.reduce((nt,st)=>nt.concat(st.toJSON()),[]),shapeHoles:this.shapeHoles.map(nt=>nt.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(nt){var mt;this.points=[],this.pointIDs=0;let st=nt.points.length/7;for(let gt=0;gt<st;gt++){let _t=gt*7,Et=nt.points[_t+0],At=nt.points[_t+1],Rt=nt.points[_t+2],Ft=nt.points[_t+3],Nt=nt.points[_t+4],Bt=nt.points[_t+5],Gt=nt.points[_t+6],dr=new Hs(we$1.generateUUID(),new U$1(Et,At));dr.controls[0].position.set(Rt,Ft),dr.controls[1].position.set(Nt,Bt),dr.roundness=Gt,this.points.push(dr)}return this.shapeHoles=(mt=nt.shapeHoles)!=null&&mt.length?nt.shapeHoles.map(gt=>{let _t=new qt;return _t.fromJSON(gt),_t}):[],this.isClosed=nt.isClosed,this._roundness=nt.roundness,this._update(),this}fromShape(nt,st=!1){this.isText=st;let mt=(_t,Et)=>{Et instanceof an&&Et.v3.equals(_t.position)&&_t.controls[0].position.copy(Et.v2)},gt=_t=>{let Et=[],At,Rt;for(At=0,Rt=_t.length;At<Rt;At++)_t[At]instanceof Yn&&(_t[At]=$I(_t[At]));for(At=0,Rt=_t.length;At<Rt;At++){let Bt=_t[At],Gt=At>0?_t[At-1]:null,dr;Bt instanceof an?(dr=this.createPoint(Bt.v0),dr.controls[1].position.copy(Bt.v1)):Bt instanceof ln&&(dr=this.createPoint(Bt.v1)),dr!==void 0&&(Gt!==null&&mt(dr,Gt),Et.push(dr))}let Ft=_t[_t.length-1],Nt=!1;return Ft instanceof an?Ft.v3.equals(Et[0].position)&&(Et[0].controls[0].position.copy(Ft.v2),Nt=!0):Ft instanceof ln&&Ft.v2.equals(Et[0].position)&&(Nt=!0),this.isClosed=Nt,Et};return this.points=gt(nt.curves),nt instanceof aa&&(this.shapeHoles=nt.holes.map(_t=>{let Et=new qt;return Et.fromShape(_t),Et})),this.update(),this}updatePoint(nt,st){let mt=this.getPointByUuid(nt);mt&&(st.position!==void 0&&mt.position.fromArray(st.position),st.roundness!==void 0&&(mt.roundness=st.roundness),st.areControlsDirectionsMirrored!==void 0&&(mt.areControlsDirectionsMirrored=st.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(nt,st){var gt;let mt=(gt=this.getPointByUuid(nt))==null?void 0:gt.controls[0];mt&&(st.position&&mt.position.fromArray(st.position),this.needsUpdate=!0)}updateNextControl(nt,st){var gt;let mt=(gt=this.getPointByUuid(nt))==null?void 0:gt.controls[1];mt&&(st.position&&mt.position.fromArray(st.position),this.needsUpdate=!0)}},xA=Math.PI*2;function vA({x:nt,y:st},mt,gt,_t,Et){return{x:nt*mt+_t,y:st*gt+Et}}function w7(nt,st){let mt=st===1.5707963267948966?.551915024494:st===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(st/4),gt=Math.cos(nt),_t=Math.sin(nt),Et=Math.cos(nt+st),At=Math.sin(nt+st);return[{x:gt-_t*mt,y:_t+gt*mt},{x:Et+At*mt,y:At-Et*mt},{x:Et,y:At}]}function lO(nt,st,mt,gt){let _t=nt*gt-st*mt<0?-1:1,Et=Math.min(1,Math.max(-1,nt*mt+st*gt));return _t*Math.acos(Et)}function A7(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt){let Bt=Math.pow(_t,2),Gt=Math.pow(Et,2),dr=Math.pow(At,2),Mr=Math.pow(Rt,2),Tr=Bt*Gt-Bt*Mr-Gt*dr;Tr<0&&(Tr=0),Tr/=Bt*Mr+Gt*dr,Tr=Math.sqrt(Tr)*(Ft===Nt?-1:1);let zr=Tr*_t/Et*Rt,Fr=Tr*-Et/_t*At,Nr=zr+(nt+mt)/2,tn=Fr+(st+gt)/2,rn=(At-zr)/_t,Tn=(Rt-Fr)/Et,$n=(-At-zr)/_t,un=(-Rt-Fr)/Et,es=lO(1,0,rn,Tn),kn=lO(rn,Tn,$n,un);return!Nt&&kn>0&&(kn-=xA),Nt&&kn<0&&(kn+=xA),{centerx:Nr,centery:tn,ang1:es,ang2:kn}}function cO({px:nt,py:st,cx:mt,cy:gt,rx:_t,ry:Et,largeArcFlag:At,sweepFlag:Rt}){let Ft=[];if(_t===0||Et===0)return[];let Nt=(nt-mt)/2,Bt=(st-gt)/2;if(Nt===0&&Bt===0)return[];_t=Math.abs(_t),Et=Math.abs(Et);let Gt=Math.pow(Nt,2)/Math.pow(_t,2)+Math.pow(Bt,2)/Math.pow(Et,2);Gt>1&&(_t*=Math.sqrt(Gt),Et*=Math.sqrt(Gt));let dr=A7(nt,st,mt,gt,_t,Et,Nt,Bt,At,Rt),{ang1:Mr,ang2:Tr}=dr,{centerx:zr,centery:Fr}=dr,Nr=Math.abs(Tr)/(xA/4);Math.abs(1-Nr)<1e-7&&(Nr=1);let tn=Math.max(Math.ceil(Nr),1);Tr/=tn;for(let rn=0;rn<tn;rn++)Ft.push(w7(Mr,Tr)),Mr+=Tr;return Ft.map(rn=>{let{x:Tn,y:$n}=vA(rn[0],_t,Et,zr,Fr),{x:un,y:es}=vA(rn[1],_t,Et,zr,Fr),{x:kn,y:ts}=vA(rn[2],_t,Et,zr,Fr);return{x1:Tn,y1:$n,x2:un,y2:es,x:kn,y:ts}})}var zt;(function(nt){nt[nt.ODD=0]="ODD",nt[nt.NONZERO=1]="NONZERO",nt[nt.POSITIVE=2]="POSITIVE",nt[nt.NEGATIVE=3]="NEGATIVE",nt[nt.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(zt||(zt={}));var jr;(function(nt){nt[nt.POLYGONS=0]="POLYGONS",nt[nt.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",nt[nt.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(jr||(jr={}));function ut$1(nt,st){if(!nt)throw st||"Assertion Failed!"}var ot=function(){function nt(){}return nt.vertEq=function(st,mt){return st.s===mt.s&&st.t===mt.t},nt.vertLeq=function(st,mt){return st.s<mt.s||st.s===mt.s&&st.t<=mt.t},nt.transLeq=function(st,mt){return st.t<mt.t||st.t===mt.t&&st.s<=mt.s},nt.edgeGoesLeft=function(st){return nt.vertLeq(st.Dst,st.Org)},nt.edgeGoesRight=function(st){return nt.vertLeq(st.Org,st.Dst)},nt.vertL1dist=function(st,mt){return Math.abs(st.s-mt.s)+Math.abs(st.t-mt.t)},nt.edgeEval=function(st,mt,gt){ut$1(nt.vertLeq(st,mt)&&nt.vertLeq(mt,gt));var _t=mt.s-st.s,Et=gt.s-mt.s;return _t+Et>0?_t<Et?mt.t-st.t+(st.t-gt.t)*(_t/(_t+Et)):mt.t-gt.t+(gt.t-st.t)*(Et/(_t+Et)):0},nt.edgeSign=function(st,mt,gt){ut$1(nt.vertLeq(st,mt)&&nt.vertLeq(mt,gt));var _t=mt.s-st.s,Et=gt.s-mt.s;return _t+Et>0?(mt.t-gt.t)*_t+(mt.t-st.t)*Et:0},nt.transEval=function(st,mt,gt){ut$1(nt.transLeq(st,mt)&&nt.transLeq(mt,gt));var _t=mt.t-st.t,Et=gt.t-mt.t;return _t+Et>0?_t<Et?mt.s-st.s+(st.s-gt.s)*(_t/(_t+Et)):mt.s-gt.s+(gt.s-st.s)*(Et/(_t+Et)):0},nt.transSign=function(st,mt,gt){ut$1(nt.transLeq(st,mt)&&nt.transLeq(mt,gt));var _t=mt.t-st.t,Et=gt.t-mt.t;return _t+Et>0?(mt.s-gt.s)*_t+(mt.s-st.s)*Et:0},nt.vertCCW=function(st,mt,gt){return st.s*(mt.t-gt.t)+mt.s*(gt.t-st.t)+gt.s*(st.t-mt.t)>=0},nt.interpolate=function(st,mt,gt,_t){return st=st<0?0:st,gt=gt<0?0:gt,st<=gt?gt===0?(mt+_t)/2:mt+(_t-mt)*(st/(st+gt)):_t+(mt-_t)*(gt/(st+gt))},nt.intersect=function(st,mt,gt,_t,Et){var At,Rt,Ft;nt.vertLeq(st,mt)||(Ft=st,st=mt,mt=Ft),nt.vertLeq(gt,_t)||(Ft=gt,gt=_t,_t=Ft),nt.vertLeq(st,gt)||(Ft=st,st=gt,gt=Ft,Ft=mt,mt=_t,_t=Ft),nt.vertLeq(gt,mt)?nt.vertLeq(mt,_t)?(At=nt.edgeEval(st,gt,mt),Rt=nt.edgeEval(gt,mt,_t),At+Rt<0&&(At=-At,Rt=-Rt),Et.s=nt.interpolate(At,gt.s,Rt,mt.s)):(At=nt.edgeSign(st,gt,mt),Rt=-nt.edgeSign(st,_t,mt),At+Rt<0&&(At=-At,Rt=-Rt),Et.s=nt.interpolate(At,gt.s,Rt,_t.s)):Et.s=(gt.s+mt.s)/2,nt.transLeq(st,mt)||(Ft=st,st=mt,mt=Ft),nt.transLeq(gt,_t)||(Ft=gt,gt=_t,_t=Ft),nt.transLeq(st,gt)||(Ft=st,st=gt,gt=Ft,Ft=mt,mt=_t,_t=Ft),nt.transLeq(gt,mt)?nt.transLeq(mt,_t)?(At=nt.transEval(st,gt,mt),Rt=nt.transEval(gt,mt,_t),At+Rt<0&&(At=-At,Rt=-Rt),Et.t=nt.interpolate(At,gt.t,Rt,mt.t)):(At=nt.transSign(st,gt,mt),Rt=-nt.transSign(st,_t,mt),At+Rt<0&&(At=-At,Rt=-Rt),Et.t=nt.interpolate(At,gt.t,Rt,_t.t)):Et.t=(gt.t+mt.t)/2},nt}(),im=function(){function nt(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return nt}(),v0=function(){function nt(st){this.side=st,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(nt.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(st){this.Sym.Lface=st},enumerable:!0,configurable:!0}),Object.defineProperty(nt.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(st){this.Sym.Org=st},enumerable:!0,configurable:!0}),Object.defineProperty(nt.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(st){this.Sym.Lnext=st},enumerable:!0,configurable:!0}),Object.defineProperty(nt.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(st){this.Onext.Sym=st},enumerable:!0,configurable:!0}),Object.defineProperty(nt.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(st){this.Lnext.Sym=st},enumerable:!0,configurable:!0}),Object.defineProperty(nt.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(st){this.Sym.Onext=st},enumerable:!0,configurable:!0}),Object.defineProperty(nt.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(st){this.Sym.Onext.Sym=st},enumerable:!0,configurable:!0}),Object.defineProperty(nt.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(st){this.Sym.Lnext.Sym=st},enumerable:!0,configurable:!0}),nt}(),xd=function(){function nt(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return nt}(),uO=function(){function nt(){var st=new xd,mt=new im,gt=new v0(0),_t=new v0(1);st.next=st.prev=st,st.anEdge=null,mt.next=mt.prev=mt,gt.next=gt,gt.Sym=_t,_t.next=_t,_t.Sym=gt,this.vHead=st,this.fHead=mt,this.eHead=gt,this.eHeadSym=_t}return nt.prototype.makeEdge_=function(st){var mt=new v0(0),gt=new v0(1);st.Sym.side<st.side&&(st=st.Sym);var _t=st.Sym.next;return gt.next=_t,_t.Sym.next=mt,mt.next=st,st.Sym.next=gt,mt.Sym=gt,mt.Onext=mt,mt.Lnext=gt,mt.Org=null,mt.Lface=null,mt.winding=0,mt.activeRegion=null,gt.Sym=mt,gt.Onext=gt,gt.Lnext=mt,gt.Org=null,gt.Lface=null,gt.winding=0,gt.activeRegion=null,mt},nt.prototype.splice_=function(st,mt){var gt=st.Onext,_t=mt.Onext;gt.Sym.Lnext=mt,_t.Sym.Lnext=st,st.Onext=_t,mt.Onext=gt},nt.prototype.makeVertex_=function(st,mt,gt){var _t=st;ut$1(_t,"Vertex can't be null!");var Et=gt.prev;_t.prev=Et,Et.next=_t,_t.next=gt,gt.prev=_t,_t.anEdge=mt;var At=mt;do At.Org=_t,At=At.Onext;while(At!==mt)},nt.prototype.makeFace_=function(st,mt,gt){var _t=st;ut$1(_t,"Face can't be null");var Et=gt.prev;_t.prev=Et,Et.next=_t,_t.next=gt,gt.prev=_t,_t.anEdge=mt,_t.trail=null,_t.marked=!1,_t.inside=gt.inside;var At=mt;do At.Lface=_t,At=At.Lnext;while(At!==mt)},nt.prototype.killEdge_=function(st){st.Sym.side<st.side&&(st=st.Sym);var mt=st.next,gt=st.Sym.next;mt.Sym.next=gt,gt.Sym.next=mt},nt.prototype.killVertex_=function(st,mt){var gt=st.anEdge,_t=gt;do _t.Org=mt,_t=_t.Onext;while(_t!==gt);var Et=st.prev,At=st.next;At.prev=Et,Et.next=At},nt.prototype.killFace_=function(st,mt){var gt=st.anEdge,_t=gt;do _t.Lface=mt,_t=_t.Lnext;while(_t!==gt);var Et=st.prev,At=st.next;At.prev=Et,Et.next=At},nt.prototype.makeEdge=function(){var st=new xd,mt=new xd,gt=new im,_t=this.makeEdge_(this.eHead);return this.makeVertex_(st,_t,this.vHead),this.makeVertex_(mt,_t.Sym,this.vHead),this.makeFace_(gt,_t,this.fHead),_t},nt.prototype.splice=function(st,mt){var gt=!1,_t=!1;if(st!==mt){if(mt.Org!==st.Org&&(_t=!0,this.killVertex_(mt.Org,st.Org)),mt.Lface!==st.Lface&&(gt=!0,this.killFace_(mt.Lface,st.Lface)),this.splice_(mt,st),!_t){var Et=new xd;this.makeVertex_(Et,mt,st.Org),st.Org.anEdge=st}if(!gt){var At=new im;this.makeFace_(At,mt,st.Lface),st.Lface.anEdge=st}}},nt.prototype.delete=function(st){var mt=st.Sym,gt=!1;if(st.Lface!==st.Rface&&(gt=!0,this.killFace_(st.Lface,st.Rface)),st.Onext===st)this.killVertex_(st.Org,null);else if(st.Rface.anEdge=st.Oprev,st.Org.anEdge=st.Onext,this.splice_(st,st.Oprev),!gt){var _t=new im;this.makeFace_(_t,st,st.Lface)}mt.Onext===mt?(this.killVertex_(mt.Org,null),this.killFace_(mt.Lface,null)):(st.Lface.anEdge=mt.Oprev,mt.Org.anEdge=mt.Onext,this.splice_(mt,mt.Oprev)),this.killEdge_(st)},nt.prototype.addEdgeVertex=function(st){var mt=this.makeEdge_(st),gt=mt.Sym;this.splice_(mt,st.Lnext),mt.Org=st.Dst;var _t=new xd;return this.makeVertex_(_t,gt,mt.Org),mt.Lface=gt.Lface=st.Lface,mt},nt.prototype.splitEdge=function(st){var mt=this.addEdgeVertex(st),gt=mt.Sym;return this.splice_(st.Sym,st.Sym.Oprev),this.splice_(st.Sym,gt),st.Dst=gt.Org,gt.Dst.anEdge=gt.Sym,gt.Rface=st.Rface,gt.winding=st.winding,gt.Sym.winding=st.Sym.winding,gt.idx=st.idx,gt.Sym.idx=st.Sym.idx,gt},nt.prototype.connect=function(st,mt){var gt=!1,_t=this.makeEdge_(st),Et=_t.Sym;if(mt.Lface!==st.Lface&&(gt=!0,this.killFace_(mt.Lface,st.Lface)),this.splice_(_t,st.Lnext),this.splice_(Et,mt),_t.Org=st.Dst,Et.Org=mt.Org,_t.Lface=Et.Lface=st.Lface,st.Lface.anEdge=Et,!gt){var At=new im;this.makeFace_(At,_t,st.Lface)}return _t},nt.prototype.zapFace=function(st){var mt=st.anEdge,gt,_t,Et,At,Rt;_t=mt.Lnext;do gt=_t,_t=gt.Lnext,gt.Lface=null,gt.Rface===null&&(gt.Onext===gt?this.killVertex_(gt.Org,null):(gt.Org.anEdge=gt.Onext,this.splice_(gt,gt.Oprev)),Et=gt.Sym,Et.Onext===Et?this.killVertex_(Et.Org,null):(Et.Org.anEdge=Et.Onext,this.splice_(Et,Et.Oprev)),this.killEdge_(gt));while(gt!=mt);At=st.prev,Rt=st.next,Rt.prev=At,At.next=Rt},nt.prototype.countFaceVerts_=function(st){var mt=st.anEdge,gt=0;do gt++,mt=mt.Lnext;while(mt!==st.anEdge);return gt},nt.prototype.mergeConvexFaces=function(st){var mt,gt,_t,Et,At,Rt,Ft;for(mt=this.fHead.next;mt!==this.fHead;mt=mt.next)if(mt.inside)for(gt=mt.anEdge,At=gt.Org;_t=gt.Lnext,Et=gt.Sym,Et&&Et.Lface&&Et.Lface.inside&&(Rt=this.countFaceVerts_(mt),Ft=this.countFaceVerts_(Et.Lface),Rt+Ft-2<=st&&ot.vertCCW(gt.Lprev.Org,gt.Org,Et.Lnext.Lnext.Org)&&ot.vertCCW(Et.Lprev.Org,Et.Org,gt.Lnext.Lnext.Org)&&(_t=Et.Lnext,this.delete(Et),gt=null,Et=null)),!(gt&&gt.Lnext.Org===At);)gt=_t;return!0},nt.prototype.check=function(){var st=this.fHead,mt=this.vHead,gt=this.eHead,_t,Et,At,Rt,Ft,Nt;for(Et=st,Et=st;(_t=Et.next)!==st;Et=_t){ut$1(_t.prev===Et),Ft=_t.anEdge;do ut$1(Ft.Sym!==Ft),ut$1(Ft.Sym.Sym===Ft),ut$1(Ft.Lnext.Onext.Sym===Ft),ut$1(Ft.Onext.Sym.Lnext===Ft),ut$1(Ft.Lface===_t),Ft=Ft.Lnext;while(Ft!==_t.anEdge)}for(ut$1(_t.prev===Et&&_t.anEdge===null),Rt=mt,Rt=mt;(At=Rt.next)!==mt;Rt=At){ut$1(At.prev===Rt),Ft=At.anEdge;do ut$1(Ft.Sym!==Ft),ut$1(Ft.Sym.Sym===Ft),ut$1(Ft.Lnext.Onext.Sym===Ft),ut$1(Ft.Onext.Sym.Lnext===Ft),ut$1(Ft.Org===At),Ft=Ft.Onext;while(Ft!==At.anEdge)}for(ut$1(At.prev===Rt&&At.anEdge===null),Nt=gt,Nt=gt;(Ft=Nt.next)!==gt;Nt=Ft)ut$1(Ft.Sym.next===Nt.Sym),ut$1(Ft.Sym!==Ft),ut$1(Ft.Sym.Sym===Ft),ut$1(Ft.Org!==null),ut$1(Ft.Dst!==null),ut$1(Ft.Lnext.Onext.Sym===Ft),ut$1(Ft.Onext.Sym.Lnext===Ft);ut$1(Ft.Sym.next===Nt.Sym&&Ft.Sym===this.eHeadSym&&Ft.Sym.Sym===Ft&&Ft.Org===null&&Ft.Dst===null&&Ft.Lface===null&&Ft.Rface===null)},nt}(),hO=function(){function nt(){this.handle=null}return nt}(),dO=function(){function nt(){this.key=null,this.node=0}return nt}(),E7=function(){function nt(st,mt){this.leq=mt,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=st,this.nodes=[],this.handles=[];for(var gt=0;gt<st+1;gt++)this.nodes[gt]=new hO,this.handles[gt]=new dO;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return nt.prototype.floatDown_=function(st){var mt=this.nodes,gt=this.handles,_t,Et,At;for(_t=mt[st].handle;;){if(At=st<<1,At<this.size&&this.leq(gt[mt[At+1].handle].key,gt[mt[At].handle].key)&&++At,ut$1(At<=this.max),Et=mt[At].handle,At>this.size||this.leq(gt[_t].key,gt[Et].key)){mt[st].handle=_t,gt[_t].node=st;break}mt[st].handle=Et,gt[Et].node=st,st=At}},nt.prototype.floatUp_=function(st){var mt=this.nodes,gt=this.handles,_t,Et,At;for(_t=mt[st].handle;;){if(At=st>>1,Et=mt[At].handle,At===0||this.leq(gt[Et].key,gt[_t].key)){mt[st].handle=_t,gt[_t].node=st;break}mt[st].handle=Et,gt[Et].node=st,st=At}},nt.prototype.init=function(){for(var st=this.size;st>=1;--st)this.floatDown_(st);this.initialized=!0},nt.prototype.min=function(){return this.handles[this.nodes[1].handle].key},nt.prototype.insert=function(st){var mt,gt;if(mt=++this.size,mt*2>this.max){this.max*=2;var _t,Et;for(Et=this.nodes.length,this.nodes.length=this.max+1,_t=Et;_t<this.nodes.length;_t++)this.nodes[_t]=new hO;for(Et=this.handles.length,this.handles.length=this.max+1,_t=Et;_t<this.handles.length;_t++)this.handles[_t]=new dO}return this.freeList===0?gt=mt:(gt=this.freeList,this.freeList=this.handles[gt].node),this.nodes[mt].handle=gt,this.handles[gt].node=mt,this.handles[gt].key=st,this.initialized&&this.floatUp_(mt),gt},nt.prototype.extractMin=function(){var st=this.nodes,mt=this.handles,gt=st[1].handle,_t=mt[gt].key;return this.size>0&&(st[1].handle=st[this.size].handle,mt[st[1].handle].node=1,mt[gt].key=null,mt[gt].node=this.freeList,this.freeList=gt,--this.size,this.size>0&&this.floatDown_(1)),_t},nt.prototype.delete=function(st){var mt=this.nodes,gt=this.handles,_t;ut$1(st>=1&&st<=this.max&&gt[st].key!==null),_t=gt[st].node,mt[_t].handle=mt[this.size].handle,gt[mt[_t].handle].node=_t,--this.size,_t<=this.size&&(_t<=1||this.leq(gt[mt[_t>>1].handle].key,gt[mt[_t].handle].key)?this.floatDown_(_t):this.floatUp_(_t)),gt[st].key=null,gt[st].node=this.freeList,this.freeList=st},nt}(),bA=function(){function nt(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return nt}(),fO=function(){function nt(){this.key=null,this.next=null,this.prev=null}return nt}(),M7=function(){function nt(st,mt){this.frame=st,this.leq=mt,this.head=new fO,this.head.next=this.head,this.head.prev=this.head}return nt.prototype.min=function(){return this.head.next},nt.prototype.max=function(){return this.head.prev},nt.prototype.insert=function(st){return this.insertBefore(this.head,st)},nt.prototype.search=function(st){var mt=this.head;do mt=mt.next;while(mt.key!==null&&!this.leq(this.frame,st,mt.key));return mt},nt.prototype.insertBefore=function(st,mt){do st=st.prev;while(st.key!==null&&!this.leq(this.frame,st.key,mt));var gt=new fO;return gt.key=mt,gt.next=st.next,st.next.prev=gt,gt.prev=st,st.next=gt,gt},nt.prototype.delete=function(st){st.next.prev=st.prev,st.prev.next=st.next},nt}(),T7=function(){function nt(){}return nt.regionBelow=function(st){return st.nodeUp.prev.key},nt.regionAbove=function(st){return st.nodeUp.next.key},nt.debugEvent=function(st){},nt.addWinding=function(st,mt){st.winding+=mt.winding,st.Sym.winding+=mt.Sym.winding},nt.edgeLeq=function(st,mt,gt){var _t=st.event,Et=mt.eUp,At=gt.eUp;if(Et.Dst===_t)return At.Dst===_t?ot.vertLeq(Et.Org,At.Org)?ot.edgeSign(At.Dst,Et.Org,At.Org)<=0:ot.edgeSign(Et.Dst,At.Org,Et.Org)>=0:ot.edgeSign(At.Dst,_t,At.Org)<=0;if(At.Dst===_t)return ot.edgeSign(Et.Dst,_t,Et.Org)>=0;var Rt=ot.edgeEval(Et.Dst,_t,Et.Org),Ft=ot.edgeEval(At.Dst,_t,At.Org);return Rt>=Ft},nt.deleteRegion=function(st,mt){mt.fixUpperEdge&&ut$1(mt.eUp.winding===0),mt.eUp.activeRegion=null,st.dict.delete(mt.nodeUp)},nt.fixUpperEdge=function(st,mt,gt){ut$1(mt.fixUpperEdge),st.mesh.delete(mt.eUp),mt.fixUpperEdge=!1,mt.eUp=gt,gt.activeRegion=mt},nt.topLeftRegion=function(st,mt){var gt=mt.eUp.Org,_t;do mt=nt.regionAbove(mt);while(mt.eUp.Org===gt);if(mt.fixUpperEdge){if(_t=st.mesh.connect(nt.regionBelow(mt).eUp.Sym,mt.eUp.Lnext),_t===null)return null;nt.fixUpperEdge(st,mt,_t),mt=nt.regionAbove(mt)}return mt},nt.topRightRegion=function(st){var mt=st.eUp.Dst;do st=nt.regionAbove(st);while(st.eUp.Dst===mt);return st},nt.addRegionBelow=function(st,mt,gt){var _t=new bA;return _t.eUp=gt,_t.nodeUp=st.dict.insertBefore(mt.nodeUp,_t),_t.fixUpperEdge=!1,_t.sentinel=!1,_t.dirty=!1,gt.activeRegion=_t,_t},nt.isWindingInside=function(st,mt){switch(st.windingRule){case zt.ODD:return(mt&1)!==0;case zt.NONZERO:return mt!==0;case zt.POSITIVE:return mt>0;case zt.NEGATIVE:return mt<0;case zt.ABS_GEQ_TWO:return mt>=2||mt<=-2}throw new Error("Invalid winding rulle")},nt.computeWinding=function(st,mt){mt.windingNumber=nt.regionAbove(mt).windingNumber+mt.eUp.winding,mt.inside=nt.isWindingInside(st,mt.windingNumber)},nt.finishRegion=function(st,mt){var gt=mt.eUp,_t=gt.Lface;_t.inside=mt.inside,_t.anEdge=gt,nt.deleteRegion(st,mt)},nt.finishLeftRegions=function(st,mt,gt){for(var _t,Et=null,At=mt,Rt=mt.eUp;At!==gt;){if(At.fixUpperEdge=!1,Et=nt.regionBelow(At),_t=Et.eUp,_t.Org!=Rt.Org){if(!Et.fixUpperEdge){nt.finishRegion(st,At);break}_t=st.mesh.connect(Rt.Lprev,_t.Sym),nt.fixUpperEdge(st,Et,_t)}Rt.Onext!==_t&&(st.mesh.splice(_t.Oprev,_t),st.mesh.splice(Rt,_t)),nt.finishRegion(st,At),Rt=Et.eUp,At=Et}return Rt},nt.addRightEdges=function(st,mt,gt,_t,Et,At){var Rt,Ft,Nt,Bt,Gt=!0;Nt=gt;do ut$1(ot.vertLeq(Nt.Org,Nt.Dst)),nt.addRegionBelow(st,mt,Nt.Sym),Nt=Nt.Onext;while(Nt!==_t);for(Et===null&&(Et=nt.regionBelow(mt).eUp.Rprev),Ft=mt,Bt=Et;Rt=nt.regionBelow(Ft),Nt=Rt.eUp.Sym,Nt.Org===Bt.Org;)Nt.Onext!==Bt&&(st.mesh.splice(Nt.Oprev,Nt),st.mesh.splice(Bt.Oprev,Nt)),Rt.windingNumber=Ft.windingNumber-Nt.winding,Rt.inside=nt.isWindingInside(st,Rt.windingNumber),Ft.dirty=!0,!Gt&&nt.checkForRightSplice(st,Ft)&&(nt.addWinding(Nt,Bt),nt.deleteRegion(st,Ft),st.mesh.delete(Bt)),Gt=!1,Ft=Rt,Bt=Nt;Ft.dirty=!0,ut$1(Ft.windingNumber-Nt.winding===Rt.windingNumber),At&&nt.walkDirtyRegions(st,Ft)},nt.spliceMergeVertices=function(st,mt,gt){st.mesh.splice(mt,gt)},nt.vertexWeights=function(st,mt,gt){var _t=ot.vertL1dist(mt,st),Et=ot.vertL1dist(gt,st),At=.5*Et/(_t+Et),Rt=.5*_t/(_t+Et);st.coords[0]+=At*mt.coords[0]+Rt*gt.coords[0],st.coords[1]+=At*mt.coords[1]+Rt*gt.coords[1],st.coords[2]+=At*mt.coords[2]+Rt*gt.coords[2]},nt.getIntersectData=function(st,mt,gt,_t,Et,At){mt.coords[0]=mt.coords[1]=mt.coords[2]=0,mt.idx=-1,nt.vertexWeights(mt,gt,_t),nt.vertexWeights(mt,Et,At)},nt.checkForRightSplice=function(st,mt){var gt=nt.regionBelow(mt),_t=mt.eUp,Et=gt.eUp;if(ot.vertLeq(_t.Org,Et.Org)){if(ot.edgeSign(Et.Dst,_t.Org,Et.Org)>0)return!1;ot.vertEq(_t.Org,Et.Org)?_t.Org!==Et.Org&&(st.pq.delete(_t.Org.pqHandle),nt.spliceMergeVertices(st,Et.Oprev,_t)):(st.mesh.splitEdge(Et.Sym),st.mesh.splice(_t,Et.Oprev),mt.dirty=gt.dirty=!0)}else{if(ot.edgeSign(_t.Dst,Et.Org,_t.Org)<0)return!1;nt.regionAbove(mt).dirty=mt.dirty=!0,st.mesh.splitEdge(_t.Sym),st.mesh.splice(Et.Oprev,_t)}return!0},nt.checkForLeftSplice=function(st,mt){var gt=nt.regionBelow(mt),_t=mt.eUp,Et=gt.eUp,At;if(ut$1(!ot.vertEq(_t.Dst,Et.Dst)),ot.vertLeq(_t.Dst,Et.Dst)){if(ot.edgeSign(_t.Dst,Et.Dst,_t.Org)<0)return!1;nt.regionAbove(mt).dirty=mt.dirty=!0,At=st.mesh.splitEdge(_t),st.mesh.splice(Et.Sym,At),At.Lface.inside=mt.inside}else{if(ot.edgeSign(Et.Dst,_t.Dst,Et.Org)>0)return!1;mt.dirty=gt.dirty=!0,At=st.mesh.splitEdge(Et),st.mesh.splice(_t.Lnext,Et.Sym),At.Rface.inside=mt.inside}return!0},nt.checkForIntersect=function(st,mt){var gt=nt.regionBelow(mt),_t=mt.eUp,Et=gt.eUp,At=_t.Org,Rt=Et.Org,Ft=_t.Dst,Nt=Et.Dst,Bt,Gt,dr=new xd,Mr,Tr;if(ut$1(!ot.vertEq(Nt,Ft)),ut$1(ot.edgeSign(Ft,st.event,At)<=0),ut$1(ot.edgeSign(Nt,st.event,Rt)>=0),ut$1(At!==st.event&&Rt!==st.event),ut$1(!mt.fixUpperEdge&&!gt.fixUpperEdge),At===Rt||(Bt=Math.min(At.t,Ft.t),Gt=Math.max(Rt.t,Nt.t),Bt>Gt))return!1;if(ot.vertLeq(At,Rt)){if(ot.edgeSign(Nt,At,Rt)>0)return!1}else if(ot.edgeSign(Ft,Rt,At)<0)return!1;return nt.debugEvent(st),ot.intersect(Ft,At,Nt,Rt,dr),ut$1(Math.min(At.t,Ft.t)<=dr.t),ut$1(dr.t<=Math.max(Rt.t,Nt.t)),ut$1(Math.min(Nt.s,Ft.s)<=dr.s),ut$1(dr.s<=Math.max(Rt.s,At.s)),ot.vertLeq(dr,st.event)&&(dr.s=st.event.s,dr.t=st.event.t),Mr=ot.vertLeq(At,Rt)?At:Rt,ot.vertLeq(Mr,dr)&&(dr.s=Mr.s,dr.t=Mr.t),ot.vertEq(dr,At)||ot.vertEq(dr,Rt)?(nt.checkForRightSplice(st,mt),!1):!ot.vertEq(Ft,st.event)&&ot.edgeSign(Ft,st.event,dr)>=0||!ot.vertEq(Nt,st.event)&&ot.edgeSign(Nt,st.event,dr)<=0?Nt===st.event?(st.mesh.splitEdge(_t.Sym),st.mesh.splice(Et.Sym,_t),mt=nt.topLeftRegion(st,mt),_t=nt.regionBelow(mt).eUp,nt.finishLeftRegions(st,nt.regionBelow(mt),gt),nt.addRightEdges(st,mt,_t.Oprev,_t,_t,!0),!0):Ft===st.event?(st.mesh.splitEdge(Et.Sym),st.mesh.splice(_t.Lnext,Et.Oprev),gt=mt,mt=nt.topRightRegion(mt),Tr=nt.regionBelow(mt).eUp.Rprev,gt.eUp=Et.Oprev,Et=nt.finishLeftRegions(st,gt,null),nt.addRightEdges(st,mt,Et.Onext,_t.Rprev,Tr,!0),!0):(ot.edgeSign(Ft,st.event,dr)>=0&&(nt.regionAbove(mt).dirty=mt.dirty=!0,st.mesh.splitEdge(_t.Sym),_t.Org.s=st.event.s,_t.Org.t=st.event.t),ot.edgeSign(Nt,st.event,dr)<=0&&(mt.dirty=gt.dirty=!0,st.mesh.splitEdge(Et.Sym),Et.Org.s=st.event.s,Et.Org.t=st.event.t),!1):(st.mesh.splitEdge(_t.Sym),st.mesh.splitEdge(Et.Sym),st.mesh.splice(Et.Oprev,_t),_t.Org.s=dr.s,_t.Org.t=dr.t,_t.Org.pqHandle=st.pq.insert(_t.Org),nt.getIntersectData(st,_t.Org,At,Ft,Rt,Nt),nt.regionAbove(mt).dirty=mt.dirty=gt.dirty=!0,!1)},nt.walkDirtyRegions=function(st,mt){for(var gt=nt.regionBelow(mt),_t,Et;;){for(;gt.dirty;)mt=gt,gt=nt.regionBelow(gt);if(!mt.dirty&&(gt=mt,mt=nt.regionAbove(mt),mt===null||!mt.dirty))return;if(mt.dirty=!1,_t=mt.eUp,Et=gt.eUp,_t.Dst!==Et.Dst&&nt.checkForLeftSplice(st,mt)&&(gt.fixUpperEdge?(nt.deleteRegion(st,gt),st.mesh.delete(Et),gt=nt.regionBelow(mt),Et=gt.eUp):mt.fixUpperEdge&&(nt.deleteRegion(st,mt),st.mesh.delete(_t),mt=nt.regionAbove(gt),_t=mt.eUp)),_t.Org!==Et.Org)if(_t.Dst!==Et.Dst&&!mt.fixUpperEdge&&!gt.fixUpperEdge&&(_t.Dst===st.event||Et.Dst===st.event)){if(nt.checkForIntersect(st,mt))return}else nt.checkForRightSplice(st,mt);_t.Org===Et.Org&&_t.Dst===Et.Dst&&(nt.addWinding(Et,_t),nt.deleteRegion(st,mt),st.mesh.delete(_t),mt=nt.regionAbove(gt))}},nt.connectRightVertex=function(st,mt,gt){var _t,Et=gt.Onext,At=nt.regionBelow(mt),Rt=mt.eUp,Ft=At.eUp,Nt=!1;if(Rt.Dst!==Ft.Dst&&nt.checkForIntersect(st,mt),ot.vertEq(Rt.Org,st.event)&&(st.mesh.splice(Et.Oprev,Rt),mt=nt.topLeftRegion(st,mt),Et=nt.regionBelow(mt).eUp,nt.finishLeftRegions(st,nt.regionBelow(mt),At),Nt=!0),ot.vertEq(Ft.Org,st.event)&&(st.mesh.splice(gt,Ft.Oprev),gt=nt.finishLeftRegions(st,At,null),Nt=!0),Nt){nt.addRightEdges(st,mt,gt.Onext,Et,Et,!0);return}ot.vertLeq(Ft.Org,Rt.Org)?_t=Ft.Oprev:_t=Rt,_t=st.mesh.connect(gt.Lprev,_t),nt.addRightEdges(st,mt,_t,_t.Onext,_t.Onext,!1),_t.Sym.activeRegion.fixUpperEdge=!0,nt.walkDirtyRegions(st,mt)},nt.connectLeftDegenerate=function(st,mt,gt){var _t,Et,At,Rt,Ft;if(_t=mt.eUp,ot.vertEq(_t.Org,gt)){ut$1(!1),nt.spliceMergeVertices(st,_t,gt.anEdge);return}if(!ot.vertEq(_t.Dst,gt)){st.mesh.splitEdge(_t.Sym),mt.fixUpperEdge&&(st.mesh.delete(_t.Onext),mt.fixUpperEdge=!1),st.mesh.splice(gt.anEdge,_t),nt.sweepEvent(st,gt);return}ut$1(!1),mt=nt.topRightRegion(mt),Ft=nt.regionBelow(mt),At=Ft.eUp.Sym,Et=Rt=At.Onext,Ft.fixUpperEdge&&(ut$1(Et!==At),nt.deleteRegion(st,Ft),st.mesh.delete(At),At=Et.Oprev),st.mesh.splice(gt.anEdge,At),ot.edgeGoesLeft(Et)||(Et=null),nt.addRightEdges(st,mt,At.Onext,Rt,Et,!0)},nt.connectLeftVertex=function(st,mt){var gt,_t,Et,At,Rt,Ft,Nt=new bA;if(Nt.eUp=mt.anEdge.Sym,gt=st.dict.search(Nt).key,_t=nt.regionBelow(gt),!!_t){if(At=gt.eUp,Rt=_t.eUp,ot.edgeSign(At.Dst,mt,At.Org)===0){nt.connectLeftDegenerate(st,gt,mt);return}if(Et=ot.vertLeq(Rt.Dst,At.Dst)?gt:_t,gt.inside||Et.fixUpperEdge){if(Et===gt)Ft=st.mesh.connect(mt.anEdge.Sym,At.Lnext);else{var Bt=st.mesh.connect(Rt.Dnext,mt.anEdge);Ft=Bt.Sym}Et.fixUpperEdge?nt.fixUpperEdge(st,Et,Ft):nt.computeWinding(st,nt.addRegionBelow(st,gt,Ft)),nt.sweepEvent(st,mt)}else nt.addRightEdges(st,gt,mt.anEdge,mt.anEdge,null,!0)}},nt.sweepEvent=function(st,mt){st.event=mt,nt.debugEvent(st);for(var gt=mt.anEdge;gt.activeRegion===null;)if(gt=gt.Onext,gt===mt.anEdge){nt.connectLeftVertex(st,mt);return}var _t=nt.topLeftRegion(st,gt.activeRegion);ut$1(_t!==null);var Et=nt.regionBelow(_t),At=Et.eUp,Rt=nt.finishLeftRegions(st,Et,null);Rt.Onext===At?nt.connectRightVertex(st,_t,Rt):nt.addRightEdges(st,_t,Rt.Onext,At,At,!0)},nt.addSentinel=function(st,mt,gt,_t){var Et=new bA,At=st.mesh.makeEdge();At.Org.s=gt,At.Org.t=_t,At.Dst.s=mt,At.Dst.t=_t,st.event=At.Dst,Et.eUp=At,Et.windingNumber=0,Et.inside=!1,Et.fixUpperEdge=!1,Et.sentinel=!0,Et.dirty=!1,Et.nodeUp=st.dict.insert(Et)},nt.initEdgeDict=function(st){st.dict=new M7(st,nt.edgeLeq);var mt=st.bmax[0]-st.bmin[0],gt=st.bmax[1]-st.bmin[1],_t=st.bmin[0]-mt,Et=st.bmax[0]+mt,At=st.bmin[1]-gt,Rt=st.bmax[1]+gt;nt.addSentinel(st,_t,Et,At),nt.addSentinel(st,_t,Et,Rt)},nt.doneEdgeDict=function(st){for(var mt,gt=0;(mt=st.dict.min().key)!==null;)mt.sentinel||(ut$1(mt.fixUpperEdge),ut$1(++gt===1)),ut$1(mt.windingNumber===0),nt.deleteRegion(st,mt)},nt.removeDegenerateEdges=function(st){var mt,gt,_t,Et=st.mesh.eHead;for(mt=Et.next;mt!==Et;mt=gt)gt=mt.next,_t=mt.Lnext,ot.vertEq(mt.Org,mt.Dst)&&mt.Lnext.Lnext!==mt&&(nt.spliceMergeVertices(st,_t,mt),st.mesh.delete(mt),mt=_t,_t=mt.Lnext),_t.Lnext===mt&&(_t!==mt&&((_t===gt||_t===gt.Sym)&&(gt=gt.next),st.mesh.delete(_t)),(mt===gt||mt===gt.Sym)&&(gt=gt.next),st.mesh.delete(mt))},nt.initPriorityQ=function(st){var mt,gt,_t,Et=0;for(_t=st.mesh.vHead,gt=_t.next;gt!==_t;gt=gt.next)Et++;for(Et+=8,mt=st.pq=new E7(Et,ot.vertLeq),_t=st.mesh.vHead,gt=_t.next;gt!==_t;gt=gt.next)gt.pqHandle=mt.insert(gt);return gt!==_t?!1:(mt.init(),!0)},nt.donePriorityQ=function(st){st.pq=null},nt.removeDegenerateFaces=function(st,mt){var gt,_t,Et;for(gt=mt.fHead.next;gt!==mt.fHead;gt=_t)_t=gt.next,Et=gt.anEdge,ut$1(Et.Lnext!==Et),Et.Lnext.Lnext===Et&&(nt.addWinding(Et.Onext,Et),st.mesh.delete(Et));return!0},nt.computeInterior=function(st,mt){mt===void 0&&(mt=!0);var gt,_t;if(nt.removeDegenerateEdges(st),!nt.initPriorityQ(st))return!1;for(nt.initEdgeDict(st);(gt=st.pq.extractMin())!==null;){for(;_t=st.pq.min(),!(_t===null||!ot.vertEq(_t,gt));)_t=st.pq.extractMin(),nt.spliceMergeVertices(st,gt.anEdge,_t.anEdge);nt.sweepEvent(st,gt)}return st.event=st.dict.min().key.eUp.Org,nt.debugEvent(st),nt.doneEdgeDict(st),nt.donePriorityQ(st),nt.removeDegenerateFaces(st,st.mesh)?(mt&&st.mesh.check(),!0):!1},nt}(),C7=function(){function nt(){this.mesh=new uO,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=zt.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return nt.prototype.dot_=function(st,mt){return st[0]*mt[0]+st[1]*mt[1]+st[2]*mt[2]},nt.prototype.normalize_=function(st){var mt=st[0]*st[0]+st[1]*st[1]+st[2]*st[2];if(!mt)throw"Zero-size vector!";mt=Math.sqrt(mt),st[0]/=mt,st[1]/=mt,st[2]/=mt},nt.prototype.longAxis_=function(st){var mt=0;return Math.abs(st[1])>Math.abs(st[0])&&(mt=1),Math.abs(st[2])>Math.abs(st[mt])&&(mt=2),mt},nt.prototype.computeNormal_=function(st){var mt,gt,_t,Et,At,Rt,Ft=[0,0,0],Nt=[0,0,0],Bt=[0,0,0],Gt=[0,0,0],dr=[0,0,0],Mr=[null,null,null],Tr=[null,null,null],zr=this.mesh.vHead;mt=zr.next;for(var Fr=0;Fr<3;++Fr)Et=mt.coords[Fr],Nt[Fr]=Et,Tr[Fr]=mt,Ft[Fr]=Et,Mr[Fr]=mt;for(mt=zr.next;mt!==zr;mt=mt.next)for(var Nr=0;Nr<3;++Nr)Et=mt.coords[Nr],Et<Nt[Nr]&&(Nt[Nr]=Et,Tr[Nr]=mt),Et>Ft[Nr]&&(Ft[Nr]=Et,Mr[Nr]=mt);var tn=0;if(Ft[1]-Nt[1]>Ft[0]-Nt[0]&&(tn=1),Ft[2]-Nt[2]>Ft[tn]-Nt[tn]&&(tn=2),Nt[tn]>=Ft[tn]){st[0]=0,st[1]=0,st[2]=1;return}for(Rt=0,gt=Tr[tn],_t=Mr[tn],Bt[0]=gt.coords[0]-_t.coords[0],Bt[1]=gt.coords[1]-_t.coords[1],Bt[2]=gt.coords[2]-_t.coords[2],mt=zr.next;mt!==zr;mt=mt.next)Gt[0]=mt.coords[0]-_t.coords[0],Gt[1]=mt.coords[1]-_t.coords[1],Gt[2]=mt.coords[2]-_t.coords[2],dr[0]=Bt[1]*Gt[2]-Bt[2]*Gt[1],dr[1]=Bt[2]*Gt[0]-Bt[0]*Gt[2],dr[2]=Bt[0]*Gt[1]-Bt[1]*Gt[0],At=dr[0]*dr[0]+dr[1]*dr[1]+dr[2]*dr[2],At>Rt&&(Rt=At,st[0]=dr[0],st[1]=dr[1],st[2]=dr[2]);Rt<=0&&(st[0]=st[1]=st[2]=0,st[this.longAxis_(Bt)]=1)},nt.prototype.checkOrientation_=function(){for(var st=this.mesh.fHead,mt,gt=this.mesh.vHead,_t,Et=0,At=st.next;At!==st;At=At.next)if(_t=At.anEdge,!(_t.winding<=0))do Et+=(_t.Org.s-_t.Dst.s)*(_t.Org.t+_t.Dst.t),_t=_t.Lnext;while(_t!==At.anEdge);if(Et<0){for(mt=gt.next;mt!==gt;mt=mt.next)mt.t=-mt.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},nt.prototype.projectPolygon_=function(){var st=this.mesh.vHead,mt=[0,0,0],gt,_t,Et=!1;mt[0]=this.normal[0],mt[1]=this.normal[1],mt[2]=this.normal[2],!mt[0]&&!mt[1]&&!mt[2]&&(this.computeNormal_(mt),Et=!0),gt=this.sUnit,_t=this.tUnit;var At=this.longAxis_(mt);gt[At]=0,gt[(At+1)%3]=1,gt[(At+2)%3]=0,_t[At]=0,_t[(At+1)%3]=0,_t[(At+2)%3]=mt[At]>0?1:-1;for(var Rt=st.next;Rt!==st;Rt=Rt.next)Rt.s=this.dot_(Rt.coords,gt),Rt.t=this.dot_(Rt.coords,_t);Et&&this.checkOrientation_();for(var Ft=!0,Nt=st.next;Nt!==st;Nt=Nt.next)Ft?(this.bmin[0]=this.bmax[0]=Nt.s,this.bmin[1]=this.bmax[1]=Nt.t,Ft=!1):(Nt.s<this.bmin[0]&&(this.bmin[0]=Nt.s),Nt.s>this.bmax[0]&&(this.bmax[0]=Nt.s),Nt.t<this.bmin[1]&&(this.bmin[1]=Nt.t),Nt.t>this.bmax[1]&&(this.bmax[1]=Nt.t))},nt.prototype.addWinding_=function(st,mt){st.winding+=mt.winding,st.Sym.winding+=mt.Sym.winding},nt.prototype.tessellateMonoRegion_=function(st,mt){var gt,_t;if(gt=mt.anEdge,!(gt.Lnext!==gt&&gt.Lnext.Lnext!==gt))throw"Mono region invalid";for(;ot.vertLeq(gt.Dst,gt.Org);gt=gt.Lprev);for(;ot.vertLeq(gt.Org,gt.Dst);gt=gt.Lnext);_t=gt.Lprev;for(var Et=void 0;gt.Lnext!==_t;)if(ot.vertLeq(gt.Dst,_t.Org)){for(;_t.Lnext!==gt&&(ot.edgeGoesLeft(_t.Lnext)||ot.edgeSign(_t.Org,_t.Dst,_t.Lnext.Dst)<=0);)Et=st.connect(_t.Lnext,_t),_t=Et.Sym;_t=_t.Lprev}else{for(;_t.Lnext!==gt&&(ot.edgeGoesRight(gt.Lprev)||ot.edgeSign(gt.Dst,gt.Org,gt.Lprev.Org)>=0);)Et=st.connect(gt,gt.Lprev),gt=Et.Sym;gt=gt.Lnext}if(_t.Lnext===gt)throw"Mono region invalid";for(;_t.Lnext.Lnext!==gt;)Et=st.connect(_t.Lnext,_t),_t=Et.Sym;return!0},nt.prototype.tessellateInterior_=function(st){for(var mt,gt=st.fHead.next;gt!==st.fHead;gt=mt)if(mt=gt.next,gt.inside&&!this.tessellateMonoRegion_(st,gt))return!1;return!0},nt.prototype.discardExterior_=function(st){for(var mt,gt=st.fHead.next;gt!==st.fHead;gt=mt)mt=gt.next,gt.inside||st.zapFace(gt)},nt.prototype.setWindingNumber_=function(st,mt,gt){for(var _t,Et=st.eHead.next;Et!==st.eHead;Et=_t)_t=Et.next,Et.Rface.inside!==Et.Lface.inside?Et.winding=Et.Lface.inside?mt:-mt:gt?st.delete(Et):Et.winding=0},nt.prototype.getNeighbourFace_=function(st){return!st.Rface||!st.Rface.inside?-1:st.Rface.n},nt.prototype.outputPolymesh_=function(st,mt,gt,_t){var Et,At=0,Rt=0,Ft;gt>3&&st.mergeConvexFaces(gt);for(var Nt=st.vHead.next;Nt!==st.vHead;Nt=Nt.next)Nt.n=-1;for(var Bt=st.fHead.next;Bt!==st.fHead;Bt=Bt.next)if(Bt.n=-1,!!Bt.inside){Et=Bt.anEdge,Ft=0;do{var Nt=Et.Org;Nt.n===-1&&(Nt.n=Rt,Rt++),Ft++,Et=Et.Lnext}while(Et!==Bt.anEdge);if(Ft>gt)throw"Face vertex greater that support polygon";Bt.n=At,++At}this.elementCount=At,mt===jr.CONNECTED_POLYGONS&&(At*=2),this.elements=[],this.elements.length=At*gt,this.vertexCount=Rt,this.vertices=[],this.vertices.length=Rt*_t,this.vertexIndices=[],this.vertexIndices.length=Rt;for(var Nt=st.vHead.next;Nt!==st.vHead;Nt=Nt.next)if(Nt.n!==-1){var Gt=Nt.n*_t;this.vertices[Gt+0]=Nt.coords[0],this.vertices[Gt+1]=Nt.coords[1],_t>2&&(this.vertices[Gt+2]=Nt.coords[2]),this.vertexIndices[Nt.n]=Nt.idx}for(var dr=0,Bt=st.fHead.next;Bt!==st.fHead;Bt=Bt.next)if(Bt.inside){Et=Bt.anEdge,Ft=0;do{var Nt=Et.Org;this.elements[dr++]=Nt.n,Ft++,Et=Et.Lnext}while(Et!==Bt.anEdge);for(var Mr=Ft;Mr<gt;++Mr)this.elements[dr++]=-1;if(mt===jr.CONNECTED_POLYGONS){Et=Bt.anEdge;do this.elements[dr++]=this.getNeighbourFace_(Et),Et=Et.Lnext;while(Et!==Bt.anEdge);for(var Tr=Ft;Tr<gt;++Tr)this.elements[dr++]=-1}}},nt.prototype.outputContours_=function(st,mt){var gt,_t,Et=0,At=0;this.vertexCount=0,this.elementCount=0;for(var Rt=st.fHead.next;Rt!==st.fHead;Rt=Rt.next)if(Rt.inside){_t=gt=Rt.anEdge;do this.vertexCount++,gt=gt.Lnext;while(gt!==_t);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*mt,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var Ft=0,Nt=0,Bt=0;Et=0;for(var Rt=st.fHead.next;Rt!==st.fHead;Rt=Rt.next)if(Rt.inside){At=0,_t=gt=Rt.anEdge;do this.vertices[Ft++]=gt.Org.coords[0],this.vertices[Ft++]=gt.Org.coords[1],mt>2&&(this.vertices[Ft++]=gt.Org.coords[2]),this.vertexIndices[Nt++]=this.vertexIdCallback?this.vertexIdCallback(gt):gt.Org.idx,At++,gt=gt.Lnext;while(gt!==_t);this.elements[Bt++]=Et,this.elements[Bt++]=At,Et+=At}},nt.prototype.addContour=function(st,mt){this.mesh===null&&(this.mesh=new uO),st<2&&(st=2),st>3&&(st=3);for(var gt=null,_t=0;_t<mt.length;_t+=st)gt===null?(gt=this.mesh.makeEdge(),this.mesh.splice(gt,gt.Sym)):(this.mesh.splitEdge(gt),gt=gt.Lnext),gt.Org.coords[0]=mt[_t+0],gt.Org.coords[1]=mt[_t+1],st>2?gt.Org.coords[2]=mt[_t+2]:gt.Org.coords[2]=0,gt.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(gt),gt.winding=1,gt.Sym.winding=-1},nt.prototype.tesselate=function(st,mt,gt,_t,Et,At){if(st===void 0&&(st=zt.ODD),mt===void 0&&(mt=jr.POLYGONS),At===void 0&&(At=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,Et&&(this.normal[0]=Et[0],this.normal[1]=Et[1],this.normal[2]=Et[2]),this.windingRule=st,_t<2&&(_t=2),_t>3&&(_t=3),!this.mesh)return!1;this.projectPolygon_(),T7.computeInterior(this,At);var Rt=this.mesh;return mt===jr.BOUNDARY_CONTOURS?this.setWindingNumber_(Rt,1,!0):this.tessellateInterior_(Rt),At&&Rt.check(),mt===jr.BOUNDARY_CONTOURS?this.outputContours_(Rt,_t):this.outputPolymesh_(Rt,mt,gt,_t),!0},nt}();function Ws(nt){var st=nt.windingRule,mt=st===void 0?zt.ODD:st,gt=nt.elementType,_t=gt===void 0?jr.POLYGONS:gt,Et=nt.polySize,At=Et===void 0?3:Et,Rt=nt.vertexSize,Ft=Rt===void 0?2:Rt,Nt=nt.normal,Bt=Nt===void 0?[0,0,1]:Nt,Gt=nt.contours,dr=Gt===void 0?[]:Gt,Mr=nt.strict,Tr=Mr===void 0?!0:Mr,zr=nt.debug,Fr=zr===void 0?!1:zr;if(!dr&&Tr)throw new Error("Contours can't be empty");if(dr){var Nr=new C7;nt.edgeCreateCallback&&(Nr.edgeCreateCallback=nt.edgeCreateCallback),nt.vertexIdCallback&&(Nr.vertexIdCallback=nt.vertexIdCallback);for(var tn=0;tn<dr.length;tn++)Nr.addContour(Ft||2,dr[tn]);return Nr.tesselate(mt,_t,At,Ft,Bt,Tr),{vertices:Nr.vertices,vertexIndices:Nr.vertexIndices,vertexCount:Nr.vertexCount,elements:Nr.elements,elementCount:Nr.elementCount,mesh:Fr?Nr.mesh:void 0}}}zt.ODD;zt.NONZERO;zt.POSITIVE;zt.NEGATIVE;zt.ABS_GEQ_TWO;jr.POLYGONS;jr.CONNECTED_POLYGONS;jr.BOUNDARY_CONTOURS;var x0=class{constructor(nt=256,st=!1){this.capacity=nt,this.size=0,this.debug=st,this.debug&&console.log(`allocating with cap ${nt}`);let mt=nt*x0.eSize;this.buffer=new ArrayBuffer(mt);let gt=Float32Array.BYTES_PER_ELEMENT,_t=0;this.positions=new Float32Array(this.buffer,_t*gt,3*nt),_t+=3*nt,this.normals=new Float32Array(this.buffer,_t*gt,3*nt),_t+=3*nt,this.uvs=new Float32Array(this.buffer,_t*gt,2*nt)}realloc(nt,st=!1){if(nt<this.size)throw Error("cannot shrink buffer");if(nt<=this.capacity&&!st)return;this.debug&&console.log(`resizing from ${this.capacity}  ${nt}`);let mt=nt*x0.eSize,gt=new ArrayBuffer(mt),_t=Float32Array.BYTES_PER_ELEMENT,Et=0,At=new Float32Array(gt,Et*_t,3*nt);Et+=3*nt;let Rt=new Float32Array(gt,Et*_t,3*nt);Et+=3*nt;let Ft=new Float32Array(gt,Et*_t,2*nt);st?(At.set(this.positions.subarray(0,this.size*3)),Rt.set(this.normals.subarray(0,this.size*3)),Ft.set(this.uvs.subarray(0,this.size*2))):(At.set(this.positions),Rt.set(this.normals),Ft.set(this.uvs)),this.buffer=gt,this.positions=At,this.normals=Rt,this.uvs=Ft,this.capacity=nt}get(nt=1){let st=this.size+nt;if(st>this.capacity){let gt=this.capacity;for(;st>gt;)gt*=2;this.realloc(gt)}let mt=this.size;return this.size=st,mt}reserve(nt){let st=this.size+nt;st>this.capacity&&this.realloc(st)}shrink(){this.debug&&console.log(`shrinking ${this.capacity}  ${this.size}`),this.realloc(this.size,!0)}},nm=x0;nm.eSize=8*Float32Array.BYTES_PER_ELEMENT;var yO=Jo(gO()),sm={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},MA={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},TA={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},EA=(nt,st)=>([mt,gt])=>(gt<mt&&(gt+=st),(nt>=mt?nt:nt+st)<=gt),Ol=class extends _e$1{constructor(nt,st,mt=0,gt=12,_t=3,Et=zt.ODD,At=!1){super(),this.forPathBevel=At,this.type="ShapeGeometry",this.vertexCache={},this._shape=nt,this._depth=st,this._curveSegments=gt,this._bevelSegmentsInput=_t;let Rt=this._shape.extractShapePointsToFlatArray([],gt),Ft=this._shape.shapeHoles.map(ts=>{let Ko=ts.extractShapePointsToFlatArray([],gt),ds=[];for(let Il=Ko.length-1;Il>=1;Il-=2){let ru=Ko[Il-1],uu=Ko[Il-0];ds.push(ru,uu)}return ds}),Nt=[],Bt=[];for(let ts=0;ts<Rt.length;ts+=2)Bt.push([Rt[ts],Rt[ts+1]]);Nt.push(Bt);for(let ts=0;ts<Ft.length;ts++){let Ko=Ft[ts],ds=[];for(let Il=0;Il<Ko.length;Il+=2)ds.push([Ko[Il],Ko[Il+1]]);Nt.push(ds)}let Gt;nt.isText?Gt=new Ku().setFromPoints(nt.points.map(ts=>ts.position)).getSize(new U$1).length()*.1:Nt[0].length===0?Gt=mt:Gt=(0,yO.default)(Nt).distance,mt<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(mt,Gt,st/2),this._bevelSegments=Math.floor(_t));let dr;try{dr=Ws({windingRule:Et,elementType:jr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[Rt]})}catch{dr=sm}let Mr;try{Mr=Ws({windingRule:zt.ODD,elementType:jr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...Ft]})}catch{Mr=MA}if(!dr)throw new Error("error generating geometry");let Tr=dr.elementCount;if(Mr){dr.elementCount+=Mr.elementCount;for(let ts=0;ts<Mr.elements.length;ts++){let Ko=Mr.elements[ts],ds=ts%2===0?dr.vertexCount:0;dr.elements.push(Ko+ds)}for(let ts=0;ts<Mr.vertexIndices.length;ts++){let Ko=Mr.vertexIndices[ts],ds=dr.vertexCount;dr.vertexIndices.push(Ko+ds)}for(let ts=0;ts<Mr.vertices.length;ts++){let Ko=Mr.vertices[ts];dr.vertices.push(Ko)}}let zr=1/0,Fr=-1/0,Nr=1/0,tn=-1/0;for(let ts=0,Ko=dr.vertexCount;ts<Ko;ts++){let ds=ts*2,Il=dr.vertices[ds+0],ru=dr.vertices[ds+1];Il<zr&&(zr=Il),Il>Fr&&(Fr=Il),ru<Nr&&(Nr=ru),ru>tn&&(tn=ru)}this._minX=zr,this._minY=Nr,this._width=Fr-zr,this._height=tn-Nr,this._buffer=new nm(this._computeBufferEstimatedSize(dr));let rn=[],Tn=[];for(let ts=dr.elementCount-1;ts>=0;ts--){let Ko=ts>=Tr,ds=ts*2,Il=dr.elements[ds+0],ru=dr.elements[ds+1],uu=Il+ru,p0={start:Il,count:ru,normals:[],continuous:[],concave:[]},X1=Il,q0=uu-1,W0=Il+1,hu=this._shape.roundedCurves.length;do{let lu=X1-Il,b0=dr.vertices[q0*2+0],l1=dr.vertices[q0*2+1],LE=dr.vertices[X1*2+0],eS=dr.vertices[X1*2+1],SA=dr.vertices[W0*2+0],o$=dr.vertices[W0*2+1],h$=LE-b0,d$=eS-l1,y$=Math.sqrt(h$*h$+d$*d$);h$/=y$,d$/=y$;let R$=LE-SA,M$=eS-o$,x$=Math.sqrt(R$*R$+M$*M$);R$/=x$,M$/=x$,p0.normals[lu*2+0]=-M$,p0.normals[lu*2+1]=R$,p0.concave[lu]=h$*M$-d$*R$>0;let v$=dr.vertexIndices[X1];if(Array.isArray(v$))p0.continuous[lu]=!1;else{let[rS,wA]=this._shape.getCurveIndexFromVertexId(v$-1,!0);if(wA>0&&wA<1)p0.continuous[lu]=!0;else{let g$=wA===1?rS+1:rS-1;g$=(g$+hu)%hu;let S$=wA===1?0:1,tA=this._shape.roundedCurves[rS].getTangent(wA),tS=this._shape.roundedCurves[g$].getTangent(S$);p0.continuous[lu]=tA.dot(tS)>.95}}Ko&&(p0.normals[lu*2+0]*=-1,p0.normals[lu*2+1]*=-1),[q0,X1,W0]=[X1,W0,W0+1],W0>=uu&&(W0-=ru)}while(W0!==Il+1);let a1=[];a1.push({bevelI:0,angle:0,size:0,boundary:{vertices:dr.vertices.slice(Il*2,uu*2),vertexCount:ru,vertexIndices:new Array(ru).fill(!0).map((lu,b0)=>[b0,b0]),elements:[0,ru],elementCount:1,mesh:null},reverseMap:[],insetPoints:dr.vertices.slice(Il*2,uu*2)});let Vx=0;for(let lu=1;lu<=this._bevelSegments;lu++){let b0=lu/this._bevelSegments*Math.PI/2,l1=(1-Math.cos(b0))*this._bevel,LE=[],eS=[],SA=0;for(let h$=0;h$<ru;h$++){let d$=h$*2,y$=(h$-1+ru)%ru*2,R$=dr.vertices[p0.start*2+d$+0],M$=dr.vertices[p0.start*2+d$+1],x$=-p0.normals[y$+0]*l1,v$=-p0.normals[y$+1]*l1,rS=-p0.normals[d$+0]*l1,wA=-p0.normals[d$+1]*l1;if(p0.concave[h$]||!p0.concave[h$]&&Ko){let g$=Math.atan2(v$,x$),S$=Math.atan2(wA,rS);S$>g$&&(S$-=Math.PI*2);let tA=S$-g$;if(p0.continuous[h$]||Ko){let tS=g$+tA/2,m$=Math.cos(tS)*l1,u$=Math.sin(tS)*l1;LE[2*SA+0]=R$+m$*(Ko?-1:1),LE[2*SA+1]=M$+u$*(Ko?-1:1),eS[SA]=h$,SA++}else{let tS=Math.max(1,Math.floor(gt/4*Math.abs(tA)/Math.PI));for(let m$=0;m$<=tS;m$++){let u$=g$+tA*(m$/tS),UE=Math.cos(u$)*l1,F$=Math.sin(u$)*l1;LE[2*SA+0]=R$+UE,LE[2*SA+1]=M$+F$,eS[SA]=h$,SA++}}}else LE[2*SA+0]=R$+x$,LE[2*SA+1]=M$+v$,eS[SA]=h$,SA++,LE[2*SA+0]=R$,LE[2*SA+1]=M$,eS[SA]=h$,SA++,LE[2*SA+0]=R$+rS,LE[2*SA+1]=M$+wA,eS[SA]=h$,SA++}let o$=Ws({windingRule:zt.POSITIVE,elementType:jr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[LE],edgeCreateCallback:h$=>{let d$=h$.Org.idx,y$=eS[d$],R$=eS[(d$+1)%eS.length];h$.idx=[y$,R$],h$.Sym.idx=[R$,y$]},vertexIdCallback:h$=>{let d$=h$.Lprev.idx;return[d$?d$[1]:0,h$.idx?h$.idx[0]:0]}});if(!o$)throw console.log("Error"),new Error(`error generating bevel geometry for ${lu}'th loop`);if(!o$.vertexCount){let h$=(lu-1)/this._bevelSegments*Math.PI/2;Vx=(1-Math.sin(h$))*this._bevel;break}for(let h$=0;h$<o$.vertexIndices.length;h$++){let[d$,y$]=o$.vertexIndices[h$];if(d$===y$)continue;let R$=y$;y$<d$&&(R$+=ru);for(let M$=d$;M$<R$;M$++){let x$=M$%ru,v$=(M$+1)%ru;if(!p0.continuous[x$]||!p0.continuous[v$]){o$.vertexIndices[h$]=[d$,x$],o$.vertexIndices.splice(h$+1,0,[v$,y$]),o$.vertices.splice((h$+1)*2,0,o$.vertices[h$*2],o$.vertices[h$*2+1]);break}}}a1.push({bevelI:lu,angle:b0,size:l1,boundary:o$,reverseMap:eS,insetPoints:LE})}let t0=(lu,b0,l1)=>{let LE=0,eS=lu.boundary.vertexIndices.length;for(;LE<eS&&l1(lu.boundary.vertexIndices[b0]);)b0=(b0+1)%eS,LE++;return LE},cu=rn.length;for(let lu=1;lu<a1.length;lu++){let b0=a1[lu-1],l1=a1[lu],LE=b0.boundary.vertexIndices.length,eS=l1.boundary.vertexIndices.length;if(!LE||!eS)break;let SA=p0.concave.length,o$=0,h$=EA(o$,ru);for(;!b0.boundary.vertexIndices.filter(h$).length||!l1.boundary.vertexIndices.filter(h$).length;)o$++,h$=EA(o$,ru);let d$=b0.boundary.vertexIndices.findIndex(h$),y$=l1.boundary.vertexIndices.findIndex(h$);do d$=(d$+1)%LE;while(h$(b0.boundary.vertexIndices[d$]));do y$=(y$+1)%eS;while(h$(l1.boundary.vertexIndices[y$]));o$=(o$+1)%ru;let R$=o$,M$=0,x$=this._buildBevelVert(p0,b0,(d$-1+LE)%LE,void 0,M$),v$=this._buildBevelVert(p0,l1,(y$-1+eS)%eS,void 0,M$),rS=x$,wA=v$,g$,S$,tA=!1;do{M$=(o$||SA)/SA,h$=EA(o$,ru);let tS=t0(b0,d$,h$),m$=t0(l1,y$,h$),u$=tA;if(tA=!1,tS&&!m$){for(let UE=0;UE<tS;UE++)g$=this._buildBevelVert(p0,b0,(d$+UE)%LE,UE/(tS-1),M$),rn.push(rS.topN,g$.topP,wA.topN),At===!1&&rn.push(g$.bottomP,rS.bottomN,wA.bottomN),rS=g$;tA=!0}else if(!tS&&m$)for(let UE=0;UE<m$;UE++)S$=this._buildBevelVert(p0,l1,(y$+UE)%eS,UE/(m$-1),M$),rn.push(wA.topN,rS.topP,S$.topP),At===!1&&rn.push(rS.bottomP,wA.bottomN,S$.bottomP),wA=S$;else if(tS&&m$)if(g$=this._buildBevelVert(p0,b0,d$,0,M$),S$=this._buildBevelVert(p0,l1,y$,0,M$),u$?(rn.push(rS.topN,S$.topP,wA.topN),rn.push(rS.topN,g$.topP,S$.topP),At===!1&&(rn.push(S$.bottomP,rS.bottomN,wA.bottomN),rn.push(S$.bottomP,g$.bottomP,rS.bottomN))):(rn.push(wA.topN,rS.topN,g$.topP),rn.push(wA.topN,g$.topP,S$.topP),At===!1&&(rn.push(g$.bottomP,rS.bottomN,wA.bottomN),rn.push(g$.bottomP,wA.bottomN,S$.bottomP))),rS=g$,wA=S$,tS===m$)for(let UE=1;UE<tS;UE++)g$=this._buildBevelVert(p0,b0,(d$+UE)%LE,UE/(tS-1),M$),S$=this._buildBevelVert(p0,l1,(y$+UE)%eS,UE/(m$-1),M$),rn.push(rS.topN,g$.topP,wA.topN),rn.push(wA.topN,g$.topP,S$.topP),At===!1&&(rn.push(g$.bottomP,rS.bottomN,wA.bottomN),rn.push(g$.bottomP,wA.bottomN,S$.bottomP)),rS=g$,wA=S$;else if(tS>m$){let UE=tS/m$,F$=0;for(let EI=1;EI<tS;EI++)g$=this._buildBevelVert(p0,b0,(d$+EI)%LE,EI/(tS-1),M$),rn.push(rS.topN,g$.topP,wA.topN),At===!1&&rn.push(g$.bottomP,rS.bottomN,wA.bottomN),rS=g$,EI>(F$+1)*UE&&(F$++,S$=this._buildBevelVert(p0,l1,(y$+F$)%eS,F$/(m$-1),M$),rn.push(wA.topN,g$.topP,S$.topP),At===!1&&rn.push(g$.bottomP,wA.bottomN,S$.bottomP),wA=S$)}else{let UE=m$/tS,F$=0;for(let EI=1;EI<m$;EI++)S$=this._buildBevelVert(p0,l1,(y$+EI)%eS,EI/(m$-1),M$),rn.push(wA.topN,g$.topP,S$.topP),At===!1&&rn.push(g$.bottomP,wA.bottomN,S$.bottomP),wA=S$,EI>(F$+1)*UE&&(F$++,g$=this._buildBevelVert(p0,b0,(d$+F$)%LE,F$/(tS-1),M$),rn.push(rS.topN,g$.topP,wA.topN),At===!1&&rn.push(g$.bottomP,rS.bottomN,wA.bottomN),rS=g$)}d$=(d$+tS)%LE,y$=(y$+m$)%eS,o$=(o$+1)%SA}while(o$!==R$)}if(At===!1&&this._depth>this._bevel*2&&this._buildWall(a1,p0,rn),Ko){let lu=[];for(let b0=rn.length-1;b0>=cu+2;b0-=3){let l1=rn[b0-2],LE=rn[b0-1],eS=rn[b0-0];lu.push(eS,LE,l1)}rn.splice(cu,rn.length-cu,...lu)}if(Ko){let lu=[];for(let b0=a1[a1.length-1].boundary.vertices.length-1;b0>=1;b0-=2){let l1=a1[a1.length-1].boundary.vertices[b0-1],LE=a1[a1.length-1].boundary.vertices[b0-0];lu.push(l1,LE)}Tn.push(lu)}if(!Ko){let lu=a1[a1.length-1],b0;try{b0=Ws({windingRule:a1.length>1?zt.POSITIVE:zt.ODD,elementType:jr.POLYGONS,vertexSize:2,strict:!0,contours:[lu.insetPoints,...Tn]})}catch{b0=TA}if(!b0)throw new Error("Error generating geometry for surface");Ft.length===0&&this._bevel<Gt&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let l1=0;l1<b0.elementCount*3;l1+=3){let LE=this._buildSurfaceVert(b0,b0.elements[l1+0],Vx),eS=this._buildSurfaceVert(b0,b0.elements[l1+1],Vx),SA=this._buildSurfaceVert(b0,b0.elements[l1+2],Vx);rn.push(LE.top,eS.top,SA.top),At===!1&&rn.push(SA.bottom,eS.bottom,LE.bottom)}}this.vertexCache={}}this._buffer.shrink();let $n=new Xe$1(Uint32Array.from(rn),1),un=new Xe$1(this._buffer.positions,3),es=new Xe$1(this._buffer.normals,3),kn=new Xe$1(this._buffer.uvs,2);un.needsUpdate=!0,es.needsUpdate=!0,kn.needsUpdate=!0,$n.needsUpdate=!0,this.setAttribute("position",un),this.setAttribute("normal",es),this.setAttribute("uv",kn),this.setIndex($n)}_computeBufferEstimatedSize(nt){return nt.vertexCount*2*(2+this._bevelSegments)}_buildWall(nt,st,mt){let gt=nt[0];for(let _t=0,Et=gt.boundary.vertexCount;_t<Et;_t++){let At=this._buildBevelVert(st,gt,_t),Rt=this._buildBevelVert(st,gt,(_t+1)%Et);mt.push(Rt.topP,At.topN,At.bottomN),mt.push(Rt.topP,At.bottomN,Rt.bottomP)}}_buildSurfaceVert(nt,st,mt){let gt=st.toString();if(gt in this.vertexCache)return this.vertexCache[gt];let _t=nt.vertices[st*2+0],Et=nt.vertices[st*2+1],At=(_t-this._minX)/this._width,Rt=(Et-this._minY)/this._height;this.forPathBevel&&(Rt=1);let Ft=this._buffer.get(this.forPathBevel?1:2),Nt=Ft*3,Bt=Ft*2,Gt={top:Ft+0,bottom:Ft+1};return this._buffer.positions[Nt+0]=_t,this._buffer.positions[Nt+1]=Et,this._buffer.positions[Nt+2]=this.forPathBevel?this._bevel:this._depth-mt,this._buffer.normals[Nt+0]=0,this._buffer.normals[Nt+1]=0,this._buffer.normals[Nt+2]=1,this._buffer.uvs[Bt+0]=At,this._buffer.uvs[Bt+1]=Rt,this.forPathBevel===!1&&(this._buffer.positions[Nt+3]=_t,this._buffer.positions[Nt+4]=Et,this._buffer.positions[Nt+5]=mt,this._buffer.normals[Nt+3]=0,this._buffer.normals[Nt+4]=0,this._buffer.normals[Nt+5]=-1,this._buffer.uvs[Bt+2]=At,this._buffer.uvs[Bt+3]=Rt),this.vertexCache[gt]=Gt,Gt}_buildBevelVert(nt,st,mt,gt=1,_t){let Et=`${st.bevelI}:${mt}`;if(Et in this.vertexCache&&_t!==0&&_t!==1&&(!_t||_t===this.vertexCache[Et].pathBevelUCoord))return this.vertexCache[Et];let[At,Rt]=st.boundary.vertexIndices[mt],Ft,Nt,Bt,Gt;At!==Rt?(Nt=At,Ft=Rt,Gt=!1,Bt=nt.continuous[Nt]&&nt.continuous[Ft]):(Ft=At,Nt=(Ft-1+nt.count)%nt.count,Gt=nt.concave[Ft]&&st.bevelI>0,Bt=nt.continuous[Ft]||Gt);let dr=Math.cos(st.angle),Mr=Math.sin(st.angle),Tr=mt*2,zr=Ft*2,Fr=Nt*2,Nr=st.boundary.vertices[Tr+0],tn=st.boundary.vertices[Tr+1],rn=(1-Mr)*this._bevel,Tn=(Nr-this._minX)/this._width,$n=(tn-this._minY)/this._height;this.forPathBevel&&(_t!==void 0&&(Tn=_t),$n=1);let un=nt.normals[zr+0],es=nt.normals[zr+1],kn=nt.normals[Fr+0],ts=nt.normals[Fr+1];if(Gt){let uu=kn-un,p0=ts-es;un=un+uu*(1-gt),es=es+p0*(1-gt);let X1=Math.sqrt(un*un+es*es);un/=X1,es/=X1}let Ko=this.forPathBevel?this._buffer.get(Bt?1:2):this._buffer.get(Bt?2:4),ds=Ko*3,Il=Ko*2,ru={i:mt,fi:Ft,topP:Ko+0,topN:Ko+0,bottomP:Ko+1,bottomN:Ko+1,pathBevelUCoord:_t};return this._buffer.positions[ds+0]=Nr,this._buffer.positions[ds+1]=tn,this._buffer.positions[ds+2]=(this.forPathBevel?this._bevel:this._depth)-rn,this._buffer.normals[ds+0]=un*dr,this._buffer.normals[ds+1]=es*dr,this._buffer.normals[ds+2]=Mr,this._buffer.uvs[Il+0]=Tn,this._buffer.uvs[Il+1]=$n,this.forPathBevel===!1&&(this._buffer.positions[ds+3]=Nr,this._buffer.positions[ds+4]=tn,this._buffer.positions[ds+5]=rn,this._buffer.normals[ds+3]=un*dr,this._buffer.normals[ds+4]=es*dr,this._buffer.normals[ds+5]=-Mr,this._buffer.uvs[Il+2]=$n,this._buffer.uvs[Il+3]=Tn),Bt||(this.forPathBevel?(Ko+=1,ds+=3,Il+=2):(Ko+=2,ds+=6,Il+=4),ru.topP=Ko+0,ru.bottomP=Ko+1,this._buffer.positions[ds+0]=Nr,this._buffer.positions[ds+1]=tn,this._buffer.positions[ds+2]=(this.forPathBevel?this._bevel:this._depth)-rn,this._buffer.normals[ds+0]=kn*dr,this._buffer.normals[ds+1]=ts*dr,this._buffer.normals[ds+2]=Mr,this._buffer.uvs[Il+0]=Tn,this._buffer.uvs[Il+1]=$n,this.forPathBevel===!1&&(this._buffer.positions[ds+3]=Nr,this._buffer.positions[ds+4]=tn,this._buffer.positions[ds+5]=rn,this._buffer.normals[ds+3]=kn*dr,this._buffer.normals[ds+4]=ts*dr,this._buffer.normals[ds+5]=-Mr,this._buffer.uvs[Il+2]=$n,this._buffer.uvs[Il+3]=Tn)),this.vertexCache[Et]=ru,ru}clone(){let nt=new Ol(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return nt.userData=fa(this.userData),nt}},bd=class extends _e$1{constructor(nt,st=12,mt={}){super(),this.type="ShapeGeometry",this.windingRule=zt.ODD,this.elementType=jr.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=nt,this._curveSegments=st,this._triangulationOptions=Object.assign({windingRule:zt.ODD,elementType:jr.POLYGONS,polySize:3,vertexSize:2,strict:!0},mt);let gt=this._shape.extractShapePointsToFlatArray([],this._curveSegments),_t=this._shape.shapeHoles.map(dr=>dr.extractShapePointsToFlatArray([],this._curveSegments)),Et,At=!0,Rt=!0,Ft,Nt;for(let dr=0,Mr=gt.length/2;dr<Mr;dr++){let Tr=dr*2,zr=gt[Tr+0],Fr=gt[Tr+1];if(Ft!==void 0&&zr!==Ft&&(At=!1),Nt!==void 0&&Fr!==Nt&&(Rt=!1),Ft=zr,Nt=Fr,!At&&!Rt)break}if(!At&&!Rt)try{Et=Ws({contours:[gt,..._t],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{Et=sm}let Bt=(Et==null?void 0:Et.vertexCount)??1,Gt=(Et==null?void 0:Et.elementCount)??1;if(this._positionAttribute=new Xe$1(new Float32Array(Bt*3),3),this._normalAttribute=new Xe$1(new Float32Array(Bt*3),3),this._uvAttribute=new Xe$1(new Float32Array(Bt*2),2),this._indexAttribute=new Xe$1(new Uint32Array(Gt*3),1),Et){let dr=1/0,Mr=-1/0,Tr=1/0,zr=-1/0;for(let tn=0,rn=Bt;tn<rn;tn++){let Tn=tn*2,$n=Et.vertices[Tn+0],un=Et.vertices[Tn+1];$n<dr&&(dr=$n),$n>Mr&&(Mr=$n),un<Tr&&(Tr=un),un>zr&&(zr=un)}let Fr=Mr-dr,Nr=zr-Tr;for(let tn=0,rn=Bt;tn<rn;tn++){let Tn=tn*2,$n=Et.vertices[Tn+0],un=Et.vertices[Tn+1],es=($n-dr)/Fr,kn=(un-Tr)/Nr;this._positionAttribute.setXYZ(tn,$n,un,0),this._normalAttribute.setXYZ(tn,0,0,1),this._uvAttribute.setXY(tn,es,kn)}for(let tn=0,rn=Gt;tn<rn;tn++){let Tn=tn*3,$n=Et.elements[Tn+0],un=Et.elements[Tn+1],es=Et.elements[Tn+2];this._indexAttribute.setX(Tn+0,$n),this._indexAttribute.setX(Tn+1,un),this._indexAttribute.setX(Tn+2,es)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((Et==null?void 0:Et.elementCount)??1)*3)}clone(){let nt=new bd(this._shape,this._curveSegments);return nt.userData=fa(this.userData),nt}},Sd=class extends Ol{constructor(nt,st,mt=0,gt=12,_t=3,Et=zt.ODD){super(nt,st,mt,gt,_t,Et),this.type="ShapeGeometry"}_computeBufferEstimatedSize(nt){return nt.vertexCount*2*(2+this._bevelSegments)}_buildWall(nt,st,mt){let gt=nt[0];for(let _t=0,Et=gt.boundary.vertexCount;_t<Et;_t++){let At=this._buildBevelVert(st,gt,_t),Rt=this._buildBevelVert(st,gt,(_t+1)%Et);mt.push(Rt.topP,At.topN,At.bottomN),mt.push(Rt.topP,At.bottomN,Rt.bottomP)}}clone(){let nt=new Sd(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return nt.userData=fa(this.userData),nt}},Rn=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){var Nt,Bt;let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:zt.ODD},nt.parameters),gt=Math.abs(mt.width),_t=Math.abs(mt.height??mt.width),Et=Math.abs(mt.depth??0),At=nt.shape??(st==null?void 0:st.shape),Rt=(At==null?void 0:At.roundness)??mt.roundness;At!==void 0&&(At instanceof qt?(At.width!==gt||At.height!==_t)&&At.applySize(gt,_t):At=new qt(gt,_t).fromJSON(At),((Nt=nt.parameters)==null?void 0:Nt.roundness)!==void 0&&((Bt=nt.parameters)==null?void 0:Bt.roundness)>0&&At.update());let Ft=At??new qt(gt,_t);return{parameters:Object.assign(mt,{width:gt,height:_t,depth:Et,roundness:Rt}),shape:Ft}}static build(nt){let{depth:st,extrudeBevelSize:mt,extrudeBevelSegments:gt,subdivisions:_t,roundness:Et,windingRule:At}=nt.parameters;nt.shape.roundness=Et;let Rt;return st<=0?Rt=new bd(nt.shape,_t,{windingRule:At}):Rt=new Sd(nt.shape,st,mt,_t,gt,At),Object.assign(Rt,{userData:{...nt,type:"VectorGeometry"}})}},xO=Math.PI*2,Ad=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},nt.parameters);return mt.angle=we$1.clamp(mt.angle,0,360),{shape:nt.shape&&nt.shape instanceof qt?nt.shape:new qt,parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??0)})}}static build(nt){let{width:st,height:mt,spikes:gt,angle:_t,innerRadius:Et,depth:At,extrudeBevelSize:Rt,extrudeBevelSegments:Ft}=nt.parameters,Nt=nt.shape,Bt=st*.5,Gt=mt*.5,dr=O7(Nt,Bt,Gt,_t*Math.PI/180,gt,Et);Nt.isClosed=!0,Nt.update();let Mr;return _t===0?(Mr=new _e$1,Mr.setAttribute("position",new Me$1([],3))):Mr=Rn.create({shape:Nt,parameters:{subdivisions:dr,depth:At,extrudeBevelSize:Rt,extrudeBevelSegments:Ft}}),Object.assign(Mr,{userData:{...nt,type:"EllipseGeometry"}})}};function O7(nt,st,mt,gt,_t,Et){if(gt>=xO)return _t>30||_t%4===0?(L7(nt,st,mt,Et),Math.round(_t/4)):vO(nt,gt,_t,st,mt,Et);gt=Math.max(gt,.001);let At={x:0,y:mt},Rt=gt+Math.PI*.5,Ft={x:Math.cos(Rt)*st,y:Math.sin(Rt)*mt},Nt=cO({px:At.x,py:At.y,cx:Ft.x,cy:Ft.y,rx:st,ry:mt,largeArcFlag:gt>Math.PI,sweepFlag:!0});return _t>30||_t%Nt.length===0?R7(nt,At.x,At.y,Nt,_t,st,mt,Et):vO(nt,gt,_t,st,mt,Et)}function R7(nt,st,mt,gt,_t,Et,At,Rt){let Ft=Math.round(_t/gt.length);nt.addPoint(wd(st,mt));for(let Nt=0,Bt=gt.length;Nt<Bt;Nt++){let Gt=gt[Nt],dr=nt.points[Nt],Mr=wd(Gt.x,Gt.y);dr.controls[1].position.set(Gt.x1,Gt.y1),Mr.controls[0].position.set(Gt.x2,Gt.y2),nt.addPoint(Mr)}return Rt>0?bO(nt,Et,At,Rt):nt.addPoint(wd(0,0)),Ft}function vO(nt,st,mt,gt,_t,Et){let At=-st/mt;for(let Rt=0;Rt<=mt;Rt++){let Ft=At*Rt,Nt=Math.sin(Ft)*gt,Bt=Math.cos(Ft)*_t;nt.addPoint(wd(Nt,Bt))}return st<xO?Et>0?bO(nt,gt,_t,Et):nt.addPoint(wd(0,0)):(nt.removePoint(nt.points[nt.points.length-1]),Et>0&&SO(nt,gt,_t,Et)),1}function L7(nt,st,mt,gt=0,_t=0,Et=0){let At=.5522847498,Rt=st*At,Ft=mt*At;nt.addPoint(S0(_t-st,Et,_t-st,Et-Ft,_t-st,Et+Ft)),nt.addPoint(S0(_t,Et+mt,_t-Rt,Et+mt,_t+Rt,Et+mt)),nt.addPoint(S0(_t+st,Et,_t+st,Et+Ft,_t+st,Et-Ft)),nt.addPoint(S0(_t,Et-mt,_t+Rt,Et-mt,_t-Rt,Et-mt)),gt>0&&SO(nt,st,mt,gt)}function wd(nt,st){return new Hs(we$1.generateUUID(),new U$1(nt,st))}function S0(nt,st,mt,gt,_t,Et){let At=wd(nt,st);return At.controls[0].position.set(mt,gt),At.controls[1].position.set(_t,Et),At}function bO(nt,st,mt,gt){wO(nt,st,mt,gt).forEach(_t=>nt.addPoint(_t))}function SO(nt,st,mt,gt){let _t=wO(nt,st,mt,gt),Et=new qt;_t.forEach(At=>Et.addPoint(At)),Et.isClosed=!0,nt.shapeHoles.push(Et)}function wO(nt,st,mt,gt){let _t=gt*st/100,Et=_t*(Math.abs(mt)/Math.abs(st)),At=new U$1(_t/st,Et/mt),Rt=nt.points.map(Ft=>{let Nt=Ft.clone();return Nt.uuid=we$1.generateUUID(),Nt}).reverse();return Rt.forEach(Ft=>{Ft.position.multiply(At);let Nt=Ft.controls[0].position.clone().multiply(At),Bt=Ft.controls[1].position.clone().multiply(At);Ft.controls[0].position.copy(Bt),Ft.controls[1].position.copy(Nt)}),Rt}var AO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},nt.parameters),gt=Math.abs(mt.width),_t=Math.abs(mt.height??gt),Et=Math.abs(mt.depth??gt),At=Math.abs(Math.min(gt,Et))/2;return{parameters:Object.assign(mt,{width:gt,height:_t,depth:Et,radius:At,segments:Math.round(mt.segments),pathSegments:Math.round(mt.pathSegments),cornerSegments:Math.round(mt.cornerSegments)})}}static build(nt){let{width:st,height:mt,depth:gt,radius:_t,revolutions:Et,segments:At,pathRadius:Rt,pathType:Ft,pathSegments:Nt,cornerRadius:Bt,cornerSegments:Gt}=nt.parameters,dr=new om(!1,st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt);return Object.assign(dr,{userData:{...nt,type:"HelixGeometry"}})}},CA=new ho$1([0,0,0],1),om=class extends _e$1{constructor(nt=!0,st=1,mt=1,gt=1,_t=1,Et=1,At=1,Rt=1,Ft=1,Nt=1,Bt=1,Gt=1){if(super(),Et===0)return;let dr=nt&&Et===1;dr&&(Gt=0),Bt>100&&(Bt=100),Bt===0&&(Gt=0);let Mr=()=>new E$6,Tr=new E$6,zr=Mr(),Fr=Mr(),Nr=Mr(),tn,rn,Tn,$n,un,es,kn,ts,Ko=Mr(),ds=Mr(),Il=Mr(),ru=Mr(),uu=Mr(),p0=Mr(),X1=Mr(),q0=Mr(),W0=mt-2*Rt+.001,hu=W0/Et,a1=Math.ceil(At*Et),Vx=a1+1,t0=W0/a1,cu=-W0/2,lu=Nt+1,b0=2*Math.PI/Nt,l1=Math.PI/2/Gt,LE=.01,eS=Math.min((1-Bt/100)*Rt,Rt-LE),SA=Rt-eS,o$=0,h$=2,d$=Gt*h$+h$,y$=lu*d$/h$,R$=y$+lu*Vx,M$=Math.max(0,lu*(Vx+d$)),[x$,v$,rS]=[3,3,2].map(X$=>Array(M$*X$).fill(0)),wA=[],g$=_t-Rt;function S$(X$,J$){let gD=Math.PI/2;es=J$*t0,ts=2*Math.PI*(es%hu)/hu+gD,es+=cu,kn=Math.sin(ts)*g$,un=Math.cos(ts)*g$,nt?X$.set(un,kn,es):X$.set(un,es,kn)}S$(Tr,-1e-10),S$(zr,0),Ko.copy(Tr),S$(Tr,1);let tA=Tr.distanceTo(zr),tS=dr?0:SA+eS,m$=tA*a1+2*tS,u$=eS,UE=m$-tS;for(let X$=0;X$<=a1;X$++){S$(Fr,X$),q0.subVectors(Fr,Ko).normalize(),Ko.copy(Fr),p0.copy(Fr).setComponent(+nt+1,0).normalize(),X1.crossVectors(q0,p0).normalize();let J$=X$===0,gD=X$===a1,fL=J$?3*Math.PI/2:l1,I7=J$?u$:UE,j$=J$?lu:R$,_$=J$?0:M$-lu,I$=q0.clone().multiplyScalar(J$?-SA:SA).add(Fr),GL=q0.clone().multiplyScalar(J$?-1:1).normalize();for(let w$=0;w$<lu;w$++){let B$=w$*b0;if(ds.addVectors(Tr.copy(p0).multiplyScalar(Rt*Math.cos(B$)),zr.copy(X1).multiplyScalar(Rt*Math.sin(B$))),Il.copy(ds).normalize(),J$||gD){dr||(o$=_$+w$,[0,1,2].forEach(r$=>{x$[o$*3+r$]=I$.getComponent(r$),v$[o$*3+r$]=GL.getComponent(r$)}),rS[o$*2]=+gD,rS[o$*2+1]=w$/Nt),zr.copy(Il).multiplyScalar(eS),Nr.addVectors(Fr,zr);for(let r$=0;r$<Gt;r$++){let O$=r$*l1+fL;ru.addVectors(Tr.copy(q0).multiplyScalar(SA*Math.sin(O$)),zr.copy(Il).multiplyScalar(SA*Math.cos(O$))),uu.copy(ru).normalize(),zr.addVectors(Nr,ru),ru.normalize(),o$=j$+r$*lu+w$,[0,1,2].forEach(mL=>{x$[o$*3+mL]=zr.getComponent(mL),v$[o$*3+mL]=uu.getComponent(mL)});let Z$=+J$+Math.sin(O$);rS[o$*2]=(I7+SA*Z$)/m$,rS[o$*2+1]=w$/Nt}}zr.addVectors(Fr,ds),o$=y$+X$*lu+w$,[0,1,2].forEach(r$=>{x$[o$*3+r$]=zr.getComponent(r$),v$[o$*3+r$]=Il.getComponent(r$)}),rS[o$*2]=(tS+X$*tA)/m$,rS[o$*2+1]=w$/Nt}}let F$=Vx+2*Gt+h$,[EI,pR]=[+dr,F$-1];for(let X$=EI;X$<=pR-1;X$++){let J$=dr&&X$===pR-1;for(let gD=0;gD<lu-1;gD++)tn=X$*lu+gD,rn=tn+1,Tn=(J$?gD:tn)+lu,$n=(J$?gD+1:rn)+lu,X$===0?wA.push(rn,$n,Tn):X$===F$-2?wA.push(tn,rn,Tn):wA.push(tn,rn,Tn,rn,$n,Tn)}this.setIndex(wA),this.setAttribute("position",new Me$1(x$,3)),this.setAttribute("normal",new Me$1(v$,3)),this.setAttribute("uv",new Me$1(rS,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let nt=this.userData.parameters,st=Math.ceil(nt.tubularSegments),mt=nt.radialSegments+1,gt=Array.from(this.getIndex().array),_t,Et,At,Rt,Ft=6*(st-1)*nt.radialSegments,Nt=st,Bt=Nt===st;for(let Gt=0;Gt<nt.radialSegments;Gt++)_t=Nt*mt+Gt,Et=_t+1,At=(Bt?Gt:_t)+mt,Rt=(Bt?Gt+1:Et)+mt,gt[Ft++]=_t,gt[Ft++]=Et,gt[Ft++]=At,gt[Ft++]=Et,gt[Ft++]=Rt,gt[Ft++]=At;return gt.length=Ft,CA.array=gt,CA.count=gt.length,CA}},EO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,detail:0,corner:0,cornerSides:4},nt.parameters);return{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??mt.width)})}}static build(nt){let{width:st,height:mt,depth:gt,detail:_t,corner:Et,cornerSides:At}=nt.parameters,Rt=_t===0&&Et!==0?new am(st*.5,Et,At):new zu(st*.5,_t);return Rt.scale(1,mt/st,gt/st),Object.assign(Rt,{userData:{...nt,type:"IcosahedronGeometry"}})}},am=class extends _l{constructor(nt=1,st=.2,mt=4){let gt=(1+Math.sqrt(5))/2,_t=[-1,gt,0,1,gt,0,-1,-gt,0,1,-gt,0,0,-1,gt,0,1,gt,0,-1,-gt,0,1,-gt,gt,0,-1,gt,0,1,-gt,0,-1,-gt,0,1],Et=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],At="IcosahedronGeometry";super(_t,Et,At,nt,st,mt),this.type=At}static fromJSON(nt){return new am(nt.radius,nt.corner,nt.cornerSides)}},MO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){var gt;(((gt=nt.parameters)==null?void 0:gt.points)??[]).forEach(_t=>{Array.isArray(_t)&&(_t.x=_t[0],_t.y=_t[1])});let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},nt.parameters);return{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??mt.width)})}}static build(nt){let{points:st,segments:mt,verticalSegments:gt}=nt.parameters,_t=new aa;_t.moveTo(st[0].x,st[0].y),_t.bezierCurveTo(st[1].x,st[1].y,st[2].x,st[2].y,st[3].x,st[3].y);let Et=new Nu(_t.extractPoints(gt).shape,mt);return Et.rotateZ(Math.PI),Object.assign(Et,{userData:{...nt,type:"LatheGeometry"}})}},Io$1=new ue$1,PA=new Mt,w0=new E$6,Rl=class extends pr{constructor(){super(),this.uuid=we$1.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(nt){let st=new fr().getNormalMatrix(nt);for(let mt=0,gt=this.vertices.length;mt<gt;mt++)this.vertices[mt].applyMatrix4(nt);for(let mt=0,gt=this.faces.length;mt<gt;mt++){let _t=this.faces[mt];_t.normal.applyMatrix3(st).normalize();for(let Et=0,At=_t.vertexNormals.length;Et<At;Et++)_t.vertexNormals[Et].applyMatrix3(st).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(nt){return Io$1.makeRotationX(nt),this.applyMatrix4(Io$1),this}rotateY(nt){return Io$1.makeRotationY(nt),this.applyMatrix4(Io$1),this}rotateZ(nt){return Io$1.makeRotationZ(nt),this.applyMatrix4(Io$1),this}translate(nt,st,mt){return Io$1.makeTranslation(nt,st,mt),this.applyMatrix4(Io$1),this}scale(nt,st,mt){return Io$1.makeScale(nt,st,mt),this.applyMatrix4(Io$1),this}lookAt(nt){return PA.lookAt(nt),PA.updateMatrix(),this.applyMatrix4(PA.matrix),this}fromBufferGeometry(nt){let st=this,mt=nt.index!==null?nt.index:void 0,gt=nt.attributes;if(gt.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let _t=gt.position,Et=gt.normal,At=gt.color,Rt=gt.uv,Ft=gt.uv2;Ft!==void 0&&(this.faceVertexUvs[1]=[]);for(let Gt=0;Gt<_t.count;Gt++)st.vertices.push(new E$6().fromBufferAttribute(_t,Gt)),At!==void 0&&st.colors.push(new We$1().fromBufferAttribute(At,Gt));function Nt(Gt,dr,Mr,Tr){let zr=At===void 0?[]:[st.colors[Gt].clone(),st.colors[dr].clone(),st.colors[Mr].clone()],Fr=Et===void 0?[]:[new E$6().fromBufferAttribute(Et,Gt),new E$6().fromBufferAttribute(Et,dr),new E$6().fromBufferAttribute(Et,Mr)],Nr=new Ed(Gt,dr,Mr,Fr,zr,Tr);st.faces.push(Nr),Rt!==void 0&&st.faceVertexUvs[0].push([new U$1().fromBufferAttribute(Rt,Gt),new U$1().fromBufferAttribute(Rt,dr),new U$1().fromBufferAttribute(Rt,Mr)]),Ft!==void 0&&st.faceVertexUvs[1].push([new U$1().fromBufferAttribute(Ft,Gt),new U$1().fromBufferAttribute(Ft,dr),new U$1().fromBufferAttribute(Ft,Mr)])}let Bt=nt.groups;if(Bt.length>0)for(let Gt=0;Gt<Bt.length;Gt++){let dr=Bt[Gt],Mr=dr.start,Tr=dr.count;for(let zr=Mr,Fr=Mr+Tr;zr<Fr;zr+=3)mt!==void 0?Nt(mt.getX(zr),mt.getX(zr+1),mt.getX(zr+2),dr.materialIndex):Nt(zr,zr+1,zr+2,dr.materialIndex)}else if(mt!==void 0)for(let Gt=0;Gt<mt.count;Gt+=3)Nt(mt.getX(Gt),mt.getX(Gt+1),mt.getX(Gt+2));else for(let Gt=0;Gt<_t.count;Gt+=3)Nt(Gt,Gt+1,Gt+2);return this.computeFaceNormals(),nt.boundingBox!==null&&(this.boundingBox=nt.boundingBox.clone()),nt.boundingSphere!==null&&(this.boundingSphere=nt.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(w0).negate(),this.translate(w0.x,w0.y,w0.z),this}normalize(){this.computeBoundingSphere();let nt=this.boundingSphere.center,st=this.boundingSphere.radius,mt=st===0?1:1/st,gt=new ue$1;return gt.set(mt,0,0,-mt*nt.x,0,mt,0,-mt*nt.y,0,0,mt,-mt*nt.z,0,0,0,1),this.applyMatrix4(gt),this}computeFaceNormals(){let nt=new E$6,st=new E$6;for(let mt=0,gt=this.faces.length;mt<gt;mt++){let _t=this.faces[mt],Et=this.vertices[_t.a],At=this.vertices[_t.b],Rt=this.vertices[_t.c];nt.subVectors(Rt,At),st.subVectors(Et,At),nt.cross(st),nt.normalize(),_t.normal.copy(nt)}}computeVertexNormals(nt=!0){let st=new Array(this.vertices.length);for(let mt=0,gt=this.vertices.length;mt<gt;mt++)st[mt]=new E$6;if(nt){let mt=new E$6,gt=new E$6;for(let _t=0,Et=this.faces.length;_t<Et;_t++){let At=this.faces[_t],Rt=this.vertices[At.a],Ft=this.vertices[At.b],Nt=this.vertices[At.c];mt.subVectors(Nt,Ft),gt.subVectors(Rt,Ft),mt.cross(gt),st[At.a].add(mt),st[At.b].add(mt),st[At.c].add(mt)}}else{this.computeFaceNormals();for(let mt=0,gt=this.faces.length;mt<gt;mt++){let _t=this.faces[mt];st[_t.a].add(_t.normal),st[_t.b].add(_t.normal),st[_t.c].add(_t.normal)}}for(let mt=0,gt=this.vertices.length;mt<gt;mt++)st[mt].normalize();for(let mt=0,gt=this.faces.length;mt<gt;mt++){let _t=this.faces[mt],Et=_t.vertexNormals;Et.length===3?(Et[0].copy(st[_t.a]),Et[1].copy(st[_t.b]),Et[2].copy(st[_t.c])):(Et[0]=st[_t.a].clone(),Et[1]=st[_t.b].clone(),Et[2]=st[_t.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let nt=0,st=this.faces.length;nt<st;nt++){let mt=this.faces[nt],gt=mt.vertexNormals;gt.length===3?(gt[0].copy(mt.normal),gt[1].copy(mt.normal),gt[2].copy(mt.normal)):(gt[0]=mt.normal.clone(),gt[1]=mt.normal.clone(),gt[2]=mt.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let st=0,mt=this.faces.length;st<mt;st++){let gt=this.faces[st];gt.__originalFaceNormal?gt.__originalFaceNormal.copy(gt.normal):gt.__originalFaceNormal=gt.normal.clone(),gt.__originalVertexNormals||(gt.__originalVertexNormals=[]);for(let _t=0,Et=gt.vertexNormals.length;_t<Et;_t++)gt.__originalVertexNormals[_t]?gt.__originalVertexNormals[_t].copy(gt.vertexNormals[_t]):gt.__originalVertexNormals[_t]=gt.vertexNormals[_t].clone()}let nt=new Rl;nt.faces=this.faces;for(let st=0,mt=this.morphTargets.length;st<mt;st++){if(!this.morphNormals[st]){this.morphNormals[st]={},this.morphNormals[st].faceNormals=[],this.morphNormals[st].vertexNormals=[];let _t=this.morphNormals[st].faceNormals,Et=this.morphNormals[st].vertexNormals;for(let At=0,Rt=this.faces.length;At<Rt;At++){let Ft=new E$6,Nt={a:new E$6,b:new E$6,c:new E$6};_t.push(Ft),Et.push(Nt)}}let gt=this.morphNormals[st];nt.vertices=this.morphTargets[st].vertices,nt.computeFaceNormals(),nt.computeVertexNormals();for(let _t=0,Et=this.faces.length;_t<Et;_t++){let At=this.faces[_t],Rt=gt.faceNormals[_t],Ft=gt.vertexNormals[_t];Rt.copy(At.normal),Ft.a.copy(At.vertexNormals[0]),Ft.b.copy(At.vertexNormals[1]),Ft.c.copy(At.vertexNormals[2])}}for(let st=0,mt=this.faces.length;st<mt;st++){let gt=this.faces[st];gt.normal=gt.__originalFaceNormal,gt.vertexNormals=gt.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new jt),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Or),this.boundingSphere.setFromPoints(this.vertices)}merge(nt,st,mt=0){if(!(nt&&nt.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",nt);return}let gt,_t=this.vertices.length,Et=this.vertices,At=nt.vertices,Rt=this.faces,Ft=nt.faces,Nt=this.colors,Bt=nt.colors;st!==void 0&&(gt=new fr().getNormalMatrix(st));for(let Gt=0,dr=At.length;Gt<dr;Gt++){let Mr=At[Gt].clone();st!==void 0&&Mr.applyMatrix4(st),Et.push(Mr)}for(let Gt=0,dr=Bt.length;Gt<dr;Gt++)Nt.push(Bt[Gt].clone());for(let Gt=0,dr=Ft.length;Gt<dr;Gt++){let Mr=Ft[Gt],Tr,zr,Fr=Mr.vertexNormals,Nr=Mr.vertexColors,tn=new Ed(Mr.a+_t,Mr.b+_t,Mr.c+_t);tn.normal.copy(Mr.normal),gt!==void 0&&tn.normal.applyMatrix3(gt).normalize();for(let rn=0,Tn=Fr.length;rn<Tn;rn++)Tr=Fr[rn].clone(),gt!==void 0&&Tr.applyMatrix3(gt).normalize(),tn.vertexNormals.push(Tr);tn.color.copy(Mr.color);for(let rn=0,Tn=Nr.length;rn<Tn;rn++)zr=Nr[rn],tn.vertexColors.push(zr.clone());tn.materialIndex=Mr.materialIndex+mt,Rt.push(tn)}for(let Gt=0,dr=nt.faceVertexUvs.length;Gt<dr;Gt++){let Mr=nt.faceVertexUvs[Gt];this.faceVertexUvs[Gt]===void 0&&(this.faceVertexUvs[Gt]=[]);for(let Tr=0,zr=Mr.length;Tr<zr;Tr++){let Fr=Mr[Tr],Nr=[];for(let tn=0,rn=Fr.length;tn<rn;tn++)Nr.push(Fr[tn].clone());this.faceVertexUvs[Gt].push(Nr)}}}mergeMesh(nt){if(!(nt&&nt.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",nt);return}nt.matrixAutoUpdate&&nt.updateMatrix(),this.merge(nt.geometry,nt.matrix)}mergeVertices(nt=4){let st={},mt=[],gt=[],_t=Math.pow(10,nt);for(let Rt=0,Ft=this.vertices.length;Rt<Ft;Rt++){let Nt=this.vertices[Rt],Bt=Math.round(Nt.x*_t)+"_"+Math.round(Nt.y*_t)+"_"+Math.round(Nt.z*_t);st[Bt]===void 0?(st[Bt]=Rt,mt.push(this.vertices[Rt]),gt[Rt]=mt.length-1):gt[Rt]=gt[st[Bt]]}let Et=[];for(let Rt=0,Ft=this.faces.length;Rt<Ft;Rt++){let Nt=this.faces[Rt];Nt.a=gt[Nt.a],Nt.b=gt[Nt.b],Nt.c=gt[Nt.c];let Bt=[Nt.a,Nt.b,Nt.c];for(let Gt=0;Gt<3;Gt++)if(Bt[Gt]===Bt[(Gt+1)%3]){Et.push(Rt);break}}for(let Rt=Et.length-1;Rt>=0;Rt--){let Ft=Et[Rt];this.faces.splice(Ft,1);for(let Nt=0,Bt=this.faceVertexUvs.length;Nt<Bt;Nt++)this.faceVertexUvs[Nt].splice(Ft,1)}let At=this.vertices.length-mt.length;return this.vertices=mt,At}setFromPoints(nt){this.vertices=[];for(let st=0,mt=nt.length;st<mt;st++){let gt=nt[st];this.vertices.push(new E$6(gt.x,gt.y,gt.z||0))}return this}sortFacesByMaterialIndex(){let nt=this.faces,st=nt.length;for(let Rt=0;Rt<st;Rt++)nt[Rt]._id=Rt;function mt(Rt,Ft){return Rt.materialIndex-Ft.materialIndex}nt.sort(mt);let gt=this.faceVertexUvs[0],_t=this.faceVertexUvs[1],Et,At;gt&&gt.length===st&&(Et=[]),_t&&_t.length===st&&(At=[]);for(let Rt=0;Rt<st;Rt++){let Ft=nt[Rt]._id;Et&&Et.push(gt[Ft]),At&&At.push(_t[Ft])}Et&&(this.faceVertexUvs[0]=Et),At&&(this.faceVertexUvs[1]=At)}toJSON(){let nt={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(nt.uuid=this.uuid,nt.type=this.type,this.name!==""&&(nt.name=this.name),this.parameters!==void 0){let Mr=this.parameters;for(let Tr in Mr)Mr[Tr]!==void 0&&(nt[Tr]=Mr[Tr]);return nt}let st=[];for(let Mr=0;Mr<this.vertices.length;Mr++){let Tr=this.vertices[Mr];st.push(Tr.x,Tr.y,Tr.z)}let mt=[],gt=[],_t={},Et=[],At={},Rt=[],Ft={};for(let Mr=0;Mr<this.faces.length;Mr++){let Tr=this.faces[Mr],zr=!0,Fr=!1,Nr=this.faceVertexUvs[0][Mr]!==void 0,tn=Tr.normal.length()>0,rn=Tr.vertexNormals.length>0,Tn=Tr.color.r!==1||Tr.color.g!==1||Tr.color.b!==1,$n=Tr.vertexColors.length>0,un=0;if(un=Nt(un,0,0),un=Nt(un,1,zr),un=Nt(un,2,Fr),un=Nt(un,3,Nr),un=Nt(un,4,tn),un=Nt(un,5,rn),un=Nt(un,6,Tn),un=Nt(un,7,$n),mt.push(un),mt.push(Tr.a,Tr.b,Tr.c),mt.push(Tr.materialIndex),Nr){let es=this.faceVertexUvs[0][Mr];mt.push(dr(es[0]),dr(es[1]),dr(es[2]))}if(tn&&mt.push(Bt(Tr.normal)),rn){let es=Tr.vertexNormals;mt.push(Bt(es[0]),Bt(es[1]),Bt(es[2]))}if(Tn&&mt.push(Gt(Tr.color)),$n){let es=Tr.vertexColors;mt.push(Gt(es[0]),Gt(es[1]),Gt(es[2]))}}function Nt(Mr,Tr,zr){return zr?Mr|1<<Tr:Mr&~(1<<Tr)}function Bt(Mr){let Tr=Mr.x.toString()+Mr.y.toString()+Mr.z.toString();return _t[Tr]!==void 0||(_t[Tr]=gt.length/3,gt.push(Mr.x,Mr.y,Mr.z)),_t[Tr]}function Gt(Mr){let Tr=Mr.r.toString()+Mr.g.toString()+Mr.b.toString();return At[Tr]!==void 0||(At[Tr]=Et.length,Et.push(Mr.getHex())),At[Tr]}function dr(Mr){let Tr=Mr.x.toString()+Mr.y.toString();return Ft[Tr]!==void 0||(Ft[Tr]=Rt.length/2,Rt.push(Mr.x,Mr.y)),Ft[Tr]}return nt.data={},nt.data.vertices=st,nt.data.normals=gt,Et.length>0&&(nt.data.colors=Et),Rt.length>0&&(nt.data.uvs=[Rt]),nt.data.faces=mt,nt}clone(){return new Rl().copy(this)}copy(nt){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=nt.name;let st=nt.vertices;for(let Gt=0,dr=st.length;Gt<dr;Gt++)this.vertices.push(st[Gt].clone());let mt=nt.colors;for(let Gt=0,dr=mt.length;Gt<dr;Gt++)this.colors.push(mt[Gt].clone());let gt=nt.faces;for(let Gt=0,dr=gt.length;Gt<dr;Gt++)this.faces.push(gt[Gt].clone());for(let Gt=0,dr=nt.faceVertexUvs.length;Gt<dr;Gt++){let Mr=nt.faceVertexUvs[Gt];this.faceVertexUvs[Gt]===void 0&&(this.faceVertexUvs[Gt]=[]);for(let Tr=0,zr=Mr.length;Tr<zr;Tr++){let Fr=Mr[Tr],Nr=[];for(let tn=0,rn=Fr.length;tn<rn;tn++){let Tn=Fr[tn];Nr.push(Tn.clone())}this.faceVertexUvs[Gt].push(Nr)}}let _t=nt.morphTargets;for(let Gt=0,dr=_t.length;Gt<dr;Gt++){let Mr={};if(Mr.name=_t[Gt].name,_t[Gt].vertices!==void 0){Mr.vertices=[];for(let Tr=0,zr=_t[Gt].vertices.length;Tr<zr;Tr++)Mr.vertices.push(_t[Gt].vertices[Tr].clone())}if(_t[Gt].normals!==void 0){Mr.normals=[];for(let Tr=0,zr=_t[Gt].normals.length;Tr<zr;Tr++)Mr.normals.push(_t[Gt].normals[Tr].clone())}this.morphTargets.push(Mr)}let Et=nt.morphNormals;for(let Gt=0,dr=Et.length;Gt<dr;Gt++){let Mr={};if(Et[Gt].vertexNormals!==void 0){Mr.vertexNormals=[];for(let Tr=0,zr=Et[Gt].vertexNormals.length;Tr<zr;Tr++){let Fr=Et[Gt].vertexNormals[Tr],Nr={};Nr.a=Fr.a.clone(),Nr.b=Fr.b.clone(),Nr.c=Fr.c.clone(),Mr.vertexNormals.push(Nr)}}if(Et[Gt].faceNormals!==void 0){Mr.faceNormals=[];for(let Tr=0,zr=Et[Gt].faceNormals.length;Tr<zr;Tr++)Mr.faceNormals.push(Et[Gt].faceNormals[Tr].clone())}this.morphNormals.push(Mr)}let At=nt.skinWeights;for(let Gt=0,dr=At.length;Gt<dr;Gt++)this.skinWeights.push(At[Gt].clone());let Rt=nt.skinIndices;for(let Gt=0,dr=Rt.length;Gt<dr;Gt++)this.skinIndices.push(Rt[Gt].clone());let Ft=nt.lineDistances;for(let Gt=0,dr=Ft.length;Gt<dr;Gt++)this.lineDistances.push(Ft[Gt]);let Nt=nt.boundingBox;Nt!==null&&(this.boundingBox=Nt.clone());let Bt=nt.boundingSphere;return Bt!==null&&(this.boundingSphere=Bt.clone()),this.elementsNeedUpdate=nt.elementsNeedUpdate,this.verticesNeedUpdate=nt.verticesNeedUpdate,this.uvsNeedUpdate=nt.uvsNeedUpdate,this.normalsNeedUpdate=nt.normalsNeedUpdate,this.colorsNeedUpdate=nt.colorsNeedUpdate,this.lineDistancesNeedUpdate=nt.lineDistancesNeedUpdate,this.groupsNeedUpdate=nt.groupsNeedUpdate,this}toBufferGeometry(){let nt=new _A().fromGeometry(this),st=new _e$1,mt=new Float32Array(nt.vertices.length*3);if(st.setAttribute("position",A0.call(new Xe$1(mt,3),nt.vertices)),nt.normals.length>0){let gt=new Float32Array(nt.normals.length*3);st.setAttribute("normal",A0.call(new Xe$1(gt,3),nt.normals))}if(nt.colors.length>0){let gt=new Float32Array(nt.colors.length*3);st.setAttribute("color",TO.call(new Xe$1(gt,3),nt.colors))}if(nt.uvs.length>0){let gt=new Float32Array(nt.uvs.length*2);st.setAttribute("uv",CO.call(new Xe$1(gt,2),nt.uvs))}if(nt.uvs2.length>0){let gt=new Float32Array(nt.uvs2.length*2);st.setAttribute("uv2",CO.call(new Xe$1(gt,2),nt.uvs2))}st.groups=nt.groups;for(let gt in nt.morphTargets){let _t=[],Et=nt.morphTargets[gt];for(let At=0,Rt=Et.length;At<Rt;At++){let Ft=Et[At],Nt=new Me$1(Ft.data.length*3,3);Nt.name=Ft.name,_t.push(A0.call(Nt,Ft.data))}st.morphAttributes[gt]=_t}if(nt.skinIndices.length>0){let gt=new Me$1(nt.skinIndices.length*4,4);st.setAttribute("skinIndex",PO.call(gt,nt.skinIndices))}if(nt.skinWeights.length>0){let gt=new Me$1(nt.skinWeights.length*4,4);st.setAttribute("skinWeight",PO.call(gt,nt.skinWeights))}return nt.boundingSphere!==null&&(st.boundingSphere=nt.boundingSphere.clone()),nt.boundingBox!==null&&(st.boundingBox=nt.boundingBox.clone()),st}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(nt){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(nt)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(nt){let st=new _e$1,mt=nt.geometry;if(nt.isPoints||nt.isLine){let gt=new Me$1(mt.vertices.length*3,3),_t=new Me$1(mt.colors.length*3,3);if(st.setAttribute("position",A0.call(gt,mt.vertices)),st.setAttribute("color",TO.call(_t,mt.colors)),mt.lineDistances&&mt.lineDistances.length===mt.vertices.length){let Et=new Me$1(mt.lineDistances.length,1);st.setAttribute("lineDistance",B7.call(Et,mt.lineDistances))}mt.boundingSphere!==null&&(st.boundingSphere=mt.boundingSphere.clone()),mt.boundingBox!==null&&(st.boundingBox=mt.boundingBox.clone())}else nt.isMesh&&(st=mt.toBufferGeometry());return st}};Rl.prototype.isGeometry=!0;var _A=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(nt){let st=[],mt,gt,_t,Et=nt.faces;for(gt=0;gt<Et.length;gt++){let At=Et[gt];At.materialIndex!==_t&&(_t=At.materialIndex,mt!==void 0&&(mt.count=gt*3-mt.start,st.push(mt)),mt={start:gt*3,materialIndex:_t})}mt!==void 0&&(mt.count=gt*3-mt.start,st.push(mt)),this.groups=st}fromGeometry(nt){let st=nt.faces,mt=nt.vertices,gt=nt.faceVertexUvs,_t=gt[0]&&gt[0].length>0,Et=gt[1]&&gt[1].length>0,At=nt.morphTargets,Rt=At.length,Ft;if(Rt>0){Ft=[];for(let Fr=0;Fr<Rt;Fr++)Ft[Fr]={name:At[Fr].name,data:[]};this.morphTargets.position=Ft}let Nt=nt.morphNormals,Bt=Nt.length,Gt;if(Bt>0){Gt=[];for(let Fr=0;Fr<Bt;Fr++)Gt[Fr]={name:Nt[Fr].name,data:[]};this.morphTargets.normal=Gt}let dr=nt.skinIndices,Mr=nt.skinWeights,Tr=dr.length===mt.length,zr=Mr.length===mt.length;mt.length>0&&st.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let Fr=0;Fr<st.length;Fr++){let Nr=st[Fr];this.vertices.push(mt[Nr.a],mt[Nr.b],mt[Nr.c]);let tn=Nr.vertexNormals;if(tn.length===3)this.normals.push(tn[0],tn[1],tn[2]);else{let Tn=Nr.normal;this.normals.push(Tn,Tn,Tn)}let rn=Nr.vertexColors;if(rn.length===3)this.colors.push(rn[0],rn[1],rn[2]);else{let Tn=Nr.color;this.colors.push(Tn,Tn,Tn)}if(_t===!0){let Tn=gt[0][Fr];Tn!==void 0?this.uvs.push(Tn[0],Tn[1],Tn[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",Fr),this.uvs.push(new U$1,new U$1,new U$1))}if(Et===!0){let Tn=gt[1][Fr];Tn!==void 0?this.uvs2.push(Tn[0],Tn[1],Tn[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",Fr),this.uvs2.push(new U$1,new U$1,new U$1))}for(let Tn=0;Tn<Rt;Tn++){let $n=At[Tn].vertices;Ft[Tn].data.push($n[Nr.a],$n[Nr.b],$n[Nr.c])}for(let Tn=0;Tn<Bt;Tn++){let $n=Nt[Tn].vertexNormals[Fr];Gt[Tn].data.push($n.a,$n.b,$n.c)}Tr&&this.skinIndices.push(dr[Nr.a],dr[Nr.b],dr[Nr.c]),zr&&this.skinWeights.push(Mr[Nr.a],Mr[Nr.b],Mr[Nr.c])}return this.computeGroups(nt),this.verticesNeedUpdate=nt.verticesNeedUpdate,this.normalsNeedUpdate=nt.normalsNeedUpdate,this.colorsNeedUpdate=nt.colorsNeedUpdate,this.uvsNeedUpdate=nt.uvsNeedUpdate,this.groupsNeedUpdate=nt.groupsNeedUpdate,nt.boundingSphere!==null&&(this.boundingSphere=nt.boundingSphere.clone()),nt.boundingBox!==null&&(this.boundingBox=nt.boundingBox.clone()),this}},Ed=class{constructor(nt,st,mt,gt,_t,Et=0){this.a=nt,this.b=st,this.c=mt,this.normal=gt&&gt.isVector3?gt:new E$6,this.vertexNormals=Array.isArray(gt)?gt:[],this.color=_t&&_t.isColor?_t:new We$1,this.vertexColors=Array.isArray(_t)?_t:[],this.materialIndex=Et}clone(){return new this.constructor().copy(this)}copy(nt){this.a=nt.a,this.b=nt.b,this.c=nt.c,this.normal.copy(nt.normal),this.color.copy(nt.color),this.materialIndex=nt.materialIndex;for(let st=0,mt=nt.vertexNormals.length;st<mt;st++)this.vertexNormals[st]=nt.vertexNormals[st].clone();for(let st=0,mt=nt.vertexColors.length;st<mt;st++)this.vertexColors[st]=nt.vertexColors[st].clone();return this}};function B7(nt){return this.array.set(nt),this}function TO(nt){let st=this.array,mt=0;for(let gt=0,_t=nt.length;gt<_t;gt++){let Et=nt[gt];Et===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",gt),Et=new We$1),st[mt++]=Et.r,st[mt++]=Et.g,st[mt++]=Et.b}return this}function CO(nt){let st=this.array,mt=0;for(let gt=0,_t=nt.length;gt<_t;gt++){let Et=nt[gt];Et===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",gt),Et=new U$1),st[mt++]=Et.x,st[mt++]=Et.y}return this}function A0(nt){let st=this.array,mt=0;for(let gt=0,_t=nt.length;gt<_t;gt++){let Et=nt[gt];Et===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",gt),Et=new E$6),st[mt++]=Et.x,st[mt++]=Et.y,st[mt++]=Et.z}return this}function PO(nt){let st=this.array,mt=0;for(let gt=0,_t=nt.length;gt<_t;gt++){let Et=nt[gt];Et===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",gt),Et=new Ze$1),st[mt++]=Et.x,st[mt++]=Et.y,st[mt++]=Et.z,st[mt++]=Et.w}return this}var N7=["a","b","c"];function F7(nt,st){switch(st){case"c":return nt.c;case"b":return nt.b;case"a":default:return nt.a}}function DA(nt,st,mt){let gt=Math.min(nt,st),_t=Math.max(nt,st),Et=gt+"_"+_t;return mt.get(Et)}function IA(nt,st,mt,gt,_t,Et){let At=Math.min(nt,st),Rt=Math.max(nt,st),Ft=At+"_"+Rt,Nt;if(gt.has(Ft))Nt=gt.get(Ft);else{let Bt=mt[At],Gt=mt[Rt];Nt={a:Bt,b:Gt,newEdge:null,faces:[]},gt.set(Ft,Nt)}Nt.faces.push(_t),Et[nt].edges.push(Nt),Et[st].edges.push(Nt)}function V7(nt,st,mt,gt){let _t,Et,At;for(_t=0,Et=nt.length;_t<Et;_t++)mt[_t]={edges:[]};for(_t=0,Et=st.length;_t<Et;_t++)At=st[_t],IA(At.a,At.b,nt,gt,At,mt),IA(At.b,At.c,nt,gt,At,mt),IA(At.c,At.a,nt,gt,At,mt)}function E0(nt,st,mt,gt,_t){nt.push(new Ed(st,mt,gt,void 0,void 0,_t))}function Md(nt,st){return Math.abs(st-nt)/2+Math.min(nt,st)}function M0(nt,st,mt,gt){nt.push([st.clone(),mt.clone(),gt.clone()])}var T0=class{constructor(nt=1){this.subdivisions=nt}modify(nt){nt instanceof _e$1?nt=new Rl().fromBufferGeometry(nt):nt=nt.clone(),nt.mergeVertices();let st=this.subdivisions;for(;st-- >0;)this._smooth(nt);return nt.computeFaceNormals(),nt.computeVertexNormals(),nt}_smooth(nt){let st=new E$6,mt,gt,_t,Et,At,Rt=nt.vertices,Ft=nt.faces,Nt=nt.faceVertexUvs[0],Bt=Nt!==void 0&&Nt.length>0,Gt=[],dr=new Map;V7(Rt,Ft,Gt,dr);let Mr=[],Tr,zr,Fr,Nr,tn,rn,Tn;for(let LE of Array.from(dr.keys())){for(zr=dr.get(LE),Fr=new E$6,tn=3/8,rn=1/8,Tn=zr.faces.length,Tn!=2&&(tn=.5,rn=0,Tn!=1),Fr.addVectors(zr.a,zr.b).multiplyScalar(tn),st.set(0,0,0),Et=0;Et<Tn;Et++){for(Nr=zr.faces[Et],At=0;At<3&&(Tr=Rt[F7(Nr,N7[At])],!(Tr!==zr.a&&Tr!==zr.b));At++);Tr&&st.add(Tr)}st.multiplyScalar(rn),Fr.add(st),zr.newEdge=Mr.length,Mr.push(Fr)}let $n,un,es,kn,ts,Ko,ds,Il=[];for(gt=0,_t=Rt.length;gt<_t;gt++){for(Ko=Rt[gt],ts=Gt[gt].edges,mt=ts.length,mt==3?$n=3/16:mt>3&&($n=3/(8*mt)),un=1-mt*Number($n),es=$n,mt<=2&&(mt==2?(un=3/4,es=1/8):mt==1||mt==0),ds=Ko.clone().multiplyScalar(un),st.set(0,0,0),Et=0;Et<mt;Et++)kn=ts[Et],Tr=kn.a!==Ko?kn.a:kn.b,st.add(Tr);st.multiplyScalar(Number(es)),ds.add(st),Il.push(ds)}let ru=Il.concat(Mr),uu=Il.length,p0,X1,q0,W0=[],hu=[],a1,Vx,t0,cu,lu=new U$1,b0=new U$1,l1=new U$1;for(gt=0,_t=Ft.length;gt<_t;gt++)Nr=Ft[gt],p0=Number(DA(Nr.a,Nr.b,dr).newEdge)+uu,X1=Number(DA(Nr.b,Nr.c,dr).newEdge)+uu,q0=Number(DA(Nr.c,Nr.a,dr).newEdge)+uu,E0(W0,p0,X1,q0,Nr.materialIndex),E0(W0,Nr.a,p0,q0,Nr.materialIndex),E0(W0,Nr.b,X1,p0,Nr.materialIndex),E0(W0,Nr.c,q0,X1,Nr.materialIndex),Bt&&(a1=Nt[gt],Vx=a1[0],t0=a1[1],cu=a1[2],lu.set(Md(Vx.x,t0.x),Md(Vx.y,t0.y)),b0.set(Md(t0.x,cu.x),Md(t0.y,cu.y)),l1.set(Md(Vx.x,cu.x),Md(Vx.y,cu.y)),M0(hu,lu,b0,l1),M0(hu,Vx,lu,l1),M0(hu,t0,b0,lu),M0(hu,cu,l1,b0));nt.vertices=ru,nt.faces=W0,Bt&&(nt.faceVertexUvs[0]=hu)}},Pi=new E$6,_O=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=nt.geometry??(st==null?void 0:st.geometry)??new _e$1().copy(new mi(100,100,100)),gt;st===void 0?(mt.computeBoundingBox(),mt.boundingBox.getSize(Pi),gt={width:Pi.x,height:Pi.y,depth:Pi.z,subdivisions:0}):gt=st.parameters;let _t={...gt,...nt.parameters};return{parameters:{width:Math.abs(_t.width),height:Math.abs(_t.height),depth:Math.abs(_t.depth),subdivisions:Math.abs(_t.subdivisions)},geometry:mt}}static build(nt){let{width:st,height:mt,depth:gt,subdivisions:_t}=nt.parameters,Et=nt.geometry??new _e$1().copy(new mi(100,100,100)),At=Et.userData.parameters;At===void 0?(Et.computeBoundingBox(),Et.boundingBox.getSize(Pi)):Pi.set(At.width,At.height,At.depth),(st!==Pi.x||mt!==Pi.y||gt!==Pi.z)&&Et.scale(Pi.x===0?1:st/Pi.x,Pi.y===0?1:mt/Pi.y,Pi.z===0?1:gt/Pi.z);let Rt=Et.originalGeometry;try{_t>0?(Rt===void 0||(At==null?void 0:At.subdivisions)!==_t)&&(Rt===void 0&&(Rt=Et),Et=new T0(_t).modify(Rt).toBufferGeometry()):(Rt!==void 0&&(Et=Rt),Rt=void 0,Et.getAttribute("normal")===void 0&&Et.computeVertexNormals())}catch{Rt!==void 0&&(Et=Rt),Rt=void 0,Et.getAttribute("normal")===void 0&&Et.computeVertexNormals()}return Rt!==void 0&&Object.assign(Et,{originalGeometry:Rt}),delete nt.geometry,Object.assign(Et,{userData:{...nt,type:"NonParametricGeometry"}})}static loadFromUrl(nt,st,mt){new Xu(mt).load(nt,gt=>{let _t=this.normalizeInputs({geometry:gt});gt.boundingBox.getSize(Pi);let Et=100/Pi.x;Object.assign(_t.parameters,{width:100,height:Pi.y*Et,depth:Pi.z*Et}),st(this.build(_t))})}},C0=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},nt.parameters);return{shape:nt.shape&&nt.shape instanceof qt?nt.shape:new qt,parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??0)})}}static build(nt){let{width:st,height:mt,spikes:gt,cornerRadius:_t,depth:Et,extrudeBevelSize:At,extrudeBevelSegments:Rt}=nt.parameters,Ft=nt.shape,Nt=st*.5,Bt=mt*.5,Gt=0,dr=0,Mr=2*Math.PI/gt;for(let zr=0;zr<gt;zr++){let Fr=Mr*zr,Nr=Gt+Math.sin(Fr)*Nt,tn=dr+Math.cos(Fr)*Bt;Ft.addPoint(Ft.createPoint(Nr,tn))}Ft.isClosed=!0;for(let zr=0,Fr=Ft.points.length;zr<Fr;zr++)Ft.points[zr].roundness=_t;Ft.roundness=_t,Ft.update();let Tr=Rn.create({shape:Ft,parameters:{roundness:_t,depth:Et,extrudeBevelSize:At,extrudeBevelSegments:Rt}});return Object.assign(Tr,{userData:{...nt,type:"PolygonGeometry"}})}},DO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},nt.parameters);return{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??mt.width)})}}static build(nt){let{width:st,height:mt,depth:gt,radialSegments:_t,heightSegments:Et,openEnded:At,cornerRadius:Rt,cornerSegments:Ft}=nt.parameters,Nt=new RA(st*.5,mt,_t,Et,At,Rt,Ft);return Nt.scale(1,1,gt/st),Object.assign(Nt,{userData:{...nt,type:"PyramidGeometry"}})}};function lm(nt,st,mt){mt.x=nt.x*st.x,mt.y=nt.y,mt.z=nt.x*st.y}function OA(nt,st,mt,gt,_t,Et){let At=st.clone().sub(nt),Rt=mt.clone().sub(nt),Ft=At.angleTo(Rt);if(At.normalize(),Rt.normalize(),gt===_t){let Nt=At.add(Rt).normalize();Et.copy(nt).addScaledVector(Nt,gt/Math.sin(Ft/2))}else{let Nt=At.angleTo(Rt);Et.copy(nt),Et.addScaledVector(At,_t/Math.sin(Nt)),Et.addScaledVector(Rt,gt/Math.sin(Nt))}}function U7(nt,st,mt){let gt=nt.clone().sub(st),_t=mt.clone().sub(st);return gt.projectOnVector(_t),gt.add(st)}var RA=class extends _e$1{constructor(nt=.5,st=1,mt=4,gt=1,_t=!1,Et=0,At=4){super(),mt=Math.floor(Math.max(3,mt)),gt=Math.floor(gt),At=Math.floor(At);let Rt=[],Ft=[],Nt=[],Bt=[],Gt=0,dr=st/2,Mr=Math.PI/mt,Tr=nt*Math.cos(Math.PI/mt),zr=2*Math.PI/mt,Fr=(mt-2)*Math.PI/mt,Nr=Math.PI-Fr,tn=new E$6(0,-dr,0),rn=new E$6(0,dr,0),Tn=new U$1(nt,-dr),$n=new U$1(Tr,-dr),un=new U$1(0,rn.y).sub($n),es=new U$1(0,rn.y).sub(Tn),kn=new U$1(un.y,-un.x).normalize(),ts=new U$1(es.y,-es.x).normalize(),Ko=nt*Math.cos(Math.PI/mt)*Math.tan((Math.PI-un.angle())/2)-1e-8;Et=Math.min(Et,Ko);let ds;{let q0=new E$6(kn.x,kn.y,0),W0=new E$6(Math.cos(zr)*q0.x,q0.y,Math.sin(zr)*q0.x);ds=q0.angleTo(W0)}let Il=Et/Math.tan((Math.PI-un.angle())/2),ru=Et/Math.tan((Math.PI-ds)/2),uu=new E$6;if(!_t){Ft.push(tn.x,tn.y,tn.z),Nt.push(0,-1,0),Bt.push(0,0);let q0=Gt++,W0=[],hu=Tn.clone(),a1=Il/Math.cos(Math.PI/mt);hu.x-=a1;for(let Vx=0;Vx<mt;Vx++){let t0=Vx/mt*Math.PI*2+Mr,cu=new U$1(Math.sin(t0),Math.cos(t0));lm(hu,cu,uu),Ft.push(uu.x,uu.y,uu.z),Nt.push(0,-1,0),Bt.push(0,0),W0.push(Gt++)}for(let Vx=0;Vx<W0.length;Vx++)Rt.push(W0[Vx],q0,W0[(Vx+1)%W0.length])}{let q0=new E$6,W0=new E$6,hu=new E$6,a1=new E$6,Vx=new E$6,t0=new E$6;for(let cu=0;cu<mt;cu++){let lu=cu/mt*Math.PI*2+Mr,b0=(cu+.5)/mt*Math.PI*2+Mr,l1=(cu+1)/mt*Math.PI*2+Mr,LE=new U$1(Math.sin(lu),Math.cos(lu)),eS=new U$1(Math.sin(b0),Math.cos(b0)),SA=new U$1(Math.sin(l1),Math.cos(l1));lm(Tn,LE,W0),lm(Tn,SA,hu),lm(kn,eS,q0),OA(rn,W0,hu,ru,ru,a1),Ft.push(a1.x,a1.y,a1.z),OA(W0,rn,hu,ru,Il,Vx),Ft.push(Vx.x,Vx.y,Vx.z),OA(hu,W0,rn,Il,ru,t0),Ft.push(t0.x,t0.y,t0.z),Nt.push(q0.x,q0.y,q0.z),Nt.push(q0.x,q0.y,q0.z),Nt.push(q0.x,q0.y,q0.z),Bt.push(0,0),Bt.push(0,0),Bt.push(0,0);let o$=Gt++,h$=Gt++,d$=Gt++;if(Rt.push(o$,h$,d$),Et>0){{let M$=W0.clone().add(hu).multiplyScalar(.5),x$=rn.clone().sub(M$).normalize(),v$=tn.clone().sub(M$).normalize().add(x$).normalize().multiplyScalar(-1),rS=t0.clone().sub(Vx);p0(M$,rS,v$,un.angle())}let y$,R$;{let M$=new E$6;lm(ts,SA,M$);let x$=t0.clone().add(a1).multiplyScalar(.5);x$=U7(x$,hu,rn);let v$=t0.clone().sub(a1);[y$,R$]=p0(x$,v$,M$,ds,a1.y)}{let M$=y$,x$=M$.clone().setY(0).normalize(),v$=new E$6(0,-1,0),rS=x$.clone().cross(v$);X1(M$,x$,v$,rS)}{let M$=un.angle(),x$=Math.PI-M$,v$=rn.clone();v$.y-=Et/Math.sin(M$-Math.PI/2);let rS=new E$6,wA=[];for(let S$=0;S$<At;S$++){let tA=[],tS=Math.PI/2-x$*S$/At,m$=Math.cos(tS),u$=Math.sin(tS),UE=b0;for(let F$=0;F$<=S$;F$++){let EI=Math.cos(UE),pR=Math.sin(UE);q0.x=m$*pR,q0.y=u$,q0.z=m$*EI,rS.copy(v$).addScaledVector(q0,Et),Ft.push(rS.x,rS.y,rS.z),Nt.push(q0.x,q0.y,q0.z),Bt.push(0,0),tA.push(Gt++),UE+=Math.PI*2/S$/mt}wA.push(tA)}R$.reverse(),wA.push(R$);let g$=wA.length-1;for(let S$=0;S$<g$;S$++){let tA=wA[S$],tS=wA[S$+1],m$=tA.length-1;Rt.push(tS[1],tA[0],tS[0]);for(let u$=1;u$<=m$;u$++)Rt.push(tA[u$],tA[u$-1],tS[u$]),Rt.push(tS[u$+1],tA[u$],tS[u$])}}}}}this.setIndex(Rt),this.setAttribute("position",new Me$1(Ft,3)),this.setAttribute("normal",new Me$1(Nt,3)),this.setAttribute("uv",new Me$1(Bt,2));function p0(q0,W0,hu,a1,Vx){let t0=-a1/2,cu=(Math.PI-a1)/2,lu=W0.clone().normalize().cross(hu);q0.addScaledVector(hu,-Et/Math.sin(cu));let b0=new E$6,l1=new E$6,LE=1,eS=Gt,SA=[];for(let o$=0;o$<=At;o$++){let h$=t0+o$/At*a1;l1.set(0,0,0),l1.addScaledVector(lu,Math.sin(h$)),l1.addScaledVector(hu,Math.cos(h$));for(let d$=0;d$<=LE;d$++){let y$=d$/LE-.5;if(b0.copy(q0),b0.addScaledVector(W0,y$),b0.addScaledVector(l1,Et),Vx!=null){let R$=Math.max(0,b0.y-Vx);b0.addScaledVector(W0,-R$/W0.y)}Ft.push(b0.x,b0.y,b0.z),Nt.push(l1.x,l1.y,l1.z),Bt.push(0,0),d$===0&&SA.push(Gt),Gt++}}for(let o$=0;o$<At;o$++)for(let h$=0;h$<LE;h$++){let d$=eS+h$+(LE+1)*o$,y$=d$+(LE+1),R$=y$+1,M$=d$+1;Rt.push(d$,y$,M$),Rt.push(y$,R$,M$)}return[q0.clone().addScaledVector(W0,.5),SA]}function X1(q0,W0,hu,a1){let Vx=Math.PI/2,t0=es.angle()-Vx,cu=[],lu=new E$6,b0=new E$6;for(let LE=0;LE<=At;LE++){let eS=[],SA=LE/At;for(let o$=0;o$<=LE;o$++){let h$=((LE?o$/LE:0)-.5)*Nr,d$=Math.cos(h$),y$=Math.sin(h$),R$=Math.atan(Math.tan(t0)*d$),M$=(Vx+R$)*SA,x$=Math.cos(M$),v$=Math.sin(M$);lu.set(0,0,0),lu.addScaledVector(W0,v$*d$),lu.addScaledVector(hu,x$),lu.addScaledVector(a1,v$*y$),b0.copy(q0).addScaledVector(lu,Et),Ft.push(b0.x,b0.y,b0.z),Nt.push(lu.x,lu.y,lu.z),Bt.push(0,0),eS.push(Gt++)}cu.push(eS)}let l1=cu.length-1;for(let LE=0;LE<l1;LE++){let eS=cu[LE],SA=cu[LE+1],o$=eS.length-1;Rt.push(eS[0],SA[1],SA[0]);for(let h$=1;h$<=o$;h$++)Rt.push(eS[h$-1],eS[h$],SA[h$]),Rt.push(eS[h$],SA[h$+1],SA[h$])}}}},Td=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},nt.parameters),gt=Object.assign((st==null?void 0:st.ui)??{enabledIndieCorners:!1},nt.ui);return{shape:nt.shape&&nt.shape instanceof qt?nt.shape:new qt,parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??0)}),ui:gt}}static build(nt){let st=nt.shape,{width:mt,height:gt,cornerRadius:_t,cornerType:Et,depth:At,extrudeBevelSize:Rt,extrudeBevelSegments:Ft}=nt.parameters,Nt={x:mt*.5,y:gt*.5},Bt={x:-Nt.x,y:-Nt.y},Gt={x:Nt.x,y:Nt.y};function dr(Tn,$n,un){return $n>mt&&un>gt?Math.min(Tn*mt/$n,Tn*gt/un):$n>mt?Tn*mt/$n:un>gt?Tn*gt/un:Tn}let Mr=[];Mr[0]=_t[0]===0?0:dr(_t[0],_t[0]+_t[3],_t[0]+_t[1]),Mr[1]=_t[1]===0?0:dr(_t[1],_t[1]+_t[2],_t[1]+_t[0]),Mr[2]=_t[2]===0?0:dr(_t[2],_t[2]+_t[1],_t[2]+_t[3]),Mr[3]=_t[3]===0?0:dr(_t[3],_t[3]+_t[0],_t[3]+_t[2]);let Tr=Bt.x,zr=Gt.x,Fr=Gt.y,Nr=Bt.y;st.addPoint(st.createPoint(Tr,Fr)),st.addPoint(st.createPoint(zr,Fr)),st.addPoint(st.createPoint(zr,Nr)),st.addPoint(st.createPoint(Tr,Nr)),st.isClosed=!0;let tn=!0;for(let Tn=0,$n=st.points.length;Tn<$n;Tn++)st.points[Tn].roundness=Mr[Tn],Tn>0&&Mr[Tn]!==Mr[Tn-1]&&(tn=!1);tn&&(st.roundness=Mr[0]),st.useCubicForRoundedCorners=Et!==1,st.update();let rn=Rn.create({shape:st,parameters:{depth:At,extrudeBevelSize:Rt,extrudeBevelSegments:Ft}});return Object.assign(rn,{userData:{...nt,type:"RectangleGeometry"}})}},IO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},nt.parameters);return mt.thetaLength=we$1.clamp(mt.thetaLength,0,180),{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??mt.width)})}}static build(nt){let{width:st=100,height:mt=st,depth:gt=st,widthSegments:_t=64,heightSegments:Et=64,phiStart:At,phiLength:Rt,thetaStart:Ft,thetaLength:Nt}=nt.parameters,Bt;return Nt===0?(Bt=new _e$1,Bt.setAttribute("position",new Me$1([],3))):Bt=new Ls(.5*st,_t,Et,At,Rt,Ft,Nt*we$1.DEG2RAD),Bt.scale(1,mt/st,gt/st),Object.assign(Bt,{userData:{...nt,type:"SphereGeometry"}})}},OO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},nt.parameters);return{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:0})}}static build(nt){let{width:st=100,height:mt=st,widthSegments:gt=8,heightSegments:_t=8}=nt.parameters,Et=new Li(st,mt,gt,_t);return Et.scale(1,1,1),Object.assign(Et,{userData:{...nt,type:"PlaneGeometry"}})}},RO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},nt.parameters);return{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??mt.width)})}}static build(nt){let{width:st,height:mt,depth:gt,angle:_t,cornerRadius:Et,cornerSegments:At}=nt.parameters,Rt=new LA(st,mt,gt,_t,Et,At);return Object.assign(Rt,{userData:{...nt,type:"BackdropGeometry"}})}},LA=class extends _e$1{constructor(nt=1,st=1,mt=1,gt=90,_t=10,Et=24){super(),this.type="BackdropGeometry";let At=[],Rt=[],Ft=[],Nt=.001;_t==0&&(Et=1),Et=Math.max(1,Math.floor(Et)),_t=Math.min(_t,100),gt=Math.min(180-Nt,gt),gt*=Math.PI/180;let Bt=[],Gt=Math.PI/2,dr=(LE=0,eS=0,SA=0)=>new E$6(LE,eS,SA),Mr=dr(),Tr=dr(),[zr,Fr,Nr]=[st/2,nt/2,mt/2],tn=-Fr,rn=+Fr,[Tn,$n,un]=[dr(tn,-zr,+Nr),dr(tn,-zr,-Nr),dr(tn,+zr,-Nr)],es=(LE,eS=!1)=>Math.sin(LE-Math.PI/(1+ +eS)),kn=(LE,eS=!1)=>Math.cos(LE-Math.PI/(1+ +eS));un.y=Math.sin(gt)*st-zr;let ts=Math.cos(gt)*st-Nr,Ko=Tn.z-Nt;gt<=Gt?(un.z=Math.min(ts,Ko),un.z==Ko&&(un.y-=(ts-Ko)/Math.tan(Gt-gt))):$n.z=Math.min($n.z-ts-Nr,Tn.z-Nt),Mr.subVectors(Tn,$n),Tr.subVectors(un,$n);let ds=Math.min(Mr.length(),Tr.length())*_t/100,Il=ds*Math.tan(gt/2),ru=ds/Math.cos(gt/2),uu=Mr.clone().normalize().add(Tr.normalize()).setLength(ru).add($n);Mr.set(0,es(gt,!0),kn(gt,!0)),Bt.push([un,Mr.clone()]);let p0=(Math.PI-gt)/Et;for(let LE=0;LE<=Et;LE++){let eS=Gt+gt+LE*p0;Mr.set(0,Math.sin(eS)*Il,Math.cos(eS)*Il),Mr.add(uu),Tr.set(0,es(eS),kn(eS)),Bt.push([Mr.clone(),Tr.clone()])}Bt.push([Tn,dr(0,1,0)]);let X1=Math.sin(p0/2)*Il*2,q0=Bt.length-1,W0=Bt[0][0].distanceTo(Bt[1][0]),hu=Bt[q0-1][0].distanceTo(Bt[q0][0]),a1=W0+X1*Et+hu;Bt[0].push(1);for(let LE=0;LE<=Et;LE++)Bt[LE+1].push(1-(W0+LE*X1)/a1);Bt[q0].push(0);let[Vx,t0,cu]=Bt[0],lu,b0,l1;for(let LE=1;LE<Bt.length;LE++)[lu,b0,l1]=Bt[LE],At.push(tn,Vx.y,Vx.z,tn,lu.y,lu.z,rn,Vx.y,Vx.z,rn,Vx.y,Vx.z,tn,lu.y,lu.z,rn,lu.y,lu.z),Rt.push(0,t0.y,t0.z,0,b0.y,b0.z,0,t0.y,t0.z,0,t0.y,t0.z,0,b0.y,b0.z,0,b0.y,b0.z),Ft.push(0,cu,0,l1,1,cu,1,cu,0,l1,1,l1),[Vx,t0,cu]=[lu,b0,l1];this.setAttribute("position",new Me$1(At,3)),this.setAttribute("normal",new Me$1(Rt,3)),this.setAttribute("uv",new Me$1(Ft,2))}},P0=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},nt.parameters);return{shape:nt.shape&&nt.shape instanceof qt?nt.shape:new qt,parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??0)})}}static build(nt){let{width:st,height:mt,innerRadiusPercent:gt,spikes:_t,cornerRadius:Et,angle:At,depth:Rt,extrudeBevelSize:Ft,extrudeBevelSegments:Nt}=nt.parameters,Bt=nt.shape,Gt=st*.5,dr=mt*.5,Mr=0,Tr=0,zr=At*Math.PI/360/_t,Fr=Math.PI/2*3*-1,Nr=Gt*gt/100,tn=dr*gt/100;if(_t===3&&gt===50){zr=2*Math.PI/_t;for(let Tn=0;Tn<_t;Tn++){let $n=zr*Tn,un=Mr+Math.sin($n)*Gt,es=Tr+Math.cos($n)*dr;Bt.addPoint(Bt.createPoint(un,es))}}else for(let Tn=0;Tn<_t;Tn++){let $n=Mr+Math.cos(Fr)*Gt,un=Tr+Math.sin(Fr)*dr;Bt.addPoint(Bt.createPoint($n,un)),Fr+=zr,$n=Mr+Math.cos(Fr)*Nr,un=Tr+Math.sin(Fr)*tn,Bt.addPoint(Bt.createPoint($n,un)),Fr+=zr}Bt.isClosed=!0;for(let Tn=0,$n=Bt.points.length;Tn<$n;Tn++)Bt.points[Tn].roundness=Et;Bt.roundness=Et,Bt.update();let rn=Rn.create({shape:Bt,parameters:{roundness:Et,depth:Rt,extrudeBevelSize:Ft,extrudeBevelSegments:Nt}});return Object.assign(rn,{userData:{...nt,type:"StarGeometry"}})}},LO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,depth:0},nt.parameters);return{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??0)})}}static build(nt){let{width:st,height:mt}=nt.parameters,gt=new Li(st,mt);return Object.assign(gt,{userData:{...nt,type:"TextFrameGeometry"}})}},BO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},nt.parameters),gt=Math.abs(mt.width),_t=Math.abs(mt.height??mt.width),Et=Math.round(Math.abs(mt.depth??mt.width*.25));return{parameters:Object.assign(mt,{width:gt,height:_t,depth:Et})}}static build(nt){let{width:st,height:mt,depth:gt,radialSegments:_t,tubularSegments:Et,arc:At,cornerRadius:Rt,cornerSegments:Ft}=nt.parameters,Nt=z7(st,mt,gt,st*.5,At,Et,0,0,_t,Rt,Ft);return Nt.scale(1,mt/st,1),Object.assign(Nt,{userData:{...nt,type:"TorusGeometry"}})}};function z7(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt){[st,mt]=[mt,st],At=st/2;let Gt=we$1.clamp(_t/360,0,1);if(Gt===0){let dr=new _e$1;return dr.setAttribute("position",new Me$1([],3)),dr}return Gt===1&&(Nt=0),new om(!0,nt,st,mt,gt,Gt,Et,At,Rt,Ft,Nt,Bt)}var NO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},nt.parameters);return{parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width),depth:Math.abs(mt.depth??mt.width),tube:mt.tube??mt.width*.125})}}static build(nt){let{width:st,tube:mt,tubularSegments:gt,radialSegments:_t,p:Et,q:At}=nt.parameters,Rt=st*.5;Rt!==mt&&(Rt-=mt);let Ft=new Gu(Rt,mt,gt,_t,Et,At);return Object.assign(Ft,{userData:{...nt,type:"TorusKnotGeometry"}})}},FO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},nt.parameters);return{shape:nt.shape&&nt.shape instanceof qt?nt.shape:new qt,parameters:Object.assign(mt,{width:Math.abs(mt.width),height:Math.abs(mt.height??mt.width*(mt.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(mt.depth??0)})}}static build(nt){let{width:st=100,height:mt,cornerRadius:gt,depth:_t,extrudeBevelSize:Et,extrudeBevelSegments:At,isRect:Rt}=nt.parameters,Ft=nt.shape,Nt=st*.5,Bt=mt*.5;Rt?(Ft.addPoint(Ft.createPoint(-Nt,Bt)),Ft.addPoint(Ft.createPoint(Nt,-Bt)),Ft.addPoint(Ft.createPoint(-Nt,-Bt))):(Ft.addPoint(Ft.createPoint(0,Bt)),Ft.addPoint(Ft.createPoint(Nt,-Bt)),Ft.addPoint(Ft.createPoint(-Nt,-Bt))),Ft.isClosed=!0;for(let dr=0,Mr=Ft.points.length;dr<Mr;dr++)Ft.points[dr].roundness=gt;Ft.roundness=gt,Ft.update();let Gt=Rn.create({shape:Ft,parameters:{roundness:gt,depth:_t,extrudeBevelSize:Et,extrudeBevelSegments:At}});return Object.assign(Gt,{userData:{...nt,type:"TriangleGeometry"}})}};function VO(nt,st){let mt=2*Math.PI;return(nt%mt+mt)%mt===(st%mt+mt)%mt}var BA=class{add(nt,st,mt){if(typeof arguments[0]!="string")for(let gt in arguments[0])this.add(gt,arguments[0][gt],arguments[1]);else(Array.isArray(nt)?nt:[nt]).forEach(function(gt){this[gt]=this[gt]||[],st&&this[gt][mt?"unshift":"push"](st)},this)}run(nt,st){this[nt]=this[nt]||[],this[nt].forEach(function(mt){mt.call(st&&st.context?st.context:st,st)})}},NA=class{constructor(nt){this.jsep=nt,this.registered={}}register(...nt){nt.forEach(st=>{if(typeof st!="object"||!st.name||!st.init)throw new Error("Invalid JSEP plugin format");this.registered[st.name]||(st.init(this.jsep),this.registered[st.name]=st)})}},fe$1=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+fe$1.version}static addUnaryOp(st){return fe$1.max_unop_len=Math.max(st.length,fe$1.max_unop_len),fe$1.unary_ops[st]=1,fe$1}static addBinaryOp(st,mt,gt){return fe$1.max_binop_len=Math.max(st.length,fe$1.max_binop_len),fe$1.binary_ops[st]=mt,gt?fe$1.right_associative.add(st):fe$1.right_associative.delete(st),fe$1}static addIdentifierChar(st){return fe$1.additional_identifier_chars.add(st),fe$1}static addLiteral(st,mt){return fe$1.literals[st]=mt,fe$1}static removeUnaryOp(st){return delete fe$1.unary_ops[st],st.length===fe$1.max_unop_len&&(fe$1.max_unop_len=fe$1.getMaxKeyLen(fe$1.unary_ops)),fe$1}static removeAllUnaryOps(){return fe$1.unary_ops={},fe$1.max_unop_len=0,fe$1}static removeIdentifierChar(st){return fe$1.additional_identifier_chars.delete(st),fe$1}static removeBinaryOp(st){return delete fe$1.binary_ops[st],st.length===fe$1.max_binop_len&&(fe$1.max_binop_len=fe$1.getMaxKeyLen(fe$1.binary_ops)),fe$1.right_associative.delete(st),fe$1}static removeAllBinaryOps(){return fe$1.binary_ops={},fe$1.max_binop_len=0,fe$1}static removeLiteral(st){return delete fe$1.literals[st],fe$1}static removeAllLiterals(){return fe$1.literals={},fe$1}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(st){this.expr=st,this.index=0}static parse(st){return new fe$1(st).parse()}static getMaxKeyLen(st){return Math.max(0,...Object.keys(st).map(mt=>mt.length))}static isDecimalDigit(st){return st>=48&&st<=57}static binaryPrecedence(st){return fe$1.binary_ops[st]||0}static isIdentifierStart(st){return st>=65&&st<=90||st>=97&&st<=122||st>=128&&!fe$1.binary_ops[String.fromCharCode(st)]||fe$1.additional_identifier_chars.has(String.fromCharCode(st))}static isIdentifierPart(st){return fe$1.isIdentifierStart(st)||fe$1.isDecimalDigit(st)}throwError(st){let mt=new Error(st+" at character "+this.index);throw mt.index=this.index,mt.description=st,mt}runHook(st,mt){if(fe$1.hooks[st]){let gt={context:this,node:mt};return fe$1.hooks.run(st,gt),gt.node}return mt}searchHook(st){if(fe$1.hooks[st]){let mt={context:this};return fe$1.hooks[st].find(function(gt){return gt.call(mt.context,mt),mt.node}),mt.node}}gobbleSpaces(){let st=this.code;for(;st===fe$1.SPACE_CODE||st===fe$1.TAB_CODE||st===fe$1.LF_CODE||st===fe$1.CR_CODE;)st=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let st=this.gobbleExpressions(),mt=st.length===1?st[0]:{type:fe$1.COMPOUND,body:st};return this.runHook("after-all",mt)}gobbleExpressions(st){let mt=[],gt,_t;for(;this.index<this.expr.length;)if(gt=this.code,gt===fe$1.SEMCOL_CODE||gt===fe$1.COMMA_CODE)this.index++;else if(_t=this.gobbleExpression())mt.push(_t);else if(this.index<this.expr.length){if(gt===st)break;this.throwError('Unexpected "'+this.char+'"')}return mt}gobbleExpression(){let st=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",st)}gobbleBinaryOp(){this.gobbleSpaces();let st=this.expr.substr(this.index,fe$1.max_binop_len),mt=st.length;for(;mt>0;){if(fe$1.binary_ops.hasOwnProperty(st)&&(!fe$1.isIdentifierStart(this.code)||this.index+st.length<this.expr.length&&!fe$1.isIdentifierPart(this.expr.charCodeAt(this.index+st.length))))return this.index+=mt,st;st=st.substr(0,--mt)}return!1}gobbleBinaryExpression(){let st,mt,gt,_t,Et,At,Rt,Ft,Nt;if(At=this.gobbleToken(),!At||(mt=this.gobbleBinaryOp(),!mt))return At;for(Et={value:mt,prec:fe$1.binaryPrecedence(mt),right_a:fe$1.right_associative.has(mt)},Rt=this.gobbleToken(),Rt||this.throwError("Expected expression after "+mt),_t=[At,Et,Rt];mt=this.gobbleBinaryOp();){if(gt=fe$1.binaryPrecedence(mt),gt===0){this.index-=mt.length;break}Et={value:mt,prec:gt,right_a:fe$1.right_associative.has(mt)},Nt=mt;let Bt=Gt=>Et.right_a&&Gt.right_a?gt>Gt.prec:gt<=Gt.prec;for(;_t.length>2&&Bt(_t[_t.length-2]);)Rt=_t.pop(),mt=_t.pop().value,At=_t.pop(),st={type:fe$1.BINARY_EXP,operator:mt,left:At,right:Rt},_t.push(st);st=this.gobbleToken(),st||this.throwError("Expected expression after "+Nt),_t.push(Et,st)}for(Ft=_t.length-1,st=_t[Ft];Ft>1;)st={type:fe$1.BINARY_EXP,operator:_t[Ft-1].value,left:_t[Ft-2],right:st},Ft-=2;return st}gobbleToken(){let st,mt,gt,_t;if(this.gobbleSpaces(),_t=this.searchHook("gobble-token"),_t)return this.runHook("after-token",_t);if(st=this.code,fe$1.isDecimalDigit(st)||st===fe$1.PERIOD_CODE)return this.gobbleNumericLiteral();if(st===fe$1.SQUOTE_CODE||st===fe$1.DQUOTE_CODE)_t=this.gobbleStringLiteral();else if(st===fe$1.OBRACK_CODE)_t=this.gobbleArray();else{for(mt=this.expr.substr(this.index,fe$1.max_unop_len),gt=mt.length;gt>0;){if(fe$1.unary_ops.hasOwnProperty(mt)&&(!fe$1.isIdentifierStart(this.code)||this.index+mt.length<this.expr.length&&!fe$1.isIdentifierPart(this.expr.charCodeAt(this.index+mt.length)))){this.index+=gt;let Et=this.gobbleToken();return Et||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:fe$1.UNARY_EXP,operator:mt,argument:Et,prefix:!0})}mt=mt.substr(0,--gt)}fe$1.isIdentifierStart(st)?(_t=this.gobbleIdentifier(),fe$1.literals.hasOwnProperty(_t.name)?_t={type:fe$1.LITERAL,value:fe$1.literals[_t.name],raw:_t.name}:_t.name===fe$1.this_str&&(_t={type:fe$1.THIS_EXP})):st===fe$1.OPAREN_CODE&&(_t=this.gobbleGroup())}return _t?(_t=this.gobbleTokenProperty(_t),this.runHook("after-token",_t)):this.runHook("after-token",!1)}gobbleTokenProperty(st){this.gobbleSpaces();let mt=this.code;for(;mt===fe$1.PERIOD_CODE||mt===fe$1.OBRACK_CODE||mt===fe$1.OPAREN_CODE||mt===fe$1.QUMARK_CODE;){let gt;if(mt===fe$1.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==fe$1.PERIOD_CODE)break;gt=!0,this.index+=2,this.gobbleSpaces(),mt=this.code}this.index++,mt===fe$1.OBRACK_CODE?(st={type:fe$1.MEMBER_EXP,computed:!0,object:st,property:this.gobbleExpression()},this.gobbleSpaces(),mt=this.code,mt!==fe$1.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):mt===fe$1.OPAREN_CODE?st={type:fe$1.CALL_EXP,arguments:this.gobbleArguments(fe$1.CPAREN_CODE),callee:st}:(mt===fe$1.PERIOD_CODE||gt)&&(gt&&this.index--,this.gobbleSpaces(),st={type:fe$1.MEMBER_EXP,computed:!1,object:st,property:this.gobbleIdentifier()}),gt&&(st.optional=!0),this.gobbleSpaces(),mt=this.code}return st}gobbleNumericLiteral(){let st="",mt,gt;for(;fe$1.isDecimalDigit(this.code);)st+=this.expr.charAt(this.index++);if(this.code===fe$1.PERIOD_CODE)for(st+=this.expr.charAt(this.index++);fe$1.isDecimalDigit(this.code);)st+=this.expr.charAt(this.index++);if(mt=this.char,mt==="e"||mt==="E"){for(st+=this.expr.charAt(this.index++),mt=this.char,(mt==="+"||mt==="-")&&(st+=this.expr.charAt(this.index++));fe$1.isDecimalDigit(this.code);)st+=this.expr.charAt(this.index++);fe$1.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+st+this.char+")")}return gt=this.code,fe$1.isIdentifierStart(gt)?this.throwError("Variable names cannot start with a number ("+st+this.char+")"):(gt===fe$1.PERIOD_CODE||st.length===1&&st.charCodeAt(0)===fe$1.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:fe$1.LITERAL,value:parseFloat(st),raw:st}}gobbleStringLiteral(){let st="",mt=this.index,gt=this.expr.charAt(this.index++),_t=!1;for(;this.index<this.expr.length;){let Et=this.expr.charAt(this.index++);if(Et===gt){_t=!0;break}else if(Et==="\\")switch(Et=this.expr.charAt(this.index++),Et){case"n":st+=`
`;break;case"r":st+="\r";break;case"t":st+="	";break;case"b":st+="\b";break;case"f":st+="\f";break;case"v":st+="\v";break;default:st+=Et}else st+=Et}return _t||this.throwError('Unclosed quote after "'+st+'"'),{type:fe$1.LITERAL,value:st,raw:this.expr.substring(mt,this.index)}}gobbleIdentifier(){let st=this.code,mt=this.index;for(fe$1.isIdentifierStart(st)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(st=this.code,fe$1.isIdentifierPart(st));)this.index++;return{type:fe$1.IDENTIFIER,name:this.expr.slice(mt,this.index)}}gobbleArguments(st){let mt=[],gt=!1,_t=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let Et=this.code;if(Et===st){gt=!0,this.index++,st===fe$1.CPAREN_CODE&&_t&&_t>=mt.length&&this.throwError("Unexpected token "+String.fromCharCode(st));break}else if(Et===fe$1.COMMA_CODE){if(this.index++,_t++,_t!==mt.length){if(st===fe$1.CPAREN_CODE)this.throwError("Unexpected token ,");else if(st===fe$1.CBRACK_CODE)for(let At=mt.length;At<_t;At++)mt.push(null)}}else if(mt.length!==_t&&_t!==0)this.throwError("Expected comma");else{let At=this.gobbleExpression();(!At||At.type===fe$1.COMPOUND)&&this.throwError("Expected comma"),mt.push(At)}}return gt||this.throwError("Expected "+String.fromCharCode(st)),mt}gobbleGroup(){this.index++;let st=this.gobbleExpressions(fe$1.CPAREN_CODE);if(this.code===fe$1.CPAREN_CODE)return this.index++,st.length===1?st[0]:st.length?{type:fe$1.SEQUENCE_EXP,expressions:st}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:fe$1.ARRAY_EXP,elements:this.gobbleArguments(fe$1.CBRACK_CODE)}}},k7=new BA;Object.assign(fe$1,{hooks:k7,plugins:new NA(fe$1),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});fe$1.max_unop_len=fe$1.getMaxKeyLen(fe$1.unary_ops);fe$1.max_binop_len=fe$1.getMaxKeyLen(fe$1.binary_ops);var Fc=nt=>new fe$1(nt).parse(),G7=Object.getOwnPropertyNames(fe$1);G7.forEach(nt=>{Fc[nt]===void 0&&nt!=="prototype"&&(Fc[nt]=fe$1[nt])});Fc.Jsep=fe$1;var j7="ConditionalExpression",H7={name:"ternary",init(nt){nt.hooks.add("after-expression",function(st){if(st.node&&this.code===nt.QUMARK_CODE){this.index++;let mt=st.node,gt=this.gobbleExpression();if(gt||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===nt.COLON_CODE){this.index++;let _t=this.gobbleExpression();if(_t||this.throwError("Expected expression"),st.node={type:j7,test:mt,consequent:gt,alternate:_t},mt.operator&&nt.binary_ops[mt.operator]<=.9){let Et=mt;for(;Et.right.operator&&nt.binary_ops[Et.right.operator]<=.9;)Et=Et.right;st.node.test=Et.right,Et.right=st.node,st.node=mt}}else this.throwError("Expected :")}})}};Fc.plugins.register(H7);var W7=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],q7=["0","1","2","3","4","5","6","7","8","9","."],Y7=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function X7(nt){return typeof nt!="string"?!1:!isNaN(nt)&&!isNaN(parseFloat(nt))}Fc.addBinaryOp("^",11,!0);function _0(nt,st,mt="number"){let gt="";for(let At=0;At<nt.length;At++){let Rt=nt[At];if("objType"in Rt&&Rt.objType==="api"){let Ft=JSON.parse(Rt.id),Nt=Ft[0],Bt=st.getUserAPI(Nt);if(Bt!==void 0){let Gt=Bt.retrieveValue(Ft.slice(1));Gt!==void 0&&(gt+=Gt)}continue}if("objType"in Rt&&Rt.objType==="webhook"){let Ft=JSON.parse(Rt.id),[Nt,Bt]=Ft,Gt=st.getUserWebhook(Nt);if(Gt!==void 0){let dr=Gt.getParameterValue(Bt);dr!==void 0&&(gt+=dr)}continue}if("id"in Rt){let Ft=nt[At-1];if(At>0&&"id"in Ft){console.error("Two variables in a row",nt);return}let Nt=st.getVariable(Rt.id),Bt=Lr.getDisplayedValue(Nt);mt==="number"&&Lr.isTextValue(Nt)&&Array.isArray(Nt.textValue)&&Nt.textValue.length===1?Bt=parseFloat(Bt).toString():mt==="boolean"&&Lr.isBoolean(Nt)?Bt=Nt?"true":"false":mt==="boolean"&&Lr.isTextValue(Nt)&&!Array.isArray(Nt.textValue)&&(Bt='"'+Bt+'"'),gt+=Bt;continue}else if(mt==="string"){Rt.name!=='"'&&(Rt.name!=="+"||Rt.escaped)&&(gt+=Rt.name),Rt.name==="+"&&!Rt.escaped&&gt[gt.length-1]==="\\"&&(gt=gt.slice(0,-1)+Rt.name);continue}if(Rt.name==="and"){gt+="&&";continue}if(Rt.name==="or"){gt+="||";continue}if(Rt.name==="True"){gt+="true";continue}if(Rt.name==="False"){gt+="false";continue}if(mt==="boolean"&&!X7(Rt.name)&&!q7.includes(Rt.name)&&!W7.includes(Rt.name)&&!Y7.includes(Rt.name.replace(/\($/g,""))){gt+='"'+Rt.name+'"';continue}gt+=Rt.name}if(mt==="string")return gt;if(nt.length===0){if(mt==="number")return 0;if(mt==="boolean")return!1}let _t;try{_t=Fc(gt)}catch(At){console.error(gt,At);return}let Et;try{Et=Ht(_t)}catch(At){console.error(gt,_t,At)}return Et}function Ht(nt){switch(nt.type){case"BinaryExpression":switch(nt.operator){case"==":return+(Ht(nt.left)===Ht(nt.right));case"!=":return+(Ht(nt.left)!==Ht(nt.right));case">":return+(Ht(nt.left)>Ht(nt.right));case">=":return+(Ht(nt.left)>=Ht(nt.right));case"<":return+(Ht(nt.left)<Ht(nt.right));case"<=":return+(Ht(nt.left)<=Ht(nt.right));case"+":return Ht(nt.left)+Ht(nt.right);case"-":return Ht(nt.left)-Ht(nt.right);case"*":return Ht(nt.left)*Ht(nt.right);case"/":return Ht(nt.left)/Ht(nt.right);case"%":return Ht(nt.left)%Ht(nt.right);case"&&":return Ht(nt.left)&&Ht(nt.right);case"||":return Ht(nt.left)||Ht(nt.right);case"^":return Math.pow(Ht(nt.left),Ht(nt.right));default:throw new Error("Unknown operator: "+nt.operator)}case"UnaryExpression":switch(nt.operator){case"-":return-Ht(nt.argument);case"!":return+!Ht(nt.argument);default:throw new Error("Unknown operator: "+nt.operator)}case"Identifier":throw new Error("Unknown identifier: "+nt.name);case"Literal":return nt.value;case"CallExpression":if(nt.callee.type==="Identifier"){if(nt.callee.name==="random"){let st=0,mt=1;if(nt.arguments.length>=1)try{st=Ht(nt.arguments[0])}catch(gt){console.warn(gt)}if(nt.arguments.length>=2)try{mt=Ht(nt.arguments[1])}catch(gt){console.warn(gt)}return st=Math.min(mt,st),mt=Math.max(mt,st),st+Math.random()*(mt-st)}return Math[nt.callee.name].apply(null,nt.arguments.map(Ht))}else throw new Error("Unknown node");default:throw new Error("Unknown node type: "+nt.type)}}var Q7=new ue$1,K7=new ue$1;function Z7(nt,st,mt){let gt=[new E$6,new E$6,new E$6],_t=[new E$6,new E$6,new E$6];return nt.extractBasis(gt[0],gt[1],gt[2]),st.extractBasis(_t[0],_t[1],_t[2]),gt.forEach((Et,At)=>{let Rt=_t[At],Ft=we$1.lerp(Et.length(),Rt.length(),mt);Et.lerp(Rt,mt).setLength(Ft)}),new ue$1().makeBasis(gt[0],gt[1],gt[2])}var UO=class{static create(nt){return this.build(this.normalizeInputs(nt))}static normalizeInputs(nt,st){let mt=Object.assign({},(st==null?void 0:st.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},nt.parameters),gt=Math.abs(mt.width),_t=Math.abs(mt.height??mt.width),Et=Math.abs(mt.depth??0),At=(st==null?void 0:st.shapeData)??Ad.create({parameters:P1}).userData.shape;return{path:nt.path??kh.defaultData(),parameters:Object.assign(mt,{width:gt,height:_t,depth:Et,extrusion:{...Vv,...mt.extrusion}}),shapeData:At}}static build(nt){if(nt.path.points.length>=2){let st=new FA(nt);return Object.assign(st,{userData:{...nt,type:"PathGeometry"}})}else return Object.assign(new _e$1,{userData:{...nt,type:"PathGeometry"}})}},FA=class extends _e$1{constructor(nt){super(),this.type="PathExtrusionGeometry",this.inputs=nt,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let nt=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&nt.depth===1)||!VO(nt.twist,0)||nt.startScale!==nt.endScale}build(){let nt=this._extractPathPoints();if(nt.length<2)return;let st=this._computeBasisMatrices(nt),{depth:mt,offset:gt}=this.inputs.parameters.extrusion;mt=Math.max(0,Math.min(mt,1)),gt=Math.max(0,Math.min(gt,1));let _t=this.inputs.path.isClosed?nt.length:nt.length-1,Et=Math.floor(gt*_t),At=this.inputs.path.isClosed?Math.ceil((mt+gt)*_t):Math.ceil(Math.min(1,mt+gt)*_t),Rt=Math.min(Math.max(2,At-Et+1),_t+2),Ft=[],Nt=[];for(let q0=0;q0<Rt;q0++){let W0=this.inputs.path.isClosed?(q0+Et)%nt.length:Math.min(q0+Et,nt.length-1);Ft.push(nt[W0].clone()),Nt.push(st[W0].clone())}let Bt=(q0,W0,hu)=>{Ft[q0]=Ft[q0].clone().lerp(Ft[W0],hu),Nt[q0]=Z7(Nt[q0],Nt[W0],hu)},Gt=0,dr=gt*_t%1;(!this.inputs.path.isClosed||mt<=1)&&(dr||gt===0)&&(Gt=dr,Bt(0,1,Gt));let Mr=0,Tr=(gt+mt)*_t%1;if((this.inputs.path.isClosed&&mt<=1||!this.inputs.path.isClosed&&gt+mt<1)&&Tr&&(Mr=Tr,Bt(Ft.length-1,Ft.length-2,1-Mr)),mt===0){let q0=Ft.length-1;Ft[q0].copy(Ft[0]),Nt[q0].copy(Nt[0])}this._applyPathModifiers(Nt,Gt,Mr);let{bevel:zr,bevelSides:Fr}=this.inputs.parameters.extrusion,Nr=zr>0?this.inputs.parameters.extrusion.capType:"flat",tn=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(tn=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:rn,infos:Tn,vertices:$n}=this._computeShapePoints(tn),un=0,es;Nr==="round"&&(es=new Ol(this.inputs.shapeData,2*zr,zr,tn,Fr,void 0,!0),un=es.getAttribute("position").count);let kn=0,ts=0;Tn.sort((q0,W0)=>q0.start-W0.start),Tn.forEach(q0=>{q0.verticesStart=kn,q0.verticesCount=q0.continuous.reduce((W0,hu,a1)=>W0+(a1===0||!hu?2:1),0),ts+=q0.verticesCount,kn=ts});let Ko=ts*Rt,ds,Il=0;if(this._isOpenEnded()&&Nr==="flat"){try{ds=Ws({windingRule:zt.ODD,elementType:jr.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:rn})}catch{ds=TA}Il=ds.vertexCount}let ru=Ko+2*Il+un*2,uu=Ko+2*Il,p0={positions:new Float32Array(ru*3),normals:new Float32Array(ru*3),uvs:new Float32Array(ru*2)},X1=[];if(Tn.forEach(q0=>{this._extrudeRegion(q0,$n,Nt,Ft,p0,X1,this._isGeometryClosed()&&!this._isOpenEnded())}),ds&&(this._closeEnd(ds,Ko,X1,p0,Nt[0],Ft[0],!1),this._closeEnd(ds,Ko+Il,X1,p0,Nt[Nt.length-1],Ft[Ft.length-1],!0)),es){p0.positions.set(es.getAttribute("position").array,uu*3),p0.normals.set(es.getAttribute("normal").array,uu*3),p0.uvs.set(es.getAttribute("uv").array,uu*2);for(let a1=uu;a1<uu+un;a1++)p0.uvs[a1*2+1]=1e-4;let q0=X1.length;X1.push(...es.getIndex().array.map(a1=>a1+uu)),uu+=un,p0.positions.set(es.getAttribute("position").array,uu*3),p0.normals.set(es.getAttribute("normal").array,uu*3),p0.uvs.set(es.getAttribute("uv").array,uu*2);let W0=X1.length;X1.push(...es.getIndex().array.map(a1=>a1+uu)),this.setAttribute("position",new Xe$1(p0.positions,3)),this.setAttribute("normal",new Xe$1(p0.normals,3)),this.setAttribute("uv",new Xe$1(p0.uvs,2)),this.setIndex(X1);let hu=Q7;hu.copy(Nt[Nt.length-1]).setPosition(Ft[Ft.length-1]),this.applyMatrix4OnRange(hu,uu,ru),hu.copy(Nt[0]).setPosition(Ft[0]).multiply(K7.makeScale(1,1,-1)),this.applyMatrix4OnRange(hu,uu-un,uu),this.reverseIndicesOnRange(q0,W0)}else this.setAttribute("position",new Xe$1(p0.positions,3)),this.setAttribute("normal",new Xe$1(p0.normals,3)),this.setAttribute("uv",new Xe$1(p0.uvs,2)),this.setIndex(X1)}_extractPathPoints(){let nt=m0(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(nt.length<2)return[];let st=[nt[0]];return nt.forEach(mt=>{st[st.length-1].distanceToSquared(mt)>.001&&st.push(mt)}),this.inputs.path.isClosed&&st[st.length-1].distanceTo(st[0])<.001&&st.pop(),st}_computeBasisMatrices(nt){let st=[],mt=nt.length,gt=this.inputs.path.isClosed,_t=new E$6,Et=new E$6,At=new E$6,Rt=new E$6,Ft=new E$6(0,1,0);for(let Tr=0;Tr<mt;Tr++){let zr=nt[Tr],Fr;Tr===0?Fr=gt?nt[nt.length-2]:zr.clone().multiplyScalar(2).sub(nt[1]):Fr=nt[Tr-1];let Nr;Tr===mt-1?Nr=gt?nt[1]:zr.clone().multiplyScalar(2).sub(nt[Tr-1]):Nr=nt[Tr+1];let tn=zr.clone().sub(Fr).normalize(),rn=Nr.clone().sub(zr).normalize(),Tn=tn.clone().add(rn).normalize();At.copy(Tn),Tr===0&&(Tn.equals(Ft)||Tn.clone().negate().equals(Ft))&&Ft.set(0,0,1);let $n=Ft.clone().cross(Tn).normalize(),un=Tn.clone().cross($n).normalize();Ft.copy(un),Rt.copy($n),Tr===0&&(_t.copy(un),Et.copy(Tn));let es=new ue$1().makeBasis($n,un,Tn);st.push(es)}let Nt=gt?Et:At,Bt=gt?_t:new E$6(0,1,0),Gt=Nt.clone().cross(Rt).normalize(),dr=Math.acos(Bt.dot(Gt));if(isNaN(dr))return st;let Mr=Bt.clone().cross(Gt);Nt.dot(Mr)>0&&(dr*=-1);for(let Tr=1;Tr<st.length;Tr++){let zr=new ue$1().makeRotationZ(dr*Tr/st.length);st[Tr].multiply(zr)}return st}_applyPathModifiers(nt,st,mt){let gt=nt.length,{angle:_t,twist:Et,startScale:At,endScale:Rt}=this.inputs.parameters.extrusion,Ft=new ue$1,Nt=new ue$1;return nt.forEach((Bt,Gt)=>{let dr=Gt===0?0:Gt===gt-1?1:(Gt-st)/(gt-(mt===0?0:1)-(st+(1-mt)));Ft.makeRotationZ(we$1.lerp(_t,_t+Et,dr)*we$1.DEG2RAD);let Mr=we$1.lerp(At,Rt,dr);Nt.makeScale(Mr,Mr,Mr),Bt.multiply(Ft).multiply(Nt)}),nt}_computeShapePoints(nt=12,st=zt.ODD){let mt=this.inputs.shapeData,gt=mt.extractShapePointsToFlatArray([],nt),_t=mt.shapeHoles.map(Nt=>{let Bt=Nt.extractShapePointsToFlatArray([],nt),Gt=[];for(let dr=Bt.length-1;dr>=1;dr-=2){let Mr=Bt[dr-1],Tr=Bt[dr-0];Gt.push(Mr,Tr)}return Gt}),Et;try{Et=Ws({windingRule:st,elementType:jr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[gt]})}catch{Et=sm}let At;try{At=Ws({windingRule:zt.ODD,elementType:jr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[..._t]})}catch{At=MA}if(!Et)throw new Error("error generating geometry");let Rt=Et.elementCount;if(At){Et.elementCount+=At.elementCount;for(let Nt=0;Nt<At.elements.length;Nt++){let Bt=At.elements[Nt],Gt=Nt%2===0?Et.vertexCount:0;Et.elements.push(Bt+Gt)}for(let Nt=0;Nt<At.vertexIndices.length;Nt++){let Bt=At.vertexIndices[Nt],Gt=Et.vertexCount;Et.vertexIndices.push(Bt+Gt)}for(let Nt=0;Nt<At.vertices.length;Nt++){let Bt=At.vertices[Nt];Et.vertices.push(Bt)}}for(let Nt=0,Bt=Et.vertexCount;Nt<Bt;Nt++){let Gt=Nt*2;Et.vertices[Gt+0],Et.vertices[Gt+1]}let Ft=[];for(let Nt=Et.elementCount-1;Nt>=0;Nt--){let Bt=Nt>=Rt,Gt=Nt*2,dr=Et.elements[Gt+0],Mr=Et.elements[Gt+1],Tr=dr+Mr,zr={start:dr,count:Mr,normals:[],isHole:Bt,continuous:[],verticesStart:0,verticesCount:0};Ft.push(zr);let Fr=dr,Nr=Tr-1,tn=dr+1,rn=mt.roundedCurves.length;do{let Tn=Fr-dr;Et.vertices[Nr*2+0],Et.vertices[Nr*2+1];let $n=Et.vertices[Fr*2+0],un=Et.vertices[Fr*2+1],es=Et.vertices[tn*2+0],kn=Et.vertices[tn*2+1],ts=$n-es,Ko=un-kn,ds=Math.sqrt(ts*ts+Ko*Ko);ts/=ds,Ko/=ds,zr.normals[Tn*2+0]=-Ko,zr.normals[Tn*2+1]=ts;let Il=Et.vertexIndices[Fr];if(Array.isArray(Il))zr.continuous[Tn]=!1;else{let[ru,uu]=mt.getCurveIndexFromVertexId(Il-1,!0);if(uu>0&&uu<1)zr.continuous[Tn]=!0;else{let p0=uu===1?ru+1:ru-1;p0=(p0+rn)%rn;let X1=uu===1?0:1,q0=mt.roundedCurves[ru].getTangent(uu),W0=mt.roundedCurves[p0].getTangent(X1);zr.continuous[Tn]=q0.dot(W0)>.95}}Bt&&(zr.normals[Tn*2+0]*=-1,zr.normals[Tn*2+1]*=-1),[Nr,Fr,tn]=[Fr,tn,tn+1],tn>=Tr&&(tn-=Mr)}while(tn!==dr+1)}return{regions:[gt,..._t],infos:Ft,vertices:Et.vertices}}_insertVertex(nt,st,mt,gt,_t){let Et=st*2,At=st*3;nt.positions[At+0]=mt.x,nt.positions[At+1]=mt.y,nt.positions[At+2]=mt.z,nt.normals[At+0]=gt.x,nt.normals[At+1]=gt.y,nt.normals[At+2]=gt.z,nt.uvs[Et+0]=_t.x,nt.uvs[Et+1]=_t.y}_extrudeRegion(nt,st,mt,gt,_t,Et,At){let Rt=new E$6,Ft=new E$6,Nt=new E$6,Bt=new E$6,Gt=new U$1;mt.forEach((Mr,Tr)=>{let zr=gt[Tr],Fr=nt.verticesStart*mt.length+nt.verticesCount*Tr;for(let Nr=0;Nr<nt.count;Nr++){let tn=(nt.start+Nr)*2;if(Rt.set(st[tn+0],st[tn+1],0),Nt.copy(Rt).applyMatrix4(Mr).add(zr),nt.continuous[Nr])Bt.set(nt.normals[Nr*2+0],nt.normals[Nr*2+1],0);else{let rn=Nr===0?(nt.start+nt.count-1)*2:tn-2;Ft.set(st[rn+0],st[rn+1],0),Bt.copy(Rt).sub(Ft),Bt.set(-Bt.y,Bt.x,0),nt.isHole||Bt.negate()}if(Bt.applyMatrix4(Mr).normalize(),Gt.set(Nr===0?1:Nr/nt.count,Tr/(mt.length-1)),this._insertVertex(_t,Fr,Nt,Bt,Gt),Fr++,!nt.continuous[Nr]||Nr===0){if(Nr===0)Bt.set(nt.normals[Nr*2+0],nt.normals[Nr*2+1],0),Gt.set(0,Tr/(mt.length-1));else{let rn=Nr===nt.count-1?nt.start*2:tn+2;Ft.set(st[rn+0],st[rn+1],0),Bt.copy(Ft).sub(Rt),Bt.set(-Bt.y,Bt.x,0),nt.isHole||Bt.negate()}Bt.applyMatrix4(Mr).normalize(),this._insertVertex(_t,Fr,Nt,Bt,Gt),Fr++}}});let dr=mt.length-1;for(let Mr=0;Mr<dr;Mr++){let Tr=nt.verticesStart*mt.length+nt.verticesCount*Mr,zr=nt.verticesStart*mt.length+nt.verticesCount*(Mr+1),Fr=0;for(let Nr=0;Nr<nt.count;Nr++){(!nt.continuous[Nr]||Nr===0)&&Fr++;let tn=Nr===nt.count-1?0:Fr+1,rn=Tr+Fr,Tn=Tr+tn,$n=zr+tn,un=zr+Fr;nt.isHole?Et.push(rn,$n,Tn,rn,un,$n):Et.push(rn,Tn,$n,rn,$n,un),Fr++}}}_closeEnd(nt,st,mt,gt,_t,Et,At){let Rt=nt.vertexCount,Ft=new E$6(0,0,At?-1:1).applyMatrix4(_t),Nt=new E$6,Bt=new U$1;for(let dr=0;dr<Rt;dr++){let Mr=2*dr;Nt.set(nt.vertices[Mr+0],nt.vertices[Mr+1],0).applyMatrix4(_t).add(Et),this._insertVertex(gt,st+dr,Nt,Ft,Bt)}let Gt=nt.elements;for(let dr=0;dr<nt.elementCount;dr++){let Mr=3*dr,Tr=Gt[Mr+0]+st,zr=Gt[Mr+(At?1:2)]+st,Fr=Gt[Mr+(At?2:1)]+st;mt.push(Tr,zr,Fr)}}applyMatrix4OnRange(nt,st,mt){let gt=nt.elements,_t=new fr().getNormalMatrix(nt).elements,Et,At,Rt,Ft,Nt=this.attributes.position,Bt=this.attributes.normal;if(!Nt||!Bt)return;let Gt=Nt.array,dr=Bt.array,Mr=Nt.itemSize;for(let Tr=st*Mr,zr=mt*Mr;Tr<zr;Tr+=Mr){if(Tr===st)debugger;Et=Gt[Tr+0],At=Gt[Tr+1],Rt=Gt[Tr+2],Ft=1/(gt[3]*Et+gt[7]*At+gt[11]*Rt+gt[15]),Gt[Tr+0]=(gt[0]*Et+gt[4]*At+gt[8]*Rt+gt[12])*Ft,Gt[Tr+1]=(gt[1]*Et+gt[5]*At+gt[9]*Rt+gt[13])*Ft,Gt[Tr+2]=(gt[2]*Et+gt[6]*At+gt[10]*Rt+gt[14])*Ft,Et=dr[Tr+0],At=dr[Tr+1],Rt=dr[Tr+2],dr[Tr+0]=_t[0]*Et+_t[3]*At+_t[6]*Rt,dr[Tr+1]=_t[1]*Et+_t[4]*At+_t[7]*Rt,dr[Tr+2]=_t[2]*Et+_t[5]*At+_t[8]*Rt}Nt.needsUpdate=!0,Bt.needsUpdate=!0}reverseIndicesOnRange(nt,st){let mt=this.index;if(mt){for(let gt=nt;gt<st;gt+=3){let _t=mt.getX(gt),Et=mt.getX(gt+1),At=mt.getX(gt+2);mt.setXYZ(gt,At,Et,_t)}mt.needsUpdate=!0}}};function zO(){let nt=new _e$1;return nt.setAttribute("position",new Xe$1(new Float32Array([]),3)),nt.setIndex(new Xe$1(new Uint16Array([]),1)),nt}var $7=zO().attributes,eY=12,tY=1,Vc=class extends _e$1{constructor(nt,st){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,$7),this.userData={parameters:nt,type:"TextGeometry"};let mt=st.getFont(nt.font);mt!=null&&mt.isLoaded?(this.font=mt,this.update(nt)):this.updateFont(nt.font,st).then(()=>{this.update(nt),st==null||st.requestRender()})}async updateFont(nt,st){let mt=st.getFont(nt);mt&&(this.font=mt,await mt.loadingPromise)}update(nt){let st=this.font;if(this.userData={parameters:nt,type:"TextGeometry"},!(st!=null&&st.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:mt,height:gt,depth:_t,extrudeBevelSize:Et,extrudeBevelSegments:At,text:Rt,textTransform:Ft}=nt,Nt=Lr.getDisplayedValue(Rt),Bt=Ft===2?Nt.toUpperCase():Ft===3?Nt.toLowerCase():Nt,Gt=rY(nt,st,Bt),{shapes:dr,charWidths:Mr,charCoords:Tr}=st.generateShapes(Gt,nt),zr=(typeof mt=="number"?mt:1)*.5,Fr=(typeof gt=="number"?gt:1)*.5,Nr=dr.map(Tn=>new qt().fromShape(Tn,!0));this.vectorShapes=Nr;let tn=Nr.map(Tn=>Rn.create({shape:Tn,parameters:{depth:_t,extrudeBevelSegments:At,extrudeBevelSize:Et,windingRule:_t<=0?zt.NONZERO:zt.ODD,subdivisions:this.isLowResolution&&_t>0?tY:eY}})),rn=tn.length?ks(tn):zO();rn.translate(-zr,Fr,0),this.dispose(),this.wrappedText=Gt,this.charCoords=Tr,this.charWidths=Mr,this.deleteAttribute("extrudeNormal"),Object.entries(rn.attributes).forEach(([Tn,$n])=>{this.setAttribute(Tn,$n)}),this.setIndex(rn.index),this.computeBoundingSphere()}clone(){let nt=qi(new _e$1,Vc.prototype);return nt.copy(this),console.log("CloneGeometry",this,nt),nt}copy(nt){return Object.entries(nt.attributes).forEach(([st,mt])=>{this.setAttribute(st,mt)}),this.setIndex(nt.index),this.userData={parameters:{...nt.userData.parameters},type:"TextGeometry"},this}async setText(nt){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:{textValue:nt}})}get text(){return this.userData.parameters.text??""}};function rY(nt,st,mt){let gt=[""],_t="";for(let Et of mt)_t+=Et,Et===" "||Et===`
`?(gt[gt.length-1]+=_t,_t="",Et===`
`&&gt.push("")):st.getTextWidth(gt[gt.length-1]+_t,nt)>nt.width&&(gt[gt.length-1].length&&gt.push(""),st.getTextWidth(gt[gt.length-1]+_t,nt)>nt.width&&(_t.length===1?(gt[gt.length-1]+=_t,_t=""):(gt[gt.length-1]+=_t.slice(0,-1),_t=_t[_t.length-1],gt.push(""))));return gt[gt.length-1]+=_t,gt}var GO,I0=new Promise(nt=>{GO=nt}),kO=!1,D0;function jO(){if(kO)return;if(D0)return D0;async function nt(){let st="https://unpkg.com/@splinetool/modelling-wasm@1.9.30/build",mt=__vitePreload(()=>import("./process-B9H0U9ag.js"),[]),[gt,_t]=await Promise.all([mt,fetch(`${st}/process.wasm`).then(Rt=>Rt.arrayBuffer())]),Et=gt.default,At=await Et({wasmBinary:_t});GO(At),kO=!0}return D0=nt(),D0}var iY=["font"];function Ca(nt,st,mt,gt){var Nt,Bt;let _t,Et,At;nt.type==="PathGeometry"?(Et=JSON.parse(JSON.stringify(nt)),At=[[],["extrusion"]]):(Et={...nt},At=[[]]);for(let Gt of At){let dr=Et;for(let Mr of Gt)dr=dr[Mr];for(_t in dr){let Mr=dr[_t];x1(Mr)&&!iY.includes(_t)&&(dr[_t]=st.getVariable(Mr,[gt.uuid,"geometry",...Gt,_t]),x1(dr[_t])&&(dr[_t]=1))}}let Rt={parameters:Et,type:Et.type};if(Et.type==="PathGeometry")Rt.path=Et.path;else if(Et.type==="VectorGeometry"){let Gt=qt.createFromState(Et.shape,Et.width,Et.height);Rt.shape=Gt}else if(Et.type==="NonParametricGeometry"){if(Et.data.groups&&((Nt=Et.data.groups)==null||Nt.forEach(Gt=>Gt.materialIndex=Math.max(Gt.materialIndex??0,0))),Rt.geometry=new Xu().parse(Et),Rt.geometry.groups.length===0){let Gt=Rt.geometry;Gt.addGroup(0,Math.max(((Bt=Gt.getIndex())==null?void 0:Bt.count)??0,Gt.getAttribute("position").count),0)}}else if(Et.type==="SubdivGeometry"){let Gt=new ni(Et,mt);return Gt.data=nt,Gt}else{if(Et.type==="TextGeometry")return new Vc(Et,st);if(Et.type==="InputGeometry")return new Vc(Et,st);if(Et.type==="UIGeometry")return Td.create({parameters:{width:Et.width,height:Et.height,cornerRadius:Et.cornerRadius,cornerType:Et.cornerType}})}let Ft;try{Ft=VA(Rt)}catch(Gt){console.error(Gt)}if(!Ft){let Gt=qt.createFromState(zh.defaultData(),100,100);Rt.shape=Gt,Ft=VA(Rt)}return Ft}var nY=new ue$1;function cm(nt,st,mt,gt){let _t=nt.position.array,Et=nt.normal.array,At=nY.makeScale(st,mt,gt).invert().elements,Rt,Ft,Nt;for(var Bt=0,Gt=_t.length;Bt<Gt;Bt+=3)_t[Bt]*=st,_t[Bt+1]*=mt,_t[Bt+2]*=gt,Rt=Et[Bt],Ft=Et[Bt+1],Nt=Et[Bt+2],Et[Bt]=At[0]*Rt+At[4]*Ft+At[8]*Nt,Et[Bt+1]=At[1]*Rt+At[5]*Ft+At[9]*Nt,Et[Bt+2]=At[2]*Rt+At[6]*Ft+At[10]*Nt;nt.position.needsUpdate=!0,nt.normal.needsUpdate=!0}var O0=new jt,Cd=new E$6,lt$1;I0.then(nt=>{lt$1=nt});var HO=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),WO=new Uint32Array([0,1,2,3]),qO=new Uint8Array([4]),ni=class extends _e$1{constructor(nt,st){super(),this.data=nt,this.flatShading=st,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(nt,st){this.freeSubdivPointer();let mt=this.data.scaleBaked,gt=Ao.div(st,mt);this.subdividedGeometry&&cm(this.subdividedGeometry.attributes,...gt),this.originalGeometry&&cm(this.originalGeometry.attributes,...gt),this.data=nt;let _t=this.userData.parameters;this.userData.parameters={width:_t.width*gt[0],height:_t.height*gt[1],depth:_t.depth*gt[2]},this.originalGeometry.boundingSphere.center.multiply(Cd.fromArray(gt));let Et=Cd.set(_t.width,_t.height,_t.depth).length();this.originalGeometry.boundingSphere.radius=Et/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let nt,st,mt;try{({originalGeometry:nt,subdividedGeometry:st,subdivPointer:mt}=ni.build(this.data,void 0,!this.flatShading,void 0))}catch{nt=new mi(100,100,100),mt=0}this.subdivPointer=mt,this.originalGeometry=nt,this.subdividedGeometry=st??void 0;let gt=this.subdividedGeometry??this.originalGeometry;Object.assign(this,gt),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(ni.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let nt=this.originalGeometry;nt.boundingSphere===null&&(nt.boundingSphere=new Or,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=nt.boundingSphere));let st=nt.attributes.position,mt=nt.boundingSphere.center;O0.setFromBufferAttribute(st),O0.getCenter(mt),nt.boundingSphere.radius=mt.distanceTo(O0.max),isNaN(nt.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),O0.getSize(Cd);let gt={width:Cd.x,height:Cd.y,depth:Cd.z};return this.userData.parameters=gt,gt}static build(nt,st,mt,gt){let _t,Et,At,Rt=(nt==null?void 0:nt.phongAngle)??35;mt===!1&&(Rt=-1),st&&(lt$1.free_bvh(st),lt$1.free_subdivision_surface(st));try{_t=ni.allocate(nt,gt)}catch(Ft){console.error(Ft,nt),_t=ni.allocate({positionWASM:HO,indexWASM:WO,verticesPerFaceWASM:qO},gt)}if(lt$1.set_destination_refinement_level(_t,0),Et=ni.buildLevel(_t,!0,Rt),nt.subdivisions>0)try{lt$1.set_destination_refinement_level(_t,nt.subdivisions),At=ni.buildLevel(_t,!1,Rt)}catch{try{lt$1.set_destination_refinement_level(_t,nt.subdivisions-1),At=ni.buildLevel(_t,!1,Rt)}catch{At=null}}else At=null;return{subdivPointer:_t,originalGeometry:Et,subdividedGeometry:At}}static primitiveToQuads(nt,st,mt){nt.widthSegments>16&&(nt.widthSegments=16),nt.heightSegments>16&&(nt.heightSegments=16),nt.depthSegments>16&&(nt.depthSegments=16),nt.radialSegments>16&&(nt.radialSegments=16),nt.type==="DodecahedronGeometry"&&(nt.detail=0);let gt=nt.shape!==void 0||nt.path!==void 0?st.geometry:Ca(nt,mt,!1),_t;nt.type==="TorusGeometry"&&nt.arc===Math.PI*2?_t=gt.getClosedTorusIndicesForBooleanOrSubdiv():_t=gt.getIndex();let Et,At,Rt,Ft;({positions:Et,triIndices:Ft}=Uc(gt.getAttribute("position"),_t));let Nt;if(nt.type==="CylinderGeometry"&&nt.cornerRadius===0&&nt.hollow===0&&nt.openEnded===!1){let Bt=nt.radialSegments*nt.heightSegments*3*2,Gt=Bt+nt.radialSegments*3;Nt=[Bt,Gt]}return{indices:At,verticesPerFace:Rt}=GA(Et,Ft,gt,Nt),{positions:Et,indices:At,verticesPerFace:Rt}}static allocate(nt,st){var rn;let mt,gt,_t,Et=[],At=[];nt.positionWASM&&nt.positionWASM.length>0?(mt=nt.positionWASM,gt=nt.indexWASM,_t=nt.verticesPerFaceWASM):(mt=HO,gt=WO,_t=qO);let Rt=mt.length,Ft=gt.length,Nt=_t.length,Bt=mt.length+Et.length+At.length,Gt=gt.length+_t.length,dr=Bt*Float32Array.BYTES_PER_ELEMENT+Gt*Uint32Array.BYTES_PER_ELEMENT,Mr=Bt*Float32Array.BYTES_PER_ELEMENT,Tr=lt$1._malloc(dr),zr=new Float32Array(lt$1.HEAPF32.buffer,Tr,Bt),Fr=new Uint32Array(lt$1.HEAPU32.buffer,Tr+Mr,Gt);zr.set(mt,0),zr.set(Et,mt.length),zr.set(At,mt.length+Et.length),Fr.set(gt,0),Fr.set(_t,gt.length);let Nr;(rn=nt==null?void 0:nt.scaleBaked)!=null&&rn.some(Tn=>Tn!==1)&&(Nr=new ue$1().makeScale(...nt.scaleBaked)),st&&(Nr?Nr.premultiply(st):Nr=st);let tn=Nr?lt$1.alloc_subdivision_surface2(Tr,Rt,Tr+Mr,Ft,Tr+Mr+gt.length*Uint32Array.BYTES_PER_ELEMENT,Nt,Nr.elements):lt$1.alloc_subdivision_surface(Tr,Rt,Tr+Mr,Ft,Tr+Mr+gt.length*Uint32Array.BYTES_PER_ELEMENT,Nt);return lt$1._free(Tr),tn}static buildLevel(nt,st,mt,gt,_t){let Et=_t?lt$1.get_mesh_data2(nt,st?lt$1.Level.CONTROL:lt$1.Level.REFINED,mt,_t.elements):lt$1.get_mesh_data(nt,st?lt$1.Level.CONTROL:lt$1.Level.REFINED,mt),At=8,Rt=lt$1.HEAPU32.subarray(Et>>2,(Et>>2)+At),Ft=Rt.subarray(4,8),Nt=0,Bt=lt$1.HEAPU32[Rt[Nt]>>2],Gt=lt$1.HEAPF32.subarray(Bt>>2,(Bt>>2)+Ft[Nt]);Nt++;let dr=lt$1.HEAPU32[Rt[Nt]>>2],Mr=lt$1.HEAPF32.subarray(dr>>2,(dr>>2)+Ft[Nt]);Nt++;let Tr=lt$1.HEAPU32[Rt[Nt]>>2],zr=lt$1.HEAPU32.subarray(Tr>>2,(Tr>>2)+Ft[Nt]);Nt++;let Fr=lt$1.HEAPU32[Rt[Nt]>>2],Nr=lt$1.HEAPU32.subarray(Fr>>2,(Fr>>2)+Ft[Nt]);if(Nt++,gt===void 0){let tn=new _e$1;if(tn.setIndex(new ho$1(Nr,1)),tn.setAttribute("position",new Me$1(Gt,3)),tn.setAttribute("normal",new Me$1(Mr,3)),st){tn.setAttribute("faceMap",new ho$1(zr,1));let rn=new Float32Array(Mr.length/3*4).fill(0);tn.setAttribute("color",new Xe$1(rn,4))}return lt$1.free_mesh_data(Et),tn.userData.type="SubdivGeometry",tn}gt.getAttribute("position").copyArray(Gt),gt.getAttribute("normal").copyArray(Mr),gt.attributes.position.needsUpdate=!0,gt.attributes.normal.needsUpdate=!0,lt$1.free_mesh_data(Et)}static freeSubdivPointer(nt){lt$1.free_bvh(nt),lt$1.free_subdivision_surface(nt)}static buildControlCageWireframe(nt,st,mt){let gt=lt$1.get_wireframe_data_for_base_level(nt),_t=4,Et=lt$1.HEAPU32.subarray(gt>>2,(gt>>2)+_t),At=Et.subarray(2,4),Rt=0,Ft=lt$1.HEAPU32[Et[Rt]>>2],Nt=lt$1.HEAPF32.subarray(Ft>>2,(Ft>>2)+At[Rt]);Rt++;let Bt=lt$1.HEAPU32[Et[Rt]>>2],Gt=lt$1.HEAPU32.subarray(Bt>>2,(Bt>>2)+At[Rt]);if(st===void 0){let dr=new _e$1;dr.setAttribute("position",new Me$1(Nt,3));let Mr=new Float32Array(Nt.length);for(let Tr=0,zr=Nt.length;Tr<zr;)Mr[Tr++]=mt.r,Mr[Tr++]=mt.g,Mr[Tr++]=mt.b;return dr.setAttribute("color",new Xe$1(Mr,3)),dr.setIndex(new ho$1(Gt,1)),lt$1.free_wireframe_data_for_base_level(gt),dr}st.getAttribute("position").copyArray(Nt),st.attributes.position.needsUpdate=!0,lt$1.free_wireframe_data_for_base_level(gt)}static updateCollabMesh(nt,st,mt){let gt=st===0;gt||lt$1.set_destination_refinement_level(nt,st);let _t=mt?lt$1.get_topological_data2(nt,gt?lt$1.Level.CONTROL:lt$1.Level.REFINED,mt.elements):lt$1.get_topological_data(nt,gt?lt$1.Level.CONTROL:lt$1.Level.REFINED),Et=6,At=lt$1.HEAPU32.subarray(_t>>2,(_t>>2)+Et),Rt=At.subarray(3,6),Ft=0,Nt=lt$1.HEAPU32[At[Ft]>>2],Bt=new Float32Array(lt$1.HEAPF32.subarray(Nt>>2,(Nt>>2)+Rt[Ft]));Ft++;let Gt=lt$1.HEAPU32[At[Ft]>>2],dr=new Uint32Array(lt$1.HEAPU32.subarray(Gt>>2,(Gt>>2)+Rt[Ft]));Ft++;let Mr=lt$1.HEAPU32[At[Ft]>>2],Tr=new Uint8Array(lt$1.HEAPU32.subarray(Mr>>2,(Mr>>2)+Rt[Ft]));return lt$1.free_topological_data(_t),{positions:Bt,indices:dr,verticesPerFace:Tr}}},YO=["getX","getY","getZ"];function Uc(nt,st){let mt={},gt=st?st.count:nt.count,_t=0,Et=[],At=[],Rt=1e4;for(let Nt=0;Nt<gt;Nt++){let Bt=st?st.getX(Nt):Nt,Gt="";for(let dr=0;dr<3;dr++)Gt+=`${~~(nt[YO[dr]](Bt)*Rt)},`;if(Gt in mt)Et.push(mt[Gt]);else{for(let dr=0;dr<3;dr++)At.push(nt[YO[dr]](Bt));mt[Gt]=_t,Et.push(_t),_t++}}let Ft=[];for(let Nt=0;Nt<Et.length;Nt+=3)Et[Nt]===Et[Nt+1]||Et[Nt]===Et[Nt+2]||Et[Nt+1]===Et[Nt+2]||Ft.push(Et[Nt],Et[Nt+1],Et[Nt+2]);return{positions:At,triIndices:Ft}}var R0=new E$6,UA=new E$6,zA=new E$6,kA=new E$6;function GA(nt,st,mt,gt){let _t=[],Et=[];if(mt.userData.shape!==void 0&&mt.userData.parameters.depth===0&&mt.userData.shape.shapeHoles.length===0){let Ft=mt.userData.shape.extractShapePointsToFlatArray([]),Nt=mt.userData.parameters.spikes;if(mt.userData.type==="EllipseGeometry"&&Nt<=24&&Nt%4===0&&mt.userData.parameters.angle>=360){let dr=Ft.length/2/Nt;Ft=Ft.filter((Mr,Tr)=>Math.floor(Tr/2)%dr===0)}let Bt=0;for(let dr=0;dr<Ft.length;dr+=2)Bt+=(Ft[dr]-Ft[(dr===0?Ft.length:dr)-2])*(Ft[dr+1]+Ft[(dr===0?Ft.length:dr)-1]);nt.length=0;let Gt=0;if(Bt<0)for(let dr=0;dr<Ft.length;dr+=2)nt.push(Ft[dr],Ft[dr+1],0),_t.push(Gt++);else for(let dr=Ft.length-2;dr>=0;dr-=2)nt.push(Ft[dr],Ft[dr+1],0),_t.push(Gt++);return Et.push(Gt),{indices:_t,verticesPerFace:Et}}let At=new Float32Array([mt.userData.parameters.depth])[0],Rt=0;for(;Rt<st.length;){if(mt.useNgonForTopBottomFaceDuringBake){let Ft=0;if((nt[st[Rt]*3+2]===At||nt[st[Rt]*3+2]===0)&&Ft++,(nt[st[Rt+1]*3+2]===At||nt[st[Rt+1]*3+2]===0)&&Ft++,(nt[st[Rt+2]*3+2]===At||nt[st[Rt+2]*3+2]===0)&&Ft++,Ft===3)break}if(st[Rt+1]===st[Rt+3]&&st[Rt+2]===st[Rt+5]||st[Rt+0]===st[Rt+3]&&st[Rt+2]===st[Rt+4]){R0.set(nt[st[Rt]*3],nt[st[Rt]*3+1],nt[st[Rt]*3+2]),UA.set(nt[st[Rt+1]*3],nt[st[Rt+1]*3+1],nt[st[Rt+1]*3+2]),zA.set(nt[st[Rt+4]*3],nt[st[Rt+4]*3+1],nt[st[Rt+4]*3+2]),kA.set(nt[st[Rt+5]*3],nt[st[Rt+5]*3+1],nt[st[Rt+5]*3+2]),UA.sub(R0).normalize(),zA.sub(R0).normalize(),kA.sub(R0).normalize();let Ft=UA.cross(zA).dot(kA);Math.abs(Ft)>.005||gt&&gt.some((Nt,Bt)=>Bt%2===1?!1:Rt>=gt[Bt]&&Rt<gt[Bt+1])?(_t.push(st[Rt],st[Rt+1],st[Rt+2]),Et.push(3),Rt+=3):(_t.push(st[Rt],st[Rt+1],st[Rt+4],st[Rt+5]),Et.push(4),Rt+=6)}else _t.push(st[Rt],st[Rt+1],st[Rt+2]),Et.push(3),Rt+=3}if(mt.useNgonForTopBottomFaceDuringBake){let Ft=[],Nt=[],Bt=0;for(let Gt=0,dr=0;Gt<nt.length;Gt+=3,dr++)nt[Gt+2]===0&&(Ft.push(dr),Bt++),nt[Gt+2]===At&&Nt.push(dr);if(mt.userData.parameters.extrudeBevelSize===0){let Gt=Nt[0];Nt[0]=Nt[1],Nt[1]=Gt}Ft.reverse(),_t.push(...Ft,...Nt),Et.push(Bt,Bt)}return{indices:_t,verticesPerFace:Et}}var ms={};aF(ms,{calcBoolean:()=>aY,calcBooleanTopological:()=>oY,freeMeshSet:()=>hY,getMeshSet:()=>lY,hasOpenEdges:()=>cY,transformMeshSet:()=>uY});var XO,QO=new Promise(nt=>{XO=nt}),L0;function KO(){if(L0)return L0;async function nt(){let st="https://unpkg.com/@splinetool/boolean-wasm@1.9.30/build",mt=__vitePreload(()=>import("./boolean-BpCokwB2.js"),[]),[gt,_t]=await Promise.all([mt,fetch(`${st}/boolean.wasm`).then(Rt=>Rt.arrayBuffer())]),Et=gt.default,At=await Et({wasmBinary:_t});XO(At)}return L0=nt(),L0}var Tt,Pd;QO.then(nt=>Tt=nt);function sY(nt,st,mt){let gt,_t;nt.userData.parameters.type==="TorusGeometry"&&nt.userData.parameters.arc===Math.PI*2?_t=nt.getClosedTorusIndicesForBooleanOrSubdiv():_t=nt.getIndex();let{positions:Et,triIndices:At}=Uc(nt.getAttribute("position"),_t),Rt;if(st&&mt){let{indices:Ft,verticesPerFace:Nt}=GA(Et,At,nt);Rt=Nt.length,gt=[];for(let Bt=0,Gt=0;Bt<Rt;Bt++){gt.push(Nt[Bt]);for(let dr=0;dr<Nt[Bt];dr++)gt.push(Ft[Gt++])}}else{let Ft=At.length;gt=Array(Ft+Ft/3),Rt=0;for(let Nt=0,Bt=0;Bt<gt.length;)gt[Bt++]=3,Rt++,gt[Bt++]=At[Nt++],gt[Bt++]=At[Nt++],gt[Bt++]=At[Nt++]}return{positions:Et,faceIndices:gt,nFaces:Rt}}function ZO(nt){let st=nt.length,mt=st*Uint32Array.BYTES_PER_ELEMENT,gt=st*Float32Array.BYTES_PER_ELEMENT,_t=Number.isInteger(nt[0])?mt:gt,Et=Tt._malloc(_t);return(Number.isInteger(nt[0])?new Uint32Array(Tt.HEAPU32.buffer,Et,st):new Float32Array(Tt.HEAPF32.buffer,Et,st)).set(nt,0),Et}function JO(nt){switch(nt){case 0:return Tt.OP.UNION;case 1:return Tt.OP.INTERSECTION;case 2:return Tt.OP.A_MINUS_B;case 3:return Tt.OP.B_MINUS_A;case 4:return Tt.OP.SYMMETRIC_DIFFERENCE;case 5:return Tt.OP.ALL;default:throw new Error("Unknown boolean operation "+nt)}}function oY(nt,st){Pd===void 0&&(Pd=Tt.init_csg());let mt=ZO(nt),gt=Tt.csg_calc_topological(Pd,mt,nt.length,JO(st));Tt._free(mt);let _t=6,Et=Tt.HEAPU32.subarray(gt>>2,(gt>>2)+_t),At=Et.subarray(3,6),Rt=0,Ft=Tt.HEAPU32[Et[Rt]>>2],Nt=new Float32Array(Tt.HEAPF32.subarray(Ft>>2,(Ft>>2)+At[Rt]));Rt++;let Bt=Tt.HEAPU32[Et[Rt]>>2],Gt=new Uint32Array(Tt.HEAPU32.subarray(Bt>>2,(Bt>>2)+At[Rt]));Rt++;let dr=Tt.HEAPU32[Et[Rt]>>2],Mr=new Uint8Array(Tt.HEAPU32.subarray(dr>>2,(dr>>2)+At[Rt]));return Tt.free_mesh_data(gt),{positions:Nt,indices:Gt,verticesPerFace:Mr}}function aY(nt,st,mt,gt){Pd===void 0&&(Pd=Tt.init_csg());let _t=ZO(nt),Et=Tt.csg_calc(Pd,_t,nt.length,gt,JO(st));Tt._free(_t);let At=5,Rt=Tt.HEAPU32.subarray(Et>>2,(Et>>2)+At),Ft=Rt.subarray(2,5),Nt=0,Bt=Tt.HEAPU32[Rt[Nt]>>2],Gt=Tt.HEAPF32.subarray(Bt>>2,(Bt>>2)+Ft[Nt]);Nt++;let dr=Tt.HEAPU32[Rt[Nt]>>2],Mr=Tt.HEAPF32.subarray(dr>>2,(dr>>2)+Ft[Nt]);Nt++;let Tr=Ft[Nt];mt.setAttribute("position",new Me$1(Gt,3)),mt.setAttribute("normal",new Me$1(Mr,3));let zr=Tt.HEAPF32.subarray((Et>>2)+5,(Et>>2)+5+6);return mt.boundingSphere===null&&(mt.boundingSphere=new Or),mt.boundingSphere.center.set(zr[0],zr[1],zr[2]),mt.boundingSphere.radius=(zr[3]**2+zr[4]**2+zr[5]**2)**.5,mt.userData.parameters={width:zr[3]*2,height:zr[4]*2,depth:zr[5]*2},Tt.free_mesh_data(Et),Tr}function lY(nt,st,mt){if(Tt===void 0)return-1;let gt,_t,Et;if(st&&nt.userData.positions!==void 0){let Fr=nt.userData;Et=Fr.verticesPerFace.length,gt=Fr.positions,_t=Array(Fr.verticesPerFace.reduce((Nr,tn)=>Nr+tn,0)+Et);for(let Nr=0,tn=0,rn=0;Nr<Fr.verticesPerFace.length;Nr++){_t[rn++]=Fr.verticesPerFace[Nr];for(let Tn=0;Tn<Fr.verticesPerFace[Nr];Tn++)_t[rn++]=Fr.indices[tn++]}}else({positions:gt,faceIndices:_t,nFaces:Et}=sY(nt,st,mt));let At=gt.length,Rt=_t.length,Ft=gt.length,Nt=_t.length,Bt=Ft*Float32Array.BYTES_PER_ELEMENT+Nt*Uint32Array.BYTES_PER_ELEMENT,Gt=Ft*Float32Array.BYTES_PER_ELEMENT,dr=Tt._malloc(Bt),Mr=new Float32Array(Tt.HEAPF32.buffer,dr,Ft),Tr=new Uint32Array(Tt.HEAPU32.buffer,dr+Gt,Nt);Mr.set(gt,0),Tr.set(_t,0);let zr=Tt.get_csg_mesh(dr,At,dr+Gt,Rt,Et);return Tt._free(dr),zr}function cY(nt){return Tt.has_open_edges(nt)}function uY(nt,st){Tt.transform_csg_mesh(nt,st.elements)}function hY(nt){Tt.free_csg_mesh(nt)}var dY={ConeGeometry:qI,CubeGeometry:YI,CylinderGeometry:g0,DodecahedronGeometry:XI,EllipseGeometry:Ad,HelixGeometry:AO,IcosahedronGeometry:EO,LatheGeometry:MO,NonParametricGeometry:_O,PolygonGeometry:C0,PyramidGeometry:DO,RectangleGeometry:Td,SphereGeometry:IO,PlaneGeometry:OO,BackdropGeometry:RO,StarGeometry:P0,TextFrameGeometry:LO,TorusGeometry:BO,TorusKnotGeometry:NO,TriangleGeometry:FO,PathGeometry:UO,VectorGeometry:Rn},VA=nt=>dY[nt.type].create(nt);function _d(nt){return nt!==null&&"booleanOp"in nt}var Dd=class extends md(Ut){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new ue$1}updateVisible(nt){super.updateVisible(nt),this.visible=!_d(this.parent)&&this.visible,_d(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(ms.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(nt=!1){return nt?this.booleanWasTransformed=!0:this.freeBooleanPointer(),_d(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let nt of this.children)nt instanceof Dd&&(nt.freeBooleanPointer(),_d(nt)&&nt.invalidateUpstreamBooleanData())}updateTransformState(nt,st){let mt=super.updateTransformState(nt,st);return mt&&_d(this.parent)&&this.invalidateDownstreamBooleanData(!0),mt}onVariableUpdate(nt=!1){super.onVariableUpdate(nt),_d(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},B0=new jt;function um(nt,st=0,mt=nt.count,gt,_t){let Et=1/0,At=1/0,Rt=1/0,Ft=-1/0,Nt=-1/0,Bt=-1/0;for(let Gt=st;Gt<mt;Gt++){let dr=nt.getX(Gt),Mr=nt.getY(Gt),Tr=nt.getZ(Gt);dr<Et&&(Et=dr),Mr<At&&(At=Mr),Tr<Rt&&(Rt=Tr),dr>Ft&&(Ft=dr),Mr>Nt&&(Nt=Mr),Tr>Bt&&(Bt=Tr)}B0.min.set(Et,At,Rt),B0.max.set(Ft,Nt,Bt),B0.getCenter(gt),B0.getSize(_t).multiplyScalar(.5)}var fY=new _e$1,pY=new on,mr=class extends Dd{constructor(nt,st){super(fY,pY),this.super_Entity(nt,st)}updateState(nt,st){this.updateState_Entity(nt,st)}updateEntityBoxSize(nt,st){let mt=this.geometry.getAttribute("position");mt!==void 0?um(mt,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:mt.count,nt,st):super.updateEntityBoxSize(nt,st)}},Pa=class{constructor(nt){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},Pa.uuidContext===null)throw new Error("plz startContext");Pa.uuidContext===Pa.globalContext?this.uuid="_gid"+Pa.uuidContext.nodeContextUuid++:this.uuid="_uid"+Pa.uuidContext.nodeContextUuid++,this.type=nt,this.name=""}static startContext(nt){this.uuidContext===null||this.uuidContext===Pa.globalContext?this.uuidContext=nt:console.error("Can't start context twice")}static endContext(nt){this.uuidContext!==nt&&console.error("Can't end context twice"),this.uuidContext=null}analyze(nt,st){st=st??{},nt.analyzing=!0,this.build(nt.addFlow(st.slot,st.cache,st.context),"v4"),nt.clearVertexNodeCode(),nt.clearFragmentNodeCode(),nt.removeFlow(),nt.analyzing=!1}analyzeAndFlow(nt,st,mt){return mt=mt??{},this.analyze(nt,mt),this.flow(nt,st,mt)}flow(nt,st,mt){mt=mt??{},nt.addFlow(mt.slot,mt.cache,mt.context);let gt={result:this.build(nt,st),code:nt.clearNodeCode(),extra:nt.context.extra};return nt.removeFlow(),gt}build(nt,st,mt){st=st??this.getType(nt,st);let gt=nt.getNodeData(mt??this);return nt.analyzing&&this.appendDepsNode(nt,gt,st),nt.nodes.indexOf(this)===-1&&nt.nodes.push(this),this.updateFrame!==void 0&&nt.updaters.indexOf(this)===-1&&nt.updaters.push(this),this.generate(nt,st,mt)}updateFrame(nt){}generateReadonly(nt,st,mt,gt,_t,Et){return""}generate(nt,st,mt,gt,_t){return""}parse(nt,st,mt,gt){}appendDepsNode(nt,st,mt){st.deps=(st.deps||0)+1;let gt=nt.getTypeLength(mt);(gt>(st.outputMax||0)||this.getType(nt,mt))&&(st.outputMax=gt,st.output=mt)}setName(nt){this.name=nt}getName(){return this.name}getType(nt,st){return st==="sampler2D"||st==="samplerCube"?st:this.type}},sr=Pa;sr.globalContext={nodeContextUuid:0},sr.uuidContext=Pa.globalContext;var hm=class{constructor(nt){nt=nt??{},this.name=nt.name,this.type=nt.type,this.node=nt.node,this.size=nt.size,this.needsUpdate=nt.needsUpdate}get value(){return this.node.value}set value(nt){this.node.value=nt}},jA=class{constructor(){this.nodes={},this.keywords={}}add(nt){this.nodes[nt.name]=nt}addKeyword(nt,st,mt){mt=mt!==void 0?mt:!0,this.keywords[nt]={callback:st,cache:mt}}remove(nt){delete this.nodes[nt.name]}removeKeyword(nt){delete this.keywords[nt]}get(nt){return this.nodes[nt]}getKeyword(nt,st){return this.keywords[nt].callback(st)}getKeywordData(nt){return this.keywords[nt]}contains(nt){return this.nodes[nt]!==void 0}containsKeyword(nt){return this.keywords[nt]!==void 0}},_i=new jA,tt=class extends sr{constructor(nt,st){super(nt),this.scope="",st=st??{},this.shared=st.shared!==void 0?st.shared:!0,this.unique=st.unique!==void 0?st.unique:!1}build(nt,st,mt,gt){if(st=st??this.getType(nt),this.getShared(nt,st)){let _t=this.getUnique(nt,st);_t&&this.uuid===void 0&&(this.uuid=we$1.generateUUID()),mt=nt.getUUID(mt??this.getUUID(),!_t);let Et=nt.getNodeData(mt),At=Et.output||this.getType(nt);if(nt.analyzing)return(Et.deps||0)>0||this.getLabel()?(this.appendDepsNode(nt,Et,st),this.generate(nt,st,mt)):super.build(nt,st,mt);if(_t)return Et.name=Et.name||super.build(nt,st,mt),Et.name;if(!this.getLabel()&&(!this.getShared(nt,At)||nt.context.ignoreCache||Et.deps===1))return super.build(nt,st,mt);mt=this.getUUID(!1);let Rt=this.getTemp(nt,mt);if(Rt)return nt.format(Rt,At,st);{Rt=super.generate(nt,st,mt,Et.output,gt);let Ft=this.generate(nt,At,mt);return nt.addNodeCode(Rt+" = "+Ft+";"),nt.format(Rt,At,st)}}return super.build(nt,st,mt)}getShared(nt,st){return st!=="sampler2D"&&st!=="samplerCube"&&this.shared}getUnique(nt,st){return this.unique}setLabel(nt){return this.label=nt,this}getLabel(){return this.label}getUUID(nt){let st=this.uuid;return typeof this.scope=="string"&&(st=this.scope+"-"+st),st}getTemp(nt,st){st=st||this.uuid;let mt=nt.getVars()[st];return mt?mt.name:void 0}generate(nt,st,mt,gt,_t){return this.getShared(nt,st)||console.error("TempNode is not shared"),mt=mt??this.uuid,nt.getTempVar(mt,gt??this.getType(nt),_t,this.getLabel()).name}},or=class extends tt{constructor(nt,st){st=st??{},st.shared=st.shared!==void 0?st.shared:!1,super(nt,st),this.readonly=!1}setReadonly(nt){return this.readonly=nt,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(nt,st,mt,gt,_t,Et){mt=nt.getUUID(mt??this.getUUID()),gt=gt??this.getType(nt);let At=nt.getNodeData(mt);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(nt,st,mt,gt,_t,Et):nt.isShader("vertex")?(At.vertex||(At.vertex=nt.createVertexUniform(gt,this,_t,Et,this.getLabel())),nt.format(At.vertex.name,gt,st)):(At.fragment||(At.fragment=nt.createFragmentUniform(gt,this,_t,Et,this.getLabel())),nt.format(At.fragment.name,gt,st))}},Hr=class extends or{constructor(nt=0,st){super("v2"),this.nodeType="Vector2",this.value=nt instanceof U$1?nt:new U$1(nt,st)}get x(){return this.value.x}set x(nt){this.value.x=nt}get y(){return this.value.y}set y(nt){this.value.y=nt}generateReadonly(nt,st,mt,gt,_t,Et){return nt.format("vec2("+this.value.x+", "+this.value.y+")",gt,st)}},Xi=class extends or{constructor(nt=0,st,mt){super("v3"),this.nodeType="Vector3",this.value=nt instanceof E$6?nt:new E$6(nt,st,mt)}get x(){return this.value.x}set x(nt){this.value.x=nt}get y(){return this.value.y}set y(nt){this.value.y=nt}get z(){return this.value.z}set z(nt){this.value.z=nt}generateReadonly(nt,st,mt,gt,_t,Et){return nt.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",gt,st)}},vr=class extends We$1{constructor(nt,st,mt,gt){super(nt,st,mt),this.isColorA=!0,this.a=gt}setRGBA(nt,st,mt,gt){super.setRGB(nt,st,mt),this.a=gt}copy(nt){return super.copy(nt),this.a="a"in nt?nt.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(nt){return super.equals(nt)&&this.a===nt.a}setStyle(nt,st="srgb"){let mt;if(nt==="transparent")return this.setRGBA(0,0,0,0),this;if(mt=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(nt)){let gt,_t=mt[1],Et=mt[2];switch(_t){case"rgb":case"rgba":if(gt=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(Et))return this.a=_t==="rgba"?parseFloat(gt[4]):1,super.setStyle(nt,st);break;case"hsl":case"hsla":if(gt=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(Et))return this.a=_t==="hsla"?parseFloat(gt[4]):1,super.setStyle(nt,st);break}}return super.setStyle(nt,st)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(nt){this.r=nt}set y(nt){this.g=nt}set z(nt){this.b=nt}set w(nt){this.a=nt}},Ln=class extends or{constructor(nt){super("v4"),this.nodeType="Vector4",this.value=nt instanceof vr?nt:new vr(nt.r,nt.g,nt.b,nt.a)}generateReadonly(nt,st,mt,gt,_t,Et){return nt.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",gt,st)}},mY=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,$O=/[a-z_0-9]+/gi,Ee$1=class extends tt{constructor(st,mt,gt,_t,Et){super(Et),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=Et===void 0,this.isInterface=!1,this.parse(st,mt,gt,_t)}getShared(st,mt){return!this.isMethod}getType(st){return st.getTypeByFormat(this.type)}getInputByName(st){if(this.inputs){let mt=this.inputs.length;for(;mt--;)if(this.inputs[mt].name===st)return this.inputs[mt]}}getIncludeByName(st){if(this.includes){let mt=this.includes.length;for(;mt--;)if(this.includes[mt].name===st)return this.includes[mt]}}generate(st,mt,gt,_t,Et){let At,Rt=0,Ft=this.src;if(this.includes)for(let Bt=0;Bt<this.includes.length;Bt++)st.include(this.includes[Bt],this);for(let Bt in this.extensions)st.extensions[Bt]=!0;let Nt=[];for(;At=$O.exec(this.src);)Nt.push(At);for(let Bt=0;Bt<Nt.length;Bt++){let Gt=Nt[Bt],dr=Gt[0],Mr=this.isMethod?!this.getInputByName(dr):!0,Tr=dr;if(this.keywords[dr]||this.useKeywords&&Mr&&_i.containsKeyword(dr)){let zr=this.keywords[dr];if(!zr){let Fr=_i.getKeywordData(dr);Fr.cache&&(zr=st.keywords[dr]),zr=zr||_i.getKeyword(dr,st),Fr.cache&&(st.keywords[dr]=zr)}Tr=zr.build(st)}dr!==Tr&&Ft[Gt.index+Rt-1]!=="."&&(Ft=Ft.substring(0,Gt.index+Rt)+Tr+Ft.substring(Gt.index+dr.length+Rt),Rt+=Tr.length-dr.length),this.getIncludeByName(Tr)===void 0&&_i.contains(Tr)&&st.include(_i.get(Tr))}return mt==="source"?Ft:this.isMethod?(this.isInterface||st.include(this,void 0,Ft),this.name):st.format("( "+Ft+" )",this.getType(st),mt)}parse(st,mt,gt,_t){if(this.src=st||"",this.includes=mt??[],this.extensions=gt??{},this.keywords=_t??{},this.isMethod){let Et=mY.exec(this.src);if(this.inputs=[],Et&&Et.length==4){this.type=Et[1],this.name=Et[2];let At=Et[3].match($O);if(At){let Rt=0;for(;Rt<At.length;){let Ft=At[Rt++],Nt;Ft==="in"||Ft==="out"||Ft==="inout"?Nt=At[Rt++]:(Nt=Ft,Ft="");let Bt=At[Rt++];this.inputs.push({name:Bt,type:Nt,qualifier:Ft})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},gY=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,HA=class extends tt{constructor(nt="",st){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(nt||HA.PI,void 0,void 0,void 0,st)}getType(nt){return nt.getTypeByFormat(this.type)}parse(nt,st,mt,gt,_t){this.src=nt||"";let Et,At,Rt="",Ft=gY.exec(nt);this.useDefine=_t??this.src.charAt(0)==="#",Ft&&Ft.length>1?(At=Ft[1],Et=Ft[2],Rt=Ft[3]):(Et=this.src,At="f"),this.name=Et,this.type=At,this.value=Rt}build(nt,st){if(st==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return nt.include(this),nt.format(this.name,this.getType(nt),st)}generate(nt,st,mt,gt,_t){return nt.format(this.name,this.getType(nt),st)}},Wt=HA;Wt.PI="PI",Wt.PI2="PI2",Wt.RECIPROCAL_PI="RECIPROCAL_PI",Wt.RECIPROCAL_PI2="RECIPROCAL_PI2",Wt.LOG2="LOG2",Wt.EPSILON="EPSILON";var yY=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),vY=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),Id=class extends tt{constructor(nt=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(nt)}getType(nt){return nt.getTypeByFormat(this.name)}getInputByName(nt){let st=this.inputs.length;for(;st--;)if(this.inputs[st].name===nt)return this.inputs[st]}generate(nt,st,mt,gt,_t){return st==="source"?this.src+";":nt.format("( "+this.src+" )",this.getType(nt),st)}parse(nt=""){this.src=nt,this.inputs=[];let st=yY.exec(nt);if(st){let mt=st[2],gt;for(;gt=vY.exec(mt);)this.inputs.push({type:gt[1],name:gt[2]});this.name=st[1]}else this.name="";this.type=this.name}},Od=class extends tt{constructor(nt){super("v2",{shared:!1}),this.nodeType="UV",this.index=nt??0}generate(nt,st){nt.requires.uv[this.index]=!0;let mt=this.index>0?this.index+1:"",gt=nt.isShader("vertex")?"uv"+mt:"vUv"+mt;return nt.format(gt,this.getType(nt),st)}};_i.addKeyword("uv",function(){return new Od});_i.addKeyword("uv2",function(){return new Od(1)});var zc=class extends tt{constructor(nt,st){super("v4"),this.nodeType="ColorSpace",this.input=nt,this.method=st??zc.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(nt){switch(nt){case mn:return["Linear"];case at$1:return["sRGB"];default:return[]}}generate(nt,st){var At;let mt=this.input.build(nt,"v4"),gt=this.getType(nt),_t=zc.Nodes[this.method],Et=nt.include(_t);if(Et===zc.LINEAR_TO_LINEAR)return nt.format(mt,gt,st);if(((At=_t.inputs)==null?void 0:At.length)===2){let Rt=this.factor.build(nt,"f");return nt.format(Et+"( "+mt+", "+Rt+" )",gt,st)}else return nt.format(Et+"( "+mt+" )",gt,st)}fromEncoding(nt){let st=zc.getEncodingComponents(nt);this.method="LinearTo"+st[0],this.factor=st[1]}fromDecoding(nt){let st=zc.getEncodingComponents(nt);this.method=st[0]+"ToLinear",this.factor=st[1]}},xn=zc;xn.Nodes={LinearToLinear:new Ee$1(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new Ee$1(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new Ee$1(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},xn.LINEAR_TO_LINEAR="LinearToLinear",xn.SRGB_TO_LINEAR="sRGBToLinear",xn.LINEAR_TO_SRGB="LinearTosRGB";var Yt=class extends Ee$1{constructor(nt="",st,mt,gt,_t){super(nt,_t,gt,mt,st),this.nodeType="Expression"}},bn=class extends or{constructor(nt=new $t,st,mt,gt){super("v4",{shared:!0}),this.nodeType="Texture",this.value=nt,this.uv=st??new Od,this.bias=mt,this.project=gt!==void 0?gt:!1}getTexture(nt,st){return super.generate(nt,st,this.value.uuid,"t")}generate(nt,st){if(st==="sampler2D")return this.getTexture(nt,st);let mt=this.getTexture(nt,st),gt=this.uv.build(nt,this.project?"v4":"v2"),_t=this.bias?this.bias.build(nt,"f"):void 0;_t===void 0&&nt.context.bias&&(_t=nt.context.bias.setTexture(this).build(nt,"f"));let Et,At;this.project?Et="texture2DProj":Et=_t?"tex2DBias":"tex2D",_t?At=Et+"( "+mt+", "+gt+", "+_t+" )":At=Et+"( "+mt+", "+gt+" )";let Rt={include:nt.isShader("vertex"),ignoreCache:!0},Ft=this.getType(nt);return nt.addContext(Rt),this.colorSpace=this.colorSpace??new xn(new Yt("",Ft)),this.colorSpace.fromDecoding(nt.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(At),At=this.colorSpace.build(nt,Ft),nt.removeContext(),nt.format(At,Ft,st)}},Fe$1=class extends or{constructor(st){super("f"),this.nodeType="Float",this.value=st??0}generateReadonly(st,mt,gt,_t,Et,At){return st.format(this.value+(this.value%1?"":".0"),_t,mt)}},dm=class extends tt{constructor(nt,st){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=nt,this.inputs=st??[]}getFunction(){return this.value}getType(nt){return this.value.getType(nt)}generate(nt,st,mt,gt,_t){gt=this.getType(nt);let Et=this.value,At=Et.build(nt,st)+"( ",Rt=[];if(Et.inputs){for(let Ft=0;Ft<Et.inputs.length;Ft++){let Nt=Et.inputs[Ft],Bt=this.inputs[Ft]||this.inputs[Nt.name];Rt.push(Bt.build(nt,nt.getTypeByFormat(Nt.type)))}At+=Rt.join(", ")+" )"}return nt.format(At,gt,st)}},WA=class extends tt{constructor(nt,st,mt=WA.ADD){super(),this.nodeType="Operator",this.type=nt.type,this.a=nt,this.b=st,this.op=mt}getType(nt){let st=this.a.getType(nt),mt=this.b.getType(nt);return nt.isTypeMatrix(st)?"v4":nt.getTypeLength(mt)>nt.getTypeLength(st)?mt:st}generate(nt,st){let mt=this.getType(nt);this.type=mt;let gt=this.a.build(nt,mt),_t=this.b.build(nt,mt);return nt.format("( "+gt+" "+this.op+" "+_t+" )",mt,st)}},Ui=WA;Ui.ADD="+",Ui.SUB="-",Ui.MUL="*",Ui.DIV="/";var ar=class extends tt{constructor(nt,st=ar.ABS,mt,gt){super(),this.nodeType="Math",this.a=nt,typeof st!="string"?this.b=st:gt=st,typeof mt!="string"?this.c=mt:gt=mt,this.method=gt,this.hashProperties=["method"]}getNumInputs(nt){switch(this.method){case ar.MIX:case ar.CLAMP:case ar.REFRACT:case ar.SMOOTHSTEP:case ar.FACEFORWARD:return 3;case ar.MIN:case ar.MAX:case ar.MOD:case ar.STEP:case ar.REFLECT:case ar.DISTANCE:case ar.DOT:case ar.CROSS:case ar.POW:return 2;default:return 1}}getInputType(nt){let st=nt.getTypeLength(this.a.getType(nt)),mt=this.b?nt.getTypeLength(this.b.getType(nt)):0,gt=this.c?nt.getTypeLength(this.c.getType(nt)):0;return st>mt&&st>gt?this.a.getType(nt):mt>gt?this.b.getType(nt):this.c.getType(nt)}getType(nt){switch(this.method){case ar.LENGTH:case ar.DISTANCE:case ar.DOT:return"f";case ar.CROSS:return"v3"}return this.getInputType(nt)}generate(nt,st){let mt,gt,_t,Et=this.a?nt.getTypeLength(this.a.getType(nt)):0,At=this.b?nt.getTypeLength(this.b.getType(nt)):0,Rt=this.c?nt.getTypeLength(this.c.getType(nt)):0,Ft=this.getInputType(nt),Nt=this.getType(nt);switch(this.type=Nt,this.method){case ar.NEGATE:return nt.format("( -"+this.a.build(nt,Ft)+" )",Ft,st);case ar.INVERT:return nt.format("( 1.0 - "+this.a.build(nt,Ft)+" )",Ft,st);case ar.CROSS:mt=this.a.build(nt,"v3"),gt=this.b.build(nt,"v3");break;case ar.STEP:mt=this.a.build(nt,Et===1?"f":Ft),gt=this.b.build(nt,Ft);break;case ar.MIN:case ar.MAX:case ar.MOD:mt=this.a.build(nt,Ft),gt=this.b.build(nt,At===1?"f":Ft);break;case ar.REFRACT:mt=this.a.build(nt,Ft),gt=this.b.build(nt,Ft),_t=this.c.build(nt,"f");break;case ar.MIX:mt=this.a.build(nt,Ft),gt=this.b.build(nt,Ft),_t=this.c.build(nt,Rt===1?"f":Ft);break;default:mt=this.a.build(nt,Ft),this.b&&(gt=this.b.build(nt,Ft)),this.c&&(_t=this.c.build(nt,Ft));break}let Bt=[];Bt.push(mt),gt&&Bt.push(gt),_t&&Bt.push(_t);let Gt=this.getNumInputs(nt);if(Bt.length!==Gt)throw Error(`Arguments not match used in "${this.method}". Require ${Gt}, currently ${Bt.length}.`);return nt.format(this.method+"( "+Bt.join(", ")+" )",Nt,st)}},ft$1=ar;ft$1.RAD="radians",ft$1.DEG="degrees",ft$1.EXP="exp",ft$1.EXP2="exp2",ft$1.LOG="log",ft$1.LOG2="log2",ft$1.SQRT="sqrt",ft$1.INV_SQRT="inversesqrt",ft$1.FLOOR="floor",ft$1.CEIL="ceil",ft$1.NORMALIZE="normalize",ft$1.FRACT="fract",ft$1.SATURATE="saturate",ft$1.SIN="sin",ft$1.COS="cos",ft$1.TAN="tan",ft$1.ASIN="asin",ft$1.ACOS="acos",ft$1.ARCTAN="atan",ft$1.ABS="abs",ft$1.SIGN="sign",ft$1.LENGTH="length",ft$1.NEGATE="negate",ft$1.INVERT="invert",ft$1.MIN="min",ft$1.MAX="max",ft$1.MOD="mod",ft$1.STEP="step",ft$1.REFLECT="reflect",ft$1.DISTANCE="distance",ft$1.DOT="dot",ft$1.CROSS="cross",ft$1.POW="pow",ft$1.MIX="mix",ft$1.CLAMP="clamp",ft$1.REFRACT="refract",ft$1.SMOOTHSTEP="smoothstep",ft$1.FACEFORWARD="faceforward";var Rd=class extends tt{constructor(nt,st,mt){super("v4"),this.nodeType="TextureCubeUV",this.value=nt,this.uv=st,this.bias=mt}bilinearCubeUV(nt,st,mt,gt){let _t=new dm(Rd.Nodes.bilinearCubeUV,[st,mt,gt]);this.colorSpaceTL=this.colorSpaceTL??new xn(new Yt("","v4")),this.colorSpaceTL.fromDecoding(nt.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(_t.build(nt)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new xn(new Yt("","v4")),this.colorSpaceTR.fromDecoding(nt.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(_t.build(nt)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new xn(new Yt("","v4")),this.colorSpaceBL.fromDecoding(nt.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(_t.build(nt)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new xn(new Yt("","v4")),this.colorSpaceBR.fromDecoding(nt.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(_t.build(nt)+".br");let Et={include:nt.isShader("vertex"),ignoreCache:!0};nt.addContext(Et),this.colorSpaceTLExp=new Yt(this.colorSpaceTL.build(nt,"v4"),"v4"),this.colorSpaceTRExp=new Yt(this.colorSpaceTR.build(nt,"v4"),"v4"),this.colorSpaceBLExp=new Yt(this.colorSpaceBL.build(nt,"v4"),"v4"),this.colorSpaceBRExp=new Yt(this.colorSpaceBR.build(nt,"v4"),"v4"),nt.removeContext();let At=new Yt("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return At.keywords.cubeUV_TL=this.colorSpaceTLExp,At.keywords.cubeUV_TR=this.colorSpaceTRExp,At.keywords.cubeUV_BL=this.colorSpaceBLExp,At.keywords.cubeUV_BR=this.colorSpaceBRExp,At.keywords.cubeUV=_t,At}generate(nt,st){if(nt.isShader("fragment")){let mt=this.uv,gt=this.bias||nt.context.roughness,_t=new dm(Rd.Nodes.roughnessToMip,[gt]),Et=new ft$1(_t,Rd.Nodes.m0,Rd.Nodes.cubeUV_maxMipLevel,ft$1.CLAMP),At=new ft$1(Et,ft$1.FLOOR),Rt=new ft$1(Et,ft$1.FRACT),Ft=this.bilinearCubeUV(nt,this.value,mt,At),Nt=this.bilinearCubeUV(nt,this.value,mt,new Ui(At,new Fe$1(1).setReadonly(!0),Ui.ADD)),Bt=new ft$1(Ft,Nt,Rt,ft$1.MIX);return nt.format(Bt.build(nt),"v4",st)}else return console.warn("TextureCubeUVNode is not compatible with "+nt.shader+" shader."),nt.format("vec4( 0.0 )",this.getType(nt),st)}},Ld=Rd;Ld.Nodes=function(){let nt=new Id(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),st=new Wt("float cubeUV_maxMipLevel 8.0",!0),mt=new Wt("float cubeUV_minMipLevel 4.0",!0),gt=new Wt("float cubeUV_maxTileSize 256.0",!0),_t=new Wt("float cubeUV_minTileSize 16.0",!0),Et=new Ee$1(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);Et.useKeywords=!1;let At=new Ee$1(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);At.useKeywords=!1;let Rt=new Ee$1(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[nt,Et,At,st,mt,gt,_t]);Rt.useKeywords=!1;let Ft=new Wt("float r0 1.0",!0),Nt=new Wt("float v0 0.339",!0),Bt=new Wt("float m0 -2.0",!0),Gt=new Wt("float r1 0.8",!0),dr=new Wt("float v1 0.276",!0),Mr=new Wt("float m1 -1.0",!0),Tr=new Wt("float r4 0.4",!0),zr=new Wt("float v4 0.046",!0),Fr=new Wt("float m4 2.0",!0),Nr=new Wt("float r5 0.305",!0),tn=new Wt("float v5 0.016",!0),rn=new Wt("float m5 3.0",!0),Tn=new Wt("float r6 0.21",!0),$n=new Wt("float v6 0.0038",!0),un=new Wt("float m6 4.0",!0),es=[Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr,Nr,tn,rn,Tn,$n,un],kn=new Ee$1(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,es);return{bilinearCubeUV:Rt,roughnessToMip:kn,m0:Bt,cubeUV_maxMipLevel:st}}();var kc=class extends tt{constructor(nt){super("v3"),this.nodeType="Normal",this.scope=nt??kc.VIEW}getShared(){return this.scope===kc.WORLD}build(nt,st,mt,gt){let _t=nt.context[this.scope+"Normal"];return _t?_t.build(nt,st,mt,gt):super.build(nt,st,mt)}generate(nt,st,mt,gt,_t){let Et;switch(this.scope){case kc.VIEW:nt.isShader("vertex")?Et="transformedNormal":Et="geometryNormal";break;case kc.LOCAL:nt.isShader("vertex")?Et="objectNormal":(nt.requires.normal=!0,Et="vObjectNormal");break;case kc.WORLD:nt.isShader("vertex")?Et="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(nt.requires.worldNormal=!0,Et="vWNormal");break}return nt.format(Et,this.getType(nt),st)}},zi=kc;zi.LOCAL="local",zi.WORLD="world",zi.VIEW="view",zi.NORMAL="normal";_i.addKeyword("viewNormal",function(){return new zi(zi.VIEW)});_i.addKeyword("localNormal",function(){return new zi(zi.NORMAL)});_i.addKeyword("worldNormal",function(){return new zi(zi.WORLD)});var Oo=class extends tt{constructor(nt){super("v3"),this.nodeType="Position",this.scope=nt??Oo.LOCAL}getType(){switch(this.scope){case Oo.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Oo.LOCAL:case Oo.WORLD:return!1}return!0}generate(nt,st,mt,gt,_t){let Et;switch(this.scope){case Oo.LOCAL:nt.isShader("vertex")?Et="transformed":(nt.requires.position=!0,Et="vPosition");break;case Oo.WORLD:if(nt.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";nt.requires.worldPosition=!0,Et="vWPosition";break;case Oo.VIEW:Et=nt.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Oo.PROJECTION:Et=nt.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return nt.format(Et,this.getType(),st)}},Bn=Oo;Bn.LOCAL="local",Bn.WORLD="world",Bn.VIEW="view",Bn.PROJECTION="projection";_i.addKeyword("position",function(){return new Bn});_i.addKeyword("worldPosition",function(){return new Bn(Bn.WORLD)});_i.addKeyword("viewPosition",function(){return new Bn(Bn.VIEW)});var qs=class extends tt{constructor(nt){super("v3"),this.nodeType="Reflect",this.scope=nt??qs.CUBE}getUnique(nt){return!nt.context.viewNormal}getType(){switch(this.scope){case qs.SPHERE:return"v2"}return this.type}generate(nt,st){let mt=this.getUnique(nt);if(nt.isShader("fragment")){let gt;switch(this.scope){case qs.VECTOR:{let _t=new zi(zi.VIEW),Et=nt.context.roughness,At=_t.build(nt,"v3"),Rt=new Bn(Bn.VIEW).build(nt,"v3"),Ft=Et?Et.build(nt,"f"):void 0,Nt=`reflect( -normalize( ${Rt} ), ${At} )`;Ft&&(Nt=`normalize( mix( ${Nt}, ${At}, ${Ft} * ${Ft} ) )`);let Bt=`inverseTransformDirection( ${Nt}, viewMatrix )`;mt?(nt.addNodeCode(`vec3 reflectVec = ${Bt};`),gt="reflectVec"):gt=Bt;break}case qs.CUBE:{let _t=new qs(qs.VECTOR).build(nt,"v3"),Et="vec3( -"+_t+".x, "+_t+".yz )";mt?(nt.addNodeCode(`vec3 reflectCubeVec = ${Et};`),gt="reflectCubeVec"):gt=Et;break}case qs.SPHERE:{let _t="normalize( ( viewMatrix * vec4( "+new qs(qs.VECTOR).build(nt,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";mt?(nt.addNodeCode(`vec2 reflectSphereVec = ${_t};`),gt="reflectSphereVec"):gt=_t;break}}return nt.format(gt,this.getType(),st)}else return console.warn("ReflectNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.type,st)}},Ro=qs;Ro.CUBE="cube",Ro.SPHERE="sphere",Ro.VECTOR="vector";var N0=class extends tt{constructor(nt=new bn,st,mt){super("v4"),this.nodeType="TextureCube",this.value=nt,this.radianceNode=new Ld(this.value,st??new Ro(Ro.VECTOR),mt),this.irradianceNode=new Ld(this.value,new zi(zi.WORLD),new Fe$1(1).setReadonly(!0))}generate(nt,st){return nt.isShader("fragment")?(nt.require("irradiance"),nt.context.bias&&nt.context.bias.setTexture(this.value),(nt.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(nt,st)):(console.warn("TextureCubeNode is not compatible with "+nt.shader+" shader."),nt.format("vec4( 0.0 )",this.getType(nt),st))}},F0=class extends or{constructor(nt=new Ru,st,mt){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=nt,this.uv=st??new Ro,this.bias=mt}getTexture(nt,st){return super.generate(nt,st,this.value.uuid,"tc")}generate(nt,st){var Ft;if(st==="samplerCube")return this.getTexture(nt,st);let mt=this.getTexture(nt,st),gt=(Ft=this.uv)==null?void 0:Ft.build(nt,"v3"),_t=this.bias?this.bias.build(nt,"f"):void 0;_t===void 0&&nt.context.bias&&(_t=nt.context.bias.setTexture(this).build(nt,"f"));let Et;_t?Et="texCubeBias( "+mt+", "+gt+", "+_t+" )":Et="texCube( "+mt+", "+gt+" )";let At={include:nt.isShader("vertex"),ignoreCache:!0},Rt=this.getType(nt);return nt.addContext(At),this.colorSpace=this.colorSpace??new xn(new Yt("",Rt)),this.colorSpace.fromDecoding(nt.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(Et),Et=this.colorSpace.build(nt,Rt),nt.removeContext(),nt.format(Et,Rt,st)}},eR=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,tR=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,rR=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,iR=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,nR=`
layout(location = 1) out vec4 gVelocity;
`,sR=`
    // Discard fully transparent pixels 
    if (gl_FragColor.a <= 0.0) discard;

    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);
`,oR=["x","y","z","w"],xY=["float","vec2","vec3","vec4"],bY={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},SY={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},Bd=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function nt(st,mt){return st.deps.length-mt.deps.length}return function(st,mt){let gt=this.getIncludes(st,mt);if(!gt)return"";let _t="";gt=gt.sort(nt);for(let Et=0;Et<gt.length;Et++)gt[Et].src&&(_t+=gt[Et].src+`
`);return _t}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(nt,st){this.addVertexParsCode(eR),this.addFragmentParsCode(tR),this.buildShader("vertex",nt),this.buildShader("fragment",st);for(let mt=0;mt<this.requires.uv.length;mt++)if(this.requires.uv[mt]){let gt=mt>0?mt+1:"";this.addVaryCode("varying vec2 vUv"+gt+";"),mt>0&&this.addVertexParsCode("attribute vec2 uv"+gt+";"),this.addVertexFinalCode("vUv"+gt+" = uv"+gt+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(rR),this.addFragmentFinalCode(iR)),this}buildShader(nt,st){this.resultCode[nt]=st.build(this.setShader(nt),"v4")}setMaterial(nt,st){return this.defines={},this}addFlow(nt,st,mt){return this.addSlot(nt).addCache(st).addContext(mt)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(nt){return this.cache=nt??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(nt){return this.context=Object.assign({},this.context,nt),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(nt){return this.slot=nt||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(nt,st){this.fragmentVariables[nt]===void 0&&(this.addFragmentCode(`${st} ${nt};`),this.fragmentVariables[nt]="")}addFragmentParsVariable(nt,st){this.fragmentParsVariables[nt]===void 0&&(this.addFragmentParsCode(`${st} ${nt};`),this.fragmentParsVariables[nt]="")}addVertexParsVariable(nt,st){this.vertexParsVariables[nt]===void 0&&(this.addVertexParsCode(`${st} ${nt};`),this.vertexParsVariables[nt]="")}addVertexCode(nt){this.addCode(nt,"vertex")}addFragmentCode(nt){this.addCode(nt,"fragment")}addCode(nt,st){this.code[st??this.shader]+=nt+`
`}addVertexNodeCode(nt){this.addNodeCode(nt,"vertex")}addFragmentNodeCode(nt){this.addNodeCode(nt,"fragment")}addNodeCode(nt,st){this.nodeCode[st??this.shader]+=nt+`
`}clearNodeCode(nt){nt=nt??this.shader;let st=this.nodeCode[nt];return this.nodeCode[nt]="",st}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(nt){this.addFinalCode(nt,"vertex")}addFragmentFinalCode(nt){this.addFinalCode(nt,"fragment")}addFinalCode(nt,st){this.finalCode[st??this.shader]+=nt+`
`}addVertexParsCode(nt){this.addParsCode(nt,"vertex")}addFragmentParsCode(nt){this.addParsCode(nt,"fragment")}addParsCode(nt,st){this.parsCode[st??this.shader]+=nt+`
`}addVaryCode(nt){this.addVertexParsCode(nt),this.addFragmentParsCode(nt)}isCache(nt){return this.caches.indexOf(nt)!==-1}isSlot(nt){return this.slots.indexOf(nt)!==-1}define(nt,st){this.defines[nt]=st===void 0?1:st}require(nt){this.requires[nt]=!0}isDefined(nt){return this.defines[nt]!==void 0}getVar(nt,st,mt,gt="varying",_t="V",Et=""){let At=this.getVars(gt),Rt=At[nt];if(!Rt){let Ft=At.length;Rt={name:mt||"node"+_t+Ft+(Et?"_"+Et:""),type:st},At.push(Rt),At[nt]=Rt}return Rt}getTempVar(nt,st,mt,gt){return this.getVar(nt,st,mt,this.shader,"T",gt)}getAttribute(nt,st){if(!this.attributes[nt]){let mt=this.getVar(nt,st);this.addVertexParsCode("attribute "+st+" "+nt+";"),this.addVertexFinalCode(mt.name+" = "+nt+";"),this.attributes[nt]={varying:mt,name:nt,type:st}}return this.attributes[nt]}getCode(nt){return[this.prefixCode,this.parsCode[nt],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[nt],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[nt],"uniform"),this.getIncludesCode("consts",nt),this.getIncludesCode("structs",nt),this.getIncludesCode("functions",nt),"void main() {",this.getVarListCode(this.getVars(nt)),this.code[nt],this.resultCode[nt],this.finalCode[nt],"}"].join(`
`)}getVarListCode(nt,st){st=st??"";let mt="";for(let gt=0,_t=nt.length;gt<_t;++gt){let Et=nt[gt],At=Et.type,Rt=Et.name,Ft=Et.size,Nt=this.getFormatByType(At);if(Nt===void 0)throw new Error("Node pars "+Nt+" not found.");Nt.includes("[]")?mt+=st+" "+Nt.substring(0,Nt.length-2)+" "+Rt+`[${Ft}];
`:mt+=st+" "+Nt+" "+Rt+`;
`}return mt}getVars(nt){return this.inputs.vars[nt??this.shader]}getNodeData(nt){let st=nt instanceof sr?nt.uuid:nt;return this.nodeData[st]=this.nodeData[st]||{}}createUniform(nt,st,mt,gt,_t,Et){if(st.includes("[]")){let At=this.inputs.arrayUniforms,Rt=At.list.length,Ft=new hm({type:st,size:mt.size,name:gt||"nodeUA"+Rt+(Et?"_"+Et:""),node:mt,needsUpdate:_t});return At.list.push(Ft),At[nt].push(Ft),At[nt][Ft.name]=Ft,this.uniforms[Ft.name]=Ft,Ft}else{let At=this.inputs.uniforms,Rt=At.list.length,Ft=new hm({type:st,name:gt||"nodeU"+Rt+(Et?"_"+Et:""),node:mt,needsUpdate:_t});return At.list.push(Ft),At[nt].push(Ft),At[nt][Ft.name]=Ft,this.uniforms[Ft.name]=Ft,Ft}}createVertexUniform(nt,st,mt,gt,_t){return this.createUniform("vertex",nt,st,mt,gt,_t)}createFragmentUniform(nt,st,mt,gt,_t){return this.createUniform("fragment",nt,st,mt,gt,_t)}include(nt,st,mt){var Et;let gt;if(nt=typeof nt=="string"?_i.get(nt):nt,this.context.include===!1)return nt.name;nt instanceof Ee$1?gt=this.includes.functions:nt instanceof Wt?gt=this.includes.consts:nt instanceof Id&&(gt=this.includes.structs);let _t=gt[this.shader]=gt[this.shader]||[];if(nt){let At=_t[nt.name];if(At||(At=_t[nt.name]={node:nt,deps:[]},_t.push(At),At.src=nt.build(this,"source")),nt instanceof Ee$1&&st&&_t[st.name]&&_t[st.name].deps.indexOf(nt)===-1&&(_t[st.name].deps.push(nt),(Et=nt.includes)==null?void 0:Et.length)){let Rt=0;do this.include(nt.includes[Rt++],st);while(Rt<nt.includes.length)}return mt&&(At.src=mt),nt.name}else throw new Error("Include not found.")}colorToVectorProperties(nt){return nt.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(nt){return nt.replace(/c/g,"v3")}getIncludes(nt,st){return this.includes[nt][st||this.shader]}getConstructorFromLength(nt){return xY[nt-1]}isTypeMatrix(nt){return/^m/.test(nt)}getTypeLength(nt){return nt==="f"?1:parseInt(this.colorToVector(nt).substr(1))}getTypeFromLength(nt){return nt===1?"f":"v"+nt}findNode(...nt){for(let st=0;st<arguments.length;st++){let mt=nt[st];if(mt!=null&&mt.isNode)return mt}}resolve(...nt){for(let st=0;st<arguments.length;st++){let mt=nt[st];if(mt!==void 0){if(mt.isNode)return mt;if(mt.isTexture)switch(mt.mapping){case Qa:case Ka:return new F0(mt);case Zu:return new N0(new bn(mt));default:return new bn(mt)}else{if(mt.isVector2)return new Hr(mt);if(mt.isVector3)return new Xi(mt);if(mt.isVector4)return new Ln(mt)}}}}format(nt,st,mt){switch(this.colorToVector(mt+" <- "+st)){case"f <- v2":return nt+".x";case"f <- v3":return nt+".x";case"f <- v4":return nt+".x";case"f <- i":case"f <- b":return"float( "+nt+" )";case"v2 <- f":return"vec2( "+nt+" )";case"v2 <- v3":return nt+".xy";case"v2 <- v4":return nt+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+nt+" ) )";case"v3 <- f":return"vec3( "+nt+" )";case"v3 <- v2":return"vec3( "+nt+", 0.0 )";case"v3 <- v4":return nt+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+nt+" ) )";case"v4 <- f":return"vec4( "+nt+" )";case"v4 <- v2":return"vec4( "+nt+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+nt+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+nt+" ) )";case"i <- f":case"i <- b":return"int( "+nt+" )";case"i <- v2":return"int( "+nt+".x )";case"i <- v3":return"int( "+nt+".x )";case"i <- v4":return"int( "+nt+".x )";case"b <- f":return"( "+nt+" != 0.0 )";case"b <- v2":return"( "+nt+" != vec2( 0.0 ) )";case"b <- v3":return"( "+nt+" != vec3( 0.0 ) )";case"b <- v4":return"( "+nt+" != vec4( 0.0 ) )";case"b <- i":return"( "+nt+" != 0 )"}return nt}getTypeByFormat(nt){return bY[nt]||nt}getFormatByType(nt){return SY[nt]||nt}getUUID(nt,st){return st=st!==void 0?st:!0,st&&this.cache&&(nt=this.cache+"-"+nt),nt}getElementByIndex(nt){return oR[nt]}getIndexByElement(nt){return oR.indexOf(nt)}isShader(nt){return this.shader===nt}setShader(nt){return this.shader=nt,this}mergeDefines(nt){for(let st in nt)this.defines[st]=nt[st];return this.defines}mergeUniform(nt){for(let st in nt)this.uniforms[st]=nt[st];return this.uniforms}getTextureEncodingFromMap(nt){let st;return nt?nt.isTexture&&(st=nt.encoding):st=mn,st===mn&&this.context.gamma&&(st=at$1),st}},er=class extends or{constructor(nt=0,st,mt,gt){super("c"),this.nodeType="Color",this.value=nt instanceof vr?nt:new vr(nt||0,st,mt,gt)}setRGBA(nt){this.value.setRGBA(nt.r,nt.g,nt.b,nt.a)}generate(nt,st,mt,gt,_t,Et){mt=nt.getUUID(mt??this.getUUID()),gt=gt??this.getType(nt);let At=nt.getNodeData(mt),Rt=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let Ft=this.alpha.build(nt,"f");nt.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${Ft};`)}return Rt?this.generateReadonly(nt,st,mt,gt,_t,Et):nt.isShader("vertex")?(At.vertex||(At.vertex=nt.createVertexUniform(gt,this,_t,Et,this.getLabel())),nt.format(At.vertex.name,gt,st)):(At.fragment||(At.fragment=nt.createFragmentUniform(gt,this,_t,Et,this.getLabel())),nt.format(At.fragment.name,gt,st))}generateReadonly(nt,st,mt,gt,_t,Et){return nt.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",gt,st)}},It=class extends or{constructor(nt){super("i"),this.nodeType="Int",this.value=Math.floor(nt??0)}generateReadonly(nt,st,mt,gt,_t,Et){return nt.format(this.value.toString(),gt,st)}},Kr=class extends or{constructor(nt){super("b"),this.nodeType="Bool",this.value=nt??!1}generateReadonly(nt,st,mt,gt){return nt.format(this.value?"true":"false",gt,st)}},Ys=class extends or{constructor(nt=1,st){super("f[]"),this.nodeType="FloatArray",this.size=nt,this.value=Array.isArray(st)?st:typeof st=="number"?new Array(nt).fill(st):new Array(nt).fill(0)}},Ll=class extends or{},V0=class extends Ll{constructor(nt){super("v3"),this.image=nt,this._value=new E$6}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},Gc=class extends Ll{constructor(nt,st,mt=1008,gt=1006){super("t"),this.image=nt,this.wrap=st,this.minFilter=mt,this.magFilter=gt}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},Nd=class extends or{constructor(nt){super("m3"),this.nodeType="Matrix3",this.value=nt??new fr}generateReadonly(nt,st,mt,gt,_t,Et){return nt.format("mat3("+this.value.elements.join(", ")+")",gt,st)}get elements(){return this.value.elements}set elements(nt){this.value.fromArray(nt)}},Qi=class extends or{constructor(nt){super("m4"),this.nodeType="Matrix4",this.value=nt??new ue$1}generateReadonly(nt,st,mt,gt,_t,Et){return nt.format("mat4("+this.value.elements.join(", ")+")",gt,st)}get elements(){return this.value.elements}set elements(nt){this.value.fromArray(nt)}};function aR(nt,st,mt,gt=0){nt.setUvTransform(mt[0],mt[1],st[0],st[1],0,0,0).premultiply(new fr().makeRotation(gt*we$1.DEG2RAD))}var U0=class extends Nd{constructor(nt,st,mt=0){super(new fr),this.repeat=nt,this.offset=st,this.rotation=mt,aR(this.value,nt,st,mt)}updateMatrix(){aR(this.value,this.repeat,this.offset,this.rotation)}},Xs=class extends or{constructor(nt=1,st){super("v4[]"),this.nodeType="Vector4Array",this.size=nt,this.value=Array.isArray(st)?st:st instanceof Ze$1?new Array(nt).fill(st):new Array(nt).fill(new Ze$1(0))}},Fd=class extends tt{constructor(nt,st,mt,gt){super("v3"),this.nodeType="Blend",this.a=nt,this.b=st,this.alpha=mt,this.mode=gt}generate(nt,st){if(nt.isShader("fragment")){let mt=[];return mt.push(this.a.build(nt,"c")),mt.push(this.b.build(nt,"c")),mt.push(this.alpha.build(nt,"f")),mt.push(this.mode.build(nt,"i")),nt.format("spe_blend("+mt.join(",")+")",this.getType(nt),st)}else return console.warn("BlendNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.getType(nt),st)}},qA=class extends tt{constructor(nt,st){super("v3"),this.nodeType="CustomColor",this.color=nt,this.alpha=st,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st){if(nt.isShader("fragment")){let mt=nt.include(qA.Nodes.customColor);nt.addFragmentVariable(this.calpha,"float");let gt=[];return gt.push(this.color.build(nt,"v3")),gt.push(this.mask?`luminance(${this.mask.build(nt,"v3")})`:"1.0"),gt.push(this.alpha.build(nt,"f")),gt.push(this.calpha),nt.format(mt+"("+gt.join(",")+")",this.getType(nt),st)}else return console.warn("CustomColorNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.getType(nt),st)}},jc=qA;jc.Nodes=function(){return{customColor:new Ee$1(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var YA=class extends tt{constructor(nt,st){super("v3"),this.nodeType="CustomNormal",this.cnormal=nt,this.alpha=st,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st){if(nt.isShader("fragment")){let mt=nt.include(YA.Nodes.customNormal);nt.addFragmentVariable(this.calpha,"float");let gt=[];return gt.push(this.cnormal.build(nt,"v3")),gt.push("normal"),gt.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),gt.push(this.alpha.build(nt,"f")),gt.push(this.calpha),nt.format(mt+"("+gt.join(",")+")",this.getType(nt),st)}else return console.warn("CustomNormalNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.getType(nt),st)}},Vd=YA;Vd.Nodes=function(){return{customNormal:new Ee$1(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var Ud=class extends tt{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt){super("v3"),this.nodeType="CustomTexture",this.texture=nt,this.textureSize=st,this.crop=mt,this.projection=gt,this.axis=_t,this.side=Et,this.size=At,this.blending=Rt,this.mat=Ft,this.isMask=Gt,this.alpha=Nt,this.mode=Bt,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st){nt.require("position"),nt.require("normal"),nt.require("uv"),nt.requires.uv=[!0],nt.extensions.shaderTextureLOD=!0,nt.extensions.derivatives=!0;let mt=`g${this.uuid.toString().replace(/-/g,"")}`,gt;switch(this.projection.value){case 3:gt=nt.include(Ud.Nodes.cylindrical);break;case 2:gt=nt.include(Ud.Nodes.spherical);break;case 1:let Et=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],At=["zy","xz","xy"][this.axis.value],Rt=new Ee$1(`
		vec3 ${mt}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${At})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${Et}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);gt=nt.include(Rt);break;case 4:gt=nt.include(Ud.Nodes.triplanar);break;default:gt=nt.include(Ud.Nodes.uv);break}nt.addFragmentVariable(this.calpha,"float");let _t=[];if(_t.push("normal"),_t.push(this.texture.generate(nt,"t")),_t.push(this.textureSize.build(nt,"v2")),_t.push(this.crop.build(nt,"f")),_t.push(this.mat.build(nt,"mat3")),_t.push(this.size.build(nt,"v2")),_t.push(this.blending.build(nt,"f")),_t.push(this.isMask.build(nt,"b")),_t.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),_t.push(this.alpha.build(nt,"f")),_t.push(this.mode.build(nt,"i")),_t.push(this.calpha),this.projection.value===4){let Et=`${mt}_writeUvs`,At=Et+"0",Rt=Et+"1",Ft=Et+"2",Nt=`${mt}_triplanarWeights`;nt.addFragmentVariable(At,"vec2"),nt.addFragmentVariable(Rt,"vec2"),nt.addFragmentVariable(Ft,"vec2"),nt.addFragmentVariable(Nt,"vec3"),_t.push(At),_t.push(Rt),_t.push(Ft),_t.push(Nt)}else{let Et=`${mt}_writeUvs`;nt.addFragmentVariable(Et,"vec2"),_t.push(Et)}return nt.format(gt+"("+_t.join(",")+")",this.getType(nt),st)}},Bl=Ud;Bl.Nodes=function(){let nt=new Ee$1(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),st=new Ee$1(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),mt=new Ee$1(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),gt=new Ee$1(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:nt,spherical:st,uv:mt,triplanar:gt}}();var zd=class extends tt{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt){super("v3"),this.nodeType="Depth",this.gradientType=nt,this.smooth=st,this.near=mt,this.far=gt,this.isVector=_t,this.isWorldSpace=Et,this.origin=At,this.direction=Rt,this.colors=Ft,this.steps=Nt,this.isMask=Gt,this.alpha=Bt,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st){let mt=`g${this.uuid.toString().replace(/-/g,"")}`,gt=new Ee$1(`vec3 ${mt}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${mt}_MAX_COLORS], float steps[${mt}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${mt}_IS_VECTOR
                   #ifdef ${mt}_LINEAR
                       #ifdef ${mt}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${mt}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${mt}_SMOOTH
				for ( int i = 1; i < ${mt}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${mt}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[zd.Nodes.vectorLinearWorldSpaceDepth,zd.Nodes.vectorLinearObjectSpaceDepth,zd.Nodes.vectorSphericalObjectSpaceDepth,zd.Nodes.vectorSphericalWorldSpaceDepth]);if(nt.isShader("fragment")){nt.define(`${mt}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&nt.define(`${mt}_SMOOTH`),this.isVector.value>.5&&nt.define(`${mt}_IS_VECTOR`),this.gradientType.value===0&&nt.define(`${mt}_LINEAR`),this.isWorldSpace.value>.5&&nt.define(`${mt}_WORLDSPACE`),nt.require("worldPosition"),nt.addFragmentVariable(this.calpha,"float");let _t=nt.include(gt),Et=[];return Et.push(this.near.build(nt,"f")),Et.push(this.far.build(nt,"f")),Et.push(this.origin.build(nt,"v3")),Et.push(this.direction.build(nt,"v3")),Et.push(this.colors.build(nt,"v4[]")),Et.push(this.steps.build(nt,"f[]")),Et.push(this.isMask.build(nt,"b")),Et.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),Et.push(this.alpha.build(nt,"f")),Et.push(this.calpha),nt.format(_t+"("+Et.join(",")+")",this.getType(nt),st)}else return console.warn("DepthNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.getType(nt),st)}},kd=zd;kd.Nodes=function(){let nt=new Ee$1(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),st=new Ee$1(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),mt=new Ee$1(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),gt=new Ee$1(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:nt,vectorLinearObjectSpaceDepth:st,vectorSphericalWorldSpaceDepth:mt,vectorSphericalObjectSpaceDepth:gt}}();var fm=class extends tt{constructor(nt,st,mt,gt,_t,Et,At,Rt){super("v3"),this.nodeType="Fresnel",this.color=nt,this.bias=st,this.scale=mt,this.intensity=gt,this.factor=_t,this.isMask=Rt,this.alpha=Et,this.mode=At,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st){if(nt.require("vWorldViewDir"),nt.require("worldNormal"),nt.isShader("fragment")){nt.addFragmentVariable(this.calpha,"float");let mt=new Ee$1(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),gt=nt.include(mt),_t=[];return _t.push(this.color.build(nt,"c")),_t.push(this.bias.build(nt,"f")),_t.push(this.scale.build(nt,"f")),_t.push(this.intensity.build(nt,"f")),_t.push(this.factor.build(nt,"f")),_t.push(this.isMask.build(nt,"b")),_t.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),_t.push(this.alpha.build(nt,"f")),_t.push(this.mode.build(nt,"i")),_t.push(this.calpha),nt.format(gt+"("+_t.join(",")+")",this.getType(nt),st)}else return console.warn("FresnelNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.getType(nt),st)}},XA=class extends tt{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft){super("v3"),this.nodeType="Gradient",this.gradientType=nt,this.smooth=st,this.colors=mt,this.steps=gt,this.offset=_t,this.morph=Et,this.angle=At,this.isMask=Ft,this.alpha=Rt,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st){if(nt.isShader("fragment")){nt.define("GRAD_MAX",10),nt.require("uv"),nt.requires.uv=[!0],nt.addFragmentVariable(this.calpha,"float");let mt=nt.include(XA.Nodes.gradient),gt=[];return gt.push(this.gradientType.build(nt,"i")),gt.push(this.smooth.build(nt,"b")),gt.push(this.colors.build(nt,"v4[]")),gt.push(this.steps.build(nt,"f[]")),gt.push(this.offset.build(nt,"v2")),gt.push(this.morph.build(nt,"v2")),gt.push(this.angle.build(nt,"f")),gt.push(this.isMask.build(nt,"b")),gt.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),gt.push(this.alpha.build(nt,"f")),gt.push(this.calpha),nt.format(mt+"("+gt.join(",")+")",this.getType(nt),st)}else return console.warn("GradientNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.getType(nt),st)}},Gd=XA;Gd.Nodes=function(){return{gradient:new Ee$1(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var QA=class extends tt{constructor(nt,st,mt,gt,_t){super("v3"),this.nodeType="Matcap",this.texture=nt,this.isMask=gt,this.alpha=st,this.mode=mt,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`,this.rotation=_t}generate(nt,st){if(nt.isShader("fragment")){nt.addFragmentVariable(this.calpha,"float");let mt=nt.include(QA.Nodes.matcap);nt.require("normal"),nt.requires.normal=!0;let gt=[];return gt.push(this.texture.generate(nt,"t")),gt.push("normal"),gt.push(this.isMask.build(nt,"b")),gt.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),gt.push(this.alpha.build(nt,"f")),gt.push(this.mode.build(nt,"i")),gt.push(this.calpha),gt.push(this.rotation.build(nt,"f")),nt.format(mt+"("+gt.join(",")+")",this.getType(nt),st)}else return console.warn("MatcapNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.getType(nt),st)}},jd=QA;jd.Nodes=function(){return{matcap:new Ee$1(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) );
					uv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;
					uv = uv * 0.495 + 0.5;
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var pm=(nt=>(nt.SIMPLEX="simplex3d",nt.SIMPLEX_FRACTAL="simplex3dFractal",nt.ASHIMA="simplexAshima",nt.FBM="fbm",nt.PERLIN="perlin",nt.VORONOI="voronoi",nt))(pm||{}),ki=function(){let nt=new Ee$1(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),st=new Ee$1(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[nt]);st.keywords.F3=new Wt("float F3 0.3333333"),st.keywords.G3=new Wt("float G3 0.1666667");let mt=new Ee$1(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[st]),gt=new Ee$1("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),_t=new Ee$1("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),Et=new Ee$1(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[gt,_t]),At=new Ee$1("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),Rt=new Ee$1("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[At]),Ft=new Ee$1(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[Rt]),Nt=new Ee$1(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[Ft]);Nt.keywords.NUM_OCTAVES=new Wt("int NUM_OCTAVES 5");let Bt=new Ee$1("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),Gt=new Ee$1(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[gt,_t,Bt]),dr=new Ee$1(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),Mr=new Ee$1(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),Tr=new Ee$1(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),zr=new Ee$1(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),Fr=new Ee$1(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),Nr=new Ee$1(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),tn=new Ee$1(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[dr,Mr,Tr,zr,Fr,Nr]);return{simplex:st,simplexFractal:mt,simplexAshima:Et,fbm:Nt,perlin:Gt,voronoi:tn}}(),Hd=class extends tt{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr,Nr,tn){super("v3"),this.nodeType="Noise",this.scale=nt,this.size=st,this.move=mt,this.fA=gt,this.fB=_t,this.distortion=Et,this.colorA=At,this.colorB=Rt,this.colorC=Ft,this.colorD=Nt,this.noiseType=Gt,this.voronoiStyle=Mr,this.highCut=Tr,this.lowCut=zr,this.smoothness=Fr,this.seed=Nr,this.quality=tn,this.isMask=dr,this.alpha=Bt,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st,mt,gt,_t){nt.require("uv"),nt.requires.uv=[!0],nt.addFragmentVariable(this.calpha,"float");let Et=Object.values(pm)[this.noiseType.value],At=Et=="voronoi"?`
		float v = ${Et}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${Et}(st),
					   ${Et}(st + vec3(1.0)),
					   ${Et}(st + vec3(1.0)));
		vec3 r = vec3(${Et}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${Et}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${Et}(st * q));
		float f = ${Et}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,Rt=new Ee$1(`vec3 ${Et}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${At}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[ki.simplex,ki.simplexFractal,ki.simplexAshima,ki.fbm,ki.perlin,ki.voronoi]),Ft=nt.include(Rt),Nt=[];return Nt.push(this.scale.build(nt,"f")),Nt.push(this.size.build(nt,"v3")),Nt.push(this.move.build(nt,"f")),Nt.push(this.fA.build(nt,"v2")),Nt.push(this.fB.build(nt,"v2")),Nt.push(this.distortion.build(nt,"v2")),Nt.push(this.colorA.build(nt,"v4")),Nt.push(this.colorB.build(nt,"v4")),Nt.push(this.colorC.build(nt,"v4")),Nt.push(this.colorD.build(nt,"v4")),Nt.push(this.voronoiStyle.build(nt,"i")),Nt.push(this.highCut.build(nt,"f")),Nt.push(this.lowCut.build(nt,"f")),Nt.push(this.smoothness.build(nt,"f")),Nt.push(this.seed.build(nt,"f")),Nt.push(this.quality.build(nt,"i")),Nt.push(this.isMask.build(nt,"b")),Nt.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),Nt.push(this.alpha.build(nt,"f")),Nt.push(this.calpha),nt.format(Ft+"("+Nt.join(",")+")",this.getType(nt),st)}};Hd.numOctaves=5;var KA=class extends tt{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=nt,this.contourColor=st,this.outlineWidth=mt,this.contourWidth=gt,this.contourThreshold=_t,this.outlineThreshold=Et,this.contourFrequency=At,this.outlineSmoothing=Rt,this.contourDirection=Ft,this.positionalLines=Nt,this.compensation=Bt,this.resolution=Gt,this.normalMap=dr,this.depthMap=Mr,this.pixelRatio=Tr,this.alpha=zr,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st){let mt=`g${this.uuid.toString().replace(/-/g,"")}`;if(nt.require("vWorldViewDir"),nt.require("worldNormal"),nt.extensions.derivatives=!0,this.compensation.value&&nt.define("OUTLINE_COMPENSATION",`${mt}_offset`),this.firstTime){let gt=this.outlineWidth.build(nt,"f"),_t=this.resolution.build(nt,"v2"),Et=this.compensation.build(nt,"b"),At=this.pixelRatio.build(nt,"f");nt.addVertexParsVariable("randomColor","attribute vec3"),nt.addVertexParsVariable("extrudeNormal","attribute vec3"),nt.addVertexParsVariable(gt,"uniform float"),nt.addVertexParsVariable(_t,"uniform vec2"),nt.addVertexParsVariable(Et,"uniform bool"),nt.addVertexParsVariable(At,"uniform float"),nt.addVertexParsVariable("vID","flat out float"),nt.addFragmentParsVariable("vID","flat in float"),nt.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${mt}_offset = vec2(0.0);
                if (${Et}) {
                    vec4 ${mt}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${mt}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${mt}_offset = normalize(${mt}_clipNormal.xy) / ${_t} * (${gt} / 2.0) * ${mt}_clipPosition.w * 2.0 * ${At};
                    ${mt}_clipPosition.xy += ${mt}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${mt}_clipPosition;
                }
            `)}if(nt.isShader("fragment")){nt.require("uv"),nt.requires.uv=[!0],nt.addFragmentVariable(this.calpha,"float");let gt=nt.include(KA.Nodes.outline),_t=[];return _t.push(this.outlineColor.build(nt,"c")),_t.push(this.contourColor.build(nt,"c")),_t.push(this.outlineWidth.build(nt,"f")),_t.push(this.contourWidth.build(nt,"f")),_t.push(this.contourThreshold.build(nt,"f")),_t.push(this.outlineThreshold.build(nt,"f")),_t.push(this.contourFrequency.build(nt,"f")),_t.push(this.outlineSmoothing.build(nt,"f")),_t.push(this.contourDirection.build(nt,"v3")),_t.push(this.positionalLines.build(nt,"b")),_t.push(this.resolution.build(nt,"v2")),_t.push(this.normalMap.getTexture(nt,"t")),_t.push(this.depthMap.getTexture(nt,"t")),_t.push(this.pixelRatio.build(nt,"f")),_t.push(this.compensation.build(nt,"b")),_t.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),_t.push(this.alpha.build(nt,"f")),_t.push(this.calpha),this.firstTime=!this.firstTime,nt.format(gt+"("+_t.join(",")+")",this.getType(nt),st)}else return console.warn("OutlineNode is not compatible with "+nt.shader+" shader."),""}},Wd=KA;Wd.Nodes=function(){let nt=new Ee$1(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new Ee$1(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[nt])}}();var Lo=class extends tt{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr,Nr){super("v3"),this.nodeType="Pattern",this.style=nt,this.projection=st,this.axis=mt,this.blending=gt,this.offset=_t,this.colorA=Et,this.colorB=At,this.frequency=Rt,this.size=Ft,this.variation=Nt,this.smoothness=Bt,this.zigzag=Gt,this.rotation=dr,this.vertical=Mr,this.horizontal=Tr,this.sides=zr,this.isMask=Nr,this.alpha=Fr,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st){if(nt.isShader("fragment")){nt.require("position"),nt.require("uv"),nt.requires.uv=[!0],nt.require("normal"),nt.requires.normal=!0,nt.addFragmentVariable(this.calpha,"float");let mt;switch(this.style.value){case 0:mt="circle";break;case 1:mt="ring";break;case 2:mt="polygon";break;case 3:mt="xcross";break;case 4:mt="diamond";break;case 5:mt="checkerboard";break;case 6:mt="line";break;case 7:mt="wave";break;default:mt="circle";break}let gt=`g${this.uuid.toString().replace(/-/g,"")}`,_t=new Ee$1(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),Et=new Ee$1(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),At="";if(this.projection.value===4){let Bt=this.style.value===2?`${mt}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${mt}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,Gt=this.style.value===2?`${mt}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${mt}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,dr=this.style.value===2?`${mt}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${mt}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;At=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${Bt};
				float d1 = ${Gt};
				float d2 = ${dr};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let Bt=this.style.value===2?`${mt}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${mt}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,Gt="";this.axis.value===0?Gt=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?Gt=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,Gt=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let dr="";switch(this.projection.value){case 0:dr="custom_uv = vUv.st;";break;case 1:break;case 2:dr=`
							vec3 p = position;
							${Gt}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}At=`
				vec2 custom_uv;
				${dr}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${Bt};
				`}let Rt=new Ee$1(`vec3 ${gt}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${At}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[Et,_t,Lo.DrawFunctions.circle,Lo.DrawFunctions.ring,Lo.DrawFunctions.polygon,Lo.DrawFunctions.cross,Lo.DrawFunctions.diamond,Lo.DrawFunctions.checkerboard,Lo.DrawFunctions.line,Lo.DrawFunctions.wave]),Ft=nt.include(Rt),Nt=[];return Nt.push("normal"),Nt.push(this.blending.build(nt,"f")),Nt.push(this.style.build(nt,"i")),Nt.push(this.offset.build(nt,"v2")),Nt.push(this.colorA.build(nt,"v4")),Nt.push(this.colorB.build(nt,"v4")),Nt.push(this.frequency.build(nt,"v2")),Nt.push(this.size.build(nt,"f")),Nt.push(this.variation.build(nt,"f")),Nt.push(this.smoothness.build(nt,"f")),Nt.push(this.zigzag.build(nt,"f")),Nt.push(this.rotation.build(nt,"f")),Nt.push(this.vertical.build(nt,"v2")),Nt.push(this.horizontal.build(nt,"v2")),Nt.push(this.sides.build(nt,"i")),Nt.push(this.isMask.build(nt,"b")),Nt.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),Nt.push(this.alpha.build(nt,"f")),Nt.push(this.calpha),nt.format(Ft+"("+Nt.join(",")+")",this.getType(nt),st)}else return console.warn("PatterNode is not compatible with "+nt.shader+" shader."),nt.format("vec3(0.0)",this.getType(nt),st)}},qd=Lo;qd.DrawFunctions=function(){let nt=new Ee$1(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),st=new Ee$1(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[nt]),mt=new Ee$1(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[st]),gt=new Ee$1(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[st]),_t=new Ee$1(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[st]),Et=new Ee$1(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[st]),At=new Ee$1(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[st]),Rt=new Ee$1(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),Ft=new Ee$1(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[st]),Nt=new Ee$1(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:st,circle:mt,ring:gt,polygon:_t,cross:Et,diamond:At,checkerboard:Rt,line:Ft,wave:Nt}}();var ZA=class extends tt{constructor(nt,st,mt,gt,_t,Et,At,Rt){super("v3"),this.nodeType="Rainbow",this.filmThickness=nt,this.movement=st,this.wavelengths=mt,this.noiseStrength=gt,this.noiseScale=_t,this.offset=Et,this.isMask=Rt,this.alpha=At,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st){if(nt.require("vWorldViewDir"),nt.require("worldNormal"),nt.isShader("fragment")){nt.require("uv"),nt.requires.uv=[!0],nt.addFragmentVariable(this.calpha,"float");let mt=nt.include(ZA.Nodes.rainbow),gt=[];return gt.push(this.filmThickness.build(nt,"f")),gt.push(this.movement.build(nt,"f")),gt.push(this.wavelengths.build(nt,"v3")),gt.push(this.noiseStrength.build(nt,"f")),gt.push(this.noiseScale.build(nt,"f")),gt.push(this.offset.build(nt,"v3")),gt.push(this.isMask.build(nt,"b")),gt.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),gt.push(this.alpha.build(nt,"f")),gt.push(this.calpha),nt.format(mt+"("+gt.join(",")+")",this.getType(nt),st)}else return console.warn("RainbowNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.getType(nt),st)}},Yd=ZA;Yd.Nodes=function(){let nt=new Ee$1(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[ki.simplex]);return{rainbow:new Ee$1(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[nt])}}();var JA=class extends tt{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt){super("v3"),this.nodeType="Toon",this.positioning=nt,this.colors=st,this.steps=mt,this.source=gt,this.isWorldSpace=_t,this.noiseStrength=Et,this.noiseScale=At,this.shadowColor=Rt,this.offset=Ft,this.alpha=Nt,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st){if(nt.require("worldNormal"),nt.require("worldPosition"),nt.isShader("fragment")){nt.define("COLORS_MAX",10),nt.addFragmentVariable(this.calpha,"float");let mt=nt.include(JA.Nodes.toon),gt=[];return gt.push(this.positioning.build(nt,"i")),gt.push(this.colors.build(nt,"v4[]")),gt.push(this.steps.build(nt,"f[]")),gt.push(this.source.build(nt,"v3")),gt.push(this.isWorldSpace.build(nt,"b")),gt.push(this.noiseStrength.build(nt,"f")),gt.push(this.noiseScale.build(nt,"f")),gt.push(this.shadowColor.build(nt,"v4")),gt.push(this.offset.build(nt,"v3")),gt.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),gt.push(this.alpha.build(nt,"f")),gt.push(this.calpha),nt.format(mt+"("+gt.join(",")+")",this.getType(nt),st)}else return console.warn("ToonNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.getType(nt),st)}},Xd=JA;Xd.Nodes=function(){let nt=new Ee$1(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),st=new Ee$1(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),mt=new Ee$1(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[st]),gt=new Ee$1(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),_t=new Ee$1(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[gt]);return{toon:new Ee$1(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[ki.simplex,nt,mt,_t])}}();var lR=function(){return{textureBicubic:new Ee$1(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function cR(nt,st){return nt>=st?new U$1(st/nt,1):new U$1(1,nt/st)}var $A=class extends tt{constructor(nt,st,mt,gt,_t,Et,At,Rt){super("v3"),this.nodeType="Transmission",this.thickness=nt,this.ior=st,this.roughness=mt,this.transmissionSamplerSize=gt,this.transmissionSamplerMap=_t,this.transmissionDepthMap=Et,this.aspectRatio=At,this.alpha=Rt,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(nt,st){if(nt.extensions.shaderTextureLOD=!0,nt.extensions.derivatives=!0,nt.isShader("fragment")){nt.define("NUM_SAMPLES",6),nt.define("BLUR_SLOD",Math.pow(2,$e$1.transmissionLod.value)),nt.require("worldPosition"),nt.requires.worldNormal=!0,nt.requires.modelMatrix=!0,nt.requires.projectionMatrix=!0,nt.addFragmentVariable(this.calpha,"float");let mt=nt.include($A.Nodes.transmission),gt=[];return gt.push(this.thickness.build(nt,"f")),gt.push(this.ior.build(nt,"f")),gt.push(this.roughness.build(nt,"f")),gt.push(this.transmissionSamplerSize.build(nt,"v2")),gt.push(this.transmissionSamplerMap.getTexture(nt,"t")),gt.push(this.transmissionDepthMap.getTexture(nt,"t")),gt.push(this.aspectRatio.build(nt,"v2")),gt.push("normal"),gt.push(this.mask?`luminance(${this.mask.flow(nt,"v3").result})`:"1.0"),gt.push(this.alpha.build(nt,"f")),gt.push(this.calpha),nt.format(mt+"("+gt.join(",")+")",this.getType(nt),st)}else return console.warn("TransmissionNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.getType(nt),st)}},Qd=$A;Qd.Nodes=function(){let nt=new Ee$1(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),st=new Ee$1(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),mt=new Ee$1(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),gt=new Ee$1(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[lR.textureBicubic,mt,nt]),_t=new Ee$1(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[gt,st]);return{transmission:new Ee$1(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[_t])}}();var eE=(nt=>(nt.NOISE="noise",nt.MAP="map",nt))(eE||{}),tE=class extends tt{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt){super("v3"),this.displacementTypeIndex=new It(0),this.nodeType="VertexDisplacement",this.intensity=nt,this.movementOrTexture=st,Object.values(eE)[this.displacementTypeIndex.value]==="map"&&(this.mat=new Nd(this.movementOrTexture.value.matrix)),this.cropOrOffset=mt,this.scale=Nt,this.noiseFunctionIndex=Bt,this.voronoiStyle=gt,this.smoothness=_t,this.seed=Et,this.highCut=At,this.lowCut=Rt,this.quality=Ft}generate(nt,st){if(nt.isShader("vertex")){nt.define("USE_LAYER_DISPLACE");let mt,gt=[];switch(gt.push("displaced_position"),gt.push("displaced_normal"),Object.values(eE)[this.displacementTypeIndex.value]){case"map":{mt=nt.include(tE.Nodes.map),gt.push(this.movementOrTexture.getTexture(nt,"t")),gt.push("uv"),gt.push(this.cropOrOffset.build(nt,"f")),this.mat&&gt.push(this.mat.build(nt,"mat3"));break}case"noise":{let _t=Object.values(pm)[this.noiseFunctionIndex.value],Et=new Ee$1(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),At=_t=="voronoi"?`
					float v = ${_t}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${_t}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,Rt=new Ee$1(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${At}
						}`,[ki.simplex,ki.simplexFractal,ki.simplexAshima,ki.fbm,ki.perlin,ki.voronoi]),Ft=new Ee$1(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[Rt,Et]);mt=nt.include(Ft),gt.push(this.scale.build(nt,"f")),gt.push(this.cropOrOffset.build(nt,"v3")),gt.push(this.movementOrTexture.build(nt,"f")),gt.push(this.voronoiStyle.build(nt,"i")),gt.push(this.smoothness.build(nt,"f")),gt.push(this.seed.build(nt,"f")),gt.push(this.highCut.build(nt,"f")),gt.push(this.lowCut.build(nt,"f")),gt.push(this.quality.build(nt,"i"));break}}return gt.push(this.intensity.build(nt,"f")),gt.push("displaced_normal"),nt.format(mt+"("+gt.join(",")+")",this.getType(nt),st)}else return console.warn("VertexDisplacementNode is not compatible with "+nt.shader+" shader."),nt.format("vec3( 0.0 )",this.getType(nt),st)}},Kd=tE;Kd.Nodes=function(){let nt=new Ee$1(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),st=new Ee$1(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new Ee$1(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[nt,st])}}();var $e$1={normalRenderTarget:new bn,normalRenderTargetDepth:new bn,transmissionRenderTarget:new bn,aspectRatio:new Hr,transmissionSize:new Hr(2048,2048),transmissionRenderTargetDepth:new bn,aoRenderTarget:new bn,aoEnabled:new Kr,pixelRatioNode:new Fe$1(1),resolution:new Hr,penumbraSize:new Ys(5,.5),frameIndex:new It(0),transmissionLod:new It(2)};for(let nt of Object.values($e$1))nt.isRenderGlobal=!0;var z0={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.9.30/build/ui.wasm"},_a=class extends sr{constructor(){super("basic"),this.nodeType="Basic",this.color=new er(ii),this.shadingAlpha=new Fe$1(1),this.shadingBlend=new It(0),this.previousModelViewMatrix=new Qi,this.previouseProjectionMatrix=new Qi}get category(){return"phong"}generate(nt){let st;if(nt.isShader("vertex")){let mt=this.position?this.position.analyzeAndFlow(nt,"v3",{cache:"position"}):void 0;nt.mergeUniform({frameIndex:$e$1.frameIndex}),nt.mergeUniform({resolution:$e$1.resolution}),nt.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),nt.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),nt.mergeUniform(Bs.merge([De$1.fog])),nt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let gt=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];mt&&gt.push(mt.code,mt.result?"displaced_position = "+mt.result+";":""),gt.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),gt.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),gt.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),st=gt.join(`
`)}else{this.color===void 0&&(this.color=new er(ii)),this.color.analyze(nt,{slot:"color"}),this.alpha&&this.alpha.analyze(nt),this.afterColor&&this.afterColor.analyze(nt,{slot:"afterColor"});let mt=this.color.flow(nt,"c",{slot:"color"}),gt=this.alpha?this.alpha.flow(nt,"f"):void 0,_t=this.alphaOverride?this.alphaOverride.flow(nt,"f"):void 0,Et=this.afterColor?this.afterColor.flow(nt,"c",{slot:"afterColor"}):void 0;nt.requires.transparent=gt!==void 0,nt.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let At=["#include <normal_fragment_begin>",mt.code];gt&&At.push(gt.code,"#ifdef ALPHATEST"," if ( "+gt.result+" <= ALPHATEST ) discard;","#endif"),Et?At.push(Et.code,`vec3 outgoingLight = ${mt.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${Et.result}, 1.0, SPE_BLENDING_NORMAL);`):At.push(`vec3 finalColor = ${mt.result};`);let Rt="1.0";this.mask&&(this.mask.analyze(nt),Rt=`luminance(${this.mask.flow(nt,"v3").result})`),gt?At.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${gt.result} * ${Rt} );`):At.push("gl_FragColor = vec4("+mt.result+", 1.0 );"),_t&&At.push(`gl_FragColor.a *= ${_t.result};`),At.push("#include <fog_fragment>","#include <dithering_fragment>"),st=At.join(`
`)}return st}},mm=class extends sr{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new er(ii),this.emissive=new er(0),this.emissiveIntensity=new Fe$1(1),this.previousModelViewMatrix=new Qi,this.previouseProjectionMatrix=new Qi,this.shadingAlpha=new Fe$1(1),this.shadingBlend=new It(0),this.occlusion=new Kr(!0)}get category(){return"lambert"}build(nt){let st;if(nt.define("LAMBERT"),nt.requires.lights=!0,nt.extensions.derivatives=!0,nt.isShader("vertex")){let mt=this.position?this.position.analyzeAndFlow(nt,"v3",{cache:"position"}):void 0;nt.mergeUniform({frameIndex:$e$1.frameIndex}),nt.mergeUniform({resolution:$e$1.resolution}),nt.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),nt.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),nt.mergeUniform(Bs.merge([De$1.fog,De$1.lights])),nt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let gt=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];mt&&gt.push(mt.code,mt.result?"displaced_position = "+mt.result+";":""),gt.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),gt.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),gt.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),gt.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),st=gt.join(`
`)}else{nt.mergeUniform({penumbraSize:$e$1.penumbraSize}),nt.mergeUniform({frameIndex:$e$1.frameIndex}),nt.mergeUniform({aoMap:$e$1.aoRenderTarget}),nt.mergeUniform({aoEnabled:$e$1.aoEnabled}),this.color===void 0&&(this.color=new er(ii)),this.color.analyze(nt,{slot:"color"}),this.shadingAlpha.analyze(nt),this.shadingBlend.analyze(nt),this.afterColor&&this.afterColor.analyze(nt,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(nt);let mt=this.color.flow(nt,"c",{slot:"color"}),gt=this.emissive.flow(nt,"c",{slot:"emissive"}),_t=this.emissiveIntensity.flow(nt,"f",{slot:"emissive"}),Et=this.occlusion.flow(nt,"b",{slot:"occlusion"}),At=this.shadingAlpha.flow(nt,"f"),Rt=this.shadingBlend.flow(nt,"i"),Ft=this.afterColor?this.afterColor.flow(nt,"c",{slot:"afterColor"}):void 0,Nt=this.alpha?this.alpha.flow(nt,"f"):void 0,Bt=this.alphaOverride?this.alphaOverride.flow(nt,"f"):void 0;nt.requires.transparent=Nt!==void 0,nt.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let Gt=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];Gt.push(mt.code,"vec3 diffuseColor = "+mt.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),Nt&&Gt.push(Nt.code,"#ifdef ALPHATEST","if ( "+Nt.result+" <= ALPHATEST ) discard;","#endif"),Gt.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),gt&&Gt.push(gt.code,"reflectedLight.directDiffuse += "+gt.result+" * "+_t.result+";"),Gt.push("vec3 ao = aoEnabled && "+Et.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let dr="1.0";this.mask&&(this.mask.analyze(nt),dr=`luminance(${this.mask.flow(nt,"v3").result})`),Gt.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${At.result} * ${dr} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${At.result} * ${dr}, ${Rt.result} );

					outgoingLight *= ao;
				}
				`),Ft&&Gt.push(Ft.code,`outgoingLight = spe_blend(outgoingLight, ${Ft.result}, 1.0, SPE_BLENDING_NORMAL);`),Nt?Gt.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${Nt.result} );`):Gt.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),Bt&&Gt.push(`gl_FragColor.a *= ${Bt.result};`),Gt.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),st=Gt.join(`
`)}return st}},Da=function(){let nt=new Ee$1(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),st=new Ee$1(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:nt,perturbNormalArb:st}}(),gm=class extends sr{constructor(){super("phong"),this.nodeType="Phong",this.color=new er(ii),this.specular=new er(1118481),this.shininess=new Fe$1(30),this.previousModelViewMatrix=new Qi,this.previouseProjectionMatrix=new Qi,this.shadingAlpha=new Fe$1(1),this.shadingBlend=new It(0),this.occlusion=new Kr(!0)}get category(){return"phong"}build(nt){let st;if(nt.define("PHONG"),nt.requires.lights=!0,nt.extensions.derivatives=!0,nt.isShader("vertex")){let mt=this.position?this.position.analyzeAndFlow(nt,"v3",{cache:"position"}):void 0;nt.mergeUniform({frameIndex:$e$1.frameIndex}),nt.mergeUniform({resolution:$e$1.resolution}),nt.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),nt.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),nt.mergeUniform(Bs.merge([De$1.fog,De$1.lights])),nt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let gt=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];mt&&gt.push(mt.code,mt.result?"displaced_position = "+mt.result+";":""),gt.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),gt.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),gt.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),st=gt.join(`
`)}else{nt.mergeUniform({penumbraSize:$e$1.penumbraSize}),nt.mergeUniform({frameIndex:$e$1.frameIndex}),nt.mergeUniform({aoMap:$e$1.aoRenderTarget}),nt.mergeUniform({aoEnabled:$e$1.aoEnabled}),this.color===void 0&&(this.color=new er(ii)),this.color.analyze(nt,{slot:"color"}),this.specular.analyze(nt),this.shininess.analyze(nt);let mt=this.occlusion.flow(nt,"b",{slot:"occlusion"});this.shadingAlpha.analyze(nt),this.shadingBlend.analyze(nt),this.afterColor&&this.afterColor.analyze(nt,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(nt);let gt=this.color.flow(nt,"c",{slot:"color"}),_t=this.specular.flow(nt,"c"),Et=this.shininess.flow(nt,"f"),At=this.shadingAlpha.flow(nt,"f"),Rt=this.shadingBlend.flow(nt,"i"),Ft=this.afterColor?this.afterColor.flow(nt,"c",{slot:"afterColor"}):void 0,Nt=this.alpha?this.alpha.flow(nt,"f"):void 0,Bt=this.alphaOverride?this.alphaOverride.flow(nt,"f"):void 0;nt.requires.transparent=Nt!==void 0,nt.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let Gt=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){nt.include(Da.dHdxy),nt.include(Da.perturbNormalArb);let Mr=this.bumpMap.texture.flow(nt,"t"),Tr=this.bumpMap.flow(nt,"v3"),zr=this.bumpMapIntensity?this.bumpMapIntensity.flow(nt,"f").result:"1.0",Fr="";this.bumpMap.projection.value===4?Fr=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${Mr.result}, uv0, ${zr});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${Mr.result}, uv1, ${zr});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${Mr.result}, uv2, ${zr});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:Fr=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${Mr.result}, bumpMapCachedUv, ${zr});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,Gt.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${Tr.result};
					${Fr}
					`)}Gt.push(gt.code,"	vec3 diffuseColor = "+gt.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",_t.code,"	vec3 specular = "+_t.result+";",Et.code,"	float shininess = max( 0.0001, "+Et.result+" );","	float specularStrength = 1.0;"),Nt&&Gt.push(Nt.code,"#ifdef ALPHATEST","if ( "+Nt.result+" <= ALPHATEST ) discard;","#endif"),Gt.push("material.diffuseColor = diffuseColor;"),Gt.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),Gt.push("vec3 ao = aoEnabled && "+mt.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let dr="1.0";this.mask&&(this.mask.analyze(nt),dr=`luminance(${this.mask.flow(nt,"v3").result})`),Gt.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${At.result} * ${dr} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${At.result} * ${dr}, ${Rt.result} );
					
					outgoingLight *= ao;
				}
				`),Ft&&Gt.push(Ft.code,`outgoingLight = spe_blend(outgoingLight, ${Ft.result}, 1.0, SPE_BLENDING_NORMAL);`),Nt?Gt.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${Nt.result});`):Gt.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),Bt&&Gt.push(`gl_FragColor.a *= ${Bt.result};`),Gt.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),st=Gt.join(`
`)}return st}},ym=class extends sr{constructor(){super("standard"),this.nodeType="Standard",this.color=new er(ii),this.roughness=new Fe$1(.3),this.metalness=new Fe$1(0),this.reflectivity=new Fe$1(.5),this.previousModelViewMatrix=new Qi,this.previouseProjectionMatrix=new Qi,this.shadingAlpha=new Fe$1(1),this.shadingBlend=new It(0),this.occlusion=new Kr(!0)}get category(){return"physical"}build(nt){let st;if(nt.define("STANDARD"),nt.requires.lights=!0,nt.extensions.derivatives=!0,nt.extensions.shaderTextureLOD=!0,nt.isShader("vertex")){let mt=this.position?this.position.analyzeAndFlow(nt,"v3",{cache:"position"}):void 0;nt.mergeUniform({frameIndex:$e$1.frameIndex}),nt.mergeUniform({resolution:$e$1.resolution}),nt.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),nt.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),nt.mergeUniform(Bs.merge([De$1.fog,De$1.lights])),De$1.LTC_1&&(nt.uniforms.ltc_1={value:void 0},nt.uniforms.ltc_2={value:void 0}),nt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let gt=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];mt&&gt.push(mt.code,mt.result?"displaced_position = "+mt.result+";":""),gt.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),gt.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),gt.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),st=gt.join(`
`)}else{nt.mergeUniform({penumbraSize:$e$1.penumbraSize}),nt.mergeUniform({frameIndex:$e$1.frameIndex}),nt.mergeUniform({aoMap:$e$1.aoRenderTarget}),nt.mergeUniform({aoEnabled:$e$1.aoEnabled});let mt={gamma:!0};this.color===void 0&&(this.color=new er(ii)),this.color.analyze(nt,{slot:"color",context:mt}),this.roughness.analyze(nt),this.metalness.analyze(nt);let gt=this.occlusion.flow(nt,"b",{slot:"occlusion"});this.shadingAlpha.analyze(nt),this.shadingBlend.analyze(nt),this.afterColor&&this.afterColor.analyze(nt,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(nt),this.reflectivity&&this.reflectivity.analyze(nt);let _t=this.color.flow(nt,"c",{slot:"color",context:mt}),Et=this.roughness.flow(nt,"f"),At=this.metalness.flow(nt,"f"),Rt=this.shadingAlpha.flow(nt,"f"),Ft=this.shadingBlend.flow(nt,"i"),Nt=this.afterColor?this.afterColor.flow(nt,"c",{slot:"afterColor"}):void 0,Bt=this.alpha?this.alpha.flow(nt,"f"):void 0,Gt=this.alphaOverride?this.alphaOverride.flow(nt,"f"):void 0,dr=this.reflectivity?this.reflectivity.flow(nt,"f"):void 0;nt.requires.transparent=Bt!==void 0,nt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let Mr=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){nt.include(Da.dHdxy),nt.include(Da.perturbNormalArb);let zr=this.bumpMap.texture.flow(nt,"t"),Fr=this.bumpMap.flow(nt,"v3"),Nr=this.bumpMapIntensity?this.bumpMapIntensity.flow(nt,"f").result:"1.0",tn="";this.bumpMap.projection.value===4?tn=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${zr.result}, uv0, ${Nr});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${zr.result}, uv1, ${Nr});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${zr.result}, uv2, ${Nr});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:tn=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${zr.result}, bumpMapCachedUv, ${Nr});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,Mr.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${Fr.result};
					${tn}
					`)}if(Mr.push(_t.code,"	vec3 diffuseColor = "+_t.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",At.code,"	float metalnessFactor = "+At.result+";"),this.roughnessMap){let zr=this.roughnessMap.texture.flow(nt,"t"),Fr=this.roughnessMap.flow(nt,"v3"),Nr="";this.roughnessMap.projection.value===4?Nr=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${zr.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${zr.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${zr.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${Et.result};
					`:Nr=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${zr.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${Et.result};
					`,Mr.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${Fr.result};

					const float roughnessScale = 1.0;

					${Nr}
				`)}else Mr.push(Et.code,"	float roughnessFactor = "+Et.result+";");Bt&&Mr.push(Bt.code,"#ifdef ALPHATEST","	if ( "+Bt.result+" <= ALPHATEST ) discard;","#endif"),Mr.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),Mr.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),dr?Mr.push(dr.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+dr.result+" ) ), diffuseColor, metalnessFactor );"):Mr.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),Mr.push("#include <lights_fragment_begin>"),Mr.push("#include <lights_fragment_end>"),Mr.push("vec3 ao = aoEnabled && "+gt.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let Tr="1.0";this.mask&&(this.mask.analyze(nt),Tr=`luminance(${this.mask.flow(nt,"v3").result})`),Mr.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${Rt.result} * ${Tr} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${Rt.result} * ${Tr}, ${Ft.result} );
					
					outgoingLight *= ao;
				}
				`),Nt&&Mr.push(Nt.code,`outgoingLight = spe_blend(outgoingLight, ${Nt.result}, 1.0, SPE_BLENDING_NORMAL);`),Bt?Mr.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${Bt.result} );`):Mr.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),Gt&&Mr.push(`gl_FragColor.a *= ${Gt.result};`),Mr.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),st=Mr.join(`
`)}return st}},vm=class extends sr{constructor(){super("toon"),this.nodeType="Toon",this.color=new er(ii),this.specular=new er(1118481),this.shininess=new Fe$1(30),this.previousModelViewMatrix=new Qi,this.previouseProjectionMatrix=new Qi,this.shadingAlpha=new Fe$1(1),this.shadingBlend=new It(0)}get category(){return"toon"}build(nt){let st;if(nt.define("TOON"),nt.requires.lights=!0,nt.extensions.derivatives=!0,nt.isShader("vertex")){let mt=this.position?this.position.analyzeAndFlow(nt,"v3",{cache:"position"}):void 0;nt.mergeUniform({frameIndex:$e$1.frameIndex}),nt.mergeUniform({resolution:$e$1.resolution}),nt.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),nt.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),nt.mergeUniform(Bs.merge([De$1.fog,De$1.lights])),nt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let gt=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];mt&&gt.push(mt.code,mt.result?"displaced_position = "+mt.result+";":""),gt.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),gt.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),gt.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),st=gt.join(`
`)}else{nt.mergeUniform({penumbraSize:$e$1.penumbraSize}),nt.mergeUniform({frameIndex:$e$1.frameIndex}),nt.mergeUniform({aoMap:$e$1.aoRenderTarget}),nt.mergeUniform({aoEnabled:$e$1.aoEnabled}),this.color===void 0&&(this.color=new er(ii)),this.color.analyze(nt,{slot:"color"}),this.specular.analyze(nt),this.shininess.analyze(nt),this.shadingAlpha.analyze(nt),this.shadingBlend.analyze(nt),this.afterColor&&this.afterColor.analyze(nt,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(nt);let mt=this.color.flow(nt,"c",{slot:"color"}),gt=this.specular.flow(nt,"c"),_t=this.shininess.flow(nt,"f"),Et=this.shadingAlpha.flow(nt,"f"),At=this.shadingBlend.flow(nt,"i"),Rt=this.afterColor?this.afterColor.flow(nt,"c",{slot:"afterColor"}):void 0,Ft=this.alpha?this.alpha.flow(nt,"f"):void 0,Nt=this.alphaOverride?this.alphaOverride.flow(nt,"f"):void 0;nt.requires.transparent=Ft!==void 0,nt.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let Bt=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){nt.include(Da.dHdxy),nt.include(Da.perturbNormalArb);let dr=this.bumpMap.texture.flow(nt,"t"),Mr=this.bumpMap.flow(nt,"v3"),Tr=this.bumpMapIntensity?this.bumpMapIntensity.flow(nt,"f").result:"1.0",zr="";this.bumpMap.projection.value===4?zr=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${dr.result}, uv0, ${Tr});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${dr.result}, uv1, ${Tr});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${dr.result}, uv2, ${Tr});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:zr=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${dr.result}, bumpMapCachedUv, ${Tr});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,Bt.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${Mr.result};
					${zr}
					`)}Bt.push(mt.code,"	vec3 diffuseColor = "+mt.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",gt.code,"	vec3 specular = "+gt.result+";",_t.code,"	float shininess = max( 0.0001, "+_t.result+" );","	float specularStrength = 1.0;"),Ft&&Bt.push(Ft.code,"#ifdef ALPHATEST","if ( "+Ft.result+" <= ALPHATEST ) discard;","#endif"),Bt.push("material.diffuseColor = diffuseColor;"),Bt.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),Bt.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let Gt="1.0";this.mask&&(this.mask.analyze(nt),Gt=`luminance(${this.mask.flow(nt,"v3").result})`),Bt.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${Et.result} * ${Gt} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${Et.result} * ${Gt}, ${At.result} );
				}
				`),Rt&&Bt.push(Rt.code,`outgoingLight = spe_blend(outgoingLight, ${Rt.result}, 1.0, SPE_BLENDING_NORMAL);`),Ft?Bt.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${Ft.result} );`):Bt.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),Nt&&Bt.push(`gl_FragColor.a *= ${Nt.result};`),Bt.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),st=Bt.join(`
`)}return st}},k0=class{constructor(nt=1e3*10){this.timeout=nt,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...nt){}remove(nt){let st=this.cache.get(nt);st&&(this.dispose(nt,st.data),this.cache.delete(nt),st.prev.next=st.next,st.next.prev=st.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let nt=Date.now(),st=this.head.next;for(;st.time<nt-this.timeout;)this.dispose(st.src,st.data),this.cache.delete(st.src),st=st.next,st.prev=this.head,this.head.next=st;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(nt){var st;return(st=this.cache.get(nt))==null?void 0:st.data}load(nt){let st=Date.now(),mt=this.cache.get(nt);return mt===void 0?(mt={data:this.create(nt),src:nt,time:st,next:null,prev:null},this.cache.set(nt,mt)):(mt.time=st,mt.prev.next=mt.next,mt.next.prev=mt.prev),mt.prev=this.tail.prev,mt.next=this.tail,this.tail.prev.next=mt,this.tail.prev=mt,this.scheduleCleanup(),mt.data}},iE=class extends k0{create(nt){return URL.createObjectURL(new Blob([nt]))}dispose(nt,st){URL.revokeObjectURL(st)}},rE;function uR(nt){return typeof nt=="string"?nt:(rE||(rE=new iE),rE.load(nt))}var G0=class{constructor(nt,st){this.data=nt,this.cache=st,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},j0=class{constructor(){this.cache=new Map}remove(nt){this.cache.delete(nt.data)}load(nt){let st=this.cache.get(nt);return st===void 0&&(st=this.create(nt),this.cache.set(nt,st)),st.refCount+=1,st}},Zd=class extends G0{constructor(nt,st){super(nt,st.imageHolderCache),this.data=nt,this.shared=st,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo=nt.type==="video",this.isBuffer=nt.isWebGLRenderTarget===!0,this.loadPromise=this.updateSrc(this.isBuffer?nt:nt.data)}async updateSrc(nt){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let st=()=>{this.loaded=!0;for(let gt of Object.values(this._cache))for(let _t of Object.values(gt))for(let Et of Object.values(_t))Et&&(Et.image=this.img,Et.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=nt,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof nt!="string"){var mt=new FileReader;mt.readAsDataURL(new Blob([nt],{type:"video/mp4"}));let gt;await new Promise(_t=>{mt.onloadend=Et=>{var At;gt=(At=Et.target)==null?void 0:At.result,_t(null)}}),this.img.src=gt}else this.img.src=nt;this.img.onloadeddata=()=>{st()}}else this.img=new Image,this.img.src=uR(nt),this.img.onload=st,await new Promise(gt=>{this.img.onload=()=>{st(),gt(null)}})}getTexture(nt,st=1008,mt=1006){var _t,Et;let gt=(Et=(_t=this._cache[nt])==null?void 0:_t[st])==null?void 0:Et[mt];if(gt)return gt;{let At;return this.isBuffer?At=this.img.texture:this.isVideo?At=new ay(this.img,void 0,nt,nt):At=new $t(this.img,void 0,nt,nt,mt,st),this.loaded&&(At.needsUpdate=!0),this._cache[nt]===void 0&&(this._cache[nt]={}),this._cache[nt][st]===void 0&&(this._cache[nt][st]={}),this._cache[nt][st][mt]=At,At}}setNeedsUpdate(nt){for(let st of Object.values(this._cache))for(let mt of Object.values(st))for(let gt of Object.values(mt))gt&&(gt.needsUpdate=nt)}disposeTextures(){for(let[nt,st]of Object.entries(this._cache))for(let[mt,gt]of Object.entries(st))for(let[_t,Et]of Object.entries(gt))Et==null||Et.dispose(),this._cache[nt]!==void 0&&this._cache[nt][mt]!==void 0&&(this._cache[nt][mt][_t]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},Jn=class extends Zd{};function sE(nt,st){var mt=MY(st);return mt.formatToParts?AY(mt,nt):EY(mt,nt)}var wY={year:0,month:1,day:2,hour:3,minute:4,second:5};function AY(nt,st){try{for(var mt=nt.formatToParts(st),gt=[],_t=0;_t<mt.length;_t++){var Et=wY[mt[_t].type];Et>=0&&(gt[Et]=parseInt(mt[_t].value,10))}return gt}catch(At){if(At instanceof RangeError)return[NaN];throw At}}function EY(nt,st){var mt=nt.format(st).replace(/\u200E/g,""),gt=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(mt);return[gt[3],gt[1],gt[2],gt[4],gt[5],gt[6]]}var nE={};function MY(nt){if(!nE[nt]){var st=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),mt=st==="06/25/2014, 00:00:00"||st==="06/25/2014 00:00:00";nE[nt]=mt?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:nt,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:nt,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return nE[nt]}function H0(nt,st,mt,gt,_t,Et,At){var Rt=new Date(0);return Rt.setUTCFullYear(nt,st,mt),Rt.setUTCHours(gt,_t,Et,At),Rt}var hR=36e5,TY=6e4,oE={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function xm(nt,st,mt){var gt,_t;if(!nt||(gt=oE.timezoneZ.exec(nt),gt))return 0;var Et;if(gt=oE.timezoneHH.exec(nt),gt)return Et=parseInt(gt[1],10),dR(Et)?-(Et*hR):NaN;if(gt=oE.timezoneHHMM.exec(nt),gt){Et=parseInt(gt[1],10);var At=parseInt(gt[2],10);return dR(Et,At)?(_t=Math.abs(Et)*hR+At*TY,Et>0?-_t:_t):NaN}if(_Y(nt)){st=new Date(st||Date.now());var Rt=mt?st:CY(st),Ft=aE(Rt,nt),Nt=mt?Ft:PY(st,Ft,nt);return-Nt}return NaN}function CY(nt){return H0(nt.getFullYear(),nt.getMonth(),nt.getDate(),nt.getHours(),nt.getMinutes(),nt.getSeconds(),nt.getMilliseconds())}function aE(nt,st){var mt=sE(nt,st),gt=H0(mt[0],mt[1]-1,mt[2],mt[3]%24,mt[4],mt[5],0).getTime(),_t=nt.getTime(),Et=_t%1e3;return _t-=Et>=0?Et:1e3+Et,gt-_t}function PY(nt,st,mt){var gt=nt.getTime(),_t=gt-st,Et=aE(new Date(_t),mt);if(st===Et)return st;_t-=Et-st;var At=aE(new Date(_t),mt);return Et===At?Et:Math.max(Et,At)}function dR(nt,st){return-23<=nt&&nt<=23&&(st==null||0<=st&&st<=59)}var fR={};function _Y(nt){if(fR[nt])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:nt}),fR[nt]=!0,!0}catch{return!1}}var AR=Jo(mR(),1),uE=Jo(yR(),1),OY=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,vR=OY,lE=36e5,xR=6e4,RY=2,Sn={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:vR};function hE(nt,st){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(nt===null)return new Date(NaN);var mt={},gt=mt.additionalDigits==null?RY:(0,AR.default)(mt.additionalDigits);if(gt!==2&&gt!==1&&gt!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(nt instanceof Date||typeof nt=="object"&&Object.prototype.toString.call(nt)==="[object Date]")return new Date(nt.getTime());if(typeof nt=="number"||Object.prototype.toString.call(nt)==="[object Number]")return new Date(nt);if(!(typeof nt=="string"||Object.prototype.toString.call(nt)==="[object String]"))return new Date(NaN);var _t=LY(nt),Et=BY(_t.date,gt),At=Et.year,Rt=Et.restDateString,Ft=NY(Rt,At);if(isNaN(Ft))return new Date(NaN);if(Ft){var Nt=Ft.getTime(),Bt=0,Gt;if(_t.time&&(Bt=FY(_t.time),isNaN(Bt)))return new Date(NaN);if(_t.timeZone||mt.timeZone){if(Gt=xm(_t.timeZone||mt.timeZone,new Date(Nt+Bt)),isNaN(Gt))return new Date(NaN)}else Gt=(0,uE.default)(new Date(Nt+Bt)),Gt=(0,uE.default)(new Date(Nt+Bt+Gt));return new Date(Nt+Bt+Gt)}else return new Date(NaN)}function LY(nt){var st={},mt=Sn.dateTimePattern.exec(nt),gt;if(mt?(st.date=mt[1],gt=mt[3]):(mt=Sn.datePattern.exec(nt),mt?(st.date=mt[1],gt=mt[2]):(st.date=null,gt=nt)),gt){var _t=Sn.timeZone.exec(gt);_t?(st.time=gt.replace(_t[1],""),st.timeZone=_t[1].trim()):st.time=gt}return st}function BY(nt,st){var mt=Sn.YYY[st],gt=Sn.YYYYY[st],_t;if(_t=Sn.YYYY.exec(nt)||gt.exec(nt),_t){var Et=_t[1];return{year:parseInt(Et,10),restDateString:nt.slice(Et.length)}}if(_t=Sn.YY.exec(nt)||mt.exec(nt),_t){var At=_t[1];return{year:parseInt(At,10)*100,restDateString:nt.slice(At.length)}}return{year:null}}function NY(nt,st){if(st===null)return null;var mt,gt,_t,Et;if(nt.length===0)return gt=new Date(0),gt.setUTCFullYear(st),gt;if(mt=Sn.MM.exec(nt),mt)return gt=new Date(0),_t=parseInt(mt[1],10)-1,SR(st,_t)?(gt.setUTCFullYear(st,_t),gt):new Date(NaN);if(mt=Sn.DDD.exec(nt),mt){gt=new Date(0);var At=parseInt(mt[1],10);return zY(st,At)?(gt.setUTCFullYear(st,0,At),gt):new Date(NaN)}if(mt=Sn.MMDD.exec(nt),mt){gt=new Date(0),_t=parseInt(mt[1],10)-1;var Rt=parseInt(mt[2],10);return SR(st,_t,Rt)?(gt.setUTCFullYear(st,_t,Rt),gt):new Date(NaN)}if(mt=Sn.Www.exec(nt),mt)return Et=parseInt(mt[1],10)-1,wR(st,Et)?bR(st,Et):new Date(NaN);if(mt=Sn.WwwD.exec(nt),mt){Et=parseInt(mt[1],10)-1;var Ft=parseInt(mt[2],10)-1;return wR(st,Et,Ft)?bR(st,Et,Ft):new Date(NaN)}return null}function FY(nt){var st,mt,gt;if(st=Sn.HH.exec(nt),st)return mt=parseFloat(st[1].replace(",",".")),cE(mt)?mt%24*lE:NaN;if(st=Sn.HHMM.exec(nt),st)return mt=parseInt(st[1],10),gt=parseFloat(st[2].replace(",",".")),cE(mt,gt)?mt%24*lE+gt*xR:NaN;if(st=Sn.HHMMSS.exec(nt),st){mt=parseInt(st[1],10),gt=parseInt(st[2],10);var _t=parseFloat(st[3].replace(",","."));return cE(mt,gt,_t)?mt%24*lE+gt*xR+_t*1e3:NaN}return null}function bR(nt,st,mt){st=st||0,mt=mt||0;var gt=new Date(0);gt.setUTCFullYear(nt,0,4);var _t=gt.getUTCDay()||7,Et=st*7+mt+1-_t;return gt.setUTCDate(gt.getUTCDate()+Et),gt}var VY=[31,28,31,30,31,30,31,31,30,31,30,31],UY=[31,29,31,30,31,30,31,31,30,31,30,31];function ER(nt){return nt%400===0||nt%4===0&&nt%100!==0}function SR(nt,st,mt){if(st<0||st>11)return!1;if(mt!=null){if(mt<1)return!1;var gt=ER(nt);if(gt&&mt>UY[st]||!gt&&mt>VY[st])return!1}return!0}function zY(nt,st){if(st<1)return!1;var mt=ER(nt);return!(mt&&st>366||!mt&&st>365)}function wR(nt,st,mt){return!(st<0||st>52||mt!=null&&(mt<0||mt>6))}function cE(nt,st,mt){return!(nt!=null&&(nt<0||nt>=25)||st!=null&&(st<0||st>=60)||mt!=null&&(mt<0||mt>=60))}function Y0(nt,st,mt){var gt=hE(nt,mt),_t=xm(st,gt,!0),Et=new Date(gt.getTime()-_t),At=new Date(0);return At.setFullYear(Et.getUTCFullYear(),Et.getUTCMonth(),Et.getUTCDate()),At.setHours(Et.getUTCHours(),Et.getUTCMinutes(),Et.getUTCSeconds(),Et.getUTCMilliseconds()),At}function Ki(nt,st){return st.color(nt)}function dE(nt=new Date,st){let mt=st.format,gt=nt.getSeconds(),_t=nt;st&&st.timeZone!==null&&(_t=Y0(new Date,st.timeZone));let Et=_t.getHours(),At=_t.getMinutes(),Rt;st.format12h24h==="12ampm"&&(Rt=Et>=12?"PM":"AM");let Ft=Et;st.format12h24h!=="24"&&(Ft=Et%12,Ft===0&&(Ft=12));let Nt,Bt;switch(mt){case"HH:mm:ss":Nt=[Ft,At,gt];break;case"HH:mm":Nt=[Ft,At];break;case"HH":Nt=[Ft],Rt=void 0;break;case"mm":Nt=[At],Rt=void 0;break;case"ss":Nt=[gt],Rt=void 0;break;case"year":Bt=_t.getFullYear();break;case"month":Bt=_t.getMonth()+1;break;case"dayOfYear":Bt=Math.floor((_t.getTime()-new Date(_t.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":Bt=_t.getDate();break;case"secondOfDay":Bt=Et*60*60+At*60+gt;break;default:console.error("Unknown time format",mt),Bt=0;break}return Nt!==void 0?{textValue:Nt,suffix:Rt}:Bt}function MR(nt,st){switch(nt.type){case"fresnel":return jY(nt,st);case"gradient":return HY(nt,st);case"depth":return WY(nt,st);case"normal":return qY(nt,st);case"noise":return YY(nt,st);case"rainbow":return XY(nt,st);case"toon":return QY(nt,st);case"outline":return KY(nt,st);case"transmission":return ZY(nt,st);case"color":return GY(nt,st);case"pattern":return JY(nt,st)}}function kY(nt){return{type:nt.type}}function Qs(nt,st){let{alpha:mt,mode:gt,isMask:_t}=nt,Et=typeof mt=="string"?(Number(st.getVariable(mt))??100)/100:mt;return{...kY(nt),alpha:Et,mode:gt,isMask:_t}}function GY(nt,st){return{...Qs(nt,st),color:Ki(nt.color,st)}}function jY(nt,st){let{bias:mt,scale:gt,intensity:_t,factor:Et,color:At}=nt;return{...Qs(nt,st),color:Ki(At,st),bias:mt,scale:gt,intensity:_t,factor:Et}}function HY(nt,st){let{gradientType:mt,smooth:gt,colors:_t,steps:Et,angle:At,offset:Rt,morph:Ft}=nt;return{...Qs(nt,st),gradientType:mt,smooth:gt,colors:_t.map(Nt=>new Ze$1(Nt[0],Nt[1],Nt[2],Nt[3])),num:_t.length,steps:Et,offset:new U$1(...Rt),morph:new U$1(...Ft),angle:At}}function WY(nt,st){let{gradientType:mt,near:gt,far:_t,isVector:Et,isWorldSpace:At,origin:Rt,direction:Ft,colors:Nt,steps:Bt,smooth:Gt}=nt;return{...Qs(nt,st),gradientType:mt,near:gt,far:_t,isVector:Et,isWorldSpace:At,origin:new E$6(...Rt),direction:Ft?new E$6(...Ft):new E$6(1,0,0),colors:Nt.map(dr=>dr!==void 0?new Ze$1(dr[0],dr[1],dr[2],dr[3]):new Ze$1(0,0,0,0)),steps:Bt.slice(0,Nt.length),smooth:Gt}}function qY(nt,st){let{cnormal:mt}=nt;return{...Qs(nt,st),cnormal:new E$6(mt[0],mt[1],mt[2])}}function YY(nt,st){return{...Qs(nt,st),scale:nt.scale,move:nt.move,fA:new U$1(...nt.fA),fB:new U$1(...nt.fB),size:new E$6(...nt.size),distortion:new U$1(...nt.distortion),colorA:Ki(nt.colorA,st),colorB:Ki(nt.colorB,st),colorC:Ki(nt.colorC,st),colorD:Ki(nt.colorD,st),noiseType:nt.noiseType,voronoiStyle:nt.voronoiStyle,highCut:nt.highCut,lowCut:nt.lowCut,smoothness:nt.smoothness,seed:nt.seed,quality:nt.quality}}function XY(nt,st){return{...Qs(nt,st),filmThickness:nt.filmThickness,movement:nt.movement,wavelengths:new E$6(...nt.wavelengths),noiseStrength:nt.noiseStrength,noiseScale:nt.noiseScale,offset:new E$6(...nt.offset)}}function QY(nt,st){return{...Qs(nt,st),positioning:nt.positioning,colors:nt.colors.map(mt=>new Ze$1(mt[0],mt[1],mt[2],mt[3])),num:nt.colors.length,steps:nt.steps,source:new E$6(...nt.source),isWorldSpace:nt.isWorldSpace,noiseStrength:nt.noiseStrength,noiseScale:nt.noiseScale,shadowColor:Ki(nt.shadowColor,st),offset:new E$6(...nt.offset)}}function KY(nt,st){return{...Qs(nt,st),outlineColor:Ki(nt.outlineColor,st),contourColor:Ki(nt.contourColor,st),outlineWidth:nt.outlineWidth,contourWidth:nt.contourWidth,outlineThreshold:nt.outlineThreshold,contourThreshold:nt.contourThreshold,outlineSmoothing:nt.outlineSmoothing,contourFrequency:nt.contourFrequency,contourDirection:new E$6(...nt.contourDirection),positionalLines:nt.positionalLines,compensation:nt.compensation}}function ZY(nt,st){return{...Qs(nt,st),thickness:nt.thickness,ior:nt.ior,roughness:nt.roughness}}function JY(nt,st){return{...Qs(nt,st),style:nt.style,projection:nt.projection,axis:nt.axis,blending:nt.blending,offset:new U$1(...nt.offset),colorA:Ki(nt.colorA,st),colorB:Ki(nt.colorB,st),frequency:new U$1(...nt.frequency),size:nt.size,variation:nt.variation,smoothness:nt.smoothness,zigzag:nt.zigzag,rotation:nt.rotation,vertical:new U$1(...nt.vertical),horizontal:new U$1(...nt.horizontal),sides:nt.sides}}var Nl=class extends vr{},$Y={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},eX={depth:["colors"]};function tX(nt,st,mt){var Et,At;if(st==="isMask")return!0;let gt=$Y[nt.type],_t=eX[nt.type];if(_t!==void 0){let Rt=nt.color;if(_t.includes(st)){let Ft=(At=(Et=Rt[st])==null?void 0:Et.value)==null?void 0:At.length;if(Ft!==void 0&&Ft!==mt.length)return!0}}return gt!==void 0?gt.includes(st):!1}function fE(nt,st,mt){let gt=mt.uniforms[`f${mt.id}_texture`];if(!gt)return!1;let _t=!1,Et=nt;if("image"in Et){let At=Et.image,Rt=st.image(At),Ft=gt;Ft.image instanceof Jn||Ft.image.deref(),Ft.image=Rt}if("video"in Et){let At=Et.video,Rt=st.video(At),Ft=gt;Ft.image instanceof Jn||Ft.image.deref(),Ft.image=Rt}if("wrapping"in Et){let At=gt;At.wrap=Et.wrapping}if("minFilter"in Et){let At=gt;At.minFilter=Et.minFilter}if("magFilter"in Et){let At=gt;At.magFilter=Et.magFilter}if("rotation"in Et&&mt.uniforms[`f${mt.id}_rotation`])return mt.uniforms[`f${mt.id}_rotation`].value=(Et.rotation??0)*we$1.DEG2RAD,_t;if("repeat"in Et||"offset"in Et||"rotation"in Et){let At="mat",Rt=mt.uniforms[`f${mt.id}_${At}`];"repeat"in Et&&(Rt.repeat=Et.repeat),"offset"in Et&&(Rt.offset=Et.offset),"rotation"in Et&&(Rt.rotation=Et.rotation??0),Rt.updateMatrix()}return _t}function TR(nt,st,mt,gt){let _t=!1;for(let[Et,At]of Object.entries(nt)){if(Et==="bumpMap"||Et==="roughnessMap"){_t=!0;continue}if(!Et||At===void 0)continue;if(pE(Et,mt,gt,st)){Et==="visible"&&mt.type==="light"&&(_t=!0);continue}mt.visible=gt.visible;let Rt=mt.uniforms[`f${mt.id}_${Et}`];if(Rt&&!(Rt instanceof Ll))switch(_t=_t||tX(mt,Et,At),Rt.constructor){case er:if(typeof At=="string"){let Ft=st.getColor(At);Ft&&(Rt.value=Ft);break}else{let Ft=At;Rt.value instanceof Nl?Rt.value=new vr(Ft.r,Ft.g,Ft.b,Ft.a):Rt.setRGBA(Ft);break}case Ln:if(typeof At=="string"){let Ft=st.getColor(At);Ft&&(Rt.value=Ft);break}else{let Ft=At;Rt.value instanceof Nl?Rt.value=new vr(Ft.r,Ft.g,Ft.b,Ft.a):Rt.value.setRGBA(Ft.r,Ft.g,Ft.b,Ft.a);break}case Hr:{let Ft=At;Rt.value.setX(Ft[0]),Rt.value.setY(Ft[1]);break}case Xi:{let Ft=At;Rt.value.setX(Ft[0]),Rt.value.setY(Ft[1]),Rt.value.setZ(Ft[2]);break}case bn:{fE(At,st,mt);break}case Xs:{Rt.value=At.map(Ft=>new Ze$1(...Ft));break}default:{Rt.value=At;break}}}return _t}var Fl=(nt,st,mt)=>Math.max(0,Math.min(1,Number(st.getVariable(typeof nt=="number"?nt*100:nt,mt)??100)/100))??1,Vl=class{constructor(nt,st,mt,gt,_t){this.id=nt,this.uuid=st,this.data=mt,this.uniforms={};for(let Et in gt)this.uniforms[`f${this.id}_${Et}`]=gt[Et];for(let Et in mt)pE(Et,this,mt,_t)}get type(){return this.data.type}static create(nt,st,mt,gt){if(mt.type==="light")return wn.createLigherLayer(nt,st,mt,gt);if(mt.type==="texture"||mt.type==="video"){let _t=mt.type==="texture"?gt.uiBuffer(mt.texture.image)??gt.image(mt.texture.image):gt.video(mt.texture.video),Et=new Gc(_t,mt.texture.wrapping,mt.texture.minFilter??1008,mt.texture.magFilter??1006),At=new V0(_t),Rt=new U0(mt.texture.repeat,mt.texture.offset,mt.texture.rotation??0),Ft=new Fe$1(mt.crop?1:0),Nt=new It(mt.projection??0),Bt=new It(["x","y","z"].indexOf(mt.axis)??0),Gt=new It(mt.side??0),dr=new Hr(mt.size?new U$1(mt.size[0],mt.size[1]):new U$1(100,100)),Mr=new Fe$1(mt.blending??0),Tr=new Fe$1(Fl(mt.alpha,gt)),zr=new It(mt.mode??0),Fr=new Kr(mt.isMask??!1),Nr=new Bl(Et,At,Ft,Nt,Bt,Gt,dr,Mr,Rt,Tr,zr,Fr),tn=new Yt(Nr.calpha,"f");return new Ir(nt,st,mt,{texture:Et,textureSize:At,crop:Ft,projection:Nt,axis:Bt,side:Gt,size:dr,blending:Mr,mat:Rt,alpha:Tr,mode:zr,isMask:Fr},Nr,zr,tn,Fr,gt)}else if(mt.type==="matcap"){let _t=gt.image(mt.texture.image),Et=new Gc(_t,mt.texture.wrapping,mt.texture.minFilter??1008,mt.texture.magFilter??1006),At=new Fe$1(Fl(mt.alpha,gt)),Rt=new It(mt.mode??0),Ft=new Kr(mt.isMask??!1),Nt=new Fe$1((mt.texture.rotation??0)*we$1.DEG2RAD),Bt=new jd(Et,At,Rt,Ft,Nt),Gt=new Yt(Bt.calpha,"f");return new Ir(nt,st,mt,{texture:Et,alpha:At,mode:Rt,isMask:Ft,rotation:Nt},Bt,Rt,Gt,Ft,gt)}else if(mt.type==="displace")if(mt.displacementType==="noise"){let _t=new Xi(new E$6(...mt.offset)),Et=new Fe$1(mt.scale??10),At=new Fe$1(mt.intensity??8),Rt=new Fe$1(mt.movement??1),Ft=new It(mt.noiseType??0),Nt=new It(mt.voronoiStyle??0),Bt=new Fe$1(mt.smoothness??.5),Gt=new Fe$1(mt.seed??0),dr=new Fe$1(mt.highCut??1),Mr=new Fe$1(mt.lowCut??0),Tr=new It(mt.quality??1),zr=new Kd(At,Rt,_t,Nt,Bt,Gt,dr,Mr,Tr,Et,Ft);return new bm(nt,st,mt,{offset:_t,scale:Et,intensity:At,movement:Rt,noiseType:Ft,voronoiStyle:Nt,smoothness:Bt,seed:Gt,highCut:dr,lowCut:Mr,quality:Tr},zr,gt)}else throw new Error;else return nX(nt,st,mt,gt)}updateByOp(nt,st,mt){let gt=nt;if(gt.path[0]===void 0){if(gt.type===0)return"type"in gt.props||"category"in gt.props||"visible"in gt.props?(mt.scene.markNeedsUpdateRendererDirty(),!0):TR(gt.props,mt.shared,this,st)}else if(gt.path[0]==="texture")return"texture"in st||"video"in st?fE(gt.props,mt.shared,this):!0;return!1}dispose(){if(rX(this)){let nt=this.uniforms[`f${this.id}_texture`];if(!nt)return!1;let st=nt;st.image instanceof Jn||st.image.deref()}}hasValueByKey(nt){return this.uniforms[nt]!==void 0}hasValue(nt){return this.hasValueByKey(`f${this.id}_${nt}`)}setValue(nt,st){let mt=`f${this.id}_${nt}`;this.hasValueByKey(mt)&&st!==void 0&&(this.uniforms[mt].value=st)}getNode(nt){let st=`f${this.id}_${nt}`;if(this.hasValueByKey(st))return this.uniforms[st]}getValue(nt){let st=`f${this.id}_${nt}`;if(this.hasValueByKey(st))return this.uniforms[st].value}getName(nt){let st=/f\d+_(.*)/.exec(nt);if(st&&st.length>1)return st[1];console.log(`Layer.getName: error ${nt}`)}getNames(){let nt=[];for(let st in this.uniforms){let mt=this.getName(st);mt&&nt.push(mt)}return nt}},Ir=class extends Vl{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft){super(nt,st,mt,gt,Ft),this.params=gt,this.color=_t,this.mode=Et,this.alpha=At,this.isMask=Rt}},bm=class extends Vl{constructor(nt,st,mt,gt,_t,Et){super(nt,st,mt,gt,Et),this.position=_t}},wn=class extends Vl{constructor(nt,st,mt,gt,_t,Et){super(nt,st,mt,_t,Et),this.node=gt}static createLigherLayer(nt,st,mt,gt){let _t,Et=new Fe$1(Fl(mt.alpha,gt)),At=new It(mt.mode),Rt=new Fe$1(mt.bumpMapIntensity),Ft=new Fe$1(Fl(mt.alphaOverride,gt)),Nt;if(!mt.visible)_t=new _a,Nt={};else if(mt.category==="lambert"){_t=new mm;let Bt=new er(gt.color(mt.emissive)??0),Gt=new Kr(mt.occlusion??!0);Nt={emissive:Bt,occlusion:Gt},_t.emissive=Bt,_t.occlusion=Gt}else if(mt.category==="toon"){_t=new vm;let Bt=new Fe$1(mt.shininess??30),Gt=new er(gt.color(mt.specular)??1118481);Nt={shininess:Bt,specular:Gt},_t.shininess=Bt,_t.specular=Gt}else if(mt.category==="physical"){_t=new ym;let Bt=new Fe$1(mt.roughness??.3),Gt=new Fe$1(mt.metalness??0),dr=new Fe$1(mt.reflectivity??.5),Mr=new Kr(mt.occlusion??!0);Nt={roughness:Bt,metalness:Gt,reflectivity:dr,occlusion:Mr},_t.roughness=Bt,_t.metalness=Gt,_t.reflectivity=dr,_t.occlusion=Mr}else{_t=new gm;let Bt=new Fe$1(mt.shininess??30),Gt=new er(mt.specular!==void 0?gt.color(mt.specular)??1118481:1118481),dr=new Kr(mt.occlusion??!0);Nt={shininess:Bt,specular:Gt,occlusion:dr},_t.shininess=Bt,_t.specular=Gt,_t.occlusion=dr}return _t.alpha=new Fe$1(1),_t.shadingAlpha=Et,_t.shadingBlend=At,_t.bumpMapIntensity=Rt,_t.alphaOverride=Ft,Nt.alpha=_t.shadingAlpha,Nt.mode=_t.shadingBlend,Nt.bumpMapIntensity=_t.bumpMapIntensity,Nt.alphaOverride=_t.alphaOverride,new wn(nt,st,mt,_t,Nt,gt)}get category(){return this.node.category}};function rX(nt){let st=nt instanceof Vl?nt.type:nt;return st==="texture"||st==="video"||st==="displace_map"||st==="matcap"}function gs(nt){return{alpha:new Fe$1(nt.alpha??1),mode:new It(nt.mode??0),isMask:new Kr(nt.isMask??!1)}}function iX(nt,st,mt,gt,_t){switch(nt.type){case"color":{let Et=new er(gt.color??ii),At=gs(gt),Rt=new jc(Et,At.alpha),Ft=new Yt(Rt.calpha,"f");return new Ir(st,mt,nt,{color:Et,...At},Rt,At.mode,Ft,At.isMask,_t)}case"fresnel":{let Et=new er(gt.color??16777215),At=new Fe$1(gt.bias??.1),Rt=new Fe$1(gt.scale??1),Ft=new Fe$1(gt.intensity??2),Nt=new Fe$1(gt.factor??1),Bt=gs(gt),Gt=new fm(Et,At,Rt,Ft,Nt,Bt.alpha,Bt.mode,Bt.isMask),dr=new Yt(Gt.calpha,"f");return new Ir(st,mt,nt,{color:Et,bias:At,scale:Rt,intensity:Ft,factor:Nt,...Bt},Gt,Bt.mode,dr,Bt.isMask,_t)}case"rainbow":{let Et=new Fe$1(gt.filmThickness??30),At=new Fe$1(gt.movement??0),Rt=new Xi(gt.wavelengths??new E$6(0,0,0)),Ft=new Fe$1(gt.noiseStrength??0),Nt=new Fe$1(gt.noiseScale??1),Bt=new Xi(gt.offset??new E$6(0,0,0)),Gt=gs(gt),dr=new Yd(Et,At,Rt,Ft,Nt,Bt,Gt.alpha,Gt.isMask),Mr=new Yt(dr.calpha,"f");return new Ir(st,mt,nt,{filmThickness:Et,movement:At,wavelengths:Rt,noiseStrength:Ft,noiseScale:Nt,offset:Bt,...Gt},dr,Gt.mode,Mr,Gt.isMask,_t)}case"transmission":{let Et=new Fe$1(gt.thickness??10),At=new Fe$1(gt.ior??1.5),Rt=new Fe$1(gt.roughness??.5),Ft=$e$1.transmissionSize,Nt=$e$1.transmissionRenderTarget,Bt=$e$1.transmissionRenderTargetDepth,Gt=window.innerWidth,dr=window.innerHeight,Mr=Gt>=dr?new Hr(dr/Gt,1):new Hr(1,Gt/dr),Tr=gs(gt),zr=new Qd(Et,At,Rt,Ft,Nt,Bt,Mr,Tr.alpha),Fr=new Yt(zr.calpha,"f");return new Ir(st,mt,nt,{thickness:Et,ior:At,roughness:Rt,aspectRatio:Mr,...Tr},zr,Tr.mode,Fr,Tr.isMask,_t)}case"toon":{let Et=new It(gt.positioning??0),At;gt.colors?At=new Xs(gt.colors.length,gt.colors):(At=new Xs(10,new Ze$1(0,0,0,1)),At.value[1]=new Ze$1(1,1,1,1));let Rt;gt.steps?Rt=new Ys(gt.steps.length,gt.steps):(Rt=new Ys(10,1),Rt.value[0]=0);let Ft=new Xi(gt.source??new E$6(0,0,0)),Nt=new Kr(gt.isWorldSpace??!0),Bt=new Fe$1(gt.noiseStrength??0),Gt=new Fe$1(gt.noiseScale??1),dr=new Ln(gt.shadowColor),Mr=new Xi(gt.offset??new E$6(0,0,0)),Tr=gs(gt),zr=new Xd(Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr.alpha),Fr=new Yt(zr.calpha,"f");return new Ir(st,mt,nt,{positioning:Et,colors:At,steps:Rt,source:Ft,isWorldSpace:Nt,noiseStrength:Bt,noiseScale:Gt,shadowColor:dr,offset:Mr,...Tr},zr,Tr.mode,Fr,Tr.isMask,_t)}case"outline":{let Et=new er(gt.outlineColor??16777215),At=new er(gt.contourColor??16777215),Rt=new Fe$1(gt.outlineWidth??.1),Ft=new Fe$1(gt.contourWidth??.1),Nt=new Fe$1(gt.outlineThreshold??.1),Bt=new Fe$1(gt.contourThreshold??.1),Gt=new Fe$1(gt.outlineSmoothing??.1),dr=new Fe$1(gt.contourFrequency??.1),Mr=new Xi(gt.contourDirection??new E$6(0,1,0)),Tr=new Kr(gt.positionalLines??!1),zr=new Kr(gt.compensation??!0),Fr=$e$1.normalRenderTarget,Nr=$e$1.normalRenderTargetDepth,tn=$e$1.pixelRatioNode,rn=$e$1.resolution,Tn=gs(gt),$n=new Wd(Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,rn,Fr,Nr,tn,Tn.alpha),un=new Yt($n.calpha,"f");return new Ir(st,mt,nt,{outlineColor:Et,contourColor:At,outlineWidth:Rt,contourWidth:Ft,outlineThreshold:Nt,contourThreshold:Bt,outlineSmoothing:Gt,contourFrequency:dr,contourDirection:Mr,positionalLines:Tr,compensation:zr,...Tn},$n,Tn.mode,un,Tn.isMask,_t)}case"depth":{let Et=new It(gt.gradientType??0),At=new Kr(gt.smooth??!1),Rt=new Fe$1(gt.near??50),Ft=new Fe$1(gt.far??200),Nt=new Fe$1(gt.isVector??1),Bt=new Fe$1(gt.isWorldSpace??0),Gt=new Xi(gt.origin??new E$6),dr=new Xi(gt.direction??new E$6),Mr;gt.colors?Mr=new Xs(gt.colors.length,gt.colors):(Mr=new Xs(2,new Ze$1(0,0,0,1)),Mr.value[1]=new Ze$1(1,1,1,1));let Tr;gt.steps?Tr=new Ys(gt.steps.length,gt.steps):(Tr=new Ys(2,1),Tr.value[0]=0);let zr=gs(gt),Fr=new kd(Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr.alpha,zr.isMask),Nr=new Yt(Fr.calpha,"f");return new Ir(st,mt,nt,{gradientType:Et,smooth:At,near:Rt,far:Ft,isVector:Nt,isWorldSpace:Bt,origin:Gt,direction:dr,colors:Mr,steps:Tr,...zr},Fr,zr.mode,Nr,zr.isMask,_t)}case"noise":{let Et=new Fe$1(gt.scale??1),At=new Xi(gt.size??new E$6(100,100,100)),Rt=new Fe$1(gt.move??1),Ft=new Hr(gt.fA??new U$1(1.7,9.2)),Nt=new Hr(gt.fB??new U$1(8.3,2.8)),Bt=new Hr(gt.distortion??new U$1(1,1)),Gt=new Ln(gt.colorA),dr=new Ln(gt.colorB),Mr=new Ln(gt.colorC),Tr=new Ln(gt.colorD),zr=new It(gt.noiseType??0),Fr=new It(gt.voronoiStyle??0),Nr=new Fe$1(gt.highCut??1),tn=new Fe$1(gt.lowCut??0),rn=new Fe$1(gt.smoothness??.5),Tn=new Fe$1(gt.seed??.5),$n=new It(gt.quality??1),un=gs(gt),es=new Hd(Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,un.alpha,zr,un.isMask,Fr,Nr,tn,rn,Tn,$n),kn=new Yt(es.calpha,"f");return new Ir(st,mt,nt,{scale:Et,size:At,move:Rt,fA:Ft,fB:Nt,distortion:Bt,colorA:Gt,colorB:dr,colorC:Mr,colorD:Tr,noiseType:zr,...un,voronoiStyle:Fr,highCut:Nr,lowCut:tn,smoothness:rn,seed:Tn,quality:$n},es,un.mode,kn,un.isMask,_t)}case"normal":{let Et=new Xi(gt.cnormal??new E$6(1,1,1)),At=gs(gt),Rt=new Vd(Et,At.alpha),Ft=new Yt(Rt.calpha,"f");return new Ir(st,mt,nt,{cnormal:Et,...At},Rt,At.mode,Ft,At.isMask,_t)}case"gradient":{let Et=new It(gt.gradientType??0),At=new Kr(gt.smooth??!1),Rt;gt.colors?Rt=new Xs(gt.colors.length,gt.colors):(Rt=new Xs(10,new Ze$1(0,0,0,1)),Rt.value[1]=new Ze$1(1,1,1,1));let Ft;gt.steps?Ft=new Ys(gt.steps.length,gt.steps):(Ft=new Ys(10,1),Ft.value[0]=0);let Nt=new Hr(gt.offset??new U$1(0,0)),Bt=new Hr(gt.morph??new U$1(0,0)),Gt=new Fe$1(gt.angle??0),dr=gs(gt),Mr=new Gd(Et,At,Rt,Ft,Nt,Bt,Gt,dr.alpha,dr.isMask),Tr=new Yt(Mr.calpha,"f");return new Ir(st,mt,nt,{gradientType:Et,smooth:At,colors:Rt,steps:Ft,offset:Nt,morph:Bt,angle:Gt,...dr},Mr,dr.mode,Tr,dr.isMask,_t)}case"pattern":{let Et=new It(gt.style??0),At=new It(gt.projection??0),Rt=new It(["x","y","z"].indexOf(gt.axis)??0),Ft=new Fe$1(gt.blending??0),Nt=new Hr(gt.offset??new U$1(0,0)),Bt=new Ln(gt.colorA),Gt=new Ln(gt.colorB),dr=new Hr(gt.frequency??new U$1(10,10)),Mr=new Fe$1(gt.size??.5),Tr=new Fe$1(gt.variation??0),zr=new Fe$1(gt.smoothness??.5),Fr=new Fe$1(gt.zigzag??0),Nr=new Fe$1(gt.rotation??0),tn=new Hr(gt.vertical??new U$1(0,1)),rn=new Hr(gt.horizontal??new U$1(0,1)),Tn=new It(gt.sides??6),$n=gs(gt),un=new qd(Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr,Nr,tn,rn,Tn,$n.alpha,$n.isMask),es=new Yt(un.calpha,"f");return new Ir(st,mt,nt,{style:Et,projection:At,axis:Rt,blending:Ft,offset:Nt,colorA:Bt,colorB:Gt,frequency:dr,size:Mr,variation:Tr,smoothness:zr,zigzag:Fr,rotation:Nr,vertical:tn,horizontal:rn,sides:Tn,...$n},un,$n.mode,es,$n.isMask,_t)}default:{let Et=new er(1,0,0,1),At=gs(gt),Rt=new jc(Et,At.alpha),Ft=new Yt(Rt.calpha,"f");return new Ir(st,mt,nt,{color:Et,...At},Rt,At.mode,Ft,At.isMask,_t)}}}function nX(nt,st,mt,gt){let _t=MR(mt,gt);return iX(mt,nt,st,_t,gt)}function pE(nt,st,mt,gt){if(mt.type==="displace"&&(nt==="intensity"||nt==="visible")){let _t=st.uniforms[`f${st.id}_intensity`];return _t?(_t.value=mt.intensity*(mt.visible?1:0),_t):void 0}if(mt.type!=="displace"&&(nt==="alpha"||nt==="visible")){let _t=st.uniforms[`f${st.id}_alpha`];if(!_t)return;if(_t.value=Fl(mt.alpha,gt)*(mt.visible?1:0),mt.type==="outline"&&nt==="visible"){let Et=st.uniforms[`f${st.id}_compensation`];Et&&(Et.value=mt.compensation&&mt.visible)}return _t}}function Wc(nt,st){let mt=0,gt=nt.layers.find(_t=>_t.data.type==="light");if(gt){let _t=gt.data,Et=Number(st.getVariable(_t.alphaOverride));if((typeof _t.alphaOverride=="string"?Et/100:_t.alphaOverride)<1)return!0}for(let _t of nt.layers){if(_t.data.type!=="displace"&&_t.data.isMask)return!0;if(_t.data.type!=="displace"&&"alpha"in _t.data&&_t.data.type!=="light"&&_t.data.type!=="fresnel"&&_t.data.type!=="texture"&&_t.data.type!=="matcap"&&_t.data.type!=="rainbow"&&_t.data.type!=="outline"&&_t.data.type!=="pattern"){let Et=_t.data.visible?_t.data.alpha:0;if(typeof Et=="string"&&(Et=Math.max(0,Math.min(1,Number(st.getVariable(Et)??100)/100))),Et===1&&_t.data.type==="depth"||_t.data.type==="gradient"){for(let At of _t.data.colors)if(At[3]<1){Et=At[3];break}}else if(Et===1&&_t.data.type==="noise"){let At=st.color(_t.data.colorA).a,Rt=st.color(_t.data.colorB).a,Ft=st.color(_t.data.colorC).a,Nt=st.color(_t.data.colorD).a,Bt=Math.min(At,Math.min(Rt,Math.min(Ft,Nt)));Bt<1&&(Et=Bt)}mt+=(1-mt)*Et}}return mt<1}var Nn=class extends it$1{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},X0=class extends Nn{constructor(nt,st,mt,gt){super(),this.flatShading=nt,this.side=st,this.wireframe=mt,this.root=gt}updateAfterBuild(){let nt=this.root;this.lights=nt.lights,this.vertexShader=nt.vertexShader,this.fragmentShader=nt.fragmentShader,this.defines=nt.defines,this.uniforms=nt.uniforms,this.extensions=nt.extensions,this.transparent=nt.transparent,this.cacheKey=nt.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(nt,st){this.root.onBeforeCompile(nt)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(nt,st,mt){return this.root.getFlavor(nt,st,mt)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(nt){return this.root.getLayersOfType(nt)}getLayerByUuid(nt){return this.root.getLayerByUuid(nt)}updateByOp(nt,st,mt){this.root.updateByOp(nt,st,mt)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},Ia=class extends Nn{constructor(nt,st,mt=!0){super(),this.data=nt,this.allowVariableSaves=mt,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=st.shared.needsJitter,sr.startContext(this),this.reset0(nt,st),sr.endContext(this)}get nodeMaterial(){return this}getFlavor(nt,st,mt){let gt=mt?6:(nt?3:0)+st;if(gt===0)return this;this.flavors===void 0&&(this.flavors=[]),gt-=1;let _t=this.flavors[gt];return _t===void 0&&(_t=new X0(nt,st,mt,this),_t.needsJitter=this.needsJitter,this.flavors[gt]=_t,_t.flatShading=nt,_t.side=st,_t.updateAfterBuild()),_t}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var nt;return((nt=this.lightLayer.getNode("occlusion"))==null?void 0:nt.value)??!1}reset(nt,st,mt=!1){sr.startContext(this),(this.data!==nt||mt)&&this.reset0(nt,st),sr.endContext(this)}reset0(nt,st){this.data=nt;let mt=nt.layers??Qr.defaultTwoLayerData("phong").layers;try{this.layers=mt.map(gt=>Vl.create(this.layerIdGen++,gt.id,gt.data,st.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=nt.name??"Untitled Material",this.onUpdate(st.shared),this.transparent=Wc(nt,st.shared),this.saveVariableLocations(st)}onVariableUpdate(nt,st,mt){if(nt[0]==="alphaOverride")this.transparent=Wc(this.data,mt.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(st)/100,1)));else if(nt[0]==="layer"){let gt=nt[1],_t=nt[2];if(gt&&_t){let Et=this.layers.find(At=>At.uuid===gt);Et!=null&&Et.hasValue(_t)&&(_t==="alpha"?(this.transparent=Wc(this.data,mt.shared),Et.setValue(_t,Math.max(0,Math.min(Number(st)/100,1)))):Et.setValue(_t,st))}}}saveVariableLocations(nt){if(!this.allowVariableSaves)return;let st=this.data.layers.find(mt=>mt.data.type==="light");st&&nt.shared.getVariable(st.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(mt=>{"alpha"in mt.data&&typeof mt.data.alpha=="string"&&nt.shared.getVariable(mt.data.alpha,["material",this.uuid,"layer",mt.id,"alpha"])})}getLayersOfType(nt){return this.layers.filter(st=>st.type===nt)}getLayerByUuid(nt){return this.layers.find(st=>st.uuid===nt)}onUpdate(nt){this.lightLayer=this.layers.find(st=>st instanceof wn),this.lightLayer===void 0&&(this.lightLayer=new wn(0,"",{...Gr.defaultData("light","phong"),visible:!1},new _a,{},nt)),this.dispose();for(let st of this.flavors)st&&st.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let nt=this.layers.find(_t=>_t instanceof wn);if(!nt)return;let st=nt.data,mt=st.bumpMap,gt=st.roughnessMap;nt.node.bumpMap=void 0,nt.node.roughnessMap=void 0;for(let _t=0;_t<this.layers.length;++_t){let Et=this.layers[_t];Et instanceof Ir&&Et.color instanceof Bl&&(Et.uuid===mt&&(nt.node.bumpMap=Et.color),Et.uuid===gt&&(nt.node.roughnessMap=Et.color))}}updateByOp(nt,st,mt){if(sr.startContext(this),st!==void 0?this.data=st:st=this.data,this.transparent=Wc(st,mt.shared),nt.path[0]==="layers"){let gt=mt.shared,_t=nt.path[1];if(_t===void 0)mt.scene.markNeedsUpdateRendererDirty(),this.reset0(st,mt);else{nt.type===0&&nt.props.occlusion!==void 0&&mt.scene.markNeedsUpdateRendererDirty();let Et=this.layers.find(At=>At.uuid===_t);if(Et){let At=st.layers.data(_t),Rt;nt.type===0&&("alpha"in nt.props||"alphaOverride"in nt.props)&&("alpha"in nt.props?Rt={...nt.props,alpha:Fl(nt.props.alpha,gt,["material",this.uuid,"layer",_t,"alpha"])}:Rt={...nt.props,alphaOverride:Fl(nt.props.alphaOverride,gt,["material",this.uuid,"alphaOverride"])}),Et.updateByOp({...nt,...Rt?{props:Rt}:{},path:nt.path.slice(2)},At,mt)&&this.reset0(st,mt)}}}else this.reset0(st,mt);sr.endContext(this)}applyMasks(){for(let nt=0;nt<this.layers.length;++nt){let st=this.layers[nt];st instanceof Ir?st.color.mask=void 0:st instanceof wn&&(st.node.mask=void 0)}for(let nt=0;nt<this.layers.length;++nt){let st=this.layers[nt];if(st instanceof Ir&&st.isMask.value&&st.data.visible&&nt>0){let mt=nt-1,gt=this.layers[mt];gt instanceof wn?gt.node.mask=new Ui(st.color,st.alpha,Ui.MUL):gt instanceof Ir&&(gt.isMask.value||(gt.color.mask=new Ui(st.color,st.alpha,Ui.MUL)))}}}blendColors(){let nt=this.layers.findIndex(mt=>mt instanceof Ir),st=this.layers.findIndex(mt=>mt instanceof wn);if(nt!==-1&&nt<st){let mt=this.layers[nt].color;for(let gt=nt+1;gt<st;++gt){let _t=this.layers[gt];if(_t instanceof Ir){if(_t.isMask.value)continue;mt=new Fd(mt,_t.color,_t.alpha,_t.mode)}}this.fragment.color=mt}else this.fragment.color=void 0}blendAfterColors(){let nt=new Yt("outgoingLight","f"),st=this.layers.findIndex(mt=>mt instanceof wn);if(this.layers.length>st+1){for(let mt=st+1;mt<this.layers.length;++mt){let gt=this.layers[mt];if(gt instanceof Ir){if(gt.isMask.value)continue;nt=new Fd(nt,gt.color,gt.alpha,gt.mode)}}this.fragment.afterColor=nt}else this.fragment.afterColor=void 0}blendPositions(){let nt=this.layers.filter(st=>st instanceof bm);if(nt.length>0){let st=nt[0].position;for(let mt=1;mt<nt.length;++mt)nt[mt]&&(st=new Ui(st,nt[mt].position,Ui.ADD),st=new Ui(st,new Fe$1(.5).setReadonly(!0),Ui.MUL));this.fragment.position=st}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(nt){nt.defines=this.defines,nt.uniforms=this.uniforms,nt.vertexShader=this.vertexShader,nt.fragmentShader=this.fragmentShader,nt.extensionDerivatives=this.extensions.derivatives===!0,nt.extensionFragDepth=this.extensions.fragDepth===!0,nt.extensionDrawBuffers=this.extensions.drawBuffers===!0,nt.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(nt,st){let mt=(gt,_t,Et)=>Math.min(Math.max(gt,_t),Et);for(let gt of this.layers)if(gt.type==="displace"){let _t=mt(gt.uniforms[`f${gt.id}_intensity`].value,nt,st);gt.uniforms[`f${gt.id}_intensity`].value=_t}}updateFrame(nt){for(let st=0;st<this.updaters.length;++st)nt.updateNode(this.updaters[st])}build(){let nt=new Bd;nt.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,nt.build(this.fragment,this.fragment),this.vertexShader=nt.getCode("vertex"),this.fragmentShader=nt.getCode("fragment"),this.defines=nt.defines,this.uniforms=nt.uniforms,this.extensions=nt.extensions,this.updaters=nt.updaters;for(let st of this.flavors)st&&st.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(nt=>nt.dispose()),super.dispose();for(let nt of this.flavors)nt&&nt.dispose()}assetsLoaded(){for(let nt of this.layers)if(nt instanceof Ir){let st=nt.params.texture;if(st instanceof Gc&&!st.image.loaded)return!1}return!0}};Object.defineProperties(Nn.prototype,{properties:{get:function(){return this.fragment.properties}}});var qc=class extends Ia{constructor(nt,st,mt){super(nt,st,!1),this.uuid=mt,this.allowVariableSaves=!0,this.saveVariableLocations(st)}},CR=new Map;function PR(nt){if(typeof nt=="string")return nt;let st=CR.get(nt);return st||(st={url:URL.createObjectURL(new Blob([nt]))},CR.set(nt,st)),st.url}var DR,IR=new Promise(nt=>{DR=nt}),_R=!1,Q0;function OR(){if(_R)return;if(Q0)return Q0;async function nt(){await __vitePreload(()=>import("./howler-78Z8t2-A.js").then(st=>st.h),[]),DR(window!==void 0?window:global),_R=!0}return Q0=nt(),Q0}var RR;IR.then(nt=>RR=nt);function LR(nt){let st=!1;return nt.scene.objects.traverse((mt,gt)=>{if(gt.events===void 0||Array.isArray(gt.events)===!1)return!0;let _t=[];gt.events.forEach(Et=>{"dragDropActions"in Et.data?(_t.push(...Et.data.dragDropActions.drag),_t.push(...Et.data.dragDropActions.drop)):"inActions"in Et.data?(_t.push(...Et.data.inActions),_t.push(...Et.data.outActions)):"gameActions"in Et.data?(_t.push(...Et.data.gameActions.idle),_t.push(...Et.data.gameActions.move),_t.push(...Et.data.gameActions.jump),_t.push(...Et.data.gameActions.run)):"breakpoints"in Et.data?Et.data.breakpoints.forEach(At=>{_t.push(...At.data.actions)}):"actions"in Et.data&&_t.push(...Et.data.actions),st=st||_t.some(At=>At.data.type==="Audio")})}),st}var Oa=class{constructor({src:nt,volume:st,delay:mt,loop:gt}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let _t;typeof nt=="string"?_t={src:nt}:_t={src:PR(nt),format:"wav"},this.sound=new RR.Howl(_t),this.sound.on("end",this.onEnd),this.src=nt,st!==void 0&&(this.volume=st),mt!==void 0&&(this.delay=mt),gt!==void 0&&(this.loop=gt)}get status(){return this._status}get volume(){return this._volume}set volume(nt){this._volume=nt,this.sound.volume(nt)}get loop(){return this._loop}set loop(nt){this._loop=nt,this.loopsRemaining=nt}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(nt,st=1e3){nt?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,st),this.clearFade()},nt)):this.sound.fade(this._volume,0,st)}on(nt,st,mt){this.sound.on(nt,st,mt)}off(nt,st,mt){this.sound.off(nt,st,mt)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(nt=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},K0=class{constructor(){this.type="ShapePath",this.color=new We$1,this.subPaths=[],this.currentPath=null}moveTo(nt,st){return this.currentPath=new vc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(nt,st),this}lineTo(nt,st){var mt;return(mt=this.currentPath)==null||mt.lineTo(nt,st),this}quadraticCurveTo(nt,st,mt,gt){var _t;return(_t=this.currentPath)==null||_t.quadraticCurveTo(nt,st,mt,gt),this}bezierCurveTo(nt,st,mt,gt,_t,Et){var At;return(At=this.currentPath)==null||At.bezierCurveTo(nt,st,mt,gt,_t,Et),this}splineThru(nt){var st;return(st=this.currentPath)==null||st.splineThru(nt),this}toShapes(){let nt={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},st={loc:nt.ORIGIN,t:0};function mt(Mr,Tr,zr,Fr){let Nr=Mr.x,tn=Tr.x,rn=zr.x,Tn=Fr.x,$n=Mr.y,un=Tr.y,es=zr.y,kn=Fr.y,ts=(Tn-rn)*($n-es)-(kn-es)*(Nr-rn),Ko=(tn-Nr)*($n-es)-(un-$n)*(Nr-rn),ds=(kn-es)*(tn-Nr)-(Tn-rn)*(un-$n),Il=ts/ds,ru=Ko/ds;if(ds===0&&ts!==0||Il<=0||Il>=1||ru<0||ru>1)return null;if(ts===0&&ds===0){for(let uu=0;uu<2;uu++)if(gt(uu===0?zr:Fr,Mr,Tr),st.loc===nt.ORIGIN){let p0=uu===0?zr:Fr;return{x:p0.x,y:p0.y,t:st.t}}else if(st.loc===nt.BETWEEN){let p0=+(Nr+st.t*(tn-Nr)).toPrecision(10),X1=+($n+st.t*(un-$n)).toPrecision(10);return{x:p0,y:X1,t:st.t}}return null}else{for(let X1=0;X1<2;X1++)if(gt(X1===0?zr:Fr,Mr,Tr),st.loc===nt.ORIGIN){let q0=X1===0?zr:Fr;return{x:q0.x,y:q0.y,t:st.t}}let uu=+(Nr+Il*(tn-Nr)).toPrecision(10),p0=+($n+Il*(un-$n)).toPrecision(10);return{x:uu,y:p0,t:Il}}}function gt(Mr,Tr,zr){let Fr=zr.x-Tr.x,Nr=zr.y-Tr.y,tn=Mr.x-Tr.x,rn=Mr.y-Tr.y,Tn=Fr*rn-tn*Nr;if(Mr.x===Tr.x&&Mr.y===Tr.y){st.loc=nt.ORIGIN,st.t=0;return}if(Mr.x===zr.x&&Mr.y===zr.y){st.loc=nt.DESTINATION,st.t=1;return}if(Tn<-Number.EPSILON){st.loc=nt.LEFT;return}if(Tn>Number.EPSILON){st.loc=nt.RIGHT;return}if(Fr*tn<0||Nr*rn<0){st.loc=nt.BEHIND;return}if(Math.sqrt(Fr*Fr+Nr*Nr)<Math.sqrt(tn*tn+rn*rn)){st.loc=nt.BEYOND;return}let $n;Fr!==0?$n=tn/Fr:$n=rn/Nr,st.loc=nt.BETWEEN,st.t=$n}function _t(Mr,Tr){let zr=[],Fr=[];for(let Nr=1;Nr<Mr.length;Nr++){let tn=Mr[Nr-1],rn=Mr[Nr];for(let Tn=1;Tn<Tr.length;Tn++){let $n=Tr[Tn-1],un=Tr[Tn],es=mt(tn,rn,$n,un);es!==null&&zr.find(kn=>kn.t<=es.t+Number.EPSILON&&kn.t>=es.t-Number.EPSILON)===void 0&&(zr.push(es),Fr.push(new U$1(es.x,es.y)))}}return Fr}function Et(Mr,Tr,zr){let Fr=new U$1;Tr.getCenter(Fr);let Nr=[];return zr.forEach(tn=>{tn.boundingBox.containsPoint(Fr)&&_t(Mr,tn.points).forEach(rn=>{Nr.push({identifier:tn.identifier,isCW:tn.isCW,point:rn})})}),Nr.sort((tn,rn)=>tn.point.x-rn.point.x),Nr}function At(Mr,Tr,zr,Fr,Nr){(Nr==null||Nr==="")&&(Nr="nonzero");let tn=new U$1;Mr.boundingBox.getCenter(tn);let rn=[new U$1(zr,tn.y),new U$1(Fr,tn.y)],Tn=Et(rn,Mr.boundingBox,Tr);Tn.sort((Ko,ds)=>Ko.point.x-ds.point.x);let $n=[],un=[];Tn.forEach(Ko=>{Ko.identifier===Mr.identifier?$n.push(Ko):un.push(Ko)});let es=$n[0].point.x,kn=[],ts=0;for(;ts<un.length&&un[ts].point.x<es;)kn.length>0&&kn[kn.length-1]===un[ts].identifier?kn.pop():kn.push(un[ts].identifier),ts++;if(kn.push(Mr.identifier),Nr==="evenodd"){let Ko=kn.length%2===0,ds=kn[kn.length-2];return{identifier:Mr.identifier,isHole:Ko,for:ds}}else if(Nr==="nonzero"){let Ko=!0,ds=null,Il=null;for(let ru=0;ru<kn.length;ru++){let uu=kn[ru];Tr[uu]&&(Ko?(Il=Tr[uu].isCW,Ko=!1,ds=uu):Il!==Tr[uu].isCW&&(Il=Tr[uu].isCW,Ko=!0))}return{identifier:Mr.identifier,isHole:Ko,for:ds}}else console.warn('fill-rule: "'+Nr+'" is currently not implemented.')}let Rt=0,Ft=999999999,Nt=-999999999,Bt=[];this.subPaths.forEach(Mr=>{let Tr=Mr.getPoints(),zr=-999999999,Fr=999999999,Nr=-999999999,tn=999999999;for(let rn=0;rn<Tr.length;rn++){let Tn=Tr[rn];Tn.y>zr&&(zr=Tn.y),Tn.y<Fr&&(Fr=Tn.y),Tn.x>Nr&&(Nr=Tn.x),Tn.x<tn&&(tn=Tn.x)}Nt<=Nr&&(Nt=Nr+1),Ft>=tn&&(Ft=tn-1),Tr.length&&Bt.push({curves:Mr.curves,points:Tr,isCW:Uu.isClockWise(Tr),identifier:Rt++,boundingBox:new Ku(new U$1(tn,Fr),new U$1(Nr,zr))})});let Gt=Bt.map(Mr=>{var Tr;return At(Mr,Bt,Ft,Nt,(Tr=this.userData)==null?void 0:Tr.style.fillRule)}),dr=[];return Bt.forEach(Mr=>{let Tr=Gt[Mr.identifier];if(Tr&&!Tr.isHole){let zr=new aa;zr.curves=Mr.curves,Gt.filter(Fr=>(Fr==null?void 0:Fr.isHole)&&Fr.for===Mr.identifier).forEach(Fr=>{if(Fr){let Nr=Bt[Fr.identifier],tn=new vc;tn.curves=Nr.curves,zr.holes.push(tn)}}),dr.push(zr)}}),dr}},mE=!1,NR,gE=new Promise(nt=>{NR=nt}),BR=!1,Z0;function FR(){if(mE=!0,BR)return;if(Z0)return Z0;async function nt(){let st=await __vitePreload(()=>import("./opentype-D6jUvuOk.js"),[]);NR(st),BR=!0}return Z0=nt(),Z0}var Sm=class{async load(nt,st,mt=()=>{}){let{load:gt}=await gE;gt(nt,(_t,Et)=>{_t||!Et?mt(_t??"Something went wrong"):st(Et)})}async parse(nt){let{parse:st,Bidi:mt}=await gE;try{let gt=st(nt),_t=new mt,Et=At=>gt.charToGlyphIndex(At.char);return _t.registerModifier("glyphIndex",null,Et),_t.applyFeatures(gt,gt.defaultRenderOptions.features),{font:gt,bidi:_t}}catch(gt){console.error(gt)}}};async function sX(nt){return await(await fetch(nt)).arrayBuffer()}var oX=new Sm;async function yE(nt){let st,mt,gt=!1;if(nt.url?(st=await sX(nt.url),mt=nt.url,gt=nt.url.startsWith("/")):nt.data&&(st=nt.data.buffer.slice(nt.data.byteOffset,nt.data.byteOffset+nt.data.byteLength)),st)if(mE){let _t=await oX.parse(st);if(_t)return{font:_t.font,url:mt,intercepted:gt,arr:st,bidi:_t.bidi}}else return{font:void 0,url:mt,intercepted:gt,arr:st,bidi:null}}function aX(nt,st){return st.state.glyphIndex===nt||st.state.fina===nt||st.state.medi===nt||st.state.init===nt}var J0=class{constructor(nt){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=nt.isUserFont??!1,this._loadingPromise=yE(nt).then(st=>{st&&(this._arrayBuffer=st.arr,this._url=st.url,this.font=st.font,this._intercepted=st.intercepted,this._isLoaded=!0,this._bidi=st.bidi)})}update(nt){this._isLoaded=!1,this._isUserFont=nt.isUserFont??!1,this._loadingPromise=yE(nt).then(st=>{st&&(this._arrayBuffer=st.arr,this._url=st.url,this.font=st.font,this._intercepted=st.intercepted,this._isLoaded=!0,this._bidi=st.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(nt,st,mt){if(!this._bidi)return[];let gt=this._bidi;gt.getTextGlyphs(st);let _t=gt.tokenizer.tokens,Et=[],At=0,Rt=mt.length===_t.length;for(let Ft=0;Ft<mt.length;Ft++){let Nt=mt[Ft].index,Bt=String.fromCharCode(mt[Ft].unicode),Gt=_t[At];if(aX(Nt,Gt)||Rt)Et.push({char:Bt,index:Nt,replacements:[Gt.state.glyphIndex],replacementChars:[Gt.char]}),At++;else{let dr=Gt.char,Mr="",Tr=[Gt.state.glyphIndex],zr=[],Fr=!1;for(;!Fr;)At++,Mr=st.charAt(At),dr+=Mr,Tr.push(nt.charToGlyphIndex(Mr)),zr=nt.stringToGlyphs(dr),zr.length===1&&zr[0].index===Nt&&(Fr=!0),At>st.length&&(Fr=!0);Et.push({char:Bt,index:Nt,replacements:Tr,replacementChars:Array.from(dr)}),At++}}return Et}generateShapes(nt,st){if(!this._isLoaded)return;let mt=this.font,gt=st.fontSize/this.unitsPerEm,_t=st.fontSize*st.lineHeight,Et=nt.map(Nr=>this.getTextWidth(Nr,st)),At=st.width,Rt=this.getCharWidth(`
`,st),Ft=st.horizontalAlign===1?Rt:0,Nt=this.computeSpaceWidthForLine(nt,0,st),Bt=this.getLineInitialOffsetX(Et[0],At,st.horizontalAlign,nt[0],Rt),Gt=this.getLineInitialOffsetY(_t,nt.length,st.height,gt,st.verticalAlign),dr=[],Mr=nt.map(Nr=>[]),Tr=nt.map(Nr=>[]),zr;for(let Nr=0;Nr<nt.length;Nr++){let tn=nt[Nr],rn={features:{liga:!0}},Tn=[];try{Tn=mt.stringToGlyphs(tn,rn)}catch(un){console.warn(un)}Bt=this.getLineInitialOffsetX(Et[Nr],At,st.horizontalAlign,tn,Rt);let $n=[];try{$n=this.reverseLigaturesTable(mt,tn,Tn)}catch(un){console.warn(un)}Nt=this.computeSpaceWidthForLine(nt,Nr,st);for(let un=0;un<Tn.length;un++){let es=Tn[un],kn=es.index===0?`
`:es.unicode?String.fromCharCode(es.unicode):void 0,ts=$n[un],Ko=0,ds=0;un===0&&st.horizontalAlign===2&&es.leftSideBearing!==void 0&&(ds=-es.leftSideBearing*gt),zr&&(Ko=mt.getKerningValue(es,zr)*gt),Bt+=ds+Ko;let Il=0;if(kn===`
`)Il=Ft;else if(kn===" ")Il=Nt;else{let ru=this.createPath(es,gt,Bt,Gt,st);ru&&(Il=ru.offsetX-(Ko+ds),dr.push(ru.path))}if(ts.replacements.length===1)Tr[Nr].push([Bt,Gt]),Mr[Nr].push(Il);else{let ru=ts.replacements.map(q0=>(mt.glyphs.get(q0).advanceWidth??0)*gt),uu=ru.reduce((q0,W0)=>q0+=W0,0),p0=ru.map(q0=>q0/uu),X1=Bt;for(let q0=0;q0<p0.length;q0++){let W0=Il*p0[q0];Tr[Nr].push([X1,Gt]),Mr[Nr].push(W0),X1+=W0}}Bt+=Il,zr=es}Gt-=_t}let Fr=[];for(let Nr=0,tn=dr.length;Nr<tn;Nr++)Fr.push(...dr[Nr].toShapes());return{shapes:Fr,charWidths:Mr,lineWidths:Et,charCoords:Tr}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var nt;return((nt=this.font)==null?void 0:nt.ascender)??0}get descender(){var nt;return((nt=this.font)==null?void 0:nt.descender)??0}get familyName(){var nt;return((nt=this.font)==null?void 0:nt.names.fontFamily)??""}get subfamilyName(){var nt;return((nt=this.font)==null?void 0:nt.names.fontSubfamily)??""}get unitsPerEm(){var nt;return((nt=this.font)==null?void 0:nt.unitsPerEm)??1}getLineInitialOffsetX(nt,st,mt,gt,_t){return(mt===3||mt===2)&&gt.indexOf(`
`)>=0&&(nt-=_t),mt===3?st*.5-nt*.5:mt===2?st-nt:0}getLineInitialOffsetY(nt,st,mt,gt,_t){let Et=st*nt,At=Math.abs(this.ascender-this.descender)*gt,Rt=nt-At,Ft=-this.ascender*gt-Rt/2;return _t===3?-(mt-Et-Ft):_t===2?-(mt*.5-Et*.5-Ft):Ft}createPath(nt,st,mt,gt,_t){var Ft;let Et=nt.getPath(mt,-gt,_t.fontSize,{kerning:!1,letterSpacing:_t.letterSpacing});if(!Et){console.error('THREE.Font: character "'+nt+'" does not exists in font family '+this.familyName+".");return}let At=new K0,Rt=(nt.advanceWidth??1)*st;if(nt)for(let Nt of Et.commands){let Bt=(Ft=At.currentPath)==null?void 0:Ft.currentPoint;if(!(Bt&&Nt.type!=="Z"&&Bt.x===Nt.x&&-Bt.y===Nt.y))switch(Nt.type){case"M":At.moveTo(Nt.x,-Nt.y);break;case"L":At.lineTo(Nt.x,-Nt.y);break;case"Q":At.quadraticCurveTo(Nt.x1,-Nt.y1,Nt.x,-Nt.y);break;case"C":At.bezierCurveTo(Nt.x1,-Nt.y1,Nt.x2,-Nt.y2,Nt.x,-Nt.y);break}}return At.subPaths.forEach(Nt=>{let Bt=lX(Nt.curves);Bt!==void 0&&Nt.currentPoint.distanceTo(Bt)>0&&Nt.lineTo(Bt.x,Bt.y)}),{offsetX:Rt+_t.fontSize*_t.letterSpacing,path:At}}getCharWidth(nt,st){var mt;return((mt=this.font)==null?void 0:mt.getAdvanceWidth(nt,st.fontSize,{kerning:!0,letterSpacing:st.letterSpacing}))??0}getTextWidth(nt,st){var mt;return((mt=this.font)==null?void 0:mt.getAdvanceWidth(nt,st.fontSize,{kerning:!0,letterSpacing:st.letterSpacing}))??0}computeSpaceWidthForLine(nt,st,mt){let gt=this.getCharWidth(" ",mt),_t=nt[st];if(_t){let Et=this.countSpaces(_t.trimEnd());if(mt.horizontalAlign===4&&st<nt.length-1&&Et){let At=mt.width,Rt=this.getTextWidth(_t,mt);return(At-(Rt-Et*gt))/Et}}return gt}countSpaces(nt){return(nt.match(/ /g)||[]).length}};function lX(nt){if(nt.length){let st=nt[0];if(st instanceof ln)return st.v1;if(st instanceof an||st instanceof Yn)return st.v0}}var vE=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(nt){return this.objects.get(nt)}get size(){return this.objects.size}get(nt,st,mt){let gt=this.objects.get(nt);return gt===void 0?(gt=this.createObject(nt,st,mt),this.objects.set(nt,gt)):gt.isShared=!0,gt}forceDelete(nt){let st=this.objects.get(nt);st&&(this.disposeObject(st),this.objects.delete(nt))}mutateIfUnique(nt,st){let mt=this.objects.get(nt);if(mt&&mt.isShared!==!0)return this.objects.delete(nt),this.objects.set(st,mt),mt}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(nt,st){let mt=this.objects.get(nt);st===mt&&this.unreachable.delete(nt)}endGc(){this.unreachable.forEach(nt=>{this.disposeObject(this.objects.get(nt)),this.objects.delete(nt)}),this.unreachable.clear()}dispose(){this.objects.forEach(nt=>{this.disposeObject(nt)}),this.objects.clear()}},wm=class extends vE{constructor(nt){super(),this.flatShading=nt}disposeObject(nt){nt.dispose()}createObject(nt,st,mt){let gt=Ca(nt,st,this.flatShading,mt);return gt.computeBoundingSphere(),gt}},VR={markNeedsUpdateRendererDirty:()=>{}};function Yc(nt){return{all:nt=nt||new Map,on:function(st,mt){var gt=nt.get(st);gt?gt.push(mt):nt.set(st,[mt])},off:function(st,mt){var gt=nt.get(st);gt&&(mt?gt.splice(gt.indexOf(mt)>>>0,1):nt.set(st,[]))},emit:function(st,mt){var gt=nt.get(st);gt&&gt.slice().map(function(_t){_t(mt)}),(gt=nt.get("*"))&&gt.slice().map(function(_t){_t(st,mt)})}}}var ex=class{constructor(nt,st,mt){var gt;this.id=nt,this.userAPI=st,this.result=void 0,this.error="null",this.isPrefetched=!1,this.isLoading=!1,this.isLoaded=!1,this.prefetchPromise=new Promise(_t=>_t()),this.emitter=Yc(),((gt=st==null?void 0:st.integration)==null?void 0:gt.type)==="OpenAI"?this.result={content:""}:st.method==="GET"&&st.url!==""&&(this.prefetchPromise=this.prefetch(mt))}async prefetch(nt){await this.callUserAPI(nt)}async callUserAPI(nt){var st,mt,gt;this.emitter.emit("start",{userAPIId:this.id}),this.isLoading=!0,this.isLoading=!1;try{this.result=await fX(this.userAPI,nt),this.error="null",this.emitter.emit("success",{userAPIId:this.id})}catch(_t){let Et=((gt=(mt=(st=_t.message)==null?void 0:st.split("_:_"))==null?void 0:mt[0])==null?void 0:gt.replace("status:",""))??"null";this.error=Et,this.result=null,this.emitter.emit("error",{userAPIId:this.id})}this.isLoading=!1,this.isPrefetched=!0,this.isLoaded=!0}update(nt,st){this.userAPI=nt,this.userAPI.url!==""&&this.userAPI.method==="GET"&&this.prefetch(st)}retrieveValue(nt){if(this.result)try{return Sr.zoom(this.result,nt)}catch(st){console.error(st)}}retrieveZoomedKeyValues(nt){if(this.result){let st=nt&&nt.length?Sr.zoom(this.result,nt):this.result;if(dX(st))return Object.entries(st);if(hX(st))return st.map((mt,gt)=>[gt.toString(),mt]);throw uX(st)?new Error("This path points to a value, use retrieveValue() instead. "+(nt==null?void 0:nt.join("."))):new Error("Path error"+(nt==null?void 0:nt.join(".")))}}dispose(){}on(nt,st){this.emitter.on(nt,st)}off(nt,st){this.emitter.off(nt,st)}get autostart(){return this.userAPI.autoStart}};function cX(nt){let st=new Headers;return nt.headers.forEach(mt=>{mt.data.key!==""&&st.append(mt.data.key,mt.data.value)}),st}function uX(nt){return typeof nt=="string"||typeof nt=="number"||typeof nt=="boolean"||nt===null}function hX(nt){return Array.isArray(nt)}function dX(nt){return typeof nt=="object"&&nt!==null}async function fX(nt,st,mt=new AbortController){var Et,At;let gt;if(((Et=nt.integration)==null?void 0:Et.type)==="OpenAI"){let Rt=$0(nt.integration.prompt===""?"":JSON.parse(nt.integration.prompt),st),Ft=nt.integration.behavior===""?"":$0(JSON.parse(nt.integration.behavior),st);gt=`{
			"model": "${nt.integration.model}",
			"messages": [${nt.integration.useBehavior?`
			{
				"role": "system",
				"content": "${Ft}"
			},`:""}
			{
				"role": "user",
				"content": "${Rt}"
			}
			]
		}`}else nt.method==="POST"&&nt.body&&(gt=$0(JSON.parse(nt.body),st));let _t=await fetch(nt.url,{method:nt.method,headers:cX(nt),signal:mt.signal,body:gt});if(!_t.ok)throw new Error("status:"+_t.status+"_:_"+_t.statusText);return((At=nt.integration)==null?void 0:At.type)==="OpenAI"?{content:(await _t.json()).choices[0].message.content}:await _t.json()}var UR=(nt,st)=>{if(typeof nt=="string"){let mt=st.getVariable(nt);if(mt)return UR(mt,st)}return Lr.isBoolean(nt)?Lr.getDisplayedValue(nt).toLowerCase():Lr.getDisplayedValue(nt)},$0=(nt,st)=>nt.map((mt,gt)=>{if("text"in mt)return mt.text;if("type"in mt){if(mt.type==="paragraph")return(gt>0?`
`:"")+$0(mt.children,st);if(mt.type==="variable"){let _t=st.getVariable(mt.variableId);if(_t!==void 0)return UR(_t,st)}}return""}).join(""),tx=1e3,zR=512*tx;function pX(nt,st){let mt=typeof nt;return!!((st==="string"||st==="number")&&mt===st||st==="boolean"&&(nt==="true"||nt==="false"||nt===!0||nt===!1)||st==="image"&&mt==="string"&&nt.startsWith("http"))}var kR="https://hooks.spline.design",mX=`${kR}/events?hashFile=`,rx=class{constructor(nt,st){this.id=nt,this.userWebhook=st,this.result=void 0,this._connected=!1,this.emitter=Yc(),this.reconnectWaitFor=tx,this._onError=mt=>{var gt,_t,Et;(gt=this.eventSource)==null||gt.removeEventListener("message",this._onMessage),(_t=this.eventSource)==null||_t.removeEventListener("error",this._onError),(Et=this.eventSource)==null||Et.removeEventListener("open",this._onConnected),this._scheduleReconnect()},this._onConnected=mt=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=tx,this._connected=!0},this._onDisconnected=()=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=tx,this._connected=!1},this._onMessage=mt=>{let gt=mt.data,_t;try{_t=JSON.parse(gt)}catch(Et){console.error("Error parsing webhook message",Et)}if(_t){let Et=!1;this.userWebhook.parametersSchemas.forEach(({data:At})=>{_t[At.name]!==void 0&&pX(_t[At.name],At.type)&&(this.result===void 0&&(this.result={}),this.result[At.name]=_t[At.name],Et=!0)}),Et&&this.emitter.emit("message",{userWebhookId:this.id})}}}connect(){clearTimeout(this.scheduledReconnectHandle),this.userWebhook.url&&(this.eventSource=new EventSource(mX+this.userWebhook.url),this.eventSource.addEventListener("message",this._onMessage),this.eventSource.addEventListener("error",this._onError),this.eventSource.addEventListener("open",this._onConnected))}disconnect(){var nt,st,mt,gt;(nt=this.eventSource)==null||nt.removeEventListener("message",this._onMessage),(st=this.eventSource)==null||st.removeEventListener("error",this._onError),(mt=this.eventSource)==null||mt.removeEventListener("open",this._onConnected),(gt=this.eventSource)==null||gt.close(),this._onDisconnected(),clearTimeout(this.scheduledReconnectHandle)}_scheduleReconnect(){this.reconnectWaitFor*=2,this.reconnectWaitFor>zR&&(this.reconnectWaitFor=zR),clearTimeout(this.scheduledReconnectHandle),this.scheduledReconnectHandle=setTimeout(()=>{this.scheduledReconnectHandle=void 0,this.connect()},this.reconnectWaitFor)}update(nt){this.userWebhook=nt}dispose(){this._connected&&this.disconnect()}get connected(){return this._connected}on(nt,st){this.emitter.on(nt,st)}off(nt,st){this.emitter.off(nt,st)}getParametersKeys(){return this.userWebhook.parametersSchemas.map(nt=>nt.data.name)}getParameterValue(nt){var st;if(this.getParametersKeys().includes(nt)){if(this.result)return(st=this.result)==null?void 0:st[nt];for(let mt of this.userWebhook.parametersSchemas)if(mt.data.name===nt)return Yv.defaultParameterValueByType(mt.data.type)}}};function ix(nt){return"variable_"+nt}var xE=class extends j0{constructor(nt){super(),this.shared=nt}create(nt){return new Zd(nt,this.shared)}},Xc=class{constructor(nt,st={},mt=!0,gt=!1){if(this.data=nt,this.needsJitter=mt,this.enableLocalStorageForPersistentVariables=gt,this.geometryCache=new wm(!0),this.geometryCache2=new wm(!1),this.imageHolderCache=new xE(this),this.thisContext={scene:VR,shared:this},this.deletedMaterial=new qc(Qr.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new Jn(Qv.emptyImage,this),this.deletedVideo=new Jn(Uh.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.userAPIs={},this.userWebhooks={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},st.images)for(let[_t,Et]of Object.entries(st.images))this.addImage(_t,Et);if(st.videos)for(let[_t,Et]of Object.entries(st.videos))this.addVideo(_t,Et);if(st.audios)for(let[_t,Et]of Object.entries(st.audios))this.addAudio(_t,Et);if(st.particles)for(let[_t,Et]of Object.entries(st.particles))this.addParticle(_t,Et);this.reset(nt)}setRequestRender(nt){this._requestRender=nt}getImageLoadPromises(){return Object.values(this.images).map(nt=>nt.loadPromise)}setEntityOpContext(nt){this.entityOpContext=nt}reset(nt,st=!1){this.data=nt,this.resetLib(nt.lib);for(let{id:mt,data:gt}of nt.variables)this.addVariableHolder(mt,gt),st&&this.updateVariableHolder(mt,gt);for(let[mt,gt]of Object.entries(nt.userAPIs))this.addUserAPI(mt,gt);for(let[mt,gt]of Object.entries(nt.userWebhooks))this.addUserWebhook(mt,gt);for(let[mt,gt]of Object.entries(nt.images))this.addImage(mt,gt);for(let[mt,gt]of Object.entries(nt.videos))this.addVideo(mt,gt);for(let[mt,gt]of Object.entries(nt.colors))this.addColor(mt,gt);for(let[mt,gt]of Object.entries(nt.materials))this.addMaterial(mt,gt);for(let[mt,gt]of Object.entries(nt.audios))this.addAudio(mt,gt);for(let[mt,gt]of Object.entries(nt.particles))this.addParticle(mt,gt);for(let[mt,gt]of Object.entries(nt.fonts))this.addFont(mt,gt)}addMaterial(nt,st){if(this.materials[nt]){let mt=this.materials[nt];mt.reset(st,this.thisContext),mt.dispose()}else{let mt=new qc(st,this.thisContext,nt);this.materials[nt]=mt}}deleteMaterial(nt){this.materials[nt]&&(this.materials[nt].nodeMaterialDispose(),delete this.materials[nt])}getMaterial(nt){return this.materials[nt]}getMaterialOrDeletedPlaceholder(nt){return this.materials[nt]??this.deletedMaterial}material(nt){return typeof nt=="string"?this.getMaterialOrDeletedPlaceholder(nt):nt==null?(console.error("material is undefined or null"),this.deletedMaterial):new Ia(nt,this.thisContext)}getMaterials(){return this.materials}addImage(nt,st){return this.images[nt]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[nt].updateSrc(st.data),!0):(this.images[nt]=new Jn(st,this),!1)}deleteImage(nt){let st=this.images[nt];st&&(st.dispose(),delete this.images[nt])}getDefaultImage(){return this.images.image_0}getImage(nt){return this.images[nt]??this.deletedImage}image(nt){return typeof nt=="string"?this.getImage(nt):this.imageHolderCache.load(nt)}addUIBuffer(nt,st){return this.uiBuffers[nt]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[nt].updateSrc(st),!0):(this.uiBuffers[nt]=new Jn(st,this),!1)}uiBuffer(nt){return this.uiBuffers[nt]}addVideo(nt,st){return this.videos[nt]?(this.videos[nt].updateSrc(st.data),!0):(this.videos[nt]=new Jn(st,this),!1)}deleteVideo(nt){let st=this.videos[nt];st&&(st.dispose(),delete this.videos[nt])}getVideo(nt){return this.videos[nt]??this.deletedVideo}video(nt){return typeof nt=="string"?this.getVideo(nt):this.imageHolderCache.load(nt)}addColor(nt,st){return this.colors[nt]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in st?this.colors[nt].setRGBA(st.r,st.g,st.b,st.a):this.colors[nt].setRGBA(st.r,st.g,st.b,1),!0):("a"in st?this.colors[nt]=new Nl(st.r,st.g,st.b,st.a):this.colors[nt]=new Nl(st.r,st.g,st.b,1),!1)}updateColor(nt,st){if(this.colors[nt]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let mt=this.colors[nt];return this.colors[nt].r=st.r??mt.r,this.colors[nt].g=st.g??mt.g,this.colors[nt].b=st.b??mt.b,this.colors[nt].a=st.a??mt.a,!0}return!1}deleteColor(nt){this.colors[nt]&&delete this.colors[nt]}getColor(nt){return this.colors[nt]}color(nt){let st;if(typeof nt=="string"){let mt=this.getColor(nt);mt?st=mt:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),st=new vr(0,0,0,0))}else return"a"in nt?new vr(nt.r,nt.g,nt.b,nt.a):new vr(nt.r,nt.g,nt.b,1);return st}addAudio(nt,st){this.audios[nt]=st}getAudio(nt){let st=this.audios[nt];if(st instanceof Oa)return st;{let mt=new Oa({src:st.data});return this.audios[nt]=mt,mt}}addParticle(nt,st){this.particles[nt]=st}getParticle(nt){return this.particles[nt]}deleteParticle(nt){this.particles[nt]&&delete this.particles[nt]}deleteAudio(nt){let st=this.audios[nt];st&&(st instanceof Oa&&st.dispose(),delete this.audios[nt])}addFont(nt,st){this.fonts[nt]=new J0(st),this.fonts[nt].loadingPromise.then(()=>this.requestRender())}getFont(nt){return this.fonts[nt]}deleteFont(nt){this.fonts[nt]&&delete this.fonts[nt]}dispose(){Object.keys(this.materials).forEach(nt=>this.deleteMaterial(nt)),this._requestRender=void 0,Object.values(this.audios).forEach(nt=>{nt instanceof Oa&&nt.dispose()}),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(nt,st){if(this.variables[nt]===void 0){let mt=st.value;if(this.enableLocalStorageForPersistentVariables&&st.persistent){let gt=localStorage.getItem(ix(nt));mt=gt!==null?JSON.parse(gt):st.value}return this.variables[nt]={value:mt,locations:[],persistent:st.persistent},"dynamicVariableType"in st&&(this.variables[nt].dynamicVariablePlayState="Playing",this.variables[nt].dynamicVariableToggleIsForward=void 0),!0}return this.variables[nt].value=st.value,!1}resetDynamicVariablePlayState(){for(let nt in this.variables)this.variables[nt].dynamicVariablePlayState!==void 0&&(this.variables[nt].dynamicVariablePlayState="Playing",this.variables[nt].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(nt,st){this.updateVariable(nt,st.value)}updateVariable(nt,st){if(this.variables[nt]===void 0)return!1;this.variables[nt].value=st,this.enableLocalStorageForPersistentVariables&&this.variables[nt].persistent&&localStorage.setItem(ix(nt),JSON.stringify(st));let mt=st;for(;typeof mt=="string";)mt=this.variables[mt].value;let gt=this.entityOpContext.scene;for(let _t=this.variables[nt].locations.length-1;_t>=0;_t--){let Et=this.variables[nt].locations[_t];if(Et[0]==="material"){let At=Et[1],Rt=mt,Ft={scene:gt,shared:this},Nt=Et.slice(2);gt.traverseMaterial(Gt=>{let dr=Gt.root??Gt;dr.uuid===At&&dr.onVariableUpdate(Nt,Rt,Ft)});let Bt=this.materials[At];Bt&&Bt.onVariableUpdate(Nt,Rt,Ft)}else{let At=gt.find(Et[0]);if(At===void 0){this.variables[nt].locations.splice(_t,1);continue}if(Et[1]!=="geometry"&&Et[1]!=="particles"){for(let Rt=1;Rt<Et.length-1;Rt++)At=At[Et[Rt]];Et[1]==="rotation"?At[Et[Et.length-1]]=mt*we$1.DEG2RAD:At[Et[Et.length-1]]=mt}if(At=gt.find(Et[0]),At.type==="ParticleEmitter"&&At.updateVariableState(mt,Et),yt.is(At)){if(Et[1]==="position"||Et[1]==="rotation"||Et[1]==="scale")At.onVariableUpdate();else if(Et[1]==="geometry"){let Rt=At;At.component&&(Rt=At.component);let Ft=Rt.dataPatched;Rt.chooseGeoemtryCache(this).forceDelete(Ft.geometry),Rt.createGeometryDelayed(this.entityOpContext),Rt.onVariableUpdate(!0),Rt.invalidateDownstreamBooleanData(),Rt.instances.forEach(Nt=>{let Bt=Nt.dataPatched;Nt.chooseGeoemtryCache(this).forceDelete(Bt.geometry),Nt.createGeometryDelayed(this.entityOpContext),Nt.onVariableUpdate(!0),Nt.invalidateDownstreamBooleanData()})}}}}return this.requestRender(),!0}deleteVariable(nt){this.variables[nt]&&delete this.variables[nt]}getVariable(nt,st){var mt,gt,_t;if(Array.isArray(nt)){if(nt[0]==="mouse")return((mt=this.mouseProperty)==null?void 0:mt[nt[1]])??0;if(nt[0]==="raycast")return((gt=this.raycastProperty)==null?void 0:gt[nt[1]])??0;let Et=this.entityOpContext.scene.find(nt[0]);if(nt[1]==="width"||nt[1]==="height"||nt[1]==="depth")return Et.geometry.userData.parameters[nt[1]];for(let At=1;At<nt.length;At++)Et=Et[nt[At]];return nt[1]==="rotation"&&(Et*=we$1.RAD2DEG),Et}for(let Et in this.variables){if(st===void 0)break;let At=this.variables[Et],Rt=(_t=At.locations)==null?void 0:_t.findIndex(Ft=>Sr.equal(Ft,st));Rt!==void 0&&Rt!==-1&&At.locations.splice(Rt,1)}if(typeof nt=="string"){let Et=nt,At=nt;do{if(At=Et,this.variables[Et]===void 0)break;let Rt=this.variables[Et].value;st&&this.variables[At]!==void 0&&this.variables[At].locations.push(st),Et=Rt}while(typeof Et=="string");return Et}else return nt}getVariables(){return this.variables}getDynamicVariablePlayState(nt){var st;return(st=this.variables[nt])==null?void 0:st.dynamicVariablePlayState}setDynamicVariablePlayState(nt,st){this.variables[nt]!==void 0&&(this.variables[nt].dynamicVariablePlayState=st)}getDynamicVariableToggleIsForward(nt){var st;return(st=this.variables[nt])==null?void 0:st.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(nt,st){this.variables[nt]!==void 0&&(this.variables[nt].dynamicVariableToggleIsForward=st)}resetLib(nt){for(let[st,mt]of Object.entries(nt.images))this.addImage(st,mt.asset);for(let[st,mt]of Object.entries(nt.audios))this.addAudio(st,mt.asset);for(let[st,mt]of Object.entries(nt.particles))this.addParticle(st,mt.asset);for(let[st,mt]of Object.entries(nt.colors))this.addColor(st,mt.asset);for(let[st,mt]of Object.entries(nt.fonts))this.addFont(st,mt.asset);for(let[st,mt]of Object.entries(nt.materials))this.addMaterial(st,mt.asset);for(let[st,mt]of Object.entries(nt.videos))this.addVideo(st,mt.asset);for(let[st,mt]of Object.entries(nt.variables))this.addVariableHolder(st,mt.asset)}updateLibByOp(nt,st){nt.path[0]==="images"?nt.path.length===1&&nt.type===1?this.addImage(nt.id,nt.data.asset):nt.path.length===1&&nt.type===2&&this.deleteImage(nt.id):nt.path[0]==="videos"?nt.path.length===1&&nt.type===1?this.addVideo(nt.id,nt.data.asset):nt.path.length===1&&nt.type===2&&this.deleteVideo(nt.id):nt.path[0]==="audios"?nt.path.length===1&&nt.type===1?this.addAudio(nt.id,nt.data.asset):nt.path.length===1&&nt.type===2&&this.deleteAudio(nt.id):nt.path[0]==="particles"?nt.path.length===1&&nt.type===1?this.addParticle(nt.id,nt.data.asset):nt.path.length===1&&nt.type===2&&this.deleteParticle(nt.id):nt.path[0]==="colors"?nt.path.length===1&&nt.type===1?this.addColor(nt.id,nt.data.asset):nt.path.length===1&&nt.type===2&&this.deleteColor(nt.id):nt.path[0]==="materials"?nt.path.length===1&&nt.type===1?this.addMaterial(nt.id,nt.data.asset):nt.path.length===1&&nt.type===2&&this.deleteMaterial(nt.id):nt.path[0]==="fonts"?nt.path.length===1&&nt.type===1?this.addFont(nt.id,nt.data.asset):nt.path.length===1&&nt.type===2&&this.deleteFont(nt.id):nt.path[0]==="variables"?nt.path.length===1&&nt.type===1?this.addVariableHolder(nt.id,nt.data.asset):nt.path.length===1&&nt.type===2&&this.deleteVariable(nt.id):nt.path[0]==="components"&&st.updateByLibOp(nt,this)}updateByOp(nt,st,mt){var gt,_t;if(this.data=st,nt.path[0]==="images")nt.path.length===2&&nt.type===0?nt.props.data&&this.getImage(nt.path[1]).updateSrc(nt.props.data):nt.path.length===1&&nt.type===1?this.addImage(nt.id,nt.data):nt.path.length===1&&nt.type===2&&this.deleteImage(nt.id);else if(nt.path[0]==="videos")nt.path.length===2&&nt.type===0?nt.props.data&&this.getVideo(nt.path[1]).updateSrc(nt.props.data):nt.path.length===1&&nt.type===1?this.addVideo(nt.id,nt.data):nt.path.length===1&&nt.type===2&&this.deleteVideo(nt.id);else if(nt.path[0]==="audios")nt.path.length===2&&nt.type===0?nt.props.data&&this.addAudio(nt.path[1],st.audios[nt.path[1]]):nt.path.length===1&&nt.type===1?this.addAudio(nt.id,nt.data):nt.path.length===1&&nt.type===2&&this.deleteAudio(nt.id);else if(nt.path[0]==="particles")nt.path.length===2&&nt.type===0?nt.props.data&&this.addParticle(nt.path[1],st.particles[nt.path[1]]):nt.path.length===1&&nt.type===1?this.addParticle(nt.id,nt.data):nt.path.length===1&&nt.type===2&&this.deleteParticle(nt.id);else if(nt.path[0]==="colors")nt.path.length===2&&nt.type===0?this.updateColor(nt.path[1],nt.props):nt.path.length===1&&nt.type===1?this.addColor(nt.id,nt.data):nt.path.length===1&&nt.type===2&&this.deleteColor(nt.id);else if(nt.path[0]==="materials")nt.path.length===1&&nt.type===1?this.addMaterial(nt.id,nt.data):nt.path.length===1&&nt.type===2?this.deleteMaterial(nt.id):nt.path.length>1&&this.getMaterial(nt.path[1]).updateByOp(Rr.drop(nt,2),st.materials[nt.path[1]],{shared:this,scene:mt});else if(nt.path[0]==="fonts")nt.path.length===2&&nt.type===0?this.updateFont(nt.path[1],nt,mt):nt.path.length===1&&nt.type===1?this.addFont(nt.id,nt.data):nt.path.length===1&&nt.type===2&&this.deleteFont(nt.id);else if(nt.path[0]==="variables")nt.path.length===2&&nt.type===0?"value"in nt.props?this.updateVariable(nt.path[1],nt.props.value):"persistent"in nt.props&&(this.variables[nt.path[1]].persistent=nt.props.persistent):nt.path.length===1&&nt.type===4?this.addVariableHolder(nt.id,nt.data):nt.path.length===1&&nt.type===5&&this.deleteVariable(nt.id);else if(nt.path[0]==="userAPIs"){if(nt.path.length===1&&nt.type===1)this.addUserAPI(nt.id,nt.data);else if(nt.path.length===1&&nt.type===2)this.deleteUserAPI(nt.id);else if(typeof nt.path[1]=="string"){let Et=st.userAPIs[nt.path[1]];Et&&((gt=this.getUserAPI(nt.path[1]))==null||gt.update(Et,this))}}else if(nt.path[0]==="userWebhooks"){if(nt.path.length===1&&nt.type===1)this.addUserWebhook(nt.id,nt.data);else if(nt.path.length===1&&nt.type===2)this.deleteUserWebhook(nt.id);else if(typeof nt.path[1]=="string"){let Et=st.userWebhooks[nt.path[1]];Et&&((_t=this.getUserWebhook(nt.path[1]))==null||_t.update(Et))}}else nt.path[0]==="lib"&&this.updateLibByOp(Rr.drop(nt,1),mt)}updateFont(nt,st,mt){if(st.props.url){let gt=this.getFont(nt),_t={...this.data.fonts[nt],url:st.props.url};gt.update(_t),gt.loadingPromise.then(()=>this.requestRender()),mt.updateFont(nt,this)}}addUserAPI(nt,st){return this.userAPIs[nt]?(this.userAPIs[nt].update(st,this),!0):(this.userAPIs[nt]=new ex(nt,st,this),!1)}getUserAPI(nt){return this.userAPIs[nt]}getUserAPIs(){return this.userAPIs}deleteUserAPI(nt){let st=this.userAPIs[nt];st&&(st.dispose(),delete this.userAPIs[nt])}addUserWebhook(nt,st){return this.userWebhooks[nt]?(this.userWebhooks[nt].update(st),!0):(this.userWebhooks[nt]=new rx(nt,st),!1)}getUserWebhook(nt){return this.userWebhooks[nt]}getUserWebhooks(){return this.userWebhooks}deleteUserWebhook(nt){let st=this.userWebhooks[nt];st&&(st.dispose(),delete this.userWebhooks[nt])}};new Xc(vn.emptyData());var ys=class extends mr{updateByPatchedOp(nt,st,mt){if(super.updateByPatchedOp(nt,st,mt),lD(nt.path,["materials"])!==null&&nt.type===0&&Array.isArray(this.material))for(let[gt,_t]of Object.entries(nt.props)){let Et=mt.shared.material(_t);this.material[Number(gt)]=Et}else if(Lt(nt.path,["material"])&&this.material instanceof Nn)"material"in st&&typeof st.material!="string"&&this.material.updateByOp(Rr.drop(nt,1),st.material,mt);else if(Lt(nt.path,["materials","*"])&&Array.isArray(this.material)){let gt=nt.path[1];if("materials"in st&&gt<this.material.length){let _t=st.materials[gt];typeof _t!="string"&&this.material[gt].updateByOp(Rr.drop(nt,2),_t,mt)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(nt,st){var gt,_t;super.updateState(nt,st),nt.castShadow!==void 0&&(this.castShadow=nt.castShadow),nt.receiveShadow!==void 0&&(this.receiveShadow=nt.receiveShadow);let mt=this.dataPatched;if(((gt=nt.geometry)==null?void 0:gt.type)!=="NonParametricGeometry"&&"material"in nt&&nt.material!==void 0&&(this.disposeMaterial(),this.material=st.shared.material(nt.material).getFlavor(mt.flatShading,mt.side,mt.wireframe),st.scene.markNeedsUpdateRendererDirty()),(((_t=nt.geometry)==null?void 0:_t.type)==="NonParametricGeometry"||"materials"in nt)&&("materials"in nt&&nt.materials!==void 0?(this.disposeMaterial(),this.material=nt.materials.map(Et=>st.shared.material(Et).getFlavor(mt.flatShading,mt.side,mt.wireframe)),st.scene.markNeedsUpdateRendererDirty()):"material"in nt&&nt.material!==void 0&&(this.disposeMaterial(),this.material=[st.shared.material(nt.material).getFlavor(mt.flatShading,mt.side,mt.wireframe)],st.scene.markNeedsUpdateRendererDirty())),nt.flatShading!==void 0||nt.wireframe!==void 0||nt.side!==void 0)if(Array.isArray(this.material))for(let Et=0;Et<this.material.length;Et++)this.material[Et]=this.material[Et].getFlavor(mt.flatShading,mt.side,mt.wireframe);else this.material=this.material.getFlavor(mt.flatShading,mt.side,mt.wireframe)}disposeMaterial(){this.material&&tv(this.material).forEach(nt=>{nt instanceof Nn&&(nt instanceof qc||nt.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},GR=new E$6,jR=new Ze$1,HR=new Ze$1,yX=new E$6,WR=new ue$1,lr=class extends ys{constructor(nt,st,mt){super(nt,st),this.data=st,this.isSkinnedMesh=!1,this.localGeometry=void 0,st.bindMode&&st.bindMatrix&&(this.bindMode=st.bindMode,this.bindMatrix=new ue$1().fromArray(st.bindMatrix),this.bindMatrixInverse=new ue$1)}chooseGeoemtryCache(nt){return nt.geometryCache}markGeometryAsReachable(nt){this.geometryCreateDeleyed instanceof _e$1&&this.chooseGeoemtryCache(nt).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof Xc){let nt=this.geometryCreateDeleyed,st=this.chooseGeoemtryCache(nt);this.geometryCreateDeleyed=st.get(this.dataPatched.geometry,nt,this)}return this.geometryCreateDeleyed}set geometry(nt){this.localGeometry=nt}get is2DAndNoDepth(){let nt=this.dataPatched.geometry;return Gp.is2DParametricMesh(nt.type)&&nt.depth===0}get is2DType(){return Gp.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(nt,st,mt){super.updateByPatchedOp(nt,st,mt),Lt(nt.path,["geometry"])&&this.updateByPatchedOpGeometry(Rr.drop(nt,1),st.geometry,mt)}removeInteractionGeometry(nt){var st;(st=this.localGeometry)==null||st.dispose(),this.localGeometry=void 0}updateGeometryInteractions(nt,st){var gt;this.invalidateDownstreamBooleanData();let mt=this.data.geometry.type;if(mt==="NonParametricGeometry"||mt==="SubdivGeometry"){let _t=nt;if(this.localGeometry===void 0){let Nt={...this.data.geometry,..._t};this.localGeometry=Ca(Nt,st,this.data.flatShading,this)}let Et,At,Rt;_t.scaleBaked?[Et,At,Rt]=_t.scaleBaked:{width:Et,height:At,depth:Rt}=_t;let Ft=this.localGeometry.userData;Ft.sxPrev!==void 0&&cm(this.localGeometry.attributes,Et/Ft.sxPrev,At/Ft.syPrev,Rt/Ft.szPrev),Ft.sxPrev=Et,Ft.syPrev=At,Ft.szPrev=Rt}else{let _t={...this.data.geometry,...nt};(gt=this.localGeometry)==null||gt.dispose(),this.localGeometry=Ca(_t,st,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let nt of this.attachedSurfaceCloners)nt.update()}refreshAttachedCloners(nt){for(let st of this.attachedSurfaceCloners)nt.scene.addPendingUpdateCloner(st.object)}refreshAttachedPaths(nt){for(let st of this.attachedPaths)nt.scene.addPendingCommand(()=>st.updateShape())}createGeometryDelayed(nt){this.geometryCreateDeleyed=nt.shared,this.refreshAttachedCloners(nt),this.refreshAttachedPaths(nt)}updateByPatchedOpGeometry(nt,st,mt){var _t;let gt=!1;nt.type===0&&nt.path.length===0&&Object.keys(nt.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof ni&&this.chooseGeoemtryCache(mt.shared).mutateIfUnique(this.geometryCreateDeleyed.data,st)===this.geometryCreateDeleyed&&(gt=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(st,nt.props.scaleBaked),this.refreshAttachedCloners(mt),this.refreshAttachedPaths(mt)),gt||((_t=mt.scene)==null||_t.markGeometryCacheDirty(),this.createGeometryDelayed(mt)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(nt,st){this.createGeometryDelayed(st)}updateState(nt,st){nt.geometry!==void 0&&this.updateGeometryOnStateUpdate(nt.geometry,st),super.updateState(nt,st)}updateGeometryGroupsIfNeeded(){var nt;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((nt=this.geometry.getIndex())==null?void 0:nt.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(nt,st){let mt=this.geometry.userData.parameters;this.is2DType?nt.set(0,0,mt.depth*.5):this.isNonParametric?(nt.setScalar(0),this.geometry.boundingSphere&&nt.copy(this.geometry.boundingSphere.center),st.set(mt.width,mt.height,mt.depth??0).multiplyScalar(.5)):nt.setScalar(0),st.set(mt.width,mt.height,mt.depth??0).multiplyScalar(.5)}updateMatrixWorld(nt){super.updateMatrixWorld(nt),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(nt,st){this.skeleton=nt,this.isSkinnedMesh=!0,st===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),st=this.matrixWorld),this.bindMatrix.copy(st),this.bindMatrixInverse.copy(st).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(nt){let st=new Ze$1,mt=this.geometry.attributes.skinWeight;for(let gt=0,_t=mt.count;gt<_t;gt++){st.fromBufferAttribute(mt,gt);let Et=1/st.manhattanLength();Et!==1/0?st.multiplyScalar(Et):st.set(1,0,0,0),mt.setXYZW(gt,st.x,st.y,st.z,st.w)}}boneTransform(nt,st){let mt=this.skeleton;if(mt===void 0)return;let gt=this.geometry;jR.fromBufferAttribute(gt.attributes.skinIndex,nt),HR.fromBufferAttribute(gt.attributes.skinWeight,nt),GR.copy(st).applyMatrix4(this.bindMatrix),st.set(0,0,0);for(let _t=0;_t<4;_t++){let Et=HR.getComponent(_t);if(Et!==0){let At=jR.getComponent(_t);WR.multiplyMatrices(mt.bones[At].matrixWorld,mt.boneInverses[At]),st.addScaledVector(yX.copy(GR).applyMatrix4(WR),Et)}}return st.applyMatrix4(this.bindMatrixInverse)}};function vX(nt){var At,Rt;if(nt.geometry.attributes.extrudeNormal||!nt.geometry.attributes.position||!nt.geometry.attributes.normal)return;let st=new Map,mt=nt.geometry.attributes,gt=mt.position.array,_t=mt.normal.array,Et=new Float32Array(gt.length);for(let Ft=0;Ft<gt.length;Ft+=3){let Nt=`${gt[Ft]}_${gt[Ft+1]}_${gt[Ft+2]}`,Bt=new E$6(_t[Ft],_t[Ft+1],_t[Ft+2]);st.has(Nt)?(At=st.get(Nt))==null||At.normals.push(Bt):st.set(Nt,{normals:[Bt],result:new E$6})}st.forEach((Ft,Nt)=>{for(let Bt of Ft.normals)Ft.result.add(Bt);Ft.result.divideScalar(Ft.normals.length)});for(let Ft=0;Ft<gt.length;Ft+=3){let Nt=`${gt[Ft]}_${gt[Ft+1]}_${gt[Ft+2]}`,Bt=(Rt=st.get(Nt))==null?void 0:Rt.result;Bt&&(Et[Ft]=Bt.x,Et[Ft+1]=Bt.y,Et[Ft+2]=Bt.z)}nt.geometry.setAttribute("extrudeNormal",new Me$1(Et,3))}function xX(nt){if(nt.geometry.attributes.extrudeNormals||!nt.geometry.attributes.position)return;let st=nt.geometry.attributes.position.array,mt=new Float32Array(st.length),gt=new E$6;for(let _t=0;_t<st.length;_t+=3)gt.set(st[_t],st[_t+1],st[_t+2]).normalize(),mt[_t]=gt.x,mt[_t+1]=gt.y,mt[_t+2]=gt.z;nt.geometry.setAttribute("extrudeNormal",new Me$1(mt,3))}function Jd(nt){if(Array.isArray(nt.material)){for(let st of nt.material)if(st.getLayersOfType("outline").length===0)return}else if(!(nt.material instanceof Nn)||nt.material.getLayersOfType("outline").length===0)return;nt instanceof lr&&nt.is2DAndNoDepth?xX(nt):vX(nt)}function $d(nt){if(!nt.geometry.attributes.position)return;let st=nt.geometry.attributes.position.array,mt=new Float32Array(st.length),gt=parseInt(nt.uuid.replace(/\D/g,"")),_t=[we$1.seededRandom(gt),we$1.seededRandom(gt+1e4),we$1.seededRandom(gt+2e4)];for(let Et=0;Et<st.length;Et++)mt[Et]=_t[Et%3];nt.geometry.setAttribute("randomColor",new Xe$1(mt,3))}var Bo=new jt,Am=new E$6;function qR(nt){let st=!1;return nt.scene.objects.traverse((mt,gt)=>{gt.type==="Mesh"&&gt.geometry.type==="SubdivGeometry"&&(st=!0)}),st}var Ks=class extends lr{constructor(nt,st,mt){super(nt,st,mt),this.data=st,this.hiddenMatrixOld=new ue$1,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(nt){return this.dataPatched.flatShading?nt.geometryCache:nt.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(nt,st){let mt=this.geometry.userData.parameters;nt.copy(this.originalGeometryNew.boundingSphere.center),st.set(mt.width,mt.height,mt.depth??0).multiplyScalar(.5)}createGeometryByControls(nt){var Et,At,Rt;if(this.skipReactionUpdate===!0)return;let st=(Et=this.localGeometry)==null?void 0:Et.uuid,{originalGeometry:mt,subdividedGeometry:gt,subdivPointer:_t}=ni.build(nt,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=_t,mt!==void 0&&((At=this.originalGeometry)==null||At.dispose(),this.originalGeometry=mt),gt!==void 0&&((Rt=this.subdividedGeometry)==null||Rt.dispose(),this.subdividedGeometry=gt??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,Jd(this),$d(this),this.calcBoundingBox(),st&&(this.localGeometry.uuid=st)}updateState(nt,st){if(super.updateState(nt,st),nt.flatShading!==void 0){let mt=this.material;this.material=Array.isArray(mt)?mt.map(gt=>gt.getFlavor(!1,gt.side,gt.wireframe)):mt.getFlavor(!1,mt.side,mt.wireframe),this.smoothShading=!nt.flatShading,this.createGeometryDelayed(st)}}updateMesh(nt=!1){ni.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,nt&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&ni.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,nt&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=ni.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=ni.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(nt,st){let mt=this.localGeometry;this.localGeometry=this.originalGeometryNew,mr.prototype.raycast.call(this,nt,st),this.localGeometry=mt}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let nt=this.originalGeometry;nt.boundingSphere===null&&(nt.boundingSphere=new Or,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=nt.boundingSphere));let st=nt.attributes.position,mt=nt.boundingSphere.center;Bo.setFromBufferAttribute(st),Bo.getCenter(mt),nt.boundingSphere.radius=mt.distanceTo(Bo.max),isNaN(nt.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Bo.getSize(Am),this.hasNonUniformScale&&Am.divide(this.scale);let gt={width:Am.x,height:Am.y,depth:Am.z};return this.geometry.userData.parameters=gt,gt}updateBoundingSphere(nt){let st=this.originalGeometry;Bo.min.set(nt[0],nt[2],nt[4]),Bo.max.set(nt[1],nt[3],nt[5]),this.hasNonUniformScale&&(Bo.min.applyMatrix4(this.shearScaleInv),Bo.max.applyMatrix4(this.shearScaleInv)),st.boundingSphere===null&&(st.boundingSphere=new Or);let mt=st.boundingSphere.center;Bo.getCenter(mt),st.boundingSphere.radius=mt.distanceTo(Bo.max)}freeSubdivPointer(){var nt,st;this.subdivPointer&&(ni.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(nt=this.originalGeometry)==null||nt.dispose(),(st=this.subdividedGeometry)==null||st.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(nt,st,mt){super.updateByPatchedOpGeometry(nt,st,mt),this.localGeometry&&this.createGeometryByControls(st)}},YR=-1,bX=1,XR={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},QR={polygon_center:0,edge:1,vertex:2},Em=(nt,st)=>(mt,gt)=>!st||mt===0||nt===0?0:nt*gt/100,vt=(nt,st)=>{let mt=Math.abs(st),gt=mt*-1;return(nt-YR)*(mt-gt)/(bX-YR)+gt};function KR(nt){let st=[],mt={};for(var gt=0,_t=nt.length;gt<_t;gt++){var Et=JSON.stringify(nt[gt].pos.map(At=>Math.round(At*1e4)/1e4));mt[Et]||(st.push(nt[gt]),mt[Et]=!0)}return st}var SX=new E$6,nx=new E$6,wX=new E$6,AX=new E$6;function ef(nt,st){let mt=wX.fromArray(nt),gt=AX.fromArray(st);nx.copy(gt).sub(mt);let _t=nx.length();return nx.normalize().multiplyScalar(_t*.5),SX.copy(mt).add(nx).toArray()}var vs=new Cr,sx=new E$6,ox=new E$6,Qc=new E$6;function ZR(nt){let st=[];for(let mt=0;mt<=nt.index.count;mt++)if(sx.fromArray(nt.index.array,mt*3),vs.setFromAttributeAndIndices(nt.attributes.position,sx.x,sx.y,sx.z),vs.getNormal(ox),vs.getMidpoint(Qc),!(isNaN(Qc.x)||isNaN(Qc.y)||isNaN(Qc.z))){let{a:gt,b:_t,c:Et}=vs,At=gt.toArray(),Rt=_t.toArray(),Ft=Et.toArray(),Nt=gt.distanceTo(_t),Bt=_t.distanceTo(Et),Gt=Et.distanceTo(gt),dr=ef(At,Rt),Mr=ef(Rt,Ft),Tr=ef(Ft,At),zr=[Nt,Bt,Gt],Fr=Math.max(...zr),Nr=zr.filter(Tn=>Math.round(Tn)===Math.round(Fr)).length>1,tn=[],rn=vs.getMidpoint(Qc).toArray();Fr===Nt&&!Nr&&(tn=[Mr,Tr,Tr],rn=dr),Fr===Bt&&!Nr&&(tn=[dr,Tr,Tr],rn=Mr),Fr===Gt&&!Nr&&(tn=[dr,Mr,Mr],rn=Tr),Nr&&(tn=[dr,Mr,Tr]),st.push({vertices:[At,Rt,Ft],faceCenters:tn,midpoint:rn,norm:vs.getNormal(ox).toArray()})}return st}function JR(nt){let st=[],{position:mt}=nt.attributes;for(let gt=0;gt<mt.count;gt++){vs.setFromAttributeAndIndices(mt,gt*3,gt*3+1,gt*3+2),vs.getNormal(ox),vs.getMidpoint(Qc);let _t=vs.a.toArray(),Et=vs.b.toArray(),At=vs.c.toArray();st.push({vertices:[_t,Et,At],faceCenters:[ef(_t,Et),ef(Et,At),ef(At,_t)],midpoint:Qc.toArray(),norm:ox.toArray()})}return st}var EX=4,MX=.5,bE=nt=>.5*(1-Math.cos(nt*Math.PI)),SE=class{constructor(){this.perlin=new Array(4096)}noise(nt,st=0,mt=0){if(this.perlin==null){this.perlin=new Array(4096);for(let Fr=0;Fr<4096;Fr++)this.perlin[Fr]=Math.random()}nt<0&&(nt=-nt),st<0&&(st=-st),mt<0&&(mt=-mt);let gt=Math.floor(nt),_t=Math.floor(st),Et=Math.floor(mt),At=nt-gt,Rt=st-_t,Ft=mt-Et,Nt,Bt,Gt=0,dr=.5,Mr,Tr,zr;for(let Fr=0;Fr<EX;Fr++){let Nr=gt+(_t<<4)+(Et<<8);Nt=bE(At),Bt=bE(Rt),Mr=this.perlin[Nr&4095],Mr+=Nt*(this.perlin[Nr+1&4095]-Mr),Tr=this.perlin[Nr+16&4095],Tr+=Nt*(this.perlin[Nr+16+1&4095]-Tr),Mr+=Bt*(Tr-Mr),Nr+=256,Tr=this.perlin[Nr&4095],Tr+=Nt*(this.perlin[Nr+1&4095]-Tr),zr=this.perlin[Nr+16&4095],zr+=Nt*(this.perlin[Nr+16+1&4095]-zr),Tr+=Bt*(zr-Tr),Mr+=bE(Ft)*(Tr-Mr),Gt+=Mr*dr,dr*=MX,gt<<=1,At*=2,_t<<=1,Rt*=2,Et<<=1,Ft*=2,At>=1&&(gt++,At--),Rt>=1&&(_t++,Rt--),Ft>=1&&(Et++,Ft--)}return Gt}noiseSeed(nt){let st=(()=>{let mt,gt;return{setSeed(_t){gt=mt=(_t??Math.random()*4294967296)>>>0},getSeed(){return mt},rand(){return gt=(1664525*gt+1013904223)%4294967296,gt/4294967296}}})();st.setSeed(nt),this.perlin=new Array(4096);for(let mt=0;mt<4096;mt++)this.perlin[mt]=st.rand()}},$R=SE,e3=new E$6,t3=new ue$1,r3=new Rs;function wE(nt){let st=!1;return nt.scene.objects.traverse((mt,gt)=>{gt.type==="Mesh"&&(gt.geometry.type==="TextGeometry"||gt.geometry.type==="InputGeometry")&&(st=!0)}),st}var Ul=class extends lr{constructor(nt,st,mt){super(nt,st,mt),this.data=st}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var st;let nt=this.dataPatched;return((st=this.font)==null?void 0:st.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,nt.geometry.height,this.fontScale,nt.geometry.verticalAlign))??0}get fontScale(){let nt=this.dataPatched;return this.font?nt.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var nt;return(((nt=this.font)==null?void 0:nt.ascender)??1)*this.fontScale}get descender(){var nt;return(((nt=this.font)==null?void 0:nt.descender)??1)*this.fontScale}get lineHeight(){let nt=this.dataPatched;return nt.geometry.fontSize*nt.geometry.lineHeight}raycast(nt,st){let{matrixWorld:mt}=this;if(!(isNaN(nt.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(t3.copy(mt).invert(),r3.copy(nt.ray).applyMatrix4(t3),r3.intersectBox(this.singleBBox,e3))){let gt=e3.applyMatrix4(mt),_t=nt.ray.origin.distanceTo(gt);st.push({distance:_t,point:gt.clone(),object:this})}}},An=1e-4,No,s3,o3,a3,i3=new E$6,n3=new E$6;I0.then(nt=>{No=nt,s3=[No.get_face_center,No.get_edge_midpoint,No.get_vertex_position],o3=[No.get_face_normal,No.get_edge_normal,No.get_vertex_normal],a3=[No.face_count,No.edge_count,No.vertex_count]});var TX=new ue$1,CX=new ue$1,zl=new E$6,ax=new E$6,Mm=new E$6,AE=new E$6,PX=new E$6,_X=new E$6,Ra=new $R,Gi=class extends fd(Mt){constructor(nt,st){super(),this.parameters=st,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=nt}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(nt){if(this.parent===null)this.updateState(this.parameters,nt);else for(let st of this.children)st instanceof Br&&st.expand()}invalidateTransform(nt){this.matrixWorldNeedsUpdate=!0,this.traverse(st=>{st instanceof Br&&st.object===nt&&(st.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let nt of this.children)nt.updateMatrix(),nt.hasNonUniformScale&&(nt.updateMatrixWorld(),nt.updateMatrixWorldSVD())}_updateCount(nt){let st;if(nt!==void 0?st=nt:st=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(st=0),this.parameters.type==="toObject"&&this.objectForSample){for(let gt=0,_t=this.children.length;gt<_t;++gt)this.remove(this.children[0]);let mt=this.children;if(mt.length===st)return;if(mt.length<st)for(let gt=0,_t=st-mt.length;gt<_t;++gt){let Et=new Br(this.object);Et.expand(),this.add(Et)}else for(let gt=0,_t=mt.length-st;gt<_t;++gt)this.remove(mt[gt])}else{if(this.children.length===st)return;if(this.children.length<st)for(let mt=0,gt=st-this.children.length;mt<gt;++mt){let _t=new Br(this.object);_t.expand(),this.add(_t)}else for(let mt=0,gt=this.children.length-st;mt<gt;++mt)this.remove(this.children[0])}}_updateRadial(nt){let st=nt.radial,mt=st.start*we$1.DEG2RAD,gt=st.end*we$1.DEG2RAD,_t=mt-gt,Et=new ir(st.rotation[0],st.rotation[1],st.rotation[2]),At;switch(st.axis){case"z":At=new E$6(0,0,1);break;case"y":At=new E$6(0,1,0);break;default:case"x":At=new E$6(1,0,0);break}let Rt=nt.randomnessObject??Eo.defaultData([1,1,1]).randomnessObject,Ft=Rt.noiseType==="perlin";Ra.noiseSeed(Rt.seed);let Nt=d0((0,tf.default)(Rt.seed)),Bt=Em(Rt.strength,this.parameters.randomness);for(let[Gt,dr]of this.children.entries()){let Mr=Gt*(Rt.freqScale/10)+Rt.movement,Tr=Ft?Ra.noise(Mr):Nt(Mr,Mr),zr=Gt+1;dr.scale.x=st.scale[0]+Bt(zr,vt(Tr,Rt.scale[0]))||An,dr.scale.y=st.scale[1]+Bt(zr,vt(Tr,Rt.scale[1]))||An,dr.scale.z=st.scale[2]+Bt(zr,vt(Tr,Rt.scale[2]))||An,dr.position.setScalar(0);let Fr=_t/nt.count*Gt-mt;switch(st.axis){case"x":dr.rotation.set(0,Fr,0);break;case"y":dr.rotation.set(0,0,Fr);break;case"z":dr.rotation.set(Fr,0,0);break}dr.translateOnAxis(At,st.radius),dr.position.x+=st.position[0]+Bt(zr,vt(Tr,Rt.position[0])),dr.position.y+=st.position[1]+Bt(zr,vt(Tr,Rt.position[1])),dr.position.z+=st.position[2]+Bt(zr,vt(Tr,Rt.position[2]));let Nr=Bt(zr,vt(Tr,Rt.rotation[0])),tn=Bt(zr,vt(Tr,Rt.rotation[1])),rn=Bt(zr,vt(Tr,Rt.rotation[2]));st.alignment===!0?(dr.rotation.x+=Et.x+Nr,dr.rotation.y+=Et.y+tn,dr.rotation.z+=Et.z+rn):dr.rotation.set(Et.x+Nr,Et.y+tn,Et.z+rn)}}_updateLinear(nt){if(nt.type!=="linear")throw new Error;let st=nt.linear,mt=new ir(st.rotation[0],st.rotation[1],st.rotation[2]),gt=nt.randomnessObject??Eo.defaultData([1,1,1]).randomnessObject,_t=gt.noiseType==="perlin";Ra.noiseSeed(gt.seed);let Et=d0((0,tf.default)(gt.seed)),At=Em(gt.strength,this.parameters.randomness);for(let[Rt,Ft]of this.children.entries()){let Nt=Rt*(gt.freqScale/10)+gt.movement,Bt=_t?Ra.noise(Nt):Et(Nt,Nt),Gt=Rt+1,dr=At(Gt,vt(Bt,gt.rotation[0])),Mr=At(Gt,vt(Bt,gt.rotation[1])),Tr=At(Gt,vt(Bt,gt.rotation[2]));Ft.scale.x=1+(st.scale[0]-1)*Rt+At(Gt,vt(Bt,gt.scale[0]))||An,Ft.scale.y=1+(st.scale[1]-1)*Rt+At(Gt,vt(Bt,gt.scale[1]))||An,Ft.scale.z=1+(st.scale[2]-1)*Rt+At(Gt,vt(Bt,gt.scale[2]))||An,Ft.rotation.x=mt.x*Rt+dr,Ft.rotation.y=mt.y*Rt+Mr,Ft.rotation.z=mt.z*Rt+Tr,Ft.position.x=st.position[0]*Rt+At(Gt,vt(Bt,gt.position[0])),Ft.position.y=st.position[1]*Rt+At(Gt,vt(Bt,gt.position[1])),Ft.position.z=st.position[2]*Rt+At(Gt,vt(Bt,gt.position[2]))}}_updateGrid(nt){let st=0,mt=nt.grid,gt=nt.randomnessObject??Eo.defaultData([1,1,1]).randomnessObject,_t=Em(gt.strength,this.parameters.randomness),Et=gt.noiseType==="perlin";Ra.noiseSeed(gt.seed);let At=UI((0,tf.default)(gt.seed));if(mt.useCenter===!0){let Rt={x:mt.count[0]%2===0?2:1,y:mt.count[1]%2===0?2:1,z:mt.count[2]%2===0?2:1},Ft=new E$6(mt.size[0]*(mt.count[0]-Rt.x)*.5,mt.size[1]*(mt.count[1]-Rt.y)*.5,mt.size[2]*(mt.count[2]-Rt.z)*.5);for(let Nt=0;Nt<mt.count[0];Nt++)for(let Bt=0;Bt<mt.count[1];Bt++)for(let Gt=0;Gt<mt.count[2];Gt++){let dr=[(Nt+1)*(gt.freqScale/10)+gt.movement,(Bt+1)*(gt.freqScale/10)+gt.movement,(Gt+1)*(gt.freqScale/10)+gt.movement],Mr=Et?Ra.noise(...dr):At(...dr),Tr=this.children[st++];Tr.scale.x=1+_t(st,vt(Mr,gt.scale[0]))||An,Tr.scale.y=1+_t(st,vt(Mr,gt.scale[1]))||An,Tr.scale.z=1+_t(st,vt(Mr,gt.scale[2]))||An;let zr=_t(st,vt(Mr,gt.rotation[0])),Fr=_t(st,vt(Mr,gt.rotation[1])),Nr=_t(st,vt(Mr,gt.rotation[2]));Tr.rotation.set(zr,Fr,Nr),Tr.position.x=mt.size[0]*Nt-Ft.x+_t(st,vt(Mr,gt.position[0])),Tr.position.y=mt.size[1]*Bt-Ft.y+_t(st,vt(Mr,gt.position[1])),Tr.position.z=mt.size[2]*Gt-Ft.z+_t(st,vt(Mr,gt.position[2]))}}else for(let Rt=0;Rt<mt.count[0];Rt++)for(let Ft=0;Ft<mt.count[1];Ft++)for(let Nt=0;Nt<mt.count[2];Nt++){let Bt=[(Rt+1)*(gt.freqScale/10)+gt.movement,(Ft+1)*(gt.freqScale/10)+gt.movement,(Nt+1)*(gt.freqScale/10)+gt.movement],Gt=Et?Ra.noise(...Bt):At(...Bt),dr=this.children[st++];dr.scale.x=1+_t(st,vt(Gt,gt.scale[0]))||An,dr.scale.y=1+_t(st,vt(Gt,gt.scale[1]))||An,dr.scale.z=1+_t(st,vt(Gt,gt.scale[2]))||An;let Mr=_t(st,vt(Gt,gt.rotation[0])),Tr=_t(st,vt(Gt,gt.rotation[1])),zr=_t(st,vt(Gt,gt.rotation[2]));dr.rotation.set(Mr,Tr,zr),dr.position.x=mt.size[0]*Rt+_t(st,vt(Gt,gt.position[0])),dr.position.y=-mt.size[1]*Ft+_t(st,vt(Gt,gt.position[1])),dr.position.z=-mt.size[2]*Nt+_t(st,vt(Gt,gt.position[2]))}}_updateToObject(nt){var zr;if(nt.type!=="toObject")throw new Error;let{toObject:st}=nt,mt=new ir(st.rotation[0],st.rotation[1],st.rotation[2]),gt=nt.randomnessObject??Eo.defaultData([1,1,1]).randomnessObject,_t=gt.noiseType==="perlin";Ra.noiseSeed(gt.seed);let Et=d0((0,tf.default)(gt.seed)),At=Em(gt.strength,this.parameters.randomness);if(!st.object){for(let[,Fr]of this.children.entries())Fr.position.set(0,0,0),Fr.scale.setScalar(1),Fr.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof Ul)if(!((zr=this.objectForSample.font)!=null&&zr.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let Rt=this.getSubdivData(),Ft=[],Nt=Fr=>{let Nr=Fr.length,tn=Fr.map($n=>$n[0]).reduce(($n,un)=>$n+un,0),rn=Fr.map($n=>$n[1]).reduce(($n,un)=>$n+un,0),Tn=Fr.map($n=>$n[2]).reduce(($n,un)=>$n+un,0);return[tn/Nr,rn/Nr,Tn/Nr]},Bt=Fr=>Math.round(Fr*1e6)/1e6;Rt.forEach(Fr=>{let Nr=Rt.filter(tn=>Bt(Fr.pos[0])===Bt(tn.pos[0])&&Bt(Fr.pos[1])===Bt(tn.pos[1])&&Bt(Fr.pos[2])===Bt(tn.pos[2]));Nr.length>1?Ft.push({pos:Fr.pos,norm:Nt(Nr.map(tn=>tn.norm))}):Ft.push(Fr)});let Gt=KR(Ft);if(Gt.length>0){let Fr=Math.round(Gt.length*st.count/100);this._updateCount(Fr)}else{let Fr=this.objectForSample.geometry.getAttribute("position");if(!Fr||isNaN(Fr.count)||Fr.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let dr=new f0(this.objectForSample).build(),Mr=XR[st.axis],Tr=this.children;dr.setRandomGenerator((0,tf.default)(this.object.uuid+st.seed));for(let[Fr,Nr]of Tr.entries()){let tn=Fr*(gt.freqScale/10)+gt.movement,rn=_t?Ra.noise(tn):Et(tn,tn),Tn=Fr+1,$n=At(Tn,vt(rn,gt.rotation[0])),un=At(Tn,vt(rn,gt.rotation[1])),es=At(Tn,vt(rn,gt.rotation[2]));st.spreadType==="random"?dr.sample(Mm,AE):(Gt.length&&(Mm.fromArray(Gt[Fr].pos),AE.fromArray(Gt[Fr].norm)),this.objectForSample instanceof Ks&&Mm.applyMatrix4(TX.copy(this.objectForSample.matrixWorld).invert())),Mm.applyMatrix4(this.object.hiddenMatrix.clone().invert()),Nr.position.copy(Mm),zl.fromArray(Mr);let kn=st.align==="normal"?AE:this.object.getWorldDirection(_X),ts=ax.fromArray(st.position);ax.x+=At(Tn,vt(rn,gt.position[0])),ax.y+=At(Tn,vt(rn,gt.position[1])),ax.z+=At(Tn,vt(rn,gt.position[2]));let Ko=Math.acos(kn.dot(zl)),ds=PX.crossVectors(zl,kn).normalize(),Il=CX.makeRotationAxis(ds,Ko),ru=kn.clone().cross(this.object.up).normalize(),uu=ru.clone().cross(kn).normalize(),p0=new ue$1().makeBasis(ru,kn,uu),X1=new E$6(zl.y,zl.z,zl.x).normalize(),q0=X1.clone().cross(zl).normalize(),W0=new ue$1().makeBasis(X1,zl,q0).invert(),hu=new ue$1().multiplyMatrices(p0,W0);Nr.rotation.setFromRotationMatrix(hu),ts.applyMatrix4(Il),Nr.position.add(ts),Nr.rotation.x=Nr.rotation.x+mt.x+$n,Nr.rotation.y=Nr.rotation.y+mt.y+un,Nr.rotation.z=Nr.rotation.z+mt.z+es,Nr.scale.setScalar(1),Nr.scale.x=Nr.scale.x+st.scale[0]+At(Tn,vt(rn,gt.scale[0]))||An,Nr.scale.y=Nr.scale.y+st.scale[1]+At(Tn,vt(rn,gt.scale[1]))||An,Nr.scale.z=Nr.scale.z+st.scale[2]+At(Tn,vt(rn,gt.scale[2]))||An,Nr.scale.multiply(this.object.scale),Nr.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let nt=this.parameters.toObject.spreadType;if(nt==="random")return[];if(this.objectForSample instanceof Ks){let st=this.objectForSample,mt=QR[nt],gt=a3[mt],_t=s3[mt],Et=o3[mt],At=[],Rt=gt(st.subdivPointerNew);for(let Ft=0;Ft<=Rt-1;Ft++){let Nt=_t(st.subdivPointerNew,Ft),Bt=Et(st.subdivPointerNew,Ft);i3.fromArray(Nt).applyMatrix4(st.matrixWorld),n3.fromArray(Bt),At.push({pos:i3.toArray(),norm:n3.toArray()})}return At}else return(this.objectForSample.geometry.index?ZR(this.objectForSample.geometry):JR(this.objectForSample.geometry)).map((st,mt)=>nt==="polygon_center"?{pos:st.midpoint,norm:st.norm}:nt==="vertex"?[{pos:st.vertices[0],norm:st.norm},{pos:st.vertices[1],norm:st.norm},{pos:st.vertices[2],norm:st.norm}]:nt==="edge"?[{pos:st.faceCenters[0],norm:st.norm},{pos:st.faceCenters[1],norm:st.norm},{pos:st.faceCenters[2],norm:st.norm}]:[]).flat()}updateState(nt,st){var mt;if(this.parameters=fa(nt),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(mt=this.object.parent)==null||mt.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let gt=st.find(this.parameters.toObject.object);gt instanceof mr?this.objectForSample=gt:this.objectForSample=void 0,this.matrix=new ue$1,this.hiddenMatrix=new ue$1,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,gt&&gt.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},Fo$1=nt=>{var st;return st=class extends nt{},st.geometryHelper=new mi(30,30,30),st},lx=new Rs,EE=new Or,l3=new ue$1,Vo=(nt,st,mt,gt,_t=!1,Et=nt)=>{let At=st,Rt=Et.matrixWorld;if(At.boundingSphere===null&&At.computeBoundingSphere(),EE.copy(At.boundingSphere),EE.applyMatrix4(Rt),mt.ray.intersectsSphere(EE)===!1||(l3.copy(Rt).invert(),lx.copy(mt.ray).applyMatrix4(l3),At.boundingBox!==null&&lx.intersectsBox(At.boundingBox)===!1))return;let Ft,Nt,Bt,Gt,dr=At.index,Mr=At.attributes.position,Tr=At.drawRange,zr,Fr;if(_t===!1){let tn=Math.max(0,Tr.start),rn=Math.min(dr.count,Tr.start+Tr.count);for(zr=tn,Fr=rn;zr<Fr;zr+=3)if(Nt=dr.getX(zr),Bt=dr.getX(zr+1),Gt=dr.getX(zr+2),Ft=Nr(nt,mt,lx,Mr,Nt,Bt,Gt),Ft){Ft.faceIndex=Math.floor(zr/3),gt.push(Ft);return}}else{let tn=At.attributes.position,rn=new E$6,Tn=new E$6,$n=new E$6,un=new E$6,es=2,kn=1/((Et.scale.x+Et.scale.y+Et.scale.z)/3),ts=kn*kn,Ko=Math.max(0,Tr.start),ds=Math.min(tn.count,Tr.start+Tr.count);for(let Il=Ko,ru=ds-1;Il<ru;Il+=es){if(rn.fromBufferAttribute(tn,Il),Tn.fromBufferAttribute(tn,Il+1),lx.distanceSqToSegment(rn,Tn,un,$n)>ts)continue;un.applyMatrix4(Et.matrixWorld);let uu=mt.ray.origin.distanceTo(un);uu<mt.near||uu>mt.far||gt.push({distance:uu,point:$n.clone().applyMatrix4(Et.matrixWorld),object:nt})}}function Nr(tn,rn,Tn,$n,un,es,kn){let ts=new E$6,Ko=new E$6,ds=new E$6,Il=new E$6,ru=new E$6;if(ts.fromBufferAttribute($n,un),Ko.fromBufferAttribute($n,es),ds.fromBufferAttribute($n,kn),Tn.intersectTriangle(ts,Ko,ds,!1,Il)===null)return null;ru.copy(Il),ru.applyMatrix4(tn.matrixWorld);let uu=rn.ray.origin.distanceTo(ru);return uu<rn.near||uu>rn.far?null:{faceIndex:1,distance:uu,point:ru.clone(),object:tn}}},cx=new E$6,xs=new qn,ME=class extends el{constructor(nt){let st=new _e$1,mt=new ss({color:16777215,vertexColors:!0,toneMapped:!1}),gt=[],_t=[],Et={},At=new We$1(15711266),Rt=new We$1(15711266),Ft=new We$1(2857471);Nt("n1","n2",At),Nt("n2","n4",At),Nt("n4","n3",At),Nt("n3","n1",At),Nt("f1","f2",At),Nt("f2","f4",At),Nt("f4","f3",At),Nt("f3","f1",At),Nt("n1","f1",At),Nt("n2","f2",At),Nt("n3","f3",At),Nt("n4","f4",At),Nt("p","n1",Rt),Nt("p","n2",Rt),Nt("p","n3",Rt),Nt("p","n4",Rt),Nt("u1","u2",Ft),Nt("u2","u3",Ft),Nt("u3","u1",Ft);function Nt(Gt,dr,Mr){Bt(Gt,Mr),Bt(dr,Mr)}function Bt(Gt,dr){gt.push(0,0,0),_t.push(dr.r,dr.g,dr.b),Et[Gt]===void 0&&(Et[Gt]=[]),Et[Gt].push(gt.length/3-1)}st.setAttribute("position",new Me$1(gt,3)),st.setAttribute("color",new Me$1(_t,3)),super(st,mt),this.type="CameraHelper",this.camera=nt,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=nt.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=Et,this.update()}update(){let nt=this.geometry,st=this.pointMap;xs.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let mt=1,gt=1,_t=.8;Zs("n1",st,nt,xs,-mt,-gt,_t),Zs("n2",st,nt,xs,mt,-gt,_t),Zs("n3",st,nt,xs,-mt,gt,_t),Zs("n4",st,nt,xs,mt,gt,_t);let Et=_t;Zs("f1",st,nt,xs,-mt,-gt,Et),Zs("f2",st,nt,xs,mt,-gt,Et),Zs("f3",st,nt,xs,-mt,gt,Et),Zs("f4",st,nt,xs,mt,gt,Et);let At=Et,Rt=.5;Zs("u1",st,nt,xs,mt*.7*Rt,gt*1.1,At),Zs("u2",st,nt,xs,-mt*.7*Rt,gt*1.1,At),Zs("u3",st,nt,xs,0,gt*(1.1+.9*Rt),At),nt.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Zs(nt,st,mt,gt,_t,Et,At){cx.set(_t,Et,At).unproject(gt);let Rt=st[nt];if(Rt!==void 0){let Ft=mt.getAttribute("position");for(let Nt=0,Bt=Rt.length;Nt<Bt;Nt++)Ft.setXYZ(Rt[Nt],cx.x,cx.y,cx.z)}}var ux=class extends Fo$1(ME){constructor(nt){super(nt),this.object=nt,this.object=nt,this.name=`CombinedCameraHelper: ${nt.uuid}`}updateMatrixWorld(nt){super.updateMatrixWorld(nt),this.updateTarget()}updateTarget(){let nt=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(nt)}raycast(nt,st){Vo(this.object,this.geometry,nt,st,!0)}},hx;(nt=>nt.is=st=>"objectHelper"in st)(hx||(hx={}));var bs=(nt,st)=>class extends md(nt){constructor(){super(...arguments),this.objectHelper=new st(this),this.gizmos={}}get geometryHelper(){return st.geometryHelper}raycast(mt,gt){this.objectHelper.raycast(mt,gt)}showGizmos(){for(let mt in this.gizmos){let gt=this.gizmos[mt];gt instanceof al&&(gt.visible=!0)}}updateEntityBoxSize(mt,gt){this.objectHelper.visible&&this.geometryHelper instanceof mi?(mt.setScalar(0),gt.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(mt,gt)}hideGizmos(){for(let mt in this.gizmos){let gt=this.gizmos[mt];gt instanceof al&&(gt.visible=!1)}}},dx=790,rf=new E$6,TE=new E$6,CE=new Qe$1,PE=new E$6,Tm=new E$6,_E=new E$6,wr=class extends bs(qn,ux){constructor(nt="",st={...Ic.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=bl.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(nt,st),this.previousProjectionMatrix=new ue$1,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let mt=this.width,gt=this.height;this.orthoCamera=new Ja(mt*-.5,mt*.5,gt*.5,gt*-.5,-5e4,1e4),this.perspCamera=new $r(45,mt/gt,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(nt){this.perspCamera.fov=nt}get fov(){return this.perspCamera.fov}setNear(nt,st){nt==="PerspectiveCamera"?this.perspCamera.near=st:this.orthoCamera.near=st}setZoom(nt,st){st>=0&&(nt==="PerspectiveCamera"?this.perspCamera.zoom=st:this.orthoCamera.zoom=st)}set cameraType(nt){nt==="PerspectiveCamera"?this.toPerspective():nt==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(nt){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=nt:this.orthoCamera.near=nt}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(nt){nt>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=nt:this.orthoCamera.zoom=nt)}lookAt(nt,st,mt){typeof nt=="number"&&(nt=new E$6(nt,st,mt)),super.lookAt(nt),this.getWorldPosition(rf),this.targetOffset=rf.distanceTo(nt)}getTarget(nt=new E$6){return this.getWorldDirection(TE),this.getWorldPosition(rf),TE.multiplyScalar(this.targetOffset),nt.copy(rf).add(TE),nt}getDistanceToTarget(){let nt=this.getTarget();return this.getWorldPosition(rf),rf.distanceTo(nt)}updateUp(){this.getWorldQuaternion(CE),PE.set(0,0,1).applyQuaternion(CE),Tm.copy(Mt.DEFAULT_UP),this.isUpVectorFlipped&&Tm.negate(),Tm.applyQuaternion(CE),_E.copy(Mt.DEFAULT_UP).projectOnPlane(PE),this.angleOffsetFromUp=_E.angleTo(Tm),this.angleOffsetFromUp*=_E.cross(Tm).dot(PE)>=0?1:-1}updateTransformState(nt,st){let mt=super.updateTransformState(nt,st);return nt.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=nt.isUpVectorFlipped),this.updateUp(),mt}getViewFrontToObject(nt){let st=nt.getWorldPosition(new E$6),mt=nt.getWorldDirection(new E$6).multiplyScalar(this.targetOffset);return{position:st.clone().add(mt),target:st}}getViewToTarget(nt){let st=this.getWorldDirection(new E$6).multiplyScalar(this.targetOffset);return{position:nt.clone().sub(st),target:nt}}getViewToObject(nt){let st=new E$6;return nt.getWorldPosition(st),this.getViewToTarget(st)}setViewplaneSize(nt,st,mt=!1){if(this.aspect=nt/st,mt){let gt=nt>st?this.aspect:1,_t=nt>st?1:this.aspect;this.left=-dx*.5*gt,this.right=dx*.5*gt,this.top=dx*.5*(1/_t),this.bottom=-dx*.5*(1/_t)}else this.left=-nt*.5,this.right=nt*.5,this.top=st*.5,this.bottom=-st*.5;this.updateProjectionMatrix()}copyViewPlaneSize(nt){this.aspect=nt.aspect,this.left=nt.left,this.right=nt.right,this.top=nt.top,this.bottom=nt.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(nt){this.perspCamera.setFocalLength(nt),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(nt,st,mt,gt,_t,Et){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(nt,st,mt,gt,_t,Et):this.orthoCamera.setViewOffset(nt,st,mt,gt,_t,Et)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(nt){super.updateMatrixWorld(nt),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(nt,st){super.updateWorldMatrix(nt,st),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(nt,st){return super.copy(nt,st),this.parent=nt.parent,this.orthoCamera.copy(nt.orthoCamera),this.perspCamera.copy(nt.perspCamera),this.left=nt.left,this.right=nt.right,this.top=nt.top,this.bottom=nt.bottom,this.far=nt.far,this.view=nt.view===null?null:Object.assign({},nt.view),this._cameraType=nt._cameraType,this.aspect=nt.aspect,this.fov=nt.fov,this.focus=nt.focus,this.filmGauge=nt.filmGauge,this.filmOffset=nt.filmOffset,this.targetOffset=nt.targetOffset,this.updateProjectionMatrix(),this}toCameraState(nt=[]){let st={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return Ch(st,nt)}updateCameraSubtype(nt,st){let mt=nt==="perspective"?"PerspectiveCamera":"OrthographicCamera";st.zoom!==void 0&&this.setZoom(mt,st.zoom),st.near!==void 0&&this.setNear(mt,st.near),st.fov!==void 0&&mt==="PerspectiveCamera"&&(this.fov=st.fov)}updateState(nt,st){this.updateCameraState(nt,st)}updateCameraState(nt,st){this.updateState_Entity(nt,st),nt.far!==void 0&&(this.far=nt.far),nt.orthographic!==void 0&&this.updateCameraSubtype("orthographic",nt.orthographic),nt.perspective!==void 0&&this.updateCameraSubtype("perspective",nt.perspective),nt.type!==void 0&&(this.cameraType=nt.type),nt.up!==void 0&&this.up.fromArray(nt.up),nt.targetOffset!==void 0&&(this.targetOffset=nt.targetOffset),nt.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=nt.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(nt,st,mt){super.updateByPatchedOp(nt,st,mt),nt.path.length===1&&nt.type===0&&this.updateCameraSubtype(nt.path[0],nt.props)}toState(nt){return{...super.toState(nt),...this.toCameraState(nt),type:this.cameraType}}},nf=new ue$1,OX=new ue$1;function DE(nt){let st=!1;return nt.scene.objects.traverse((mt,gt)=>{var _t;((_t=gt.geometry)==null?void 0:_t.type)==="BooleanGeometry"&&(st=!0)}),st}var Fn=class extends ys{constructor(nt,st,mt){super(nt,st),this.data=st,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new _e$1,this.onAfterRender=(gt,_t,Et,At,Rt,Ft)=>{super.onAfterRender(gt,_t,Et,At,Rt,Ft),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(nt,st,mt){super.updateByPatchedOp(nt,st,mt),nt.path.length===1&&nt.path[0]==="geometry"&&nt.type===0&&nt.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(nt,st=!0){var gt;if(this.booleanMeshSetAddress!==-1&&!nt)return;for(let _t=0;_t<this.children.length;_t++){let Et=this.children[_t];Et instanceof Fn&&Et.dataPatched.visible===!0&&Et.recomputeBoolean(nt===!0,st)}this.meshSetAddresses=[];for(let _t=0;_t<this.children.length;_t++){let Et=this.children[_t];if(Et instanceof mr&&Et.dataPatched.visible===!0&&((gt=Et.geometry.attributes.position)==null?void 0:gt.count)>0&&Et.geometry.drawRange.count>0&&Et.booleanMeshSetAddress!==0){nf.multiplyMatrices(Et.hiddenMatrix,Et.matrix);try{if(Et.booleanMeshSetAddress===-1){if((Et.geometry.index??Et.geometry.getAttribute("position")).count/3<15e5&&(Et.booleanMeshSetAddress=ms.getMeshSet(Et.geometry,nt===!0,st)),Et.booleanMeshSetAddress===-1)return;ms.transformMeshSet(Et.booleanMeshSetAddress,nf),Et.booleanMatrixInvOld.copy(nf).invert(),Et.booleanWasTransformed=!1}else Et instanceof Fn&&Et.needsTransformForDownstream===!0?(ms.transformMeshSet(Et.booleanMeshSetAddress,nf),Et.needsTransformForDownstream=!1):Et.booleanWasTransformed===!0&&(ms.transformMeshSet(Et.booleanMeshSetAddress,OX.multiplyMatrices(nf,Et.booleanMatrixInvOld)),Et.booleanMatrixInvOld.copy(nf).invert(),Et.booleanWasTransformed=!1)}catch(At){console.error(At),Et.booleanMeshSetAddress=0,Et.geometry.userData.booleanOperationDidFail=!0;continue}ms.hasOpenEdges(Et.booleanMeshSetAddress)===!1||_t===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(Et.booleanMeshSetAddress),Et.geometry.userData.booleanOperationDidFail=!1):Et.geometry.userData.booleanOperationDidFail="openEdges"}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new Me$1([],0)),this.geometry.setDrawRange(0,0);return}if(nt===!0)return ms.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let mt=this.geometry;mt.dispose(),this.geometry=new _e$1,this.geometry.userData=mt.userData,this.geometry.boundingSphere=mt.boundingSphere;try{this.booleanMeshSetAddress=ms.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(_t){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(_t)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,Jd(this),$d(this)}dispose(){super.dispose(),this.geometry.dispose()}},fx;(nt=>{function st(mt){return yt.is(mt)&&mt instanceof sl}nt.is=st})(fx||(fx={}));var sf=(nt,st)=>class extends bs(nt,st){updateState_Light(mt,gt){this.updateState_Entity(mt,gt),mt.color!==void 0&&(this.color=gt.shared.color(mt.color)),mt.intensity!==void 0&&(this.intensity=mt.intensity),mt.depth!==void 0&&(this.shadow.camera.far=mt.depth,this.shadow.needsUpdate=!0),mt.shadows!==void 0&&(this.castShadow=mt.shadows)}},cn=nt=>nt instanceof mr,En=nt=>nt!==null&&nt instanceof Fn,c3=nt=>nt instanceof wr,u3=nt=>fx.is(nt),Cm=nt=>hx.is(nt),RX=new E$6(1,1,1),h3=new E$6,LX=new E$6,d3=new Qe$1,Ss=class extends Fo$1(wy){constructor(nt,st=15){super(st),this.object=nt,this.dummy=new sn,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${nt.uuid}`,this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(nt,st){Vo(this.object,Ss.geometryHelper,nt,st,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(nt){this.object.matrixWorld.decompose(h3,d3,LX),this.matrix.compose(h3,d3,RX),super.updateMatrixWorld(nt)}updateWorldMatrix(nt,st){}},ws=class extends bs(sn,Ss){constructor(nt,st){super(),this.super_Entity(nt,st),this.objectHelper.update()}updateState(nt,st){this.updateState_Entity(nt,st),"buffer"in nt&&Object.keys(nt).length===1&&st.scene.reloadSplats()}},kl=class extends bs(sn,Ss){constructor(nt,st,mt){super(),this.super_Entity(nt,st),this.context=mt,this.objectHelper.update()}updateState(nt,st){this.updateState_Entity(nt,st)}},x3={RED:0,GREEN:1,BLUE:2,ALPHA:3},Pm="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",BX=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;uniform vec4 kernel64[32];varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;}}`,px=class extends it$1{constructor(nt=!1,st=!1){super({name:"BokehMaterial",defines:{PASS:nt?"2":"1"},uniforms:{kernel64:new le$1(null),kernel16:new le$1(null),inputBuffer:new le$1(null),cocBuffer:new le$1(null),texelSize:new le$1(new U$1),scale:new le$1(1)},blending:Jt,depthWrite:!1,depthTest:!1,fragmentShader:BX,vertexShader:Pm}),this.toneMapped=!1,st&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.uniforms.inputBuffer.value=nt}set cocBuffer(nt){this.uniforms.cocBuffer.value=nt}setCoCBuffer(nt){this.uniforms.cocBuffer.value=nt}get scale(){return this.uniforms.scale.value}set scale(nt){this.uniforms.scale.value=nt}getScale(nt){return this.uniforms.scale.value=nt}setScale(nt){this.uniforms.scale.value=nt}generateKernel(){let nt=2.39996323,st=new Float32Array(128),mt=new Float32Array(32),gt=0,_t=0;for(let Rt=0;Rt<80;++Rt){let Ft=Rt*nt,Nt=Math.sqrt(Rt)/Math.sqrt(80),Bt=Nt*Math.cos(Ft),Gt=Nt*Math.sin(Ft);Rt%5===0?(mt[_t++]=Bt,mt[_t++]=Gt):(st[gt++]=Bt,st[gt++]=Gt)}let Et=[],At=[];for(let Rt=0;Rt<128;)Et.push(new Ze$1(st[Rt++],st[Rt++],st[Rt++],st[Rt++]));for(let Rt=0;Rt<32;)At.push(new Ze$1(mt[Rt++],mt[Rt++],mt[Rt++],mt[Rt++]));this.uniforms.kernel64.value=Et,this.uniforms.kernel16.value=At}setTexelSize(nt,st){this.uniforms.texelSize.value.set(nt,st)}setSize(nt,st){this.uniforms.texelSize.value.set(1/nt,1/st)}};function f3(nt,st,mt){return nt*(st-mt)-st}function BE(nt,st,mt){return Math.min(Math.max((nt+st)/(st-mt),0),1)}var NX=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,FX=class extends it$1{constructor(nt){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new le$1(null),focusDistance:new le$1(0),focusRange:new le$1(0),cameraNear:new le$1(.3),cameraFar:new le$1(1e3)},blending:Jt,depthWrite:!1,depthTest:!1,fragmentShader:NX,vertexShader:Pm}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(nt)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(nt){this.uniforms.depthBuffer.value=nt}set depthPacking(nt){this.defines.DEPTH_PACKING=nt.toFixed(0),this.needsUpdate=!0}setDepthBuffer(nt,st=Bi){this.depthBuffer=nt,this.depthPacking=st}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(nt){this.uniforms.focusDistance.value=nt}get worldFocusDistance(){return-f3(this.focusDistance,this.near,this.far)}set worldFocusDistance(nt){this.focusDistance=BE(-nt,this.near,this.far)}getFocusDistance(nt){this.uniforms.focusDistance.value=nt}setFocusDistance(nt){this.uniforms.focusDistance.value=nt}get focalLength(){return this.focusRange}set focalLength(nt){this.focusRange=nt}get focusRange(){return this.uniforms.focusRange.value}set focusRange(nt){this.uniforms.focusRange.value=nt}get worldFocusRange(){return-f3(this.focusRange,this.near,this.far)}set worldFocusRange(nt){this.focusRange=BE(-nt,this.near,this.far)}getFocalLength(nt){return this.focusRange}setFocalLength(nt){this.focusRange=nt}adoptCameraSettings(nt){nt&&(this.uniforms.cameraNear.value=nt.near,this.uniforms.cameraFar.value=nt.far,nt instanceof $r?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},VX=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,UX="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",p3=class extends it$1{constructor(nt=new U$1){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new le$1(null),texelSize:new le$1(new U$1),halfTexelSize:new le$1(new U$1),kernel:new le$1(0),scale:new le$1(1)},blending:Jt,depthWrite:!1,depthTest:!1,fragmentShader:VX,vertexShader:UX}),this.toneMapped=!1,this.setTexelSize(nt.x,nt.y)}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.inputBuffer=nt}get scale(){return this.uniforms.scale.value}set scale(nt){this.uniforms.scale.value=nt}getScale(){return this.uniforms.scale.value}setScale(nt){this.uniforms.scale.value=nt}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(nt){this.uniforms.kernel.value=nt}setKernel(nt){this.kernel=nt}setTexelSize(nt,st){this.uniforms.texelSize.value.set(nt,st),this.uniforms.halfTexelSize.value.set(nt,st).multiplyScalar(.5)}setSize(nt,st){let mt=this.uniforms;mt.texelSize.value.set(1/nt,1/st),mt.halfTexelSize.value.copy(mt.texelSize.value).multiplyScalar(.5)}},zX=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,kX=class extends it$1{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new le$1(null),opacity:new le$1(1)},blending:Jt,depthWrite:!1,depthTest:!1,fragmentShader:zX,vertexShader:Pm}),this.toneMapped=!1}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.uniforms.inputBuffer.value=nt}getOpacity(nt){return this.uniforms.opacity.value}setOpacity(nt){this.uniforms.opacity.value=nt}},GX=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,jX=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,of={DEPTH:0,LUMA:1,COLOR:2},HX={DISABLED:0,DEPTH:1,CUSTOM:2},WX=class extends it$1{constructor(nt=new U$1,st=of.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:la.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new le$1(null),depthBuffer:new le$1(null),predicationBuffer:new le$1(null),texelSize:new le$1(nt)},blending:Jt,depthWrite:!1,depthTest:!1,fragmentShader:GX,vertexShader:jX}),this.toneMapped=!1,this.edgeDetectionMode=st}set depthBuffer(nt){this.uniforms.depthBuffer.value=nt}set depthPacking(nt){this.defines.DEPTH_PACKING=nt.toFixed(0),this.needsUpdate=!0}setDepthBuffer(nt,st=Bi){this.depthBuffer=nt,this.depthPacking=st}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(nt){this.defines.EDGE_DETECTION_MODE=nt.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(nt){this.edgeDetectionMode=nt}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(nt){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=nt.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(nt){this.localContrastAdaptationFactor=nt}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(nt){this.defines.EDGE_THRESHOLD=nt.toFixed("6"),this.defines.DEPTH_THRESHOLD=(nt*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(nt){this.edgeDetectionThreshold=nt}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(nt){this.defines.PREDICATION_MODE=nt.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(nt){this.predicationMode=nt}set predicationBuffer(nt){this.uniforms.predicationBuffer.value=nt}setPredicationBuffer(nt){this.uniforms.predicationBuffer.value=nt}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(nt){this.defines.PREDICATION_THRESHOLD=nt.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(nt){this.predicationThreshold=nt}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(nt){this.defines.PREDICATION_SCALE=nt.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(nt){this.predicationScale=nt}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(nt){this.defines.PREDICATION_STRENGTH=nt.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(nt){this.predicationStrength=nt}setSize(nt,st){this.uniforms.texelSize.value.set(1/nt,1/st)}},qX=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,YX="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",Js={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},NE=class extends it$1{constructor(nt,st,mt,gt,_t=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:la.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new le$1(null),depthBuffer:new le$1(null),resolution:new le$1(new U$1),texelSize:new le$1(new U$1),cameraNear:new le$1(.3),cameraFar:new le$1(1e3),aspect:new le$1(1),time:new le$1(0)},blending:Jt,depthWrite:!1,depthTest:!1,dithering:_t}),this.toneMapped=!1,nt&&this.setShaderParts(nt),st&&this.setDefines(st),mt&&this.setUniforms(mt),this.adoptCameraSettings(gt)}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.uniforms.inputBuffer.value=nt}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(nt){this.uniforms.depthBuffer.value=nt}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(nt){this.defines.DEPTH_PACKING=nt.toFixed(0),this.needsUpdate=!0}setDepthBuffer(nt,st=Bi){this.depthBuffer=nt,this.depthPacking=st}setShaderParts(nt){return this.fragmentShader=qX.replace(Js.FRAGMENT_HEAD,nt.get(Js.FRAGMENT_HEAD)).replace(Js.FRAGMENT_MAIN_UV,nt.get(Js.FRAGMENT_MAIN_UV)).replace(Js.FRAGMENT_MAIN_IMAGE,nt.get(Js.FRAGMENT_MAIN_IMAGE)),this.vertexShader=YX.replace(Js.VERTEX_HEAD,nt.get(Js.VERTEX_HEAD)).replace(Js.VERTEX_MAIN_SUPPORT,nt.get(Js.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(nt){for(let st of nt.entries())this.defines[st[0]]=st[1];return this.needsUpdate=!0,this}setUniforms(nt){for(let st of nt.entries())this.uniforms[st[0]]=st[1];return this}setExtensions(nt){this.extensions={};for(let st of nt)this.extensions[st]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(nt){this.encodeOutput!==nt&&(nt?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(nt){return this.encodeOutput}setOutputEncodingEnabled(nt){this.encodeOutput=nt}get time(){return this.uniforms.time.value}set time(nt){this.uniforms.time.value=nt}setDeltaTime(nt){this.uniforms.time.value+=nt}adoptCameraSettings(nt){nt&&(this.uniforms.cameraNear.value=nt.near,this.uniforms.cameraFar.value=nt.far,nt instanceof $r?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(nt,st){let mt=this.uniforms;mt.resolution.value.set(nt,st),mt.texelSize.value.set(1/nt,1/st),mt.aspect.value=nt/st}static get Section(){return Js}},XX=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,QX=class extends it$1{constructor(nt=!1,st=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:la.replace(/\D+/g,"")},uniforms:{inputBuffer:new le$1(null),threshold:new le$1(0),smoothing:new le$1(1),range:new le$1(null)},blending:Jt,depthWrite:!1,depthTest:!1,fragmentShader:XX,vertexShader:Pm}),this.toneMapped=!1,this.colorOutput=nt,this.luminanceRange=st}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.uniforms.inputBuffer.value=nt}get threshold(){return this.uniforms.threshold.value}set threshold(nt){this.smoothing>0||nt>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=nt}getThreshold(){return this.threshold}setThreshold(nt){this.threshold=nt}get smoothing(){return this.uniforms.smoothing.value}set smoothing(nt){this.threshold>0||nt>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=nt}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(nt){this.smoothing=nt}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(nt){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(nt){nt?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(nt){return this.colorOutput}setColorOutputEnabled(nt){this.colorOutput=nt}get useRange(){return this.luminanceRange!==null}set useRange(nt){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(nt){nt!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=nt,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(nt){this.luminanceRange=nt}},KX=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,b3={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},ZX=class extends it$1{constructor(nt=null){super({name:"MaskMaterial",uniforms:{maskTexture:new le$1(nt),inputBuffer:new le$1(null),strength:new le$1(1)},blending:Jt,depthWrite:!1,depthTest:!1,fragmentShader:KX,vertexShader:Pm}),this.toneMapped=!1,this.setColorChannel(x3.RED),this.setMaskFunction(b3.DISCARD)}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.uniforms.inputBuffer.value=nt}set maskTexture(nt){this.uniforms.maskTexture.value=nt,delete this.defines.MASK_PRECISION_HIGH,nt.type!==_r&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(nt){this.maskTexture=nt}set colorChannel(nt){this.defines.COLOR_CHANNEL=nt.toFixed(0),this.needsUpdate=!0}setColorChannel(nt){this.colorChannel=nt}set maskFunction(nt){this.defines.MASK_FUNCTION=nt.toFixed(0),this.needsUpdate=!0}setMaskFunction(nt){this.maskFunction=nt}get inverted(){return this.defines.INVERTED!==void 0}set inverted(nt){this.inverted&&!nt?delete this.defines.INVERTED:nt&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(nt){this.inverted=nt}get strength(){return this.uniforms.strength.value}set strength(nt){this.uniforms.strength.value=nt}getStrength(){return this.strength}setStrength(nt){this.strength=nt}},JX=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,$X="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",eQ=class extends it$1{constructor(nt=new U$1,st=new U$1){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new le$1(null),searchTexture:new le$1(null),areaTexture:new le$1(null),resolution:new le$1(st),texelSize:new le$1(nt)},blending:Jt,depthWrite:!1,depthTest:!1,fragmentShader:JX,vertexShader:$X}),this.toneMapped=!1}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}setInputBuffer(nt){this.uniforms.inputBuffer.value=nt}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(nt){this.uniforms.searchTexture.value=nt}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(nt){this.uniforms.areaTexture.value=nt}setLookupTextures(nt,st){this.searchTexture=nt,this.areaTexture=st}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(nt){let st=Math.min(Math.max(nt,0),112);this.defines.MAX_SEARCH_STEPS_INT=st.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=st.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(nt){this.orthogonalSearchSteps=nt}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(nt){let st=Math.min(Math.max(nt,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=st.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=st.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(nt){this.diagonalSearchSteps=nt}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(nt){nt?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(nt){this.diagonalDetection=nt}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(nt){let st=Math.min(Math.max(nt,0),100);this.defines.CORNER_ROUNDING=st.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(st/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(nt){this.cornerRounding=nt}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(nt){nt?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(nt){this.cornerDetection=nt}setSize(nt,st){let mt=this.uniforms;mt.texelSize.value.set(1/nt,1/st),mt.resolution.value.set(nt,st)}},tQ=new qn,Gl=null;function rQ(){if(Gl===null){let nt=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),st=new Float32Array([0,0,2,0,0,2]);Gl=new _e$1,Gl.setAttribute!==void 0?(Gl.setAttribute("position",new Xe$1(nt,3)),Gl.setAttribute("uv",new Xe$1(st,2))):(Gl.addAttribute("position",new Xe$1(nt,3)),Gl.addAttribute("uv",new Xe$1(st,2)))}return Gl}var xi=class{constructor(nt="Pass",st=new ei,mt=tQ){this.name=nt,this.renderer=null,this.scene=st,this.camera=mt,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(nt){if(this.rtt===nt){let st=this.getFullscreenMaterial();st!==null&&(st.needsUpdate=!0),this.rtt=!nt}}setRenderer(nt){this.renderer=nt}isEnabled(){return this.enabled}setEnabled(nt){this.enabled=nt}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(nt){let st=this.screen;st!==null?st.material=nt:(st=new Ut(rQ(),nt),st.frustumCulled=!1,this.scene===null&&(this.scene=new ei),this.scene.add(st),this.screen=st)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(nt){this.fullscreenMaterial=nt}getDepthTexture(){return null}setDepthTexture(nt,st=Bi){}render(nt,st,mt,gt,_t){throw new Error("Render method not implemented!")}setSize(nt,st){}initialize(nt,st,mt){}dispose(){for(let nt of Object.keys(this)){let st=this[nt];if(st!==null&&typeof st=="object"&&typeof st.dispose=="function"){if(st instanceof ei||st===this.renderer)continue;this[nt].dispose()}}}},_m=class extends xi{constructor(nt,st=!0){super("CopyPass"),this.fullscreenMaterial=new kX,this.needsSwap=!1,this.renderTarget=nt,nt===void 0&&(this.renderTarget=new dt$1(1,1,{minFilter:rt$1,magFilter:rt$1,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=st}get resize(){return this.autoResize}set resize(nt){this.autoResize=nt}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(nt){this.autoResize=nt}render(nt,st,mt,gt,_t){this.fullscreenMaterial.inputBuffer=st.texture,nt.setRenderTarget(this.renderToScreen?null:this.renderTarget),nt.render(this.scene,this.camera)}setSize(nt,st){this.autoResize&&this.renderTarget.setSize(nt,st)}initialize(nt,st,mt){mt!==void 0&&(this.renderTarget.texture.type=mt,mt!==_r?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":nt.outputEncoding===at$1&&(this.renderTarget.texture.encoding=at$1))}},S3=class extends xi{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(nt,st,mt,gt,_t){let Et=nt.state.buffers.stencil;Et.setLocked(!1),Et.setTest(!1)}},IE=new We$1,FE=class extends xi{constructor(nt=!0,st=!0,mt=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=nt,this.depth=st,this.stencil=mt,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(nt,st,mt){this.color=nt,this.depth=st,this.stencil=mt}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(nt){this.overrideClearColor=nt}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(nt){this.overrideClearAlpha=nt}render(nt,st,mt,gt,_t){let Et=this.overrideClearColor,At=this.overrideClearAlpha,Rt=nt.getClearAlpha(),Ft=Et!==null,Nt=At>=0;Ft?(IE.copy(nt.getClearColor(IE)),nt.setClearColor(Et,Nt?At:Rt)):Nt&&nt.setClearAlpha(At),nt.setRenderTarget(this.renderToScreen?null:st),nt.clear(this.color,this.depth,this.stencil),Ft?nt.setClearColor(IE,Rt):Nt&&nt.setClearAlpha(Rt)}},jl=-1,Vn=class extends pr{constructor(nt,st=jl,mt=jl,gt=1){super(),this.resizable=nt,this.base=new U$1(1,1),this.preferred=new U$1(st,mt),this.target=this.preferred,this.s=gt}get width(){let{base:nt,preferred:st,scale:mt}=this,gt;return st.width!==jl?gt=st.width:st.height!==jl?gt=Math.round(st.height*(nt.width/Math.max(nt.height,1))):gt=Math.round(nt.width*mt),gt}set width(nt){this.preferredWidth=nt}get height(){let{base:nt,preferred:st,scale:mt}=this,gt;return st.height!==jl?gt=st.height:st.width!==jl?gt=Math.round(st.width/Math.max(nt.width/Math.max(nt.height,1),1)):gt=Math.round(nt.height*mt),gt}set height(nt){this.preferredHeight=nt}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(nt){this.s!==nt&&(this.s=nt,this.preferred.setScalar(jl),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(nt){this.scale=nt}get baseWidth(){return this.base.width}set baseWidth(nt){this.base.width!==nt&&(this.base.width=nt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(nt){this.base.width!==nt&&(this.base.width=nt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(nt){this.base.height!==nt&&(this.base.height=nt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(nt){this.baseHeight=nt}setBaseSize(nt,st){(this.base.width!==nt||this.base.height!==st)&&(this.base.set(nt,st),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(nt){this.preferred.width!==nt&&(this.preferred.width=nt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(nt){this.preferredWidth=nt}get preferredHeight(){return this.preferred.height}set preferredHeight(nt){this.preferred.height!==nt&&(this.preferred.height=nt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(nt){this.preferredHeight=nt}setPreferredSize(nt,st){(this.preferred.width!==nt||this.preferred.height!==st)&&(this.preferred.set(nt,st),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(nt){this.base.set(nt.getBaseWidth(),nt.getBaseHeight()),this.preferred.set(nt.getPreferredWidth(),nt.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return jl}},OE=!1,m3=class{constructor(nt=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(nt),this.meshCount=0,this.replaceMaterial=st=>{if(st.isMesh){let mt;if(st.material.flatShading)switch(st.material.side){case fi:mt=this.materialsFlatShadedDoubleSide;break;case pi:mt=this.materialsFlatShadedBackSide;break;default:mt=this.materialsFlatShaded;break}else switch(st.material.side){case fi:mt=this.materialsDoubleSide;break;case pi:mt=this.materialsBackSide;break;default:mt=this.materials;break}this.originalMaterials.set(st,st.material),st.isSkinnedMesh?st.material=mt[2]:st.isInstancedMesh?st.material=mt[1]:st.material=mt[0],++this.meshCount}}}setMaterial(nt){if(this.disposeMaterials(),this.material=nt,nt!==null){let st=this.materials=[nt.clone(),nt.clone(),nt.clone()];for(let mt of st)mt.uniforms=Object.assign({},nt.uniforms),mt.side=Hn;st[2].skinning=!0,this.materialsBackSide=st.map(mt=>{let gt=mt.clone();return gt.uniforms=Object.assign({},nt.uniforms),gt.side=pi,gt}),this.materialsDoubleSide=st.map(mt=>{let gt=mt.clone();return gt.uniforms=Object.assign({},nt.uniforms),gt.side=fi,gt}),this.materialsFlatShaded=st.map(mt=>{let gt=mt.clone();return gt.uniforms=Object.assign({},nt.uniforms),gt.flatShading=!0,gt}),this.materialsFlatShadedBackSide=st.map(mt=>{let gt=mt.clone();return gt.uniforms=Object.assign({},nt.uniforms),gt.flatShading=!0,gt.side=pi,gt}),this.materialsFlatShadedDoubleSide=st.map(mt=>{let gt=mt.clone();return gt.uniforms=Object.assign({},nt.uniforms),gt.flatShading=!0,gt.side=fi,gt})}}render(nt,st,mt){let gt=nt.shadowMap.enabled;if(nt.shadowMap.enabled=!1,OE){let _t=this.originalMaterials;this.meshCount=0,st.traverse(this.replaceMaterial),nt.render(st,mt);for(let Et of _t)Et[0].material=Et[1];this.meshCount!==_t.size&&_t.clear()}else{let _t=st.overrideMaterial;st.overrideMaterial=this.material,nt.render(st,mt),st.overrideMaterial=_t}nt.shadowMap.enabled=gt}disposeMaterials(){if(this.material!==null){let nt=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let st of nt)st.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return OE}static set workaroundEnabled(nt){OE=nt}},iQ=class extends xi{constructor(nt,st,mt=null){super("RenderPass",nt,st),this.needsSwap=!1,this.clearPass=new FE,this.overrideMaterialManager=mt===null?null:new m3(mt),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(nt){super.renderToScreen=nt,this.clearPass.renderToScreen=nt}get overrideMaterial(){let nt=this.overrideMaterialManager;return nt!==null?nt.material:null}set overrideMaterial(nt){let st=this.overrideMaterialManager;nt!==null?st!==null?st.setMaterial(nt):this.overrideMaterialManager=new m3(nt):st!==null&&(st.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(nt){this.overrideMaterial=nt}get clear(){return this.clearPass.enabled}set clear(nt){this.clearPass.enabled=nt}getSelection(){return this.selection}setSelection(nt){this.selection=nt}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(nt){this.ignoreBackground=nt}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(nt){this.skipShadowMapUpdate=nt}getClearPass(){return this.clearPass}render(nt,st,mt,gt,_t){let Et=this.scene,At=this.camera,Rt=this.selection,Ft=At.layers.mask,Nt=Et.background,Bt=nt.shadowMap.autoUpdate,Gt=this.renderToScreen?null:st;Rt!==null&&At.layers.set(Rt.getLayer()),this.skipShadowMapUpdate&&(nt.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(Et.background=null),this.clearPass.enabled&&this.clearPass.render(nt,st),nt.setRenderTarget(Gt),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(nt,Et,At):nt.render(Et,At),At.layers.mask=Ft,Et.background=Nt,nt.shadowMap.autoUpdate=Bt}},VE=class extends xi{constructor(nt,st,{resolutionScale:mt=1,width:gt=Vn.AUTO_SIZE,height:_t=Vn.AUTO_SIZE,renderTarget:Et}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new iQ(nt,st,new up({depthPacking:Tw}));let At=this.renderPass;At.skipShadowMapUpdate=!0,At.ignoreBackground=!0;let Rt=At.getClearPass();Rt.overrideClearColor=new We$1(16777215),Rt.overrideClearAlpha=1,this.renderTarget=Et,this.renderTarget===void 0&&(this.renderTarget=new dt$1(1,1,{minFilter:Vt,magFilter:Vt,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let Ft=this.resolution=new Vn(this,gt,_t,mt);Ft.addEventListener("change",Nt=>this.setSize(Ft.baseWidth,Ft.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(nt){this.resolution.scale=nt}render(nt,st,mt,gt,_t){let Et=this.renderToScreen?null:this.renderTarget;this.renderPass.render(nt,Et)}setSize(nt,st){let mt=this.resolution;mt.setBaseSize(nt,st),this.renderTarget.setSize(mt.width,mt.height)}},Pt={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},nQ="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",sQ="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",oQ="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",aQ="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",lQ="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",cQ="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",uQ="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",hQ="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",dQ="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",fQ="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",pQ="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",mQ="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",gQ="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",yQ="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",vQ="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",xQ="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",bQ="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",SQ="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",wQ=new Map([[Pt.SKIP,null],[Pt.ADD,nQ],[Pt.ALPHA,sQ],[Pt.AVERAGE,oQ],[Pt.COLOR_BURN,aQ],[Pt.COLOR_DODGE,lQ],[Pt.DARKEN,cQ],[Pt.DIFFERENCE,uQ],[Pt.EXCLUSION,hQ],[Pt.LIGHTEN,dQ],[Pt.MULTIPLY,fQ],[Pt.DIVIDE,pQ],[Pt.NEGATION,mQ],[Pt.NORMAL,gQ],[Pt.OVERLAY,yQ],[Pt.REFLECT,vQ],[Pt.SCREEN,xQ],[Pt.SOFT_LIGHT,bQ],[Pt.SUBTRACT,SQ]]),AQ=class extends pr{constructor(nt,st=1){super(),this.f=nt,this.opacity=new le$1(st)}getOpacity(){return this.opacity.value}setOpacity(nt){this.opacity.value=nt}get blendFunction(){return this.f}set blendFunction(nt){this.f=nt,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(nt){this.blendFunction=nt}getShaderCode(){return wQ.get(this.blendFunction)}},Uo={NONE:0,DEPTH:1,CONVOLUTION:2},zo=class extends pr{constructor(nt,st,{attributes:mt=Uo.NONE,blendFunction:gt=Pt.SCREEN,defines:_t=new Map,uniforms:Et=new Map,extensions:At=null,vertexShader:Rt=null}={}){super(),this.name=nt,this.renderer=null,this.attributes=mt,this.fragmentShader=st,this.vertexShader=Rt,this.defines=_t,this.uniforms=Et,this.extensions=At,this.blendMode=new AQ(gt),this.blendMode.addEventListener("change",Ft=>this.setChanged())}getName(){return this.name}setRenderer(nt){this.renderer=nt}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(nt){this.attributes=nt,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(nt){this.fragmentShader=nt,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(nt){this.vertexShader=nt,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(nt,st=Bi){}update(nt,st,mt){}setSize(nt,st){}initialize(nt,st,mt){}dispose(){for(let nt of Object.keys(this)){let st=this[nt];if(st!==null&&typeof st=="object"&&typeof st.dispose=="function"){if(st instanceof ei||st===this.renderer)continue;this[nt].dispose()}}}};function g3(nt,st,mt){for(let gt of st){let _t="$1"+nt+gt.charAt(0).toUpperCase()+gt.slice(1),Et=new RegExp("([^\\.])(\\b"+gt+"\\b)","g");for(let At of mt.entries())At[1]!==null&&mt.set(At[0],At[1].replace(Et,_t))}}function EQ(nt,st,mt,gt,_t,Et,At){let Rt=new Map([["fragment",st.getFragmentShader()],["vertex",st.getVertexShader()]]),Ft=Rt.get("fragment")!==void 0&&/mainImage/.test(Rt.get("fragment")),Nt=Rt.get("fragment")!==void 0&&/mainUv/.test(Rt.get("fragment")),Bt=[],Gt=[],dr=!1,Mr=!1;if(Rt.get("fragment")===void 0)console.error("Missing fragment shader",st);else if(Nt&&At&Uo.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",st);else if(!Ft&&!Nt)console.error("The fragment shader contains neither a mainImage nor a mainUv function",st);else{let Tr=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,zr=NE.Section;if(Nt){let Nr=`	${nt}MainUv(UV);
`;mt.set(zr.FRAGMENT_MAIN_UV,mt.get(zr.FRAGMENT_MAIN_UV)+Nr),dr=!0}if(Rt.get("vertex")!==null&&/mainSupport/.test(Rt.get("vertex"))){let Nr=`	${nt}MainSupport(`;Nr+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(Rt.get("vertex"))?`vUv);
`:`);
`,mt.set(zr.VERTEX_MAIN_SUPPORT,mt.get(zr.VERTEX_MAIN_SUPPORT)+Nr),Bt=Bt.concat([...Rt.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(tn=>tn[1])),Gt=Gt.concat(Bt).concat([...Rt.get("vertex").matchAll(Tr)].map(tn=>tn[1]))}Gt=Gt.concat([...Rt.get("fragment").matchAll(Tr)].map(Nr=>Nr[1])),Gt=Gt.concat([...st.defines.keys()].map(Nr=>Nr.replace(/\([\w\s,]*\)/g,""))),Gt=Gt.concat([...st.uniforms.keys()]),st.uniforms.forEach((Nr,tn)=>Et.set(nt+tn.charAt(0).toUpperCase()+tn.slice(1),Nr)),st.defines.forEach((Nr,tn)=>_t.set(nt+tn.charAt(0).toUpperCase()+tn.slice(1),Nr)),g3(nt,Gt,_t),g3(nt,Gt,Rt);let Fr=st.blendMode;if(gt.set(Fr.blendFunction,Fr),Ft){let Nr=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,tn=`${nt}MainImage(color0, UV, `;At&Uo.DEPTH&&Nr.test(Rt.get("fragment"))&&(tn+="depth, ",Mr=!0),tn+=`color1);
	`;let rn=nt+"BlendOpacity";Et.set(rn,Fr.opacity),tn+=`color0 = blend${Fr.blendFunction}(color0, color1, ${rn});

	`,mt.set(zr.FRAGMENT_MAIN_IMAGE,mt.get(zr.FRAGMENT_MAIN_IMAGE)+tn),tn=`uniform float ${rn};

`,mt.set(zr.FRAGMENT_HEAD,mt.get(zr.FRAGMENT_HEAD)+tn)}mt.set(zr.FRAGMENT_HEAD,mt.get(zr.FRAGMENT_HEAD)+Rt.get("fragment")+`
`),Rt.get("vertex")!==null&&mt.set(zr.VERTEX_HEAD,mt.get(zr.VERTEX_HEAD)+Rt.get("vertex")+`
`)}return{varyings:Bt,transformedUv:dr,readDepth:Mr}}var Kc=class extends xi{constructor(nt,...st){super("EffectPass"),this.fullscreenMaterial=new NE(null,null,null,nt),this.effects=st.sort((mt,gt)=>gt.attributes-mt.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(nt){this.fullscreenMaterial.encodeOutput=nt}get dithering(){return this.fullscreenMaterial.dithering}set dithering(nt){let st=this.fullscreenMaterial;st.dithering=nt,st.needsUpdate=!0}verifyResources(){let nt=this.renderer.capabilities,st=Math.min(nt.maxFragmentUniforms,nt.maxVertexUniforms);this.uniformCount>st&&console.warn("The current rendering context doesn't support more than "+st+" uniforms, but "+this.uniformCount+" were defined"),st=nt.maxVaryings,this.varyingCount>st&&console.warn("The current rendering context doesn't support more than "+st+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let nt=NE.Section,st=new Map([[nt.FRAGMENT_HEAD,""],[nt.FRAGMENT_MAIN_UV,""],[nt.FRAGMENT_MAIN_IMAGE,""],[nt.VERTEX_HEAD,""],[nt.VERTEX_MAIN_SUPPORT,""]]),mt=new Map,gt=new Map,_t=new Map,Et=new Set,At=0,Rt=0,Ft=0,Nt=!1,Bt=!1;for(let dr of this.effects)if(dr.blendMode.blendFunction===Pt.SKIP)Ft|=dr.getAttributes()&Uo.DEPTH;else if(Ft&dr.getAttributes()&Uo.CONVOLUTION)console.error("Convolution effects cannot be merged",dr);else{Ft|=dr.getAttributes();let Mr="e"+At++,Tr=EQ(Mr,dr,st,mt,gt,_t,Ft);if(Rt+=Tr.varyings.length,Nt=Nt||Tr.transformedUv,Bt=Bt||Tr.readDepth,dr.extensions!==null)for(let zr of dr.extensions)Et.add(zr)}let Gt=/\bblend\b/g;for(let dr of mt.values()){let Mr=dr.getShaderCode().replace(Gt,`blend${dr.blendFunction}`);st.set(nt.FRAGMENT_HEAD,st.get(nt.FRAGMENT_HEAD)+Mr+`
`)}Ft&Uo.DEPTH?(Bt&&st.set(nt.FRAGMENT_MAIN_IMAGE,`float depth = readDepth(UV);

	`+st.get(nt.FRAGMENT_MAIN_IMAGE)),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,Nt?(st.set(nt.FRAGMENT_MAIN_UV,`vec2 transformedUv = vUv;
`+st.get(nt.FRAGMENT_MAIN_UV)),gt.set("UV","transformedUv")):gt.set("UV","vUv"),st.forEach((dr,Mr,Tr)=>Tr.set(Mr,dr.trim().replace(/^#/,`
#`))),this.uniformCount=_t.size,this.varyingCount=Rt,this.skipRendering=At===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(st).setExtensions(Et).setUniforms(_t).setDefines(gt)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(nt,st=Bi){this.fullscreenMaterial.depthBuffer=nt,this.fullscreenMaterial.depthPacking=st;for(let mt of this.effects)mt.setDepthTexture(nt,st)}render(nt,st,mt,gt,_t){for(let Et of this.effects)Et.update(nt,st,gt);if(!this.skipRendering||this.renderToScreen){let Et=this.fullscreenMaterial;Et.inputBuffer=st.texture,Et.time+=gt,nt.setRenderTarget(this.renderToScreen?null:mt),nt.render(this.scene,this.camera)}}setSize(nt,st){this.fullscreenMaterial.setSize(nt,st);for(let mt of this.effects)mt.setSize(nt,st)}initialize(nt,st,mt){this.renderer=nt;for(let gt of this.effects)gt.initialize(nt,st,mt),gt.addEventListener("change",_t=>this.handleEvent(_t));this.updateMaterial(),this.verifyResources(),mt!==void 0&&mt!==_r&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let nt of this.effects)nt.dispose()}handleEvent(nt){switch(nt.type){case"change":this.recompile();break}}},MQ=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],gx=class extends xi{constructor({resolutionScale:nt=.5,width:st=Vn.AUTO_SIZE,height:mt=Vn.AUTO_SIZE,kernelSize:gt=Dm.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new dt$1(1,1,{minFilter:rt$1,magFilter:rt$1,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let _t=this.resolution=new Vn(this,st,mt,nt);_t.addEventListener("change",Et=>this.setSize(_t.baseWidth,_t.baseHeight)),this.blurMaterial=new p3,this.ditheredBlurMaterial=new p3,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=gt}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(nt){this.resolution.preferredWidth=nt}get height(){return this.resolution.height}set height(nt){this.resolution.preferredHeight=nt}get scale(){return this.blurMaterial.scale}set scale(nt){this.blurMaterial.scale=nt}getScale(){return this.blurMaterial.scale}setScale(nt){this.blurMaterial.scale=nt}getKernelSize(){return this.kernelSize}setKernelSize(nt){this.kernelSize=nt}getResolutionScale(){return this.resolution.scale}setResolutionScale(nt){this.resolution.scale=nt}render(nt,st,mt,gt,_t){let Et=this.scene,At=this.camera,Rt=this.renderTargetA,Ft=this.renderTargetB,Nt=MQ[this.kernelSize],Bt=this.blurMaterial,Gt=st,dr,Mr;for(this.fullscreenMaterial=Bt,dr=0,Mr=Nt.length-1;dr<Mr;++dr){let Tr=dr&1?Ft:Rt;Bt.kernel=Nt[dr],Bt.inputBuffer=Gt.texture,nt.setRenderTarget(Tr),nt.render(Et,At),Gt=Tr}this.dithering&&(Bt=this.ditheredBlurMaterial,this.fullscreenMaterial=Bt),Bt.kernel=Nt[dr],Bt.inputBuffer=Gt.texture,nt.setRenderTarget(this.renderToScreen?null:mt),nt.render(Et,At)}setSize(nt,st){let mt=this.resolution;mt.setBaseSize(nt,st);let gt=mt.width,_t=mt.height;this.renderTargetA.setSize(gt,_t),this.renderTargetB.setSize(gt,_t),this.blurMaterial.setSize(gt,_t),this.ditheredBlurMaterial.setSize(gt,_t)}initialize(nt,st,mt){mt!==void 0&&(this.renderTargetA.texture.type=mt,this.renderTargetB.texture.type=mt,mt!==_r?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):nt.outputEncoding===at$1&&(this.renderTargetA.texture.encoding=at$1,this.renderTargetB.texture.encoding=at$1))}static get AUTO_SIZE(){return Vn.AUTO_SIZE}},TQ=class extends xi{constructor({width:nt=Vn.AUTO_SIZE,height:st=Vn.AUTO_SIZE,renderTarget:mt,luminanceRange:gt,colorOutput:_t}={}){super("LuminancePass"),this.fullscreenMaterial=new QX(_t,gt),this.needsSwap=!1,this.renderTarget=mt,this.renderTarget===void 0&&(this.renderTarget=new dt$1(1,1,{minFilter:rt$1,magFilter:rt$1,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let Et=this.resolution=new Vn(this,nt,st);Et.addEventListener("change",At=>this.setSize(Et.baseWidth,Et.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(nt,st,mt,gt,_t){let Et=this.fullscreenMaterial;Et.inputBuffer=st.texture,nt.setRenderTarget(this.renderToScreen?null:this.renderTarget),nt.render(this.scene,this.camera)}setSize(nt,st){let mt=this.resolution;mt.setBaseSize(nt,st),this.renderTarget.setSize(mt.width,mt.height)}initialize(nt,st,mt){mt!==void 0&&mt!==_r&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},w3=class extends xi{constructor(nt,st){super("MaskPass",nt,st),this.needsSwap=!1,this.clearPass=new FE(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(nt){this.inverse=nt}get clear(){return this.clearPass.enabled}set clear(nt){this.clearPass.enabled=nt}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(nt){this.inverted=nt}render(nt,st,mt,gt,_t){let Et=nt.getContext(),At=nt.state.buffers,Rt=this.scene,Ft=this.camera,Nt=this.clearPass,Bt=this.inverted?0:1,Gt=1-Bt;At.color.setMask(!1),At.depth.setMask(!1),At.color.setLocked(!0),At.depth.setLocked(!0),At.stencil.setTest(!0),At.stencil.setOp(Et.REPLACE,Et.REPLACE,Et.REPLACE),At.stencil.setFunc(Et.ALWAYS,Bt,4294967295),At.stencil.setClear(Gt),At.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?Nt.render(nt,null):(Nt.render(nt,st),Nt.render(nt,mt))),this.renderToScreen?(nt.setRenderTarget(null),nt.render(Rt,Ft)):(nt.setRenderTarget(st),nt.render(Rt,Ft),nt.setRenderTarget(mt),nt.render(Rt,Ft)),At.color.setLocked(!1),At.depth.setLocked(!1),At.stencil.setLocked(!1),At.stencil.setFunc(Et.EQUAL,1,4294967295),At.stencil.setOp(Et.KEEP,Et.KEEP,Et.KEEP),At.stencil.setLocked(!0)}},hn=class extends xi{constructor(nt,st="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=nt,this.inputBufferUniform=null,this.setInput(st)}setInput(nt){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let st=this.fullscreenMaterial.uniforms;st!==void 0&&st[nt]!==void 0&&(this.inputBufferUniform=st[nt])}}render(nt,st,mt,gt,_t){this.inputBufferUniform!==null&&st!==null&&(this.inputBufferUniform.value=st.texture),nt.setRenderTarget(this.renderToScreen?null:mt),nt.render(this.scene,this.camera)}initialize(nt,st,mt){mt!==void 0&&mt!==_r&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},RE=1/1e3,CQ=1e3,A3=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(nt){return this.fixedDeltaEnabled=nt,this}isAutoResetEnabled(nt){return this.autoReset}setAutoResetEnabled(nt){return typeof document<"u"&&document.hidden!==void 0&&(nt?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=nt),this}getDelta(){return this.delta*RE}getFixedDelta(){return this.fixedDelta*RE}setFixedDelta(nt){return this.fixedDelta=nt*CQ,this}getElapsed(){return this.elapsed*RE}getTimescale(){return this.timescale}setTimescale(nt){return this.timescale=nt,this}update(nt){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=nt!==void 0?nt:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(nt){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},Dm={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},PQ=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,E3=class extends zo{constructor({blendFunction:nt=Pt.SCREEN,luminanceThreshold:st=.9,luminanceSmoothing:mt=.025,resolutionScale:gt=.5,intensity:_t=1,width:Et=Vn.AUTO_SIZE,height:At=Vn.AUTO_SIZE,kernelSize:Rt=Dm.LARGE}={}){super("BloomEffect",PQ,{blendFunction:nt,uniforms:new Map([["map",new le$1(null)],["intensity",new le$1(_t)]])}),this.renderTarget=new dt$1(1,1,{minFilter:rt$1,magFilter:rt$1,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new TQ({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=st,this.luminanceMaterial.smoothingFactor=mt,this.blurPass=new gx({resolutionScale:gt,width:Et,height:At,kernelSize:Rt});let Ft=this.blurPass.getResolution();Ft.addEventListener("change",Nt=>this.setSize(Ft.baseWidth,Ft.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(nt){this.resolution.preferredWidth=nt}get height(){return this.resolution.height}set height(nt){this.resolution.preferredHeight=nt}get dithering(){return this.blurPass.dithering}set dithering(nt){this.blurPass.dithering=nt}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(nt){this.blurPass.kernelSize=nt}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(nt){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(nt){this.uniforms.get("intensity").value=nt}getIntensity(){return this.intensity}setIntensity(nt){this.intensity=nt}getResolutionScale(){return this.resolution.scale}setResolutionScale(nt){this.resolution.scale=nt}update(nt,st,mt){let gt=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(nt,st,gt),this.blurPass.render(nt,gt,gt)):this.blurPass.render(nt,st,gt)}setSize(nt,st){let mt=this.resolution;mt.setBaseSize(nt,st),this.renderTarget.setSize(mt.width,mt.height),this.luminancePass.resolution.copy(mt)}initialize(nt,st,mt){this.blurPass.initialize(nt,st,mt),mt!==void 0&&(this.renderTarget.texture.type=mt,nt.outputEncoding===at$1&&(this.renderTarget.texture.encoding=at$1))}},_Q="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",M3=class extends zo{constructor({blendFunction:nt=Pt.NORMAL,brightness:st=0,contrast:mt=0}={}){super("BrightnessContrastEffect",_Q,{blendFunction:nt,uniforms:new Map([["brightness",new le$1(st)],["contrast",new le$1(mt)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(nt){this.uniforms.get("brightness").value=nt}getBrightness(nt){return this.brightness}setBrightness(nt){this.brightness=nt}get contrast(){return this.uniforms.get("contrast").value}set contrast(nt){this.uniforms.get("contrast").value=nt}getContrast(nt){return this.contrast}setContrast(nt){this.contrast=nt}},DQ="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",T3=class extends zo{constructor(nt=Pt.NORMAL){super("ColorAverageEffect",DQ,{blendFunction:nt})}},IQ="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",OQ="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",C3=class extends zo{constructor({blendFunction:nt=Pt.NORMAL,offset:st=new U$1(.001,5e-4)}={}){super("ChromaticAberrationEffect",IQ,{vertexShader:OQ,blendFunction:nt,attributes:Uo.CONVOLUTION,uniforms:new Map([["offset",new le$1(st)]])})}get offset(){return this.uniforms.get("offset").value}set offset(nt){this.uniforms.get("offset").value=nt}getOffset(){return this.offset}setOffset(nt){this.offset=nt}},RQ=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,P3=class extends zo{constructor(nt,{blendFunction:st=Pt.NORMAL,worldFocusDistance:mt,worldFocusRange:gt,focusDistance:_t=0,focalLength:Et=.1,focusRange:At=Et,bokehScale:Rt=1,width:Ft=Vn.AUTO_SIZE,height:Nt=Vn.AUTO_SIZE}={}){super("DepthOfFieldEffect",RQ,{blendFunction:st,attributes:Uo.DEPTH,uniforms:new Map([["nearColorBuffer",new le$1(null)],["farColorBuffer",new le$1(null)],["nearCoCBuffer",new le$1(null)],["scale",new le$1(1)]])}),this.camera=nt,this.renderTarget=new dt$1(1,1,{minFilter:rt$1,magFilter:rt$1,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new hn(new FX(nt));let Bt=this.cocMaterial;Bt.focusDistance=_t,Bt.focusRange=At,mt!==void 0&&(Bt.worldFocusDistance=mt),gt!==void 0&&(Bt.worldFocusRange=gt),this.blurPass=new gx({kernelSize:Dm.MEDIUM,width:Ft,height:Nt});let Gt=this.blurPass.getResolution();Gt.addEventListener("change",Mr=>this.setSize(Gt.getBaseWidth(),Gt.getBaseHeight())),this.maskPass=new hn(new ZX(this.renderTargetCoC.texture));let dr=this.maskPass.fullscreenMaterial;dr.maskFunction=b3.MULTIPLY,dr.colorChannel=x3.GREEN,this.bokehNearBasePass=new hn(new px(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new hn(new px(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new hn(new px(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new hn(new px(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=Rt}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(nt){let st=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let mt of st)mt.fullscreenMaterial.setScale(nt);this.maskPass.fullscreenMaterial.setStrength(nt),this.uniforms.get("scale").value=nt}getBokehScale(){return this.bokehScale}setBokehScale(nt){this.bokehScale=nt}getTarget(){return this.target}setTarget(nt){this.target=nt}calculateFocusDistance(nt){let st=this.camera,mt=st.position.distanceTo(nt);return BE(-mt,st.near,st.far)}setDepthTexture(nt,st=Bi){this.circleOfConfusionMaterial.depthBuffer=nt,this.circleOfConfusionMaterial.depthPacking=st}update(nt,st,mt){let gt=this.renderTarget,_t=this.renderTargetCoC,Et=this.renderTargetCoCBlurred,At=this.renderTargetMasked;if(this.target!==null){let Rt=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=Rt}this.cocPass.render(nt,null,_t),this.blurPass.render(nt,_t,Et),this.maskPass.render(nt,st,At),this.bokehFarBasePass.render(nt,At,gt),this.bokehFarFillPass.render(nt,gt,this.renderTargetFar),this.bokehNearBasePass.render(nt,st,gt),this.bokehNearFillPass.render(nt,gt,this.renderTargetNear)}setSize(nt,st){let mt=this.resolution;mt.setBaseSize(nt,st);let gt=mt.width,_t=mt.height,Et=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];Et.push(this.renderTargetCoC,this.renderTargetMasked),Et.forEach(At=>At.setSize(nt,st)),Et=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],Et.forEach(At=>At.setSize(gt,_t)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(At=>At.fullscreenMaterial.setSize(gt,_t))}initialize(nt,st,mt){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(gt=>gt.initialize(nt,st,mt)),this.blurPass.initialize(nt,st,_r),mt!==void 0&&(this.renderTarget.texture.type=mt,this.renderTargetNear.texture.type=mt,this.renderTargetFar.texture.type=mt,this.renderTargetMasked.texture.type=mt,nt.outputEncoding===at$1&&(this.renderTarget.texture.encoding=at$1,this.renderTargetNear.texture.encoding=at$1,this.renderTargetFar.texture.encoding=at$1,this.renderTargetMasked.texture.encoding=at$1))}};new E$6;new ue$1;var LQ="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",_3=class extends zo{constructor({blendFunction:nt=Pt.NORMAL,hue:st=0,saturation:mt=0}={}){super("HueSaturationEffect",LQ,{blendFunction:nt,uniforms:new Map([["hue",new le$1(new E$6)],["saturation",new le$1(mt)]])}),this.hue=st}get saturation(){return this.uniforms.get("saturation").value}set saturation(nt){this.uniforms.get("saturation").value=nt}getSaturation(){return this.saturation}setSaturation(nt){this.saturation=nt}get hue(){let nt=this.uniforms.get("hue").value;return Math.acos((nt.x*3-1)/2)}set hue(nt){let st=Math.sin(nt),mt=Math.cos(nt);this.uniforms.get("hue").value.set((2*mt+1)/3,(-Math.sqrt(3)*st-mt+1)/3,(Math.sqrt(3)*st-mt+1)/3)}getHue(){return this.hue}setHue(nt){this.hue=nt}};new We$1;var BQ=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,D3=class extends zo{constructor({blendFunction:nt=Pt.SCREEN,premultiply:st=!1}={}){super("NoiseEffect",BQ,{blendFunction:nt}),this.premultiply=st}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(nt){this.premultiply!==nt&&(nt?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(nt){this.premultiply=nt}},NQ="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",I3=class extends zo{constructor(nt=30){super("PixelationEffect",NQ,{uniforms:new Map([["active",new le$1(!1)],["d",new le$1(new U$1)]])}),this.resolution=new U$1,this.d=0,this.granularity=nt}get granularity(){return this.d}set granularity(nt){let st=Math.floor(nt);st%2>0&&(st+=1),this.d=st,this.uniforms.get("active").value=st>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(nt){this.granularity=nt}setSize(nt,st){this.resolution.set(nt,st),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new E$6;new E$6;var y3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",v3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",FQ="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",VQ="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",La={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},yx=class extends zo{constructor({preset:nt=La.MEDIUM,edgeDetectionMode:st=of.COLOR,predicationMode:mt=HX.DISABLED}={}){super("SMAAEffect",FQ,{vertexShader:VQ,blendFunction:Pt.NORMAL,attributes:Uo.CONVOLUTION|Uo.DEPTH,uniforms:new Map([["weightMap",new le$1(null)]])});let gt,_t;arguments.length>1&&(gt=arguments[0],_t=arguments[1],arguments.length>2&&(nt=arguments[2]),arguments.length>3&&(st=arguments[3])),this.renderTargetEdges=new dt$1(1,1,{minFilter:rt$1,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new FE(!0,!1,!1),this.clearPass.overrideClearColor=new We$1(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new hn(new WX),this.edgeDetectionMaterial.edgeDetectionMode=st,this.edgeDetectionMaterial.predicationMode=mt,this.weightsPass=new hn(new eQ);let Et=new yp;Et.onLoad=()=>{let At=new $t(gt);At.name="SMAA.Search",At.magFilter=Vt,At.minFilter=Vt,At.generateMipmaps=!1,At.needsUpdate=!0,At.flipY=!0,this.weightsMaterial.searchTexture=At;let Rt=new $t(_t);Rt.name="SMAA.Area",Rt.magFilter=rt$1,Rt.minFilter=rt$1,Rt.generateMipmaps=!1,Rt.needsUpdate=!0,Rt.flipY=!1,this.weightsMaterial.areaTexture=Rt,this.dispatchEvent({type:"load"})},Et.itemStart("search"),Et.itemStart("area"),gt!==void 0&&_t!==void 0?(Et.itemEnd("search"),Et.itemEnd("area")):typeof Image<"u"&&(gt=new Image,_t=new Image,gt.addEventListener("load",()=>Et.itemEnd("search")),_t.addEventListener("load",()=>Et.itemEnd("area")),gt.src=y3,_t.src=v3),this.applyPreset(nt)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(nt){this.edgeDetectionMaterial.edgeDetectionThreshold=nt}setOrthogonalSearchSteps(nt){this.weightsMaterial.orthogonalSearchSteps=nt}applyPreset(nt){let st=this.edgeDetectionMaterial,mt=this.weightsMaterial;switch(nt){case La.LOW:st.edgeDetectionThreshold=.15,mt.orthogonalSearchSteps=4,mt.diagonalDetection=!1,mt.cornerDetection=!1;break;case La.MEDIUM:st.edgeDetectionThreshold=.1,mt.orthogonalSearchSteps=8,mt.diagonalDetection=!1,mt.cornerDetection=!1;break;case La.HIGH:st.edgeDetectionThreshold=.1,mt.orthogonalSearchSteps=16,mt.diagonalSearchSteps=8,mt.cornerRounding=25,mt.diagonalDetection=!0,mt.cornerDetection=!0;break;case La.ULTRA:st.edgeDetectionThreshold=.05,mt.orthogonalSearchSteps=32,mt.diagonalSearchSteps=16,mt.cornerRounding=25,mt.diagonalDetection=!0,mt.cornerDetection=!0;break}}setDepthTexture(nt,st=Bi){this.edgeDetectionMaterial.depthBuffer=nt,this.edgeDetectionMaterial.depthPacking=st}update(nt,st,mt){this.clearPass.render(nt,this.renderTargetEdges),this.edgeDetectionPass.render(nt,st,this.renderTargetEdges),this.weightsPass.render(nt,this.renderTargetEdges,this.renderTargetWeights)}setSize(nt,st){this.edgeDetectionMaterial.setSize(nt,st),this.weightsMaterial.setSize(nt,st),this.renderTargetEdges.setSize(nt,st),this.renderTargetWeights.setSize(nt,st)}dispose(){let{searchTexture:nt,areaTexture:st}=this.weightsMaterial;nt!==null&&st!==null&&(nt.dispose(),st.dispose()),super.dispose()}static get searchImageDataURL(){return y3}static get areaImageDataURL(){return v3}},UQ=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,mx={DEFAULT:0,ESKIL:1},O3=class extends zo{constructor({blendFunction:nt=Pt.NORMAL,technique:st=mx.DEFAULT,eskil:mt=!1,offset:gt=.5,darkness:_t=.5}={}){super("VignetteEffect",UQ,{blendFunction:nt,defines:new Map([["VIGNETTE_TECHNIQUE",st.toFixed(0)]]),uniforms:new Map([["offset",new le$1(gt)],["darkness",new le$1(_t)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(nt){this.technique!==nt&&(this.defines.set("VIGNETTE_TECHNIQUE",nt.toFixed(0)),this.setChanged())}get eskil(){return this.technique===mx.ESKIL}set eskil(nt){this.technique=nt?mx.ESKIL:mx.DEFAULT}getTechnique(){return this.technique}setTechnique(nt){this.technique=nt}get offset(){return this.uniforms.get("offset").value}set offset(nt){this.uniforms.get("offset").value=nt}getOffset(){return this.offset}setOffset(nt){this.offset=nt}get darkness(){return this.uniforms.get("darkness").value}set darkness(nt){this.uniforms.get("darkness").value=nt}getDarkness(){return this.darkness}setDarkness(nt){this.darkness=nt}},si=class{constructor(nt,st){this.enabled=!1,this.effect=new nt(st),Object.defineProperty(this,"opacity",{enumerable:!0,set(mt){this.effect.blendMode.opacity.value=mt},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(mt){this.effect.blendMode.setBlendFunction(Number(mt))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Pt.NORMAL}},af=class extends si{constructor(){super(E3),this.blendFunction=Pt.SCREEN}set intensity(nt){this.effect.intensity=nt}get intensity(){return this.effect.intensity}set luminanceThreshold(nt){this.effect.luminanceMaterial.threshold=nt}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(nt){this.effect.luminanceMaterial.smoothing=nt}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(nt){this.effect.blurPass.scale=nt}get blurScale(){return this.effect.blurPass.scale}set kernelSize(nt){this.effect.blurPass.kernelSize=nt}get kernelSize(){return this.effect.blurPass.kernelSize}},lf=class extends si{constructor(){super(M3)}set contrast(nt){this.effect.uniforms.get("contrast").value=nt}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(nt){this.effect.uniforms.get("brightness").value=nt}get brightness(){return this.effect.uniforms.get("brightness").value}},cf=class extends si{constructor(){super(C3),this.effect.offset=new U$1(.01,.01)}set offset(nt){this.effect.offset.set(nt[0]/1e3,nt[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},uf=class extends si{constructor(){super(T3)}},hf=class extends si{constructor(){super(_3),this._hue=0}set hue(nt){this._hue=nt,this.effect.setHue(nt)}get hue(){return this._hue}set saturation(nt){this.effect.uniforms.get("saturation").value=nt}get saturation(){return this.effect.uniforms.get("saturation").value}},df=class extends si{constructor(){super(D3),this.blendFunction=Pt.OVERLAY}},ff=class extends si{constructor(){super(O3)}get eskil(){return this.effect.eskil}set eskil(nt){this.effect.eskil=nt}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(nt){this.effect.uniforms.get("darkness").value=nt}get offset(){return this.effect.uniforms.get("offset").value}set offset(nt){this.effect.uniforms.get("offset").value=nt}},pf=class extends si{constructor(nt){super(P3)}set focalLength(nt){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=nt/2e3}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(nt){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=this.isPerspectiveCamera?nt/2e3:(nt+992)/2e3}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(nt){this.effect.bokehScale=nt}setCamera(nt){let st=!1;(nt.isPerspectiveCamera&&this.isPerspectiveCamera===!1||!nt.isPerspectiveCamera&&this.isPerspectiveCamera===!0)&&(st=!0),nt.isPerspectiveCamera?(this.effect.circleOfConfusionMaterial.adoptCameraSettings(nt.perspCamera),this.isPerspectiveCamera=!0):(this.effect.circleOfConfusionMaterial.adoptCameraSettings(nt),this.isPerspectiveCamera=!1),st&&this.effect.setChanged()}},mf=class extends si{constructor(){super(I3)}get granularity(){return this.effect.getGranularity()}set granularity(nt){this.effect.setGranularity(nt)}},R3=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,L3=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,B3=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,N3=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,gf=class extends it$1{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new le$1(null)},blending:Jt,depthWrite:!1,depthTest:!1,vertexShader:B3,fragmentShader:N3})}set inputBuffer(nt){this.uniforms.inputBuffer.value=nt}},vx=class extends xi{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new gf,this.resolutionVector=new U$1,this.resolveMaterial=new it$1({name:"TAAResolveMaterial",uniforms:{inputBuffer:new le$1(null),historyBuffer:new le$1(null),velocityBuffer:new le$1(null),depthBuffer:new le$1(null),resolution:new le$1(new U$1)},blending:Jt,depthWrite:!1,depthTest:!1,vertexShader:R3,fragmentShader:L3}),this.historyRenderTarget=new dt$1(1024,1024,{minFilter:rt$1,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new dt$1(1024,1024,{minFilter:rt$1,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(nt,st){this.historyRenderTarget.setSize(nt,st),this.resultRenderTarget.setSize(nt,st)}render(nt,st){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=st.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=st.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=st.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(st.width,st.height),nt.setRenderTarget(this.resultRenderTarget),nt.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,nt.setRenderTarget(this.historyRenderTarget),nt.render(this.scene,this.camera);let mt=this.renderToScreen?null:st;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,nt.setRenderTarget(mt),nt.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},xx=class extends xi{constructor(nt,st,mt){super("TransmissionPass",void 0,st),this.MRTCompatible=!0,this.depthPass=new VE(nt,st,{renderTarget:mt.transmissionDepthTarget}),this.passThroughMaterial=new gf,this.splineScene=nt,this.needsSwap=!1}updatePasses(nt){this.passThroughMaterial=new gf,this.depthPass=new VE(this.splineScene,this.camera,{renderTarget:nt.transmissionDepthTarget})}setCamera(nt){this.camera=nt}setScene(nt){this.splineScene=nt}render(nt,st,mt){let gt=this.camera.layers.mask,_t=nt;_t.setRenderTarget(_t.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=st.texture[0],_t.clear(),_t.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(nt,st,mt),_t.shadowMap.needsUpdate=!1,_t.shadowMap.autoUpdate=!1;let Et=this.renderToScreen?null:st;this.camera.layers.set(3),nt.setRenderTarget(Et),nt.render(this.splineScene,this.camera),this.camera.layers.mask=gt}},F3=new ei,WQ=new it$1({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),Zc=class extends xi{constructor(nt,st,mt){super("OpaquePass",st??F3,mt),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=nt}setCamera(nt){this.camera=nt}setScene(nt){this.scene=nt??F3}getScene(){return this.scene}render(nt,st){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(gt=>{gt.layers.isEnabled(3)&&gt instanceof mr&&(this.originalMaterials.set(gt.id,gt.material),gt.material=WQ)}),nt.shadowMap.needsUpdate=!0,nt.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let mt=this.renderToScreen?null:st;nt.setRenderTarget(mt),this.clearColorOnly&&nt.clear(!0,!1,!0),this.clear&&nt.clear(),nt.render(this.scene,this.camera),this.clearDepth&&nt.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((gt,_t)=>{let Et=this.scene.getObjectById(_t);Et&&(Et.material=gt)})}},bx=class{constructor(nt,{depthBuffer:st=!0,stencilBuffer:mt=!1,multisampling:gt=0,frameBufferType:_t=0}={}){this.renderer=nt,this.helperStartIndex=0,this.copyPass=new _m,this.depthTexture=null,this.timer=new A3,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(st,mt,_t,gt,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(st,mt,_t,gt,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(st,mt,_t,gt,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(nt)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(nt){let st=this.inputBuffer,mt=this.multisampling;mt>0&&nt>0?(this.inputBuffer.samples=nt,this.outputBuffer.samples=nt,this.inputBuffer.dispose(),this.outputBuffer.dispose()):mt!==nt&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(st.depthBuffer,st.stencilBuffer,st.texture.type,nt,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(nt){var st;if(this.renderer=nt,nt!==null){let mt=nt.getSize(new U$1),gt=((st=nt.getContext().getContextAttributes())==null?void 0:st.alpha)??!1,_t=this.inputBuffer.texture[0].type;_t===_r&&nt.outputEncoding===at$1&&(this.inputBuffer.texture[0].encoding=at$1,this.outputBuffer.texture[0].encoding=at$1,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),nt.autoClear=!1,this.setSize(mt.width,mt.height,!1);for(let Et of this.passes)Et.initialize(nt,gt,_t)}}replaceRenderer(nt,st=!0){let mt=this.renderer,gt=mt.domElement.parentNode;return this.setRenderer(nt),st&&gt!==null&&(gt.removeChild(mt.domElement),gt.appendChild(nt.domElement)),mt}createDepthTexture(){let nt=this.depthTexture=new ns(this._width,this._height);return this.inputBuffer.depthTexture=nt,this.inputBuffer.stencilBuffer?(nt.format=Za,nt.type=Xa):nt.type=Ds,nt}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let nt of this.passes)nt.setDepthTexture(null)}}createBuffer(nt,st,mt,gt,_t,Et){let At=this.renderer,Rt=At===null?new U$1:At.getDrawingBufferSize(new U$1),Ft={minFilter:rt$1,magFilter:rt$1,wrapS:Xt,wrapT:Xt,stencilBuffer:st,depthBuffer:nt},Nt;return gt>0?(Nt=new dt$1(Rt.width,Rt.height,Ft),Nt.samples=gt):(_t?(Nt=new ry(Rt.width,Rt.height,2,Ft),Nt.texture[1].type=Wn):Nt=new dt$1(Rt.width,Rt.height,Ft),Nt.depthTexture=new ns(2048,2048),Nt.depthTexture.type=br),mt===_r&&At!==null&&At.outputEncoding===at$1&&(Array.isArray(Nt.texture)?Nt.texture.forEach(Bt=>Bt.encoding=at$1):Nt.texture.encoding=at$1),Array.isArray(Nt.texture)?Nt.texture.forEach((Bt,Gt)=>{Bt.name=`EffectComposer.Buffer ${_t} ${Gt}`,Bt.generateMipmaps=!1}):(Nt.texture.name=`EffectComposer.Buffer ${_t}`,Nt.texture.generateMipmaps=!1),Nt.name=Et,Nt}addPass(nt,st){var Rt;let mt=this.passes,gt=this.renderer,_t=gt.getDrawingBufferSize(new U$1),Et=((Rt=gt.getContext().getContextAttributes())==null?void 0:Rt.alpha)??!1,At;if(nt.MRTCompatible&&(At=this.inputBuffer.texture[0].type),nt.MRTCompatible||(At=this.inputBuffer.texture.type),nt.setRenderer(gt),nt.setSize(_t.width,_t.height),nt.initialize(gt,Et,At),this.autoRenderToScreen&&(mt.length>0&&(mt[mt.length-1].renderToScreen=!1),nt.renderToScreen&&(this.autoRenderToScreen=!1)),st!==void 0?mt.splice(st,0,nt):mt.push(nt),this.autoRenderToScreen&&(mt[mt.length-1].renderToScreen=!0),nt.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let Ft=this.createDepthTexture();for(nt of mt)nt.setDepthTexture(Ft)}else nt.setDepthTexture(this.depthTexture)}setHelperStartIndex(nt){this.helperStartIndex=nt}removePass(nt){let st=this.passes,mt=st.indexOf(nt);if(mt!==-1&&st.splice(mt,1).length>0){if(this.depthTexture!==null){let gt=(_t,Et)=>_t||Et.needsDepthTexture;st.reduce(gt,!1)||nt.getDepthTexture()===this.depthTexture&&nt.setDepthTexture(null)}this.autoRenderToScreen&&mt===st.length&&(nt.renderToScreen=!1,st.length>0&&(st[st.length-1].renderToScreen=!0))}}removeAllPasses(){let nt=this.passes;nt.length>0&&(this.autoRenderToScreen&&(nt[nt.length-1].renderToScreen=!1),this.passes=[])}render(nt){let st=this.renderer,mt=this.copyPass,gt=this.inputBuffer,_t=this.outputBuffer,Et=this.inputBufferSingle,At=this.outputBufferSingle,Rt=!1,Ft,Nt,Bt,Gt;nt===void 0&&(nt=this.timer.update().getDelta());for(let dr of this.passes)dr.enabled&&(dr.MRTCompatible?dr.render(st,gt,_t,nt,Rt):dr.render(st,Et,At,nt,Rt),dr.needsSwap&&(Rt&&(mt.renderToScreen=dr.renderToScreen,Ft=st.getContext(),Nt=st.state.buffers.stencil,Nt.setFunc(Ft.NOTEQUAL,1,4294967295),mt.render(st,gt,_t,nt,Rt),Nt.setFunc(Ft.EQUAL,1,4294967295)),Bt=gt,Gt=Et,gt=_t,Et=At,_t=Bt,At=Gt),dr instanceof w3?Rt=!0:dr instanceof S3&&(Rt=!1))}setSize(nt,st,mt){let gt=this.renderer;if(this._width=nt,this._height=st,nt===void 0||st===void 0){let Et=gt.getSize(new U$1);nt=Et.width,st=Et.height}gt.setSize(nt,st,mt);let _t=gt.getDrawingBufferSize(new U$1);this.inputBuffer.setSize(_t.width,_t.height),this.outputBuffer.setSize(_t.width,_t.height),this.inputBufferSingle.setSize(_t.width,_t.height),this.outputBufferSingle.setSize(_t.width,_t.height);for(let Et of this.passes)Et.setSize(_t.width,_t.height)}reset(){let nt=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(nt)}dispose(){for(let nt of this.passes)nt.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},qQ=new it$1({name:"CombineMaterial",uniforms:{inputBufferA:new le$1(null),inputBufferB:new le$1(null)},blending:Jt,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),Sx=class extends xi{constructor(nt){super("HelperPass",void 0,nt),this.MRTCompatible=!1,this.fullscreenMaterial=qQ,this.helperPass=new Zc(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new Zc(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let st=new yx({preset:La.LOW,edgeDetectionMode:of.COLOR});this.effectPass=new Kc(this.camera,st),this.rt=new dt$1(10,10,{minFilter:rt$1,magFilter:rt$1,wrapS:Xt,wrapT:Xt,depthBuffer:!0})}setSize(nt,st){this.rt.setSize(nt,st),this.effectPass.setSize(nt,st)}set sceneHelpers(nt){this.helperPass.setScene(nt)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(nt){this.helperPassOnTop.setScene(nt)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(nt){this.helperPass.setCamera(nt),this.helperPassOnTop.setCamera(nt)}initialize(nt,st,mt){super.initialize(nt,st,mt),this.effectPass.initialize(nt,st,mt)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(nt,st,mt){this.rt.depthTexture=st.depthTexture;let gt=nt.getClearAlpha();nt.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(nt,this.rt),this.helperPassOnTop.render(nt,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(nt,this.rt,mt),this.fullscreenMaterial.uniforms.inputBufferA.value=mt.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=st.texture,nt.setClearAlpha(gt),nt.setRenderTarget(null),nt.clear(),nt.render(this.scene,this.camera)}},V3=`#define GLSLIFY 1
#include <skinning_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,U3=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,z3=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,k3=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,G3=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,j3=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,yf=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],$Q=new it$1({vertexShader:V3,fragmentShader:U3}),vf=new it$1({vertexShader:G3,fragmentShader:j3,uniforms:{texture_ao_lrez:new le$1(null),texture_depth_lrez:new le$1(null),texture_depth_hrez:new le$1(null),near:new le$1(null),far:new le$1(null)}}),wx=class extends xi{constructor(nt,st){super("AmbientOcclusionPass",void 0,st),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let mt=1024,gt=1024;this.gBuffer=new dt$1(mt,gt,{type:go?Wn:br,depthTexture:new ns(mt,gt),minFilter:rt$1,magFilter:rt$1}),this.depthBufferHighRes=new dt$1(mt,gt,{depthTexture:new ns(mt,gt)}),this.aoBuffer=new dt$1(mt,gt,{minFilter:rt$1,magFilter:rt$1}),this.splineScene=nt,this.splineCamera=st;let _t=new Float32Array(yf.length*2);for(let At=0;At<yf.length;At++){let Rt=At*2;_t[Rt+0]=yf[At][0],_t[Rt+1]=yf[At][1]}this.blueNoiseInDiskTexture=new gi(_t,yf.length,1,Ju,br),this.blueNoiseInDiskTexture.wrapS=Os,this.blueNoiseInDiskTexture.wrapT=Os,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new it$1({vertexShader:z3,fragmentShader:k3,uniforms:{near:new le$1(null),far:new le$1(null),fov:new le$1(null),proj_info:new le$1(new Ze$1),is_ortho:new le$1(!1),resolution:new le$1(new U$1),radius_of_influence:new le$1(8),radius_in_screen_space:new le$1(1),exponent:new le$1(1),ao_color:new le$1(new E$6),bias:new le$1(.5),texture_depth:new le$1(null),texture_normals:new le$1(null),texture_blue_noise:new le$1(null),texture_blue_noise_in_disk:new le$1(this.blueNoiseInDiskTexture),frame_index:new le$1(0),fog_enabled:new le$1(!1),fog_near:new le$1(1),fog_far:new le$1(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new dt$1(mt,gt,{minFilter:rt$1,magFilter:rt$1,wrapS:Xt,wrapT:Xt,depthBuffer:!1,type:br});let Et=new yx({preset:La.ULTRA,edgeDetectionMode:of.COLOR});this.effectPass=new Kc(this.camera,Et)}initialize(nt,st,mt){super.initialize(nt,st,mt),this.effectPass.initialize(nt,st,mt)}setBlueNoiseTexture(nt){this.hbaoMaterial.uniforms.texture_blue_noise.value=nt}setSize(nt,st){this._width=nt,this._height=st,this.depthBufferHighRes.setSize(nt,st);let mt=this._runHalfRes?.5:1,gt=nt*mt,_t=st*mt;this.gBuffer.setSize(gt,_t),this.aoBuffer.setSize(gt,_t),this.hbaoMaterial.uniforms.resolution.value.set(gt,_t),this.aaBuffer.setSize(gt,_t),this.effectPass.setSize(gt,_t)}get runHalfRes(){return this._runHalfRes}set runHalfRes(nt){this._runHalfRes=nt,this.setSize(this._width,this._height)}setCamera(nt){this.splineCamera=nt}setScene(nt){this.splineScene=nt}setDepthTexture(nt){this.depthBufferHighRes.depthTexture=nt,vf.uniforms.texture_depth_hrez.value=nt,vf.needsUpdate=!0}render(nt,st,mt){this.splineScene.overrideMaterial=$Q;let gt=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),nt.setRenderTarget(this.gBuffer),nt.clear(),nt.render(this.splineScene,this.splineCamera),nt.setRenderTarget(this.depthBufferHighRes),nt.clear(),nt.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=gt,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let _t=this.splineCamera.perspCamera.projectionMatrix.elements,Et=2/_t[0],At=2/_t[5],Rt=-(1-_t[8])/_t[0],Ft=-(1+_t[9])/_t[5];this.hbaoMaterial.uniforms.proj_info.value.set(Et,At,Rt,Ft);let Nt=this.splineCamera.perspCamera.fov*(Math.PI/180),Bt=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(Nt*.5)*2),Gt=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*Bt;this.hbaoMaterial.uniforms.radius_in_screen_space.value=Gt,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let _t=this.splineCamera.orthoCamera.projectionMatrix.elements,Et=2/_t[0],At=2/_t[5],Rt=-(1+_t[12])/_t[0],Ft=-(1-_t[13])/_t[5];this.hbaoMaterial.uniforms.proj_info.value.set(Et,At,Rt,Ft);let Nt=.5*(this.hbaoMaterial.uniforms.resolution.value.y/At),Bt=this.hbaoMaterial.uniforms.radius_of_influence.value*Nt;this.hbaoMaterial.uniforms.radius_in_screen_space.value=Bt,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,nt.setRenderTarget(this.aoBuffer),nt.clear(),nt.render(this.scene,this.camera),this.fullscreenMaterial=vf,vf.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,vf.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,vf.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,nt.setRenderTarget(nt.aoRenderTarget),nt.clear(),nt.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,nt.setRenderTarget(this.aaBuffer),nt.clear(),nt.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(nt,this.aaBuffer,nt.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},eK=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,tK=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,Ax=class extends hn{constructor(){super(new it$1({vertexShader:eK,fragmentShader:tK,uniforms:{tInput:new le$1(null),tMap:new le$1(null),uResolution:new le$1(new U$1),uSize:new le$1(new U$1),uCoords:new le$1(new U$1),uScale:new le$1(1),uSceneColor:new le$1(new We$1(16711680)),uDPR:new le$1(1),uCurrent:new le$1(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(nt){this.uniforms.tMap.value=nt}},rK=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,iK=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,nK=[],Ex=class extends hn{constructor(){super(new it$1({vertexShader:rK,fragmentShader:iK,uniforms:{toScene:new le$1(null),fromScene:new le$1(null),uResolution:new le$1(new U$1),uDPR:new le$1(1),mixRatio:new le$1(0),threshold:new le$1(.1),useTexture:new le$1(0),tMixTexture:{value:nK[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(nt){this.uniforms.fromScene.value=nt}},sK=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,oK=`
uniform sampler2D inputBuffer;
uniform sampler2D blurredInputBuffer;
uniform sampler2D overlay;
uniform float blurIntensity;

uniform vec2 uResolution;
uniform float uDPR;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( overlay, screenUv );
	vec4 texel2 = texture2D( inputBuffer, screenUv );
	vec4 texel3 = texture2D( blurredInputBuffer, screenUv );

	float blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;
    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );
}
`,Mx=class extends hn{constructor(){super(new it$1({vertexShader:sK,fragmentShader:oK,uniforms:{inputBuffer:new le$1(null),blurredInputBuffer:new le$1(null),overlay:new le$1(null),uResolution:new le$1(new U$1),uDPR:new le$1(1),blurIntensity:new le$1(0)}})),this._blurEnabled=!1,this.blurTarget=new dt$1(1,1,{minFilter:rt$1,magFilter:rt$1,wrapS:Xt,wrapT:Xt}),this.blurPass=new gx({width:window.innerWidth,height:window.innerHeight,kernelSize:Dm.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(nt){this.uniforms.overlay.value=nt}setResolution(nt,st,mt=1){this.uniforms.uResolution.value.set(nt,st),this.uniforms.uDPR.value=mt,this.blurPass.setSize(nt,st),this.blurTarget.setSize(nt,st),this.blurPass.setSize(nt,st)}get uiCanvas(){return this._uiCanvas}set uiCanvas(nt){this._uiCanvas=nt,nt.texture&&(this.uniforms.overlay.value=nt.texture);let st=nt.frame;if(st){let mt=st.data.backgroundBlur,gt=mt.radius;this._blurEnabled=mt.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=gt/3}}render(nt,st,mt,gt,_t){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(nt,st,this.blurTarget,gt,_t)),super.render(nt,st,mt,gt,_t)}},aK=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,lK=`
uniform sampler2D tInput;
uniform sampler2D tOverlayImage;
varying vec2 vUv;
uniform vec2 uResolution;
uniform vec2 uRightBottom;
uniform vec2 uImageSize;
uniform float uScale;
uniform float uDPR;

vec3 blendNormal(vec3 base, vec3 blend) {
	return blend;
}

vec3 blendNormal(vec3 base, vec3 blend, float opacity) {
	return (blendNormal(base, blend) * opacity + base * (1.0 - opacity));
}

vec4 drawFixedSizeImage(sampler2D image, vec2 screenUV, vec2 imageSize, vec2 imageCoords, vec2 screenSize, float dpr) {
	vec2 uv = (screenUV * screenSize * dpr - imageCoords) / (imageSize * dpr);
	if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {
		return vec4(0.0);
	}
	return texture2D(image, uv);
}

void main() {
    vec2 screenUV = gl_FragCoord.xy / (uResolution.xy * uDPR);
	vec2 imageCoords = vec2(uResolution.x * uDPR - uImageSize.x * uScale * uDPR - uRightBottom.x * uDPR, uRightBottom.y * uDPR);
    vec4 background = texture2D(tInput, screenUV);
    vec4 image = drawFixedSizeImage(tOverlayImage, screenUV, uImageSize * uScale, imageCoords, uResolution, uDPR);
    gl_FragColor = vec4(blendNormal(background.rgb, image.rgb, image.a), max(background.a, image.a));
}
`,Tx=class extends hn{constructor(){super(new it$1({vertexShader:aK,fragmentShader:lK,uniforms:{tInput:new le$1(null),tOverlayImage:new le$1(null),uResolution:new le$1(new U$1),uImageSize:new le$1(new U$1),uRightBottom:new le$1(new U$1(20,20)),uScale:new le$1(.25),uDPR:new le$1(1)}}),"tInput")}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tOverlayImage.value}set texture(nt){this.uniforms.tOverlayImage.value=nt,this.uniforms.uImageSize.value.set(nt.image.width,nt.image.height)}};function W3(nt,st){return st&&st.enabled&&nt.push(st.effect),nt}var cK=nt=>Object.values(Pt).includes(nt)?nt:Pt.NORMAL,Im=class extends pr{constructor(nt,st){super(),this._needsDOFResize=st,this.postprocessingState=Gh.defaultData,this._scene=new ei,this._camera=new wr,this.effects=new Map,this.blueNoiseTexture=new gi,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new yy,this.renderer=nt,this.debug=!1,this.effects.set("bloom",new af),this.effects.set("chromaticAberration",new cf),this.effects.set("vignette",new ff),this.effects.set("noise",new df),this.effects.set("colorAverage",new uf),this.effects.set("hueSaturation",new hf),this.effects.set("brightnessContrast",new lf),this.effects.set("depthOfField",new pf),this.effects.set("pixelation",new mf),this.effectComposer=new bx(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new Zc(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new xx(this.scene,this.camera,this.renderer),this.aoPass=new wx(this.scene,this.camera),this.taaPass=new vx,this.taaPass.renderToScreen=!1,this.helperPass=new Sx(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new Ax,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new Mx,this.uiOverlayPass.enabled=!1,this.logoOverlayPass=new Tx,this.logoOverlayPass.enabled=!1,this.sceneTransitionPass=new Ex,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(nt){nt!==void 0?(this.stylesOverlayPass.texture=nt,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(nt){this.helperPass.sceneHelpers=nt}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(nt){this.helperPass.sceneHelpersOnTop=nt}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(nt){this._scene=nt,this.opaquePass.setScene(nt),this.transmissionPass.setScene(nt),this.aoPass.setScene(nt)}get camera(){return this._camera}set camera(nt){let st=this._camera!==nt;this._camera=nt,this.opaquePass.setCamera(nt),this.transmissionPass.setCamera(nt),st&&this.transmissionPass.updatePasses(this.renderer),this.aoPass.setCamera(nt),this.helperPass.setCamera(nt),this.effects.get("depthOfField").setCamera(nt)}updateRenderToScreen(){let nt=!1;for(let st=this.effectComposer.passes.length-1;st>=0;st--){let mt=this.effectComposer.passes[st];if(mt.enabled===!0&&!nt&&this._renderToScreen){mt.renderToScreen=!0,nt=!0;continue}mt.renderToScreen=!1}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(nt){this.blueNoiseTexture=new gi(nt,128,128),this.blueNoiseTexture.wrapS=Os,this.blueNoiseTexture.wrapT=Os,this.blueNoiseTexture.minFilter=Vt,this.blueNoiseTexture.magFilter=Vt,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(nt,st,mt,gt,_t,Et,At,Rt){this.aoPass.enabled=nt,this.aoPass.radius=st,this.aoPass.bias=mt,this.aoPass.aoColor=gt,this.aoPass.fogEnabled=_t,this.aoPass.fogNear=Et,this.aoPass.fogFar=At,this.aoPass.runHalfRes!==!Rt&&(this.aoPass.runHalfRes=!Rt)}setTransmissionPassEnabled(nt){this.transmissionPass.enabled=nt,this.opaquePass.hasTransmissionPass=nt}_initPasses(){var nt,st,mt;if((nt=this.uvEffectPass)==null||nt.dispose(),(st=this.effectPass)==null||st.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let gt=[this.effects.get("pixelation")].reduce(W3,[]);gt.length>0&&(this.uvEffectPass=new Kc(this.camera,...gt),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let _t=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("depthOfField"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(W3,[]);if(_t.length>0&&(this.effectPass=new Kc(this.camera,..._t),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass),this._needsDOFResize&&((mt=this.effects.get("depthOfField"))==null?void 0:mt.enabled)&&window!==void 0)){let Et=this.renderer.viewportWidth,At=this.renderer.viewportHeight;this.renderer.setSize(Et-1,At-1),this.renderer.setSize(Et,At)}}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass),this.effectComposer.addPass(this.logoOverlayPass)}_initCopyPass(){if(this._savePass)return;let nt=new U$1;this.renderer.getDrawingBufferSize(nt),this._rt=new dt$1(nt.x,nt.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Os,wrapT:Os}),this._rt.samples=0,this._savePass=new _m(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(nt){this._rt=nt,this._savePass=new _m(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(nt){if(this._renderToScreen===nt)return;let st=this.effectComposer;!st||(nt===!0?st.removePass(this._savePass):st.addPass(this._savePass),this._renderToScreen=nt,this.updateRenderToScreen())}set sceneTransitionFromTexture(nt){nt!==this.sceneTransitionPass.texture&&(nt!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=nt)}setWatermark(nt){this.logoOverlayPass.enabled=nt!==null,nt&&(this.logoOverlayPass.texture=nt)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(nt){let{enabled:st,...mt}=nt,gt=!1;st!==this.postprocessingState.enabled&&(gt=!0);for(let _t of Object.entries(mt)){let Et=_t[1],At=this.effects.get(_t[0]);if(At){At.enabled!==Et.enabled&&(gt=!0),At.enabled=Et.enabled;for(let[Rt,Ft]of Object.entries(Et))Rt==="blendFunction"?At.blendFunction=cK(Ft):At[Rt]=Ft}}this.postprocessingState=nt,gt&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(nt,st,mt,gt){nt instanceof Ze$1?(this.effectComposer.inputBuffer.scissor.set(nt.x,nt.y,nt.z,nt.w),this.effectComposer.outputBuffer.scissor.set(nt.x,nt.y,nt.z,nt.w)):(this.effectComposer.inputBuffer.scissor.set(nt,st,mt,gt),this.effectComposer.outputBuffer.scissor.set(nt,st,mt,gt));let _t=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(_t),this.effectComposer.outputBuffer.scissor.multiplyScalar(_t),this.renderer.setScissor(nt,st,mt,gt)}setScissorTest(nt){this.effectComposer.inputBuffer.scissorTest=nt,this.effectComposer.outputBuffer.scissorTest=nt,this.renderer.setScissorTest(nt)}setViewport(nt,st,mt,gt){nt instanceof Ze$1?(this.effectComposer.inputBuffer.viewport.copy(nt),this.effectComposer.outputBuffer.viewport.copy(nt)):(this.effectComposer.inputBuffer.viewport.set(nt,st,mt,gt),this.effectComposer.outputBuffer.viewport.set(nt,st,mt,gt))}resize(nt,st,mt){if(this.effectComposer.setSize(nt,st,mt),this._rt){let gt=this.renderer.getPixelRatio();this._rt.setSize(nt*gt,st*gt)}}dispose(){var nt,st;(nt=this.uvEffectPass)==null||nt.dispose(),(st=this.effectPass)==null||st.dispose(),this.effectComposer.dispose()}},uK=nt=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${nt};
const int gShadowSamples = ${nt};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,hK=xt.lights_fragment_begin,dK=xt.shadowmask_pars_fragment,q3=null,fK=nt=>{switch(nt){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},Y3=(nt="medium")=>{if(q3===nt)return!1;q3=nt;let st=fK(nt);xt.shadowmap_pars_fragment=uK(st);let mt=hK.slice();mt=mt.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),mt=mt.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),xt.lights_fragment_begin=mt;let gt=dK.slice();return gt=gt.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),xt.shadowmask_pars_fragment=gt,!0},pK=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;
#include <skinning_pars_vertex>

void main()
{
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
vec3 transformed = vec3(position);
#include <skinning_vertex>

vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
}
`,mK=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,Cx=new it$1({vertexShader:pK,fragmentShader:mK,uniforms:{depthContrast:{value:1}}}),X3=new $t,Q3=new U$1,Px=class extends _w{constructor(nt){super(nt),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new U$1,this.dummyCamera=new wr,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(_t=!0,Et=!0,At=!0)=>{let Rt=this.getContext(),Ft=0;_t&&(Ft|=Rt.COLOR_BUFFER_BIT),Et&&(Ft|=Rt.DEPTH_BUFFER_BIT),At&&(Ft|=Rt.STENCIL_BUFFER_BIT),Rt.clear(Ft),Rt.clearBufferfv(Rt.COLOR,1,[0,0,0,1])},this.pipeline=new Im(this,(nt==null?void 0:nt.needsDOFResize)??!1),this.autoClear=!1;let st=this.setPixelRatio.bind(this),mt=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=Ay,this.dummyCamera.matrixAutoUpdate=!1,this.domElement.removeAttribute("data-engine");let gt=this.getContext();if(gt&&"drawingBufferColorSpace"in gt)try{gt.drawingBufferColorSpace="display-p3"}catch(_t){console.warn(_t)}this.setPixelRatio=_t=>{this._pixelRatio!==_t&&(this._pixelRatio=_t,st(_t))},this.setSize=(_t,Et,At=!0)=>{var Rt,Ft;(this.viewportWidth!==_t||this.viewportHeight!==Et)&&(this.viewportWidth=_t,this.viewportHeight=Et,mt(_t,Et,At),(Rt=this.normalRenderTarget)==null||Rt.setSize(_t*this._pixelRatio,Et*this._pixelRatio),this._resizeTransmission(_t,Et),(Ft=this.transmissionDepthTarget)==null||Ft.setSize(_t*this._pixelRatio/2,Et*this._pixelRatio/2),this.pipeline.resize(_t,Et,At))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new dt$1(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:rt$1,magFilter:rt$1,wrapS:Xt,wrapT:Xt,depthBuffer:!1}))}_resizeTransmission(nt,st){var mt,gt;(mt=this.transmissionRenderTarget)==null||mt.setSize(nt*this._pixelRatio/(this.hdTransmission?1:2),st*this._pixelRatio/(this.hdTransmission?1:2)),(gt=this.aoRenderTarget)==null||gt.setSize(nt*this._pixelRatio/1,st*this._pixelRatio/1)}get hdTransmission(){return $e$1.transmissionLod.value===1}set hdTransmission(nt){$e$1.transmissionLod.value=nt===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new dt$1(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:dc,magFilter:rt$1,wrapS:Xt,wrapT:Xt,depthBuffer:!1}),this.transmissionDepthTarget=new dt$1(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:Vt,magFilter:Vt,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new dt$1(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Vt,magFilter:Vt,type:br,depthTexture:new ns(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(nt,st,mt){this.normalRenderTarget&&(this.setClearColor(0),mt.layers.enable(8),mt.layers.disable(0),mt.layers.disable(3),st.traverseEntity(gt=>{gt.layers.isEnabled(8)&&(gt.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),mt instanceof wr?Cx.uniforms.depthContrast.value=(mt.far-mt.near)/1e4:Cx.uniforms.depthContrast.value=1,st.overrideMaterial=Cx,this.render(st,mt),this.setClearColor(st.bgColor,st.bgColor.a),this.setRenderTarget(null),st.overrideMaterial=nt.wireframeState?_x:null,mt.layers.enable(0),mt.layers.enable(3),st.traverseEntity(gt=>{gt.layers.isEnabled(8)&&(gt.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(nt,st,mt=1){this.dummyCamera.updateCameraState(st.dataPatched),this.dummyCamera.matrix.copy(st.matrixWorld);let gt=st.height,_t=st.width,Et=this.viewportWidth/this.viewportHeight;_t<gt?_t=gt*Et:gt=_t/Et,this.dummyCamera.setViewplaneSize(_t,gt);for(let At=0;At<mt;At++)this.renderSplineScene(nt,this.dummyCamera)}renderSplineScene(nt,st,{sceneHelpers:mt=this.sceneHelpers,sceneHelpersOnTop:gt=this.sceneHelpersOnTop,overrideTransmission:_t=void 0,overrideNormal:Et=void 0}={}){var dr;let At=nt instanceof Hl?nt.activePage:nt,Rt=At.visible;At.visible=!0;let Ft=At.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(st)),this.setClearColor(At.bgColor,At.bgColor.a),At.penumbraSizeArray.forEach((Mr,Tr)=>{$e$1.penumbraSize.value[Tr]=Mr}),$e$1.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?$e$1.resolution.value.set(this.resolution.x,this.resolution.y):$e$1.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),Et!==void 0?($e$1.normalRenderTarget.value=Et,$e$1.normalRenderTargetDepth.value=X3):Ft.needsNormal()&&(this.createNormalRenderTarget(),$e$1.normalRenderTarget.value=this.normalRenderTarget.texture,$e$1.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(Ft,At,st));let Nt=At.data.ao,Bt=Nt.occlusion;if(Bt&&(this.createAORenderTarget(),$e$1.aoRenderTarget.value=this.aoRenderTarget.texture),$e$1.aoEnabled.value=Bt,this.pipeline.setAmbientOcclusionParams(Nt.occlusion,Nt.radius,Nt.bias,At.aoColor,At.fog!==null,At.backupFog.near,At.backupFog.far,Nt.aoFullRes&&!go),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&((dr=At.uiCanvas)==null?void 0:dr.enabled)&&At.uiCanvas.texture&&At.uiCanvas.texture.image.width>0){let Mr=this.getSize(Q3),Tr=this.getPixelRatio();(At.uiCanvas.width!==this.viewportWidth||At.uiCanvas.height!==this.viewportHeight||At.uiCanvas.dpr!==Tr)&&At.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight},Tr),At.uiCanvas.render(this),this.pipeline.uiOverlayPass.uiCanvas=At.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(Mr.x,Mr.y,Tr),this.pipeline.updateRenderToScreen()}else this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen();if(this.pipeline.logoOverlayPass.enabled){let Mr=this.getSize(Q3),Tr=this.getPixelRatio();this.pipeline.logoOverlayPass.uniforms.uResolution.value.set(Mr.x,Mr.y),this.pipeline.logoOverlayPass.uniforms.uDPR.value=Tr}let Gt=!1;if(_t!==void 0)$e$1.transmissionRenderTarget.value=_t,$e$1.transmissionRenderTargetDepth.value=X3,this.pipeline.setTransmissionPassEnabled(!1);else{let Mr=Ft.needsTransmission();Mr&&(this.transmissionRenderTarget===void 0&&(Gt=!0),this.createTransmissionRenderTarget(),$e$1.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,$e$1.aspectRatio.value=cR(this.viewportWidth,this.viewportHeight),$e$1.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(Mr)}st.layers.enable(3),st.layers.enable(8),this.pipeline.sceneHelpers=mt,this.pipeline.sceneHelpersOnTop=gt,this.pipeline.scene=At,this.pipeline.camera=st,Gt&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==At.postprocessing&&(this.pipeline.updatePostprocessing(At.postprocessing),!mt&&!gt&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),At.overrideMaterial=Ft.wireframeState?_x:null,this.pipeline.render(),$e$1.frameIndex.value=($e$1.frameIndex.value+1)%16,st instanceof wr&&st.copyHistory(),At.visible=Rt}renderFromSceneForSceneTransitionPass(nt,st,mt){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(nt,st),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=mt,this.sceneTransitionTimeRemaining=mt,this.pipeline.renderToScreen=!0;let gt=this.pipeline.sceneTransitionPass.uniforms;gt.uDPR.value=window.devicePixelRatio,gt.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var nt,st,mt,gt,_t,Et;this._superDispose(),this.pipeline.dispose(),(nt=this.aoRenderTarget)==null||nt.dispose(),(st=this.transmissionRenderTarget)==null||st.dispose(),(mt=this.transmissionDepthTarget)==null||mt.dispose(),(gt=this.normalRenderTarget)==null||gt.dispose(),(Et=(_t=this.normalRenderTarget)==null?void 0:_t.depthTexture)==null||Et.dispose()}},xf=class extends Fo$1(Sy){constructor(nt,st=15,mt=10066329){super(nt,st,mt),this.object=nt,this.added=!1,this.name=`DirectionalLightHelper: ${nt.uuid}`}raycast(nt,st){Vo(this.object,xf.geometryHelper,nt,st)}},bf=class extends Fo$1(by){constructor(nt,st=15,mt=6710886){super(nt,st,mt),this.object=nt,this.name=`PointLightHelper: ${nt.uuid}`}raycast(nt,st){Vo(this.object,bf.geometryHelper,nt,st)}},Dx=class extends Fo$1(xy){constructor(nt,st=6710886){super(nt,st),this.object=nt,this.name=`SpotLightHelper: ${nt.uuid}`}raycast(nt,st){Vo(this.object,Dx.geometryHelper,nt,st)}update(){if(this.object!==void 0){let nt=Dx._vector,st=this.object.distance?this.object.distance:1e3,mt=st*Math.tan(this.object.angle);this.cone.scale.set(mt,mt,st),nt.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(nt);let gt=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let _t=0,Et=this.cone.material.length;_t<Et;_t++)this.cone.material[_t].color.set(gt);else this.cone.material.color.set(gt)}}},Om=Dx;Om._vector=new E$6;var Sf=class extends sn{constructor(){super(),this.caretIndex=0,this._caretVisibleAlpha=1,this._selectionVisibleAlpha=.3,this.current={start:0,end:void 0},this.matrixAutoUpdate=!1,this.caretMesh=new Ut(new Li(1,1),new on({transparent:!0,opacity:0,side:fi})),this.add(this.caretMesh),this.selectionMesh=new Ut(new Li(1,1),new on({color:2857471,transparent:!0,depthTest:!1,depthWrite:!1,opacity:0,side:fi})),this.add(this.selectionMesh),this.hide()}get caretHeight(){var nt;return((nt=this.object)==null?void 0:nt.AD)??0}show(nt){this.visible=!0,this.object=nt,this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.y=-this.caretHeight*.5,this.setCaretPosition(this.caretIndex),this.update()}hide(){this.visible=!1}update(){if(this.object===void 0)return;this.updateHelperMatrix();let{depth:nt}=this.object.geometry.userData.parameters;this.caretMesh.position.z=nt,this.selectionMesh.position.z=nt}updateHelperMatrix(){if(this.object===void 0)return;let nt=this.object,st=nt.parent;st!==null&&st.updateWorldMatrix(!0,!1),nt.matrixAutoUpdate&&nt.updateMatrix(),st!==null?(this.matrixWorld.multiplyMatrices(st.matrixWorld,nt.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,nt.matrix)):this.matrixWorld.multiplyMatrices(nt.hiddenMatrix,nt.matrix),this.matrix.copy(this.matrixWorld);for(let mt of this.children)mt.matrixWorld.copy(this.matrixWorld);nt.updateWorldMatrix(!0,!0)}setCaretColor(nt){let st=this.caretMesh.material;st.color.setRGB(nt.r,nt.g,nt.b);let mt=this._caretVisibleAlpha===st.opacity;this._caretVisibleAlpha=nt.a,mt&&(st.opacity=this._caretVisibleAlpha)}setSelectionColor(nt){this.selectionMesh.material.color.setRGB(nt.r,nt.g,nt.b)}setCaretPosition(nt,st={}){if(this.object===void 0)return;this.caretIndex=nt;let mt=this.object.wrappedText,[gt,_t]=Ix(mt,nt),[Et,At]=nt>0?Ix(mt,nt-1):[null,null];(nt>0&&mt.length?mt[Et].charAt(At):null)===`
`&&(gt++,_t=0),this.current.start=nt,this.current.end=void 0;let[Rt,Ft]=zE(this.object,gt,_t),{AD:Nt,descender:Bt}=this.object,Gt=Bt+Nt*.5,{width:dr,height:Mr,depth:Tr}=this.object.geometry.userData.parameters,zr=typeof dr=="string"?0:dr,Fr=typeof Mr=="string"?0:Mr;this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.set(Rt-zr*.5,Ft+Gt+Fr*.5,Tr),this.hideSelectionMesh(),this.showCaretMesh()}setSelection(nt,st){if(this.object===void 0)return;let mt=this.object.wrappedText;this.current.start=nt,this.current.end=st;let gt=[],_t=[],Et=vK(mt,nt,st),{lineHeight:At,AD:Rt,descender:Ft}=this.object,Nt=Ft+Rt*.5-At*.5;for(let[Fr,Nr,tn]of Et)if(Nr!==tn){let[rn,Tn]=zE(this.object,Fr,Nr),[$n,un]=zE(this.object,Fr,tn);Tn+=Nt,un+=Nt,un+=At;let es=gt.length/3;gt.push(rn,Tn,0),gt.push($n,Tn,0),gt.push($n,un,0),gt.push(rn,un,0),_t.push(es+0,es+1,es+2),_t.push(es+2,es+3,es+0)}let Bt=new _e$1;Bt.setIndex(_t),Bt.setAttribute("position",new Me$1(gt,3));let{width:Gt,height:dr,depth:Mr}=this.object.geometry.userData.parameters,Tr=typeof Gt=="string"?0:Gt,zr=typeof dr=="string"?0:dr;this.selectionMesh.geometry.dispose(),this.selectionMesh.geometry=Bt,this.selectionMesh.position.x=-Tr*.5,this.selectionMesh.position.y=zr*.5,this.selectionMesh.position.z=Mr,this.showSelectionMesh(),this.hideCaretMesh()}getSelectionFromPosition(nt,st,mt="previous"){if(this.object===void 0||this.object.font===void 0)return;let gt=this.object.wrappedText,_t=gt.length,Et=this.object.lineHeight,At=_t*Et,{height:Rt,verticalAlign:Ft}=this.object.geometry.userData.parameters,Nt=typeof Rt=="string"?0:Rt,Bt=0;Ft===3?Bt=Nt-At:Ft===2&&(Bt=Nt*.5-At*.5);let Gt=Math.min(Math.floor(Math.max(Math.min(-st-Bt,At),0)/Et),_t-1),dr=this.object.charCoords[Gt],Mr=this.object.charWidths[Gt],Tr=0,zr=!1;if(mt==="previous"){for(let Fr=0;Fr<dr.length;Fr++)if(dr[Fr][0]+Mr[Fr]*.5-nt>0){Tr=Fr,zr=!0;break}}else if(mt==="closest"){let Fr=1/0;for(let Nr=0;Nr<dr.length;Nr++){let tn=dr[Nr][0]+Mr[Nr]*.5,rn=Math.abs(tn-nt);rn<Fr&&(Fr=rn,Tr=Nr,zr=!0)}}else for(let Fr=0;Fr<dr.length;Fr++){let Nr=dr[Fr][0],tn=dr[Fr][0]+Mr[Fr];if(nt>=Nr&&nt<tn){Tr=Fr,zr=!0;break}}return zr||(Tr=dr.length),{index:this.getGlobalIndexFromLineAndCharIndexes(gt,Gt,Tr),lineIndex:Gt,characterIndex:Tr}}getGlobalIndexFromLineAndCharIndexes(nt,st,mt){return nt.slice(0,st).reduce((gt,_t)=>gt+=_t.length,0)+mt}showSelectionMesh(){this.selectionMesh.material.opacity=this._selectionVisibleAlpha}hideSelectionMesh(){this.selectionMesh.material.opacity=0}showCaretMesh(){this.caretMesh.material.opacity=this._caretVisibleAlpha}hideCaretMesh(){this.caretMesh.material.opacity=0}};function zE(nt,st,mt){let{charCoords:gt,charWidths:_t,initialOffsetY:Et,lineHeight:At}=nt;if(gt[st]&&gt[st].length===0||gt.length===0){let Bt=0,{horizontalAlign:Gt}=nt.data.geometry,dr=nt.wrappedText,{width:Mr}=nt.geometry.userData.parameters;return dr.length===1&&dr[0].length===0&&(Gt===3?Bt=Mr*.5:Gt===2&&(Bt=Mr)),[Bt,Et-At*st]}let Rt=gt[st];if(Rt===void 0||Rt.length===0)return[0,0];let[Ft,Nt]=Rt[Math.min(mt,Rt.length-1)];return mt>=Rt.length&&(Ft+=_t[st][mt-1]),[Ft,Nt]}function Ix(nt,st){var gt;let mt=0;for(let _t=0;_t<nt.length;_t++){let Et=nt[_t],At=st-mt;if(At<=Et.length)return[_t,At];mt+=Et.length}return[Math.max(0,nt.length-1),((gt=nt[nt.length-1])==null?void 0:gt.length)??0]}function vK(nt,st,mt){let[gt,_t]=Ix(nt,st),[Et,At]=Ix(nt,mt),Rt=[];_t>=nt[gt].length&&(gt++,_t=0);for(let Ft=gt;Ft<=Et;Ft++){let Nt=nt[Ft],Bt=Ft===gt?_t:0,Gt=Ft===Et?At:Nt.length;Rt.push([Ft,Bt,Gt])}return Rt}function K3(nt,st){let mt=ri.fromHex(3223857),gt=.8;for(let _t of nt.layers){if(_t.data.type==="light"||_t.data.type==="displace"||_t.data.type==="fresnel"||_t.data.type==="matcap"||_t.data.type==="texture"||_t.data.type==="toon"||_t.data.type==="outline"||_t.data.type==="transmission"||_t.data.type==="noise")continue;let Et=typeof _t.data.alpha=="string"?Number(st.getVariable(_t.data.alpha)):_t.data.alpha;if(_t.data.type==="color"&&Et>.3){mt=xK(_t.data.color,st),gt=Et;break}else if((_t.data.type==="depth"||_t.data.type==="gradient")&&Et>.3){let At=bK(_t.data);mt={r:At[0],g:At[1],b:At[2]},gt=typeof _t.data.alpha=="string"?1:_t.data.alpha;break}}return{...mt,a:gt}}function xK(nt,st){return typeof nt=="string"?st.data.colors[nt]:nt}function bK(nt){return nt.colors[0]}function SK(nt,st){nt.shadow.camera.right=st/2,nt.shadow.camera.left=-st/2,nt.shadow.camera.top=st/2,nt.shadow.camera.bottom=-st/2,nt.shadow.needsUpdate=!0}var wf=class extends sf(gy,xf){constructor(nt,st,mt){super(),this.super_Entity(nt,st),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let gt=this.shadow.camera;gt.top=1250,gt.bottom=-1250,gt.right=1250,gt.left=-1250,gt.near=-1e4,gt.far=2500;let _t=new ol(this.shadow.camera);_t.visible=!1,this.gizmos.shadowmap=_t}update(){this.shadow.camera.updateProjectionMatrix();for(let nt in this.gizmos){let st=this.gizmos[nt];st instanceof ol&&st.update()}}updateMatrixWorld(nt){super.updateMatrixWorld(nt),this.objectHelper&&this.objectHelper.update()}updateState(nt,st){this.updateState_Light(nt,st);let mt=nt.depth!==void 0&&nt.depth!==this.shadow.camera.far||nt.size!==void 0&&nt.size/2!==this.shadow.camera.right;nt.size!==void 0&&SK(this,nt.size),nt.shadowRadius!==void 0&&(this.shadow.radius=nt.shadowRadius),nt.shadowResolution!==void 0&&(this.shadow.mapSize.set(nt.shadowResolution,nt.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),nt.penumbraSize!==void 0&&st.scene.markPenumbraSizeDirty(),mt&&this.update()}},Z3=new E$6,J3=new E$6,$3=new Qe$1,Af=class extends sf(py,Om){constructor(nt,st,mt){super(),this.super_Entity(nt,st),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let gt=this.shadow.camera;gt.fov=we$1.RAD2DEG*2*this.angle,gt.aspect=1,gt.near=100,gt.far=2500;let _t=new ol(this.shadow.camera);_t.visible=!1,this.gizmos.shadowmap=_t,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let nt in this.gizmos){let st=this.gizmos[nt];st instanceof ol&&st.update()}}updateMatrixWorld(nt){super.updateMatrixWorld(nt),J3.setFromMatrixPosition(this.matrixWorld),$3.setFromRotationMatrix(this.matrixWorld),Z3.copy(this.up).applyQuaternion($3).negate().multiplyScalar(this.distance),this.target.position.copy(J3).add(Z3),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(nt,st){this.updateState_Light(nt,st),nt.distance!==void 0&&(this.distance=nt.distance),nt.decay!==void 0&&(this.decay=nt.decay),nt.angle!==void 0&&(this.angle=nt.angle),nt.penumbra!==void 0&&(this.penumbra=nt.penumbra),nt.shadowRadius!==void 0&&(this.shadow.radius=nt.shadowRadius),nt.penumbraSize!==void 0&&st.scene.markPenumbraSizeDirty(),nt.shadowResolution!==void 0&&(this.shadow.mapSize.set(nt.shadowResolution,nt.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function wK(nt){let st=(nt[0][0]+nt[1][1])/2,mt=(nt[0][0]-nt[1][1])/2,gt=(nt[1][0]+nt[0][1])/2,_t=(nt[1][0]-nt[0][1])/2,Et=Math.sqrt(st*st+_t*_t),At=Math.sqrt(mt*mt+gt*gt),Rt=Et+At,Ft=Et-At,Nt=Math.atan2(gt,mt),Bt=Math.atan2(_t,st),Gt=(Bt-Nt)/2,dr=(Bt+Nt)/2,Mr=[[Math.cos(dr),Math.sin(dr)],[-Math.sin(dr),Math.cos(dr)]],Tr=[[Rt,0],[0,Ft]],zr=[[Math.cos(Gt),Math.sin(Gt)],[-Math.sin(Gt),Math.cos(Gt)]];return Mr[0][0]*=-1,Mr[0][1]*=-1,zr[0][0]*=-1,zr[1][0]*=-1,[Mr,Tr,zr]}function Ox(nt,st){return[[nt[0][0]*st[0][0]+nt[0][1]*st[1][0],nt[0][0]*st[0][1]+nt[0][1]*st[1][1]],[nt[1][0]*st[0][0]+nt[1][1]*st[1][0],nt[1][0]*st[0][1]+nt[1][1]*st[1][1]]]}function eL(nt){return[[nt[0][0],nt[1][0]],[nt[0][1],nt[1][1]]]}function tL(nt){let[st,mt,gt]=wK(nt),_t=Ox(st,eL(gt)),Et=Ox(Ox(gt,mt),eL(gt)),At=Math.atan2(_t[1][0],_t[0][0]),Rt=[Et[0][0],Et[1][1]],Ft=[Et[0][1]/Et[1][1],Et[1][0]/Et[0][0]];return{rotation:At,scale:Rt,shear:Ft}}function rL({rotation:nt,scale:st,shear:mt}){let gt=Math.cos(nt),_t=Math.sin(nt),Et=[[gt,-_t],[_t,gt]],At=[[st[0],mt[0]*st[1]],[mt[1]*st[0],st[1]]],Rt=Ox(Et,At);return[Rt[0][0],Rt[1][0],Rt[0][1],Rt[1][1]]}var St;(nt=>{function st(){return[1,0,0,0,1,0,0,0,1]}nt.identity=st;function mt(un,es=nt.identity()){for(let kn=0,ts=un.length;kn<ts;kn++)es[kn]=un[kn];return es}nt.copy=mt;function gt(un,es,kn,ts,Ko,ds){return nt.setAbcdef(nt.identity(),un,es,kn,ts,Ko,ds)}nt.create=gt;function _t(un,es,kn,ts,Ko,ds,Il){return un[0]=es,un[1]=ts,un[2]=ds,un[3]=kn,un[4]=Ko,un[5]=Il,un}nt.setAbcdef=_t;function Et(un,es){let[kn,ts,Ko,ds,Il,ru]=Rt(un),[uu,p0,X1,q0,W0,hu]=Rt(es),a1=uu*kn+p0*Ko,Vx=uu*ts+p0*ds,t0=X1*kn+q0*Ko,cu=X1*ts+q0*ds,lu=W0*kn+hu*Ko+Il,b0=W0*ts+hu*ds+ru;return nt.create(a1,Vx,t0,cu,lu,b0)}nt.append=Et;function At(un,es){let[kn,ts,Ko,ds,Il,ru]=Rt(un),[uu,p0,X1,q0,W0,hu]=Rt(es),a1=kn,Vx=ts,t0=Ko,cu=ds;(uu!==1||p0!==0||X1!==0||q0!==1)&&(a1=kn*uu+ts*X1,Vx=kn*p0+ts*q0,t0=Ko*uu+ds*X1,cu=Ko*p0+ds*q0);let lu=Il*uu+ru*X1+W0,b0=Il*p0+ru*q0+hu;return nt.create(a1,Vx,t0,cu,lu,b0)}nt.prepend=At;function Rt(un){return[un[0],un[3],un[1],un[4],un[2],un[5]]}nt.getAbcdef=Rt;function Ft(un){let[es,kn,ts,Ko,ds,Il]=nt.getAbcdef(un),ru=es*Ko-kn*ts,uu=Ko/ru,p0=-kn/ru,X1=-ts/ru,q0=es/ru,W0=(ts*Il-Ko*ds)/ru,hu=-(es*Il-kn*ds)/ru;return nt.create(uu,p0,X1,q0,W0,hu)}nt.invert=Ft;function Nt([un,es],kn){let[ts,Ko,ds,Il,ru,uu]=nt.getAbcdef(kn);return[ts*un+ds*es+ru,Ko*un+Il*es+uu]}nt.apply=Nt;function Bt(un,es){let[kn,ts,Ko,ds,Il,ru]=nt.getAbcdef(es),uu=1/(kn*ds+Ko*-ts),[p0,X1]=un;return[ds*uu*p0+-Ko*uu*X1+(ru*Ko-Il*ds)*uu,kn*uu*X1+-ts*uu*p0+(-ru*kn+Il*ts)*uu]}nt.applyInverse=Bt;function Gt(un,es,kn=es){let[ts,Ko,ds,Il,ru,uu]=nt.getAbcdef(un);return nt.setAbcdef(un,ts*es,Ko*kn,ds*es,Il*kn,ru*es,uu*kn),un}nt.scale=Gt;function dr(un,es){let kn=Math.cos(es),ts=Math.sin(es),[Ko,ds,Il,ru,uu,p0]=nt.getAbcdef(un);return nt.setAbcdef(un,Ko*kn-ds*ts,Ko*ts+ds*kn,Il*kn-ru*ts,Il*ts+ru*kn,uu*kn-p0*ts,uu*ts+p0*kn),un}nt.rotate=dr;function Mr(un,es,kn){let[ts,Ko]=kn,ds=nt.translate(un,-ts,-Ko);return ds=nt.rotate(ds,es),ds=nt.translate(ds,ts,Ko),ds}nt.rotateAround=Mr;function Tr(un,es,kn){let[ts,Ko,ds,Il,ru,uu]=nt.getAbcdef(un);return nt.setAbcdef(un,ts,Ko,ds,Il,ru+es,uu+kn),un}nt.translate=Tr;function zr(un,es,kn){let[ts,Ko,ds,Il]=nt.getAbcdef(un);return nt.setAbcdef(un,ts,Ko,ds,Il,es,kn),un}nt.setTranslate=zr;function Fr(un,es,kn){let[ts,Ko,ds,Il]=nt.getAbcdef(un);return nt.setAbcdef(un,ts,Ko,ds,Il,es,kn),un}nt.setPosition=Fr;function Nr(un){let[es,kn,ts,Ko]=nt.getAbcdef(un),ds=Math.sqrt(es*es+kn*kn),Il=Math.sqrt(ts*ts+Ko*Ko);return[ds,Il]}nt.getScale=Nr;function tn(un){let[,,,,es,kn]=nt.getAbcdef(un);return[es,kn]}nt.getPosition=tn;function rn(un,es){return nt.decompose(un,es).rotation}nt.getRotation=rn;function Tn(un,es){let[kn,ts,Ko,ds,Il,ru]=nt.getAbcdef(un),{rotation:uu,scale:p0,shear:X1}=tL([[kn,Ko],[ts,ds]]);return{position:[Il+(es[0]*kn+es[1]*Ko)-es[0],ru+(es[0]*ts+es[1]*ds)-es[1]],scale:p0,rotation:uu,shear:X1,pivot:es}}nt.decompose=Tn;function $n(un,es,kn,ts,Ko=[0,0]){let[ds,Il]=un,[ru,uu]=ts,[p0,X1,q0,W0]=rL({rotation:kn,scale:es,shear:Ko}),hu=ds-(ru*p0+uu*q0)+ru,a1=Il-(ru*X1+uu*W0)+uu;return nt.create(p0,X1,q0,W0,hu,a1)}nt.compose=$n})(St||(St={}));var AK=Math.PI/180;function iL(nt,st,mt,gt,_t,Et){let At=nt-mt,Rt=st-gt;return At*At/(_t*_t)+Rt*Rt/(Et*Et)<=1}function nL(nt){return nt*AK}var tr=class{constructor(nt,st,mt){this.uuid=nt,this.data=st,this.localMatrix=St.identity(),this.worldMatrix=St.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new Wl,this._recursiveBBox=new Wl,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=Yc(),this.dpr=mt.dpr??1,this.dataPatched=st}project(nt,st){let mt=this.worldMatrix;return st&&(mt=St.append(st.worldMatrix,mt)),St.applyInverse(nt,mt)}intersects(nt,st,mt,gt=!1){return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([nt,st],mt),gt)}intersectsInLocalSpace(nt,st,mt=!1){let{min:gt,max:_t}=mt?this.recursiveBBox:this.singleBBox;return nt>=gt[0]&&nt<=_t[0]&&st>=gt[1]&&st<=_t[1]}applyTransforms(nt){nt.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=St.compose(this.position,this.scale,nL(this.rotation),Ea.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(nt,st,mt){let gt=this.parent;st&&gt!==null&&gt!==void 0&&gt.updateWorldMatrix(nt,!0,!1),nt&&this.updateLocalMatrix(),this.parent?this.worldMatrix=St.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=St.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return Ea.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(nt=>{nt.resetBBoxNeedsUpdateSelf()})}updateTransformState(nt){let st=!1;nt.position!==void 0&&(st=!0,this.position=nt.position),nt.rotation!==void 0&&(st=!0,this.rotation=nt.rotation),nt.scale!==void 0&&(st=!0,this.scale=nt.scale),nt.shear!==void 0&&(st=!0,this.shear=nt.shear),st&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(nt,st,mt){nt.type===0&&nt.props.visible!==void 0&&(this.visible=nt.props.visible),this.data=st,this.data=st;let gt=nt,_t=Lt(nt.path,["states","*"]);if(_t!==null){if(nt.type===0){let[Et]=_t;if((this==null?void 0:this.stateSelection)===Et){let At={...nt.props};if(delete At.name,Object.values(nt.props).some(Rt=>Rt===void 0)){let Rt=this.data;if(Rt!==void 0){let Ft=Sr.zoom(Rt,nt.path.slice(2));if(Ft)for(let Nt in nt.props)nt.props[Nt]===void 0&&Nt in Ft&&(At[Nt]=Ft[Nt])}}gt={...nt,props:At,path:nt.path.slice(2)}}}}else if(nt.type===0){let Et=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(Et!==void 0){if(nt.props.name!==void 0&&Et.name){let{name:Rt,...Ft}=Et;Et=Ft}let At=Sr.removeOverridden(nt.path,nt.props,Et);gt={...nt,props:At}}}this.updateByPatchedOpBase(gt,Aa.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),mt)}changeSelectedState(nt,st,mt=!1){if(!(this.data.states.length===0&&!mt)){for(let gt of this.data.states)Aa.toOps(this.data,gt.data).forEach(_t=>{let Et=Lh.replaceProps(_t,this.data);this.dataPatched=this.data,this.updateByPatchedOp(Et,this.data,st)});if(nt!==null){let gt=this.data.states.data(nt);gt&&(this.dataPatched=Aa.patch(this.data,gt),Aa.toOps(this.data,gt).forEach(_t=>{this.updateByPatchedOp(_t,this.dataPatched,st)}))}mt&&this.updateTransformState(this.dataPatched),this.stateSelection=nt}}updateState(nt,st){nt.name!==void 0&&(this.name=nt.name),nt.visible!==void 0&&(this.visible=nt.visible),this.updateTransformState(nt)}updateByPatchedOpBase(nt,st,mt){this.dataPatched=st,this.updateByPatchedOp(nt,st,mt)}updateByPatchedOp(nt,st,mt){nt.path.length===0&&nt.type===0&&this.updateState(nt.props,mt),this.requestRender()}traverseFrameAncestors(nt){this.traverseAncestors(st=>{st.data.type==="frame2d"&&nt(st)})}traverseAncestors(nt){let st=this.parent;for(;st;)nt(st),st=st.parent}requestRender(){this.traverseFrameAncestors(nt=>{nt.requestRender()})}clone(nt){let st=new tr(this.uuid,this.data,nt);return st.parent=void 0,st}addEventListener(nt,st){this.emitter.on(nt,st)}removeEventListener(nt,st){this.emitter.off(nt,st)}dispatchEvent(nt){this.emitter.emit(nt.type,{...nt,target:nt.target??this})}traverseSortNextHelper(){let nt=this.parent;if(nt){let st=nt.children;if(st){let mt=st.indexOf(this)+1;return st[mt]?st[mt]:nt.traverseSortNextHelper()}}}sortNext(){let nt=this.children;return nt&&nt.length>0&&nt[0]?nt[0]:this.traverseSortNextHelper()}isDescendantOf(nt){nt instanceof tr&&(nt=nt.uuid);let st=this;for(;st.parent;){if(st.parent.uuid===nt)return!0;st=st.parent}return!1}},Zi=class extends tr{constructor(nt,st,mt){super(nt,st,mt),this.uuid=nt,this.data=st,this.context=mt,this.children=[]}add(nt){nt.parent&&nt.parent instanceof Zi&&nt.parent.remove(nt),this.children.push(nt),nt.parent=this}remove(nt){let st=this.children.indexOf(nt);st>=0&&(this.children.splice(st,1),nt.parent=void 0)}traverse(nt){let st=nt(this);if(st!==!0)for(let mt of this.children)mt instanceof Zi?mt.traverse(nt):st=nt(mt)}intersectsChildrenHelper(nt,st,mt,gt,_t){for(let Et of this.children)if(Et.intersects(nt,st,mt,!1)&&(_t.push(Et),gt)||Et instanceof Zi&&Et.intersectsChildrenHelper(nt,st,mt,gt,_t))return!0;return!1}intersectsChildren(nt,st,mt,gt=!1,_t=[],Et=!1){return this.intersectsChildrenHelper(nt,st,mt,gt,_t),_t}intersectsChildrenHelperReverse(nt,st,mt,gt,_t){for(let Et of this.children)if(Et instanceof Zi&&Et.intersectsChildrenHelperReverse(nt,st,mt,gt,_t)||Et.intersects(nt,st,mt,!1)&&(_t.push(Et),gt))return!0;return!1}intersectsChildrenReverse(nt,st,mt,gt=!1,_t=[],Et=!1){return this.intersectsChildrenHelperReverse(nt,st,mt,gt,_t),_t}updateWorldMatrix(nt,st,mt){if(super.updateWorldMatrix(nt,st,mt),mt&&this.children)for(let gt of this.children)gt.updateWorldMatrix(nt,!1,!0)}find(nt){let st;return this.traverse(mt=>{mt.uuid===nt&&(st=mt)}),st}innerDrawChildren(nt){for(let st=this.children.length-1;st>=0;st--)this.children[st].draw(nt)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse(nt=>{nt.resetBBoxNeedsUpdateSelf()})}clone(nt){let st=new Zi(this.uuid,this.data,nt);st.parent=void 0;for(let mt of this.children)st.add(mt.clone(nt));return st}},Un=class extends Zi{constructor(nt,st,mt){super(nt,st,mt),this.uuid=nt,this.data=st,this.updateState(st,mt)}draw(nt){!this.visible||(nt.save(),this.applyTransforms(nt),this.innerDrawChildren(nt),nt.restore())}clone(nt){let st=new Un(this.uuid,this.data,nt);st.parent=void 0;for(let mt of this.children)st.add(mt.clone(nt));return st}};function EK(nt,st){let[[mt,gt],[_t,Et]]=nt,[[At,Rt],[Ft,Nt]]=st,Bt=(mt-_t)*(Rt-Nt)-(gt-Et)*(At-Ft);if(Bt===0)return!1;let Gt=((mt-At)*(Rt-Nt)-(gt-Rt)*(At-Ft))/Bt,dr=-((mt-_t)*(gt-Rt)-(gt-Et)*(mt-At))/Bt;return Gt>=0&&Gt<=1&&dr>=0&&dr<=1}var oL=[[-1,1],[-1,-1],[1,-1],[1,1]],sL=(nt,st,mt)=>{let gt=nt.getCenter(),_t=nt.getHalfSize(),Et=St.append(st,nt.worldMatrix);_t[0]===0&&_t[1]===0?mt.push(St.apply(gt,Et)):oL.forEach(At=>{let Rt=[At[0]*_t[0]+gt[0],At[1]*_t[1]+gt[1]];mt.push(St.apply(Rt,Et))})},Wl=class{constructor(){this.matrix=St.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(nt,st=!1){nt.updateWorldMatrix(),this.makeEmpty(),St.copy(nt.worldMatrix,this.matrix);let mt=St.invert(nt.worldMatrix);this.expandByObjectSize(nt,mt,st)}expandByObjectSize(nt,st,mt=!1){let gt=[];mt===!0&&nt instanceof Zi?nt.traverse(_t=>{_t.visible&&sL(_t,st,gt)}):sL(nt,st,gt),this.setFromPoints(gt)}setFromSize(nt,st,mt){this.makeEmpty(),St.copy(mt,this.matrix),this.expandBySize(nt,st,mt)}expandBySize(nt,st,mt){[St.apply([0,0],mt),St.apply([0,st],mt),St.apply([nt,st],mt),St.apply([nt,0],mt)].forEach(gt=>this.expandByPoint(gt))}getCenter(){let[nt,st]=this.min,[mt,gt]=this.getHalfSize();return St.apply([nt+mt,st+gt],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[(this.max[0]-this.min[0])*.5,(this.max[1]-this.min[1])*.5]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(nt){this.makeEmpty();for(let st of nt)this.expandByPoint(st)}expandByPoint(nt){this.min=[Math.min(this.min[0],nt[0]),Math.min(this.min[1],nt[1])],this.max=[Math.max(this.max[0],nt[0]),Math.max(this.max[1],nt[1])]}computeVertices(){let[nt,st]=this.getHalfSize(),mt=this.getCenter(),[gt,_t,Et,At]=St.getAbcdef(this.matrix),Rt=St.create(gt,_t,Et,At,mt[0],mt[1]);this.vertices=oL.map(([Ft,Nt])=>St.apply([Ft*nt,Nt*st],Rt))}computeEdges(){this.edges=[];for(let nt=0,st=this.vertices.length;nt<st;++nt)this.edges.push([this.vertices[nt],this.vertices[(nt+1)%st]])}project(nt,st){let mt=this.matrix;return st&&(mt=St.append(st.worldMatrix,mt)),St.applyInverse(nt,mt)}intersects(nt,st,mt){return this.intersectsInLocalSpace(...this.project([nt,st],mt))}intersectsInLocalSpace(nt,st){let{min:mt,max:gt}=this;return nt>=mt[0]&&nt<=gt[0]&&st>=mt[1]&&st<=gt[1]}containsPoint(nt){let[st,mt]=nt,[gt,_t]=this.min,[Et,At]=this.max;return st>=gt&&st<=Et&&mt>=_t&&mt<=At}intersectsBBox2D(nt){for(let st=0,mt=this.edges.length;st<mt;st++){let gt=this.edges[st];for(let _t=0,Et=nt.edges.length;_t<Et;_t++){let At=nt.edges[_t];if(EK(gt,At))return!0}}for(let st=0,mt=nt.vertices.length;st<mt;st++){let gt=nt.vertices[st];if(this.containsPoint(gt))return!0}return!1}ensureMinMax(){let nt=this.min,st=this.max;this.min=[Math.min(nt[0],st[0]),Math.min(nt[1],st[1])],this.max=[Math.max(nt[0],st[0]),Math.max(nt[1],st[1])]}copy(nt){this.min=[...nt.min],this.max=[...nt.max],St.copy(nt.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let nt=new Wl;return nt.copy(this),nt}},lL,cL=new Promise(nt=>{lL=nt}),aL=!1,Rx;function uL(){if(aL)return;if(Rx)return Rx;async function nt(){let st=await __vitePreload(()=>import("./ui-L7l3pL7d.js"),[]);lL(st.default??st),aL=!0}return Rx=nt(),Rx}function GE(nt){let st=!1;return nt.scene.objects.traverse((mt,gt)=>{(gt.type==="Mesh"&&gt.geometry.type==="UIGeometry"||gt.type==="Page"&&gt.uiFrame!==void 0)&&(st=!0)}),st}var pt$1,kE;async function MK(nt){let st=await cL;pt$1||(kE||(kE=st({locateFile:()=>nt})),pt$1=await kE)}var hL=St.identity(),Rm=class{constructor(nt,st=1){this.canvas=nt,this._dpr=st,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=bt$1.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=bt$1.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let mt=nt.getBoundingClientRect();nt.width=mt.width*st,nt.height=mt.height*st}catch{console.log(nt.width,st)}this._currentM3Transform=hL,this._currentTransform=new Float32Array(hL)}get dpr(){return this._dpr}set dpr(nt){this._dpr=nt,this._isSizeDirty=!0}async init(){var nt,st;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await MK(this.wasmURL),this._surface=pt$1.MakeWebGLCanvasSurface(this.canvas),this.ctx=(nt=this._surface)==null?void 0:nt.getCanvas(),this._paint=new pt$1.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(pt$1.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(pt$1.PaintStyle.Stroke),(st=this.ctx)==null||st.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(nt){this._currentM3Transform=nt,this._currentTransform.set(nt)}async loadFont(nt,st){let mt=await(await fetch(nt)).arrayBuffer();this.registerFont(mt,st)}registerFont(nt,st){if(this._fonts.has(st))return;let mt=pt$1.FontMgr.FromData(nt);if(mt)this._fonts.set(st,mt);else throw new Error("Invalid font data for "+st)}get width(){return this._width}get height(){return this._height}set strokeColor(nt){this._paintStroke&&this._paintStroke.setColor(Lx(nt),pt$1.ColorSpace.DISPLAY_P3)}set fillColor(nt){this._paintFill&&this._paintFill.setColor(Lx(nt),pt$1.ColorSpace.DISPLAY_P3)}set lineWidth(nt){this._paintStroke&&this._paintStroke.setStrokeWidth(this._strokeMode==="center"?nt:nt*2)}set strokeMode(nt){this._strokeMode=nt}set dropShadowBlur(nt){this._dropShadowBlur=nt}set dropShadowColor(nt){this._dropShadowColor=nt}set dropShadowOffsetX(nt){this._dropShadowOffsetX=nt}set dropShadowOffsetY(nt){this._dropShadowOffsetY=nt}set innerShadowBlur(nt){this._innerShadowBlur=nt}set innerShadowColor(nt){this._innerShadowColor=nt}set innerShadowOffsetX(nt){this._innerShadowOffsetX=nt}set innerShadowOffsetY(nt){this._innerShadowOffsetY=nt}set innerShadowSpread(nt){this._innerShadowSpread=nt}set layerBlur(nt){this._layerBlur=nt}set backgroundBlur(nt){this._backgroundBlur=nt}clear(){var nt;(nt=this.ctx)==null||nt.clear(pt$1.TRANSPARENT)}save(){var nt;(nt=this.ctx)==null||nt.save()}restore(){var nt;(nt=this.ctx)==null||nt.restore()}beginPath(){var nt;(nt=this._currentPath)==null||nt.delete(),this._currentPath=new pt$1.Path}closePath(){let nt=this._currentPath;if(nt){if(nt.isEmpty())return;let st=nt.getBounds();(st[3]-st[1]||st[2]-st[0])&&nt.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(nt,st,mt,gt,_t=0,Et=0,At=0,Rt=0){var Nt,Bt;let Ft=pt$1.XYWHRect(nt,st,mt,gt);if(_t===0&&Et===0&&Rt===0&&At===0)(Nt=this.ctx)==null||Nt.clipRect(Ft,pt$1.ClipOp.Intersect,!0);else{let Gt=pt$1.RRectXY(Ft,_t,_t);Gt[4]=Gt[5]=_t,Gt[6]=Gt[7]=Et,Gt[8]=Gt[9]=At,Gt[10]=Gt[11]=Rt,(Bt=this.ctx)==null||Bt.clipRRect(Gt,pt$1.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let nt=St.invert(this.currentTransform);this.ctx.concat(nt);let st=St.translate(St.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(st),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(nt,st,mt=!0){var gt,_t,Et,At;if(this.ctx&&this._currentPath){let Rt,Ft=!1;if(mt&&this._hasDropShadow()){let Nt=nt.copy();Nt.setColor(Lx(this._dropShadowColor));let Bt;this._dropShadowBlur>0&&(Bt=pt$1.MaskFilter.MakeBlur(pt$1.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(((gt=this.camera)==null?void 0:gt.scale)??1),!1),Nt.setMaskFilter(Bt)),this.ctx.save(),this.ctx.clipPath(this._currentPath,pt$1.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),st(Nt),this.ctx.restore(),Nt.delete(),Bt==null||Bt.delete()}if(this._backgroundBlur>0&&mt){this.ctx.save(),this.ctx.clipPath(this._currentPath,pt$1.ClipOp.Intersect,!0);let Nt=pt$1.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,pt$1.TileMode.Clamp,null),Bt=nt.copy();Bt.setImageFilter(Nt),Bt.setAlphaf(1);let Gt=this._currentPath.computeTightBounds();this.ctx.saveLayer(Bt,Gt,null,pt$1.SaveLayerInitWithPrevious),this.ctx.drawColor(nt.getColor()),this.ctx.restore(),this.ctx.restore(),Bt.delete(),Nt.delete(),Ft=!0}if(this._layerBlur>0){let Nt=nt.copy();Rt=pt$1.MaskFilter.MakeBlur(pt$1.BlurStyle.Normal,this._layerBlur*this.dpr*(((_t=this.camera)==null?void 0:_t.scale)??1),!1),Nt.setMaskFilter(Rt),st(Nt),Nt.delete(),Rt.delete(),Ft=!0}if(Ft||st(nt),mt&&this._hasInnerShadow()){let Nt=new pt$1.Paint;Nt.setAntiAlias(!0),Nt.setStyle(pt$1.PaintStyle.Fill),Nt.setColor(Lx(this._innerShadowColor));let Bt;this._innerShadowBlur>0&&(Bt=pt$1.MaskFilter.MakeBlur(pt$1.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(((Et=this.camera)==null?void 0:Et.scale)??1),!1),Nt.setMaskFilter(Bt));let Gt=this._currentPath.computeTightBounds(),[dr,Mr,Tr,zr]=Gt,Fr=Tr-dr,Nr=zr-Mr;this.ctx.save(),this.ctx.clipPath(this._currentPath,pt$1.ClipOp.Intersect,!0),this.ctx.saveLayer(Nt,Gt,null,pt$1.SaveLayerInitWithPrevious),(At=this.ctx)==null||At.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(pt$1.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+Fr+Math.abs(this._innerShadowOffsetX*2),2e3+Nr+Math.abs(this._innerShadowOffsetY*2)),Nt),Nt.setBlendMode(pt$1.BlendMode.Clear),this.ctx.drawPath(this._currentPath,Nt),this.ctx.restore(),this.ctx.restore(),Nt.delete(),Bt==null||Bt.delete()}}}_paintInner(nt,st=!0){if(this.ctx&&this._currentPath&&nt){let mt=this.ctx,gt=this._currentPath;this._applyEffectsToPaint(nt,_t=>{let Et=!1;!st&&this._strokeMode!=="center"&&(mt.save(),mt.clipPath(gt,this._strokeMode==="outside"?pt$1.ClipOp.Difference:pt$1.ClipOp.Intersect,!0),Et=!0),mt.drawPath(gt,_t),Et&&mt.restore()},st)}}_hasDropShadow(){var nt;return((nt=this._dropShadowColor)==null?void 0:nt.a)>0}_hasInnerShadow(){var nt;return((nt=this._innerShadowColor)==null?void 0:nt.a)>0}path(nt){var st;(st=this._currentPath)==null||st.addPath(pt$1.Path.MakeFromSVGString(nt))}ellipse(nt,st,mt,gt,_t,Et,At,Rt){var Nt;if(!dL([nt,st,mt,gt])||!this._currentPath)return;if(mt<0||gt<0)throw Error("radii cannot be negative");let Ft=pt$1.XYWHRect(nt-mt,st-gt,mt*2,gt*2);(Nt=this._currentPath)==null||Nt.addOval(Ft)}rect(nt,st,mt,gt,_t=0,Et=0,At=0,Rt=0){var Nt,Bt;let Ft=pt$1.XYWHRect(nt,st,mt,gt);if(dL(Ft))if(_t===0&&Et===0&&Rt===0&&At===0)(Nt=this._currentPath)==null||Nt.addRect(Ft);else{let Gt=pt$1.RRectXY(Ft,_t,_t);Gt[4]=Gt[5]=_t,Gt[6]=Gt[7]=Et,Gt[8]=Gt[9]=At,Gt[10]=Gt[11]=Rt,(Bt=this._currentPath)==null||Bt.addRRect(Gt)}}getHorizontalAlign(nt){switch(nt){case 2:return pt$1.TextAlign.Right;case 3:return pt$1.TextAlign.Center;case 4:return pt$1.TextAlign.Justify;case 1:default:return pt$1.TextAlign.Left}}drawTextInner(nt,st,mt,[gt,_t,Et,At],Rt,Ft,Nt=!0){let Bt=0,{ctx:Gt}=this;if(!Gt)return Bt;let dr=Ft.copy(),Mr=Ft.copy();return Mr.setAlphaf(0),this._applyEffectsToPaint(dr,Tr=>{st.pushPaintStyle(mt,Tr,Mr),st.addText(nt);let zr=st.build();zr.layout(Et);let Fr=_t;Rt===2?Fr+=(At-zr.getHeight())/2:Rt===3&&(Fr+=At-zr.getHeight()),Gt.drawParagraph(zr,gt,Fr),Bt=zr.getHeight(),st.reset(),zr.delete()},Nt),dr.delete(),Mr.delete(),Bt}drawText(nt,st){let mt=0,gt=this._fonts.get(st.font),{ctx:_t,_paintFill:Et,_paintStroke:At}=this;if(gt&&_t){let Rt=new pt$1.TextStyle({fontFamilies:[st.font],fontSize:st.fontSize,heightMultiplier:st.lineHeight,letterSpacing:st.letterSpacing}),Ft=new pt$1.ParagraphStyle({textStyle:Rt,textAlign:this.getHorizontalAlign(st.horizontalAlign)}),Nt=pt$1.XYWHRect(st.x,st.y,st.width,st.height),Bt=pt$1.ParagraphBuilder.Make(Ft,gt);Et&&(mt=this.drawTextInner(nt,Bt,Rt,Nt,st.verticalAlign,Et,!0)),At&&(mt=this.drawTextInner(nt,Bt,Rt,Nt,st.verticalAlign,At,!1)),Bt.delete()}return{height:mt}}render(){var nt;(nt=this._surface)==null||nt.flush()}moveTo(nt,st){var mt;(mt=this._currentPath)==null||mt.moveTo(nt,st)}lineTo(nt,st){var mt;(mt=this._currentPath)==null||mt.lineTo(nt,st)}bezierCurveTo(nt,st,mt,gt,_t,Et){var At;(At=this._currentPath)==null||At.cubicTo(nt,st,mt,gt,_t,Et)}quadraticCurveTo(nt,st,mt,gt){var _t;(_t=this._currentPath)==null||_t.quadTo(nt,st,mt,gt)}setTransform(nt,st=!1){var _t,Et,At,Rt,Ft;if(!this.ctx)return;let mt=this.ctx.getTotalMatrix(),gt=St.invert(mt);if(gt&&this.ctx.concat(gt),(_t=this.ctx)==null||_t.scale(this.dpr,this.dpr),((Et=this.camera)==null?void 0:Et.enabled)&&((At=this.ctx)==null||At.concat(this.camera.worldMatrix),st)){let Nt=St.getScale(this.camera.worldMatrix);(Rt=this.ctx)==null||Rt.scale(1/Nt[0],1/Nt[1])}(Ft=this.ctx)==null||Ft.concat(nt),this.currentTransform=nt}transform(nt){var st;(st=this.ctx)==null||st.concat(nt)}setSize(nt,st){var mt;!this._isSizeDirty&&nt===this._width&&st===this._height||(this._isSizeDirty=!1,this._width=nt,this._height=st,this.canvas.style.width=nt+"px",this.canvas.style.height=st+"px",this.canvas.width=nt*this.dpr,this.canvas.height=st*this.dpr,this._surface&&(this._surface=pt$1.MakeWebGLCanvasSurface(this.canvas),this.ctx=(mt=this._surface)==null?void 0:mt.getCanvas()))}};function dL(nt){for(let st=0;st<nt.length;st++)if(nt[st]!==void 0&&!Number.isFinite(nt[st]))return!1;return!0}function Lx({r:nt,g:st,b:mt,a:gt}){return pt$1.Color4f(nt,st,mt,gt)}var Lm=class{constructor(nt,st,mt){this.uuid=nt,this.data=st,this.enabled=!1,this.color=bt$1.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(st)}update(nt){nt.color!==void 0&&(this.color=nt.color),nt.enabled!==void 0&&(this.enabled=nt.enabled),nt.blurRadius!==void 0&&(this.blurRadius=nt.blurRadius),nt.offset!==void 0&&(this.offset=nt.offset),nt.spread!==void 0&&(this.spread=nt.spread)}},Bm=class{constructor(nt,st,mt){this.uuid=nt,this.data=st,this.enabled=!1,this.radius=0,this.update(st)}update(nt){nt.enabled!==void 0&&(this.enabled=nt.enabled),nt.radius!==void 0&&(this.radius=nt.radius)}},Bx=class{constructor(nt,st,mt){this.uuid=nt,this.data=st,this.enabled=!1,this.color=bt$1.transparent,this.update(st)}update(nt){nt.enabled!==void 0&&(this.enabled=nt.enabled),nt.color!==void 0&&(this.color=nt.color)}},Nx=class{constructor(nt,st,mt){this.uuid=nt,this.data=st,this.enabled=!1,this.color=bt$1.transparent,this.thickness=0,this.mode="inside",this.update(st)}update(nt){nt.enabled!==void 0&&(this.enabled=nt.enabled),nt.color!==void 0&&(this.color=nt.color),nt.thickness!==void 0&&(this.thickness=nt.thickness),nt.mode!==void 0&&(this.mode=nt.mode)}},Ar=class extends tr{constructor(nt,st,mt){super(nt,st,mt),this.uuid=nt,this.data=st,this.autoClose=!0,this.fill=new Bx(nt+"-fill",st.fill,mt),this.stroke=new Nx(nt+"-stroke",st.stroke,mt),this.dropShadow=new Lm(nt+"-dropShadow",st.dropShadow,mt),this.innerShadow=new Lm(nt+"-innerShadow",st.innerShadow,mt),this.backgroundBlur=new Bm(nt+"-backgroundBlur",st.backgroundBlur,mt),this.layerBlur=new Bm(nt+"-layerBlur",st.layerBlur,mt)}applyFillStroke(nt){nt.fillColor=this.fill.enabled?this.fill.color:bt$1.transparent,nt.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:bt$1.transparent,nt.strokeMode=this.stroke.mode,nt.lineWidth=this.stroke.thickness}applyFilters(nt){this.layerBlur.enabled?nt.layerBlur=this.layerBlur.radius*5:nt.layerBlur=0,this.backgroundBlur.enabled?nt.backgroundBlur=this.backgroundBlur.radius*5:nt.backgroundBlur=0,this.dropShadow.enabled?(nt.dropShadowBlur=this.dropShadow.blurRadius*5,nt.dropShadowColor=this.dropShadow.color,nt.dropShadowOffsetX=this.dropShadow.offset[0],nt.dropShadowOffsetY=this.dropShadow.offset[1]):nt.dropShadowColor=bt$1.transparent,this.innerShadow.enabled?(nt.innerShadowSpread=this.innerShadow.spread,nt.innerShadowBlur=this.innerShadow.blurRadius*5,nt.innerShadowColor=this.innerShadow.color,nt.innerShadowOffsetX=this.innerShadow.offset[0],nt.innerShadowOffsetY=this.innerShadow.offset[1]):nt.innerShadowColor=bt$1.transparent}innerDraw(nt){}draw(nt){!this.visible||(nt.save(),this.applyTransforms(nt),this.applyFilters(nt),this.applyFillStroke(nt),nt.beginPath(),this.innerDraw(nt),this.autoClose&&nt.closePath(),this.fill.enabled&&nt.fill(),this.stroke.enabled&&nt.stroke(),nt.restore())}updateByPatchedOp(nt,st,mt){super.updateByPatchedOp(nt,st,mt),nt.type===0&&(Lt(nt.path,["fill"])?this.fill.update(nt.props):Lt(nt.path,["stroke"])?this.stroke.update(nt.props):Lt(nt.path,["dropShadow"])?this.dropShadow.update(nt.props):Lt(nt.path,["innerShadow"])?this.innerShadow.update(nt.props):Lt(nt.path,["layerBlur"])?this.layerBlur.update(nt.props):Lt(nt.path,["backgroundBlur"])?this.backgroundBlur.update(nt.props):this.resetBBoxNeedsUpdate())}updateState(nt,st){super.updateState(nt,st),nt.fill!==void 0&&this.fill.update(nt.fill),nt.stroke!==void 0&&this.stroke.update(nt.stroke),nt.dropShadow!==void 0&&this.dropShadow.update(nt.dropShadow),nt.innerShadow!==void 0&&this.innerShadow.update(nt.innerShadow),nt.layerBlur!==void 0&&this.layerBlur.update(nt.layerBlur),nt.backgroundBlur!==void 0&&this.backgroundBlur.update(nt.backgroundBlur)}clone(nt){let st=new Ar(this.uuid,this.data,nt);return st.parent=void 0,st}},ql=class extends Ar{constructor(nt,st,mt){super(nt,st,mt),this.uuid=nt,this.data=st,this.width=0,this.height=0,this.updateState(st,mt)}innerDraw(nt){nt.ellipse(this.width*.5,this.height*.5,this.width*.5,this.height*.5,0,0,Math.PI*2)}intersectsInLocalSpace(nt,st){return iL(nt,st,this.width*.5,this.height*.5,this.width*.5,this.height*.5)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(nt){let st=!1;nt.width!==void 0&&(this.width=typeof nt.width=="number"?nt.width:this.width,st=!0),nt.height!==void 0&&(this.height=typeof nt.height=="number"?nt.height:this.height,st=!0),st&&this.updateWorldMatrix(!0,!1,!0)}updateState(nt,st){super.updateState(nt,st),this.updateSizeState(nt)}clone(nt){let st=new ql(this.uuid,this.data,nt);return st.parent=void 0,st}},As=class extends Ar{constructor(nt,st,mt){super(nt,st,mt),this.uuid=nt,this.data=st,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(st,mt)}innerDraw(nt){nt.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(nt){nt.cornerRadius!==void 0&&(this.cornerRadius=nt.cornerRadius)}updateSizeState(nt){let st=!1;nt.width!==void 0&&(this.width=typeof nt.width=="number"?nt.width:this.width,st=!0),nt.height!==void 0&&(this.height=typeof nt.height=="number"?nt.height:this.height,st=!0),st&&this.updateWorldMatrix(!0,!1,!0)}updateState(nt,st){super.updateState(nt,st),this.updateSizeState(nt),this.updateCornerState(nt)}clone(nt){let st=new As(this.uuid,this.data,nt);return st.parent=void 0,st}},Yl=class extends Ar{constructor(nt,st,mt){super(nt,st,mt),this.uuid=nt,this.data=st,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(st,mt)}get textHeight(){return this._textHeight}applyFillStroke(nt){nt.fillColor=this.fill.enabled?this.fill.color:bt$1.transparent,nt.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:bt$1.transparent,nt.strokeMode="center",nt.lineWidth=this.stroke.thickness}innerDraw(nt){var Et;(Et=this._fontHolder)!=null&&Et.arrayBuffer&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&nt.registerFont(this._fontHolder.arrayBuffer,this.data.font);let st=this.data.textTransform,mt=this.data.text.textValue.toString(),gt=st===2?mt.toUpperCase():st===3?mt.toLowerCase():mt,{height:_t}=nt.drawText(gt,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:this.data.lineHeight??1,letterSpacing:this.data.letterSpacing??0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=_t}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(nt){let st=!1;nt.width!==void 0&&(this.width=typeof nt.width=="number"?nt.width:this.width,st=!0),nt.height!==void 0&&(this.height=typeof nt.height=="number"?nt.height:this.height,st=!0),st&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(nt,{shared:st}){nt.font!==void 0&&(this._fontHolder=st.getFont(nt.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then(()=>{this.requestRender()}))}updateState(nt,st){super.updateState(nt,st),this.updateSizeState(nt),this.updateFontState(nt,st)}clone(nt){let st=new Yl(this.uuid,this.data,nt);return st.parent=void 0,st}},Ef=class extends Ar{constructor(nt,st,mt){super(nt,st,mt),this.uuid=nt,this.data=st,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(st,mt)}computeExtremas(){this.curves.length===0&&this.computeCurves();let nt=this.curves.map(gt=>Fx.extremas(gt)),st=[1/0,1/0],mt=[-1/0,-1/0];for(let gt=0,_t=nt.length;gt<_t;gt++){let Et=nt[gt];Et[0][0]<st[0]&&(st[0]=Et[0][0]),Et[0][1]<st[1]&&(st[1]=Et[0][1]),Et[1][0]>mt[0]&&(mt[0]=Et[1][0]),Et[1][1]>mt[1]&&(mt[1]=Et[1][1])}return this.extremasBBox.min=[st[0],st[1]],this.extremasBBox.max=[mt[0],mt[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let mt=1,gt=this.data.points.length;mt<gt;mt++){let _t=this.data.points[mt].data,Et=this.data.points[mt-1].data,At={start:Et.position,cp1:Et.controlNext.position,cp2:_t.controlPrevious.position,end:_t.position};this.curves.push(At)}let nt=this.data.points[0].data,st=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let mt={start:st.position,cp1:st.controlNext.position,cp2:nt.controlPrevious.position,end:nt.position};this.curves.push(mt)}}getCenter(){let[nt,st]=this.extremasBBox.min,[mt,gt]=this.getHalfSize();return[nt+mt,st+gt]}getHalfSize(){let{min:nt,max:st}=this.extremasBBox;return[(st[0]-nt[0])*.5,(st[1]-nt[1])*.5]}innerDraw(nt){for(let gt=0,_t=this.data.points.length;gt<_t;gt++){let Et=this.data.points[gt].data;if(gt===0){let[At,Rt]=Et.position;nt.moveTo(At,Rt)}else{let At=this.data.points[gt-1].data,[Rt,Ft]=At.controlNext.position,[Nt,Bt]=Et.controlPrevious.position,[Gt,dr]=Et.position,Mr={start:At.position,cp1:At.controlNext.position,cp2:Et.controlPrevious.position,end:Et.position};Fx.derive(Mr),nt.bezierCurveTo(Rt,Ft,Nt,Bt,Gt,dr)}}let st=this.data.points[0].data,mt=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[gt,_t]=mt.controlNext.position,[Et,At]=st.controlPrevious.position,[Rt,Ft]=st.position;nt.bezierCurveTo(gt,_t,Et,At,Rt,Ft)}}updateState(nt,st){super.updateState(nt,st),this.computeExtremas()}clone(nt){let st=new Ef(this.uuid,this.data,nt);return st.parent=void 0,st}},Fx;(nt=>{function st(At){let Rt=At.start,Ft=At.cp1,Nt=At.cp2,Bt=At.end,Gt=[3*(Ft[0]-Rt[0]),3*(Ft[1]-Rt[1])],dr=[3*(Nt[0]-Ft[0]),3*(Nt[1]-Ft[1])],Mr=[3*(Bt[0]-Nt[0]),3*(Bt[1]-Nt[1])],Tr={start:Gt,cp:dr,end:Mr};return At.derivative=Tr,Tr.derivative=jE.derive(Tr),Tr}nt.derive=st;function mt(At,Rt,Ft,Nt=!1){let Bt=At-2*Rt+Ft;if(Bt!==0){let Gt=-Math.sqrt(Math.abs(Rt*Rt-At*Ft)),dr=-At+Rt,Mr=-(Gt+dr)/Bt,Tr=-(-Gt+dr)/Bt;return[Mr,Tr]}else if(Rt!==Ft&&Bt===0)return[(2*Rt-Ft)/(2*(Rt-Ft))];return[]}function gt(At){let Rt=At.derivative??nt.derive(At),Ft=Rt.start,Nt=Rt.cp,Bt=Rt.end;return[mt(Ft[0],Nt[0],Bt[0]),mt(Ft[1],Nt[1],Bt[1])]}nt.droot=gt;function _t(At){let[Rt,Ft]=nt.droot(At),Nt=[At.start[0],At.end[0]],Bt=[At.start[1],At.end[1]];for(let Gt of Rt)Nt.push(nt.compute(At,Math.min(1,Math.max(0,Gt)))[0]);for(let Gt of Ft)Bt.push(nt.compute(At,Math.min(1,Math.max(0,Gt)))[1]);return Nt.sort((Gt,dr)=>Gt-dr),Bt.sort((Gt,dr)=>Gt-dr),[[Nt[0],Bt[0]],[Nt[Nt.length-1],Bt[Bt.length-1]]]}nt.extremas=_t;function Et(At,Rt){if(Rt===0)return[...At.start];if(Rt===1)return[...At.end];let Ft=1-Rt,Nt=Ft*Ft,Bt=Rt*Rt,Gt=Nt*Ft,dr=Nt*Rt*3,Mr=Ft*Bt*3,Tr=Rt*Bt;return[Gt*At.start[0]+dr*At.cp1[0]+Mr*At.cp2[0]+Tr*At.end[0],Gt*At.start[1]+dr*At.cp1[1]+Mr*At.cp2[1]+Tr*At.end[1]]}nt.compute=Et})(Fx||(Fx={}));var jE;(nt=>{function st(_t){let Et=_t.start,At=_t.cp,Rt=_t.end,Ft=[2*(At[0]-Et[0]),2*(At[1]-Et[1])],Nt=[2*(Rt[0]-At[0]),2*(Rt[1]-At[1])],Bt={start:Ft,end:Nt};return Bt.derivative=HE.derive(Bt),_t.derivative=Bt,Bt}nt.derive=st;function mt(_t){let Et=_t.derivative??nt.derive(_t),At=Et.start,Rt=Et.end;return[At[0]!==Rt[0]?At[0]/(At[0]-Rt[0]):0,At[1]!==Rt[1]?At[1]/(At[1]-Rt[1]):0]}nt.droot=mt;function gt(_t,Et){if(Et===0)return[..._t.start];if(Et===1)return[..._t.end];let At=1-Et,Rt=At*At,Ft=Et*Et,Nt=Rt,Bt=At*Et*2,Gt=Ft;return[Nt*_t.start[0]+Bt*_t.cp[0]+Gt*_t.end[0],Nt*_t.start[1]+Bt*_t.cp[1]+Gt*_t.end[1]]}nt.compute=gt})(jE||(jE={}));var HE;(nt=>{function st(gt){let _t=gt.start,Et=gt.end,At=[Et[0]-_t[0],Et[1]-_t[1]];return gt.derivative=At,gt.derivative}nt.derive=st;function mt(gt,_t){if(_t===0)return[...gt.start];if(_t===1)return[...gt.end];let Et=gt.start,At=gt.end;return[Et[0]+(At[0]-Et[0])*_t,Et[1]+(At[1]-Et[1])*_t]}nt.compute=mt})(HE||(HE={}));var Ji=class extends Zi{constructor(nt,st,mt){super(nt,st,mt),this.uuid=nt,this.width=0,this.height=0,this.clipped=!0,this.background=new As(nt+"-background",Jh.defaultData,mt),this.background.parent=this,this.updateState(st,mt)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(nt){this.background.cornerRadius=nt}updateLocalMatrix(){var nt;super.updateLocalMatrix(),(nt=this.background)==null||nt.updateLocalMatrix()}updateWorldMatrix(nt,st,mt){var gt;super.updateWorldMatrix(nt,st,mt),(gt=this.background)==null||gt.updateWorldMatrix(nt,st,mt)}draw(nt){if(!this.visible)return;nt.save();let st=this.width,mt=this.height;this.applyTransforms(nt),this.background.width=st,this.background.height=mt,this.background.draw(nt),this.clipped&&nt.clipRect(0,0,st,mt,...this.cornerRadius),this.innerDrawChildren(nt),nt.restore()}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(nt){nt.cornerRadius!==void 0&&(this.cornerRadius=nt.cornerRadius)}updateSizeState(nt){let st=!1;nt.width!==void 0&&(this.width=typeof nt.width=="number"?nt.width:this.width,st=!0),nt.height!==void 0&&(this.height=typeof nt.height=="number"?nt.height:this.height,st=!0),st&&this.updateWorldMatrix(!0,!1,!0)}updateState(nt,st){super.updateState(nt,st),this.updateSizeState(nt),this.updateCornerState(nt),nt.fill!==void 0&&this.fill.update(nt.fill),nt.stroke!==void 0&&this.stroke.update(nt.stroke),nt.dropShadow!==void 0&&this.dropShadow.update(nt.dropShadow),nt.innerShadow!==void 0&&this.innerShadow.update(nt.innerShadow),nt.layerBlur!==void 0&&this.layerBlur.update(nt.layerBlur),nt.backgroundBlur!==void 0&&this.backgroundBlur.update(nt.backgroundBlur),nt.clipped!==void 0&&(this.clipped=nt.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(nt,st,mt){super.updateByPatchedOp(nt,st,mt),nt.type===0&&(Lt(nt.path,["fill"])?this.fill.update(nt.props):Lt(nt.path,["stroke"])?this.stroke.update(nt.props):Lt(nt.path,["dropShadow"])?this.dropShadow.update(nt.props):Lt(nt.path,["innerShadow"])?this.innerShadow.update(nt.props):Lt(nt.path,["layerBlur"])?this.layerBlur.update(nt.props):Lt(nt.path,["backgroundBlur"])?this.backgroundBlur.update(nt.props):this.resetBBoxNeedsUpdate())}clone(nt){let st=new Ji(this.uuid,this.data,nt);st.parent=void 0;for(let mt of this.children)st.add(mt.clone(nt));return st}},gL=Jo(WE(),1),Ba=class extends Ar{constructor(nt,st,mt){super(nt,st,mt),this.uuid=nt,this.data=st,this._pathBBox=new DOMRect,this.path="",this.updateState(st,mt),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let nt=document.createElementNS("http://www.w3.org/2000/svg","svg"),st=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(nt),st.setAttribute("d",this.path),nt.appendChild(st),this._pathBBox=st.getBBox(),nt.remove()}innerDraw(nt){nt.path(this.path)}intersectsInLocalSpace(nt,st){return nt>=this._pathBBox.x&&nt<=this._pathBBox.x+this._pathBBox.width&&st>=this._pathBBox.y&&st<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(nt,st){super.updateState(nt,st),nt.path!==void 0&&(this.path=nt.path,this.computeSVGBBox())}clone(nt){let st=new Ba(this.uuid,this.data,nt);return st.parent=void 0,st}};function yL(nt,st=1,mt=1){if(st<=0||mt<=0)return nt;let gt=(0,gL.parseSVG)(nt).map(_t=>{let Et={..._t};return"x"in Et&&(Et.x=Et.x*st),"y"in Et&&(Et.y=Et.y*mt),"x1"in Et&&(Et.x1=Et.x1*st),"x2"in Et&&(Et.x2=Et.x2*st),"y1"in Et&&(Et.y1=Et.y1*mt),"y2"in Et&&(Et.y2=Et.y2*mt),"rx"in Et&&(Et.rx=Et.rx*st),"ry"in Et&&(Et.ry=Et.ry*mt),Et});return vL(gt)}function vL(nt){let st=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"],mt;return nt.map(gt=>{let _t=[];st.forEach(At=>{if(At in gt){let Rt=gt[At]*1;_t.length&&Rt>=0&&_t.push(","),_t.push(Rt)}});let Et=(mt===gt.code?_t[0]<0?"":",":gt.code)+_t.join("");return mt=gt.code,Et}).join("")}function xL(nt,st,mt){switch(st.type){case"ellipse2d":return new ql(nt,st,mt);case"rectangle2d":return new As(nt,st,mt);case"text2d":return new Yl(nt,st,mt);case"vector2d":return new Ef(nt,st,mt);case"path2d":return new Ba(nt,st,mt);case"frame2d":return new Ji(nt,st,mt);case"group2d":default:return new Un(nt,st,mt)}}var qE=class{constructor(nt,st,mt){this.uuid=nt,this.data=st,this.group=new Un(qE.GROUP_ID,{...Hp.defaultData},mt),this.createChildrenObjects(st.objects,this.group,mt)}createObject(nt,st,mt,gt,_t,Et){let At=xL(nt,st,Et);At&&(gt.add(At),gt.children.splice(_t,0,gt.children.pop()),At.updateWorldMatrix(),mt.length>0&&(At instanceof Un||At instanceof Ji)&&this.createChildrenObjects(mt,At,Et))}createChildrenObjects(nt,st,mt){let gt=0;for(let _t of nt)this.createObject(_t.id,_t.data,_t.children,st,gt,mt),gt+=1}draw(nt){this.group.draw(nt)}updateEntityByOp(nt,st,mt,gt){let _t=this.find(nt);if(_t)try{_t.updateByOp(st,mt,{shared:gt})}catch(Et){console.error(Et)}}updateTreeByOp(nt,st){if(nt.path.length===0&&nt.type===7){let mt=nt.parent===null?this.group:this.find(nt.parent);mt!==void 0&&mt instanceof Zi&&(this.createObject(nt.id,nt.data,nt.children,mt,nt.localIndex,st),mt.requestRender())}else if(nt.path.length===0&&nt.type===8){let mt=this.find(nt.id);if(mt!==void 0&&mt.parent!==void 0&&mt.parent instanceof Zi){let gt=mt.parent;mt.resetBBoxNeedsUpdate(),gt==null||gt.remove(mt),gt==null||gt.requestRender()}}else if(nt.path.length===0&&nt.type===9){let mt=this.find(nt.id);if(mt!==void 0){let gt=mt.parent,_t=nt.parent===null?this:this.find(nt.parent);if(_t instanceof Zi||_t===this){_t.add(mt);let Et=nt.localIndex;_t.children.splice(Et,0,_t.children.pop()),mt.updateWorldMatrix(!0,!1,!0),gt==null||gt.requestRender(),mt.requestRender()}mt.resetBBoxNeedsUpdate()}}}add(nt){this.group.add(nt)}remove(nt){this.group.remove(nt)}traverse(nt){this.group.traverse(st=>{st!==this.group&&nt(st)})}intersectsChildren(nt,st,mt,gt=!1,_t=[]){return this.group.intersectsChildren(nt,st,mt,gt,_t,!0)}intersectsChildrenReverse(nt,st,mt,gt=!1,_t=[]){return this.group.intersectsChildrenReverse(nt,st,mt,gt,_t,!0)}find(nt){return this.group.find(nt)}get children(){return this.group.children}project(nt,st){return this.group.project(nt,st)}getWithSortKey(nt){let st=this.find(nt);if(st===void 0)return;let mt=[],gt=st;for(;gt!==this.group;){let _t=gt;gt=gt.parent;let Et=gt.children.indexOf(_t);mt.splice(0,0,Et)}return{entity:st,sortKey:mt}}getAllSorted(nt){let st=[];for(let mt of nt){let gt=this.getWithSortKey(mt.id);gt!==void 0&&st.push(gt)}return st.sort((mt,gt)=>rv(mt.sortKey,gt.sortKey)),st.map(mt=>mt.entity)}},eu=qE;eu.GROUP_ID="scene2d";function YE({constraints:nt,newParentWidth:st,newParentHeight:mt,initialParentWidth:gt,initialParentHeight:_t,objectInitialWidth:Et,objectInitialHeight:At,objectInitialPosition:Rt}){let{horizontalConstraint:Ft,verticalConstraint:Nt}=nt,Bt=st-gt,Gt=mt-_t,dr=Et,Mr=At,Tr=Rt[0],zr=Rt[1];if(Ft!==0){if(Ft===1)Tr+=Bt;else if(Ft===3)Tr+=Bt/2;else if(Ft===2)dr=Math.max(1,dr+Bt);else if(Ft===4){let Fr=st/gt;dr*=Fr,Tr*=Fr}}if(Nt!==0){if(Nt===1)zr+=Gt;else if(Nt===3)zr+=Gt/2;else if(Nt===2)Mr=Math.max(1,Mr+Gt);else if(Nt===4){let Fr=mt/_t;Mr*=Fr,zr*=Fr}}return{width:dr,height:Mr,position:[Tr,zr]}}Jo(WE(),1);var IK=`
	varying vec2 vUv;
	void main() {
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
	}`,OK=`
	uniform sampler2D tDiffuse;
	varying vec2 vUv;
	void main() {
		vec4 texel = texture2D( tDiffuse, vUv );
		gl_FragColor = texel;
	}`,RK=new Ja(-1,1,1,-1,0,1),KE=class extends _e$1{constructor(){super(),this.setAttribute("position",new Me$1([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Me$1([0,2,0,0,2,0],2))}},LK=new KE,ZE=class{constructor(nt){this._mesh=new Ut(LK,nt)}dispose(){this._mesh.geometry.dispose()}render(nt){nt.render(this._mesh,RK)}get material(){return this._mesh.material}set material(nt){this._mesh.material=nt}},bL=new it$1({defines:{},uniforms:{tDiffuse:new le$1(null)},vertexShader:IK,fragmentShader:OK}),BK=new ZE(bL),XE=null,QE=null,NK=()=>(XE===null&&(XE=document.createElement("canvas")),XE),FK=nt=>(QE===null&&(QE=new Rm(nt)),QE),VK=St.identity(),Mf=class{constructor(nt,st,mt,gt){this.uuid=nt,this.width=st,this.height=mt,this.context=gt,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let _t=this.width,Et=this.height,At=this.dpr;this.renderer.dpr=this.isScreenSpace?At:Math.floor(2048/Math.max(_t,Et)),this.renderer.setSize(_t,Et)},this.onFrameOverrideObjectEvent=_t=>{var Et,At;if(((Et=_t.target)==null?void 0:Et.uuid)!==void 0){let Rt=(At=this.frameRoot)==null?void 0:At.find(_t.target.uuid);Rt&&Rt.dispatchEvent({..._t,target:Rt})}},this.scene2d=new eu(we$1.generateUUID(),$v.defaultData,{dpr:window.devicePixelRatio,shared:gt.shared}),this.canvas=NK(),this.renderer=FK(this.canvas),this.promise=this.init(),this.renderTarget=new dt$1(1,1,{type:Wn,stencilBuffer:!1,depthBuffer:!1}),gt.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=gt.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new ly(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof Rm&&(this.renderer.wasmURL=z0.skiaWasmUrl),await this.renderer.init()}render(nt){var st,mt;if(this.isFrameDirty){this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),(st=this.frameOverride)==null||st.draw(this.renderer),this.renderer.render(),bL.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let gt=nt.getRenderTarget();nt.setRenderTarget(this.renderTarget),nt.clear(),BK.render(nt),nt.setRenderTarget(gt),(mt=this.textureHolder)==null||mt.setNeedsUpdate(!0)}}updateEntity2DByOp(nt,st,mt,gt){this.scene2d.updateEntityByOp(nt,st,mt,gt),this.applySize()}updateTreeByOp(nt,st){this.scene2d.updateTreeByOp(nt,st),this.applySize()}applyOverrides(nt){if(this.frameOverride&&this.frameRoot){this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let st=(nt==null?void 0:nt.width)??this.width,mt=(nt==null?void 0:nt.height)??this.height;this.frameOverride.width=st,this.frameOverride.height=mt,this.frameOverride.localMatrix=VK,this.isScreenSpace&&(this.frameOverride.fill.color=bt$1.from0to1([0,0,0,0])),this.frameOverride.data={...this.frameOverride.data,width:st,height:mt},SL({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(nt,st=window.devicePixelRatio){var Rt,Ft;let mt=Math.max(1,(nt==null?void 0:nt.width)??this.width),gt=Math.max(1,(nt==null?void 0:nt.height)??this.height);this.dpr=st,this.width=mt,this.height=gt,this._innerApplySize();let _t=1,Et=512,At=512;(mt*st<Et||gt*st<At)&&(_t=Math.max(Et/(mt*st),At/(gt*st))),this.renderTarget.setSize(mt*st*_t,gt*st*_t),(Rt=this._canvasTexture)==null||Rt.dispose(),this._canvasTexture=void 0,this.applyOverrides(nt),(Ft=this.frameOverride)==null||Ft.requestRender()}applyFrame(nt){var mt,gt;let st=this.context.scene.find2D(nt);if(!(!st||!(st instanceof Ji)))return this.disposeFrameOverride(),this.frameRoot=st,this.frameOverride=st.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),(mt=this.frame)==null||mt.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse(_t=>{_t.addEventListener("beginState",this.onFrameOverrideObjectEvent)}),this.frameOverride.traverse(_t=>{_t.addEventListener("completeState",this.onFrameOverrideObjectEvent)}),(gt=this.frame)==null||gt.requestRender(),st}get frame(){return this.frameOverride}get frameId(){var nt;return(nt=this.frame)==null?void 0:nt.uuid}find(nt){return this.scene2d.find(nt)}get texture(){var nt;return(nt=this.textureHolder)==null?void 0:nt.getTexture(1001)}disposeFrameOverride(){var nt,st,mt;(nt=this.frameOverride)==null||nt.removeEventListener("render",this.onRenderRequestedDownstream),(st=this.frameOverride)==null||st.traverse(gt=>{gt.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)}),(mt=this.frameOverride)==null||mt.traverse(gt=>{gt.removeEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function SL({objectOverride:nt,objectRoot:st,newParentWidth:mt,newParentHeight:gt,initialParentWidth:_t,initialParentHeight:Et}){if(nt instanceof Ji&&st instanceof Ji||nt instanceof Un&&st instanceof Un)for(let At=0,Rt=nt.children.length;At<Rt;At++){let Ft=nt.children[At],Nt=st.children[At];Ft&&Nt&&Ft.uuid===Nt.uuid&&zK({objectOverride:Ft,objectRoot:Nt,newParentWidth:mt,newParentHeight:gt,initialParentWidth:_t,initialParentHeight:Et})}}function UK(nt){if(JE(nt))return[nt.width,nt.height];if(nt instanceof Ba){let[st,mt]=nt.getHalfSize();return[st*2,mt*2]}else if(nt instanceof Un){let[st,mt]=nt.recursiveBBox.getHalfSize();return[st*2,mt*2]}return[0,0]}function zK({objectOverride:nt,objectRoot:st,newParentWidth:mt,newParentHeight:gt,initialParentWidth:_t,initialParentHeight:Et}){let[At,Rt]=UK(st),{width:Ft,height:Nt,position:Bt}=YE({constraints:nt.data,newParentWidth:mt,newParentHeight:gt,initialParentWidth:_t,initialParentHeight:Et,objectInitialWidth:At,objectInitialHeight:Rt,objectInitialPosition:st.position});if(nt.position=Bt,nt.data={...nt.data,position:Bt},nt.states)for(let Gt in nt.states)kK({stateId:Gt,objectOverride:nt,objectRoot:st,newParentWidth:mt,newParentHeight:gt,initialParentWidth:_t,initialParentHeight:Et});if(JE(nt)||nt instanceof Un)JE(nt)&&(nt.width=Ft,nt.height=Nt,nt.data={...nt.data,width:Ft,height:Nt}),SL({objectOverride:nt,objectRoot:st,newParentWidth:Ft,newParentHeight:Nt,initialParentWidth:At,initialParentHeight:Rt});else if(nt instanceof Ba){let Gt=st,dr=At!==0?Ft/At:1,Mr=Rt!==0?Nt/Rt:1;nt.path=yL(Gt.path,dr,Mr),nt.data={...nt.data,path:nt.path}}}function kK({stateId:nt,objectOverride:st,objectRoot:mt,newParentWidth:gt,newParentHeight:_t,initialParentWidth:Et,initialParentHeight:At}){var Nt,Bt;let Rt=(Nt=st.states)==null?void 0:Nt[nt],Ft=(Bt=mt.states)==null?void 0:Bt[nt];if(Rt&&Ft){let{width:Gt,height:dr,position:Mr}=YE({constraints:st.data,newParentWidth:gt,newParentHeight:_t,initialParentWidth:Et,initialParentHeight:At,objectInitialWidth:Ea.isResizeable(Ft)?Ft.width:0,objectInitialHeight:Ea.isResizeable(Ft)?Ft.height:0,objectInitialPosition:Ft.position});Object.assign(st.states[nt],{position:Mr}),Ea.isResizeable(Rt)&&Object.assign(st.states[nt],{width:Gt,height:dr})}}function JE(nt){return nt instanceof As||nt instanceof Ji||nt instanceof ql||nt instanceof Yl}var cr=class extends md(ei){constructor(nt,st,mt){super(),this.data=st,this.bgColor=new vr(1,1,1,1),this.fog=null,this.backupFog=new Lu(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new We$1,this.penumbraSizeArrayCache=null,this.super_Entity(nt,st),this.personalCamera=new wr(hs,{...Ic.defaultData,...st.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new fy(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),st.uiScene?this.uiScene=new eu((Array.isArray(nt)?nt[0]:nt)+"-ui",st.uiScene,{dpr:window.devicePixelRatio,shared:mt.shared}):st.uiFrame&&this.createUICanvas(st.uiFrame,mt)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var nt;return(nt=this.uiCanvas)==null?void 0:nt.frame}createUICanvas(nt,st){this.uiCanvas=new Mf(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,st),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then(()=>{var mt,gt;(mt=this.uiCanvas)==null||mt.applyFrame(nt),(gt=this.uiCanvas)==null||gt.applySize()})}updateVisible(){}setBackgroundColor(nt){this.bgColor=nt,this.fogUseBGColor===!0&&(this.backupFog.color=nt)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(nt,st){nt.color!==void 0&&(this.ambientLight.color=Ki(nt.color,st)),nt.intensity!==void 0&&(this.ambientLight.intensity=nt.intensity),nt.enabled!==void 0&&(nt.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(nt){this.isActive=!0,nt.fog=this.fog,this.traverseEntity(st=>{st instanceof Fn&&st.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(nt=>{if(nt instanceof ys)if(Array.isArray(nt.material))for(let st of nt.material)st.needsUpdate=!0;else nt.material.needsUpdate=!0,nt.material.dispose()})}updateShadow(nt){nt.softShadowQuality!==void 0&&this.isActive&&Y3(nt.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(nt,st){if(nt.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let mt=this.scene;mt.fog=this.fog}this.fogUseBGColor=nt.useBackgroundColor,nt.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=Ki(nt.color,st),this.backupFog.near=nt.near,this.backupFog.far=nt.far}updateAo(nt,st){nt.aoColor!==void 0&&(this.aoColor=Ki(nt.aoColor,st))}updateByOp(nt,st,mt,gt){let _t=this.data.uiFrame;super.updateByOp(nt,st,mt,gt);let Et=st;Lt(nt.path,["fog"])?this.updateFog(Et.fog,mt.shared):Lt(nt.path,["ao"])?this.updateAo(Et.ao,mt.shared):Lt(nt.path,["ambient"])?this.updateAmbientLight(Et.ambient,mt.shared):Lt(nt.path,["shadow"])?this.updateShadow(Et.shadow):nt.type===0&&nt.path.length===0&&(nt.props.uiFrame!==void 0||_t!==Et.uiFrame)&&this.updateUIFrame(nt.props.uiFrame,mt)}updateUIFrame(nt,st){nt?(this.uiCanvas||this.createUICanvas(nt,st),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(nt)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(nt,st){this.updateState_Entity(nt,st),nt.backgroundColor!==void 0&&this.setBackgroundColor(Ki(nt.backgroundColor,st.shared)),nt.fog!==void 0&&this.updateFog(nt.fog,st.shared),nt.ambient!==void 0&&this.updateAmbientLight(nt.ambient,st.shared),nt.ao!==void 0&&this.updateAo(nt.ao,st.shared),nt.shadow!==void 0&&this.updateShadow(nt.shadow)}createFrame(nt,st){}raycast(nt,st){super.raycast(nt,st)}switchActiveCamera(nt){nt&&nt.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=nt,nt.objectHelper.visible=!1)}get playCamera(){var nt;return((nt=this.scene)==null?void 0:nt.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let nt=0,st=0;this.traverseEntity(mt=>{if(!mt.visible)return!0;mt instanceof wf&&mt.visible&&nt<3&&(this.penumbraSizeArrayCache[nt]=mt.data.penumbraSize??.5,nt+=1),mt instanceof Af&&mt.visible&&nt<2&&(this.penumbraSizeArrayCache[3+st]=mt.data.penumbraSize??.5,st+=1)})}raycastWithClones(nt){let st=[],mt=gt=>{for(let _t of gt.children){let Et=_t.cloner;yt.is(_t)&&(_t.visible||Et!=null&&Et.object.data.visible)&&((cn(_t)||Cm(_t)&&this.scene.enableHelpers&&_t.objectHelper.visible)&&(nt.intersectObject(_t,!1,st),Nm(_t,nt,st,!0)),mt(_t))}};return mt(this),st}updateEntity2DByOp(nt,st,mt,gt){var _t;(_t=this.uiCanvas)==null||_t.updateEntity2DByOp(nt,st,mt,gt)}},Ux=class extends sf(my,bf){constructor(nt,st,mt){super(),this.super_Entity(nt,st),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let gt=this.shadow.camera;gt.fov=90,gt.aspect=1,gt.near=100,gt.far=2500;let _t=new E$6(-gt.far+this.position.x,-gt.far+this.position.y,-gt.far+this.position.z),Et=new E$6(gt.far+this.position.x,gt.far+this.position.y,gt.far+this.position.z),At=new jt(_t,Et),Rt=new al(At,new We$1(16755200));Rt.visible=!1,this.gizmos.shadowmap=Rt,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let nt in this.gizmos){let st=this.gizmos[nt];if(st instanceof al){let mt=this.shadow.camera,gt=new E$6(-mt.far+this.position.x,-mt.far+this.position.y,-mt.far+this.position.z),_t=new E$6(mt.far+this.position.x,mt.far+this.position.y,mt.far+this.position.z);st.box.set(gt,_t),st.updateMatrixWorld(!0)}}}updateMatrixWorld(nt){super.updateMatrixWorld(nt),this.objectHelper&&this.objectHelper.update()}updateState(nt,st){this.updateState_Light(nt,st),nt.distance!==void 0&&(this.distance=nt.distance),nt.decay!==void 0&&(this.decay=nt.decay),nt.shadowRadius!==void 0&&(this.shadow.radius=nt.shadowRadius),nt.shadowResolution!==void 0&&(this.shadow.mapSize.set(nt.shadowResolution,nt.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},zx=class extends lr{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(nt,st){let mt=this.geometry.getAttribute("position");mt!==void 0?um(mt,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:mt.count,nt,st):super.updateEntityBoxSize(nt,st)}},Xl=class extends lr{constructor(nt,st,mt){super(nt,st,mt),this._shapeId=null,this._context=mt}updateState(nt,st){super.updateState(nt,st),this.updateShape()}updateShape(){var gt;let nt={...this.data.geometry.extrusion.shape};for(let _t in nt)typeof nt[_t]=="string"&&(nt[_t]=this._context.shared.getVariable(nt[_t],[this.uuid,"geometry","extrusion","shape",_t]));let st;if(nt.type==="Custom"){let _t=nt.shapeId;if(_t!==this._shapeId&&this.detachShape(),_t){this._shapeId=_t;let Et=this._context.scene.find(_t);Et!=null&&Et.data&&(Et.attachedPaths.add(this),st=(gt=Et.geometry.userData)==null?void 0:gt.shape),st||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let _t;switch(nt.type){case"Rectangle":_t=Td;break;case"Ellipse":_t=Ad;break;case"Polygon":_t=C0;break;case"Star":_t=P0;break;default:throw new Error(`Unknown shape type: ${nt.type}`)}st=_t.create({parameters:nt}).userData.shape}let mt=this.geometry;st&&mt.inputs&&(mt.inputs.shapeData=st,mt.build(),this.attachedSurfaceCloners.forEach(_t=>_t.update()))}detachShape(){var nt;this._shapeId!==null&&((nt=this._context.scene.find(this._shapeId))==null||nt.attachedPaths.delete(this))}createGeometryDelayed(nt){this.geometryCreateDeleyed=nt.shared,this.updateShape(),this.refreshAttachedPaths(nt)}updateTransformState(nt,st){return super.updateTransformState(nt,st)}updateGeometryInteractions(nt,st){super.updateGeometryInteractions(nt,st),this.updateShape()}updateEntityBoxSize(nt,st){let mt=this.geometry.getAttribute("position");mt!==void 0?um(mt,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:mt.count,nt,st):super.updateEntityBoxSize(nt,st)}},Ql=class extends Ul{constructor(nt,st,mt){super(nt,st,mt),this.data=st}},$s=class extends bs(sn,Ss){constructor(nt,st,mt){super(),st.type==="Instance"&&typeof nt=="string"&&(st=this.transformAssignData(st,mt)),this.super_Entity(nt,st),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(nt,st){let mt=qh.getComponentData({scene:st.scene.data,shared:st.shared.data},nt.component);if(mt){let gt,_t;for(let Et of Mo.rootOverrideProps)nt[Et]===void 0?(gt===void 0&&(gt={...nt}),gt[Et]=mt.data[Et]):(_t===void 0&&(_t={}),_t[Et]=nt[Et],gt===void 0&&(gt={...nt}),gt[Et]=vo.apply(mt.data[Et],nt[Et]));return this.overrideData=_t,gt}else return{...vi.defaultData,...nt,...Pn(vi.defaultData,Mo.rootOverrideProps)}}updateByOp(nt,st,mt,gt){let _t;if(this.isInstanceRoot&&!gt){if(st=this.transformAssignData(st,mt),nt.type===0&&nt.path.length===0&&this.component)for(let Et of Mo.rootOverrideProps)Et in nt.props&&nt.props[Et]===void 0&&(_t===void 0&&(_t={...nt,props:{...nt.props}}),_t.props[Et]=this.component.data[Et]);else if(nt.type===0&&nt.path.length>0&&Mo.rootOverrideProps.includes(nt.path[0])){let Et=nt.path[0];_t===void 0&&(_t={...nt,path:[],props:{[Et]:st[Et]}})}}super.updateByOp(_t??nt,st,mt,gt)}updateState(nt,st){this.updateState_Entity(nt,st)}expandInstanceChildren(nt){let st=this.data;if(this.component===void 0){let mt=nt.scene.find(st.component)??null,gt=!1;if(mt!==this.oldComponent){if(this.oldComponent){let _t=0;for(let Et of this.children)if(yt.is(Et))nt.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(Et),kx(Et),_t+=1;else break;this.children.splice(0,_t)}gt=!0}if(mt){let _t={};AL(nt,[this.uuid],st.overrides,this,mt,mt,0,gt,_t);for(let Et of this.children)if(yt.is(Et)){let At=Et.data;At.type==="Empty"&&At.animations&&Et.traverseEntity(Rt=>{let Ft=Rt.dataPatched;if(Rt instanceof lr&&Ft.bones&&Ft.boneInverses){let Nt=Rt.dataPatched;if(Nt.bones&&Nt.boneInverses){let Bt=Nt.bones.map(Mr=>nt.scene.find(_t[Mr])),Gt=Nt.boneInverses.map(Mr=>new ue$1().fromArray(Mr)),dr=new $a(Bt,Gt);Rt.bind(dr,Rt.bindMatrix)}}else Rt.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function kx(nt){if(nt.component){let st=nt.component.instances.indexOf(nt);st>=0&&nt.component.instances.splice(st,1);for(let mt of nt.children)yt.is(mt)&&kx(mt)}}function wL(nt,st,mt,gt){return nt.component===st&&Cc(nt.identity,gt)?nt.overrideData===mt?2:1:0}function AL(nt,st,mt,gt,_t,Et,At,Rt,Ft){if(At>50)return!1;if(gt.component!==_t){if(gt.component){let Bt=gt.component.instances.indexOf(gt);Bt>=0&&gt.component.instances.splice(Bt,1)}_t.instances.find(Bt=>Bt===gt)||_t.instances.push(gt),gt.component=_t}_t instanceof $s&&_t.isInstanceRoot&&_t.expandInstanceChildren(nt);let Nt=0;for(let Bt of _t.children)if(yt.is(Bt)){let Gt=[...st,...typeof Bt.identity=="string"?[Bt.identity]:Bt.identity],dr=Hh.resolve(mt,Gt,1);dr!=null&&!(dr instanceof yr)&&(Object.setPrototypeOf(dr,yr.prototype),console.error("wrong prototype"));let Mr=null,Tr;if(!Rt){let zr=gt.children[Nt];if(Mr=yt.is(zr)?zr:null,Mr!==null){let Fr=wL(Mr,Bt,dr,Gt);Tr=Fr>=1?Mr.stateSelection:void 0,Fr!==2&&(Mr=null)}if(Mr===null&&(Mr=nt.scene.findInstance(Gt)??null,Mr!==null)){let Fr=wL(Mr,Bt,dr,Gt);if(Tr=Fr>=1?Mr.stateSelection:void 0,Fr!==2)Mr=null;else{let Nr=Mr.parent.children.indexOf(Mr);Mr.parent.children.splice(Nr,1),gt.children.splice(Nt,0,Mr),Mr.parent===gt?Nr<=Nt&&console.error("not possible"):(Mr.parent=gt,Mr.matrixWorldNeedsUpdate=!0,Mr.resetBBoxNeedsUpdate(),Mr.updateVisible(),nt.pendingDeletes.delete(Mr))}}}if(Mr===null){let zr=dr?vo.apply(Bt.data,dr):Bt.data;Vs.is(zr.type)&&(zr={...zr,type:"Empty"}),Mr=js.createEntity(Gt,zr,nt),Mr.overrideData=dr,gt.add(Mr),gt.children.splice(gt.children.length-1,1),gt.children.splice(Nt,0,Mr),Mr.updateState(Mr.data,nt),Tr&&Mr.changeSelectedState(Tr,nt),nt.scene.registerInstanceAndSetUuid(Mr)}if(Mr.isBone){let zr=Mr.identity[Mr.identity.length-1];Ft[zr]=Mr.uuid}Nt+=1,AL(nt,st,mt,Mr,Bt,Et,At+1,Rt,Ft)}if(!Rt){let Bt=Nt;for(;;){let Gt=gt.children[Nt];if(yt.is(Gt))nt.pendingDeletes.add(Gt);else break;Nt+=1}gt.children.splice(Bt,Nt-Bt)}return!0}var Gx=class extends bs(hp,Ss){constructor(nt,st){super(),this.super_Entity(nt,st),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(nt,st){this.updateState_Entity(nt,st)}},Er=class extends lr{constructor(nt,st,mt){super(nt,st,mt),this.onBeforeRender=gt=>{this.uiCanvas.render(gt)},this.uiCanvas=new Mf(nt+"-canvas",st.geometry.width,st.geometry.height,mt),this.uiCanvas.promise.then(()=>{this.applyFrame(this.dataPatched.geometry.frame,mt.shared)})}updateByPatchedOpGeometry(nt,st,mt){super.updateByPatchedOpGeometry(nt,st,mt),nt.type===0&&(nt.props.frame!==void 0&&this.applyFrame(nt.props.frame,mt.shared),(nt.props.width!==void 0||nt.props.height!==void 0)&&this.applySize(nt.props,mt.shared))}applySize(nt,st){let mt=(nt==null?void 0:nt.width)??this.dataPatched.geometry.width,gt=(nt==null?void 0:nt.height)??this.dataPatched.geometry.height;this.uiCanvas.applySize({width:mt,height:gt}),this.applyGeometryParametersFromFrame(st)}applyFrame(nt,st){this.uiCanvas.applyFrame(nt),this.applyGeometryParametersFromFrame(st),this.applyMaterialParametersFromFrame({shared:st})}applyGeometryParametersFromFrame(nt){var mt;let st=this.frame;st&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:st.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:st.cornerRadius,cornerType:0})}),(mt=this.localGeometry)==null||mt.dispose(),this.localGeometry=Ca(this.dataPatched.geometry,nt,this.data.flatShading,this))}applyMaterialParametersFromFrame(nt){let st=this.frame;if(st){let mt=st.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:mt.radius,alpha:mt.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:mt.radius,alpha:mt.enabled?1:0}),this.material.reset(this.dataPatched.material,nt,!0)}}updateEntity2DByOp(nt,st,mt,gt){this.uiCanvas.updateEntity2DByOp(nt,st,mt,gt),nt===this.frameId&&st.type===0&&(st.props.cornerRadius!==void 0?this.applyGeometryParametersFromFrame(gt):Lt(st.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:gt}))}get frame(){return this.uiCanvas.frame}get frameId(){var nt;return(nt=this.frame)==null?void 0:nt.uuid}removeInteractionGeometry(nt){super.removeInteractionGeometry(nt),this.applySize({},nt)}updateGeometryInteractions(nt,st){super.updateGeometryInteractions(nt,st),this.applySize({width:nt.width,height:nt.height},st)}},jx=class{constructor(nt,st,mt){this.variables=[],this.currentTextureIndex=0;let gt=br,_t=new ei,Et=new qn;Et.position.z=1;let At={passThruTexture:{value:null}},Rt=Bt(dr(),At),Ft=new Ut(new Li(2,2),Rt);_t.add(Ft),this.setDataType=function(Mr){return gt=Mr,this},this.addVariable=function(Mr,Tr,zr){let Fr=this.createShaderMaterial(Tr),Nr={name:Mr,initialValueTexture:zr,material:Fr,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:Vt,magFilter:Vt};return this.variables.push(Nr),Nr},this.setVariableDependencies=function(Mr,Tr){Mr.dependencies=Tr},this.init=function(){if(mt.capabilities.isWebGL2===!1&&mt.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(mt.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(let Mr=0;Mr<this.variables.length;Mr++){let Tr=this.variables[Mr];Tr.renderTargets[0]=this.createRenderTarget(nt,st,Tr.wrapS,Tr.wrapT,Tr.minFilter,Tr.magFilter),Tr.renderTargets[1]=this.createRenderTarget(nt,st,Tr.wrapS,Tr.wrapT,Tr.minFilter,Tr.magFilter),this.renderTexture(Tr.initialValueTexture,Tr.renderTargets[0]),this.renderTexture(Tr.initialValueTexture,Tr.renderTargets[1]);let zr=Tr.material,Fr=zr.uniforms;if(Tr.dependencies!==null)for(let Nr=0;Nr<Tr.dependencies.length;Nr++){let tn=Tr.dependencies[Nr];if(tn.name!==Tr.name){let rn=!1;for(let Tn=0;Tn<this.variables.length;Tn++)if(tn.name===this.variables[Tn].name){rn=!0;break}if(!rn)return"Variable dependency not found. Variable="+Tr.name+", dependency="+tn.name}Fr[tn.name]={value:null},zr.fragmentShader=`
uniform sampler2D `+tn.name+`;
`+zr.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let Mr=this.currentTextureIndex,Tr=this.currentTextureIndex===0?1:0;for(let zr=0,Fr=this.variables.length;zr<Fr;zr++){let Nr=this.variables[zr];if(Nr.dependencies!==null){let tn=Nr.material.uniforms;for(let rn=0,Tn=Nr.dependencies.length;rn<Tn;rn++){let $n=Nr.dependencies[rn];tn[$n.name].value=$n.renderTargets[Mr].texture}}this.doRenderTarget(Nr.material,Nr.renderTargets[Tr])}this.currentTextureIndex=Tr},this.getCurrentRenderTarget=function(Mr){return Mr.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(Mr){return Mr.renderTargets[this.currentTextureIndex===0?1:0]},this.dispose=function(){Ft.geometry.dispose(),Ft.material.dispose();let Mr=this.variables;for(let Tr=0;Tr<Mr.length;Tr++){let zr=Mr[Tr];zr.initialValueTexture&&zr.initialValueTexture.dispose();let Fr=zr.renderTargets;for(let Nr=0;Nr<Fr.length;Nr++)Fr[Nr].dispose()}};function Nt(Mr){Mr.defines.resolution="vec2( "+nt.toFixed(1)+", "+st.toFixed(1)+" )"}this.addResolutionDefine=Nt;function Bt(Mr,Tr){Tr=Tr||{};let zr=new it$1({uniforms:Tr,vertexShader:Gt(),fragmentShader:Mr});return Nt(zr),zr}this.createShaderMaterial=Bt,this.createRenderTarget=function(Mr,Tr,zr,Fr,Nr,tn){return Mr=Mr||nt,Tr=Tr||st,zr=zr||Xt,Fr=Fr||Xt,Nr=Nr||Vt,tn=tn||Vt,new dt$1(Mr,Tr,{wrapS:zr,wrapT:Fr,minFilter:Nr,magFilter:tn,format:qr,type:gt,depthBuffer:!1})},this.createTexture=function(){let Mr=new Float32Array(nt*st*4),Tr=new gi(Mr,nt,st,qr,br);return Tr.needsUpdate=!0,Tr},this.renderTexture=function(Mr,Tr){At.passThruTexture.value=Mr,this.doRenderTarget(Rt,Tr),At.passThruTexture.value=null},this.doRenderTarget=function(Mr,Tr){let zr=mt.getRenderTarget(),Fr=mt.xr.enabled,Nr=mt.shadowMap.autoUpdate,tn=mt.outputEncoding,rn=mt.toneMapping;mt.xr.enabled=!1,mt.shadowMap.autoUpdate=!1,mt.outputEncoding=mn,mt.toneMapping=Is,Ft.material=Mr,mt.setRenderTarget(Tr),mt.render(_t,Et),Ft.material=Rt,mt.xr.enabled=Fr,mt.shadowMap.autoUpdate=Nr,mt.outputEncoding=tn,mt.toneMapping=rn,mt.setRenderTarget(zr)};function Gt(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function dr(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}}},$i=new Cr,Hx=new E$6,Wx=class{constructor(nt){let st=nt.geometry;if(!st.isBufferGeometry||st.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");st.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),st=st.toNonIndexed()),this.geometry=st,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(nt){return this.weightAttribute=nt?this.geometry.getAttribute(nt):null,this}build(){let nt=this.positionAttribute,st=this.weightAttribute,mt=new Float32Array(nt.count/3);for(let _t=0;_t<nt.count;_t+=3){let Et=1;st&&(Et=st.getX(_t)+st.getX(_t+1)+st.getX(_t+2)),$i.a.fromBufferAttribute(nt,_t),$i.b.fromBufferAttribute(nt,_t+1),$i.c.fromBufferAttribute(nt,_t+2),Et*=$i.getArea(),mt[_t/3]=Et}this.distribution=new Float32Array(nt.count/3);let gt=0;for(let _t=0;_t<mt.length;_t++)gt+=mt[_t],this.distribution[_t]=gt;return this}setRandomGenerator(nt){return this.randomFunction=nt,this}sample(nt,st,mt){let gt=this.distribution[this.distribution.length-1],_t=this.binarySearch(this.randomFunction()*gt);return this.sampleFace(_t,nt,st,mt)}binarySearch(nt){let st=this.distribution,mt=0,gt=st.length-1,_t=-1;for(;mt<=gt;){let Et=Math.ceil((mt+gt)/2);if(Et===0||st[Et-1]<=nt&&st[Et]>nt){_t=Et;break}else nt<st[Et]?gt=Et-1:mt=Et+1}return _t}sampleFace(nt,st,mt,gt){let _t=this.randomFunction(),Et=this.randomFunction();return _t+Et>1&&(_t=1-_t,Et=1-Et),$i.a.fromBufferAttribute(this.positionAttribute,nt*3),$i.b.fromBufferAttribute(this.positionAttribute,nt*3+1),$i.c.fromBufferAttribute(this.positionAttribute,nt*3+2),st.set(0,0,0).addScaledVector($i.a,_t).addScaledVector($i.b,Et).addScaledVector($i.c,1-(_t+Et)),mt!==void 0&&$i.getNormal(mt),gt!==void 0&&this.colorAttribute!==void 0&&($i.a.fromBufferAttribute(this.colorAttribute,nt*3),$i.b.fromBufferAttribute(this.colorAttribute,nt*3+1),$i.c.fromBufferAttribute(this.colorAttribute,nt*3+2),Hx.set(0,0,0).addScaledVector($i.a,_t).addScaledVector($i.b,Et).addScaledVector($i.c,1-(_t+Et)),gt.r=Hx.x,gt.g=Hx.y,gt.b=Hx.z),this}};function EL(nt){let st=new Float32Array(nt*nt*2);for(let mt=0;mt<nt;mt++)for(let gt=0;gt<nt;gt++){let _t=mt*nt+gt;st[_t*2+0]=mt/(nt-1),st[_t*2+1]=gt/(nt-1)}return st}function ML(nt){let st=Math.ceil(Math.sqrt(nt));return Math.max(st,1)}function TL(nt,st){let mt=new Ut(nt.geometry,nt.material),gt=[],_t=[],Et=new E$6,At=new E$6;mt.geometry.index!==null&&(mt.geometry=mt.geometry.toNonIndexed());let Rt=new Wx(mt).build();for(let Bt=0;Bt<st;Bt++)Rt.sample(Et,At),gt.push(Et.x,Et.y,Et.z),_t.push(At.x,At.y,At.z);let Ft=new Float32Array(gt),Nt=new Float32Array(_t);return{positions:Ft,normals:Nt}}function $E(nt,st){let mt=nt,gt=new Float32Array(4*st*st);for(let Et=0;Et<st*st;Et++)gt[4*Et]=mt[3*Et],gt[4*Et+1]=mt[3*Et+1],gt[4*Et+2]=mt[3*Et+2],gt[4*Et+3]=0;let _t=new gi(gt,st,st,qr,br);return _t.needsUpdate=!0,_t}function CL({size:nt}){let st=new Float32Array(4*nt*nt);for(let gt=0;gt<nt*nt;gt++)st[4*gt]=gt,st[4*gt+1]=0,st[4*gt+2]=0,st[4*gt+3]=0;let mt=new gi(st,nt,nt,qr,br);return mt.needsUpdate=!0,mt}function PL(nt){let st=new Float32Array(4*nt*nt);for(let gt=0;gt<nt*nt;gt++)st[4*gt]=0,st[4*gt+1]=0,st[4*gt+2]=0,st[4*gt+3]=0;let mt=new gi(st,nt,nt,qr,br);return mt.needsUpdate=!0,mt}var _L=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform float uTime;
uniform float uSpeed;     // update speed of the particles
uniform vec3 uWorldOffset;    
uniform vec4 uWorldQuaternion;
uniform float uMaxLifeTime;
uniform vec3 uEmitterSize;
uniform float uFPSRatio;     // 1  for 60 FPS

float random (vec2 st) {
    return fract(sin(dot(st.xy,
        vec2(12.9898,78.233)))*
        43758.5453123);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
    vec3 acceleration = force / mass;
    
    return acceleration;
  }
  

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted
    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided
    float lifeTime = uMaxLifeTime;

    // Calculate the position adjustment based on collision
    //     if (collisionFlag > .5) {  
    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0
    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise
    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);

    // Update position based on collision or normal movement
    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);
    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);

    // EMISSION RATE - BIRTH
    // if (isSpawning == 1.0) {
    // Better Approach to avoid If statement
    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;
    originalPosition = mix(originalPosition, newPosition, isSpawning);
    position = mix(position, originalPosition, isSpawning);;
    timeStart = mix(timeStart, uTime, isSpawning);

    // Calculate timeLeft for life normalization
    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);
    float life_Normalize = timeLeft / lifeTime;

    // Use isActive to blend between the calculated color and black
    vec4 activeColor = vec4(position, life_Normalize);
    // if (isActive == 1.0) {
    gl_FragColor = mix(vec4(0.0), activeColor, isActive);

}
`,DL=`

    vec3 mod289(vec3 x) {
      return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 mod289(vec4 x) {
    return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 permute(vec4 x) {
        return mod289(((x*34.0)+1.0)*x);
    }
    
    vec4 taylorInvSqrt(vec4 r)
    {
    return 1.79284291400159 - 0.85373472095314 * r;
    }
    
    vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

    float snoise(vec3 v)
    {
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );
    vec3 x1 = x0 - i1 + C.xxx;
    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y
    
    // Permutations
    i = mod289(i);
    vec4 p = permute( permute( permute(
                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
    
    // Gradients: 7x7 points over a square, mapped onto an octahedron.
    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
    float n_ = 0.142857142857; // 1.0/7.0
    vec3  ns = n_ * D.wyz - D.xzx;
    
    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)
    
    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
    
    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);
    
    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );
    
    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));
    
    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
    
    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);
    
    //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    
    // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
    }
    
    vec3 snoiseVec3( vec3 x ){
    
      float s  = snoise(vec3( x ));
      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));
      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));
      vec3 c = vec3( s , s1 , s2 );
      return c;
    
    }
    
      
    vec3 curlNoise( vec3 p, float seed){
      p += seed;
      const float e = .1;
      vec3 dx = vec3( e   , 0.0 , 0.0 );
      vec3 dy = vec3( 0.0 , e   , 0.0 );
      vec3 dz = vec3( 0.0 , 0.0 , e   );
    
      vec3 p_x0 = snoiseVec3( p - dx );
      vec3 p_x1 = snoiseVec3( p + dx );
      vec3 p_y0 = snoiseVec3( p - dy );
      vec3 p_y1 = snoiseVec3( p + dy );
      vec3 p_z0 = snoiseVec3( p - dz );
      vec3 p_z1 = snoiseVec3( p + dz );
    
      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;
      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;
      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;
    
      const float divisor = 1.0 / ( 2.0 * e );
      return normalize( vec3( x , y , z ) * divisor );
    
    }


// Classic Perlin noise
float cnoise(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
  return 2.2 * n_xyz;
}


vec3 fbm_vec3(vec3 p, float frequency, float offset)
{
  return vec3(
    cnoise((p+vec3(offset))*frequency),
    cnoise((p+vec3(offset+20.0))*frequency),
    cnoise((p+vec3(offset-30.0))*frequency)
  );
}

`,IL=`
  #ifdef USE_COLLIDER
    float restitution = max(uBounce * 2., .01); // Energy Loss
    // SPHERE COLLIDER
    // **************************************************************
    #ifdef USE_SPHERE_COLLIDER       
      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
      vec3 radii = uColliderSize;
      // Adjust position relative to collider
      vec3 relPos = position - uColliderPos;
      // Apply rotation of the collider to the relative position
      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
      // Scale relative position by radii (for ellipsoid collision detection)
      vec3 scaledPos = relPos / radii;
      // Calculate ellipsoidal distance
      float dist = length(scaledPos); // Distance in terms of ellipsoid
      
      // Check for collision
      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {
          // Compute the normal at the collision point, accounting for particle size
        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          
        // Compute the normal at the collision point
        vec3 normal = ellipsoidNormal(adjustedPos, radii);
        // Rotate the normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);
        // Reflect the velocity vector off the normal
        velocity = reflect(velocity, normal) * restitution;

        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif

    // BOX COLLIDER or PLANE COLLIDER 
    // **************************************************************
    #ifdef USE_BOX_COLLIDER
      // Box dimensions and repulsion variables
      vec3 boxHalfSize = uColliderSize / 2.0;
      // Convert world position to box's local space
      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
      // Collision detection
      vec3 localDistance = abs(localPos) - boxHalfSize;
      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    

      // Collision Detected
      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      
        // Find the nearest face normal for bounce direction
        vec3 normal;
        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {
            normal = vec3(sign(localPos.x), 0.0, 0.0);
        } else if (localDistance.y > localDistance.z) {
            normal = vec3(0.0, sign(localPos.y), 0.0);
        } else {
            normal = vec3(0.0, 0.0, sign(localPos.z));
        }            
        // Rotate normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);      
        // Reflect velocity and apply repulsion force
        velocity = reflect(velocity, normal) * restitution;
        
        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif      
  #endif      
  // END COLLIDER    
`,OL=`
  #ifdef USE_ATTRACTOR

      #ifdef USE_SPHERE_COLLIDER      
        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
        vec3 radii = uColliderSize;
        // Adjust position relative to collider
        vec3 relPos = position - uColliderPos;
        // Apply rotation of the collider to the relative position
        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
        // Scale relative position by radii (for ellipsoid collision detection)
        vec3 scaledPos = relPos / radii;
        // Calculate ellipsoidal distance
        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid
        float insideCheck = 1.0;

      #endif


      #ifdef USE_BOX_COLLIDER
        // Box dimensions
        vec3 boxHalfSize = uColliderSize / 2.0;
        // Convert world position to box's local space
        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
        vec3 localDistance = abs(localPos) - boxHalfSize;
        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));
        float insideCheck = particleSize;
      #endif      
  
      // Apply vortex force inside the Helper
      #ifdef USE_FORCE_LOCAL_SPACE
        if (distToSurface <= insideCheck ) {    
            // Define parameters for the attractor field
            #ifdef USE_SPHERE_COLLIDER      
              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed
            #endif

            #ifdef USE_BOX_COLLIDER
              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed
              #endif

            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)
          
            // Use the same radii calculation code as for the collider
            vec3 attractorRadii = uColliderSize;
            // Adjust position relative to attractor center
            vec3 relPos = position - uColliderPos;
            // Apply rotation of the collider to the relative position
            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
            // Scale relative position by radii (for ellipsoid attraction)
            vec3 scaledPos = relPos / attractorRadii;

            // Calculate ellipsoidal distance as attractor radius
            float attractorRadius = length(scaledPos);
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * attractorStrength;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= attractorDamping;
        }
      #else 
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= uForceDamping;
      #endif    
  #endif      
`,RL=`
  #ifdef USE_VORTEX
    // Box dimensions
    vec3 boxHalfSize = uColliderSize / 2.0;
    // Convert world position to box's local space
    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
    vec3 localDistance = abs(localPos) - boxHalfSize;
    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));

    // Apply vortex force inside the box
    if (distToSurface <= particleSize) {
      float vortexStrength = uForceIntensity;
      vec3 localTopCenter = vec3(0.0, 0., 0.0);

      // Transform the local top center to the world space
      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);
      // Calculate the vector from particle to vortex center
      vec3 vortexVector = vortexCenter - position;

      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector
      // Note: important to add a tiny z component to the up vector to avoid instability
      vec3 upVector = vec3(0.0, 1.0, 0.01);
      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));
      rotationAxis = normalize(rotationAxis);

      // Add rotational component to velocity
      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; 

      vec3 rotationVelocity = rotationAxis * rotationSpeed;
      // velocity += rotationVelocity * 0.005 ;
      velocity = rotationVelocity * 0.005 ;

      // Calculate vortex force
      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;
      // Apply the vortex force to the particle
      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);
      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);
    }
  #endif      
`,LL=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform sampler2D uDirections;     
uniform vec3 uDirectionsAxis;
uniform vec4 uWorldQuaternion;
uniform vec3 uGravity;        
uniform float uNoiseStrength;     // Variation of the noise
uniform float uNoiseScale;        // Scale of the noise
uniform float uNoiseSeed;         // Seed of the noise
uniform float particleSize;
uniform float uSpeed;     // update speed of the particles
uniform float uRandomMassFactor;

// COLLIDER
uniform vec3 uColliderPos;                // Collider Position
uniform vec3 uColliderSize;               // Collider Dimension
uniform vec4 uColliderQuaternion;         // Collider Rotation
uniform vec4 uColliderQuaternionInvert;   // Collider Rotation
uniform float uBounce;                    // Bounce factor
uniform float uForceDamping;
uniform float uForceIntensity;


`+DL+`
float rand(vec2 co){
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
 } 
vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
  
  return acceleration;
}

vec4 conjugate(vec4 q) {
  return vec4(q.w, -q.x, -q.y, -q.z);
}

// Function to compute the normal of the ellipsoid at a given point
vec3 ellipsoidNormal(vec3 p, vec3 radii) {
  return normalize(p / (radii * radii));
}

float friction = .3;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    vec3 directions = texture2D( uDirections, vUv ).xyz;    
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float mass = rand(originalPosition.xy) * 0.5 + 0.5;
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active
    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision

    // Randomness Mass
    mass = (1.0 - (uRandomMassFactor * mass));
    
    if (isActive == 1.0) {
      // **************************************************************
      // FORCES NOISES
      // **************************************************************
      #ifdef USE_CURL_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {
          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;
        }
      #endif
      // **************************************************************
      #ifdef USE_SIMPLEX_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {
          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);
        }
      #endif
      // ************************************************************** 
      #ifdef USE_FBM_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      
          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;
        }
      #endif

      // COLLIDER
      ${IL}
      // ATTRACTION
      ${OL}  
      // VORTEX
      ${RL}
    } 
    // End isActive

    // SPAWN BIRTH 
    // **************************************************************
    // if (isSpawning == 1.)
    #ifdef USE_NORMALS
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);
    #else
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    
    #endif
    
    // if (collisionFlag == 0.0)
    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);

    gl_FragColor = vec4(velocity, collisionFlag);
}
`,eM=`

  // Linear Fade In
  float linearFadeIn(float t) {
    return t;
  }


  // linear fade out
  float linearFadeOut(float t) {
    return 1.0 - t;
  }
  
  float linearInOut(float t) {
    return t < 0.5 ? t :  (1.0 - t);  
  }

    // lerp
    float lerp(float a, float b, float t) {
      return a + (b - a) * t;
    }

  // Ease In Out Quart
  float exponentialInOut(float t) {
    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :
    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :
    1.0;
   }

  // constant
  float constant(float t) {
    return 1.0;
  } 
`,BL=`

float rand(vec3 co){
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 applyQuaternionToVector( vec4 q, vec3 v ){
  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
    
  return acceleration;
}
`,NL=`
vec3 rgb2xyz (in vec3 rgb) {
    float r = rgb.r;
	float g = rgb.g;
	float b = rgb.b;

	r = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);
	g = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);
	b = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);

	float x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);
	float y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);
	float z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);
    
    vec3 xyz = vec3(
        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,
        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,
        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0
    );
    return(xyz);
}

vec3 xyz2lab (in vec3 xyz) {
	float x = xyz.x / 95.047;
	float y = xyz.y / 100.0;
	float z = xyz.z / 108.883;

	x = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);
	y = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);
	z = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);

    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));
    return(lab);
}

vec3 rgb2lab(in vec3 rgb) {
    vec3 xyz = rgb2xyz(rgb);
    vec3 lab = xyz2lab(xyz);
    return(lab);
}

vec3 xyz2rgb (in vec3 xyz) {
	float x = xyz.x / 100.0;
	float y = xyz.y / 100.0;
	float z = xyz.z / 100.0;
	
    
	float r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);
	float g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);
	float b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);

	r = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;
	g = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;
	b = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;

	r = min(max(0.0, r), 1.0);
	g = min(max(0.0, g), 1.0);
	b = min(max(0.0, b), 1.0);

	return(vec3(r, g, b));
}

vec3 lab2xyz (in vec3 lab) {
    float l = lab.x;
	float a = lab.y;
	float b = lab.z;

  	float y = (l + 16.0) / 116.0;
	float x = a / 500.0 + y;
	float z = y - b / 200.0;

	float y2 = pow(y, 3.0);
	float x2 = pow(x, 3.0);
	float z2 = pow(z, 3.0);

  	y = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;
	x = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;
	z = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;

	x *= 95.047;
	y *= 100.0;
	z *= 108.883;

	return(vec3(x, y, z));
}
vec3 lab2rgb (in vec3 lab) {
    vec3 xyz = lab2xyz(lab);
    vec3 rgb = xyz2rgb(xyz);
    return(rgb);
}

`,FL=`
  uniform sampler2D uPosition;
  uniform float uSize;
  uniform float uSizeEnd;
  uniform vec3 uWorldOffset;
  uniform vec4 uWorldQuaternion;
  // Billboard Behavior - Currently at Zero, but we can change that
  uniform float uRotation;
  uniform float uRotationEnd;
  uniform vec2 center;

  // Randomness
  uniform float uRandScaleFactor;
  uniform float uRandRotationFactor;

  attribute vec2 ref;

  varying float v_LifeLeft;    // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  ${BL}
  ${eM}
`,VL=({easeSize:nt="linearFadeOut"})=>`
  vUv = uv;  
  vRef = ref;
  // Normalized LifeTime 1 to 0
  float lifeLeft = texture2D(uPosition, ref).w;
  v_LifeLeft = lifeLeft;
  // Position From DataTexture Simulation
  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;
  // Apply World Quaternion
  pos = applyQuaternionToVector(uWorldQuaternion, pos);  
            
  #ifdef  USE_SIZE_END
    // Scaled Over Time
    float t = 1. - lifeLeft;
    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd
    vec3 scaledPosition = position * vec3(currentSize);
  #else
    // Change Size Behavior over LifeTime
    float easeSize = ${nt}(1. - lifeLeft);
    // Scaled Over Time
    vec3 scaledPosition = position * vec3(uSize * easeSize);
  #endif

  // Billboard Behavior
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    
  // Randomness 
  float randRef = rand(ref);
  scale *= (1.0 - (uRandScaleFactor * randRef));
  // Rotation
  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);
  float originalRotation = (1.0 - uRotation) * 2.0 * PI;
  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;
  // OverTime
  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);

  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;
  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;
  
  mat4 instanceMatrix = mat4(
    vec4(1.0, 0.0, 0.0, 0.0),
    vec4(0.0, 1.0, 0.0, 0.0),
    vec4(0.0, 0.0, 1.0, 0.0),
    vec4(pos.x, pos.y, pos.z, 1.0)
  );  

  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  mvPosition.xy += rotatedPosition;
  gl_Position = projectionMatrix  * mvPosition;   
`,UL=`
  uniform vec4 uColor;                // start color
  uniform vec4 uColor2;               // end color
  uniform sampler2D uTexture;         // texture
  varying float v_LifeLeft;   // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  float random(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
  }
  `+eM+`  
  ${NL}

`,zL=({easeOpacity:nt="linearFadeOut"})=>`  
  // if Particle is dead, hide it
  if (v_LifeLeft <= 0.005 ) {
    discard;
  }

  #ifdef USE_RANDOM_COLORING
    float randVal = random(vRef); // Generate a random value based on the reference
    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors
  #else
    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);
  #endif

  // Opacity over Life Time
  float finalAlpha = ${nt}(1. - v_LifeLeft);  
  vec4 textureColor = texture2D(uTexture, vUv).rgba; 
  finalColor = textureColor.rgb * color.rgb;
  finalAlpha = color.a * textureColor.a * finalAlpha;
  
  gl_FragColor = vec4(finalColor, finalAlpha);     

`,qx=class extends it$1{constructor(nt,st){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(nt,st),this.context=st}reset(){}init(nt,st){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=nt.ease,this.easeSize=nt.easeSize,this.layers=[],sr.startContext(sr.globalContext),this.lightLayer=new wn(0,"",{...Gr.defaultData("light","phong"),visible:!1},new _a,{},st.shared),sr.endContext(sr.globalContext),this.build()}updateState(nt){nt.coloring!==void 0&&(this.isColoringRandom=nt.coloring==="random"),nt.color!==void 0&&(nt.color instanceof Array?this.uniforms.uColor.value=nt.color:this.uniforms.uColor.value=this.context.shared.color(nt.color)),nt.color2!==void 0&&(nt.color2 instanceof Array?this.uniforms.uColor2.value=nt.color2:this.uniforms.uColor2.value=this.context.shared.color(nt.color2)),nt.size!==void 0&&(this.uniforms.uSize.value=nt.size[0],this.uniforms.uSizeEnd.value=nt.size[1],nt.size[0]!==nt.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),nt.ease!==void 0&&(this.easeOpacity=nt.ease,this.build()),nt.easeSize!==void 0&&(this.easeSize=nt.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(nt){this.build(),nt.defines=this.defines,nt.uniforms=this.uniforms,nt.vertexShader=this.vertexShader,nt.fragmentShader=this.fragmentShader}build(){let nt=new Bd;return nt.needsJitter=this.needsJitter,nt.addFragmentParsCode(nR),nt.buildShader("vertex",this.fragment),nt.buildShader("fragment",this.fragment),nt.addFragmentFinalCode(sR),this.isColoringRandom&&nt.define("USE_RANDOM_COLORING"),this.useSizeEnd&&nt.define("USE_SIZE_END"),nt.addVertexParsCode(FL),nt.addFragmentParsCode(UL),nt.addVertexFinalCode(VL({easeSize:this.easeSize})),nt.addFragmentFinalCode(zL({easeOpacity:this.easeOpacity})),this.vertexShader=nt.getCode("vertex"),this.fragmentShader=nt.getCode("fragment"),this.defines=nt.defines,this.uniforms={...nt.uniforms,...this.uniforms},this.extensions=nt.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach(nt=>nt.dispose()),super.dispose()}},Tf=class{constructor(nt,st,mt,gt){this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=nt,this.type=mt,this.textureSize=ML(st);let _t=1;this.targetMesh=(gt==null?void 0:gt.type)==="Mesh"&&gt?gt:this.getMesh(mt,_t);let{positions:Et,dataTexture:At,dataTextureNormals:Rt}=this.createPositions(this.textureSize,this.targetMesh??this.getMesh(mt,_t));this.positionsTexture=At,this.positionsAttribute=Et,this.directionsTexture=Rt}createPositions(nt,st){let{positions:mt,normals:gt}=TL(st,nt*nt),_t=$E(mt,nt),Et=$E(gt,nt);return{dataTexture:_t,positions:mt,dataTextureNormals:Et}}getMesh(nt,st){let mt=null;switch(nt){case"SphereEmitterShape":{mt=new Ls(st*.5,32,32);break}case"TorusEmitterShape":{mt=new ku(st*.5,.3,15,40);break}case"ConeEmitterShape":{mt=new tl(st,st,15);break}case"BoxEmitterShape":{mt=new mi(st,st,st);break}case"PlaneEmitterShape":{mt=new Li(st,st),mt.rotateX(-Math.PI/2);break}case"MeshEmitterShape":{mt=new Ls(st,32,32);break}default:{mt=new Ls(st,32,32);break}}return new Ut(mt,new on({color:16711680}))}applyToShader(nt,st){this.size=new E$6().fromArray(st.size),nt.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function Kl(nt){let st={...nt},mt=Vh.defaultData;st.forceFieldObjectId&&(st.colliderEntityId=st.forceFieldObjectId);let gt={...mt.shape,...st.shape},_t={...mt.renderMaterial,...st.renderMaterial};return{...mt,...st,shape:gt,renderMaterial:_t}}var kL=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU

uniform sampler2D uIndex; // Texture with corresponding index
uniform float uLastIndexEmitted; // Last emitted index
uniform float uParticlesToEmit; // Number of particles to emit on that frame
uniform float uTime;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    float particleIndex = texture(uIndex, vUv).x;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;


    // ********** Detect Colision to Create a flag and use it in position **********
    // We are doing this here, so

    // ********** Emit Particles **********
    // X = isSpawning 0.0 or 1.0
    // Y = isActive 0.0 or 1.0
    // Check if the vertex index is between the first value and the last value
    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {
    //     // Emit a particle by writing 1 to the red channel of the color output
    //     // r: 1. == emit the particle
    //     // g: 1. == particle is now active
    //     timeStart = uTime;
    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);
    // } else {
    //     // The Particle is either already emitted or not in the range of the particles to emit
    //     // Do not emit a particle by writing 0 to the red channel of the color output        
    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);
    // }
    // Determine if the particle is within the emission range
    float emitLowerBound = step(uLastIndexEmitted, particleIndex);
    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);
    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise

    // Set timeStart and color
    timeStart = mix(timeStart, uTime, emitParticle);
    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);


}
`,tM=10,Yx=class extends Mt{constructor(nt,st){super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new dy,this.currentWorldPosition=new E$6,this.systemQuaternion=new Qe$1,this.worldGravity=new E$6(0,0,0),this.directionAxis=new E$6(0,0,0),this.colliderV3=new E$6(0,0,0),this.colliderQuaternion=new Qe$1(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=nt,this.system=st,this.shared=st.context.shared;let mt=st.data;this.material=new qx(mt.renderMaterial,st.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:mt.renderMaterial.color},uColor2:{value:mt.renderMaterial.color2},uPosition:{value:new E$6(0,0,0)},uEmissionData:{value:new E$6(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new E$6(0,0,0)},uWorldQuaternion:{value:new Ze$1(0,0,0,1)},uRandScaleFactor:{value:mt.randomScale??0},uRandRotationFactor:{value:mt.randomRotation??0},uRotation:{value:mt.renderMaterial.spriteRotation[0]??0},uRotationEnd:{value:mt.renderMaterial.spriteRotation[1]??0}},this.setTexture(this.material.uniforms,mt.renderMaterial.texture),this.init(mt)}setTexture(nt,st){let mt=st.data;if(typeof st=="string"){let gt=this.shared.image(st),_t=new $t(gt.img);_t.needsUpdate=!0,nt.uTexture.value=_t;return}if(typeof mt!="string"){let gt=new Image;gt.onload=()=>{let At=new $t(gt);At.needsUpdate=!0,nt.uTexture.value=At};let _t=new Blob([mt],{type:"image/*"}),Et=URL.createObjectURL(_t);gt.src=Et}}updateGeometryAttributes(nt,st){var gt;let mt=EL(st);!((gt=this.emitterShape)!=null&&gt.positionsAttribute)||nt.geometry.setAttribute("ref",new fo$1(mt,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let nt=this.system;nt.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),nt.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(nt,st){var At;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset){this.reset();return}this.applyWorldSpace(),this.globalTime=nt,this.positionSimRT.material.uniforms.uTime.value=nt,this.emissionRateSimRT.material.uniforms.uTime.value=nt;let mt=1e3/st,gt=this.targetFPS/mt,_t=this.previousRatio+(gt-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=_t,this.previousRatio=_t;let Et=this.isEmitting?this.GoEmitSomeParticles(nt,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=Et,this.material.uniforms.uPosition.value=(At=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))==null?void 0:At.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let nt=this.system.colliderEntities[0],st=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(nt.destroyedInAction&&st&&this.init(Kl({...this.system.data,colliderEntityId:null})),!nt||nt.destroyedInAction)return;nt.getWorldPosition(this.colliderV3),this.colliderV3.y===0&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let mt=nt.data.size;this.colliderV3.fromArray(mt),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),nt.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(nt){!this.velocitySimRT||!this.positionSimRT||(nt.renderMaterial&&this.updateMaterialState(nt.renderMaterial),this.updateParticleState(nt))}updateVariableState(nt,st){if(!this.velocitySimRT||!this.positionSimRT)return;st[2]==="size"&&this.material.updateState({size:[nt,this.material.uniforms.uSizeEnd.value]}),st[2]==="sizeEnd"&&this.material.updateState({size:[this.material.uniforms.uSize.value,nt]});let mt=(gt,_t)=>{let Et=[...this.system.data.shape.size];Et[gt]=_t,this.updateParticleState({shape:{...this.system.data.shape,size:Et}})};st[2]==="shape_size_0"&&mt(0,nt),st[2]==="shape_size_1"&&mt(1,nt),st[2]==="shape_size_2"&&mt(2,nt),st[2]==="speed"&&(this.velocitySimRT.material.uniforms.uSpeed.value=nt/tM),st[2]==="gravity"&&this.worldGravity.set(0,nt/100,0),st[2]==="noiseStrength"&&(this.noiseStrength=nt,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),st[2]==="noiseScale"&&(this.noiseScale=nt,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),st[2]==="direction_x"&&(this.directionAxis=this.getDirectionAxis([Number(nt),this.system.data.direction[1],this.system.data.direction[2]])),st[2]==="direction_y"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(nt),this.system.data.direction[2]])),st[2]==="direction_z"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(nt)]))}updateMaterialState(nt){this.material.updateState({...nt,size:nt.size?[Number(this.shared.getVariable(nt.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(nt.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]}),nt.texture&&(this.setTexture(this.material.uniforms,nt.texture),this.material.needsUpdate=!0)}updateParticleState(nt){var st,mt,gt;if(!(!this.positionSimRT||!this.velocitySimRT)){if(this.shouldReInitGPUCompute(nt)&&this.init(Kl(this.system.data)),nt.life!==void 0&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=nt.life),nt.speed!==void 0&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(nt.speed,[this.uuid,"particles","speed"]))/tM),nt.collisionBounce!==void 0&&(this.velocitySimRT.material.uniforms.uBounce.value=nt.collisionBounce),nt.noiseStrength!==void 0&&(this.noiseStrength=Number(this.shared.getVariable(nt.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),nt.noiseScale!==void 0&&(this.noiseScale=Number(this.shared.getVariable(nt.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),nt.noiseSeed!==void 0&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=nt.noiseSeed),nt.randomMass!==void 0&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=nt.randomMass),((st=nt.renderMaterial)==null?void 0:st.size)!==void 0){let _t=this.shared.getVariable(nt.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(_t)}if(((mt=nt.renderMaterial)==null?void 0:mt.spriteRotation)!==void 0&&(this.material.uniforms.uRotation.value=nt.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=nt.renderMaterial.spriteRotation[1]),nt.shape!==void 0){let _t=nt.shape.size??this.system.data.shape.size,Et=[Number(this.shared.getVariable(_t[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(_t[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(_t[2],[this.uuid,"particles","shape_size_2"]))],At={...Kl(this.system.data).shape,size:Et};(gt=this.emitterShape)==null||gt.applyToShader(this.positionSimRT.material.uniforms,At)}if(nt.gravity!==void 0&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),nt.direction!==void 0){let _t=this.getDirectionFromVariable(nt.direction);this.directionAxis=this.getDirectionAxis(_t),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}nt.randomRotation!==void 0&&(this.material.uniforms.uRandRotationFactor.value=nt.randomRotation),nt.randomScale!==void 0&&(this.material.uniforms.uRandScaleFactor.value=nt.randomScale)}}updateForceFieldParameters(nt){!this.velocitySimRT||(nt.forceIntensity!==void 0&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=nt.forceIntensity),nt.forceDambing!==void 0&&(this.velocitySimRT.material.uniforms.uForceDamping.value=nt.forceDambing))}getDirectionAxis(nt){let st=[Number(nt[0])*we$1.DEG2RAD,Number(nt[1])*we$1.DEG2RAD,Number(nt[2])*we$1.DEG2RAD],mt=new ir(st[0],st[1],st[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(mt).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(nt){let{birthRatePerSec:st,rootObjectType:mt,colliderEntityId:gt,shape:_t,emitTimeDuration:Et,emitTimeCycle:At,life:Rt,directionMode:Ft,noiseType:Nt}=nt;return st!==void 0||mt!==void 0||gt||gt===null||At!==void 0||_t!==void 0||Rt!==void 0||Et!==void 0||Ft!==void 0||Nt!==void 0}init(nt){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:nt.birthRatePerSec,particleMaxLifeTime:nt.life,loopDuration:nt.emitTimeCycle==="infinity"?0:nt.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to 100000."),this.particlesAmount=1e5),this.emitterShape=this.createShape(nt.shape,this.particlesAmount);let st=setInterval(()=>{if(this.emitterShape)if(isNaN(this.emitterShape.positionsTexture.source.data.data[0])){this.init(nt);return}else clearInterval(st)},100);if(!this.emitterShape)return;let mt=new jx(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),gt=this.updateSimulationDefinition(nt),_t=mt.addVariable("uCurrentPosition",gt+_L,this.emitterShape.positionsTexture),Et=mt.addVariable("uCurrentVelocity",gt+LL,this.emitterShape.directionsTexture),At=mt.addVariable("uCurrentEmissionRate",kL,PL(this.emitterShape.textureSize));mt.setVariableDependencies(_t,[_t,Et,At]),mt.setVariableDependencies(Et,[_t,Et,At]),mt.setVariableDependencies(At,[_t,Et,At]);let Rt=CL({size:this.emitterShape.textureSize}),Ft={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new E$6(0,0,0)},uWorldQuaternion:{value:new Ze$1(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:nt.life},uEmitterSize:{value:new E$6(Number(this.shared.getVariable(nt.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(nt.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(nt.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};_t.material.uniforms=Ft;let Nt=this.getDirectionFromVariable(nt.direction);this.directionAxis=this.getDirectionAxis(Nt),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(nt.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(nt.noiseScale,[this.uuid,"particles","noiseScale"]));let Bt=nt.colliderEntityId&&this.system.getColliderData(nt.colliderEntityId),Gt={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new Ze$1(0,0,0,1)},uColliderPos:{value:new E$6(0,0,0)},uColliderSize:{value:new E$6(0,0,0)},uForceIntensity:{value:Bt?Bt.forceIntensity:0},uForceDamping:{value:Bt?Bt.forceDambing:0},uColliderQuaternion:{value:new Ze$1(0,0,0,1)},uColliderQuaternionInvert:{value:new Ze$1(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:nt.noiseSeed},uRandomMassFactor:{value:nt.randomMass},uBounce:{value:nt.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(nt.speed,[this.uuid,"particles","speed"]))/tM}};Et.material.uniforms=Gt;let dr={uIndex:{value:Rt},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};At.material.uniforms=dr;let Mr=[Number(this.shared.getVariable(nt.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(nt.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(nt.shape.size[2],[this.uuid,"particles","shape_size_2"]))],Tr={...Kl(this.system.data).shape,size:Mr};this.emitterShape.applyToShader(_t.material.uniforms,Tr),mt.init(),this.gpuCompute=mt,this.positionSimRT=_t,this.velocitySimRT=Et,this.emissionRateSimRT=At,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(nt){let st=Number(this.shared.getVariable(nt[0],[this.uuid,"particles","direction_x"])),mt=Number(this.shared.getVariable(nt[1],[this.uuid,"particles","direction_y"])),gt=Number(this.shared.getVariable(nt[2],[this.uuid,"particles","direction_z"]));return[st,mt,gt]}updateSimulationDefinition(nt){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,nt.colliderEntityId&&this.system.colliderEntities.length>0){let mt=this.system.getColliderData(nt.colliderEntityId);switch(mt==null?void 0:mt.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0;break}let gt=mt==null?void 0:mt.colliderType;gt==="sphere"&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),gt==="box"&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),(mt==null?void 0:mt.forceRange)==="helper"&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}nt.directionMode==="normals"&&(this.simFeaturesDefinition.USE_NORMALS=!0),nt.noiseType==="curl"&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),nt.noiseType==="simplex"&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),nt.noiseType==="fbm"&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let st="";for(let[mt,gt]of Object.entries(this.simFeaturesDefinition))gt&&(st+=`#define ${mt}
`);return st}createShape(nt,st){this.emitterShape&&this.emitterShape.dispose();let mt=new E$6(Number(this.shared.getVariable(nt.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(nt.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(nt.size[2],[this.uuid,"particles","shape_size_2"])));if(nt.type==="MeshEmitterShape"){let gt=null;return this.system.context.scene.traverseEntity(_t=>{_t.uuid===nt.fromMeshId&&(gt=_t)}),gt?new Tf(mt,st,nt.type,gt):new Tf(mt,st,"SphereEmitterShape")}else return new Tf(mt,st,nt.type)}createPrimaryEmitter(nt){let st,mt=nt*nt;return st=new oy(new Li(1,1,1),this.material,mt),this.updateGeometryAttributes(st,nt),this.material.needsUpdate=!0,st.onBeforeRender=()=>{this.applyWorldSpace()},st}getMaxParticlesAmount({birthRatePerSecond:nt,particleMaxLifeTime:st,loopDuration:mt=0}){return Math.ceil(nt*(st+mt))}dispose(){var nt,st,mt;!this.gpuCompute||((st=(nt=this.rootObject)==null?void 0:nt.parent)==null||st.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),(mt=this.emitterShape)==null||mt.dispose())}GoEmitSomeParticles(nt,st){let mt=nt-this.lastEmitTime,gt=1/st;if(mt>=gt){let _t=Math.max(1,Math.floor(mt/gt));return this.lastEmitTime=nt,this.emittedParticlesAmount+_t>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=_t,_t}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(Kl(this.system.data))}startEmitting(nt){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=nt}stopEmitting(){this.isEmitting=!1}},Zl=class extends mr{constructor(nt,st,mt){super(nt,st),this.type="ParticleSystem",this.geometry=new _e$1,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=gt=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(gt))},this.context=mt,this.data={...st,...Kl(st)},this.geometry.setAttribute("position",new Me$1([],3)),this.material=new on({colorWrite:!1}),this.frustumCulled=!1}init(nt){this.renderer=nt,this.emitter=new Yx(nt,this),this.add(this.emitter),this.updateParticleState(this.data)}update(nt){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=nt,this.stopped||(this.currentLoopTime+=nt);let st=this.data.emitTimeCycle==="one_time";if((this.data.emitTimeCycle==="loop"||st)&&this.currentLoopTime>this.data.emitTimeDuration*1e3&&(this.stopped||(this.stop(),st||this.start(this.data.emitTimeDelay*1e3))),this.emitter&&this.started){let mt=this.actualTime/1e3;this.emitter.update(mt,nt)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(nt){return this.colliderEntities.some(st=>st.identity===nt)}getColliderData(nt){let st=this.colliderEntities.find(mt=>mt.identity===nt);return st?st.data:null}updateByPatchedOp(nt,st,mt){super.updateByPatchedOp(nt,st,mt),Lt(nt.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:{...this.data.renderMaterial,...Rr.drop(nt,1).props}}),Lt(nt.path,["shape"])&&this.updateParticleState({shape:{...this.data.shape,...Rr.drop(nt,1).props}})}updateState(nt,st){super.updateState(nt,st),this.updateParticleState(nt)}updateParticleState(nt){if(this.emitter){if(nt.colliderEntityId!==void 0&&nt.colliderEntityId!==null){let st=this.context.scene.find(nt.colliderEntityId);this.colliderEntities=st?[st]:[]}nt.colliderEntityId===null&&(this.colliderEntities=[]),this.emitter.updateState(nt),nt.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(nt){!this.emitter||(this.emitter.updateForceFieldParameters(nt),this.stop(),this.start())}start(nt=0){var st;if(this.currentLoopTime=0,nt){this.timeoutId=window.setTimeout(()=>{this.start(0)},nt);return}this.started=!0,this.stopped=!1,this.isFrozen=!1,(st=this.emitter)==null||st.startEmitting(this.actualTime/1e3)}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var nt;this.stopped=!0,this.currentLoopTime=0,(nt=this.emitter)==null||nt.stopEmitting(),clearTimeout(this.timeoutId)}reset(){var nt;this.started=!1,this.stopped=!1,(nt=this.emitter)==null||nt.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};function GK(){try{let nt=window.location.href;if(nt.includes("reducesubdiv=")){let st=nt.indexOf("reducesubdiv=")+13;return parseInt(nt.slice(st,st+1))}}catch{}}var rM=GK();function jK(nt,st,mt){var _t;rM!==void 0&&(((_t=st==null?void 0:st.geometry)==null?void 0:_t.subdivisions)??0)>rM&&(console.log("reducing subdivisions",st.name,st.geometry.subdivisions),st.geometry.subdivisions=rM);let gt;return st.geometry.type==="TextGeometry"?new Ul(nt,st,mt):st.geometry.type==="InputGeometry"?new Ql(nt,st,mt):(st.geometry.type==="SubdivGeometry"?gt=new Ks(nt,st,mt):st.geometry.type==="PathGeometry"?gt=new Xl(nt,st,mt):st.geometry.type==="VectorGeometry"?gt=new zx(nt,st,mt):st.geometry.type==="BooleanGeometry"?gt=new Fn(nt,st,mt):st.geometry.type==="UIGeometry"?gt=new Er(nt,st,mt):gt=new lr(nt,st,mt),gt)}function Xx(nt,st,mt){return console.assert(st.type!==void 0),st.type==="Mesh"?jK(nt,st,mt):st.type==="Empty"?new ws(nt,st):st.type==="Particle"?new Zl(nt,st,mt):st.type==="ParticleCollider"?new kl(nt,st,mt):st.type==="Splat"?new ws(nt,st):st.type==="Bone"?new Gx(nt,st):st.type==="Page"?new cr(nt,st,mt):st.type==="PointLight"?new Ux(nt,st,mt):st.type==="SpotLight"?new Af(nt,st,mt):st.type==="DirectionalLight"?new wf(nt,st,mt):st.type==="Component"||st.type==="Instance"?new $s(nt,st,mt):Vs.is(st.type)?new wr(nt,st):(console.error(st),new ws(nt,st))}js.createEntity=Xx;function HK(nt,st,mt){let gt=Xx(nt.identity,st,mt),_t=nt.children,Et=nt.attachedPaths,At=nt.parent,Rt=nt.component,Ft=nt.instances,Nt=nt.overrideData,Bt=nt.uuid,Gt=nt.stateSelection;nt.dispose();for(let dr of Object.keys(nt))delete nt[dr];Object.setPrototypeOf(nt,Object.getPrototypeOf(gt));for(let dr of Object.keys(gt))nt[dr]=gt[dr];nt.children=[...nt.children,..._t],nt.attachedPaths=Et,nt.parent=At,nt.component=Rt,nt.instances=Ft,nt.uuid=Bt,nt.overrideData=Nt,nt.updateState(nt.data,mt),Gt&&nt.changeSelectedState(Gt,mt),nt.resetBBoxNeedsUpdate()}js.changeEntityProptotype=HK;js.Cloner=Gi;function jL(nt,st,mt,gt){nt.updateByOp(st,mt,gt,!1)}function HL(nt,st){let mt=!1,gt=st.getLayersOfType("transmission"),_t=st.getLayersOfType("outline");return _t.length>0&&(nt.layers.set(8),gt.length>0&&nt.layers.enable(3),mt=!0,$d(nt),Jd(nt)),gt.length===0&&_t.length===0&&nt.layers.set(0),nt instanceof ys&&nt.needsAO&&nt.layers.enable(5),mt}function WL(nt,st){if(!st.layers)return!1;let mt=!1,gt=st.getLayersOfType("transmission").filter(Et=>Et.data.visible),_t=st.getLayersOfType("outline").filter(Et=>Et.data.visible);return gt.length>0&&(nt.layers.set(3),_t.length>0&&nt.layers.enable(8),mt=!0),gt.length===0&&_t.length===0&&nt.layers.set(0),nt.needsAO&&nt.layers.enable(5),mt}function qL(nt){let st=!1;return nt.traverseEntity(mt=>{if(mt instanceof ys)if(Array.isArray(mt.material))for(let gt=0;gt<mt.material.length;gt++)HL(mt,mt.material[gt])&&(st=!0);else HL(mt,mt.material)&&(st=!0)}),st}function YL(nt){let st=!1;return nt.traverseEntity(mt=>{if(mt instanceof ys)if(Array.isArray(mt.material))for(let gt=0;gt<mt.material.length;gt++)WL(mt,mt.material[gt])&&(st=!0);else WL(mt,mt.material)&&(st=!0)}),st}var WK=new Qu,qK=new ue$1,YK=new Rs;function Nm(nt,st,mt,gt=!1){let _t=nt.cloner;if(_t)for(let Et of _t.children){let At=qK.copy(Et.matrixWorld).invert(),Rt=YK.copy(st.ray).applyMatrix4(At),Ft=nt.matrixWorld;Rt.applyMatrix4(Ft);let Nt=WK;Nt.set(Rt.origin,Rt.direction),Nt.near=st.near,Nt.far=st.far;let Bt=Nt.intersectObject(nt,!1);Bt.length>0&&mt.push({...Bt[0],object:gt?Et:nt})}}var Qx=class{constructor(){this._constraints=new Map}setConstraint(nt,st){st===null?this._constraints.delete(nt):this._constraints.set(nt,st)}removeDependencies(nt){this._constraints.delete(nt)}applyConstraints(nt){let st=new Set;this._constraints.forEach((mt,gt)=>{let _t=[gt,mt],Et=mt;for(;this._constraints.has(Et);){if(Et=this._constraints.get(Et),_t.includes(Et)){console.warn(`circular dependency detected: ${_t.join(" -> ")}`);break}st.has(Et)||_t.push(Et)}for(let At=_t.length-2;At>=0;At--)if(!st.has(_t[At])){let Rt=nt.find(_t[At]);Rt?Rt.applyPathSnapping(nt):console.warn(`missing entity ${_t[At]}`),st.add(_t[At])}})}findDependency(nt,st){let mt=nt;for(;this._constraints.has(mt);)if(mt=this._constraints.get(mt),mt===st)return!0;return!1}},XL="AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL",ko=class{};nc(ko,"DepthMapRange",65536),nc(ko,"MemoryPageSize",65536),nc(ko,"BytesPerFloat",4),nc(ko,"BytesPerInt",4);function XK(nt){let st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr;function Nr(ds){let Il=new Float64Array(Bt,At,16);for(let uu=0;uu<16;uu++)Il[uu]=ds[uu];let ru;if(gt>1){st.exports.sortIndexes(_t,Et,Nt,At,Rt,Ft,dr.DepthMapRange,gt);let uu=new Uint32Array(gt);ru=uu.buffer,uu.set(new Uint32Array(Bt,Ft,gt))}else if(gt===1){let uu=new Uint32Array(gt);uu[0]=new Uint32Array(Bt,_t,mt)[0],ru=uu.buffer}else ru=new ArrayBuffer(0);nt.postMessage({sortDone:!0,indexesBuffer:ru},[ru])}function tn(ds,Il,ru){let uu=new Float32Array(Bt,Et,mt*3);gt=0;let p0=new Uint32Array(Bt,_t,mt);for(let X1=0;X1<ru.length-1;X1++){let q0=Il[X1],W0=ds[X1].elements,hu=q0.filter(Vx=>Vx.enabled&&Vx.mode==="Include").map(Vx=>Vx.type==="Box"?un(Vx):ts(Vx)),a1=q0.filter(Vx=>Vx.enabled&&Vx.mode==="Exclude").map(Vx=>Vx.type==="Box"?un(Vx):ts(Vx));for(let Vx=ru[X1];Vx<ru[X1+1];Vx++){let t0=Mr[Vx*3],cu=Mr[Vx*3+1],lu=Mr[Vx*3+2];if((hu.length===0||Tn(t0,cu,lu,hu))&&(a1.length===0||!Tn(t0,cu,lu,a1))){let b0=1/(W0[3]*t0+W0[7]*cu+W0[11]*lu+W0[15]);uu[gt*3]=(W0[0]*t0+W0[4]*cu+W0[8]*lu+W0[12])*b0,uu[gt*3+1]=(W0[1]*t0+W0[5]*cu+W0[9]*lu+W0[13])*b0,uu[gt*3+2]=(W0[2]*t0+W0[6]*cu+W0[10]*lu+W0[14])*b0,p0[gt]=Vx,gt++}}}}function rn(ds,Il){let ru=[],uu=Il.filter(q0=>q0.enabled&&q0.mode==="Include").map(q0=>q0.type==="Box"?un(q0):ts(q0)),p0=Il.filter(q0=>q0.enabled&&q0.mode==="Exclude").map(q0=>q0.type==="Box"?un(q0):ts(q0)),X1=ds.length;for(let q0=0;q0<X1;q0+=3){let W0=ds[q0],hu=ds[q0+1],a1=ds[q0+2];(uu.length===0||Tn(W0,hu,a1,uu))&&(p0.length===0||!Tn(W0,hu,a1,p0))||ru.push(q0/3)}return ru}function Tn(ds,Il,ru,uu,p0){return uu.some(X1=>{let q0=$n(ds,Il,ru,X1.invRotationMatrix,X1.cropCenter);return Array.isArray(X1)?kn(q0.x,q0.y,q0.z,X1):Ko(q0.x,q0.y,q0.z,X1)})}function $n(ds,Il,ru,uu,p0){let X1=ds-p0[0],q0=Il-p0[1],W0=ru-p0[2],hu=1/(uu[3]*X1+uu[7]*q0+uu[11]*W0+uu[15]);return{x:(uu[0]*X1+uu[4]*q0+uu[8]*W0+uu[12])*hu+p0[0],y:(uu[1]*X1+uu[5]*q0+uu[9]*W0+uu[13])*hu+p0[1],z:(uu[2]*X1+uu[6]*q0+uu[10]*W0+uu[14])*hu+p0[2]}}function un(ds){let Il=ds.cropSize[0]/2,ru=ds.cropSize[1]/2,uu=ds.cropSize[2]/2,p0=[ds.cropCenter[0]-Il,ds.cropCenter[1]-ru,ds.cropCenter[2]-uu,ds.cropCenter[0]+Il,ds.cropCenter[1]+ru,ds.cropCenter[2]+uu],X1=es(ds.cropRotation);return Object.assign(p0,{invRotationMatrix:X1,cropCenter:ds.cropCenter})}function es(ds){let Il=[],ru=ds[0]*Math.PI/180,uu=ds[1]*Math.PI/180,p0=ds[2]*Math.PI/180,X1=Math.cos(ru),q0=Math.sin(ru),W0=Math.cos(uu),hu=Math.sin(uu),a1=Math.cos(p0),Vx=Math.sin(p0),t0=X1*a1,cu=X1*Vx,lu=q0*a1,b0=q0*Vx;return Il[0]=W0*a1,Il[1]=-W0*Vx,Il[2]=hu,Il[4]=cu+lu*hu,Il[5]=t0-b0*hu,Il[6]=-q0*W0,Il[8]=b0-t0*hu,Il[9]=lu+cu*hu,Il[10]=X1*W0,Il[12]=0,Il[13]=0,Il[14]=0,Il[3]=0,Il[7]=0,Il[11]=0,Il[15]=1,Il}function kn(ds,Il,ru,uu){return ds>=uu[0]&&ds<=uu[3]&&Il>=uu[1]&&Il<=uu[4]&&ru>=uu[2]&&ru<=uu[5]}function ts(ds){let Il=2/ds.cropSize[0],ru=2/ds.cropSize[1],uu=2/ds.cropSize[2],p0=es(ds.cropRotation);return{invRadiusX:Il,invRadiusY:ru,invRadiusZ:uu,cropCenter:ds.cropCenter,invRotationMatrix:p0}}function Ko(ds,Il,ru,uu){let p0=(ds-uu.cropCenter[0])*uu.invRadiusX,X1=(Il-uu.cropCenter[1])*uu.invRadiusY,q0=(ru-uu.cropCenter[2])*uu.invRadiusZ;return p0*p0+X1*X1+q0*q0<=1}nt.onmessage=ds=>{if(ds.data.getCroppedIndexes){let Il=new Uint32Array(rn(new Float32Array(ds.data.positions),ds.data.crops)).buffer;nt.postMessage({outOfBoundsIndexes:Il},[Il])}else if(ds.data.positions)Gt=ds.data.positions,Mr=new Float32Array(Gt),zr=ds.data.meshMatrixWorlds,Fr=ds.data.cropsArray,Tr=ds.data.meshIndexIntervals,tn(zr,Fr,Tr),nt.postMessage({sortSetupComplete:!0});else if(ds.data.sort||ds.data.newMatrixWorlds||ds.data.newCropsArray)(ds.data.newMatrixWorlds||ds.data.newCropsArray)&&(Fr=ds.data.newCropsArray||Fr,zr=ds.data.newMatrixWorlds||zr,tn(zr,Fr,Tr)),Nr(ds.data.sort.view,ds.data.sort.cameraPosition);else if(ds.data.init){dr=ds.data.init.Constants,mt=ds.data.init.splatCount;let Il=dr.BytesPerInt,ru=dr.BytesPerFloat*3,uu=new Uint8Array(ds.data.init.sorterWasmBytes),p0=Il+ru,X1=mt*p0,q0=mt*dr.BytesPerInt*2+dr.DepthMapRange*dr.BytesPerInt*2,W0=dr.MemoryPageSize*32,hu=X1+q0+W0,a1=Math.floor(hu/dr.MemoryPageSize)+1,Vx={module:{},env:{memory:new WebAssembly.Memory({initial:a1*2,maximum:a1*3,shared:!0})}};WebAssembly.compile(uu).then(t0=>WebAssembly.instantiate(t0,Vx)).then(t0=>{st=t0,_t=0,Et=mt*Il,At=Et+mt*ru,Nt=At+16*dr.BytesPerFloat*2,Rt=Nt+mt*dr.BytesPerInt,Ft=Rt+dr.DepthMapRange*dr.BytesPerInt,Bt=Vx.env.memory.buffer,nt.postMessage({sortSetupPhase1Complete:!0})})}}}function QL(nt){let st=new Worker(URL.createObjectURL(new Blob(["(",XK.toString(),")(self)"],{type:"application/javascript"}))),mt=atob(XL),gt=new Uint8Array(mt.length);for(let _t=0;_t<mt.length;_t++)gt[_t]=mt.charCodeAt(_t);return st.postMessage({init:{sorterWasmBytes:gt.buffer,splatCount:nt,Constants:{BytesPerFloat:ko.BytesPerFloat,BytesPerInt:ko.BytesPerInt,DepthMapRange:ko.DepthMapRange,MemoryPageSize:ko.MemoryPageSize}}}),st}var Kx=function(){let nt=new Float32Array(1),st=new Int32Array(nt.buffer);return function(mt){return nt[0]=mt,st[0]}}(),KL=function(nt,st,mt,gt){return nt+(st<<8)+(mt<<16)+(gt<<24)},Zx=new U$1;function Jx(nt){let st=!1;return nt.scene.objects.traverse((mt,gt)=>{if(gt.visible===!1)return!0;gt.type==="Splat"&&(st=!0)}),st}var Jl=class extends Ut{constructor(nt,st,mt,gt,_t=!1,Et=1,At,Rt){super(mt,gt),this.splatCount=st,this.meshIndexIntervals=At,this.meshMatrixWorlds=Rt,this.splatBuffers=nt,this.geometry=mt,this.material=gt,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=_t,this.devicePixelRatio=Et,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(nt,st,mt=!1,gt=1,_t,Et){let At=Jl.buildGeomtery(st),Rt=Jl.buildMaterial(_t);return new Jl(nt,st,At,Rt,mt,gt,_t,Et)}static buildMaterial(nt){let st=`
            precision highp float;
            #include <common>

            attribute uint splatIndex;

            uniform highp sampler2D covariancesTexture;
            uniform highp usampler2D centersColorsTexture;
            uniform vec2 focal;
            uniform vec2 viewport;
            uniform vec2 basisViewport;
            uniform vec2 covariancesTextureSize;
            uniform vec2 centersColorsTextureSize;
						uniform highp sampler2D meshMatrixWorldsTexture;
						uniform uint meshIndexIntervals[257];
						uniform float orthoZoom;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;

            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);
            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));
            const uvec4 shift4 = uvec4(0, 8, 16, 24);
            vec4 uintToRGBAVec (uint u) {
               uvec4 urgba = mask4 & u;
               urgba = urgba >> shift4;
               vec4 rgba = vec4(urgba) * encodeNorm4;
               return rgba;
            }

            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {
                vec2 samplerUV = vec2(0.0, 0.0);
                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;
                samplerUV.y = float(floor(d)) / dimensions.y;
                samplerUV.x = fract(d);
                return samplerUV;
            }

            void main () {
                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));
                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));
                vColor = uintToRGBAVec(sampledCenterColor.r);

                vPosition = position.xy * 2.0;

								uint meshIndex;
								for (int i = 1; i < 257; i++) {
									if (splatIndex < meshIndexIntervals[i]) {
										meshIndex = uint(i - 1);
										break;
									}
								}

								float strideMulmeshIndex = float(4u*meshIndex);
								float meshMatrixWorldsTextureLength = float(256*4);

								mat4 modelMat = mat4(
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))
								);
								mat4 modelViewMat = viewMatrix * modelMat;
								vec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); 
                vec4 clipCenter = projectionMatrix * viewCenter;

                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;
                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;
                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;

                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);
                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);

                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix
                mat3 Vrk = mat3(
                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,
                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,
                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z
                );
                float s = 1.0 / (viewCenter.z * viewCenter.z);

                mat3 W = transpose(mat3(modelViewMat));
                mat3 T = orthoZoom > 0.0 ? W : W * mat3(
									focal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,
									0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,
									0., 0., 0.
								);
                mat3 cov2Dm = transpose(T) * Vrk * T;
                cov2Dm[0][0] += 0.3;
                cov2Dm[1][1] += 0.3;

                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because
                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],
                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't
                // need cov2Dm[1][0] because it is a symetric matrix.
                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);

                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix
                // so that we can determine the 2D basis for the splat. This is done using the method described
                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html
                //
                // This is a different approach than in the original work at INRIA. In that work they compute the
                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle
                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance
                // matrix (called 'conic') to determine fragment opacity.
                float a = cov2Dv.x;
                float d = cov2Dv.z;
                float b = cov2Dv.y;
                float D = a * d - b * b;
                float trace = a + d;
                float traceOver2 = 0.5 * trace;
                float term2 = sqrt(trace * trace / 4.0 - D);
                float eigenValue1 = traceOver2 + term2;
								float eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value

                const float maxSplatSize = 1024.0;
                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));
                // since the eigen vectors are orthogonal, we derive the second one from the first
                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);
                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);
                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);

                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;

								if (orthoZoom > 0.0) {
									ndcOffset *= orthoZoom;
								}

                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);
            }`,mt=`
            precision highp float;
            #include <common>

            uniform vec3 debugColor;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;
						layout(location = 1) out vec4 gVelocity; 

            void main () {
                // compute the negative squared distance from the center of the splat to the
                // current fragment in the splat's local space.
                float A = -dot(vPosition, vPosition);
                if (A < -4.0) discard;
                vec3 color = vColor.rgb;
                A = exp(A) * vColor.a;
                gl_FragColor = vec4(color.rgb, A);
								gVelocity = vec4(0.0); // so it is ignored by TAA
            }`,gt={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:nt},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new U$1},viewport:{type:"v2",value:new U$1},basisViewport:{type:"v2",value:new U$1},debugColor:{type:"v3",value:new We$1},covariancesTextureSize:{type:"v2",value:new U$1(1024,1024)},centersColorsTextureSize:{type:"v2",value:new U$1(1024,1024)},orthoZoom:{type:"f",value:-1}};return new it$1({uniforms:gt,vertexShader:st,fragmentShader:mt,transparent:!0,alphaTest:1,blending:Ya,depthTest:!0,depthWrite:!1,side:fi})}static buildGeomtery(nt){let st=new _e$1;st.setIndex([0,1,2,0,2,3]);let mt=new Float32Array(4*3),gt=new Xe$1(mt,3);st.setAttribute("position",gt),gt.setXYZ(0,-1,-1,0),gt.setXYZ(1,-1,1,0),gt.setXYZ(2,1,1,0),gt.setXYZ(3,1,-1,0),gt.needsUpdate=!0;let _t=new xp().copy(st),Et=new Uint32Array(nt),At=new fo$1(Et,1,!1);return At.setUsage(qC),_t.setAttribute("splatIndex",At),_t.instanceCount=nt,_t}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(gt=>gt.buildPreComputedBuffers()),this.covariances=new Float32Array(this.splatCount*6),this.colors=new Uint8Array(this.splatCount*4),this.centers=new Float32Array(this.splatCount*3);let nt=0,st=0,mt=0;for(let gt of this.splatBuffers){let _t=gt.nsplats;this.colors.subarray(nt,nt+_t*4).set(gt.colorsA),nt+=_t*4,this.centers.subarray(st,st+_t*3).set(gt.decoded.xyz.denormDequant().data),st+=_t*3,this.covariances.subarray(mt,mt+_t*6).set(new Float32Array(gt.precomputedCovarianceBufferData)),mt+=_t*6}}allocateAndStoreLocalSplatDataInTextures(){let nt=this.splatCount,st=new U$1(4096,1024);for(;st.x*st.y*2<nt*6;)st.y*=2;let mt=new U$1(4096,1024);for(;mt.x*mt.y*4<nt*4;)mt.y*=2;let gt,_t;if(this.halfPrecisionCovariancesOnGPU){_t=new Uint16Array(st.x*st.y*2);for(let Bt=0;Bt<this.covariances.length;Bt++)_t[Bt]=aP.toHalfFloat(this.covariances[Bt]);gt=new gi(_t,st.x,st.y,Ju,Wn)}else _t=new Float32Array(st.x*st.y*2),_t.set(this.covariances),gt=new gi(_t,st.x,st.y,Ju,br);gt.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=gt,this.material.uniforms.covariancesTextureSize.value.copy(st);let Et=new Uint32Array(mt.x*mt.y*4);for(let Bt=0;Bt<nt;Bt++){let Gt=Bt*4,dr=Bt*3,Mr=Bt*4;Et[Mr]=KL(this.colors[Gt],this.colors[Gt+1],this.colors[Gt+2],this.colors[Gt+3]),Et[Mr+1]=Kx(this.centers[dr]),Et[Mr+2]=Kx(this.centers[dr+1]),Et[Mr+3]=Kx(this.centers[dr+2])}let At=new gi(Et,mt.x,mt.y,ww,Ds);At.internalFormat="RGBA32UI",At.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=At,this.material.uniforms.centersColorsTextureSize.value.copy(mt);let Rt=256*4,Ft=new Float32Array(256*16);for(let Bt=0;Bt<this.meshMatrixWorlds.length;Bt++)Ft.set(this.meshMatrixWorlds[Bt].elements,Bt*16);let Nt=new gi(Ft,Rt,1,qr,br);Nt.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=Nt,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:_t,texture:gt,size:st},centerColors:{data:Et,texture:At,size:mt},meshMatrixWorlds:{data:Ft,texture:Nt}}}updateIndexes(nt){let st=this.geometry;st.attributes.splatIndex.set(nt),st.attributes.splatIndex.needsUpdate=!0,st.instanceCount=nt.length}updateUniforms(nt,st,mt,gt){this.splatCount>0&&(Zx.set(nt.x*this.devicePixelRatio,nt.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(Zx),this.material.uniforms.basisViewport.value.set(2/Zx.x,2/Zx.y),this.material.uniforms.focal.value.set(st,mt),this.material.uniforms.orthoZoom.value=gt,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose()),this.removeFromParent()}},JL,iM=new Promise(nt=>{JL=nt}),ZL=!1,$x;function nM(){if(ZL)return;if($x)return $x;async function nt(){let st=await __vitePreload(()=>import("./gaussian-splat-compression-ro4O0smp.js"),[]);JL(st),ZL=!0}return $x=nt(),$x}var $L;iM.then(nt=>$L=nt);var Fm=class{constructor(nt={}){nc(this,"updateView",function(){let st=new ue$1,mt=[],gt=new E$6(0,0,-1),_t=new E$6(0,0,-1),Et=new E$6,At=new E$6;return function(Rt=!1,Ft){let Nt=this.updateMatrixWorldsInWorkerIfNeeded(),Bt=this.cropsChanged();if(!Rt){_t.set(0,0,-1).applyQuaternion(Ft.quaternion);let dr=!1,Mr=!1;if(_t.dot(gt)<=.95&&(dr=!0),At.copy(Ft.position).sub(Et).length()>=1&&(Mr=!0),!dr&&!Mr&&!Nt&&!Bt&&!this.needsInitialRender)return}this.needsInitialRender=!1,Et.copy(Ft.position),gt.copy(_t),st.copy(Ft.matrixWorld).invert(),st.premultiply(this.dummyPerspectiveMatrix),mt[0]=Ft.position.x,mt[1]=Ft.position.y,mt[2]=Ft.position.z;let Gt={sort:{view:st.elements,cameraPosition:mt,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...Nt?{newMatrixWorlds:this.meshMatrixWorlds}:{},...Bt?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=Gt:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(Gt))}}()),this.scene=nt.scene,this.currentPage=null,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null,this.needsInitialRender=!0,this.dummyPerspectiveMatrix=new ue$1().makePerspective(-1,1,-1,1,.1,1e3)}updateSplatMeshUniforms(nt,st){let mt=new U$1;this.splatMesh!==null&&this.splatMesh.getSplatCount()>0&&(nt.getSize(mt),this.cameraFocalLengthX=st.projectionMatrix.elements[0]*this.devicePixelRatio*mt.x*.45,this.cameraFocalLengthY=st.projectionMatrix.elements[5]*this.devicePixelRatio*mt.y*.45,this.splatMesh.updateUniforms(mt,this.cameraFocalLengthX,this.cameraFocalLengthY,st.isPerspectiveCamera?-1:st.zoom*this.devicePixelRatio))}loadSplat(nt={}){this.activePage=this.scene.activePage,nt.position&&(nt.position=new E$6().fromArray(nt.position)),nt.orientation&&(nt.orientation=new Qe$1().fromArray(nt.orientation)),nt.halfPrecisionCovariances=!!nt.halfPrecisionCovariances;let st=[];if(this.splatEntries=st,this.activePage.traverseVisibleEntity(Et=>{Et.data.type==="Splat"&&st.push(Et)}),this.splatMesh&&this.splatMesh.dispose(),st.length===0)return this.splatMesh=null,!1;this.meshMatrixWorlds=st.map(Et=>Et.matrixWorld),this.meshMatrixWorldsOld=st.map(Et=>Et.matrixWorld.clone()),this.cropsArray=st.map(Et=>Et.data.crops.map(At=>At.data));let mt=st.map(Et=>new $L.GSplineBuffer(new Uint8Array(Et.data.buffer).buffer)),gt=0,_t=[0];for(let Et of mt)gt+=Et.getSplatCount(),_t.push(gt);return this.setupSplatMesh(mt,gt,nt.position,nt.orientation,nt.halfPrecisionCovariances,this.devicePixelRatio,_t,this.meshMatrixWorlds),this.setupSortWorker(gt),!0}updateMatrixWorldsInWorkerIfNeeded(){let nt=this.splatDataTextures.meshMatrixWorlds.data;for(let st=0;st<this.meshMatrixWorlds.length;st++)nt.set(this.meshMatrixWorlds[st].elements,st*16);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,this.meshMatrixWorlds.every((st,mt)=>st.equals(this.meshMatrixWorldsOld[mt]))?!1:(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(st=>st.clone()),!0)}cropsChanged(){let nt=!1;return this.splatEntries.forEach((st,mt)=>{var gt;st.data.crops.forEach((_t,Et)=>{this.cropsArray[mt][Et]===void 0?(nt=!0,this.cropsArray[mt][Et]=_t.data):Object.entries(_t.data).forEach(([At,Rt])=>{var Ft;Array.isArray(Rt)&&Rt.some((Nt,Bt)=>Nt!==this.cropsArray[mt][Et][At][Bt])?(nt=!0,this.cropsArray[mt][Et][At]=Rt):Rt!==((Ft=this.cropsArray[mt][Et])==null?void 0:Ft[At])&&(nt=!0,this.cropsArray[mt][Et][At]=Rt)})}),st.data.crops.length!==((gt=this.cropsArray[mt])==null?void 0:gt.length)&&(this.cropsArray[mt].length=st.data.crops.length,nt=!0)}),nt}setupSplatMesh(nt,st,mt=new E$6,gt=new Qe$1,_t=!1,Et=1,At,Rt){this.splatMesh=Jl.buildMesh(nt,st,_t,Et,At,Rt),this.splatMesh.position.copy(mt),this.splatMesh.quaternion.copy(gt),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=99999,this.splatRenderCount=st,this.splatMesh.onBeforeRender=(Ft,Nt,Bt)=>this.update(Ft,Bt)}setupSortWorker(nt){this.sortWorker=QL(nt),this.sortWorker.onmessage=st=>{var mt;st.data.sortDone?(this.sortRunning=!1,(mt=this.splatMesh)==null||mt.updateIndexes(new Uint32Array(st.data.indexesBuffer)),this.lastSortTime=st.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):st.data.sortCanceled?this.sortRunning=!1:st.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):st.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.scene.activePage.add(this.splatMesh),this.needsInitialRender=!0)}}update(nt,st){this.splatMesh!==null&&(this.updateSplatMeshUniforms(nt,st),this.updateView(!1,st))}getSplatMesh(){return this.splatMesh}},_x=new on;_x.wireframe=!0;var eB=new E$6,Hl=class extends ei{constructor(nt,st){super(),this.data=nt,this.sharedAssets=st,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new Qx,this.invisibleObjects=new ws("jflkdsafjasdifjaslk",{...Hv.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(nt,st),this.matrixAutoUpdate=!1,this.errorPage=new cr("fdasfa",{...ya.defaultData,name:""},{shared:st,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=YL(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=qL(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(nt){let st=nt.identity.join("-"),mt=this.entityIdentityToEntity[st];mt&&(nt.uuid=mt.uuid),this.entityIdentityToEntity[st]=nt,this.entityByUuid[nt.uuid]=nt}markPenumbraSizeDirty(){for(let nt of this.children)nt instanceof cr&&(nt.penumbraSizeArrayCache=null)}findInstance(nt){return this.entityIdentityToEntity[nt.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(nt){let st=this.find(nt);if(st===void 0)return;let mt=[],gt=st;for(;gt!==this;){let _t=gt;gt=gt.parent;let Et=gt.children.indexOf(_t);mt.splice(0,0,Et)}return{entity:st,sortKey:mt}}getAllSorted(nt){let st=[];for(let mt of nt){let gt=this.getWithSortKey(mt.id);gt!==void 0&&st.push(gt)}return st.sort((mt,gt)=>rv(mt.sortKey,gt.sortKey)),st.map(mt=>mt.entity)}nonExistOrDescendantOf(nt,st){let mt=this.find(nt);if(mt===void 0)return!0;for(;mt;){if(mt.uuid===st)return!0;mt=mt.parent}return!1}find(nt){if(this.activePage&&this.activePage.personalCamera.parent){if(nt==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(nt===hs)return this.activePage.personalCamera}if(nt===""||nt===void 0)return;let st=this.entityByUuid[nt];return st===void 0?this.getObjectByProperty("uuid",nt):st}find2D(nt){for(let st of this.children)if(st instanceof cr&&st.uiScene){let mt=st.uiScene.find(nt);if(mt)return mt}}findScene2DfromObject2D(nt){for(let st of this.children)if(st instanceof cr&&st.uiScene&&st.uiScene.find(nt))return st.uiScene}find2DInUIObjects(nt){let st;return this.traverseEntity(mt=>{st===void 0&&mt instanceof Er&&(st=mt.uiCanvas.find(nt))}),st}traverse2D(nt){for(let st of this.children)st instanceof cr&&st.uiScene&&st.uiScene.traverse(nt)}debugEnsureEntity(nt){let st=this.find(nt);if(st){if(Array.isArray(st.identity)&&this.findInstance(st.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(nt){this.toExpandCloner.add(nt)}addPendingUpdateCloner(nt){this.toUpdateCloner.add(nt)}markToExpandCloner(nt){this.toExpandCloner.add(nt),nt.traverseEntityAncestors(st=>{this.toExpandCloner.add(st)})}doPendingExpandCloner(){this.toExpandCloner.forEach(nt=>{nt.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(nt=>{var st;(st=nt.cloner)==null||st.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(nt){this.pendingCommands.push(nt)}applyPendingCommands(){this.pendingCommands.forEach(nt=>nt()),this.pendingCommands.length=0}updateByLibOp(nt,st){nt.path.length===1&&nt.path[0]==="components"&&nt.type===1&&this.createChildrenObjects([{...nt.data.asset,id:nt.id}],this.invisibleObjects,st)}updateTreeByOp(nt,st){var mt;if(nt.path.length===0&&nt.type===7){let gt=nt.parent===null?this:this.find(nt.parent);if(gt===void 0)throw new Error("unexpected");let _t=this.createObject(nt.id,nt.data,nt.children,gt,nt.localIndex,st);_t.updateVisible(this),_t.resetBBoxNeedsUpdate(),cn(_t)&&En(_t.parent)&&(_t.invalidateUpstreamBooleanData(),_t.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(gt),this.markNeedsRecomputeInstancesForChildren(_t),this.markToExpandCloner(_t),this.markPenumbraSizeDirty(),_t.updatePathSnapping()}else if(nt.path.length===0&&nt.type===8){let gt=this.find(nt.id);if(gt===void 0)throw new Error("unexpected");this.markToExpandCloner(gt),gt.resetBBoxNeedsUpdate(),this.unregisterObject(gt);let _t=gt.parent;this.markNeedsRecomputeInstancesForAncessors(_t),this.markNeedsRecomputeInstancesForChildren(gt),this.markPenumbraSizeDirty(),gt.parent.remove(gt),En(gt.parent)&&(gt.parent.invalidateUpstreamBooleanData(),gt.parent.invalidateDownstreamBooleanData().recomputeBoolean()),cn(gt)&&(gt.freeBooleanPointer(),_t instanceof Fn&&_t.invalidateDownstreamBooleanData().recomputeBoolean()),gt instanceof Xl&&gt.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(gt),this.pathConstraints.removeDependencies(gt.uuid),gt.updatePathSnapping()}else if(nt.path.length===0&&nt.type===9){let gt=this.find(nt.id);if(gt===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(gt);let _t=gt.parent;this.markNeedsRecomputeInstancesForAncessors(_t),(mt=gt.cloner)==null||mt.resetOnMove(),this.markToExpandCloner(gt);let Et=nt.parent===null?this:this.find(nt.parent);if(Et===void 0)throw new Error("unexpected");Et.add(gt),this.markNeedsRecomputeInstancesForAncessors(Et),this.markToExpandCloner(gt),gt.invalidateClonerTransform(gt),gt.updateVisible(this),gt.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let At=nt.localIndex;Et.children.splice(At,0,Et.children.pop()),cn(gt)&&(gt.invalidateUpstreamBooleanData(),En(gt.parent)?gt.parent.invalidateDownstreamBooleanData().recomputeBoolean():_t instanceof Fn&&_t.invalidateDownstreamBooleanData().recomputeBoolean()),gt.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(nt){var st;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let mt of this.children)mt instanceof cr&&(mt.visible=mt.uuid===nt,mt.visible&&(this.activePage=mt,this.activePage.onActive(this)));this.activePage!==((st=this.splatViewer)==null?void 0:st.activePage)&&this.reloadSplats()}updateEntityByOp(nt,st,mt,gt){if(st.type===0){if(("overrides"in st.props||"component"in st.props)&&this.markNeedsRecomputeInstances(),"visible"in st.props&&this.markPenumbraSizeDirty(),st.path.includes("overrides")&&"states"in st.props){let{rest:Et}=st.props;st={...st,props:Et},this.markNeedsRecomputeInstances()}st.path[0]==="pathSnapping"&&st.props.pathId!==void 0&&this.pathConstraints.setConstraint(nt,st.props.pathId)}let _t=this.find(nt);if(_t)try{jL(_t,st,mt,{scene:this,shared:gt}),_t instanceof lr&&_t.updateGeometryGroupsIfNeeded()}catch(Et){console.error(Et)}}updateEntity2DByOp(nt,st,mt,gt,_t,Et=[]){nt.updateEntityByOp(st,mt,gt,_t),this.traverseEntity(At=>{(At instanceof Er||At instanceof cr)&&(Et.includes(At.frameId??"")||At.frameId===st)&&At.updateEntity2DByOp(st,mt,gt,_t)})}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(nt){this.activePage.switchActiveCamera(nt)}isInvisibleObjects(nt){return nt===this.invisibleObjects||nt.hasAnccestor(this.invisibleObjects)}init(nt,st){let mt=Object.entries(st.data.lib.components).map((gt,_t)=>({data:gt[1].asset.data,children:gt[1].asset.children,id:gt[0],fi:_t}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:st}),this.add(this.invisibleObjects),this.createChildrenObjects(mt,this.invisibleObjects,st),this.createChildrenObjects(nt.objects,this,st),this.updatePage(nt.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(st,!0),this.traverseEntity(gt=>{gt instanceof wr&&gt.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(nt){nt.traverseEntity(st=>{(st.data.type==="Component"||st.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(nt){yt.is(nt)&&(nt.data.type==="Component"&&this.markNeedsRecomputeInstances(),nt.traverseAncestors(st=>{yt.is(st)&&st.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(nt,st,mt,gt,_t,Et,At){if(nt){let Rt=gt.find(nt);Rt&&Rt!==gt&&_t.forInstancesRec(Ft=>{Ft.data=pl(Ft.data,Nt=>{let Bt=Nt.events.data(At.id),Gt=Ft.goUp(Et);if(Gt){let dr=[...tv(Gt.identity),nt].join("-"),Mr=this.entityIdentityToEntity[dr];if(Mr){let Tr=Mr.uuid,zr=Sr.zoom(Bt,st);zr[mt]=Tr}else console.warn("cannot find instance")}}).data})}}rewriteActions(nt,st,mt,gt,_t,Et){nt.forEach(At=>{At.data.type==="Transition"?this.relativeizeInner(At.data.object,[...st,At.id],"object",mt,gt,_t,Et):At.data.type==="Animation"?this.relativeizeInner(At.data.object,[...st,At.id],"object",mt,gt,_t,Et):At.data.type==="Conditional"&&(this.rewriteActions(At.data.ifActions,[...st,At.id,"ifActions"],mt,gt,_t,Et),this.rewriteActions(At.data.elseActions,[...st,At.id,"elseActions"],mt,gt,_t,Et))})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(nt=>{if(nt instanceof $s&&typeof nt.identity=="string"&&nt.data.type==="Component")return nt.traverseEntity((st,mt)=>{st.data.events.forEach(gt=>{if(gt.data.type==="GameControl"){let _t=!1;if(st.forInstancesRec(Et=>{Et.data=pl(Et.data,At=>{Et.isInstanceRoot||(At.events.delete(gt.id),_t=!0)}).data}),_t===!1)for(let Et of Xh.list)this.rewriteActions(gt.data.gameActions[Et],["gameActions",Et],nt,st,mt,gt)}else gt.data.type==="Conditional"?(gt.data.condition.type==="Distance"?(this.relativeizeInner(gt.data.condition.fromObject,["condition"],"fromObject",nt,st,mt,gt),this.relativeizeInner(gt.data.condition.toObject,["condition"],"toObject",nt,st,mt,gt)):gt.data.condition.type==="State"?this.relativeizeInner(gt.data.condition.object,["condition"],"object",nt,st,mt,gt):gt.data.condition.type==="Comparison"&&(gt.data.condition.lOperand.type==="Property"&&this.relativeizeInner(gt.data.condition.lOperand.value[0],["condition","lOperand","value"],0,nt,st,mt,gt),gt.data.condition.rOperand.type==="Property"&&this.relativeizeInner(gt.data.condition.rOperand.value[0],["condition","rOperand","value"],0,nt,st,mt,gt)),this.rewriteActions(gt.data.inActions,["inActions"],nt,st,mt,gt),this.rewriteActions(gt.data.outActions,["outActions"],nt,st,mt,gt)):"actions"in gt.data&&this.rewriteActions(gt.data.actions,["actions"],nt,st,mt,gt)})}),!0})}expandInstances(nt,st,mt){let gt=new Set;this.traverseEntity(_t=>{if(_t instanceof $s&&_t.isInstanceRoot)return _t.expandInstanceChildren({scene:this,shared:nt,pendingDeletes:gt}),st||_t.resetBBoxNeedsUpdate(),mt&&_t.traverseEntity(Et=>{mt.addClip(Et)}),!0});for(let _t of gt)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(_t),kx(_t)}recomputeInstances(nt,st){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(mt=>{mt instanceof $s&&mt.isInstanceRoot&&(mt.component=void 0)}),this.expandInstances(nt,!1,st))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(nt){nt.traverseEntity(st=>{let mt=typeof st.identity=="string"?st.identity:st.identity.join("-");this.entityIdentityToEntity[mt]===st&&(delete this.entityByUuid[st.uuid],delete this.entityIdentityToEntity[mt]),st.dispose()})}clearScene(){for(let nt of this.children)yt.is(nt)&&nt.disposeRecursively();this.children.length=0}resetAfterClear(nt,st){this.init(nt,st)}raycast(nt){return this.raycast1(nt,!1)}raycast1(nt,st){let mt=[],gt=_t=>{for(let Et of _t.children){let At=Et.cloner;if(yt.is(Et)&&!Et.raycastLock&&(Et.visible||At!=null&&At.object.data.visible))if(st===!0&&Et.isInstanceRoot){let Rt=[];if(nt.intersectObject(Et,!0,Rt),Rt.length){let Ft=Rt[0];Ft.object=Et,Ft.point.applyMatrix4(Ft.object.matrixWorld);let Nt=Et.matrixWorld.clone().invert();Ft.point.applyMatrix4(Nt),mt.push(Ft)}}else(cn(Et)||Cm(Et)&&this.enableHelpers&&Et.objectHelper.visible)&&(nt.intersectObject(Et,!1,mt),Nm(Et,nt,mt)),gt(Et)}};return gt(this.activePage),mt}raycastWithClones(nt){let st=[],mt=gt=>{for(let _t of gt.children){let Et=_t.cloner;yt.is(_t)&&(_t.visible||Et!=null&&Et.object.data.visible)&&((cn(_t)||Cm(_t)&&this.enableHelpers&&_t.objectHelper.visible)&&(nt.intersectObject(_t,!1,st),Nm(_t,nt,st,!0)),mt(_t))}};return mt(this),st}forEachEntity(nt){for(let st of this.children)yt.is(st)&&nt(st)}traverseConcreteEntity(nt){for(let st of this.children)yt.is(st)&&st.isConcreteEntity&&st.traverseEntity(nt)}traverseEntity(nt){for(let st of this.children)yt.is(st)&&st.traverseEntity(nt)}updateFont(nt,st){this.traverseEntity(mt=>{if(mt instanceof lr&&mt.data.type==="Mesh"&&(mt.data.geometry.type==="TextGeometry"||mt.data.geometry.type==="InputGeometry")&&mt.data.geometry.font===nt){let gt=mt.geometry,_t=mt.data.geometry;gt.updateFont(nt,st).then(()=>{gt.update(_t);let Et=mt.invalidateDownstreamBooleanData();En(Et)&&Et.recomputeBoolean()})}})}traverseObject(nt){for(let st of this.children)dd.is(st)&&st.traverseObject(nt)}traverseVisibleEntity(nt){for(let st of this.children)yt.is(st)&&st.visible&&st.traverseVisibleEntity(nt)}dispose(){this.clearScene()}createChildrenObjects(nt,st,mt){let gt=0;for(let _t of nt)this.createObject(_t.id,_t.data,_t.children,st,gt,mt),gt+=1}registerObjectCreatedInLegacy(nt){this.entityByUuid[nt.uuid]=nt}unregisterObject(nt){delete this.entityByUuid[nt.uuid];for(let st of nt.children)this.unregisterObject(st)}createObject(nt,st,mt,gt,_t,Et){var Ft;let At={scene:this,shared:Et},Rt=Xx(nt,st,At);return Rt&&(this.entityByUuid[nt]=Rt,gt.add(Rt),gt.children.splice(_t,0,gt.children.pop()),mt.length>0&&(Rt.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(mt,Rt,Et)),Rt.updateState(st,At),Rt instanceof lr&&Rt.updateGeometryGroupsIfNeeded(),Rt.updateVisible(this),Rt.cloner&&this.toExpandCloner.add(Rt),(Ft=st.pathSnapping)!=null&&Ft.pathId&&this.pathConstraints.setConstraint(nt,st.pathSnapping.pathId)),st.type==="Empty"&&st.animations&&Rt.traverseEntity(Nt=>{let Bt=Nt.dataPatched;if(Nt instanceof lr&&Bt.bones&&Bt.boneInverses){let Gt=Bt.bones.map(Tr=>this.find(Tr)),dr=Bt.boneInverses.map(Tr=>new ue$1().fromArray(Tr)),Mr=new $a(Gt,dr);Nt.bind(Mr,Nt.bindMatrix)}else Nt.matrixAutoUpdate=!0}),Rt}getCenter(nt){let st=[];for(let gt=0,_t=nt.length;gt<_t;++gt){let{id:Et,recursive:At}=nt[gt],Rt=this.find(Et),Ft=At?Rt.recursiveBBox:Rt.singleBBox;st.push(...Ft.vertices)}let mt=new jt;return mt.setFromPoints(st),mt.getCenter(eB),eB}copyMatrixWorld(nt,st){if(nt===null){st.identity();return}let mt=this.find(nt);mt?st.copy(mt.matrixWorld):st.identity()}copyParentMatrixWorld(nt,st){var gt;if(nt===null){st.identity();return}let mt=(gt=this.find(nt))==null?void 0:gt.parent;mt?st.copy(mt.matrixWorld):st.identity()}traverseMaterial(nt){this.traverseEntity(st=>{if(st instanceof mr)if(Array.isArray(st.material))for(let mt=0;mt<st.material.length;mt++)st.material[mt]instanceof Nn&&nt(st.material[mt]);else st.material instanceof Nn&&nt(st.material)})}updateViewPlaneSize(nt,st,mt=!1){this.traverseConcreteEntity(gt=>{gt instanceof wr&&gt.setViewplaneSize(nt,st,mt)})}initializeSplatViewer(){this.splatViewer=new Fm({scene:this}),this.reloadSplats()}reloadSplats(){var nt;(nt=this.splatViewer)==null||nt.loadSplat()}},Vm=(nt,st)=>{let mt=st.x-nt.x,gt=st.y-nt.y;return Math.sqrt(mt*mt+gt*gt)},tB=(nt,st)=>{let mt=st.x-nt.x,gt=st.y-nt.y;return QK(Math.atan2(gt,mt))},rB=(nt,st,mt)=>{let gt={x:0,y:0};return mt=eb(mt),gt.x=nt.x-st*Math.cos(mt),gt.y=nt.y-st*Math.sin(mt),gt},eb=nt=>nt*(Math.PI/180),QK=nt=>nt*(180/Math.PI),iB=nt=>isNaN(nt.buttons)?nt.pressure!==0:nt.buttons!==0,sM=new Map,oM=nt=>{sM.has(nt)&&clearTimeout(sM.get(nt)),sM.set(nt,setTimeout(nt,100))},Cf=(nt,st,mt)=>{let gt=st.split(/[ ,]+/g),_t;for(let Et=0;Et<gt.length;Et+=1)_t=gt[Et],nt.addEventListener?nt.addEventListener(_t,mt,!1):nt.attachEvent&&nt.attachEvent(_t,mt)},aM=(nt,st,mt)=>{let gt=st.split(/[ ,]+/g),_t;for(let Et=0;Et<gt.length;Et+=1)_t=gt[Et],nt.removeEventListener?nt.removeEventListener(_t,mt):nt.detachEvent&&nt.detachEvent(_t,mt)},tb=nt=>(nt.preventDefault(),nt.type.match(/^touch/)?nt.changedTouches:nt),lM=()=>{if(typeof window>"u")return;let nt=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,st=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:nt,y:st}},rb=(nt,st)=>{st.top||st.right||st.bottom||st.left?(nt.style.top=st.top,nt.style.right=st.right,nt.style.bottom=st.bottom,nt.style.left=st.left):(nt.style.left=st.x+"px",nt.style.top=st.y+"px")},ib=(nt,st,mt)=>{let gt=sB(nt);for(let _t in gt)if(gt.hasOwnProperty(_t))if(typeof st=="string")gt[_t]=st+" "+mt;else{let Et="";for(let At=0,Rt=st.length;At<Rt;At+=1)Et+=st[At]+" "+mt+", ";gt[_t]=Et.slice(0,-2)}return gt},nB=(nt,st)=>{let mt=sB(nt);for(let gt in mt)mt.hasOwnProperty(gt)&&(mt[gt]=st);return mt},sB=nt=>{let st={};return st[nt]="",["webkit","Moz","o"].forEach(function(mt){st[mt+nt.charAt(0).toUpperCase()+nt.slice(1)]=""}),st},nb=(nt,st)=>{for(let mt in st)st.hasOwnProperty(mt)&&(nt[mt]=st[mt]);return nt},oB=(nt,st)=>{let mt={};for(let gt in nt)nt.hasOwnProperty(gt)&&st.hasOwnProperty(gt)?mt[gt]=st[gt]:nt.hasOwnProperty(gt)&&(mt[gt]=nt[gt]);return mt},Um=(nt,st)=>{if(nt.length)for(let mt=0,gt=nt.length;mt<gt;mt+=1)st(nt[mt]);else st(nt)},aB=(nt,st,mt)=>({x:Math.min(Math.max(nt.x,st.x-mt),st.x+mt),y:Math.min(Math.max(nt.y,st.y-mt),st.y+mt)});typeof window<"u"&&(lB="ontouchstart"in window,cB=!!window.PointerEvent,uB=!!window.MSPointerEvent);var lB,cB,uB,zm={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Pf,km={};cB?Pf=zm.pointer:uB?Pf=zm.MSPointer:lB?(Pf=zm.touch,km=zm.mouse):Pf=zm.mouse;function tu(){}tu.prototype.on=function(nt,st){var mt=this,gt=nt.split(/[ ,]+/g),_t;mt._handlers_=mt._handlers_||{};for(var Et=0;Et<gt.length;Et+=1)_t=gt[Et],mt._handlers_[_t]=mt._handlers_[_t]||[],mt._handlers_[_t].push(st);return mt};tu.prototype.off=function(nt,st){var mt=this;return mt._handlers_=mt._handlers_||{},nt===void 0?mt._handlers_={}:st===void 0?mt._handlers_[nt]=null:mt._handlers_[nt]&&mt._handlers_[nt].indexOf(st)>=0&&mt._handlers_[nt].splice(mt._handlers_[nt].indexOf(st),1),mt};tu.prototype.trigger=function(nt,st){var mt=this,gt=nt.split(/[ ,]+/g),_t;mt._handlers_=mt._handlers_||{};for(var Et=0;Et<gt.length;Et+=1)_t=gt[Et],mt._handlers_[_t]&&mt._handlers_[_t].length&&mt._handlers_[_t].forEach(function(At){At.call(mt,{type:_t,target:mt},st)})};tu.prototype.config=function(nt){var st=this;st.options=st.defaults||{},nt&&(st.options=oB(st.options,nt))};tu.prototype.bindEvt=function(nt,st){var mt=this;return mt._domHandlers_=mt._domHandlers_||{},mt._domHandlers_[st]=function(){typeof mt["on"+st]=="function"?mt["on"+st].apply(mt,arguments):console.warn('[WARNING] : Missing "on'+st+'" handler.')},Cf(nt,Pf[st],mt._domHandlers_[st]),km[st]&&Cf(nt,km[st],mt._domHandlers_[st]),mt};tu.prototype.unbindEvt=function(nt,st){var mt=this;return mt._domHandlers_=mt._domHandlers_||{},aM(nt,Pf[st],mt._domHandlers_[st]),km[st]&&aM(nt,km[st],mt._domHandlers_[st]),delete mt._domHandlers_[st],this};var _f=tu;function Di(nt,st){return this.identifier=st.identifier,this.position=st.position,this.frontPosition=st.frontPosition,this.collection=nt,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(st),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Di.id,Di.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Di.prototype=new _f;Di.constructor=Di;Di.id=0;Di.prototype.buildEl=function(nt){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Di.prototype.stylize=function(){if(this.options.dataOnly)return this;var nt=this.options.fadeTime+"ms",st=nB("borderRadius","50%"),mt=ib("transition","opacity",nt),gt={};return gt.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},gt.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},gt.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},nb(gt.el,mt),this.options.shape==="circle"&&nb(gt.back,st),nb(gt.front,st),this.applyStyles(gt),this};Di.prototype.applyStyles=function(nt){for(var st in this.ui)if(this.ui.hasOwnProperty(st))for(var mt in nt[st])this.ui[st].style[mt]=nt[st][mt];return this};Di.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Di.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Di.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Di.prototype.show=function(nt){var st=this;return st.options.dataOnly||(clearTimeout(st.removeTimeout),clearTimeout(st.showTimeout),clearTimeout(st.restTimeout),st.addToDom(),st.restCallback(),setTimeout(function(){st.ui.el.style.opacity=1},0),st.showTimeout=setTimeout(function(){st.trigger("shown",st.instance),typeof nt=="function"&&nt.call(this)},st.options.fadeTime)),st};Di.prototype.hide=function(nt){var st=this;if(st.options.dataOnly)return st;if(st.ui.el.style.opacity=st.options.restOpacity,clearTimeout(st.removeTimeout),clearTimeout(st.showTimeout),clearTimeout(st.restTimeout),st.removeTimeout=setTimeout(function(){var mt=st.options.mode==="dynamic"?"none":"block";st.ui.el.style.display=mt,typeof nt=="function"&&nt.call(st),st.trigger("hidden",st.instance)},st.options.fadeTime),st.options.restJoystick){let mt=st.options.restJoystick,gt={};gt.x=mt===!0||mt.x!==!1?0:st.instance.frontPosition.x,gt.y=mt===!0||mt.y!==!1?0:st.instance.frontPosition.y,st.setPosition(nt,gt)}return st};Di.prototype.setPosition=function(nt,st){var mt=this;mt.frontPosition={x:st.x,y:st.y};var gt=mt.options.fadeTime+"ms",_t={};_t.front=ib("transition",["top","left"],gt);var Et={front:{}};Et.front={left:mt.frontPosition.x+"px",top:mt.frontPosition.y+"px"},mt.applyStyles(_t),mt.applyStyles(Et),mt.restTimeout=setTimeout(function(){typeof nt=="function"&&nt.call(mt),mt.restCallback()},mt.options.fadeTime)};Di.prototype.restCallback=function(){var nt=this,st={};st.front=ib("transition","none",""),nt.applyStyles(st),nt.trigger("rested",nt.instance)};Di.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Di.prototype.computeDirection=function(nt){var st=nt.angle.radian,mt=Math.PI/4,gt=Math.PI/2,_t,Et,At;if(st>mt&&st<mt*3&&!nt.lockX?_t="up":st>-mt&&st<=mt&&!nt.lockY?_t="left":st>-mt*3&&st<=-mt&&!nt.lockX?_t="down":nt.lockY||(_t="right"),nt.lockY||(st>-gt&&st<gt?Et="left":Et="right"),nt.lockX||(st>0?At="up":At="down"),nt.force>this.options.threshold){var Rt={},Ft;for(Ft in this.direction)this.direction.hasOwnProperty(Ft)&&(Rt[Ft]=this.direction[Ft]);var Nt={};this.direction={x:Et,y:At,angle:_t},nt.direction=this.direction;for(Ft in Rt)Rt[Ft]===this.direction[Ft]&&(Nt[Ft]=!0);if(Nt.x&&Nt.y&&Nt.angle)return nt;(!Nt.x||!Nt.y)&&this.trigger("plain",nt),Nt.x||this.trigger("plain:"+Et,nt),Nt.y||this.trigger("plain:"+At,nt),Nt.angle||this.trigger("dir dir:"+_t,nt)}else this.resetDirection();return nt};var hB=Di;function oi(nt,st){var mt=this;mt.nipples=[],mt.idles=[],mt.actives=[],mt.ids=[],mt.pressureIntervals={},mt.manager=nt,mt.id=oi.id,oi.id+=1,mt.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},mt.config(st),(mt.options.mode==="static"||mt.options.mode==="semi")&&(mt.options.multitouch=!1),mt.options.multitouch||(mt.options.maxNumberOfNipples=1);let gt=getComputedStyle(mt.options.zone.parentElement);return gt&&gt.display==="flex"&&(mt.parentIsFlex=!0),mt.updateBox(),mt.prepareNipples(),mt.bindings(),mt.begin(),mt.nipples}oi.prototype=new _f;oi.constructor=oi;oi.id=0;oi.prototype.prepareNipples=function(){var nt=this,st=nt.nipples;st.on=nt.on.bind(nt),st.off=nt.off.bind(nt),st.options=nt.options,st.destroy=nt.destroy.bind(nt),st.ids=nt.ids,st.id=nt.id,st.processOnMove=nt.processOnMove.bind(nt),st.processOnEnd=nt.processOnEnd.bind(nt),st.get=function(mt){if(mt===void 0)return st[0];for(var gt=0,_t=st.length;gt<_t;gt+=1)if(st[gt].identifier===mt)return st[gt];return!1}};oi.prototype.bindings=function(){var nt=this;nt.bindEvt(nt.options.zone,"start"),nt.options.zone.style.touchAction="none",nt.options.zone.style.msTouchAction="none"};oi.prototype.begin=function(){var nt=this,st=nt.options;if(st.mode==="static"){var mt=nt.createNipple(st.position,nt.manager.getIdentifier());mt.add(),nt.idles.push(mt)}};oi.prototype.createNipple=function(nt,st){var mt=this,gt=mt.manager.scroll,_t={},Et=mt.options,At={x:mt.parentIsFlex?gt.x:gt.x+mt.box.left,y:mt.parentIsFlex?gt.y:gt.y+mt.box.top};if(nt.x&&nt.y)_t={x:nt.x-At.x,y:nt.y-At.y};else if(nt.top||nt.right||nt.bottom||nt.left){var Rt=document.createElement("DIV");Rt.style.display="hidden",Rt.style.top=nt.top,Rt.style.right=nt.right,Rt.style.bottom=nt.bottom,Rt.style.left=nt.left,Rt.style.position="absolute",Et.zone.appendChild(Rt);var Ft=Rt.getBoundingClientRect();Et.zone.removeChild(Rt),_t=nt,nt={x:Ft.left+gt.x,y:Ft.top+gt.y}}var Nt=new hB(mt,{color:Et.color,size:Et.size,threshold:Et.threshold,fadeTime:Et.fadeTime,dataOnly:Et.dataOnly,restJoystick:Et.restJoystick,restOpacity:Et.restOpacity,mode:Et.mode,identifier:st,position:nt,zone:Et.zone,frontPosition:{x:0,y:0},shape:Et.shape});return Et.dataOnly||(rb(Nt.ui.el,_t),rb(Nt.ui.front,Nt.frontPosition)),mt.nipples.push(Nt),mt.trigger("added "+Nt.identifier+":added",Nt),mt.manager.trigger("added "+Nt.identifier+":added",Nt),mt.bindNipple(Nt),Nt};oi.prototype.updateBox=function(){var nt=this;nt.box=nt.options.zone.getBoundingClientRect()};oi.prototype.bindNipple=function(nt){var st=this,mt,gt=function(_t,Et){mt=_t.type+" "+Et.id+":"+_t.type,st.trigger(mt,Et)};nt.on("destroyed",st.onDestroyed.bind(st)),nt.on("shown hidden rested dir plain",gt),nt.on("dir:up dir:right dir:down dir:left",gt),nt.on("plain:up plain:right plain:down plain:left",gt)};oi.prototype.pressureFn=function(nt,st,mt){var gt=this,_t=0;clearInterval(gt.pressureIntervals[mt]),gt.pressureIntervals[mt]=setInterval((function(){var Et=nt.force||nt.pressure||nt.webkitForce||0;Et!==_t&&(st.trigger("pressure",Et),gt.trigger("pressure "+st.identifier+":pressure",Et),_t=Et)}).bind(gt),100)};oi.prototype.onstart=function(nt){var st=this,mt=st.options,gt=nt;nt=tb(nt),st.updateBox();var _t=function(Et){st.actives.length<mt.maxNumberOfNipples?st.processOnStart(Et):gt.type.match(/^touch/)&&(Object.keys(st.manager.ids).forEach(function(At){if(Object.values(gt.touches).findIndex(function(Ft){return Ft.identifier===At})<0){var Rt=[nt[0]];Rt.identifier=At,st.processOnEnd(Rt)}}),st.actives.length<mt.maxNumberOfNipples&&st.processOnStart(Et))};return Um(nt,_t),st.manager.bindDocument(),!1};oi.prototype.processOnStart=function(nt){var st=this,mt=st.options,gt,_t=st.manager.getIdentifier(nt),Et=nt.force||nt.pressure||nt.webkitForce||0,At={x:nt.pageX,y:nt.pageY},Rt=st.getOrCreate(_t,At);Rt.identifier!==_t&&st.manager.removeIdentifier(Rt.identifier),Rt.identifier=_t;var Ft=function(Bt){Bt.trigger("start",Bt),st.trigger("start "+Bt.id+":start",Bt),Bt.show(),Et>0&&st.pressureFn(nt,Bt,Bt.identifier),st.processOnMove(nt)};if((gt=st.idles.indexOf(Rt))>=0&&st.idles.splice(gt,1),st.actives.push(Rt),st.ids.push(Rt.identifier),mt.mode!=="semi")Ft(Rt);else{var Nt=Vm(At,Rt.position);if(Nt<=mt.catchDistance)Ft(Rt);else{Rt.destroy(),st.processOnStart(nt);return}}return Rt};oi.prototype.getOrCreate=function(nt,st){var mt=this,gt=mt.options,_t;return/(semi|static)/.test(gt.mode)?(_t=mt.idles[0],_t?(mt.idles.splice(0,1),_t):gt.mode==="semi"?mt.createNipple(st,nt):(console.warn("Coudln't find the needed nipple."),!1)):(_t=mt.createNipple(st,nt),_t)};oi.prototype.processOnMove=function(nt){var st=this,mt=st.options,gt=st.manager.getIdentifier(nt),_t=st.nipples.get(gt),Et=st.manager.scroll;if(!iB(nt)){this.processOnEnd(nt);return}if(!_t){console.error("Found zombie joystick with ID "+gt),st.manager.removeIdentifier(gt);return}if(mt.dynamicPage){var At=_t.el.getBoundingClientRect();_t.position={x:Et.x+At.left,y:Et.y+At.top}}_t.identifier=gt;var Rt=_t.options.size/2,Ft={x:nt.pageX,y:nt.pageY};mt.lockX&&(Ft.y=_t.position.y),mt.lockY&&(Ft.x=_t.position.x);var Nt=Vm(Ft,_t.position),Bt=tB(Ft,_t.position),Gt=eb(Bt),dr=Nt/Rt,Mr={distance:Nt,position:Ft},Tr,zr;if(_t.options.shape==="circle"?(Tr=Math.min(Nt,Rt),zr=rB(_t.position,Tr,Bt)):(zr=aB(Ft,_t.position,Rt),Tr=Vm(zr,_t.position)),mt.follow){if(Nt>Rt){let rn=Ft.x-zr.x,Tn=Ft.y-zr.y;_t.position.x+=rn,_t.position.y+=Tn,_t.el.style.top=_t.position.y-(st.box.top+Et.y)+"px",_t.el.style.left=_t.position.x-(st.box.left+Et.x)+"px",Nt=Vm(Ft,_t.position)}}else Ft=zr,Nt=Tr;var Fr=Ft.x-_t.position.x,Nr=Ft.y-_t.position.y;_t.frontPosition={x:Fr,y:Nr},mt.dataOnly||rb(_t.ui.front,_t.frontPosition);var tn={identifier:_t.identifier,position:Ft,force:dr,pressure:nt.force||nt.pressure||nt.webkitForce||0,distance:Nt,angle:{radian:Gt,degree:Bt},vector:{x:Fr/Rt,y:-Nr/Rt},raw:Mr,instance:_t,lockX:mt.lockX,lockY:mt.lockY};tn=_t.computeDirection(tn),tn.angle={radian:eb(180-Bt),degree:180-Bt},_t.trigger("move",tn),st.trigger("move "+_t.id+":move",tn)};oi.prototype.processOnEnd=function(nt){var st=this,mt=st.options,gt=st.manager.getIdentifier(nt),_t=st.nipples.get(gt),Et=st.manager.removeIdentifier(_t.identifier);!_t||(mt.dataOnly||_t.hide(function(){mt.mode==="dynamic"&&(_t.trigger("removed",_t),st.trigger("removed "+_t.id+":removed",_t),st.manager.trigger("removed "+_t.id+":removed",_t),_t.destroy())}),clearInterval(st.pressureIntervals[_t.identifier]),_t.resetDirection(),_t.trigger("end",_t),st.trigger("end "+_t.id+":end",_t),st.ids.indexOf(_t.identifier)>=0&&st.ids.splice(st.ids.indexOf(_t.identifier),1),st.actives.indexOf(_t)>=0&&st.actives.splice(st.actives.indexOf(_t),1),/(semi|static)/.test(mt.mode)?st.idles.push(_t):st.nipples.indexOf(_t)>=0&&st.nipples.splice(st.nipples.indexOf(_t),1),st.manager.unbindDocument(),/(semi|static)/.test(mt.mode)&&(st.manager.ids[Et.id]=Et.identifier))};oi.prototype.onDestroyed=function(nt,st){var mt=this;mt.nipples.indexOf(st)>=0&&mt.nipples.splice(mt.nipples.indexOf(st),1),mt.actives.indexOf(st)>=0&&mt.actives.splice(mt.actives.indexOf(st),1),mt.idles.indexOf(st)>=0&&mt.idles.splice(mt.idles.indexOf(st),1),mt.ids.indexOf(st.identifier)>=0&&mt.ids.splice(mt.ids.indexOf(st.identifier),1),mt.manager.removeIdentifier(st.identifier),mt.manager.unbindDocument()};oi.prototype.destroy=function(){var nt=this;nt.unbindEvt(nt.options.zone,"start"),nt.nipples.forEach(function(mt){mt.destroy()});for(var st in nt.pressureIntervals)nt.pressureIntervals.hasOwnProperty(st)&&clearInterval(nt.pressureIntervals[st]);nt.trigger("destroyed",nt.nipples),nt.manager.unbindDocument(),nt.off()};var dB=oi;function ji(nt){var st=this;st.ids={},st.index=0,st.collections=[],st.scroll=lM(),st.config(nt),st.prepareCollections();var mt=function(){var _t;st.collections.forEach(function(Et){Et.forEach(function(At){_t=At.el.getBoundingClientRect(),At.position={x:st.scroll.x+_t.left,y:st.scroll.y+_t.top}})})};if(typeof window>"u")return st.collections;Cf(window,"resize",function(){oM(mt)});var gt=function(){st.scroll=lM()};return Cf(window,"scroll",function(){oM(gt)}),st.collections}ji.prototype=new _f;ji.constructor=ji;ji.prototype.prepareCollections=function(){var nt=this;nt.collections.create=nt.create.bind(nt),nt.collections.on=nt.on.bind(nt),nt.collections.off=nt.off.bind(nt),nt.collections.destroy=nt.destroy.bind(nt),nt.collections.get=function(st){var mt;return nt.collections.every(function(gt){return mt=gt.get(st),!mt}),mt}};ji.prototype.create=function(nt){return this.createCollection(nt)};ji.prototype.createCollection=function(nt){var st=this,mt=new dB(st,nt);return st.bindCollection(mt),st.collections.push(mt),mt};ji.prototype.bindCollection=function(nt){var st=this,mt,gt=function(_t,Et){mt=_t.type+" "+Et.id+":"+_t.type,st.trigger(mt,Et)};nt.on("destroyed",st.onDestroyed.bind(st)),nt.on("shown hidden rested dir plain",gt),nt.on("dir:up dir:right dir:down dir:left",gt),nt.on("plain:up plain:right plain:down plain:left",gt)};ji.prototype.bindDocument=function(){var nt=this;nt.binded||(nt.bindEvt(document,"move").bindEvt(document,"end"),nt.binded=!0)};ji.prototype.unbindDocument=function(nt){var st=this;(!Object.keys(st.ids).length||nt===!0)&&(st.unbindEvt(document,"move").unbindEvt(document,"end"),st.binded=!1)};ji.prototype.getIdentifier=function(nt){var st;return nt?(st=nt.identifier===void 0?nt.pointerId:nt.identifier,st===void 0&&(st=this.latest||0)):st=this.index,this.ids[st]===void 0&&(this.ids[st]=this.index,this.index+=1),this.latest=st,this.ids[st]};ji.prototype.removeIdentifier=function(nt){var st={};for(var mt in this.ids)if(this.ids[mt]===nt){st.id=mt,st.identifier=this.ids[mt],delete this.ids[mt];break}return st};ji.prototype.onmove=function(nt){var st=this;return st.onAny("move",nt),!1};ji.prototype.onend=function(nt){var st=this;return st.onAny("end",nt),!1};ji.prototype.oncancel=function(nt){var st=this;return st.onAny("end",nt),!1};ji.prototype.onAny=function(nt,st){var mt=this,gt,_t="processOn"+nt.charAt(0).toUpperCase()+nt.slice(1);st=tb(st);var Et=function(Rt,Ft,Nt){Nt.ids.indexOf(Ft)>=0&&(Nt[_t](Rt),Rt._found_=!0)},At=function(Rt){gt=mt.getIdentifier(Rt),Um(mt.collections,Et.bind(null,Rt,gt)),Rt._found_||mt.removeIdentifier(gt)};return Um(st,At),!1};ji.prototype.destroy=function(){var nt=this;nt.unbindDocument(!0),nt.ids={},nt.index=0,nt.collections.forEach(function(st){st.destroy()}),nt.off()};ji.prototype.onDestroyed=function(nt,st){var mt=this;if(mt.collections.indexOf(st)<0)return!1;mt.collections.splice(mt.collections.indexOf(st),1)};var fB=ji,pB=new fB,mB={create:function(nt){return pB.create(nt)},factory:pB},gB=new Map,Gm=new Map,Go=class{constructor(nt,st,mt,gt){this.data=st;let{audio:_t,volume:Et,delay:At,loop:Rt}=st;if(!_t)throw new Error("Missing property");let Ft=typeof _t=="string"?gt.getAudio(_t).src:_t.data;this.audioPlayer=new Oa({src:Ft,volume:Et,delay:At,loop:Rt}),Gm.has(mt.uuid)?Gm.get(mt.uuid).push(this):Gm.set(mt.uuid,[this]),gB.set(nt,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},Df=class{constructor(nt){this.data=nt}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(nt){let st=gB.get(nt);!st||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{st.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):st.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(nt){let st=Gm.get(nt);!(st!=null&&st.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{st.forEach(mt=>mt.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):st.forEach(mt=>mt.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let nt=[...Gm.values()];!nt.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{nt.forEach(st=>{st.forEach(mt=>{mt.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):nt.forEach(st=>{st.forEach(mt=>{mt.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},jm=class{constructor(nt,st,mt,gt,_t){if(this.data=st,this.shared=gt,this.condition=_t,st.interaction==="play")this.interaction=new Go(nt,st,mt,gt);else if(st.interaction==="pause"||st.interaction==="stop")this.interaction=new Df(st);else throw new Error("Missing property")}dispatchBasic(){if(wt(this.shared,this.condition)===!1)return!1;this.interaction instanceof Go?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(wt(this.shared,this.condition)===!1)return!1;this.interaction instanceof Go?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(nt){if(wt(this.shared,this.condition)===!1)return!1;this.interaction instanceof Go&&(nt==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},Hm=class{constructor(nt,st,mt,gt){this.data=nt,this.page=st,this.shared=mt,this.condition=gt,this.delay=0,this.emission=nt.emission,nt.delay!==void 0&&(this.delay=nt.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(nt=0){if(nt){this.delayTimerId=window.setTimeout(()=>{this.start(0),this.clearDelay()},nt);return}this.particleSystem.start()}stop(nt=0){if(nt){this.delayTimerId=window.setTimeout(()=>{this.stop(0),this.clearDelay()},nt);return}this.particleSystem.stop()}freeze(nt=0){if(nt){this.delayTimerId=window.setTimeout(()=>{this.freeze(0),this.clearDelay()},nt);return}this.particleSystem.froze()}unFreeze(nt=0){if(nt){this.delayTimerId=window.setTimeout(()=>{this.unFreeze(0),this.clearDelay()},nt);return}this.particleSystem.unFroze()}reset(nt=0){if(nt){this.delayTimerId=window.setTimeout(()=>{this.reset(0),this.clearDelay()},nt);return}this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze();break}}dispatchBasic(){if(wt(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchConditional(){if(wt(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchGameControl(nt){if(wt(this.shared,this.condition)===!1||!this.particleSystem)return!1;nt==="start"?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},KK="text/plain",ZK="us-ascii",yB=(nt,st)=>st.some(mt=>mt instanceof RegExp?mt.test(nt):mt===nt),JK=(nt,{stripHash:st})=>{let mt=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(nt);if(!mt)throw new Error(`Invalid URL: ${nt}`);let{type:gt,data:_t,hash:Et}=mt.groups,At=gt.split(";");Et=st?"":Et;let Rt=!1;At[At.length-1]==="base64"&&(At.pop(),Rt=!0);let Ft=(At.shift()||"").toLowerCase(),Nt=[...At.map(Bt=>{let[Gt,dr=""]=Bt.split("=").map(Mr=>Mr.trim());return Gt==="charset"&&(dr=dr.toLowerCase(),dr===ZK)?"":`${Gt}${dr?`=${dr}`:""}`}).filter(Boolean)];return Rt&&Nt.push("base64"),(Nt.length>0||Ft&&Ft!==KK)&&Nt.unshift(Ft),`data:${Nt.join(";")},${Rt?_t.trim():_t}${Et?`#${Et}`:""}`};function cM(nt,st){if(st={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...st},nt=nt.trim(),/^data:/i.test(nt))return JK(nt,st);if(/^view-source:/i.test(nt))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let mt=nt.startsWith("//");!mt&&/^\.*\//.test(nt)||(nt=nt.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,st.defaultProtocol));let gt=new URL(nt);if(st.forceHttp&&st.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(st.forceHttp&&gt.protocol==="https:"&&(gt.protocol="http:"),st.forceHttps&&gt.protocol==="http:"&&(gt.protocol="https:"),st.stripAuthentication&&(gt.username="",gt.password=""),st.stripHash?gt.hash="":st.stripTextFragment&&(gt.hash=gt.hash.replace(/#?:~:text.*?$/i,"")),gt.pathname){let Et=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,At=0,Rt="";for(;;){let Nt=Et.exec(gt.pathname);if(!Nt)break;let Bt=Nt[0],Gt=Nt.index,dr=gt.pathname.slice(At,Gt);Rt+=dr.replace(/\/{2,}/g,"/"),Rt+=Bt,At=Gt+Bt.length}let Ft=gt.pathname.slice(At,gt.pathname.length);Rt+=Ft.replace(/\/{2,}/g,"/"),gt.pathname=Rt}if(gt.pathname)try{gt.pathname=decodeURI(gt.pathname)}catch{}if(st.removeDirectoryIndex===!0&&(st.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(st.removeDirectoryIndex)&&st.removeDirectoryIndex.length>0){let Et=gt.pathname.split("/"),At=Et[Et.length-1];yB(At,st.removeDirectoryIndex)&&(Et=Et.slice(0,-1),gt.pathname=Et.slice(1).join("/")+"/")}if(gt.hostname&&(gt.hostname=gt.hostname.replace(/\.$/,""),st.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(gt.hostname)&&(gt.hostname=gt.hostname.replace(/^www\./,""))),Array.isArray(st.removeQueryParameters))for(let Et of[...gt.searchParams.keys()])yB(Et,st.removeQueryParameters)&&gt.searchParams.delete(Et);if(st.removeQueryParameters===!0&&(gt.search=""),st.sortQueryParameters){gt.searchParams.sort();try{gt.search=decodeURIComponent(gt.search)}catch{}}st.removeTrailingSlash&&(gt.pathname=gt.pathname.replace(/\/$/,""));let _t=nt;return nt=gt.toString(),!st.removeSingleSlash&&gt.pathname==="/"&&!_t.endsWith("/")&&gt.hash===""&&(nt=nt.replace(/\/$/,"")),(st.removeTrailingSlash||gt.pathname==="/")&&gt.hash===""&&st.removeSingleSlash&&(nt=nt.replace(/\/$/,"")),mt&&!st.normalizeProtocol&&(nt=nt.replace(/^http:\/\//,"//")),st.stripProtocol&&(nt=nt.replace(/^(?:https?:)?\/\//,"")),nt}var ob=class{constructor({url:nt,context:st},mt,gt,_t){if(this.controlsManager=mt,this.shared=gt,this.condition=_t,!nt)throw new Error("Missing property");this.url=nt.startsWith("mailto:")?nt:cM(nt,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=st??"tab"}dispatch(){var nt;if(wt(this.shared,this.condition)===!1)return!1;go?window.location.assign(this.url):(this.context==="tab"||Zw&&this.context==="none"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(nt=this.controlsManager.orbitControls)==null||nt.onPointerUp(Je$1[0]),j2())}},Wm=class{constructor(nt,st,mt,gt,_t){this.data=nt,this.page=st,this.controlsManager=mt,this.shared=gt,this.condition=_t,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=Et=>{var Nt,Bt;this.timeoutIdQueue.shift();let At=this.page.scene.find(Et);if(At===void 0)return;let Rt=this.controlsManager.sharedGameControlGlobals.rapierWorld,Ft=Rt?(Nt=At.dataPatched.physics)==null?void 0:Nt.fusedBody:!0;if(At.cloner){for(let Gt of At.cloner.children)Ft?(Gt.playModeVisible=!1,Gt.rigidBody&&((Bt=At.dataPatched.physics)==null?void 0:Bt.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(Gt.rigidBody.collider(0).handle),Rt.removeRigidBody(Gt.rigidBody),Gt.rigidBody=void 0),Gt.bvhGeometry&&(Gt.bvhGeometry=void 0)):this.clone===void 0||this.clone===Gt?(Gt.playModeVisible=!1,Gt.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(Gt.rigidBody.collider(0).handle),Rt.removeRigidBody(Gt.rigidBody),Gt.rigidBody=void 0)):Gt.playModeVisible===void 0&&(Gt.playModeVisible=!0);(Ft||this.clone===void 0||this.clone===!1)&&(At.visible=!1,At.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(At.rigidBody.collider(0).handle),Rt.removeRigidBody(At.rigidBody),At.rigidBody=void 0),At.bvhGeometry&&(At.bvhGeometry=void 0))}else At.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(At.rigidBody.collider(0).handle),Rt.removeRigidBody(At.rigidBody),At.rigidBody=void 0),At.bvhGeometry&&(At.bvhGeometry=void 0),At.visible=!1;Rt===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(Gt=>Gt.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(Gt=>Gt.rigidBody!==void 0),At.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...nt.objects]}dispatch(nt){if(wt(this.shared,this.condition)===!1)return!1;this.clone=nt,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){if(wt(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(nt=>window.clearTimeout(nt))}},qm=class{constructor(nt,st,mt,gt,_t){this.data=nt,this.page=st,this.shared=mt,this.eventManager=gt,this.condition=_t,this.shared=mt}dispatch(){if(wt(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var nt;this.shared.reset(this.shared.data,!0),If(this.page,this.shared,!0),this.eventManager.reset(),(nt=this.eventManager.controlsManager.gameControl)==null||nt.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},AB={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},fM={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},$K=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],lb={CSS:{},springs:{}};function eo$1(nt,st,mt){return Math.min(Math.max(nt,st),mt)}function Ym(nt,st){return nt.indexOf(st)>-1}function uM(nt,st){return nt.apply(null,st)}var ht$1={arr:function(nt){return Array.isArray(nt)},obj:function(nt){return Ym(Object.prototype.toString.call(nt),"Object")},pth:function(nt){return ht$1.obj(nt)&&nt.hasOwnProperty("totalLength")},svg:function(nt){return nt instanceof SVGElement},inp:function(nt){return nt instanceof HTMLInputElement},dom:function(nt){return!("isNode"in nt)&&(nt.nodeType||ht$1.svg(nt))},str:function(nt){return typeof nt=="string"},fnc:function(nt){return typeof nt=="function"},und:function(nt){return typeof nt>"u"},hex:function(nt){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(nt)},rgb:function(nt){return/^rgb/.test(nt)},hsl:function(nt){return/^hsl/.test(nt)},col:function(nt){return ht$1.hex(nt)||ht$1.rgb(nt)||ht$1.hsl(nt)},key:function(nt){return!AB.hasOwnProperty(nt)&&!fM.hasOwnProperty(nt)&&nt!=="targets"&&nt!=="keyframes"}};function EB(nt){var st=/\(([^)]+)\)/.exec(nt);return st?st[1].split(",").map(function(mt){return parseFloat(mt)}):[]}function MB(nt,st){var mt=EB(nt),gt=eo$1(ht$1.und(mt[0])?1:mt[0],.1,100),_t=eo$1(ht$1.und(mt[1])?100:mt[1],.1,100),Et=eo$1(ht$1.und(mt[2])?10:mt[2],.1,100),At=eo$1(ht$1.und(mt[3])?0:mt[3],.1,100),Rt=Math.sqrt(_t/gt),Ft=Et/(2*Math.sqrt(_t*gt)),Nt=Ft<1?Rt*Math.sqrt(1-Ft*Ft):0,Bt=1,Gt=Ft<1?(Ft*Rt+-At)/Nt:-At+Rt;function dr(Tr){var zr=st?st*Tr/1e3:Tr;return Ft<1?zr=Math.exp(-zr*Ft*Rt)*(Bt*Math.cos(Nt*zr)+Gt*Math.sin(Nt*zr)):zr=(Bt+Gt*zr)*Math.exp(-zr*Rt),Tr===0||Tr===1?Tr:1-zr}function Mr(){var Tr=lb.springs[nt];if(Tr)return Tr;for(var zr=1/6,Fr=0,Nr=0;;)if(Fr+=zr,dr(Fr)===1){if(Nr++,Nr>=16)break}else Nr=0;var tn=Fr*zr*1e3;return lb.springs[nt]=tn,tn}return st?dr:Mr}function eZ(nt){return nt===void 0&&(nt=10),function(st){return Math.ceil(eo$1(st,1e-6,1)*nt)*(1/nt)}}var tZ=function(){var nt=11,st=1/(nt-1);function mt(Bt,Gt){return 1-3*Gt+3*Bt}function gt(Bt,Gt){return 3*Gt-6*Bt}function _t(Bt){return 3*Bt}function Et(Bt,Gt,dr){return((mt(Gt,dr)*Bt+gt(Gt,dr))*Bt+_t(Gt))*Bt}function At(Bt,Gt,dr){return 3*mt(Gt,dr)*Bt*Bt+2*gt(Gt,dr)*Bt+_t(Gt)}function Rt(Bt,Gt,dr,Mr,Tr){var zr,Fr,Nr=0;do Fr=Gt+(dr-Gt)/2,zr=Et(Fr,Mr,Tr)-Bt,zr>0?dr=Fr:Gt=Fr;while(Math.abs(zr)>1e-7&&++Nr<10);return Fr}function Ft(Bt,Gt,dr,Mr){for(var Tr=0;Tr<4;++Tr){var zr=At(Gt,dr,Mr);if(zr===0)return Gt;var Fr=Et(Gt,dr,Mr)-Bt;Gt-=Fr/zr}return Gt}function Nt(Bt,Gt,dr,Mr){if(!(0<=Bt&&Bt<=1&&0<=dr&&dr<=1))return;var Tr=new Float32Array(nt);if(Bt!==Gt||dr!==Mr)for(var zr=0;zr<nt;++zr)Tr[zr]=Et(zr*st,Bt,dr);function Fr(Nr){for(var tn=0,rn=1,Tn=nt-1;rn!==Tn&&Tr[rn]<=Nr;++rn)tn+=st;--rn;var $n=(Nr-Tr[rn])/(Tr[rn+1]-Tr[rn]),un=tn+$n*st,es=At(un,Bt,dr);return es>=.001?Ft(Nr,un,Bt,dr):es===0?un:Rt(Nr,tn,tn+st,Bt,dr)}return function(Nr){return Bt===Gt&&dr===Mr||Nr===0||Nr===1?Nr:Et(Fr(Nr),Gt,Mr)}}return Nt}(),TB=function(){var nt={linear:function(){return function(gt){return gt}}},st={Sine:function(){return function(gt){return 1-Math.cos(gt*Math.PI/2)}},Circ:function(){return function(gt){return 1-Math.sqrt(1-gt*gt)}},Back:function(){return function(gt){return gt*gt*(3*gt-2)}},Bounce:function(){return function(gt){for(var _t,Et=4;gt<((_t=Math.pow(2,--Et))-1)/11;);return 1/Math.pow(4,3-Et)-7.5625*Math.pow((_t*3-2)/22-gt,2)}},Elastic:function(gt,_t){gt===void 0&&(gt=1),_t===void 0&&(_t=.5);var Et=eo$1(gt,1,10),At=eo$1(_t,.1,2);return function(Rt){return Rt===0||Rt===1?Rt:-Et*Math.pow(2,10*(Rt-1))*Math.sin((Rt-1-At/(Math.PI*2)*Math.asin(1/Et))*(Math.PI*2)/At)}}},mt=["Quad","Cubic","Quart","Quint","Expo"];return mt.forEach(function(gt,_t){st[gt]=function(){return function(Et){return Math.pow(Et,_t+2)}}}),Object.keys(st).forEach(function(gt){var _t=st[gt];nt["easeIn"+gt]=_t,nt["easeOut"+gt]=function(Et,At){return function(Rt){return 1-_t(Et,At)(1-Rt)}},nt["easeInOut"+gt]=function(Et,At){return function(Rt){return Rt<.5?_t(Et,At)(Rt*2)/2:1-_t(Et,At)(Rt*-2+2)/2}}}),nt}();function pM(nt,st){if(ht$1.fnc(nt))return nt;var mt=nt.split("(")[0],gt=TB[mt],_t=EB(nt);switch(mt){case"spring":return MB(nt,st);case"cubicBezier":return uM(tZ,_t);case"steps":return uM(eZ,_t);default:return uM(gt,_t)}}function CB(nt){try{var st=document.querySelectorAll(nt);return st}catch{return}}function cb(nt,st){for(var mt=nt.length,gt=arguments.length>=2?arguments[1]:void 0,_t=[],Et=0;Et<mt;Et++)if(Et in nt){var At=nt[Et];st.call(gt,At,Et,nt)&&_t.push(At)}return _t}function ub(nt){return nt.reduce(function(st,mt){return st.concat(ht$1.arr(mt)?ub(mt):mt)},[])}function vB(nt){return ht$1.arr(nt)?nt:(ht$1.str(nt)&&(nt=CB(nt)||nt),nt instanceof NodeList||nt instanceof HTMLCollection?[].slice.call(nt):[nt])}function mM(nt,st){return nt.some(function(mt){return mt===st})}function gM(nt){var st={};for(var mt in nt)st[mt]=nt[mt];return st}function hM(nt,st){var mt=gM(nt);for(var gt in nt)mt[gt]=st.hasOwnProperty(gt)?st[gt]:nt[gt];return mt}function hb(nt,st){var mt=gM(nt);for(var gt in st)mt[gt]=ht$1.und(nt[gt])?st[gt]:nt[gt];return mt}function rZ(nt){var st=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(nt);return st?"rgba("+st[1]+",1)":nt}function iZ(nt){var st=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,mt=nt.replace(st,function(Rt,Ft,Nt,Bt){return Ft+Ft+Nt+Nt+Bt+Bt}),gt=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(mt),_t=parseInt(gt[1],16),Et=parseInt(gt[2],16),At=parseInt(gt[3],16);return"rgba("+_t+","+Et+","+At+",1)"}function nZ(nt){var st=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(nt)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(nt),mt=parseInt(st[1],10)/360,gt=parseInt(st[2],10)/100,_t=parseInt(st[3],10)/100,Et=st[4]||1;function At(dr,Mr,Tr){return Tr<0&&(Tr+=1),Tr>1&&(Tr-=1),Tr<1/6?dr+(Mr-dr)*6*Tr:Tr<1/2?Mr:Tr<2/3?dr+(Mr-dr)*(2/3-Tr)*6:dr}var Rt,Ft,Nt;if(gt==0)Rt=Ft=Nt=_t;else{var Bt=_t<.5?_t*(1+gt):_t+gt-_t*gt,Gt=2*_t-Bt;Rt=At(Gt,Bt,mt+1/3),Ft=At(Gt,Bt,mt),Nt=At(Gt,Bt,mt-1/3)}return"rgba("+Rt*255+","+Ft*255+","+Nt*255+","+Et+")"}function sZ(nt){if(ht$1.rgb(nt))return rZ(nt);if(ht$1.hex(nt))return iZ(nt);if(ht$1.hsl(nt))return nZ(nt)}function Na(nt){var st=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(nt);if(st)return st[1]}function oZ(nt){if(Ym(nt,"translate")||nt==="perspective")return"px";if(Ym(nt,"rotate")||Ym(nt,"skew"))return"deg"}function dM(nt,st){return ht$1.fnc(nt)?nt(st.target,st.id,st.total):nt}function jo(nt,st){return nt.getAttribute(st)}function yM(nt,st,mt){var gt=Na(st);if(mM([mt,"deg","rad","turn"],gt))return st;var _t=lb.CSS[st+mt];if(!ht$1.und(_t))return _t;var Et=100,At=document.createElement(nt.tagName),Rt=nt.parentNode&&nt.parentNode!==document?nt.parentNode:document.body;Rt.appendChild(At),At.style.position="absolute",At.style.width=Et+mt;var Ft=Et/At.offsetWidth;Rt.removeChild(At);var Nt=Ft*parseFloat(st);return lb.CSS[st+mt]=Nt,Nt}function PB(nt,st,mt){if(st in nt.style){var gt=st.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),_t=nt.style[st]||getComputedStyle(nt).getPropertyValue(gt)||"0";return mt?yM(nt,_t,mt):_t}}function vM(nt,st){if(ht$1.dom(nt)&&!ht$1.inp(nt)&&(jo(nt,st)||ht$1.svg(nt)&&nt[st]))return"attribute";if(ht$1.dom(nt)&&mM($K,st))return"transform";if(ht$1.dom(nt)&&st!=="transform"&&PB(nt,st))return"css";if(nt[st]!=null)return"object"}function _B(nt){if(ht$1.dom(nt)){for(var st=nt.style.transform||"",mt=/(\w+)\(([^)]*)\)/g,gt=new Map,_t;_t=mt.exec(st);)gt.set(_t[1],_t[2]);return gt}}function aZ(nt,st,mt,gt){var _t=Ym(st,"scale")?1:0+oZ(st),Et=_B(nt).get(st)||_t;return mt&&(mt.transforms.list.set(st,Et),mt.transforms.last=st),gt?yM(nt,Et,gt):Et}function xM(nt,st,mt,gt){switch(vM(nt,st)){case"transform":return aZ(nt,st,gt,mt);case"css":return PB(nt,st,mt);case"attribute":return jo(nt,st);default:return nt[st]||0}}function bM(nt,st){var mt=/^(\*=|\+=|-=)/.exec(nt);if(!mt)return nt;var gt=Na(nt)||0,_t=parseFloat(st),Et=parseFloat(nt.replace(mt[0],""));switch(mt[0][0]){case"+":return _t+Et+gt;case"-":return _t-Et+gt;case"*":return _t*Et+gt}}function DB(nt,st){if(ht$1.col(nt))return sZ(nt);if(/\s/g.test(nt))return nt;var mt=Na(nt),gt=mt?nt.substr(0,nt.length-mt.length):nt;return st?gt+st:gt}function SM(nt,st){return Math.sqrt(Math.pow(st.x-nt.x,2)+Math.pow(st.y-nt.y,2))}function lZ(nt){return Math.PI*2*jo(nt,"r")}function cZ(nt){return jo(nt,"width")*2+jo(nt,"height")*2}function uZ(nt){return SM({x:jo(nt,"x1"),y:jo(nt,"y1")},{x:jo(nt,"x2"),y:jo(nt,"y2")})}function IB(nt){for(var st=nt.points,mt=0,gt,_t=0;_t<st.numberOfItems;_t++){var Et=st.getItem(_t);_t>0&&(mt+=SM(gt,Et)),gt=Et}return mt}function hZ(nt){var st=nt.points;return IB(nt)+SM(st.getItem(st.numberOfItems-1),st.getItem(0))}function OB(nt){if(nt.getTotalLength)return nt.getTotalLength();switch(nt.tagName.toLowerCase()){case"circle":return lZ(nt);case"rect":return cZ(nt);case"line":return uZ(nt);case"polyline":return IB(nt);case"polygon":return hZ(nt)}}function dZ(nt){var st=OB(nt);return nt.setAttribute("stroke-dasharray",st),st}function fZ(nt){for(var st=nt.parentNode;ht$1.svg(st)&&ht$1.svg(st.parentNode);)st=st.parentNode;return st}function RB(nt,st){var mt=st||{},gt=mt.el||fZ(nt),_t=gt.getBoundingClientRect(),Et=jo(gt,"viewBox"),At=_t.width,Rt=_t.height,Ft=mt.viewBox||(Et?Et.split(" "):[0,0,At,Rt]);return{el:gt,viewBox:Ft,x:Ft[0]/1,y:Ft[1]/1,w:At/Ft[2],h:Rt/Ft[3]}}function pZ(nt,st){var mt=ht$1.str(nt)?CB(nt)[0]:nt,gt=st||100;return function(_t){return{property:_t,el:mt,svg:RB(mt),totalLength:OB(mt)*(gt/100)}}}function mZ(nt,st){function mt(Rt){Rt===void 0&&(Rt=0);var Ft=st+Rt>=1?st+Rt:0;return nt.el.getPointAtLength(Ft)}var gt=RB(nt.el,nt.svg),_t=mt(),Et=mt(-1),At=mt(1);switch(nt.property){case"x":return(_t.x-gt.x)*gt.w;case"y":return(_t.y-gt.y)*gt.h;case"angle":return Math.atan2(At.y-Et.y,At.x-Et.x)*180/Math.PI}}function xB(nt,st){var mt=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,gt=DB(ht$1.pth(nt)?nt.totalLength:nt,st)+"";return{original:gt,numbers:gt.match(mt)?gt.match(mt).map(Number):[0],strings:ht$1.str(nt)||st?gt.split(mt):[]}}function LB(nt){var st=nt?ub(ht$1.arr(nt)?nt.map(vB):vB(nt)):[];return cb(st,function(mt,gt,_t){return _t.indexOf(mt)===gt})}function BB(nt){var st=LB(nt);return st.map(function(mt,gt){return{target:mt,id:gt,total:st.length,transforms:{list:_B(mt)}}})}function gZ(nt,st){var mt=gM(st);if(/^spring/.test(mt.easing)&&(mt.duration=MB(mt.easing)),ht$1.arr(nt)){var gt=nt.length,_t=gt===2&&!ht$1.obj(nt[0]);_t?nt={value:nt}:ht$1.fnc(st.duration)||(mt.duration=st.duration/gt)}var Et=ht$1.arr(nt)?nt:[nt];return Et.map(function(At,Rt){var Ft=ht$1.obj(At)&&!ht$1.pth(At)?At:{value:At};return ht$1.und(Ft.delay)&&(Ft.delay=Rt?0:st.delay),ht$1.und(Ft.endDelay)&&(Ft.endDelay=Rt===Et.length-1?st.endDelay:0),Ft}).map(function(At){return hb(At,mt)})}function yZ(nt){for(var st=cb(ub(nt.map(function(Et){return Object.keys(Et)})),function(Et){return ht$1.key(Et)}).reduce(function(Et,At){return Et.indexOf(At)<0&&Et.push(At),Et},[]),mt={},gt=function(Et){var At=st[Et];mt[At]=nt.map(function(Rt){var Ft={};for(var Nt in Rt)ht$1.key(Nt)?Nt==At&&(Ft.value=Rt[Nt]):Ft[Nt]=Rt[Nt];return Ft})},_t=0;_t<st.length;_t++)gt(_t);return mt}function vZ(nt,st){var mt=[],gt=st.keyframes;gt&&(st=hb(yZ(gt),st));for(var _t in st)ht$1.key(_t)&&mt.push({name:_t,tweens:gZ(st[_t],nt)});return mt}function xZ(nt,st){var mt={};for(var gt in nt){var _t=dM(nt[gt],st);ht$1.arr(_t)&&(_t=_t.map(function(Et){return dM(Et,st)}),_t.length===1&&(_t=_t[0])),mt[gt]=_t}return mt.duration=parseFloat(mt.duration),mt.delay=parseFloat(mt.delay),mt}function bZ(nt,st){var mt;return nt.tweens.map(function(gt){var _t=xZ(gt,st),Et=_t.value,At=ht$1.arr(Et)?Et[1]:Et,Rt=Na(At),Ft=xM(st.target,nt.name,Rt,st),Nt=mt?mt.to.original:Ft,Bt=ht$1.arr(Et)?Et[0]:Nt,Gt=Na(Bt)||Na(Ft),dr=Rt||Gt;return ht$1.und(At)&&(At=Nt),_t.from=xB(Bt,dr),_t.to=xB(bM(At,Bt),dr),_t.start=mt?mt.end:0,_t.end=_t.start+_t.delay+_t.duration+_t.endDelay,_t.easing=pM(_t.easing,_t.duration),_t.isPath=ht$1.pth(Et),_t.isColor=ht$1.col(_t.from.original),_t.isColor&&(_t.round=1),mt=_t,_t})}var NB={css:function(nt,st,mt){return nt.style[st]=mt},attribute:function(nt,st,mt){return nt.setAttribute(st,mt)},object:function(nt,st,mt){return nt[st]=mt},transform:function(nt,st,mt,gt,_t){if(gt.list.set(st,mt),st===gt.last||_t){var Et="";gt.list.forEach(function(At,Rt){Et+=Rt+"("+At+") "}),nt.style.transform=Et}}};function FB(nt,st){var mt=BB(nt);mt.forEach(function(gt){for(var _t in st){var Et=dM(st[_t],gt),At=gt.target,Rt=Na(Et),Ft=xM(At,_t,Rt,gt),Nt=Rt||Na(Ft),Bt=bM(DB(Et,Nt),Ft),Gt=vM(At,_t);NB[Gt](At,_t,Bt,gt.transforms,!0)}})}function SZ(nt,st){var mt=vM(nt.target,st.name);if(mt){var gt=bZ(st,nt),_t=gt[gt.length-1];return{type:mt,property:st.name,animatable:nt,tweens:gt,duration:_t.end,delay:gt[0].delay,endDelay:_t.endDelay}}}function wZ(nt,st){return cb(ub(nt.map(function(mt){return st.map(function(gt){return SZ(mt,gt)})})),function(mt){return!ht$1.und(mt)})}function VB(nt,st){var mt=nt.length,gt=function(Et){return Et.timelineOffset?Et.timelineOffset:0},_t={};return _t.duration=mt?Math.max.apply(Math,nt.map(function(Et){let At=Et.startOnceDelay??0,Rt=Et.pingPongDelayCorrection??0,Ft=Et.pingPongEndDelayCorrection??0;return gt(Et)+At+Rt+Ft+Et.duration*(Et.loop??1)})):st.duration,_t.delay=mt?Math.min.apply(Math,nt.map(function(Et){let At=Et.startOnceDelay??0,Rt=Et.pingPongDelayCorrection??0;return gt(Et)+At+Rt+Et.delay})):st.delay,_t.endDelay=mt?_t.duration-Math.max.apply(Math,nt.map(function(Et){let At=Et.startOnceDelay??0,Rt=Et.pingPongDelayCorrection??0,Ft=Et.pingPongEndDelayCorrection??0;return gt(Et)+At+Rt+Et.duration*(Et.loop??1)-Et.endDelay-Ft})):st.endDelay,_t}var bB=0;function AZ(nt){var st=hM(AB,nt),mt=hM(fM,nt),gt=vZ(mt,nt),_t=BB(nt.targets),Et=wZ(_t,gt),At=VB(Et,mt),Rt=bB;return bB++,hb(st,{id:Rt,children:[],animatables:_t,animations:Et,duration:At.duration,delay:At.delay,endDelay:At.endDelay,startOnceDelay:mt.startOnceDelay,pingPongDelayCorrection:mt.pingPongDelayCorrection,pingPongEndDelayCorrection:mt.pingPongEndDelayCorrection})}var Es=[],SB=[],ab,EZ=function(){function nt(){ab=requestAnimationFrame(st)}function st(mt){var gt=Es.length;if(gt){for(var _t=0;_t<gt;){var Et=Es[_t];Et.paused?(Es.splice(_t,1),gt-=1):(Et.tick(mt),_t++)}nt()}else ab=cancelAnimationFrame(ab)}return nt}();function MZ(nt){document.hidden?(Es.forEach(function(st){return st.pause(nt.timeStamp)}),SB=Es.slice(0),ai.running=Es=[]):SB.forEach(function(st){return st.play(nt.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",MZ);function ai(nt){nt===void 0&&(nt={});var st=0,mt=0,gt=0,_t,Et,At=0,Rt=null;function Ft(un){var es=window.Promise&&new Promise(function(kn){return Rt=kn});return un.finished=es,es}var Nt=AZ(nt);Ft(Nt);function Bt(){var un=Nt.direction;un!=="alternate"&&(Nt.direction=un!=="normal"?"normal":"reverse"),Nt.reversed=!Nt.reversed,Et.forEach(function(es){(es.loop===1||es.loop%2===0)&&(es.reversed=Nt.reversed)})}function Gt(){Nt.direction="normal",Nt.reversed=!1,Et.forEach(function(un){return un.reversed=!1})}function dr(un){return Nt.reversed?Nt.duration-un:un}function Mr(){st=0,mt=dr(Nt.currentTime)*(1/ai.speed)}function Tr(un,es,kn=!1){es&&(Nt.reversed?es.seek(es.duration*es.loop-(un-es.timelineOffset-es.pingPongDelayCorrection),kn):es.seek(un-es.timelineOffset-es.startOnceDelay-es.pingPongDelayCorrection,kn))}function zr(un,es=!1){if(Nt.reversed)for(var kn=At;kn--;)Tr(un,Et[kn],es);else for(var ts=0;ts<At;ts++)Tr(un,Et[ts],es)}function Fr(un){var LE,eS,SA,o$,h$,d$,y$,R$,M$,x$;var es=0,kn=Nt.animations,ts=kn.length;for(Nt.direction!=="alternate"&&((LE=Nt.parent)==null?void 0:LE.direction)==="alternate"?((eS=Nt.parent)==null?void 0:eS.rewind)===!1&&Nt.reversePlayback===!0&&Nt.rewind===!1&&((SA=Nt.parent)!=null&&SA.reversed&&Nt.direction==="alternate"?un=Nt.duration-Nt.delay+Nt.endDelay-un:un=Nt.duration+Nt.delay-Nt.endDelay-un):Tn(!1,(o$=Nt.parent)==null?void 0:o$.rewind,Nt.rewind,(h$=Nt.parent)==null?void 0:h$.reversePlayback,Nt.reversePlayback)&&((d$=Nt.parent)!=null&&d$.reversed&&Nt.direction==="alternate"?un=Nt.duration-Nt.delay+Nt.endDelay-un:un=Nt.duration+Nt.delay-Nt.endDelay-un);es<ts;){var Ko=kn[es],ds=Ko.animatable,Il=Ko.tweens,ru=Il.length-1,uu=Il[ru];ru&&(uu=cb(Il,function(rS){return un<rS.end})[0]||uu);let v$;(y$=Nt.parent)!=null&&y$.reversed&&Nt.direction==="alternate"?v$=eo$1(un-uu.start-uu.endDelay,0,uu.duration)/uu.duration:v$=eo$1(un-uu.start-uu.delay,0,uu.duration)/uu.duration;for(var p0=isNaN(v$)?1:uu.easing(v$),X1=uu.to.strings,q0=uu.round,W0=[],hu=uu.to.numbers.length,a1=void 0,Vx=0;Vx<hu;Vx++){var t0=void 0;let rS,wA;Nt.direction!=="alternate"?((R$=Nt.parent)==null?void 0:R$.rewind)===!1&&Nt.reversePlayback===!0&&Nt.rewind===!1?(rS=uu.to.numbers[Vx],wA=uu.from.numbers[Vx]||0):(wA=uu.to.numbers[Vx],rS=uu.from.numbers[Vx]||0):Tn(!0,(M$=Nt.parent)==null?void 0:M$.rewind,Nt.rewind,(x$=Nt.parent)==null?void 0:x$.reversePlayback,Nt.reversePlayback)?(rS=uu.to.numbers[Vx],wA=uu.from.numbers[Vx]||0):(wA=uu.to.numbers[Vx],rS=uu.from.numbers[Vx]||0),uu.isPath?t0=mZ(uu.value,p0*wA):t0=rS+p0*(wA-rS),q0&&(uu.isColor&&Vx>2||(t0=Math.round(t0*q0)/q0)),W0.push(t0)}var cu=X1.length;if(!cu)a1=W0[0];else{a1=X1[0];for(var lu=0;lu<cu;lu++){X1[lu];var b0=X1[lu+1],l1=W0[lu];isNaN(l1)||(b0?a1+=l1+b0:a1+=l1+" ")}}NB[Ko.type](ds.target,Ko.property,a1,ds.transforms),Ko.currentValue=a1,es++}}function Nr(un){Nt[un]&&!Nt.passThrough&&Nt[un](Nt)}function tn(){Nt.remaining&&Nt.remaining!==!0&&Nt.remaining--}let rn={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function Tn(un,es,kn,ts,Ko){return rn[un<<4|es<<3|kn<<2|ts<<1|Ko]}function $n(un,es=!1){var Il;var kn=Nt.duration;let ts=Nt.delay,Ko=kn-Nt.endDelay;(Il=Nt.parent)!=null&&Il.reversed&&Nt.direction==="alternate"&&(ts=Nt.endDelay,Ko=kn-Nt.delay);var ds=dr(un);if(Nt.progress=eo$1(ds/kn*100,0,100),es||(Nt.reversePlayback=ds<Nt.currentTime),At&&zr(ds,es),!Nt.began&&Nt.currentTime>=0&&(Nt.began=!0,Nr("begin")),!Nt.loopBegan&&Nt.currentTime>0&&(Nt.loopBegan=!0,Nr("loopBegin")),(Nt.reversed||ds>=0)&&ds<=ts&&Nt.currentTime!==0&&(Fr(0),Nr("change")),(ds>=Ko&&Nt.currentTime!==kn+Nt.pingPongDelayCorrection||!kn)&&(Fr(kn),Nr("change")),ds>ts&&ds<Ko?(Nt.changeBegan||(Nt.changeBegan=!0,Nt.changeCompleted=!1,Nr("changeBegin")),Fr(ds),Nr("change")):Nt.changeBegan?(Nt.changeCompleted=!0,Nt.changeBegan=!1,Nr("change"),At&&Nr("timelineChangeComplete")):Nt.began&&ds>Ko&&Nr("changeComplete"),Nt.currentTime=eo$1(ds,0,kn+Nt.pingPongDelayCorrection),Nt.began&&Nr("update"),un>=kn)if(tn(),!Nt.remaining)Nt.paused=!0,Nt.completed||(Nt.completed=!0,Nr("loopComplete"),Nr("complete"),!Nt.passThrough&&"Promise"in window&&(Rt(),Ft(Nt)));else{At?st+=Nt.duration/ai.speed:st+=Nt.duration;for(let ru of Et)ru.setStartTime(0),ru.remaining=ru.loop;Nr("loopComplete"),Nt.loopBegan=!1,Nt.direction==="alternate"?Bt():At&&Gt()}}return Nt.reset=function(){var un=Nt.direction;Nt.passThrough=!1,Nt.currentTime=0,Nt.progress=0,Nt.paused=!0,Nt.began=!1,Nt.loopBegan=!1,Nt.changeBegan=!1,Nt.completed=!1,Nt.changeCompleted=!1,Nt.reversePlayback=!1,Nt.reversed=un==="reverse",Nt.remaining=Nt.loop,Et=Nt.children,At=Et.length;for(var es=At;es--;)Nt.children[es].reset();Fr(Nt.reversed?Nt.duration:0)},Nt.setStartTime=function(un){st=un},Nt.set=function(un,es){return FB(un,es),Nt},Nt.tick=function(un){gt=un,st||(st=gt),$n((gt+(mt-st))*ai.speed)},Nt.seek=function(un,es=!1){$n(un-st,es)},Nt.pause=function(un){Nt.paused=!0,At&&(_t=un??performance.now())},Nt.play=function(un){!Nt.paused||(Nt.completed&&Nt.reset(),Nt.paused=!1,Es.push(Nt),At&&_t!==void 0&&(st+=(un??performance.now())-_t),ab||EZ())},Nt.reverse=function(){Bt(),Nt.completed=!Nt.reversed,Mr()},Nt.restart=function(){Nt.reset(),Nt.play()},Nt.reset(),Nt.autoplay&&Nt.play(),Nt}function wB(nt,st){for(var mt=st.length;mt--;)mM(nt,st[mt].animatable.target)&&st.splice(mt,1)}function TZ(nt){for(var st=LB(nt),mt=Es.length;mt--;){var gt=Es[mt],_t=gt.animations,Et=gt.children;wB(st,_t);for(var At=Et.length;At--;){var Rt=Et[At],Ft=Rt.animations;wB(st,Ft),!Ft.length&&!Rt.children.length&&Et.splice(At,1)}!_t.length&&!Et.length&&gt.pause()}}function CZ(nt,st){st===void 0&&(st={});var mt=st.direction||"normal",gt=st.easing?pM(st.easing):null,_t=st.grid,Et=st.axis,At=st.from||0,Rt=At==="first",Ft=At==="center",Nt=At==="last",Bt=ht$1.arr(nt),Gt=parseFloat(Bt?nt[0]:nt),dr=Bt?parseFloat(nt[1]):0,Mr=Na(Bt?nt[1]:nt)||0,Tr=st.start||0+(Bt?Gt:0),zr=[],Fr=0;return function(Nr,tn,rn){if(Rt&&(At=0),Ft&&(At=(rn-1)/2),Nt&&(At=rn-1),!zr.length){for(var Tn=0;Tn<rn;Tn++){if(!_t)zr.push(Math.abs(At-Tn));else{var $n=Ft?(_t[0]-1)/2:At%_t[0],un=Ft?(_t[1]-1)/2:Math.floor(At/_t[0]),es=Tn%_t[0],kn=Math.floor(Tn/_t[0]),ts=$n-es,Ko=un-kn,ds=Math.sqrt(ts*ts+Ko*Ko);Et==="x"&&(ds=-ts),Et==="y"&&(ds=-Ko),zr.push(ds)}Fr=Math.max.apply(Math,zr)}gt&&(zr=zr.map(function(ru){return gt(ru/Fr)*Fr})),mt==="reverse"&&(zr=zr.map(function(ru){return Et?ru<0?ru*-1:-ru:Math.abs(Fr-ru)}))}var Il=Bt?(dr-Gt)/Fr:Gt;return Tr+Il*(Math.round(zr[tn]*100)/100)+Mr}}function PZ(nt){nt===void 0&&(nt={});var st=ai(nt);return st.duration=0,st.add=function(mt,gt){var _t=Es.indexOf(st),Et=st.children;_t>-1&&Es.splice(_t,1);function At(dr){dr.passThrough=!0}for(var Rt=0;Rt<Et.length;Rt++)At(Et[Rt]);var Ft=hb(mt,hM(fM,nt));Ft.targets=Ft.targets||nt.targets;var Nt=st.duration;Ft.autoplay=!1,Ft.timelineOffset=ht$1.und(gt)?Nt:bM(gt,Nt),At(st);var Bt=ai(Ft);At(Bt),Et.push(Bt),Bt.parent=st;var Gt=VB(Et,nt);return st.delay=Gt.delay,st.endDelay=Gt.endDelay,st.duration=Gt.duration,Bt.loop===!0&&(st.duration=1/0),st.seek(0),st.reset(),st.autoplay&&st.play(),st},st}ai.version="3.2.0";ai.speed=1;ai.running=Es;ai.remove=TZ;ai.get=xM;ai.set=FB;ai.convertPx=yM;ai.path=pZ;ai.setDashoffset=dZ;ai.stagger=CZ;ai.timeline=PZ;ai.easing=pM;ai.penner=TB;ai.random=function(nt,st){return Math.floor(Math.random()*(st-nt+1))+nt};var db=ai,UB=new E$6,zB=new E$6,kB=new Qe$1;function jB(nt,st,mt,gt){if(gt===0)return mt.copy(nt);if(gt===1)return mt.copy(st);let _t=nt.w*st.w+nt.x*st.x+nt.y*st.y+nt.z*st.z;if(_t>=1)return mt.copy(nt);let Et=1-_t*_t;if(Et<=Number.EPSILON){let Bt=1-gt;return mt.w=Bt*nt.w+gt*st.w,mt.x=Bt*nt.x+gt*st.x,mt.y=Bt*nt.y+gt*st.y,mt.z=Bt*nt.z+gt*st.z,mt.normalize(),mt}let At=Math.sqrt(Et),Rt=Math.atan2(At,_t),Ft=Math.sin((1-gt)*Rt)/At,Nt=Math.sin(gt*Rt)/At;return mt.w=nt.w*Ft+st.w*Nt,mt.x=nt.x*Ft+st.x*Nt,mt.y=nt.y*Ft+st.y*Nt,mt.z=nt.z*Ft+st.z*Nt,mt}function Zr(nt,st,mt,gt,_t,Et){let At=mt[nt]!==void 0?mt[nt]:void 0,Rt=gt[nt];if(Rt==null)return;let Ft=At!=null?typeof At=="string"?Number(_t.getVariable(At)??0):At:st[nt],Nt=typeof Rt=="string"?Number(_t.getVariable(Rt)??0):Rt;if(Ft!==Nt)return{update:Bt=>{let Gt=we$1.lerp(Ft,Nt,Bt);Et?st[nt]=Math.trunc(Gt):st[nt]=Gt},start:()=>{st[nt]=Ft},end:()=>{st[nt]=Nt}}}function Qm(nt,st,mt,gt,_t,Et){let At=mt[nt]?mt[nt]:void 0,Rt=gt[nt];if(!Rt)return;let Ft=st[nt],Nt=[...At??Ft].map(Gt=>typeof Gt=="string"?Number(_t.getVariable(Gt)??0):Gt),Bt=[...Rt].map(Gt=>typeof Gt=="string"?Number(_t.getVariable(Gt)??0):Gt);if(!(Nt.length!==Bt.length||Cc(Nt,Bt)))return{update:Gt=>{Nt.forEach((dr,Mr)=>{let Tr=we$1.lerp(dr,Bt[Mr],Gt);st[nt][Mr]=Et?Math.trunc(Tr):Tr})},start:()=>{Object.assign(st[nt],Nt)},end:()=>{Object.assign(st[nt],Bt)}}}function Xm(nt,st,mt){return st.forEach((gt,_t)=>{nt.setComponent(_t,typeof gt=="string"?Number(mt.getVariable(gt)??0):gt)}),nt}function wM(nt,st,mt,gt,_t){let Et=mt[nt]?mt[nt]:void 0,At=gt[nt];if(!At)return;let Rt=st[nt],Ft=Et?Xm(new E$6,Et,_t):Rt.clone(),Nt=Xm(new E$6,At,_t);if(!Ft.equals(Nt))return{update:Bt=>{Rt.lerpVectors(Ft,Nt,Bt)},start:()=>{Rt.copy(Ft)},end:()=>{Rt.copy(Nt)}}}function GB(nt,st,mt){return st.forEach((gt,_t)=>{nt.setComponent(_t,typeof gt=="string"?Number(mt.getVariable(gt)??0):gt)}),nt}function Of(nt,st,mt,gt,_t){let Et=mt[nt]?mt[nt]:void 0,At=gt[nt];if(!At)return;let Rt=st[nt],Ft=!(Rt instanceof U$1),Nt=Rt instanceof U$1?Rt:new U$1().fromArray(Rt),Bt=Et?GB(new U$1,Et,_t):Nt.clone(),Gt=GB(new U$1,At,_t);if(!Bt.equals(Gt))return{update:dr=>{Nt.lerpVectors(Bt,Gt,dr),Ft&&(st[nt]=Nt.toArray())},start:()=>{Nt.copy(Bt),Ft&&(st[nt]=Nt.toArray())},end:()=>{Nt.copy(Gt),Ft&&(st[nt]=Nt.toArray())}}}function HB(nt,st,mt,gt){let _t=mt[nt]?mt[nt]:void 0,Et=gt[nt];if(!Et)return;let At=st[nt],Rt=_t?new ue$1().fromArray(_t):At.clone(),Ft=new E$6,Nt=new Qe$1,Bt=new E$6;Rt.decompose(Ft,Nt,Bt);let Gt=new ue$1().fromArray(Et),dr=new E$6,Mr=new Qe$1,Tr=new E$6;if(Gt.decompose(dr,Mr,Tr),!Rt.equals(Gt))return{update:zr=>{kB.slerpQuaternions(Nt,Mr,zr),UB.lerpVectors(Ft,dr,zr),zB.lerpVectors(Bt,Tr,zr),At.compose(UB,kB,zB)},start:()=>{At.compose(Ft,Nt,Bt)},end:()=>{At.compose(dr,Mr,Tr)}}}function WB(nt,st,mt,gt,_t){let Et=mt[nt]?mt[nt]:void 0,At=gt[nt];if(!At)return;let Rt=st[nt],Ft=Et?typeof Et=="string"?_t.getColor(Et).clone():new We$1().setRGB(Et.r,Et.g,Et.b):Rt.clone(),Nt=typeof At=="string"?_t.getColor(At).clone():new We$1().setRGB(At.r,At.g,At.b);if(Ft.equals(Nt))return;let Bt=Rt.clone();return{update:Gt=>{var dr,Mr;Bt.lerpColors(Ft,Nt,Gt),(Mr=(dr=st[nt])==null?void 0:dr.copy)==null||Mr.call(dr,Bt)},start:()=>{Bt.copy(Ft)},end:()=>{Bt.copy(Nt)}}}function Km(nt,st,mt,gt,_t){let Et=mt[nt]?mt[nt]:void 0,At=gt[nt];if(!At)return;let Rt=st[nt],Ft=new vr(Rt.r,Rt.g,Rt.b,Rt.a),Nt=Et?typeof Et=="string"?_t.getColor(Et).clone():new vr(Et.r,Et.g,Et.b,Et.a):Ft.clone(),Bt=typeof At=="string"?_t.getColor(At).clone():new vr(At.r,At.g,At.b,At.a);if(!Nt.equals(Bt))return{update:Gt=>{Ft.lerpColors(Nt,Bt,Gt);let dr=we$1.lerp(Nt.a,Bt.a,Gt);Ft.a=dr,st[nt]={r:Ft.r,g:Ft.g,b:Ft.b,a:Ft.a}},start:()=>{Ft.copy(Nt)},end:()=>{Ft.copy(Bt)}}}function Ho(nt,st,mt,gt,_t){if(typeof st[nt]=="number")return Zr(nt,st,mt??{},gt,_t);if(Array.isArray(st[nt]))return Qm(nt,st,mt??{},gt,_t)}function qB(nt,st,mt,gt){var Rt,Ft,Nt,Bt;let _t=[],Et=nt.cameraType==="OrthographicCamera"?(Rt=st.orthographic)==null?void 0:Rt.zoom:(Ft=st.perspective)==null?void 0:Ft.zoom,At=nt.cameraType==="OrthographicCamera"?(Nt=mt.orthographic)==null?void 0:Nt.zoom:(Bt=mt.perspective)==null?void 0:Bt.zoom;if(At!==void 0){let Gt=Et??nt.zoom,dr=At;Gt!==dr&&_t.push({update:Mr=>{nt.zoom=we$1.lerp(Gt,dr,Mr),nt.updateProjectionMatrix()},start:()=>{nt.zoom=Gt,nt.updateProjectionMatrix()},end:()=>{nt.zoom=dr,nt.updateProjectionMatrix()}})}if(mt.targetOffset!==void 0){let Gt=Zr("targetOffset",nt,st,mt,gt);Gt&&_t.push(Gt)}return _t}function _Z(nt,st,mt,gt){if(mt.scaleBaked===void 0)return;let _t=(st.scaleBaked??nt.data.geometry.scaleBaked).map(Rt=>typeof Rt=="string"?Number(gt.getVariable(Rt)??0):Rt),Et=mt.scaleBaked.map(Rt=>typeof Rt=="string"?Number(gt.getVariable(Rt)??0):Rt);if(Ao.isEqual(_t,Et))return;let At=[];return At.push({update:Rt=>{nt.updateGeometryInteractions({scaleBaked:[we$1.lerp(_t[0],Et[0],Rt),we$1.lerp(_t[1],Et[1],Rt),we$1.lerp(_t[2],Et[2],Rt)]},gt),nt.invalidateDownstreamBooleanData(),nt.refreshAttachedClonersInteractions()},start:()=>{nt.updateGeometryInteractions({scaleBaked:_t},gt),nt.invalidateDownstreamBooleanData(),nt.refreshAttachedClonersInteractions()},end:()=>{nt.updateGeometryInteractions({scaleBaked:Et},gt),nt.invalidateDownstreamBooleanData(),nt.refreshAttachedClonersInteractions()}}),At}function DZ(nt,st,mt,gt){if(!mt.extrusion)return;let _t=nt.extrusion,Et=st.extrusion??{},At=mt.extrusion,Rt=[];return _1.forEach(Ft=>{let Nt=Ho(Ft,_t,Et,At,gt);Nt&&Rt.push(Nt)}),Rt}function YB(nt,st,mt,gt){let _t=[];if(!("geometry"in mt))return _t;let Et=nt.geometry.userData.parameters,At="geometry"in st?st.geometry:{},Rt=mt.geometry;if(nt instanceof Ks){let Ft=_Z(nt,At,Rt,gt);Ft&&_t.push(...Ft)}else{let Ft={};if(Object.assign(Ft,Pn(Et,zv),Pn(At,zv)),zv.forEach(Nt=>{let Bt=Ho(Nt,Ft,At,Rt,gt);Bt&&_t.push(Bt)}),nt instanceof Xl){Object.assign(Ft,{extrusion:{...Et.extrusion}});let Nt=DZ(Ft,At,Rt,gt);Nt&&_t.push(...Nt)}_t.length&&_t.push({update:Nt=>{nt.updateGeometryInteractions(Ft,gt),nt.updateGeometryGroupsIfNeeded(),nt.refreshAttachedClonersInteractions()},start:Nt=>{nt.updateGeometryInteractions(Ft,gt),nt.updateGeometryGroupsIfNeeded(),nt.refreshAttachedClonersInteractions()},end:Nt=>{nt.updateGeometryInteractions(Ft,gt),nt.updateGeometryGroupsIfNeeded(),nt.refreshAttachedClonersInteractions()}})}return _t}function XB(nt,st,mt,gt){let _t=[];if(mt.intensity!==void 0){let Et=Zr("intensity",nt,st,mt,gt);Et&&_t.push(Et)}if(mt.color!==void 0){let Et=WB("color",nt,st,mt,gt);Et&&_t.push(Et)}return _t}function KB(nt,st,mt,gt){let _t=[];if(Array.isArray(nt.material)){if(!("materials"in mt&&mt.materials))return _t;let Et="materials"in st&&st.materials?st.materials:[],At=mt.materials;nt.material.forEach((Rt,Ft)=>{if(!At[Ft])return;let Nt=Et[Ft]??{},Bt=At[Ft];typeof Nt=="string"||typeof Bt=="string"||_t.push(...QB(Rt,Nt,Bt,gt))})}else{if(!("material"in mt&&mt.material))return _t;let Et="material"in st&&st.material?st.material:{},At=mt.material;if(typeof Et=="string"||typeof At=="string")return _t;_t.push(...QB(nt.material,Et,At,gt))}return _t}function QB(nt,st,mt,gt){var At;let _t=[],Et=Wc(mt,gt)||!!st.layers&&Wc(st,gt);_t.push(UZ(nt,Et));for(let Rt of nt.layers){let Ft=(At=st.layers)==null?void 0:At.data(Rt.uuid),Nt=mt.layers.data(Rt.uuid);if(!Nt||Rt.type!=="light"&&(!(Rt.visible??!0)||!(Nt.visible??!0)))continue;let Bt=Rt.getNames().filter(Gt=>!Nv.some(dr=>Gt.includes(dr)));for(let Gt of Bt)try{let dr=Rt.getValue(Gt),Mr;if(Gt==="colors")Mr=FZ(Rt,Ft,Nt,Gt);else if(Array.isArray(dr))Gt==="steps"&&(Mr=NZ(Rt,Ft,Nt,Gt));else if(typeof dr=="number")Mr=IZ(Rt,Ft,Nt,Gt,gt);else{if(typeof dr=="boolean")continue;dr instanceof U$1?Mr=OZ(Rt,Ft,Nt,Gt):dr instanceof E$6?Mr=RZ(Rt,Ft,Nt,Gt,gt):dr instanceof vr?Mr=BZ(Rt,Ft,Nt,Gt,gt):dr instanceof We$1?Mr=LZ(Rt,Ft,Nt,Gt,gt):"isTexture"in dr&&(Mr=VZ(Rt,Ft,Nt,Gt))}Mr&&(Array.isArray(Mr)?_t.push(...Mr):_t.push(Mr))}catch(dr){console.error(`lerpMaterial: unexpected material layer for ${Gt}`,dr)}}return _t}function IZ(nt,st,mt,gt,_t){if(!nt.hasValue(gt)||!(gt in mt))return;let Et=st?st[gt]:nt.getValue(gt),At=mt[gt],Rt=typeof Et=="string"?Number(_t.getVariable(Et)??0):Et,Ft=typeof At=="string"?Number(_t.getVariable(At)??0):At;if(Rt!==Ft)return{update:Nt=>{nt.setValue(gt,we$1.lerp(Rt,Ft,Nt))},start:()=>{nt.setValue(gt,Rt)},end:()=>{nt.setValue(gt,Ft)}}}function OZ(nt,st,mt,gt){if(!nt.hasValue(gt)||!(gt in mt))return;let _t=nt.getValue(gt),Et=st?new U$1().fromArray(st[gt]):_t.clone(),At=new U$1().fromArray(mt[gt]);if(!Et.equals(At))return{update:Rt=>{_t.lerpVectors(Et,At,Rt)},start:()=>{_t.copy(Et)},end:()=>{_t.copy(At)}}}function RZ(nt,st,mt,gt,_t){if(!nt.hasValue(gt)||!(gt in mt))return;let Et=nt.getValue(gt),At=st?st[gt]:void 0,Rt=mt[gt],Ft=At?Xm(new E$6,At,_t):Et.clone(),Nt=Xm(new E$6,Rt,_t);if(!Ft.equals(Nt))return{update:Bt=>{Et.lerpVectors(Ft,Nt,Bt)},start:()=>{Et.copy(Ft)},end:()=>{Et.copy(Nt)}}}function LZ(nt,st,mt,gt,_t){if(!nt.hasValue(gt)||!(gt in mt))return;let Et=st?st[gt]:void 0,At=mt[gt],Rt=nt.getValue(gt),Ft=Et?typeof Et=="string"?_t.getColor(Et).clone():new We$1().setRGB(Et.r,Et.g,Et.b):Rt.clone(),Nt=typeof At=="string"?_t.getColor(At).clone():new We$1().setRGB(At.r,At.g,At.b);if(Ft.equals(Nt))return;let Bt=Rt.clone();return{update:Gt=>{nt.getValue(gt)!==Bt&&nt.setValue(gt,Bt),Bt.lerpColors(Ft,Nt,Gt)},start:()=>{Bt.copy(Ft)},end:()=>{Bt.copy(Nt)}}}function BZ(nt,st,mt,gt,_t){if(!nt.hasValue(gt)||!(gt in mt))return;let Et=st?st[gt]:void 0,At=mt[gt],Rt=nt.getValue(gt),Ft=Et?typeof Et=="string"?_t.getColor(Et).clone():new We$1().setRGB(Et.r,Et.g,Et.b):Rt.clone(),Nt=typeof At=="string"?_t.getColor(At).clone():new vr(At.r,At.g,At.b,At.a);if(Ft.equals(Nt))return;let Bt=Rt.clone();return{update:Gt=>{nt.getValue(gt)!==Bt&&nt.setValue(gt,Bt),Bt.lerpColors(Ft,Nt,Gt)},start:()=>{Bt.copy(Ft)},end:()=>{Bt.copy(Nt)}}}function NZ(nt,st,mt,gt="steps"){if(!nt.hasValue(gt)||!(gt in mt))return;let _t=[],Et=nt.getValue(gt),At=st?st[gt]:Et,Rt=mt[gt];return Cc(At,Rt)||_t.push({update:Ft=>{let Nt=[...Et];for(let Bt=0;Bt<Et.length;++Bt){let Gt=At[Bt],dr=Rt[Bt];Nt[Bt]=we$1.lerp(Gt,dr,Ft)}nt.setValue(gt,Nt)},start:()=>{nt.setValue(gt,At)},end:()=>{nt.setValue(gt,Rt)}}),_t.length?_t:void 0}function FZ(nt,st,mt,gt="colors"){if(!nt.hasValue(gt)||!(gt in mt))return;let _t=[],Et=nt.getValue(gt),At=st?st[gt]:Et.map(Ft=>Ft.toArray()),Rt=mt[gt];for(let Ft=0;Ft<Et.length;++Ft){let Nt=[...At[Ft]],Bt=[...Rt[Ft]];kp.isEqual(Nt,Bt)||_t.push({update:Gt=>{Et[Ft].fromArray(kp.lerp(Nt,Bt,Gt))},start:()=>{Et[Ft].fromArray(Nt)},end:()=>{Et[Ft].fromArray(Bt)}})}return _t.length?_t:void 0}function VZ(nt,st,mt,gt="texture"){var Fr,Nr;if(!nt.hasValue(gt)||!(gt in mt))return;let _t=nt.getNode("rotation"),Et=((Fr=st==null?void 0:st[gt])==null?void 0:Fr.rotation)??0,At=((Nr=mt[gt])==null?void 0:Nr.rotation)??0;if(_t&&Et!==At)return{update:tn=>{_t.value=we$1.lerp(Et,At,tn)*we$1.DEG2RAD},start:()=>{_t.value=Et*we$1.DEG2RAD},end:()=>{_t.value=At*we$1.DEG2RAD}};let Rt=nt.getNode("mat");if(!Rt)return;let Ft=st?st[gt]:Rt,Nt=mt[gt],Bt=[...Ft.repeat],Gt=[...Ft.offset],dr=[...Nt.repeat],Mr=[...Nt.offset],Tr=Ft.rotation??0,zr=Nt.rotation??0;if(!Fs.isEqual(Bt,dr)||!Fs.isEqual(Gt,Mr)||Tr!==zr)return{update:tn=>{Rt.repeat=Fs.lerp(Bt,dr,tn),Rt.offset=Fs.lerp(Gt,Mr,tn),Rt.rotation=we$1.lerp(Tr,zr,tn),Rt.updateMatrix()},start:()=>{Rt.repeat=[...Bt],Rt.offset=[...Gt],Rt.rotation=Tr,Rt.updateMatrix()},end:()=>{Rt.repeat=[...dr],Rt.offset=[...Mr],Rt.rotation=zr,Rt.updateMatrix()}}}function UZ(nt,st){return{update:()=>{nt.transparent=st}}}var AM=new E$6,ZB=new ir;function JB(nt,st,mt,gt,_t){var Tr,zr,Fr,Nr,tn,rn;let Et=[],At,Rt,Ft,Nt,Bt,Gt,dr,Mr;if(nt instanceof tr?(At=Of("position",nt,st,mt,_t),At&&Et.push(At),Ft=Zr("rotation",nt,st,mt,_t),Ft&&Et.push(Ft),Nt=Of("shear",nt,st,mt,_t),Nt&&Et.push(Nt)):(Mr={slide:((Tr=st.pathSnapping)==null?void 0:Tr.slide)??((zr=nt.updatedPathSnapping)==null?void 0:zr.slide)??((Fr=nt.dataPatched.pathSnapping)==null?void 0:Fr.slide)??0,offset:((Nr=st.pathSnapping)==null?void 0:Nr.offset)??((tn=nt.updatedPathSnapping)==null?void 0:tn.offset)??((rn=nt.dataPatched.pathSnapping)==null?void 0:rn.offset)??0},Gt=Zr("slide",Mr,st.pathSnapping??nt.updatedPathSnapping??nt.dataPatched.pathSnapping,mt.pathSnapping??nt.dataPatched.pathSnapping,_t),Gt&&Et.push(Gt),dr=Zr("offset",Mr,st.pathSnapping??nt.updatedPathSnapping??nt.dataPatched.pathSnapping,mt.pathSnapping??nt.dataPatched.pathSnapping,_t),dr&&Et.push(dr),!Gt&&!dr&&(At=wM("position",nt,st,mt,_t),At&&Et.push(At),Rt=wM("scale",nt,st,mt,_t),Rt&&Et.push(Rt),Ft=zZ(nt,st,mt,gt,_t),Ft&&Et.push(Ft),Bt=HB("hiddenMatrix",nt,st,mt),Bt&&Et.push(Bt))),At||Rt||Ft||Bt||Gt||dr){let Tn=nt instanceof tr?()=>{nt.updateWorldMatrix(!0)}:()=>{var $n;nt.updateMatrix(),nt.hasNonUniformScale&&(nt.updateMatrixWorld(),nt.updateMatrixWorldSVD()),($n=nt.parent)!=null&&$n.matrixWorldFusedFalse&&(nt.matrixWorld.multiplyMatrices(nt.parent.matrixWorldFusedFalse,nt.matrix),nt.matrixWorldNeedsUpdate=!1),cn(nt)&&En(nt.parent)&&nt.invalidateDownstreamBooleanData(!0),nt.updatePathSnapping(Object.assign({},st.pathSnapping,Mr))};Et.push({update:Tn,start:Tn,end:Tn})}return Et}function zZ(nt,st,mt,gt,_t){var Bt;let Et=st!=null&&st.rotation?st.rotation.map(Gt=>(typeof Gt=="string"?Number(_t.getVariable(Gt)??0):Gt)*we$1.DEG2RAD):void 0,At=(Bt=mt.rotation)==null?void 0:Bt.map(Gt=>(typeof Gt=="string"?Number(_t.getVariable(Gt)??0):Gt)*we$1.DEG2RAD);if(!At)return;let Rt=Et?new E$6().fromArray(Et):new E$6().setFromEuler(nt.rotation),Ft=new E$6().fromArray(At);if(Rt.equals(Ft))return;let Nt=AM.subVectors(Ft,Rt);if(gt&&Nt.toArray().every(Gt=>Math.abs(Gt)<2*Math.PI)){let Gt=new Qe$1().setFromEuler(ZB.setFromVector3(Rt)),dr=new Qe$1().setFromEuler(ZB.setFromVector3(Ft));return{update:Mr=>{jB(Gt,dr,nt.quaternion,Mr)},start:()=>{nt.rotation.setFromVector3(Rt)},end:()=>{nt.rotation.setFromVector3(Ft)}}}else return{update:Gt=>{AM.lerpVectors(Rt,Ft,Gt),nt.rotation.setFromVector3(AM)},start:()=>{nt.rotation.setFromVector3(Rt)},end:()=>{nt.rotation.setFromVector3(Ft)}}}function $B(nt,st,mt,gt){let _t=[];if(!("cloner"in mt)||!nt.cloner)return _t;let Et=nt.cloner,At="cloner"in st?st.cloner:{},Rt=mt.cloner;b1.forEach(Mr=>{let Tr;Mr==="count"?Tr=Zr("count",Et.parameters,At,Rt,gt,!0):Tr=Ho(Mr,Et.parameters,At??{},Rt,gt),Tr&&_t.push(Tr)});let Ft=kZ(Et,At,Rt,gt);Ft!=null&&Ft.length&&_t.push(...Ft);let Nt=GZ(Et,At,Rt,gt);Nt!=null&&Nt.length&&_t.push(...Nt);let Bt=jZ(Et,At,Rt,gt);Bt!=null&&Bt.length&&_t.push(...Bt);let Gt=HZ(Et,At,Rt,gt);Gt!=null&&Gt.length&&_t.push(...Gt);let dr=WZ(Et,At,Rt,gt);return dr!=null&&dr.length&&_t.push(...dr),_t.length&&_t.push({update:()=>{Et.update()}}),_t}function kZ(nt,st,mt,gt){if(nt.parameters.type!=="radial")return;let _t=st.radial,Et=mt.radial;if(!Et)return;let At=nt.parameters.radial,Rt=[];return S1.forEach(Ft=>{let Nt=Ho(Ft,At,_t??{},Et,gt);Nt&&Rt.push(Nt)}),Rt}function GZ(nt,st,mt,gt){if(nt.parameters.type!=="linear")return;let _t=st.linear,Et=mt.linear;if(!Et)return;let At=[],Rt=nt.parameters.linear;return w1.forEach(Ft=>{let Nt=Ho(Ft,Rt,_t??{},Et,gt);Nt&&At.push(Nt)}),At}function jZ(nt,st,mt,gt){if(nt.parameters.type!=="grid")return;let _t=st.grid,Et=mt.grid;if(!Et)return;let At=[],Rt=nt.parameters.grid;return A1.forEach(Ft=>{let Nt;Ft==="count"?Nt=Qm(Ft,Rt,_t??{},Et,gt,!0):Nt=Ho(Ft,Rt,_t??{},Et,gt),Nt&&At.push(Nt)}),At}function HZ(nt,st,mt,gt){if(nt.parameters.type!=="toObject")return;let _t=st.toObject,Et=mt.toObject;if(!Et)return;let At=[],Rt=nt.parameters.toObject;return E1.forEach(Ft=>{let Nt;Ft==="count"?Nt=Zr(Ft,Rt,_t??{},Et,gt,!0):Nt=Ho(Ft,Rt,_t??{},Et,gt),Nt&&At.push(Nt)}),At}function WZ(nt,st,mt,gt){if(!nt.parameters.randomness)return;let _t=st.randomnessObject,Et=mt.randomnessObject;if(!Et)return;let At=[],Rt=nt.parameters.randomnessObject;return M1.forEach(Ft=>{let Nt=Ho(Ft,Rt,_t??{},Et,gt);Nt&&At.push(Nt)}),At}function qZ(nt,st){return{update:()=>{nt instanceof Ar&&(nt.fill.enabled=st)}}}function YZ(nt,st){return{update:()=>{nt instanceof Ar&&(nt.stroke.enabled=st)}}}function XZ(nt,st){return{update:()=>{nt instanceof Ar&&(nt.dropShadow.enabled=st)}}}function QZ(nt,st){return{update:()=>{nt instanceof Ar&&(nt.innerShadow.enabled=st)}}}function KZ(nt,st){return{update:()=>{nt instanceof Ar&&(nt.backgroundBlur.enabled=st)}}}function ZZ(nt,st){return{update:()=>{nt instanceof Ar&&(nt.layerBlur.enabled=st)}}}function eN(nt,st,mt,gt,_t){let Et=[],At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr,Nr,tn,rn,Tn;if("width"in nt&&(At=Zr("width",nt,st,mt,_t),At&&Et.push(At)),"height"in nt&&(Rt=Zr("height",nt,st,mt,_t),Rt&&Et.push(Rt)),nt instanceof Ar||nt instanceof Ji){let $n={...st.fill},un={...mt.fill};$n.enabled!==void 0&&$n.enabled!==un.enabled&&(Et.push(qZ(nt,!0)),$n.enabled||Object.assign($n,{enabled:!0,color:{...$n.color,a:0}}),un.enabled||Object.assign(un,{enabled:!0,color:{...un.color,a:0}})),Ft=Km("color",nt.fill,$n,un,_t),Ft&&Et.push(Ft)}if(nt instanceof Ar){let $n={...st.stroke},un={...mt.stroke};($n.enabled||un.enabled)&&(Et.push(YZ(nt,!0)),$n.enabled||Object.assign($n,{enabled:!0,color:{...$n.color,a:0}}),un.enabled||Object.assign(un,{enabled:!0,color:{...un.color,a:0}})),Nt=Km("color",nt.stroke,$n,un,_t),Nt&&Et.push(Nt),Bt=Zr("thickness",nt.stroke,$n,un,_t),Bt&&Et.push(Bt)}if(nt instanceof Ar){let $n={...st.dropShadow},un={...mt.dropShadow};($n.enabled||un.enabled)&&(Et.push(XZ(nt,!0)),$n.enabled||Object.assign($n,{enabled:!0,color:{...$n.color,a:0}}),un.enabled||Object.assign(un,{enabled:!0,color:{...un.color,a:0}})),Gt=Km("color",nt.dropShadow,$n,un,_t),Gt&&Et.push(Gt),dr=Zr("blurRadius",nt.dropShadow,$n,un,_t),dr&&Et.push(dr),Tr=Zr("spread",nt.dropShadow,$n,un,_t),Tr&&Et.push(Tr),Mr=Of("offset",nt.dropShadow,$n,un,_t),Mr&&Et.push(Mr)}if(nt instanceof Ar){let $n={...st.innerShadow},un={...mt.innerShadow};($n.enabled||un.enabled)&&(Et.push(QZ(nt,!0)),$n.enabled||Object.assign($n,{enabled:!0,color:{...$n.color,a:0}}),un.enabled||Object.assign(un,{enabled:!0,color:{...un.color,a:0}})),zr=Km("color",nt.innerShadow,$n,un,_t),zr&&Et.push(zr),Fr=Zr("blurRadius",nt.innerShadow,$n,un,_t),Fr&&Et.push(Fr),tn=Zr("spread",nt.innerShadow,$n,un,_t),tn&&Et.push(tn),Nr=Of("offset",nt.innerShadow,$n,un,_t),Nr&&Et.push(Nr)}if(nt instanceof Ar||nt instanceof Ji){let $n={...st.backgroundBlur},un={...mt.backgroundBlur};($n.enabled||un.enabled)&&(Et.push(KZ(nt,!0)),$n.enabled||Object.assign($n,{enabled:!0,radius:0}),un.enabled||Object.assign(un,{enabled:!0,radius:0})),rn=Zr("radius",nt.backgroundBlur,$n,un,_t),rn&&Et.push(rn)}if(nt instanceof Ar){let $n={...st.layerBlur},un={...mt.layerBlur};($n.enabled||un.enabled)&&(Et.push(ZZ(nt,!0)),$n.enabled||Object.assign($n,{enabled:!0,radius:0}),un.enabled||Object.assign(un,{enabled:!0,radius:0})),Tn=Zr("radius",nt.layerBlur,$n,un,_t),Tn&&Et.push(Tn)}if(nt instanceof Ji||nt instanceof As){let $n=Qm("cornerRadius",nt,st,mt,_t);$n&&Et.push($n)}return Et}function EM(nt,st,mt,gt,_t){let Et=[];return nt.data.visible&&Et.push(...JB(nt,st,mt,_t,gt)),nt instanceof tr?Et.push(...eN(nt,st,mt,_t,gt)):(nt.data.visible&&Et.push(...$B(nt,st,mt,gt)),cn(nt)?(nt instanceof lr&&nt.data.visible&&Et.push(...YB(nt,st,mt,gt)),nt.data.visible&&Et.push(...KB(nt,st,mt,gt))):u3(nt)?nt.data.visible&&Et.push(...XB(nt,st,mt,gt)):c3(nt)&&Et.push(...qB(nt,st,mt,gt))),Et.length?{update:At=>{Et.forEach(Rt=>Rt.update(At))},start:At=>{Et.forEach(Rt=>{var Ft;return(Ft=Rt.start)==null?void 0:Ft.call(Rt,At)})},end:At=>{Et.forEach(Rt=>{var Ft;return(Ft=Rt.end)==null?void 0:Ft.call(Rt,At)})}}:void 0}var tN=new E$6;function If(nt,st,mt=!1){var Et;let gt=[],_t=At=>{let Rt=At.data;delete At.states,At.currentState=null,At.reversibleToState=null,At.currentTransitionEvent=null;for(let Ft of Rt.states){let Nt={...Ft.data};At.states||(At.states={}),At.states[Ft.id]=Aa.patch(Rt,Nt)}iN(nt.scene,At,null,st,Rt.events.find(Ft=>Ft.data.type==="Follow"||Ft.data.type==="LookAt")!==void 0),rN(nt)};nt.scene.traverse2D(_t),nt.traverseChildren(At=>{var Bt,Gt,dr,Mr,Tr,zr;if(mt&&((Bt=At.rigidBody)==null||Bt.setTranslation(At.position0,!0),(Gt=At.rigidBody)==null||Gt.setRotation(At.rotation0,!0),(dr=At.rigidBody)==null||dr.setLinvel(tN,!0),(Mr=At.rigidBody)==null||Mr.setAngvel(tN,!0)),!yt.is(At))return;let Rt=At.uuid,Ft=At.data;if(delete At.states,At.uuid===hs)return;let Nt=!1;gt.some(Fr=>{var Nr;return(Nr=nt.scene.find(Rt))==null?void 0:Nr.isDescendantOf(Fr)})?Nt=!0:((Tr=Ft.physics)==null?void 0:Tr.fusedBody)===!0&&Ft.physics.rigidBody==="dynamic"&&gt.push(Rt),At.data=Ft,At.currentState=null,At.reversibleToState=null,At.currentTransitionEvent=null;for(let Fr of Ft.states){let Nr={...Fr.data};nt.data.globalPhysics.usePhysics===!0&&Ft.physics&&(Ft.physics.rigidBody==="dynamic"||Nt)&&(Fr.data.position!==void 0&&delete Nr.position,Fr.data.rotation!==void 0&&delete Nr.rotation,Fr.data.hiddenMatrix!==void 0&&delete Nr.hiddenMatrix),At.states||(At.states={}),At.states[Fr.id]=va.patch(Ft,Nr)}iN(nt.scene,At,null,st,Ft.events.find(Fr=>Fr.data.type==="Follow"||Fr.data.type==="LookAt")!==void 0),rN(nt),At instanceof Er&&At.frame&&(At.frame.traverse(Fr=>_t(Fr)),(zr=At.uiCanvas)==null||zr.applySize())}),nt.frame&&(nt.frame.traverse(At=>_t(At)),(Et=nt.uiCanvas)==null||Et.applySize())}function rN(nt){nt.traverseEntity(st=>{for(let mt of st.data.events){let gt=[];switch(mt.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":gt.push(...mt.data.actions);break;case"GameControl":for(let _t of Object.values(mt.data.gameActions))gt.push(..._t);break;case"DragDrop":gt.push(...mt.data.dragDropActions.drag,...mt.data.dragDropActions.drop);break;case"Conditional":gt.push(...mt.data.inActions,...mt.data.outActions);break}for(let _t of gt)if(_t.data.type==="Create"&&_t.data.hideBase==="Yes"){let Et=nt.scene.find(_t.data.object);Et&&(Et.visible=!1)}}})}function iN(nt,st,mt,gt,_t=!1){if(st instanceof lr&&st.removeInteractionGeometry(gt),st instanceof tr?st.changeSelectedState(mt,{shared:gt},_t):st.changeSelectedState(mt,{scene:nt,shared:gt},_t),st instanceof lr&&st.updateGeometryGroupsIfNeeded(),st instanceof wr&&st.updateCameraState(st.dataPatched,{scene:nt,shared:gt}),!(st instanceof tr)){if(st.cloner)for(let Et of st.cloner.children)Et.playModeVisible=void 0;st.updateVisible()}}function TM(nt){let st;if(nt.easing===5){let{control1:mt,control2:gt}=nt;st=`cubicBezier(
			${mt[0]}, ${mt[1]}, ${gt[0]}, ${gt[1]}
		)`}else if(nt.easing===6){let{mass:mt,stiffness:gt,damping:_t,velocity:Et}=nt;st=`spring( ${mt}, ${gt}, ${_t}, ${Et} )`}else{let mt;switch(nt.easing){case 0:mt=ma.linear;break;case 1:mt=ma.ease;break;case 2:mt=ma.easeIn;break;case 3:mt=ma.easeOut;break;case 4:mt=ma.easeInOut;break;default:mt=ma.linear}let[gt,_t,Et,At]=mt;st=`cubicBezier( ${gt}, ${_t}, ${Et}, ${At} )`}return{duration:Math.max(nt.duration,1e-4),easing:st}}function MM(nt){let st={delay:0,loop:nt.repeat===-1?!0:nt.repeat+1};if(nt.repeat===0)st.direction="normal",st.rewind=!1;else switch(nt.direction){case"pingpong":st.direction="alternate",st.rewind=!1;break;case"pingpong-rewind":st.direction="alternate",st.rewind=!0;break;default:st.direction="normal",st.rewind=!1;break}switch(st.delay=0,st.endDelay=0,st.startOnceDelay=0,st.pingPongDelayCorrection=0,st.pingPongEndDelayCorrection=0,nt.delayDirection){case"start-once":st.startOnceDelay=nt.delay;break;case"start":st.delay=nt.delay;break;case"end":st.endDelay=nt.delay;break;case"start-end":case void 0:st.delay=nt.delay,st.endDelay=nt.delay;break}return st.direction==="alternate"&&(st.delay/=2,st.endDelay/=2,nt.delayDirection==="start"?(st.pingPongDelayCorrection=st.delay,typeof st.loop=="number"&&st.loop%2===0&&(st.pingPongEndDelayCorrection=st.delay)):nt.delayDirection==="end"?typeof st.loop=="number"&&st.loop%2!==0&&(st.pingPongEndDelayCorrection=st.endDelay):nt.delayDirection==="start-end"&&(st.pingPongDelayCorrection=st.delay,st.pingPongEndDelayCorrection=st.endDelay)),st}var JZ={type:"beginState"},$Z={type:"completeState",isfromEntity:!1},pb=class{constructor(nt,st,mt,gt,_t,Et){if(this.object=nt,this.data=gt,this.sharedAssets=_t,this.allowSlerp=Et,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let At=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=At,this.object.dispatchEvent({type:"beginState",state:At}),this.object instanceof tr||this.object.traverseEntity(Rt=>{Rt!==this.object&&Rt instanceof wr&&Rt.dispatchEvent(JZ)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let At=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=At,this.object.dispatchEvent({type:"completeState",state:At}),this.object instanceof tr||this.object.traverseEntity(Rt=>{Rt!==this.object&&Rt instanceof wr&&Rt.dispatchEvent($Z)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=EM(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},st===void 0){let At=fb(this.object,this.object.currentState===mt?this.object.prevState:this.object.currentState);if(!At)throw new Error("Missing property");this.from=At}else{let At=fb(this.object,st);if(!At)throw new Error("Missing property");this.from=At}if(mt===void 0)throw new Error("Missing property");{let At=fb(this.object,mt);if(!At)throw new Error("Missing property");this.to=At}this.useCurrentState=st===void 0||mt===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...MM(gt),...TM(gt),change:this.onChange},this.callback=EM(this.object,st===void 0?{}:this.from.data,mt===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},Zm=class extends pr{constructor(nt,st,mt,gt,_t){var At;if(super(),this.eventType=nt,this.data=st,this.page=mt,this.shared=gt,this.condition=_t,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{var Rt;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((Rt=this.timeline)==null||Rt.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!st.object)throw new Error("Missing property");let Et=this.page.scene.find(st.object)??((At=this.page.uiCanvas)==null?void 0:At.find(st.object))??this.page.scene.find2DInUIObjects(st.object);if(!Et)throw new Error("Missing property");if(!Et.states)throw new Error("Missing property");if(this.object=Et,st.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=st.tweens[0].data.delayDirection==="start-once"?st.tweens[0].data.delay:0,this.init()}get playing(){var nt;return((nt=this.timeline)==null?void 0:nt.paused)===!1}get changeBegan(){return this.tweens.some(nt=>nt.changeBegan)??!1}init(){this.initialCurrentState=fb(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.data.runMode==="Toggle"&&v1(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:nt=!0,needsRebuild:st=!1,isRebuild:mt=!1}={}){var gt,_t,Et,At;try{let Rt=MM(this.data.tweens[0].data);mt&&typeof Rt.loop=="number"&&Rt.loop--,(gt=this.timeline)==null||gt.pause(),this.timeline=db.timeline({autoplay:!1,...Rt,...Rt.loop===!0||Rt.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let Ft=this.tweens.findIndex(Nt=>Nt==null?void 0:Nt.changeBegan);if(st===!0&&(this.timelineNeedsRebuild=!0),nt){let Nt=Ft===-1?0:Ft;for(let Bt=Nt;Bt<this.data.tweens.length-1;Bt++){let Gt=this.data.tweens[Bt],dr=this.data.tweens[Bt+1],Mr;Bt===Nt&&(this.object.wasMovedByUser===!0||((_t=this.object.previousAction)==null?void 0:_t.changeBegan)===!0)?(Mr=void 0,this.object instanceof wr&&(this.object.wasMovedByUser=!1)):Mr=Gt.data.state===void 0?this.currentState:Gt.data.state;let Tr=new pb(this.object,Mr,dr.data.state===void 0?this.currentState:dr.data.state,dr.data,this.shared,this.data.allowSlerp??!1);Ft!==-1&&Bt===Nt&&Object.assign(Tr.params,{startOnceDelay:0}),this.tweens[Bt]=Tr,this.timeline.add(Tr.params,this.timeline.duration+(Bt===Nt?Rt.delay:0))}this.timeline.duration+=Rt.endDelay}else{let Nt=Ft===-1?this.data.tweens.length-1:Ft+1;for(let Bt=Nt;Bt>0;Bt--){let Gt=this.data.tweens[Bt],dr=this.data.tweens[Bt-1],Mr;Bt===Nt&&(this.object.wasMovedByUser===!0||((Et=this.object.previousAction)==null?void 0:Et.changeBegan)===!0)?(Mr=void 0,this.object instanceof wr&&(this.object.wasMovedByUser=!1)):Mr=Gt.data.state===void 0?this.currentState:Gt.data.state;let Tr=new pb(this.object,Mr,dr.data.state===void 0?this.currentState:dr.data.state,Gt.data,this.shared,this.data.allowSlerp??!1);Ft!==-1&&Bt===Nt&&Object.assign(Tr.params,{startOnceDelay:0}),this.tweens[Bt-1]=Tr,this.timeline.add(Tr.params,this.timeline.duration+(Bt===Nt?Rt.endDelay:0))}this.timeline.duration+=Rt.delay}}catch(Rt){Rt instanceof Error&&console.error(Rt.message)}((At=this.object.previousAction)==null?void 0:At.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(wt(this.shared,this.condition)===!1||v1(this.eventType)&&this.data.runMode==="Once"&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let nt=MM(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(st){st instanceof Error&&console.error(st.message)}},this.startOnceDelay+nt)}pause(){var nt;(nt=this.timeline)==null||nt.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let nt=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof tr?this.object.changeSelectedState(nt,{shared:this.shared}):this.object.changeSelectedState(nt,{scene:this.page.scene,shared:this.shared}),this.object.currentState=nt}seek(nt){var st;if(wt(this.shared,this.condition)===!1)return!1;this.timeline===void 0&&this.buildTimeline(),(st=this.timeline)==null||st.seek(nt*this.timeline.duration,!0)}toggle(nt){var st;if(wt(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),this.toggleIsForward=nt??!this.toggleIsForward,this.playing?((st=this.timeline)==null||st.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var mt;(mt=this.timeline)==null||mt.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function fb(nt,st){var _t;let mt,gt;if(typeof st=="string"?(mt=st,gt=(_t=nt.states)==null?void 0:_t[mt]):st===null&&(mt=null,gt=nt.data),!(mt===void 0||gt===void 0))return{id:mt,data:gt}}var eJ={type:"beginState"},nN={type:"completeState",isfromEntity:!1},sN={type:"requestRender"},Jm=class extends pr{constructor(nt,st,mt,gt){super(),this.data=nt,this.page=st,this.shared=mt,this.condition=gt,this.toggleIsForward=!1,this.posStart=new E$6,this.posEnd=new E$6,this.qStart=new Qe$1,this.qEnd=new Qe$1,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(nt=!1){if(!this.data.animate)return;let st=this.page.scene.find(this.data.targetCamera);if(!st||!st.visible)throw new ReferenceError("Target camera not founded or not visible");let mt={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=db({targets:mt,t:1,...TM(this.data),update:()=>{mt.t===0&&(this.data.runMode==="Toggle"&&!this.toggleIsForward?this.fromCamera&&(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(st.position),this.qEnd.copy(st.quaternion),this.zoomEnd=st.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(st.uuid)),this.page.activeCamera.dispatchEvent(eJ));let gt=this.page.activeCamera;gt.position.lerpVectors(this.posStart,this.posEnd,mt.t),gt.quaternion.slerpQuaternions(this.qStart,this.qEnd,mt.t),gt.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*mt.t,gt.wasMovedBySwitchCameraAction=!0,gt.updateMatrix(),gt.updateMatrixWorld(),gt.updateProjectionMatrix(),gt.dispatchEvent(sN),mt.t===1&&gt.dispatchEvent(nN)}})}switchCamera(nt){let st=this.page.activeCamera,mt=this.page.scene.find(nt);if(!mt||!mt.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(mt),st.dispatchEvent({type:"cameraChange",camera:mt})}play(){if(wt(this.shared,this.condition)===!1)return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var nt;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(nt=this.animation)==null||nt.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var nt;(nt=this.animation)==null||nt.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(nt){var st,mt;if(wt(this.shared,this.condition)===!1)return!1;if(window.clearTimeout(this.timeoutId),delete this.timeoutId,nt!==this.toggleIsForward)try{this.playing?((st=this.animation)==null||st.pause(),this.toggleIsForward=nt??!this.toggleIsForward,this.buildAnimation(!0),(mt=this.animation)==null||mt.play()):this.timeoutId=window.setTimeout(()=>{var gt,_t;this.toggleIsForward=nt??!this.toggleIsForward,this.data.animate?((gt=this.animation)==null||gt.pause(),this.buildAnimation(),(_t=this.animation)==null||_t.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.fromCamera&&this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(nN),this.page.activeCamera.dispatchEvent(sN))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function CM(nt){let st=nt==null?void 0:nt.tracks.filter(mt=>mt.ValueTypeName==="vector"||mt.ValueTypeName==="quaternion").map(mt=>mt.times.length);if(st!=null&&st.length){let mt=Qw(st);return mt&&mt>2?mt:2}return 2}var $m=class extends pr{constructor(nt,st,mt,gt,_t){var Ft,Nt,Bt;super(),this.data=nt,this.page=st,this.animationControls=mt,this.shared=gt,this.condition=_t,this.startOnceDelay=0,this.toggleIsForward=!1;let Et=nt.object,At=st.scene.find(nt.object);At&&Array.isArray(At.identity)&&(Et=At.identity[0]),this.data={...nt,object:Et};let Rt=this.animationControls.clipIdToAction[nt.clipId+"/"+Et];if(this.duration=((Ft=Rt==null?void 0:Rt.getClip())==null?void 0:Ft.duration)??1,this.data.crop2){let Gt=CM(Rt==null?void 0:Rt.getClip());this.leftFrameTime=this.data.crop2[0]/(Gt-1)*this.duration,this.rightFrameTime=this.data.crop2[1]/(Gt-1)*this.duration}else{let Gt=(Bt=(Nt=Rt==null?void 0:Rt.getClip())==null?void 0:Nt.tracks[0])==null?void 0:Bt.times.length;Gt&&Gt>1?(this.leftFrameTime=this.data.crop[0]/Gt*this.duration,this.rightFrameTime=this.data.crop[1]/Gt*this.duration):(this.leftFrameTime=0,this.rightFrameTime=this.duration)}this.startOnceDelay=nt.delay}get playing(){var nt;return((nt=this.threeAnimAction)==null?void 0:nt.isRunning())??!1}play(nt=!1){if(wt(this.shared,this.condition)===!1)return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var mt;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let st=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([gt,_t])=>{let Et=gt.split("/")[1];this.threeAnimAction!==_t&&Et===st&&_t.isRunning()&&(nt?_t.fadeOut(.2):_t.stop())}),nt&&((mt=this.threeAnimAction)==null||mt.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var nt;(nt=this.threeAnimAction)==null||nt.fadeOut(.2)}seek(nt){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=we$1.clamp(this.threeAnimAction.time+1/60*nt,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(nt,st=!1){if(wt(this.shared,this.condition)===!1)return!1;this.toggleIsForward=nt??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var mt;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let gt=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([_t,Et])=>{let At=_t.split("/")[1];this.threeAnimAction!==Et&&At===gt&&Et.isRunning()&&(st?Et.fadeOut(.2):Et.stop())}),st&&((mt=this.threeAnimAction)==null||mt.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var st;let nt=(st=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:st.getClip();nt&&(nt.duration=this.duration),this.pause()}},eg=class{constructor(nt,st,mt,gt,_t){this.data=nt,this.page=st,this.eventManager=mt,this.shared=gt,this.condition=_t,this.timeOutId=-1,this.scene=st.scene}dispatch(){if(wt(this.shared,this.condition)===!1)return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(st=>st.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let nt=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity(st=>{st.type==="ParticleSystem"&&(st.sleep(),st.wakeUp(),st.data.autoPlay?st.start():st.stop())}),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(nt),If(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},tg=class{constructor(nt,st,mt,gt){this.data=nt,this.page=st,this.shared=mt,this.condition=gt,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=wt(this.shared,this.condition)}dispatch(){if(this.evaluatedCondition===!1)return!1;let nt=this.shared.getVariable(this.data.variableId),st=_0(this.data.expression,this.shared,Lr.typeOfVariable(nt));st!==void 0&&this.shared.updateVariable(this.data.variableId,typeof st=="string"?{textValue:st}:st)}dispose(){}},rg=class{constructor(nt,st,mt,gt){this.data=nt,this.page=st,this.shared=mt,this.condition=gt,this.timeoutId=null}dispatchInner(){if(wt(this.shared,this.condition)===!1)return!1;let nt=this.shared.getDynamicVariablePlayState(this.data.variableId);if(this.data.mode==="PlayPause")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,nt==="Playing"?"Paused":"Playing");else if(this.data.mode==="Play"&&nt!=="Playing")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if(this.data.mode==="Stop"&&nt!=="Stopped")this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if(this.data.mode==="Pause"&&nt!=="Paused")this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if(this.data.mode==="Restart")this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if(this.data.mode==="Toggle"){let st=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);nt==="Playing"?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,st===void 0?!1:!st):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!st),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let nt=this.data.delay,st=this.shared.getDynamicVariablePlayState(this.data.variableId);this.data.mode==="PlayPause"&&st==="Playing"&&(nt=this.data.pauseDelay),nt!==0?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.timeoutId=null,this.dispatchInner()},nt)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},mb=class{constructor(nt,st,mt,gt){this.data=nt,this.page=st,this.shared=mt,this.condition=gt}dispatch(){if(wt(this.shared,this.condition)===!1)return!1;(this.data.target==="single"?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach(nt=>{var mt;this.shared.getVariable(nt);let st=(mt=this.shared.data.variables.data(nt))==null?void 0:mt.value;st!==void 0&&this.shared.updateVariable(nt,st),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(ix(nt))})}dispose(){}},gb=class{constructor(nt,st,mt,gt){this.data=nt,this.page=st,this.shared=mt,this.condition=gt}dispatch(){var nt;if(wt(this.shared,this.condition)===!1)return!1;this.data.userAPIId&&((nt=this.shared.getUserAPI(this.data.userAPIId))==null||nt.callUserAPI(this.shared))}dispose(){}};function wt(nt,st){if(st===void 0)return!0;if(st.expression.length===0)return!1;let mt=_0(st.expression,nt,"boolean");return st.negate?!mt:!!mt}function Kt$1(nt,st,mt,gt,_t,Et){let At={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[],UserAPI:[]},Rt=Ft=>({id:Nt,data:Bt})=>{try{Bt.type==="Audio"?Yi[nt.type].includes("Audio")&&At.Audio.push(new jm(Nt,Bt,Et,gt,Ft)):Bt.type==="Video"&&!(Et instanceof tr)?Yi[nt.type].includes("Video")&&At.Video.push(new ig(Nt,Bt,Et,gt,Ft)):Bt.type==="Particles"?Yi[nt.type].includes("Particles")&&At.Particles.push(new Hm(Bt,mt,gt,Ft)):Bt.type==="Link"?Yi[nt.type].includes("Link")&&At.Link.push(new ob(Bt,_t.controlsManager,gt,Ft)):Bt.type==="Create"?Yi[nt.type].includes("Create")&&At.Create.push(new ng(Bt,mt,_t.controlsManager,gt,Ft)):Bt.type==="Destroy"?Yi[nt.type].includes("Destroy")&&At.Destroy.push(new Wm(Bt,mt,_t.controlsManager,gt,Ft)):Bt.type==="Reset"?Yi[nt.type].includes("Reset")&&At.Reset.push(new qm(Bt,mt,gt,_t,Ft)):Bt.type==="Transition"?Yi[nt.type].includes("Transition")&&At.Transition.push(new Zm(nt.type,Bt,mt,gt,Ft)):Bt.type==="SwitchCamera"?Yi[nt.type].includes("SwitchCamera")&&At.SwitchCamera.push(new Jm(Bt,mt,gt,Ft)):Bt.type==="SceneTransition"?Yi[nt.type].includes("SceneTransition")&&At.SceneTransition.push(new eg(Bt,mt,_t,gt,Ft)):Bt.type==="Animation"?Yi[nt.type].includes("Animation")&&At.Animation.push(new $m(Bt,mt,_t.animationControls,gt,Ft)):Bt.type==="SetVariable"?Yi[nt.type].includes("SetVariable")&&At.SetVariable.push(new tg(Bt,mt,gt,Ft)):Bt.type==="DynamicVariablePlay"?Yi[nt.type].includes("DynamicVariablePlay")&&At.DynamicVariablePlay.push(new rg(Bt,mt,gt,Ft)):Bt.type==="Conditional"?Yi[nt.type].includes("Conditional")&&(Bt.ifActions.forEach(Rt({expression:Bt.condition,negate:!1})),Bt.elseActions.forEach(Rt({expression:Bt.condition,negate:!0}))):Bt.type==="ClearLocalStorage"?Yi[nt.type].includes("ClearLocalStorage")&&At.ClearLocalStorage.push(new mb(Bt,mt,gt,Ft)):Bt.type==="UserAPI"&&Yi[nt.type].includes("UserAPI")&&At.UserAPI.push(new gb(Bt,mt,gt,Ft))}catch{}};return st.forEach(Rt()),At}function ur(nt){Object.values(nt).forEach(st=>{st.forEach(mt=>{(mt instanceof jm||mt instanceof ig||mt instanceof Hm||mt instanceof $m||mt instanceof Zm||mt instanceof ng||mt instanceof Wm||mt instanceof Jm||mt instanceof eg||mt instanceof qm||mt instanceof tg||mt instanceof rg)&&mt.dispose()})})}function oN(nt,st){let mt;if("material"in nt){let gt=nt.material;Array.isArray(gt)?mt=nt.material[0].layers.find(_t=>_t.uuid===st):mt=nt.material.layers.find(_t=>_t.uuid===st)}if(mt)return mt.color.texture.image.img instanceof HTMLVideoElement?mt.color.texture.image.img:void 0}var aN=new Map,sg=new Map,Fa=class{constructor(nt,st,mt){this.data=st,this.delay=0,this.status="stopped";let{layerId:gt,loop:_t,volume:Et,delay:At}=st;if(this.object=mt,gt===void 0)throw new Error("Missing property");let Rt=oN(mt,gt);Rt&&(this.videoElement=Rt,this.videoElement.loop=_t===1/0,go&&(this.videoElement.autoplay=!0),Et!==void 0&&(this.videoElement.volume=Et)),At!==void 0&&(this.delay=At),sg.has(mt.uuid)?sg.get(mt.uuid).push(this):sg.set(mt.uuid,[this]),aN.set(nt,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(nt){if(!this.videoElement)return;let st=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);nt?(this.mute(),this.delay+=150):st?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let mt=this.videoElement.play();mt!==void 0&&mt.then(gt=>{}).catch(gt=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},Rf=class{constructor(nt){this.data=nt}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(nt){let st=aN.get(nt);!st||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{st[this.data.interaction](),this.disposeDelay()},this.data.delay)):st[this.data.interaction]())}pauseAllVideosFromObject(nt){let st=sg.get(nt);!(st!=null&&st.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{st.forEach(mt=>mt[this.data.interaction]()),this.disposeDelay()},this.data.delay)):st.forEach(mt=>mt[this.data.interaction]()))}pauseAllVideos(){let nt=[...sg.values()];!nt.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{nt.forEach(st=>{st.forEach(mt=>{mt[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):nt.forEach(st=>{st.forEach(mt=>{mt[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},ig=class{constructor(nt,st,mt,gt,_t){if(this.data=st,this.shared=gt,this.condition=_t,st.interaction==="play")this.interaction=new Fa(nt,st,mt);else if(st.interaction==="pause"||st.interaction==="stop")this.interaction=new Rf(st);else throw new Error("Missing property")}dispatchBasic(){if(wt(this.shared,this.condition)===!1)return!1;this.interaction instanceof Fa?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(wt(this.shared,this.condition)===!1)return!1;this.interaction instanceof Fa?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},lN=(()=>{let nt,st,mt,gt;function _t(Rt){!nt&&!cN()&&(st==null?void 0:st.sharedGameControlGlobals.createdObjects.length)>0&&(nt=requestAnimationFrame(Et)),Rt&&(st=Rt,gt=Rt.requestRender)}function Et(Rt){let Ft=mt?Rt-mt:0,Nt=st.sharedGameControlGlobals.createdObjects,Bt=st.sharedGameControlGlobals.nCreatedPerAction,Gt=Nt.length,dr=0;for(;dr<Gt;){let Mr=Nt[dr];Mr.userData.createdTime===void 0&&(Mr.userData.createdTime=Rt),Mr.userData.lifetime===void 0&&Mr.userData.quantity===void 0||Mr.userData.lifetime&&Rt-Mr.userData.createdTime<Mr.userData.lifetime||Mr.userData.quantity&&Bt[Mr.userData.actionId]<=Mr.userData.quantity?(Mr.userData.velocity&&(Mr.position.addScaledVector(Mr.userData.velocity,Ft/1e3),Mr.updateMatrix(),gt()),dr++):(Bt[Mr.userData.actionId]>Mr.userData.quantity&&Bt[Mr.userData.actionId]--,Nt.splice(dr,1),Mr.removeFromParent(),st.sharedGameControlGlobals.rapierWorld&&Mr.rigidBody?(st.sharedGameControlGlobals.colliderToEntity.delete(Mr.rigidBody.collider(0).handle),st.sharedGameControlGlobals.rapierWorld.removeRigidBody(Mr.rigidBody)):(Mr.bvhGeometry=void 0,st.sharedGameControlGlobals.entitiesWithTransformAnim=st.sharedGameControlGlobals.entitiesWithTransformAnim.filter(Tr=>Tr.bvhGeometry!==void 0)),Gt--,gt())}nt=dr>0?requestAnimationFrame(Et):void 0,mt=dr>0?Rt:void 0}function At(){cN()?nt&&(cancelAnimationFrame(nt),nt=void 0,mt=void 0):_t()}return typeof document<"u"&&document.addEventListener("visibilitychange",At),_t})();function cN(){return!!document&&document.hidden}var uN=new Qe$1,tJ=new E$6,rJ=new E$6,ng=class{constructor(nt,st,mt,gt,_t){this.data=nt,this.page=st,this.controlsManager=mt,this.shared=gt,this.condition=_t,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=we$1.generateUUID(),this.dispatch=()=>{if(wt(this.shared,this.condition)===!1)return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{if(wt(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=Kw(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let At=new Br(this.object);if(At.playModeVisible=!0,At.expand(),this.data.coordinateSystem!=="world"){let Ft=this.data.coordinateSystem,Nt=this.page.scene.find(Ft);Nt&&(Nt.updateMatrixWorldSVD(),At.hiddenMatrix.copy(Nt.matrixWorldRigid))}At.scale.copy(this.object.scale),At.position.fromArray(this.data.position),At.rotation.fromArray(this.data.rotation),At.updateMatrix(),this.page.add(At);let Rt=this.controlsManager.sharedGameControlGlobals;Rt.createdObjects.push(At),Rt.nCreatedPerAction[this.uniqueId]===void 0?Rt.nCreatedPerAction[this.uniqueId]=1:Rt.nCreatedPerAction[this.uniqueId]++,At.updateWorldMatrix(!0,!0),At.traverseObject(this.traverseObjectCB),lN(),this.controlsManager.requestRender()},this.traverseObjectCB=At=>{var Bt,Gt,dr,Mr;At.hasNonUniformScale&&At.updateMatrixWorldSVD();let Rt;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(At instanceof Gi)if(At.objectForSample){if(At.objectForSample.dataPatched.physics.fusedBody)return;Rt=At.object}else return At.object.dataPatched.physics.fusedBody===!0&&At.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(At instanceof Br)Rt=At.object;else if(Rt=At,(Bt=Rt.dataPatched.cloner)==null?void 0:Bt.hideBase)return!0}else{if(At instanceof Gi)return;At instanceof Br?Rt=At.object:Rt=At}this.data.destroy==="Time"?At.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(At.userData.quantity=this.data.destroyAfterQuantity,At.userData.actionId=this.uniqueId);let Ft=new E$6().fromArray(this.data.velocity),Nt=Rt.dataPatched;if(!(Nt.physics.enabled==="visibility"?!Nt.visible:!Nt.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(At,Rt,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((Gt=At.rigidBody)==null||Gt.collider(0).setActiveEvents(1),At.userData.hasCollisionDestroy=!0),At.matrixWorld.decompose(tJ,uN,rJ),Ft.applyQuaternion(uN),this.data.velocity.some(Tr=>Tr!==0)&&this.data.dynamic&&((dr=At.rigidBody)==null||dr.setLinvel(Ft.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in At.object&&this.controlsManager.addBoundsTree(At),this.data.velocity.some(Tr=>Tr!==0)&&this.data.dynamic&&(At.userData.velocity=Ft)),((Mr=Rt.dataPatched.physics)==null?void 0:Mr.fusedBody)===!0))return!0};let Et=this.page.scene.find(this.data.object);if(!Et)throw new Error("Missing Property");if(this.object=Et,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");lN(mt)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(nt=>window.clearTimeout(nt)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},IM=200,PM=.02,_M=.3,iJ=65;new E$6;var hN=new E$6,dN=new E$6,nJ=new E$6,Mn=new E$6,zn=new E$6,$l=new E$6,DM=new ue$1,fN=new ue$1,sJ=new ue$1;new ue$1;var to=new Qe$1,Va=new Qe$1,Wo=new ir(0,0,0,"YXZ"),oJ=new E$6(1,0,0),ro=new E$6(0,1,0),aJ=new E$6(0,0,1),pN=new E$6(1,1,1);new Or;var lJ=1,cJ=.025,uJ=16e-6,mN=12,hJ=20,Hi=new Mi,Ms=new jt,dJ={type:"requestRender"},fJ={type:"updateMatrix"},gN=Math.PI/6,yb=class extends pr{constructor(nt,st,mt,gt,_t,Et,At,Rt,Ft){var Tr;super(),this.object=nt,this.domElement=st,this.data=mt,this.gloabalPhysics=gt,this.controlsManager=_t,this.cameraFollow=Et,this.camera=At,this.page=Rt,this.sharedAssets=Ft,this.enableDamping=!0,this.hiddenMatrix0=new ue$1,this.target0=new E$6,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=IM,this.euler0=new ir(0,0,0,"YXZ"),this.position0Cam=new E$6,this.quat0Cam=new Qe$1,this.scale0Cam=new E$6,this.hiddenMatrix0Cam=new ue$1,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new Mi(new E$6(0,-40,0),new E$6(0,40,0)),matrix:new ue$1,position:new E$6,rotation:new Qe$1},this.euler=new ir(0,0,0,"YXZ"),this.eulerDelta=new E$6,this.lastPosition=new E$6,this.lastCameraQuaternion=new Qe$1,this.lastCameraPosition=new E$6,this.PI_2=Math.PI/2,this.prevMouse=new U$1,this.velocityTarget=new E$6,this.velocity=new E$6,this.directionXZ=new E$6,this.rotVelocityStick=new E$6,this.rotVelocityTarget=new E$6,this.rotVelocity=new E$6,this.rotDirection=new E$6,this.nonColliderRotOffset=new ue$1,this.nonColliderPosOffset=new ue$1,this.firstPointerId=-1,this.rot=new E$6,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new ue$1,this.objectToTarget=new E$6,this.objectToTarget0=new E$6,this.objectToCamXZ=new E$6,this.objectToCamXZ0=new E$6,this.targetToCamera=new E$6,this.targetToCamera0=new E$6,this.cameraPolarAxis0=new E$6,this.targetPos=new E$6,this.targetQuat=new Qe$1,this.lerpFactorPos=new E$6().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new Qe$1,this.objXZQuatInv=new Qe$1,this.objXZRotMat=new ue$1,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new E$6,this.pushedVelocity=new E$6,this.groundYRotation=0,this.objectRealQuat=new Qe$1,this.colliderWorldQuat=new Qe$1,this.groundNormal=new E$6,this.groundTilt=new Qe$1,this.groundTiltInv=new Qe$1,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new E$6,this.quaternion=new Qe$1,this.scale=new E$6,this.initialAction=!0,this.onPointerDown=zr=>{var Fr;!(zr.target===this.domElement||zr.target instanceof HTMLElement&&zr.target.tagName==="SPLINE-VIEWER"&&((Fr=zr.target.shadowRoot)!=null&&Fr.contains(this.domElement)))||this.firstPointerId!==-1||(this.firstPointerId=zr.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!Ci&&!Jw&&this.domElement.requestPointerLock(),this.prevMouse.set(zr.clientX,zr.clientY))},this.onPointerUp=zr=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),zr.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=zr=>{if(zr.pointerId!==this.firstPointerId)return;let Fr=zr.clientX-this.prevMouse.x,Nr=zr.clientY-this.prevMouse.y;this.prevMouse.set(zr.clientX,zr.clientY),zr.pointerType==="mouse"&&this.rotBy!=="keys"&&(Jw&&z2<15.5&&!Ci?(this.eulerDelta.y=-Fr*this.mouseOrbitSensitivity,this.eulerDelta.x=-Nr*this.mouseOrbitSensitivity):(this.eulerDelta.y=-zr.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-zr.movementY*this.mouseOrbitSensitivity)),zr.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-Fr*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-Nr*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=zr=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?yb.isLocked=!0:yb.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let zr in this.movementState)this.movementState[zr]=0},this.onKeyDown=zr=>{!(zr.target instanceof HTMLInputElement)&&(zr.code==="ArrowLeft"||zr.code==="ArrowUp"||zr.code==="ArrowRight"||zr.code==="ArrowDown"||zr.code==="Space")&&zr.preventDefault();for(let Fr of this.keyAssignments)if(zr.key.toUpperCase()===Fr[1]||zr.key===Fr[1]){this.movementState[Fr[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=zr=>{for(let Fr of this.keyAssignments)if(zr.key.toUpperCase()===Fr[1]||zr.key===Fr[1]||zr.code.slice(3,zr.code.length).toUpperCase()===Fr[1]){this.movementState[Fr[0]]=0;break}},this.copyVRGamePadValues=(zr,Fr)=>{for(let Nr=2;Nr<4;Nr++){let tn=zr.axes[Nr];Fr===0?Nr===2?this.movementState.movePosX=tn:this.movementState.movePosZ=tn:(zr.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,Nr===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(tn)>=.3&&(this.vrEulerYOffset+=tn<0?1:-1),this.movementState.rotPosY=tn):this.moveMode==="fly"&&(this.movementState.moveNegY=tn))}},this.sharedGameControlGlobals=_t.sharedGameControlGlobals,nt===At&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let Nt=this.euler0.clone(),Bt=Nt.y;if(this.objectRealQuat.copy(this.quaternion),Nt.y=0,this.quaternion.setFromEuler(Nt),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),Nt.set(0,Bt,0),this.quaternion.setFromEuler(Nt),this.rot.setFromEuler(Nt),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((Tr=this.camera)==null?void 0:Tr.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let zr=new E$6(0,0,-1).applyQuaternion(this.camera.quaternion),Fr=new E$6().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(Fr),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let Nr,tn;Math.abs(zr.y)<1e-6?(Fr.y=0,zr.y=0,tn=Fr.projectOnVector(zr)):Fr.y/zr.y>0?tn=zr.multiplyScalar(Fr.y/zr.y):tn=zr.multiplyScalar(Fr.length()),this.targetToCamera0.copy(tn).negate(),Nr=this.camera.position.clone().add(tn),this.objectToTarget0.subVectors(Nr,this.position);let rn=new ir().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-rn.x,rn.x=0,rn.z=0,rn.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(rn)}if(this.object instanceof wr&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=mt.rotByTouch??"joystick",this.rotBy=mt.rotBy??"keys",this.rotationMode=mt.rotationMode??"normal",this.moveMode=mt.moveMode??"walk",this.collisionEnabled=mt.collisionEnabled,this.speedTranslate=(mt.speedTranslate??250)*lJ,this.speedOrbit=(mt.speedRotate??100)*cJ,this.mouseOrbitSensitivity=(mt.speedRotate??100)*uJ,this.keyAssignments=mt.keyAssignments.map(zr=>{let Fr=[zr[0],zr[1]];return Fr[1]===""?Fr[1]="ArrowUp":Fr[1]===""?Fr[1]="ArrowLeft":Fr[1]===""?Fr[1]="ArrowDown":Fr[1]===""?Fr[1]="ArrowRight":Fr[1]===""?Fr[1]="Shift":Fr[1]===""?Fr[1]="Enter":Fr[1]==="Space"?Fr[1]=" ":Fr[1]===""?Fr[1]="Meta":Fr[1]==="Ctrl"?Fr[1]="Control":Fr[1]==="Esc"&&(Fr[1]="Escape"),Fr}),mt.rotBy==="mouse"){let zr;zr=this.keyAssignments.findIndex(Fr=>Fr[0]==="rotNegX"),zr!==-1&&(this.keyAssignments[zr][1]=""),zr=this.keyAssignments.findIndex(Fr=>Fr[0]==="rotPosX"),zr!==-1&&(this.keyAssignments[zr][1]=""),zr=this.keyAssignments.findIndex(Fr=>Fr[0]==="rotPosY"),zr!==-1&&(this.keyAssignments[zr][1]=""),zr=this.keyAssignments.findIndex(Fr=>Fr[0]==="rotNegY"),zr!==-1&&(this.keyAssignments[zr][1]="")}this.lerpFactorPosStart=1-.02**(1/((mt.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((mt.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((mt.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((mt.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((mt.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((mt.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??wl.defaultData.gravity)*mN,this.usePhysics=this.gloabalPhysics.usePhysics??wl.defaultData.usePhysics,this.jumpPower=mt.jumpPower*hJ,this.resetYPosition=this.position.y+Math.abs(mt.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=mt.alignToGround??!1,this.orientMode=mt.autoOrientMove?mt.orientMode:"none",this.orientWith=mt.orientWith??Qh.defaultDataThirdPerson.orientWith,this.slopeThresh=iJ*Math.PI/180,mt.collider.type==="capsule"?(this.collider.radius=mt.collider.radius,this.collider.segment.start.y=mt.collider.height/2-mt.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=mt.collider.height*PM/this.pixelsPerMeter,this.stepThresh=mt.collider.height*_M/this.pixelsPerMeter,this.colliderHeight=mt.collider.height):mt.collider.type==="sphere"?(this.collider.radius=mt.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*mt.collider.radius*PM/this.pixelsPerMeter,this.stepThresh=2*mt.collider.radius*_M/this.pixelsPerMeter,this.colliderHeight=mt.collider.radius*2):(this.offset=mt.collider.height*PM/this.pixelsPerMeter,this.stepThresh=mt.collider.height*_M/this.pixelsPerMeter,this.colliderHeight=mt.collider.height),this.collider.type=mt.collider.type;let Gt=new E$6().fromArray(mt.collider.position),dr=new Qe$1().setFromEuler(new ir().fromArray([...mt.collider.rotation,"XYZ"]));this.collider.position.copy(Gt).multiply(this.scale),this.collider.rotation.copy(dr),this.collider.matrix.compose(Gt,dr,pN),mt.cameraXAxis!==void 0&&(this.cameraXAxis=mt.cameraXAxis,this.cameraYAxis=mt.cameraYAxis,this.minPolarAngle=mt.cameraRotXLimits[0],this.maxPolarAngle=mt.cameraRotXLimits[1],this.minAzimuthAngleRel=mt.cameraRotYLimits[0],this.maxAzimuthAngleRel=mt.cameraRotYLimits[1]),this.forwardDir=mt.forwardDirection??"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=mt.runMultiplier??2;let Mr=mt.navmesh.destinationHelperRadius*2;if(Mr>0){let zr=new Ue$1;zr.push({fi:0,data:{...Gr.defaultData("light","phong"),alpha:0},id:"layer1"}),zr.push({fi:0,data:{...Gr.defaultData("color"),color:mt.navmesh.destinationHelperColor,alpha:mt.navmesh.destinationHelperColor.a},id:"layer2"});let Fr=new Ia({layers:zr},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new Ut(g0.create({parameters:{width:Mr,height:Mr/10,hollow:.7}}),Fr),this.navMeshPathDest.material.userData.opacity0=mt.navmesh.destinationHelperColor.a}this.activate()}reset(nt=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),nt){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let st=new ir().setFromQuaternion(this.quaternion,"YXZ"),mt=st.y;this.objectRealQuat.copy(this.quaternion),st.y=0,this.quaternion.setFromEuler(st),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),st.set(0,mt,0),this.quaternion.setFromEuler(st),this.rot.setFromEuler(st),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof wr?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var nt;this.deactivate(),(nt=this.navMeshPathDest)!=null&&nt.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let nt=this.data,st=this.sharedAssets;nt.gameActions!==void 0&&(this.actions={},Xh.list.forEach(mt=>{this.actions[mt]=Kt$1({...nt,disabled:!1,type:"GameControl"},nt.gameActions[mt],this.page,st,this.controlsManager.eventManager,this.object)})),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),ur(this.actions.idle),ur(this.actions.move),ur(this.actions.run),ur(this.actions.jump)}dispatchStartEvent(nt){this.actions[nt]!==void 0&&(this.actionState[nt]||(this.actionState[nt]=!0,this.actions[nt].Transition.forEach(st=>{st.play()}),this.actions[nt].Animation.forEach(st=>{st.play(this.initialAction===!1)}),this.actions[nt].Create.forEach(st=>{st.dispatchStart()}),this.actions[nt].Audio.forEach(st=>{st.dispatchGameControl("start")}),this.actions[nt].Particles.forEach(st=>{st.dispatchGameControl("start")})))}dispatchStopEvent(nt){this.actions[nt]!==void 0&&(!this.actionState[nt]||(this.actionState[nt]=!1,this.actions[nt].Transition.forEach(st=>{st.stop(),st.object.currentState!==null&&st.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})}),this.actions[nt].Create.forEach(st=>{st.dispatchStop()}),this.actions[nt].Audio.forEach(st=>{st.dispatchGameControl("stop")}),this.actions[nt].Particles.forEach(st=>{st.dispatchGameControl("stop")})))}get colliderWorldPosition(){return Mn.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(nt,st,mt){var Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let gt=(this.isFirstFrame?16.6:nt)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let _t=gt*60,Et=!1;if(this.usePhysics&&this.collisionEnabled){let Fr=zn.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*mN),1)*(this.gravity>0?1:-1):this.velocity.y)*gt,0).divideScalar(this.pixelsPerMeter),Nr=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,Fr,(Rt=this.object.rigidBody)==null?void 0:Rt.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(Nr){this.onObject=!0,this.groundNormal.set(Nr.normal2.x,Nr.normal2.y,Nr.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(Et=!0),((Ft=Nr.collider.parent())==null?void 0:Ft.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let tn=Nr.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let rn of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(rn.rigidBody===tn&&rn.userData.isFollowingObj!==this.object.uuid){(rn.hasNonUniformScale?rn.matrixWorldRigid:rn.matrixWorld).decompose(Mn,Va,zn),this.groundVelocity.subVectors(Mn,rn.prevT),this.object.getWorldPosition(zn).add(this.collider.position).sub(Mn),this.groundYRotation=Wo.setFromQuaternion(Va).y-rn.prevR.y,$l.copy(zn).applyAxisAngle(ro,this.groundYRotation),this.groundVelocity.add($l.sub(zn)).divideScalar(gt);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*_t),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let Fr=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let Nr=Mn.subVectors(this.path[1],this.position),tn=zn.subVectors(this.path[1],this.path[0]);Nr.dot(tn)<0?this.path.shift():(this.directionXZ.x=tn.x,this.directionXZ.z=tn.z),Fr.opacity=Fr.userData.opacity0}else Fr.opacity-=.05*Fr.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**_t),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**_t),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**_t)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let At=nJ.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let Fr=zn.copy(At);Fr.y=0,At.set(0,At.y,Fr.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none"&&this.isFirstPerson===!1)if(this.orientWith==="camera"&&this.path.length<=1){let Fr=Mn;this.camera.getWorldDirection(Fr);let Nr=$l.copy(ro).multiplyScalar(Fr.dot(ro));Fr.sub(Nr);let tn=zn.copy(this.directionXZ);tn.x*=-1,this.rot.y=Fr.angleTo(tn)*(Fr.cross(tn).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(Wo.setFromVector3(this.rot),this.moveMode==="walk"&&(Wo.x=0),At.applyEuler(Wo),Et&&(Va.setFromUnitVectors(ro,this.groundNormal),At.applyQuaternion(Va)),mt){let Fr=Wo.set(0,this.vrEulerYOffset*gN,0);mt.applyEuler(Fr),At.x+=mt.x,At.z+=mt.z,this.nonColliderPosOffset.elements[13]+=mt.y*gt}if(this.usePhysics===!0){let Fr=zn;this.pushedVelocity.set(0,0,0);for(let Nr of this.sharedGameControlGlobals.entitiesWithTransformAnim){let tn=$l.setFromMatrixPosition(Nr.matrixWorld).sub(Nr.prevT).divideScalar(gt).divideScalar(this.pixelsPerMeter),rn=Nr.rigidBody.collider(0).castCollider(tn,this.object.rigidBody.collider(0),Mn.copy(At).divideScalar(this.pixelsPerMeter),gt,!1);tn.multiplyScalar(this.pixelsPerMeter);let Tn=yt.is(Nr)?Nr:Nr.object;if(rn!==null&&this.lastHitObj!==Tn){let $n;Nr instanceof Br&&($n=Nr);let un=this.sharedGameControlGlobals.entityToCollisionEvents[Tn.uuid];if(un)for(let es of un)es.data.target==="character"&&(es.dispatch($n),Tn.dispatchEvent(vb));this.lastHitObj=Tn}if(rn!==null){this.pushedVelocity.copy(tn),Fr.copy(rn.normal1).applyQuaternion(Nr.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let Nr=Fr.dot(At);Nr<0&&At.addScaledVector(Fr,-Nr),At.add(this.pushedVelocity)}else At.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(gt),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**_t):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**_t),this.euler.x+=this.rotVelocity.x*gt,this.euler.y+=this.rotVelocity.y*gt+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*gt),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(ro,this.euler.y-this.euler0.y);let Fr=zn.copy(this.objectToCamXZ).normalize(),Nr=$l.copy(At).multiplyScalar(gt);Nr.y=0;let tn=Nr.sub(Mn.copy(Fr).multiplyScalar(Nr.dot(Fr))).cross(Fr).y;this.euler.y-=Math.atan2(tn,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*gt+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=we$1.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=we$1.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=we$1.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(st?(Wo.copy(st),Wo.y=0):(Wo.copy(this.euler),Wo.y=0),this.nonColliderRotOffset.makeRotationFromEuler(Wo)),st&&(this.moveMode==="walk"?(this.rot.y=st.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(st),this.rot.y+=this.vrEulerYOffset*gN),to.setFromAxisAngle(oJ,this.rot.x),Va.setFromAxisAngle(ro,this.rot.y),Va.multiply(to),to.setFromAxisAngle(aJ,this.rot.z),Va.multiply(to),this.quaternion.copy(Va),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let Fr=zn.copy(At).multiplyScalar(gt/this.pixelsPerMeter),Nr=null;this.didHit=!1;let tn=new E$6;for(let rn=0;rn<5;rn++){let Tn=Fr.length(),$n=$l.copy(Fr).normalize();if(Nr=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(tn),this.colliderWorldQuat,$n,(Nt=this.object.rigidBody)==null?void 0:Nt.collider(0).shape,Tn,!1,24,void 0,void 0,this.object.rigidBody),Nr!==null){this.didHit=!0;let un=this.sharedGameControlGlobals.colliderToEntity.get(Nr.collider.handle);if(un!==this.lastHitObj&&rn===0){this.lastHitObj=un;let Ko=this.sharedGameControlGlobals.entityToCollisionEvents[un==null?void 0:un.uuid];if(Ko){for(let ds of Ko)if(ds.data.target==="character"){let Il=((Bt=this.sharedGameControlGlobals.rapierWorld)==null?void 0:Bt.getCollider(Nr.collider.handle))._parent,ru;if(un.cloner){for(let uu of un.cloner.children)if(uu.rigidBody===Il){ru=uu;break}}ds.dispatch(ru),un.dispatchEvent(vb)}}}let es=hN.set(Nr.normal2.x,Nr.normal2.y,Nr.normal2.z).applyQuaternion(this.colliderWorldQuat),kn=dN.copy($n).multiplyScalar(Nr.toi).dot(es),ts=Nr.toi;if(ts===0&&(this.position.y+=this.offset*this.pixelsPerMeter),kn>this.offset&&(ts=Nr.toi*(kn-this.offset)/kn,tn.addScaledVector($n,ts)),Fr.copy($n).multiplyScalar(Tn-ts),Math.acos(-es.y)>this.slopeThresh){let Ko=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(tn),ds=$l.copy(Nr.witness2).applyQuaternion(this.colliderWorldQuat);ds.y=0;let Il=Ko.add(ds);Il.y+=this.stepThresh;let ru=this.sharedGameControlGlobals.rapierWorld.castShape(Il,this.colliderWorldQuat,Fr,(Gt=this.object.rigidBody)==null?void 0:Gt.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);ru!==null&&ru.toi===0&&(es.y=0,es.normalize())}Fr.addScaledVector(es,-Fr.dot(es))}else{rn===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),tn.add(Fr);break}}this.position.addScaledVector(tn,this.pixelsPerMeter),(dr=this.object.rigidBody)==null||dr.setTranslation(Mn.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(Mr=this.object.rigidBody)==null||Mr.setRotation(to.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let Fr=this.onObject?1:5,Nr=At.multiplyScalar(gt/Fr);for(let tn=0;tn<Fr;tn++)this.position.add(Nr),this.collisionAdjustment(gt/Fr)}else this.position.addScaledVector(At,gt);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let Fr=this.objectToTarget.add(this.position),Nr=this.targetToCamera.add(Fr);DM.lookAt(Nr,Fr,ro).setPosition(Nr),DM.decompose(this.targetPos,this.targetQuat,Mn),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**_t),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**_t),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=we$1.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=we$1.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(fJ),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&(this.navMeshPathDest===null||this.navMeshPathDest.material.opacity<-.04*((zr=(Tr=this.navMeshPathDest)==null?void 0:Tr.material)==null?void 0:zr.userData.opacity0))?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(dJ),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let nt=to.setFromAxisAngle(ro,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?we$1.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(nt);let st;this.cameraXAxis==="Limit"?st=we$1.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):st=we$1.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let mt=Mn.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&mt.applyQuaternion(nt);let gt=Va.setFromAxisAngle(mt,st);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(nt),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(gt)}groundTiltAdjustment(nt){ro.angleTo(nt)*180/Math.PI<15||ro.angleTo(nt)*180/Math.PI>85?to.identity():to.setFromUnitVectors(ro,nt),this.groundTilt.slerp(to,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(nt){var _t;let st=dN.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let mt=DM.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(Mn,to,zn).compose(Mn,to,pN);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(Et=>{if(Et===this.object||Et.isDescendantOf(this.object))return;Ms.makeEmpty(),Et.updateMatrixWorldSVD();let At=Et.matrixWorldRigid,Rt=fN.copy(At).invert(),Ft=sJ.copy(fN).multiply(mt);Hi.copy(this.collider.segment),Hi.start.applyMatrix4(Ft),Hi.end.applyMatrix4(Ft);let Nt=hN.copy(this.position).applyMatrix4(Rt);Ms.expandByPoint(Hi.start),Ms.expandByPoint(Hi.end),Ms.min.addScalar(-this.collider.radius),Ms.max.addScalar(this.collider.radius),Et.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(Bt){return Bt.distanceToPoint(Hi.end)},intersectsBounds:Bt=>Bt.intersectsBox(Ms),intersectsTriangle:Bt=>{let Gt=Mn,dr=zn,Mr=Bt.closestPointToSegment(Hi,Gt,dr);if(Mr<this.collider.radius){let Tr=this.collider.radius-Mr,zr=dr.sub(Gt).normalize(),Fr=$l.copy(Nt);Fr.addScaledVector(zr,Tr);let Nr=Fr.applyMatrix4(At).sub(this.position);st.add(Nr),Hi.start.addScaledVector(zr,Tr),Hi.end.addScaledVector(zr,Tr)}}})}),Ms.makeEmpty(),Hi.copy(this.collider.segment),Hi.start.applyMatrix4(mt),Hi.end.applyMatrix4(mt),Ms.expandByPoint(Hi.start),Ms.expandByPoint(Hi.end),Ms.min.addScalar(-this.collider.radius),Ms.max.addScalar(this.collider.radius),(_t=this.sharedGameControlGlobals.staticMeshBVH)==null||_t.shapecast({traverseBoundsOrder(Et){return Et.distanceToPoint(Hi.end)},intersectsBounds:Et=>Et.intersectsBox(Ms),intersectsTriangle:Et=>{let At=Mn,Rt=zn,Ft=Et.closestPointToSegment(Hi,At,Rt);if(Ft<this.collider.radius){let Nt=this.collider.radius-Ft,Bt=Rt.sub(At).normalize();this.alignToGround&&this.groundTiltAdjustment(Bt),st.addScaledVector(Bt,Nt),Hi.start.addScaledVector(Bt,Nt),Hi.end.addScaledVector(Bt,Nt)}}}),this.onObject=Math.abs(st.y)>Math.abs(nt*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let gt=Math.max(0,st.length()-1e-5);st.normalize().multiplyScalar(gt),this.position.add(st)}},og=yb;og.isLocked=!1;var yN=Jo(iA());function io(nt,st){let mt=new _e$1;if(st){let Et=st.elements,At=Et[0]**2+Et[1]**2+Et[2]**2,Rt=Et[4]**2+Et[5]**2+Et[6]**2,Ft=Et[8]**2+Et[9]**2+Et[10]**2,Nt=Et[0]**2+Et[4]**2+Et[8]**2,Bt=Et[1]**2+Et[5]**2+Et[9]**2,Gt=Et[2]**2+Et[6]**2+Et[10]**2,dr=1e-8;if(At<dr||Rt<dr||Ft<dr||Nt<dr||Bt<dr||Gt<dr)return mt.setAttribute("position",new Me$1([],3)),mt.setIndex([]),mt}if(!nt.getAttribute("position"))return mt.setAttribute("position",new Me$1([],3)),mt.setIndex([]),mt;let{positions:gt,triIndices:_t}=Uc(nt.getAttribute("position"),nt.getIndex());return mt.setAttribute("position",new Me$1(gt,3)),mt.setIndex(_t),st&&mt.applyMatrix4(st),mt}var pJ=new ue$1,mJ=new ue$1,qo=[[0,0,0],[0,0,0],[0,0,0]];function OM(nt){let st=nt.elements;qo[0][0]=st[0],qo[0][1]=st[4],qo[0][2]=st[8],qo[1][0]=st[1],qo[1][1]=st[5],qo[1][2]=st[9],qo[2][0]=st[2],qo[2][1]=st[6],qo[2][2]=st[10];let{u:mt,v:gt}=(0,yN.SVD)(qo),_t=pJ.set(mt[0][0],mt[0][1],mt[0][2],0,mt[1][0],mt[1][1],mt[1][2],0,mt[2][0],mt[2][1],mt[2][2],0,0,0,0,1),Et=mJ.set(gt[0][0],gt[0][1],gt[0][2],0,gt[1][0],gt[1][1],gt[1][2],0,gt[2][0],gt[2][1],gt[2][2],0,0,0,0,1);return _t.multiply(Et.transpose())}var xb=class extends Qu{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(nt,st){st.isOrthographicCamera?(this.ray.origin.set(nt.x,nt.y,-1).unproject(st),this.ray.direction.set(0,0,-1).transformDirection(st.matrixWorld),this.camera=st):st.isPerspectiveCamera?(this.ray.origin.set(nt.x,nt.y,-1).unproject(st),this.ray.direction.set(nt.x,nt.y,.5).unproject(st).sub(this.ray.origin).normalize(),this.camera=st):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(nt,st=!0,mt=[]){return nt.forEach(gt=>{gt.visible&&this.intersectObject(gt,st,mt)}),mt}createRaycastLineHelper(){let nt=new ss({color:65280,linewidth:10}),st=new E$6(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),mt=new E$6(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),gt=this.camera.far-this.camera.near,_t=new E$6().addVectors(st,mt.multiplyScalar(gt)),Et=new _e$1;return Et.setFromPoints([st,_t]),new mc(Et,nt)}},vN=nt=>nt instanceof ws||nt instanceof $s;function gJ(nt,st){return nt.distance-st.distance}function xN(nt,st,mt){if(!(!Do(st)||!st.visible)){cn(st)&&st.raycast(nt,mt);for(let gt of st.children)xN(nt,gt,mt)}}function Lf(nt,st,mt,gt=!1){if(!gt&&!mt.some(Et=>Bf(nt,Et)!==void 0))return[];let _t=[];return st.children.forEach(Et=>xN(nt,Et,_t)),_t.sort(gJ),_t}function ag(nt){let st=[];if(nt.length){let mt=nt[0].object;Do(mt)&&st.push(mt);let gt=mt.parent;for(;gt;)vN(gt)&&st.push(gt),gt=gt.parent}return st}function no$1(nt,st,mt,gt){let _t=nt.frame;if(_t){let Et=st[0]*_t.width,At=(1-st[1])*_t.height;for(let Rt of mt){let Ft=Rt===_t.uuid?_t:_t.find(Rt);if(Ft!=null&&Ft.intersects(Et,At))return gt(Ft),!0}}return!1}function Bf(nt,st){if(cn(st)){if(st.visible){let mt=[];return st.raycast(nt,mt),mt.length?mt[0]:void 0}}else if(vN(st))return bN(nt,st)}function bN(nt,st){if(!(!Do(st)||!st.visible)){if(cn(st)){let mt=[];if(st.raycast(nt,mt),mt.length)return mt[0]}for(let mt of st.children){let gt=bN(nt,mt);if(gt)return gt}}}function yJ(nt,st,mt){return{x:(nt-(mt.left+window.scrollX))/mt.width*2-1,y:-((st-(mt.top+window.scrollY))/mt.height)*2+1}}function vJ(nt,st,mt){return{x:(nt-(mt.left+window.scrollX))/mt.width,y:1-(st-(mt.top+window.scrollY))/mt.height}}var bb=class{constructor(nt,st,mt,gt,_t,Et,At,Rt){this.renderer=nt,this.publish=st,this.scene=mt,this.getCamera=gt,this.sharedAssets=_t,this.requestRender=Et,this.isExport=At,this.frame=Rt,this.raycaster=new xb,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents=st.mouseEventTarget==="window",this.domElement=nt.domElement,this.eventElement=this._useWindowEvents?window:nt.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(nt){this._useWindowEvents=nt,this.eventElement=nt?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(nt){this._domRect=nt}get domRect(){return this._domRect}updateRaycaster(nt){var gt;let{pageX:st,pageY:mt}=((gt=nt.touches)==null?void 0:gt.length)>0?nt.touches[0]:nt;this.pointerWorld=yJ(st,mt,this._domRect),this.pointerScreen=vJ(st,mt,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},hr=class{constructor(nt){this.eventContext=nt,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},RM=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],SN=nt=>{var st;return(st=RM.find(([mt,gt])=>gt===nt))==null?void 0:st[0]},Yo=nt=>{var st;return(st=RM.find(([mt])=>mt===nt))==null?void 0:st[1]},xJ=(nt,st)=>{let mt=SN(nt);if(mt){let gt=new CustomEvent(mt,{bubbles:!0});return Object.defineProperty(gt,"target",{writable:!1,value:st}),gt}},Sb=class extends hr{constructor(){super(...arguments),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=nt=>{var gt;if(!nt.eventName||!nt.target||nt.eventName==="Scroll")return;let st=(gt=this.splineEvents[SN(nt.eventName)])==null?void 0:gt[nt.target.uuid];if(!st)return;nt.eventName==="Scroll"&&nt.deltaY!==void 0&&Object.assign(st,{deltaY:nt.deltaY});let{domElement:mt}=this.eventContext;mt.dispatchEvent(st)}}connect(){let{page:nt}=this.eventContext;nt.traverseEntity(st=>{var mt,gt;if((mt=st.data)!=null&&mt.events.length){for(let[_t,Et]of RM)if(st.data.events.some(At=>At.data.type===Et&&!At.data.disabled)){this.objectsPerEvents.has(_t)?(gt=this.objectsPerEvents.get(_t))==null||gt.push(st):this.objectsPerEvents.set(_t,[st]);let At={id:st.uuid,name:st.name},Rt=xJ(Et,At),Ft=this.splineEvents[_t];Ft?Ft[st.uuid]=Rt:this.splineEvents[_t]={[st.uuid]:Rt}}}}),this.objectsPerEvents.forEach(st=>{st.forEach(mt=>{mt.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(nt=>{nt.forEach(st=>{st.removeEventListener("beginEvent",this.onBeginEvent)})})}},LM=class{constructor(nt,st,mt,gt,_t,Et){if(this.id=nt,this.data=st,this.object=mt,this.entered=!1,(st.type==="KeyDown"||st.type==="KeyUp"||st.type==="KeyPress")&&!st.key)throw new Error("Missing property");this.actions=Kt$1(st,st.actions,gt,_t,Et,mt)}disconnect(){ur(this.actions)}dispatchHeld(nt){this.actions.Create.forEach(st=>{nt&&st.dispatchThrottled.cancel(),st.dispatchThrottled()})}dispatch(nt=!1){this.actions.Transition.forEach(st=>{st.object.currentTransitionEvent!==this&&(st.object.currentTransitionEvent=this,st.init())}),this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(st=>st.playFromCurrent()),this.actions.Animation.forEach(st=>st.playFromCurrent()),this.actions.SwitchCamera.forEach(st=>st.playFromCurrent()),this.actions.Create.forEach(st=>st.dispatchStart())):(this.actions.Transition.some(st=>st.playing&&st.data.runMode!=="Toggle")||this.actions.Transition.forEach(st=>{st.data.runMode==="Toggle"?st.toggle():st.play()}),this.actions.SwitchCamera.some(st=>st.playing&&st.data.runMode!=="Toggle")||this.actions.SwitchCamera.forEach(st=>{st.data.runMode==="Toggle"?st.toggle():st.play()}),this.actions.Animation.forEach(st=>{st.data.runMode==="Toggle"?st.toggle():st.play()})),this.actions.Link.forEach(st=>{st.dispatch()}),this.actions.SceneTransition.forEach(st=>{st.dispatch()}),nt===!1&&this.actions.Create.forEach(st=>{st.dispatch()}),this.actions.Destroy.forEach(st=>{st.dispatch()}),this.actions.Reset.forEach(st=>{st.dispatch()}),this.actions.Audio.forEach(st=>{st.dispatchBasic()}),this.actions.Video.forEach(st=>{st.dispatchBasic()}),this.actions.Particles.forEach(st=>{st.dispatchBasic()}),this.actions.SetVariable.forEach(st=>st.checkConditions()),this.actions.SetVariable.forEach(st=>st.dispatch()),this.actions.DynamicVariablePlay.forEach(st=>st.dispatch()),this.actions.ClearLocalStorage.forEach(st=>st.dispatch()),this.actions.UserAPI.forEach(st=>st.dispatch())}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(nt=>nt.reverseFromCurrent()),this.actions.Particles.forEach(nt=>nt.reverseFromCurrent()),this.actions.Animation.forEach(nt=>nt.reverseFromCurrent()),this.actions.SwitchCamera.forEach(nt=>nt.reverseFromCurrent()),this.actions.Create.forEach(nt=>nt.dispatchStop()))}dispatchUserEvent(nt){this.actions.Transition.forEach(st=>{st.object.currentTransitionEvent!==this&&(st.object.currentTransitionEvent=this,st.init())}),nt?(this.actions.Transition.forEach(st=>st.reverseFromCurrent()),this.actions.Animation.forEach(st=>st.reverseFromCurrent()),this.actions.SwitchCamera.forEach(st=>st.reverseFromCurrent())):(this.actions.Transition.forEach(st=>st.playFromCurrent()),this.actions.Animation.forEach(st=>st.playFromCurrent()),this.actions.SwitchCamera.forEach(st=>st.playFromCurrent())),this.actions.Link.forEach(st=>{st.dispatch()}),this.actions.SceneTransition.forEach(st=>{st.dispatch()}),this.actions.Create.forEach(st=>{st.dispatch()}),this.actions.Destroy.forEach(st=>{st.dispatch()}),this.actions.Reset.forEach(st=>{st.dispatch()}),this.actions.Audio.forEach(st=>{st.dispatchBasic()}),this.actions.Video.forEach(st=>{st.dispatchBasic()}),this.actions.Particles.forEach(st=>{st.dispatchBasic()}),this.actions.SetVariable.forEach(st=>st.checkConditions()),this.actions.SetVariable.forEach(st=>st.dispatch()),this.actions.DynamicVariablePlay.forEach(st=>st.dispatch()),this.actions.ClearLocalStorage.forEach(st=>st.dispatch()),this.actions.UserAPI.forEach(st=>st.dispatch())}},wb=class extends hr{constructor(nt,st,mt){super(nt),this.eventManager=st,this.useForRaycastProperty=mt,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=gt=>{if(this.useForRaycastProperty===!0&&this.sceneInterects===null){this.eventContext.updateRaycaster(gt);let{raycaster:_t,page:Et}=this.eventContext,At=Lf(_t,Et,[],!0);this.sceneInterects=At,At.length&&(this.eventContext.sharedAssets.raycastProperty={x:At[0].point.x,y:At[0].point.y,z:At[0].point.z,objX:At[0].object.matrixWorld.elements[12],objY:At[0].object.matrixWorld.elements[13],objZ:At[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=gt=>{(gt.target===this.eventContext.domElement||gt.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(_t=>{(_t.data.type==="MouseDown"||_t.data.type==="MousePress")&&(this.onCanvasRaycast(gt),_t.dispatch())})},this.onCanvasMouseUp=gt=>{(gt.target===this.eventContext.domElement||gt.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(_t=>{_t.data.type==="MouseUp"?(this.onCanvasRaycast(gt),_t.dispatch()):_t.data.type==="MousePress"&&_t.dispatchRelease()})},this.onMouseDown=gt=>{Je$1.length>1||(this.eventContext.updateRaycaster(gt),this.handleMouseEvent("MouseDown"))},this.onMouseUp=gt=>{Je$1.length>1||(this.eventContext.updateRaycaster(gt),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=gt=>{Je$1.length>1||(this.eventContext.updateRaycaster(gt),this.handleMousePressEvent())},this.onMousePressRelease=gt=>{Je$1.length>1||(this.eventContext.updateRaycaster(gt),this.handleMousePressEvent(!0))},this.onKeyDown=gt=>{this.heldKeys[gt.key]||(this.handleKeyEvent(gt,"KeyDown"),this.handleKeyEventHeld(gt,"KeyDown",!0)),this.heldKeys[gt.key]=!0},this.onKeyUp=gt=>{this.handleKeyEvent(gt,"KeyUp"),this.handleKeyEventHeld(gt,"KeyUp",!0)},this.onKeyPressDown=gt=>{this.heldKeysPress[gt.key]?this.handleKeyEventHeld(gt,"KeyPress"):(this.handleKeyEvent(gt,"KeyPress"),this.handleKeyEventHeld(gt,"KeyPress",!0)),this.heldKeysPress[gt.key]=!0},this.onKeyPressUp=gt=>{this.handleKeyEvent(gt,"KeyPress",!0)},this.releaseHeldKey=gt=>{delete this.heldKeys[gt.key]},this.releaseHeldKeyPress=gt=>{delete this.heldKeysPress[gt.key]},this._onUserEvent=({eventName:gt,target:_t,reverse:Et})=>{var Rt,Ft,Nt,Bt;if(!gt||!_t)return;let At=Yo(gt);At&&(At==="MouseDown"||At==="MouseUp"||At==="MousePress"?(_t.dispatchEvent({type:"beginEvent",eventName:At}),(Ft=(Rt=this.eventsPerObjects[At])==null?void 0:Rt[_t.uuid])==null||Ft.forEach(Gt=>{Gt.dispatchUserEvent(Et)})):(At==="KeyDown"||At==="KeyUp"||At==="KeyPress")&&(_t.dispatchEvent({type:"beginEvent",eventName:At}),(Bt=(Nt=this.eventsPerObjects[At])==null?void 0:Nt[_t.uuid])==null||Bt.forEach(Gt=>{Gt.dispatchUserEvent()})))}}connect(){var _t,Et,At,Rt,Ft,Nt;let{page:nt,sharedAssets:st,domElement:mt}=this.eventContext,gt=(Bt,Gt)=>{var Mr,Tr;if(!((Mr=Bt.data)!=null&&Mr.events.length))return;let dr=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let zr of dr){let Fr=this.eventsPerObjects[zr];Bt.data.events.filter(({data:Nr})=>Nr.type===zr&&Nr.disabled!==!0).forEach(({id:Nr,data:tn})=>{try{let rn=new LM(Nr,tn,Bt,nt,st,this.eventManager);rn.actions.Video.length&&(this.hasVideoAction=!0),(tn.type==="MouseDown"||tn.type==="MouseUp"||tn.type==="MousePress")&&(tn.mode==="Canvas"||tn.mode==="Window")?this.canvasMouseEvents.push(rn):Fr[Bt.uuid]?Fr[Bt.uuid].some(Tn=>Tn.id===rn.id)||Fr[Bt.uuid].push(rn):Fr[Bt.uuid]=[rn]}catch{}}),(Tr=Fr[Bt.uuid])!=null&&Tr.length&&this.objectsPerTypes[zr].push(Bt instanceof tr&&(zr==="MouseDown"||zr==="MouseUp"||zr==="MousePress")?Gt:Bt)}};nt.traverseEntity(Bt=>{var Gt;(Bt instanceof Er||Bt instanceof cr)&&((Gt=Bt.frame)==null||Gt.traverse(dr=>{gt(dr,Bt)})),gt(Bt)}),this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),mt.addEventListener("pointerdown",this.onCanvasMouseDown),mt.addEventListener("pointerup",this.onCanvasMouseUp),((_t=this.objectsPerTypes.MouseDown)!=null&&_t.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),mt.addEventListener("pointerdown",this.onMouseDown)),(Et=this.objectsPerTypes.MouseUp)!=null&&Et.length&&(this.domEventsNeeded.add("pointerup"),mt.addEventListener("pointerup",this.onMouseUp)),(At=this.objectsPerTypes.MousePress)!=null&&At.length&&(this.domEventsNeeded.add("pointerdown"),mt.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),mt.addEventListener("pointerup",this.onMousePressRelease)),(Rt=this.objectsPerTypes.KeyDown)!=null&&Rt.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(Ft=this.objectsPerTypes.KeyUp)!=null&&Ft.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(Nt=this.objectsPerTypes.KeyPress)!=null&&Nt.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([Bt,Gt])=>{Gt.forEach(dr=>{dr.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:nt}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},nt.removeEventListener("pointerdown",this.onCanvasMouseDown),nt.removeEventListener("pointerup",this.onCanvasMouseUp),nt.removeEventListener("pointerdown",this.onMouseDown),nt.removeEventListener("pointerdown",this.onMousePressDown),nt.removeEventListener("pointerup",this.onMouseUp),nt.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(st=>{Object.values(st).forEach(mt=>{mt.forEach(gt=>{gt.disconnect()})})}),this.canvasMouseEvents.forEach(st=>{st.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([st,mt])=>{mt.forEach(gt=>{gt.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(nt){var Rt,Ft,Nt,Bt;let{stopRaycast:st,raycaster:mt,page:gt,pointerScreen:_t}=this.eventContext,Et=this.objectsPerTypes[nt],At=Et.filter(Gt=>!(Gt instanceof tr));if(!(!Et.length&&!this.useForRaycastProperty)&&!(gt.uiCanvas&&no$1(gt,[_t.x,_t.y],Object.keys(this.eventsPerObjects[nt]),Gt=>{this.handleObjectMouseEventDispatch(Gt,nt)}))){if(st||this.useForRaycastProperty){let Gt;if(this.sceneInterects===null?Gt=Lf(mt,gt,At,this.useForRaycastProperty):(Gt=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&Gt.length&&(this.eventContext.sharedAssets.raycastProperty={x:Gt[0].point.x,y:Gt[0].point.y,z:Gt[0].point.z,objX:Gt[0].object.matrixWorld.elements[12],objY:Gt[0].object.matrixWorld.elements[13],objZ:Gt[0].object.matrixWorld.elements[14]}),st){let dr=[((Ft=(Rt=Gt[0])==null?void 0:Rt.uv)==null?void 0:Ft.x)??0,((Bt=(Nt=Gt[0])==null?void 0:Nt.uv)==null?void 0:Bt.y)??0];ag(Gt).forEach(Mr=>{Mr instanceof Er&&no$1(Mr,dr,Object.keys(this.eventsPerObjects[nt]),Tr=>{this.handleObjectMouseEventDispatch(Tr,nt)}),this.eventsPerObjects[nt][Mr.uuid]&&this.handleObjectMouseEventDispatch(Mr,nt)})}}st||At.forEach(Gt=>{var Mr,Tr;let dr=Bf(mt,Gt);dr&&(this.handleObjectMouseEventDispatch(Gt,nt),Gt instanceof Er&&no$1(Gt,[((Mr=dr==null?void 0:dr.uv)==null?void 0:Mr.x)??0,((Tr=dr==null?void 0:dr.uv)==null?void 0:Tr.y)??0],Object.keys(this.eventsPerObjects[nt]),zr=>{this.handleObjectMouseEventDispatch(zr,nt)}))})}}handleMousePressEvent(nt=!1){let st="MousePress",mt=this.objectsPerTypes[st],gt=mt.filter(Et=>!(Et instanceof tr)),_t=[];if(mt.length){if(!nt){let{stopRaycast:Et,raycaster:At,page:Rt,pointerScreen:Ft}=this.eventContext,Nt=!1;if(Rt.uiCanvas&&(Nt=no$1(Rt,[Ft.x,Ft.y],Object.keys(this.eventsPerObjects[st]),Bt=>{_t.push(Bt)})),Et&&!Nt){let Bt=Lf(At,Rt,gt);_t=ag(Bt),Bt.forEach(Gt=>{var dr,Mr;Gt.object instanceof Er&&no$1(Gt.object,[((dr=Gt==null?void 0:Gt.uv)==null?void 0:dr.x)??0,((Mr=Gt==null?void 0:Gt.uv)==null?void 0:Mr.y)??0],Object.keys(this.eventsPerObjects[st]),Tr=>{_t.push(Tr)})})}else gt.forEach(Bt=>{var dr,Mr;let Gt=Bf(At,Bt);Gt&&(_t.push(Bt),Bt instanceof Er&&no$1(Bt,[((dr=Gt==null?void 0:Gt.uv)==null?void 0:dr.x)??0,((Mr=Gt==null?void 0:Gt.uv)==null?void 0:Mr.y)??0],Object.keys(this.eventsPerObjects[st]),Tr=>{_t.push(Tr)}))})}this._prevObjects.length&&this._prevObjects.forEach(Et=>{_t.includes(Et)||this.handleObjectMouseEventDispatchRelease(Et,st)}),_t.length&&_t.forEach(Et=>{this.handleObjectMouseEventDispatch(Et,st)}),this._prevObjects=_t}}handleObjectMouseEventDispatch(nt,st){var mt,gt;nt.dispatchEvent({type:"beginEvent",eventName:st}),(gt=(mt=this.eventsPerObjects[st])==null?void 0:mt[nt.uuid])==null||gt.forEach(_t=>{_t.dispatch()})}handleObjectMouseEventDispatchRelease(nt,st){var mt,gt;nt.dispatchEvent({type:"beginEvent",eventName:st}),(gt=(mt=this.eventsPerObjects[st])==null?void 0:mt[nt.uuid])==null||gt.forEach(_t=>{_t.dispatchRelease()})}handleKeyEvent(nt,st,mt=!1){this.objectsPerTypes[st].forEach(gt=>{let _t=this.eventsPerObjects[st][gt.uuid];_t.some(({data:Et})=>"key"in Et&&Et.key===nt.key)&&gt.dispatchEvent({type:"beginEvent",eventName:st}),_t.forEach(Et=>{"key"in Et.data&&Et.data.key===nt.key&&(mt?Et.dispatchRelease():Et.dispatch(!0))})})}handleKeyEventHeld(nt,st,mt=!1){this.objectsPerTypes[st].forEach(gt=>{this.eventsPerObjects[st][gt.uuid].forEach(_t=>{"key"in _t.data&&_t.data.key===nt.key&&_t.dispatchHeld(mt)})})}},bJ=new E$6,SJ=new E$6,Ab=class{constructor(nt,st,mt,gt,_t){this.actionsIn=Kt$1(nt,nt.inActions,mt,gt,_t,st),this.actionsOut=Kt$1(nt,nt.outActions,mt,gt,_t,st)}disconnect(){ur(this.actionsIn),ur(this.actionsOut)}},BM=class extends Ab{constructor(nt,st,mt,gt,_t,Et){super(st,mt,gt,_t,Et),this.id=nt,this.data=st,this.object=mt,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let dr of this.objects)if(!dr.visible)return;let Nt=bJ.setFromMatrixPosition(this.objects[0].matrixWorld),Bt=SJ.setFromMatrixPosition(this.objects[1].matrixWorld),Gt=Nt.distanceTo(Bt)<=this.distance?"in":"out";if(this.stage!==Gt){this.stage=Gt;let dr=Gt==="in"?this.actionsIn:this.actionsOut;dr.Audio.forEach(Mr=>Mr.dispatchConditional()),dr.Particles.forEach(Mr=>Mr.dispatchConditional()),dr.Video.forEach(Mr=>Mr.dispatchConditional()),dr.Link.forEach(Mr=>Mr.dispatch()),dr.Create.forEach(Mr=>Mr.dispatch()),dr.Destroy.forEach(Mr=>Mr.dispatch()),dr.Reset.forEach(Mr=>Mr.dispatch()),dr.Transition.forEach(Mr=>{Mr.object.currentTransitionEvent!==this&&(Mr.object.currentTransitionEvent=this),Mr.init()}),dr.Transition.forEach(Mr=>Mr.play()),dr.Animation.forEach(Mr=>Mr.play()),dr.SwitchCamera.forEach(Mr=>Mr.play()),dr.SceneTransition.forEach(Mr=>Mr.dispatch()),dr.SetVariable.forEach(Mr=>Mr.checkConditions()),dr.SetVariable.forEach(Mr=>Mr.dispatch()),dr.DynamicVariablePlay.forEach(Mr=>Mr.dispatch()),dr.ClearLocalStorage.forEach(Mr=>Mr.dispatch()),dr.UserAPI.forEach(Mr=>Mr.dispatch())}};let{distance:At,fromObject:Rt,toObject:Ft}=st.condition;this.distance=At;for(let Nt of[Rt,Ft]){if(!Nt)throw new Error("Missing property");let Bt=gt.find(Nt);if(!Bt)throw new Error("Missing property");this.objects.push(Bt)}}connect(){window.setTimeout(()=>{this.objects.forEach(nt=>{nt.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}),this.onUpdateMatrixWorld()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(nt=>{nt.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})}},NM=class extends Ab{constructor(nt,st,mt,gt,_t,Et){var Ft;super(st,mt,gt,_t,Et),this.id=nt,this.data=st,this.object=mt,this.onBegin=({target:Nt,state:Bt})=>{this.toState!==Bt&&(this.actionsOut.Audio.forEach(Gt=>Gt.dispatchConditional()),this.actionsOut.Particles.forEach(Gt=>Gt.dispatchConditional()),this.actionsOut.Video.forEach(Gt=>Gt.dispatchConditional()),this.actionsOut.Link.forEach(Gt=>Gt.dispatch()),this.actionsOut.Create.forEach(Gt=>Gt.dispatch()),this.actionsOut.Destroy.forEach(Gt=>Gt.dispatch()),this.actionsOut.Reset.forEach(Gt=>Gt.dispatch()),this.actionsIn.Transition.forEach(Gt=>Gt.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(Gt=>Gt.play()),this.actionsOut.Animation.forEach(Gt=>Gt.play()),this.actionsIn.SwitchCamera.forEach(Gt=>Gt.pause()),this.actionsOut.SwitchCamera.forEach(Gt=>Gt.play()),this.actionsOut.SceneTransition.forEach(Gt=>Gt.dispatch()),this.actionsOut.SetVariable.forEach(Gt=>Gt.checkConditions()),this.actionsOut.SetVariable.forEach(Gt=>Gt.dispatch()),this.actionsOut.DynamicVariablePlay.forEach(Gt=>Gt.dispatch()),this.actionsOut.ClearLocalStorage.forEach(Gt=>Gt.dispatch()),this.actionsOut.UserAPI.forEach(Gt=>Gt.dispatch()))},this.onComplete=({target:Nt,state:Bt})=>{this.toState===Bt&&(this.actionsIn.Audio.forEach(Gt=>Gt.dispatchConditional()),this.actionsIn.Particles.forEach(Gt=>Gt.dispatchConditional()),this.actionsIn.Video.forEach(Gt=>Gt.dispatchConditional()),this.actionsIn.Link.forEach(Gt=>Gt.dispatch()),this.actionsIn.Create.forEach(Gt=>Gt.dispatch()),this.actionsIn.Destroy.forEach(Gt=>Gt.dispatch()),this.actionsIn.Reset.forEach(Gt=>Gt.dispatch()),this.actionsOut.Transition.forEach(Gt=>Gt.pause()),this.actionsOut.Transition.forEach(Gt=>Gt.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(Gt=>Gt.play()),this.actionsIn.Animation.forEach(Gt=>Gt.play()),this.actionsOut.SwitchCamera.forEach(Gt=>Gt.pause()),this.actionsIn.SwitchCamera.forEach(Gt=>Gt.play()),this.actionsIn.SceneTransition.forEach(Gt=>Gt.dispatch()),this.actionsIn.SetVariable.forEach(Gt=>Gt.checkConditions()),this.actionsIn.SetVariable.forEach(Gt=>Gt.dispatch()),this.actionsIn.DynamicVariablePlay.forEach(Gt=>Gt.dispatch()),this.actionsOut.ClearLocalStorage.forEach(Gt=>Gt.dispatch()),this.actionsOut.UserAPI.forEach(Gt=>Gt.dispatch()))};let{condition:At}=st;if(!At.object)throw new Error("Missing property");let Rt=gt.find(At.object)??gt.scene.find2D(At.object);if(!Rt)throw new Error("Missing property");if(this.toObject=Rt,At.state&&!((Ft=this.toObject.states)!=null&&Ft[At.state]))throw new Error("Missing property");this.toState=At.state}connect(){ls(this.actionsOut).forEach(nt=>{var st;(st=this.actionsOut[nt])!=null&&st.length&&this.toObject.addEventListener("beginState",this.onBegin)}),ls(this.actionsIn).forEach(nt=>{var st;(st=this.actionsIn[nt])!=null&&st.length&&this.toObject.addEventListener("completeState",this.onComplete)})}disconnect(){super.disconnect(),ls(this.actionsOut).forEach(nt=>{var st;(st=this.actionsIn[nt])!=null&&st.length&&this.toObject.removeEventListener("beginState",this.onBegin)}),ls(this.actionsIn).forEach(nt=>{var st;(st=this.actionsIn[nt])!=null&&st.length&&this.toObject.removeEventListener("completeState",this.onComplete)})}},Eb=class extends hr{constructor(nt,st){super(nt),this.eventManager=st,this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1}connect(){super.connect();let{page:nt,sharedAssets:st}=this.eventContext;nt.traverseEntity(mt=>{var gt;if((gt=mt.data)!=null&&gt.events.length){for(let{id:_t,data:Et}of mt.data.events)if(!Et.disabled&&Et.type==="Conditional")try{let At;Et.condition.type==="Comparison"||(Et.condition.type==="Distance"?At=new BM(_t,Et,mt,nt,st,this.eventManager):Et.condition.type==="State"&&(At=new NM(_t,Et,mt,nt,st,this.eventManager))),At&&(this.eventsPerConditions[Et.condition.type].push(At),(At.actionsIn.Video.length||At.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}}),Object.values(this.eventsPerConditions).forEach(mt=>mt.forEach(gt=>gt.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(nt=>nt.forEach(st=>st.disconnect()))}},lg=new E$6,ec=new E$6,iu=new E$6,wN=new Vr,wJ=.01,rr=new E$6,Ii=new E$6,AN=new E$6,nu=new Qe$1,FM=new ir,AJ=new ue$1,VM=new fr,Nf=new E$6,Xo=new E$6,Ff=.2;function UM(nt,st){!st||(st[0]<st[1]&&(nt.x=Math.min(Math.max(nt.x,st[0]),st[1])),st[2]<st[3]&&(nt.y=Math.min(Math.max(nt.y,st[2]),st[3])),st[4]<st[5]&&(nt.z=Math.min(Math.max(nt.z,st[4]),st[5])))}var EJ=function(){let nt=new ue$1;return(st,mt,gt)=>{let _t=st.obj;nt.copy(_t.hiddenMatrix),_t.parent!==null&&nt.premultiply(_t.parent.matrixWorld),nt.invert(),_t.position.copy(mt),st.reference==="global"&&UM(_t.position,st.limits),_t.position.applyMatrix4(nt),st.reference==="parent"?UM(_t.position,st.limits):st.reference==="local"&&(nu.copy(st.quat0).invert(),_t.position.sub(st.position0),_t.position.applyQuaternion(nu),UM(_t.position,st.limits),nu.invert(),_t.position.applyQuaternion(nu),_t.position.add(st.position0)),nt.multiply(gt??_t.matrixWorld).decompose(rr,_t.quaternion,Ii),_t.updateMatrix(),_t.hasNonUniformScale&&(_t.updateMatrixWorld(),_t.updateMatrixWorldSVD()),_t instanceof mr&&En(_t.parent)&&_t.invalidateDownstreamBooleanData(!0)}}(),zM=class{constructor(nt,st,mt,gt,_t,Et,At){this.object=nt,this.id=st,this.data=mt,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=Kt$1(mt,mt.dragDropActions.drag,gt,_t,Et,this.object),this.actionsDrop=Kt$1(mt,mt.dragDropActions.drop,gt,_t,Et,this.object);let Rt=[];this.data.objects.forEach(Ft=>{let Nt=gt.find(Ft);!Nt||Nt.data.visible!==!1&&(Rt.push(Nt),At[Nt.uuid]&&At[Nt.uuid].forEach(Bt=>{let Gt=gt.find(Bt);!Gt||Gt.data.visible!==!1&&Rt.push(Gt)}))}),this.data.dropDestinations.forEach(Ft=>{let Nt=gt.find(Ft);!Nt||Nt.data.visible!==!1&&(this.dropDestIds.push(Nt.uuid),At[Nt.uuid]&&At[Nt.uuid].forEach(Bt=>{let Gt=gt.find(Bt);!Gt||Gt.data.visible!==!1&&this.dropDestIds.push(Gt.uuid)}))}),this.dragItems=Rt.map(Ft=>(this.data.planeMode==="locked"&&(Ft.userData.lockedPlane=!0),Ft.userData.worldPosition0=new E$6().setFromMatrixPosition(Ft.matrixWorld),{obj:Ft,fromPosition:new E$6().setFromMatrixPosition(Ft.matrixWorld),pointStart:new E$6,pointEnd:new E$6,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new E$6().copy(Ft.position),quat0:new Qe$1().copy(Ft.quaternion),snapped:!1,orientationMatrix:new ue$1,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){ur(this.actionsDrag),ur(this.actionsDrop),this.dragItems.forEach(nt=>{nt.fromPosition.copy(nt.obj.userData.worldPosition0),nt.pointStart.copy(nt.fromPosition),nt.pointEnd.copy(nt.pointStart),nt.obj.recursiveBBoxNeedsUpdate=!0,nt.obj.userData.lockedPlane=void 0,nt.obj.position.copy(nt.position0),nt.obj.quaternion.copy(nt.quat0),nt.obj.updateMatrix()})}},Mb=class extends hr{constructor(nt,st){super(nt),this.eventManager=st,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=mt=>{var At;if(Je$1.length>1)return;this.eventContext.updateRaycaster(mt);let{raycaster:gt,page:_t}=this.eventContext,Et=_t.raycastWithClones(gt);if(this.lastDropDestination=null,Et.length===0){this.activeEvent=null;return}for(let Rt of this.events){let Ft=0;for(let{obj:Nt,pointEnd:Bt,pointStart:Gt}of Rt.dragItems){if(Nt===Et[0].object||Nt===Et[0].object.object||yt.is(Nt)&&Nt.isAncestorOf(Et[0].object.uuid)){if(Rt.activeIdx=Ft,Rt.activeDragItem.reset=!1,Rt.activeDragItem.currentDampingFactor=Rt.data.dampingFactor,Rt.activeDragItem.snapped=!1,Rt.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){Rt.activeDragItem.obj.rigidBody&&Rt.activeDragItem.obj.rigidBody.setBodyType(2,!0);let dr=Rt.activeDragItem.obj;Nt.hasNonUniformScale&&Nt.updateMatrixWorldSVD(),(dr.hasNonUniformScale?dr.matrixWorldRigid:dr.matrixWorld).decompose(rr,nu,Ii),FM.setFromQuaternion(nu),dr.prevR===void 0?(dr.prevR=FM.clone(),dr.prevT=rr.clone()):(dr.prevR.copy(FM),dr.prevT.copy(rr)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(Rt.activeDragItem.obj)}this.calcPlaneIntersectPos(Nt,Gt,Rt.data.plane,Rt.data.referenceFrame),Bt.copy(Gt),(this.eventManager.controlsManager.usePhysics&&((At=Nt.data.physics)==null?void 0:At.rigidBody)==="dynamic"||Rt.data.drop===!1||Rt.data.resetOnSnapFail===!1)&&Rt.activeDragItem.fromPosition.setFromMatrixPosition(Rt.activeDragItem.obj.matrixWorld),this.activeEvent=Rt,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}Ft++}}this.activeEvent=null},this.onPointerMove=mt=>{var At,Rt,Ft,Nt;if(Je$1.length>1)return;this.eventContext.updateRaycaster(mt);let{raycaster:gt,page:_t}=this.eventContext,Et=_t.raycastWithClones(gt);if(Je$1.length===0){let Bt=!1;for(let Gt of this.events){for(let{obj:dr}of Gt.dragItems)if(dr===((At=Et[0])==null?void 0:At.object)||dr===((Ft=(Rt=Et[0])==null?void 0:Rt.object)==null?void 0:Ft.object)||yt.is(dr)&&dr.isAncestorOf((Nt=Et[0])==null?void 0:Nt.object.uuid)){switch(Bt=!0,Gt.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(Bt)break}Bt||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let Bt=this.activeEvent.activeDragItem;Bt.snapped=!1;let Gt;if(this.activeEvent.data.drop&&(Gt=Et.filter(dr=>Bt.obj!==dr.object&&!Bt.obj.isAncestorOf(dr.object.uuid)&&!(dr.object instanceof ws)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(Mr=>Mr===dr.object.uuid||_t.scene.find(Mr).isAncestorOf(dr.object.uuid))))[0]),Gt){let dr=AN.copy(Gt.face.normal).applyMatrix3(VM.getNormalMatrix(Gt.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")Bt.fromPosition.setFromMatrixPosition(Gt.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(Bt.fromPosition.copy(Gt.point),this.activeEvent.data.snapSurfaceMode==="bbox"){rr.copy(dr).applyMatrix3(VM.setFromMatrix4(Bt.obj.matrixWorld).transpose());let Mr=Bt.obj;rr.x>Ff?Ii.x=-Mr.recursiveBBox.min.x:rr.x<-Ff&&(Ii.x=-Mr.recursiveBBox.max.x),rr.y>Ff?Ii.y=-Mr.recursiveBBox.min.y:rr.y<-Ff&&(Ii.y=-Mr.recursiveBBox.max.y),rr.z>Ff?Ii.z=-Mr.recursiveBBox.min.z:rr.z<-Ff&&(Ii.z=-Mr.recursiveBBox.max.z),Ii.applyMatrix3(VM.invert())}else Ii.copy(dr).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);Bt.fromPosition.add(Ii)}this.activeEvent.data.autoOrient&&(rr.set(0,1,0).cross(dr),rr.length()<1e-4&&rr.set(-1,0,0).cross(dr),Ii.crossVectors(AN,rr),Bt.orientationMatrix.makeBasis(rr,Ii,dr)),Bt.pointStart.copy(Bt.fromPosition),Bt.pointEnd.copy(Bt.pointStart),Bt.currentDampingFactor=this.activeEvent.snapDampingFactor,Bt.snapped=!0,this.lastDropDestination!==Gt.object&&(this.lastDropDestination=Gt.object,this.activeEvent.actionsDrop.Transition.forEach(Mr=>{Mr.play()}),this.activeEvent.actionsDrop.Animation.forEach(Mr=>{Mr.play()}),this.activeEvent.actionsDrop.Audio.forEach(Mr=>{Mr.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Particles.forEach(Mr=>{Mr.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(Mr=>{Mr.dispatchThrottled()}))}else Bt.orientationMatrix.makeRotationFromQuaternion(Bt.quat0),this.lastDropDestination=null,Bt.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(Bt.obj,Bt.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(dr=>{dr.stop(),dr.object.currentState!==null&&dr.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(dr=>{dr.stop()}),this.activeEvent.actionsDrop.Audio.forEach(dr=>{dr.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.Particles.forEach(dr=>{dr.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(dr=>{dr.dispatchThrottled()}),this.activeEvent.actionsDrag.SetVariable.forEach(dr=>dr.checkConditions()),this.activeEvent.actionsDrag.SetVariable.forEach(dr=>dr.dispatch()),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach(dr=>dr.dispatch()),this.activeEvent.actionsDrag.ClearLocalStorage.forEach(dr=>dr.dispatch()),this.activeEvent.actionsDrag.UserAPI.forEach(dr=>dr.dispatch()),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(dr=>{dr.play()}),this.activeEvent.actionsDrag.Animation.forEach(dr=>{dr.play()}),this.activeEvent.actionsDrag.Audio.forEach(dr=>{dr.dispatchGameControl("start")}),this.activeEvent.actionsDrag.Particles.forEach(dr=>{dr.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(dr=>{dr.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(dr=>{dr.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(dr=>{dr.stop(),dr.object.currentState!==null&&dr.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(dr=>{dr.stop()}))},500),this.updateDragItem(Bt),Bt.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=mt=>{var gt;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let _t=((gt=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:gt.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!_t)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&_t&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(Et=>{Et.stop(),Et.object.currentState!==null&&Et.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(Et=>{Et.stop()}),this.activeEvent.actionsDrag.Audio.forEach(Et=>{Et.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(Et=>{Et.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.SetVariable.forEach(Et=>Et.checkConditions()),this.activeEvent.actionsDrop.SetVariable.forEach(Et=>Et.dispatch()),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach(Et=>Et.dispatch()),this.activeEvent.actionsDrop.ClearLocalStorage.forEach(Et=>Et.dispatch()),this.activeEvent.actionsDrop.UserAPI.forEach(Et=>Et.dispatch())),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}}}connect(){let nt={};if(this.eventContext.page.traverseEntity(mt=>{mt.component&&(nt[mt.component.uuid]?nt[mt.component.uuid].push(mt.uuid):nt[mt.component.uuid]=[mt.uuid])}),this.eventContext.page.traverseEntity(mt=>{var gt;(gt=mt.data)==null||gt.events.filter(_t=>_t.data.type==="DragDrop"&&!_t.data.disabled).forEach(_t=>{this.events.push(new zM(mt,_t.id,_t.data,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager,nt))})}),!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let st=this.eventContext.domElement;st.addEventListener("pointerdown",this.onPointerDown),st.addEventListener("pointermove",this.onPointerMove),st.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let nt=this.eventContext.domElement;nt.removeEventListener("pointerdown",this.onPointerDown),nt.removeEventListener("pointermove",this.onPointerMove),nt.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(st=>st.dispose())}setCursor(nt){this.eventContext.domElement.style.cursor=nt}onAnimationFrameDamping(){for(let nt of this.events)for(let st of nt.dragItems)st.paused||this.updateDragItem(st,!0)}calcPlaneIntersectPos(nt,st,mt,gt){let{getCamera:_t,raycaster:Et}=this.eventContext;_t().getWorldDirection(ec),ec.negate();let At=nu.identity();switch(gt==="parent"?AJ.multiplyMatrices(nt.parent.matrixWorld,nt.hiddenMatrix).decompose(rr,At,Ii):gt==="local"&&nt.matrixWorld.decompose(rr,At,Ii),mt){case"x":rr.set(1,0,0).applyQuaternion(At),Nf.copy(ec).cross(rr),Xo.copy(rr).cross(Nf);break;case"y":rr.set(0,1,0).applyQuaternion(At),Nf.copy(ec).cross(rr),Xo.copy(rr).cross(Nf);break;case"z":rr.set(0,0,1).applyQuaternion(At),Nf.copy(ec).cross(rr),Xo.copy(rr).cross(Nf);break;case"xy":Xo.set(0,0,1).applyQuaternion(At);break;case"yz":Xo.set(1,0,0).applyQuaternion(At);break;case"xz":Xo.set(0,1,0).applyQuaternion(At);break;case"adaptive":ec.angleTo(Ii.set(0,1,0))>Math.PI/6?(rr.crossVectors(Ii.set(0,1,0),ec),Xo.crossVectors(rr,Ii)):Xo.set(0,1,0);break;default:Xo.copy(ec);break}iu.setFromMatrixPosition(nt.matrixWorld);let Rt=nt.userData.lockedPlane?nt.userData.worldPosition0:iu;if(wN.setFromNormalAndCoplanarPoint(Xo,Rt),!!Et.ray.intersectPlane(wN,st)&&(mt==="x"||mt==="y"||mt==="z")){let Ft=Ii.subVectors(st,Rt).dot(rr);st.copy(Rt).addScaledVector(rr,Ft)}}updateDragItem(nt,st=!1){var mt,gt;iu.setFromMatrixPosition(nt.obj.matrixWorld),nt.reset==="current"?lg.subVectors(nt.fromPosition,iu).divideScalar(nt.currentDampingFactor):nt.reset==="original"?(lg.subVectors(nt.obj.userData.worldPosition0,iu).divideScalar(nt.currentDampingFactor),nt.fromPosition.copy(nt.obj.userData.worldPosition0),nt.pointStart.copy(nt.fromPosition),nt.pointEnd.copy(nt.pointStart)):lg.subVectors(nt.pointEnd,nt.pointStart).add(nt.fromPosition).sub(iu).divideScalar(nt.currentDampingFactor),nt.paused=nt.currentDampingFactor>1?lg.length()<wJ:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||st)&&EJ(nt,lg.add(iu),(mt=this.activeEvent)!=null&&mt.data.drop&&((gt=this.activeEvent)!=null&&gt.data.autoOrient)?nt.orientationMatrix:null),nt.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},Vf=new E$6,kM=new E$6,Ua=new E$6,za=new E$6,EN=new Vr,MJ=.01,TJ={type:"requestRender"},CJ=function(){let nt=new E$6,st=new E$6;return(mt,gt,_t)=>_t>0?(nt.subVectors(mt,gt),nt.length()<=_t?mt:st.copy(gt).add(nt.normalize().multiplyScalar(_t))):gt}(),MN=function(){let nt=new ue$1;return(st,mt)=>{st.position.copy(mt),st.parent!==null&&(nt.copy(st.parent.matrixWorld).invert(),st.position.applyMatrix4(nt)),nt.copy(st.hiddenMatrix).invert(),st.position.applyMatrix4(nt),st.updateMatrix(),st.hasNonUniformScale&&(st.updateMatrixWorld(),st.updateMatrixWorldSVD()),st instanceof mr&&En(st.parent)&&st.invalidateDownstreamBooleanData(!0)}}(),GM=class{constructor(nt,st,mt,gt,_t,Et){this.data=nt,this.id=st,this.object=mt,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new E$6,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...Cv.defaultData,...nt,...nt.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},nt.target===void 0||nt.target==="cursor"||(this.target=gt.find(nt.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=Kt$1(nt,nt.actions,gt,_t,Et,mt)}},Tb=class extends hr{constructor(nt,st){super(nt),this.eventManager=st,this.events=[],this.pairOfEventListeners=[],this.onMouseMove=mt=>{if(!(Je$1.length>1)){this.eventContext.updateRaycaster(mt);for(let gt of this.events)gt.target===void 0&&this.updateSingleEvent(gt)}},this.onMouseEnter=mt=>{for(let gt of this.events)gt.target===void 0&&(gt.isReset=!1,gt.currentDampingFactor=gt.data.dampingFactor)},this.onMouseLeave=mt=>{for(let gt of this.events)gt.target===void 0&&(gt.data.resetOnPointerLeave&&(gt.isReset=!0,gt.currentDampingFactor=gt.resetDampingFactor),this.updateSingleEvent(gt))},this.onTargetChange=mt=>()=>{this.updateSingleEvent(mt)}}connect(){let{page:nt}=this.eventContext;if(nt.traverseEntity(gt=>{var Et,At;let _t=(Et=gt.data)==null?void 0:Et.events.find(Rt=>Rt.data.type==="Follow"&&!Rt.data.disabled);_t&&(!nt.data.globalPhysics.usePhysics||((At=gt.dataPatched.physics)==null?void 0:At.rigidBody)!=="dynamic")&&this.events.push(new GM(_t.data,_t.id,gt,nt,this.eventContext.sharedAssets,this.eventManager))}),!this.events.length)return;let{domElement:st,eventElement:mt}=this.eventContext;this.domEventsNeeded.clear(),Ci&&(this.domEventsNeeded.add("pointerdown"),st.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),mt.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(st.addEventListener("pointerenter",this.onMouseEnter),st.addEventListener("pointerleave",this.onMouseLeave));for(let gt of this.events)if(gt.target!==void 0){let _t=gt.target,Et=this.onTargetChange(gt);this.pairOfEventListeners.push([_t,Et]),_t.addEventListener("requestRender",Et)}}disconnect(){if(!this.events.length)return;let{domElement:nt,eventElement:st}=this.eventContext;this.domEventsNeeded.clear(),Ci&&nt.removeEventListener("pointerdown",this.onMouseMove),st.removeEventListener("pointermove",this.onMouseMove),nt.removeEventListener("pointerenter",this.onMouseEnter),nt.removeEventListener("pointerleave",this.onMouseLeave);for(let[mt,gt]of this.pairOfEventListeners)mt.removeEventListener("requestRender",gt);for(let mt of this.events)mt.paused=!0,mt.isReset=!1,ur(mt.actions)}onAnimationFrameDamping(){for(let nt of this.events)nt.paused||this.updateSingleEvent(nt,!0)}updateSingleEvent(nt,st=!1){var At;this.events.forEach(Rt=>{Rt.actions.Create.forEach(Ft=>{Ft.dispatchThrottled()})});let{plane:mt,limitDistance:gt,limitDistanceEnabled:_t}=nt.data;if(nt.object.getWorldPosition(Ua),nt.isReset)za.copy(nt.worldPosition0);else if(nt.target)nt.target.getWorldPosition(za);else{let{getCamera:Rt,raycaster:Ft}=this.eventContext;if(mt==="custom"?(Rt().getWorldDirection(kM),kM.negate(),Vf.copy(kM)):mt==="xy"?Vf.set(0,0,1):mt==="xz"?Vf.set(0,1,0):mt==="yz"&&Vf.set(1,0,0),EN.setFromNormalAndCoplanarPoint(Vf,Ua),!Ft.ray.intersectPlane(EN,za))return}if(!nt.isReset){if(za.distanceTo(nt.worldPosition0)>gt&&_t&&nt.target)if(nt.snapComplete=!1,nt.data.snapDelay&&(nt.delayFinished=!1,typeof window<"u"&&nt.timeoutId!==null&&(window.clearTimeout(nt.timeoutId),nt.timeoutId=null)),nt.wasOutside=!0,nt.data.resetAfterDistanceLimit)za.copy(nt.worldPosition0),nt.currentDampingFactor=nt.resetDampingFactor;else return;else if(nt.wasOutside&&(nt.data.snapDelay&&typeof window<"u"&&(nt.timeoutId=window.setTimeout(()=>{nt.delayFinished=!0,nt.paused=!1,this.updateSingleEvent(nt)},nt.data.snapDelay*1e3)),nt.currentDampingFactor=nt.data.dampingFactor,nt.wasOutside=!1),nt.delayFinished===!1)return}nt.data.enabledTranslation[0]===!1&&(za.x=Ua.x),nt.data.enabledTranslation[1]===!1&&(za.y=Ua.y),nt.data.enabledTranslation[2]===!1&&(za.z=Ua.z);let Et=CJ(Ua,za,nt.wasOutside?0:nt.data.maxDelta);if(nt.currentDampingFactor>1){let Rt=Vf.subVectors(Et,Ua).divideScalar(nt.currentDampingFactor);Ua.add(Rt),st&&MN(nt.object,Ua),nt.paused=Rt.length()<MJ}else MN(nt.object,Et),nt.paused=!0;(At=nt.object)==null||At.dispatchEvent({type:"beginEvent",eventName:"Follow"}),nt.object.dispatchEvent(TJ)}},cg=new E$6,Cb=new E$6,ug=new ue$1,Uf=new Qe$1,tc=new Qe$1,hg=new E$6,dg=new E$6,su=new E$6,ka=new E$6,jM=new Vr,PJ=1e-6,_J={type:"requestRender"},DJ={type:"changeRotation"},TN=function(){let nt=new ue$1;return function(st,mt){st.parent!==null?nt.multiplyMatrices(st.parent.matrixWorld,st.hiddenMatrix):nt.copy(st.hiddenMatrix),mt.premultiply(OM(nt).invert()),st.rotation.setFromRotationMatrix(mt),st.updateMatrix(),st instanceof mr&&En(st.parent)&&st.invalidateDownstreamBooleanData(!0)}}(),HM=class{constructor(nt,st,mt,gt){this.id=st,this.object=mt,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new Qe$1,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...Pv.defaultData,...nt,...nt.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},nt.target===void 0||nt.target==="cursor"||(this.target=gt.find(nt.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},Pb=class extends hr{constructor(){super(...arguments),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=nt=>{if(!(Je$1.length>1)){this._lastMouseEvent=nt,this.eventContext.updateRaycaster(nt);for(let st of this.events)st.target===void 0&&this.updateSingleEvent(st)}},this.onMouseEnter=nt=>{for(let st of this.events)st.target===void 0&&(st.isReset=!1,st.currentDampingFactor=st.data.dampingFactor)},this.onMouseLeave=nt=>{for(let st of this.events)st.target===void 0&&(st.data.resetOnPointerLeave&&(st.isReset=!0,st.currentDampingFactor=st.resetDampingFactor),this.updateSingleEvent(st))},this.onScroll=nt=>{if(this._lastMouseEvent){let st=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(st)}},this.onTargetChange=nt=>()=>{this.updateSingleEvent(nt)},this.createUserEventListener=nt=>({eventName:st,target:mt})=>{if(!st||!mt)return;let gt=Yo(st);gt&&gt==="LookAt"&&this.updateSingleEvent(nt)}}connect(){let{page:nt}=this.eventContext;if(nt.traverseEntity(gt=>{var Et,At;let _t=(Et=gt.data)==null?void 0:Et.events.find(Rt=>Rt.data.type==="LookAt"&&!Rt.data.disabled);_t&&(!nt.data.globalPhysics.usePhysics||((At=gt.dataPatched.physics)==null?void 0:At.rigidBody)!=="dynamic")&&this.events.push(new HM(_t.data,_t.id,gt,nt))}),!this.events.length)return;let{domElement:st,eventElement:mt}=this.eventContext;this.domEventsNeeded.clear(),Ci&&(this.domEventsNeeded.add("pointerdown"),st.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),mt.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?mt.addEventListener("scroll",this.onScroll):(st.addEventListener("pointerenter",this.onMouseEnter),st.addEventListener("pointerleave",this.onMouseLeave));for(let gt of this.events){if(gt.target!==void 0){let At=this.onTargetChange(gt),Rt=gt.target;this.pairOfEventListeners.push([Rt,At]),Rt.addEventListener("requestRender",At)}let _t=this.createUserEventListener(gt),Et=gt.object;this.pairOfUserEventListeners.push([Et,_t]),Et.addEventListener("userEvent",_t)}}disconnect(){if(!this.events.length)return;let{domElement:nt,eventElement:st}=this.eventContext;this.domEventsNeeded.clear(),Ci&&nt.removeEventListener("pointerdown",this.onMouseMove),st.removeEventListener("pointermove",this.onMouseMove),nt.removeEventListener("pointerenter",this.onMouseEnter),nt.removeEventListener("pointerleave",this.onMouseLeave),st.removeEventListener("scroll",this.onScroll);for(let[mt,gt]of this.pairOfEventListeners)mt.removeEventListener("requestRender",gt);for(let[mt,gt]of this.pairOfUserEventListeners)mt.removeEventListener("userEvent",gt);for(let mt of this.events)mt.paused=!0,mt.isReset=!1}onAnimationFrameDamping(){for(let nt of this.events)nt.paused||this.updateSingleEvent(nt)}updateSingleEvent(nt){var dr;let{tilt:st,axis:mt,distance:gt,plane:_t,limitDistance:Et,enabledRotation:At,limitDistanceEnabled:Rt}=nt.data,{getCamera:Ft,raycaster:Nt}=this.eventContext,{object:Bt,target:Gt}=nt;if(Bt.getWorldPosition(hg),!nt.isReset)if(nt.target)nt.target.getWorldPosition(dg);else{if(_t==="custom"?(Ft().getWorldDirection(Cb),Cb.negate(),jM.setFromNormalAndCoplanarPoint(Cb,hg)):(_t==="xy"?cg.set(0,0,1):_t==="xz"?cg.set(0,1,0):_t==="yz"&&cg.set(1,0,0),jM.setFromNormalAndCoplanarPoint(cg,hg)),!Nt.ray.intersectPlane(jM,dg))return;gt>0&&(_t==="custom"||_t===void 0)&&dg.addScaledVector(Cb,gt)}if(nt.isReset||(Gt?st==="target"?su.copy(Gt.up).applyMatrix4(ug.extractRotation(Gt.matrixWorld)).normalize():At.some(Mr=>Mr===!1)?(mt==="x"?(ka.set(0,0,1),At[2]===!1&&ka.set(0,1,0)):mt==="y"?(ka.set(1,0,0),At[0]===!1&&ka.set(0,0,1)):(ka.set(0,1,0),At[1]===!1&&ka.set(1,0,0)),su.copy(ka).applyQuaternion(nt.worldQuaternion0).normalize()):su.set(0,1,0):_t==="custom"?su.set(0,1,0):su.copy(cg)),nt.isReset)tc.copy(nt.worldQuaternion0);else if(hg.distanceTo(dg)>Et&&Rt&&Gt)if(nt.data.snapDelay&&(nt.delayFinished=!1,typeof window<"u"&&nt.timeoutId!==null&&(window.clearTimeout(nt.timeoutId),nt.timeoutId=null)),nt.wasOutside=!0,nt.data.resetAfterDistanceLimit)tc.copy(nt.worldQuaternion0),nt.currentDampingFactor=nt.resetDampingFactor;else return;else{if(nt.wasOutside&&(nt.data.snapDelay&&typeof window<"u"&&(nt.timeoutId=window.setTimeout(()=>{nt.delayFinished=!0,nt.paused=!1,this.updateSingleEvent(nt)},nt.data.snapDelay*1e3)),nt.currentDampingFactor=nt.data.dampingFactor,nt.wasOutside=!1),nt.delayFinished===!1)return;IJ(ug,dg,hg,su,mt,ka),tc.setFromRotationMatrix(ug),Uf.setFromUnitVectors(ka.applyQuaternion(tc),su),At.some(Mr=>Mr===!1)&&st!=="target"&&tc.premultiply(Uf).normalize()}nt.currentDampingFactor>1?(Bt.updateWorldMatrix(!0,!1),Uf.setFromRotationMatrix(OM(Bt.matrixWorld)),Uf.slerp(tc,1/nt.currentDampingFactor),TN(Bt,ug.makeRotationFromQuaternion(Uf)),nt.paused=8*(1-Uf.dot(tc))<PJ):(TN(Bt,ug.makeRotationFromQuaternion(tc)),nt.paused=!0),(dr=nt.object)==null||dr.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),Bt.dispatchEvent(_J),Bt.dispatchEvent(DJ)}},Ts=new E$6,Oi=new E$6,li=new E$6;function IJ(nt,st,mt,gt,_t,Et){let At=nt.elements;li.subVectors(st,mt),li.lengthSq()===0&&(li.z=1),li.normalize(),Oi.crossVectors(gt,li),Oi.lengthSq()===0&&(Math.abs(gt.z)===1?li.x+=1e-4:li.z+=1e-4,li.normalize(),Oi.crossVectors(gt,li)),Oi.normalize(),Ts.crossVectors(li,Oi),_t==="x"?Et.z===1?[Oi,Ts,li]=[li,Oi,Ts]:(Oi.negate(),[Oi,li]=[li,Oi]):_t==="y"?Et.x===1?[Oi,Ts,li]=[Ts,li,Oi]:(Oi.negate(),[Ts,li]=[li,Ts]):Et.x===1&&(Oi.negate(),[Oi,Ts]=[Ts,Oi]),At[0]=Oi.x,At[4]=Ts.x,At[8]=li.x,At[1]=Oi.y,At[5]=Ts.y,At[9]=li.y,At[2]=Oi.z,At[6]=Ts.z,At[10]=li.z}var WM=class{constructor(nt,st,mt,gt,_t,Et){this.id=nt,this.data=st,this.object=mt,this.entered=!1,this.actions=Kt$1(st,st.actions,gt,_t,Et,mt)}disconnect(){ur(this.actions)}dispatchEnter(){this.actions.Transition.forEach(nt=>{nt.object.currentTransitionEvent!==this&&(nt.object.currentTransitionEvent=this,nt.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(nt=>nt.playFromCurrent()),this.actions.Animation.forEach(nt=>nt.play()),this.actions.Create.forEach(nt=>nt.dispatchStart()),this.actions.Particles.forEach(nt=>nt.dispatchBasic()),this.actions.Destroy.forEach(nt=>nt.dispatch()),this.actions.SwitchCamera.forEach(nt=>nt.playFromCurrent()),this.actions.SceneTransition.forEach(nt=>nt.dispatch()),this.actions.SetVariable.forEach(nt=>nt.checkConditions()),this.actions.SetVariable.forEach(nt=>nt.dispatch()),this.actions.DynamicVariablePlay.forEach(nt=>nt.dispatch()),this.actions.ClearLocalStorage.forEach(nt=>nt.dispatch()),this.actions.UserAPI.forEach(nt=>nt.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(nt=>{nt.object.currentTransitionEvent!==this&&(nt.object.currentTransitionEvent=this,nt.init())}),this.entered&&(this.entered=!1,this.actions.Create.forEach(nt=>nt.dispatchStop()),this.actions.Transition.forEach(nt=>nt.reverseFromCurrent()),this.actions.Particles.forEach(nt=>nt.reverseFromCurrent()),this.actions.SwitchCamera.forEach(nt=>nt.reverseFromCurrent()))}dispatchUserEvent(nt){this.actions.Transition.forEach(st=>{st.object.currentTransitionEvent!==this&&(st.object.currentTransitionEvent=this,st.init())}),nt?(this.actions.Transition.forEach(st=>st.reverseFromCurrent()),this.actions.Particles.forEach(st=>st.reverseFromCurrent()),this.actions.Animation.forEach(st=>st.reverseFromCurrent()),this.actions.SwitchCamera.forEach(st=>st.reverseFromCurrent())):(this.actions.Transition.forEach(st=>st.playFromCurrent()),this.actions.Animation.forEach(st=>st.playFromCurrent()),this.actions.Create.forEach(st=>st.dispatch()),this.actions.Particles.forEach(st=>st.dispatchBasic()),this.actions.Destroy.forEach(st=>st.dispatch()),this.actions.SwitchCamera.forEach(st=>st.playFromCurrent())),this.actions.SceneTransition.forEach(st=>st.dispatch()),this.actions.SetVariable.forEach(st=>st.checkConditions()),this.actions.SetVariable.forEach(st=>st.dispatch()),this.actions.DynamicVariablePlay.forEach(st=>st.dispatch()),this.actions.ClearLocalStorage.forEach(st=>st.dispatch()),this.actions.UserAPI.forEach(st=>st.dispatch())}},_b=class extends hr{constructor(nt,st){super(nt),this.eventManager=st,this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=mt=>{Je$1.length>1||(this.eventContext.updateRaycaster(mt),this.handleMouseHoverEvent())},this.onMouseUp=mt=>{Je$1.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=mt=>{Je$1.length>1||(this.eventContext.updateRaycaster(mt),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:mt,target:gt,reverse:_t})=>{var At;if(!mt||!gt)return;let Et=Yo(mt);Et&&Et==="MouseHover"&&(gt.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(At=this.eventsPerObjects[gt.uuid])==null||At.forEach(Rt=>Rt.dispatchUserEvent(_t)))}}connect(){let{page:nt,sharedAssets:st}=this.eventContext,mt=(_t,Et)=>{var At,Rt;if(!(!_t.visible||!((At=_t.data)!=null&&At.events.length))){for(let{id:Ft,data:Nt}of _t.data.events)if(!Nt.disabled&&Nt.type==="MouseHover")try{let Bt=new WM(Ft,Nt,_t,nt,st,this.eventManager);this.eventsPerObjects[_t.uuid]?this.eventsPerObjects[_t.uuid].push(Bt):this.eventsPerObjects[_t.uuid]=[Bt]}catch{}(Rt=this.eventsPerObjects[_t.uuid])!=null&&Rt.length&&this.objects.push(_t instanceof tr?Et:_t)}};if(nt.traverseEntity(_t=>{var Et;(_t instanceof Er||_t instanceof cr)&&((Et=_t.frame)==null||Et.traverse(At=>{mt(At,_t)})),mt(_t)}),!this.objects.length)return;let{domElement:gt}=this.eventContext;this.domEventsNeeded.clear(),Ci&&(this.domEventsNeeded.add("pointerdown"),gt.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),gt.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),gt.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(_t=>{_t.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:nt}=this.eventContext;this.domEventsNeeded.clear(),Ci&&(nt.removeEventListener("pointerdown",this.onMouseDown),nt.removeEventListener("pointerup",this.onMouseUp)),nt.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(st=>{st.forEach(mt=>{mt.disconnect()})}),this.objects.forEach(st=>{st.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(nt=!1){let st=[];if(!nt){let{stopRaycast:mt,raycaster:gt,page:_t,pointerScreen:Et}=this.eventContext,At=!1;if(_t.uiCanvas&&(At=no$1(_t,[Et.x,Et.y],Object.keys(this.eventsPerObjects),Rt=>{st.push(Rt)})),mt&&!At){let Rt=Lf(gt,_t,this.objects);st=ag(Rt),Rt.forEach(Ft=>{var Nt,Bt;Ft.object instanceof Er&&no$1(Ft.object,[((Nt=Ft==null?void 0:Ft.uv)==null?void 0:Nt.x)??0,((Bt=Ft==null?void 0:Ft.uv)==null?void 0:Bt.y)??0],Object.keys(this.eventsPerObjects),Gt=>{st.push(Gt)})})}else this.objects.forEach(Rt=>{var Nt,Bt;let Ft=Bf(gt,Rt);Ft&&(st.push(Rt),Rt instanceof Er&&no$1(Rt,[((Nt=Ft==null?void 0:Ft.uv)==null?void 0:Nt.x)??0,((Bt=Ft==null?void 0:Ft.uv)==null?void 0:Bt.y)??0],Object.keys(this.eventsPerObjects),Gt=>{st.push(Gt)}))})}this._prevObjects.length&&this._prevObjects.forEach(mt=>{var gt;st.includes(mt)||(mt.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(gt=this.eventsPerObjects[mt.uuid])==null||gt.forEach(_t=>_t.dispatchLeave()))}),st.length&&st.forEach(mt=>{var gt;mt.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(gt=this.eventsPerObjects[mt.uuid])==null||gt.forEach(_t=>_t.dispatchEnter())}),this._prevObjects=st}},qM=class{constructor(nt,st,mt,gt,_t,Et){this.id=nt,this.data=st,this.object=mt,this.scrollCounter=0,this.actions=Kt$1(st,st.actions,gt,_t,Et,mt)}connect(){this.scrollCounter=0}disconnect(){ur(this.actions)}dispatch(nt){this.actions.Transition.forEach(gt=>{gt.object.currentTransitionEvent!==this&&(gt.object.currentTransitionEvent=this,gt.init())});let st=nt>0?1:-1;this.scrollCounter+=st,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let mt=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(gt=>gt.seek(mt)),this.actions.Animation.forEach(gt=>gt.seek(st)),this.actions.Create.forEach(gt=>gt.dispatchThrottled()),this.actions.SetVariable.forEach(gt=>gt.checkConditions()),this.actions.SetVariable.forEach(gt=>gt.dispatch()),this.actions.DynamicVariablePlay.forEach(gt=>gt.dispatch()),this.actions.ClearLocalStorage.forEach(gt=>gt.dispatch()),this.actions.UserAPI.forEach(gt=>gt.dispatch())}dispatchUserEvent(nt){this.actions.Transition.forEach(st=>{st.object.currentTransitionEvent!==this&&(st.object.currentTransitionEvent=this,st.init())}),nt?(this.actions.Transition.forEach(st=>st.reverseFromCurrent()),this.actions.Animation.forEach(st=>st.reverseFromCurrent())):(this.actions.Transition.forEach(st=>{st.playFromCurrent()}),this.actions.Animation.forEach(st=>{st.playFromCurrent()})),this.actions.Create.forEach(st=>st.dispatchThrottled()),this.actions.SetVariable.forEach(st=>st.checkConditions()),this.actions.SetVariable.forEach(st=>st.dispatch()),this.actions.DynamicVariablePlay.forEach(st=>st.dispatch()),this.actions.ClearLocalStorage.forEach(st=>st.dispatch()),this.actions.UserAPI.forEach(st=>st.dispatch())}},YM=class{constructor(nt,st,mt,gt,_t,Et,At){this.id=nt,this.data=st,this.object=mt,this.domElement=Et,this.eventManager=At,this.scrollStart=0,this.scrollEnd=0,this.actions=Kt$1(st,st.actions,gt,_t,At,mt)}getStickyParentElement(){let nt=this.domElement;for(;nt;){if(window.getComputedStyle(nt).position==="sticky")return nt;nt=nt.parentElement}return null}computeScrollBounds(){let nt=this.getStickyParentElement(),st=nt==null?void 0:nt.parentElement,mt=this.domElement.getBoundingClientRect(),gt={top:mt.top,bottom:mt.bottom,left:mt.left,right:mt.right,width:mt.width,height:mt.height};if(st){let Nt=st.getBoundingClientRect(),Bt=window.getComputedStyle(nt),Gt=parseFloat(Bt.marginTop)+parseFloat(Bt.marginBottom),dr=parseFloat(Bt.top),Mr=parseFloat(Bt.bottom),Tr=Nt.height-Gt;if(!isNaN(dr))mt.top===dr?(gt.top+=Nt.top-dr,gt.bottom+=Nt.top-dr):mt.top<0&&(gt.top-=Tr-mt.height,gt.bottom-=Tr-mt.height);else if(!isNaN(Mr)){let zr=document.body.clientHeight??window.innerHeight,Fr=window.innerWidth-(document.documentElement.clientWidth??window.innerWidth);mt.bottom===zr-Mr?(gt.top+=Nt.top-mt.height+Mr+Fr,gt.bottom+=Nt.top-mt.height+Mr+Fr):mt.bottom<zr-Mr&&(gt.top-=Tr-mt.height,gt.bottom-=Tr-mt.height)}}let _t=document.body,Et=document.documentElement,At=window.pageYOffset||Et.scrollTop||_t.scrollTop,Rt=Et.clientTop||_t.clientTop||0,Ft=Math.round(gt.top+At-Rt);if(this.data.startFrom==="enter"){let Nt=window.innerHeight,Bt=gt.height,Gt=this.data.enterAnchor,dr=Gt==="top"?Nt:Gt==="bottom"?Nt-Bt:Nt-Bt*.5;this.scrollStart=Ft-dr}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=gt,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){ur(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:nt,y:st}){this.actions.Transition.forEach(_t=>{_t.object.currentTransitionEvent!==this&&(_t.object.currentTransitionEvent=this,_t.init())});let mt=this.scrollEnd-this.scrollStart,gt=Math.min(1,Math.max(0,(st-this.scrollStart)/mt));this.actions.Transition.forEach(_t=>_t.seek(gt)),this.actions.Animation.forEach(_t=>_t.seek(gt)),this.actions.Create.forEach(_t=>_t.dispatchThrottled()),this.actions.SetVariable.forEach(_t=>_t.checkConditions()),this.actions.SetVariable.forEach(_t=>_t.dispatch()),this.actions.DynamicVariablePlay.forEach(_t=>_t.dispatch()),this.actions.ClearLocalStorage.forEach(_t=>_t.dispatch()),this.actions.UserAPI.forEach(_t=>_t.dispatch())}dispatch(nt){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(nt)}dispatchUserEvent(nt){this.actions.Transition.forEach(st=>{st.object.currentTransitionEvent!==this&&(st.object.currentTransitionEvent=this,st.init())}),nt?(this.actions.Transition.forEach(st=>st.reverseFromCurrent()),this.actions.Animation.forEach(st=>st.reverseFromCurrent())):(this.actions.Transition.forEach(st=>{st.playFromCurrent()}),this.actions.Animation.forEach(st=>{st.playFromCurrent()})),this.actions.Create.forEach(st=>st.dispatchThrottled()),this.actions.SetVariable.forEach(st=>st.checkConditions()),this.actions.SetVariable.forEach(st=>st.dispatch()),this.actions.DynamicVariablePlay.forEach(st=>st.dispatch()),this.actions.ClearLocalStorage.forEach(st=>st.dispatch()),this.actions.UserAPI.forEach(st=>st.dispatch())}},Db=class extends hr{constructor(nt,st){super(nt),this.managers=st,this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([mt,gt])=>{gt.forEach(_t=>_t.handleResize())})},this.onScroll=mt=>{if(!this.isInview)return;let gt={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([_t,Et])=>{_t.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:gt}),Et.forEach(At=>At.dispatch(gt))})},this.onWheel=mt=>{!this.isInview||mt.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([gt,_t])=>{gt.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:mt.deltaY}),_t.forEach(Et=>Et.dispatch(mt.deltaY))})},this.onUserEvent=({eventName:mt,target:gt,reverse:_t})=>{var At;if(!mt||!gt)return;let Et=Yo(mt);Et&&Et==="Scroll"&&(gt.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(At=this.wheelEventsPerObject.get(gt))==null||At.forEach(Rt=>{Rt.dispatchUserEvent(_t)}))}}connect(){let{page:nt,sharedAssets:st,domElement:mt,isExport:gt}=this.eventContext,_t=Et=>{var At,Rt,Ft;if((At=Et.data)!=null&&At.events.length){for(let{id:Nt,data:Bt}of Et.data.events)if(!Bt.disabled&&Bt.type==="Scroll")if(Bt.trigger==="load"||!gt){let Gt=new qM(Nt,Bt,Et,nt,st,this.managers);this.wheelEventsPerObject.has(Et)?(Rt=this.wheelEventsPerObject.get(Et))==null||Rt.push(Gt):this.wheelEventsPerObject.set(Et,[Gt])}else{let Gt=new YM(Nt,Bt,Et,nt,st,mt,this.managers);this.scrollEventsPerObject.has(Et)?(Ft=this.scrollEventsPerObject.get(Et))==null||Ft.push(Gt):this.scrollEventsPerObject.set(Et,[Gt])}}};nt.traverseEntity(Et=>{var At;(Et instanceof Er||Et instanceof cr)&&((At=Et.frame)==null||At.traverse(Rt=>{_t(Rt)})),_t(Et)}),this.intersectionObserver=new IntersectionObserver(Et=>{let At=Et[0];At&&(this.isInview=At.isIntersecting)},{root:null}),this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([Et,At])=>{At.forEach(Rt=>Rt.connect()),Et.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([Et,At])=>{At.forEach(Rt=>Rt.connect()),Et.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(Et=>Et.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(Et=>Et.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([nt,st])=>{st.forEach(mt=>mt.disconnect()),nt.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([nt,st])=>{st.forEach(mt=>mt.disconnect()),nt.removeEventListener("userEvent",this.onUserEvent)})}},XM=class{constructor(nt,st,mt,gt,_t,Et){this.id=nt,this.data=st,this.object=mt,this.actions=Kt$1(st,st.actions,gt,_t,Et,mt)}disconnect(){ur(this.actions)}dispatch(){this.actions.Transition.forEach(nt=>{nt.play()}),this.actions.Animation.forEach(nt=>{nt.play()}),this.actions.SwitchCamera.forEach(nt=>{nt.play()}),this.actions.SceneTransition.forEach(nt=>{nt.dispatch()}),this.actions.Reset.forEach(nt=>nt.dispatch()),this.actions.SetVariable.forEach(nt=>nt.checkConditions()),this.actions.SetVariable.forEach(nt=>nt.dispatch()),this.actions.DynamicVariablePlay.forEach(nt=>nt.dispatch()),this.actions.ClearLocalStorage.forEach(nt=>nt.dispatch()),this.actions.UserAPI.forEach(nt=>nt.dispatch()),this.actions.Create.forEach(nt=>{nt.dispatchFromStart()}),this.actions.Destroy.forEach(nt=>{nt.dispatchFromStart()})}dispatchAfter(nt){this.actions.Audio.forEach(st=>{(st.interaction.data.triggerAfter??"any")===nt&&(st.interaction instanceof Go?st.interaction.audioPlayer.play():st.interaction instanceof Df&&st.interaction.dispatch())}),this.actions.Video.forEach(st=>{let mt=st.interaction.data.triggerAfter??"autoplay";mt===nt&&(st.interaction instanceof Fa?st.interaction.play(mt==="autoplay"):st.interaction instanceof Rf&&st.interaction.dispatch())}),this.actions.Particles.forEach(st=>{(st.data.triggerAfter??"any")===nt&&st.dispatchBasic()})}dispatchUserEvent(nt){this.actions.Transition.forEach(st=>{st.object.currentTransitionEvent!==this&&(st.object.currentTransitionEvent=this,st.init())}),nt?(this.actions.Transition.forEach(st=>st.reverseFromCurrent()),this.actions.Animation.forEach(st=>st.reverseFromCurrent()),this.actions.SwitchCamera.forEach(st=>st.reverseFromCurrent())):(this.actions.Transition.forEach(st=>st.playFromCurrent()),this.actions.Animation.forEach(st=>st.playFromCurrent()),this.actions.SwitchCamera.forEach(st=>st.playFromCurrent())),this.actions.SceneTransition.forEach(st=>st.dispatch()),this.actions.Reset.forEach(st=>st.dispatch()),this.actions.SetVariable.forEach(st=>st.checkConditions()),this.actions.SetVariable.forEach(st=>st.dispatch()),this.actions.DynamicVariablePlay.forEach(st=>st.dispatch()),this.actions.ClearLocalStorage.forEach(st=>st.dispatch()),this.actions.UserAPI.forEach(st=>st.dispatch()),this.actions.Create.forEach(st=>{st.dispatch()}),this.actions.Destroy.forEach(st=>{st.dispatch()}),this.actions.Audio.forEach(st=>{st.interaction instanceof Go?st.interaction.audioPlayer.play():st.interaction instanceof Df&&st.interaction.dispatch()}),this.actions.Video.forEach(st=>{st.interaction instanceof Fa?st.interaction.play():st.interaction instanceof Rf&&st.interaction.dispatch()}),this.actions.Particles.forEach(st=>{st.dispatchBasic()})}},Ib=class extends hr{constructor(nt,st){super(nt),this.eventManager=st,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([mt,gt])=>{mt.dispatchEvent({type:"beginEvent",eventName:"Start"}),gt.forEach(_t=>{_t.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([mt,gt])=>{mt.dispatchEvent({type:"beginEvent",eventName:"Start"}),gt.forEach(_t=>{_t.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:mt,isExport:gt}=this.eventContext,_t=gt?document:mt;_t.removeEventListener("pointerdown",this.onAny),_t.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([Et,At])=>{Et.dispatchEvent({type:"beginEvent",eventName:"Start"}),At.forEach(Rt=>{Rt.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([mt,gt])=>{mt.dispatchEvent({type:"beginEvent",eventName:"Start"}),gt.forEach(_t=>{_t.actions.Audio.forEach(Et=>{Et.interaction instanceof Go&&Et.interaction.audioPlayer.play()}),_t.actions.Video.forEach(Et=>{let At=Et.interaction.data.triggerAfter??"autoplay";Et.interaction instanceof Fa&&Et.interaction.play(At==="autoplay")}),_t.actions.Particles.forEach(Et=>{Et.dispatchBasic()})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([mt,gt])=>{mt.dispatchEvent({type:"beginEvent",eventName:"Start"}),gt.forEach(_t=>{_t.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:mt,target:gt,reverse:_t})=>{var At,Rt;if(!mt||!gt)return;let Et=Yo(mt);Et&&Et==="Start"&&(gt instanceof tr||gt.dispatchEvent({type:"beginEvent",eventName:"Start"}),(At=this.eventsPerObject.get(gt))==null||At.forEach(Ft=>{Ft.dispatchUserEvent(_t)}),(Rt=this.eventsAfterPerObject.get(gt))==null||Rt.forEach(Ft=>{Ft.dispatchUserEvent(_t)}))}}connect(){let{sharedAssets:nt,page:st}=this.eventContext,mt=gt=>{var _t,Et,At,Rt,Ft;if((_t=gt.data)!=null&&_t.events.length)for(let{id:Nt,data:Bt}of gt.data.events){if(Bt.disabled||Bt.type!=="Start")continue;let Gt=new XM(Nt,Bt,gt,st,nt,this.eventManager);(Gt.actions.Transition.length||Gt.actions.Animation.length||Gt.actions.SwitchCamera.length||Gt.actions.Create.length||Gt.actions.Destroy.length||Gt.actions.SceneTransition.length||Gt.actions.Reset.length||Gt.actions.SetVariable.length||Gt.actions.DynamicVariablePlay.length||Gt.actions.ClearLocalStorage.length||Gt.actions.UserAPI.length)&&(this.eventsPerObject.has(gt)?(Et=this.eventsPerObject.get(gt))==null||Et.push(Gt):this.eventsPerObject.set(gt,[Gt])),Gt.actions.Audio.length&&(this.eventsAfterPerObject.has(gt)?(At=this.eventsAfterPerObject.get(gt))==null||At.push(Gt):this.eventsAfterPerObject.set(gt,[Gt])),Gt.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(gt)?(Rt=this.eventsAfterPerObject.get(gt))==null||Rt.push(Gt):this.eventsAfterPerObject.set(gt,[Gt])),Gt.actions.Particles.length&&(this.eventsAfterPerObject.has(gt)?(Ft=this.eventsAfterPerObject.get(gt))==null||Ft.push(Gt):this.eventsAfterPerObject.set(gt,[Gt]))}};if(st.traverseEntity(gt=>{var _t;(gt instanceof Er||gt instanceof cr)&&((_t=gt.frame)==null||_t.traverse(Et=>{mt(Et)})),mt(gt)}),[...this.eventsAfterPerObject.values()].some(gt=>gt.length)){if(this.eventManager.activateCount===0){let{domElement:gt,isExport:_t}=this.eventContext,Et=_t?document:gt;Et.addEventListener("pointerdown",this.onMouseDown,{once:!0}),Et.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),Et.addEventListener("pointerdown",this.onAny),Et.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([At,Rt])=>{At.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([gt,_t])=>{gt.dispatchEvent({type:"beginEvent",eventName:"Start"}),_t.forEach(Et=>Et.dispatch()),gt.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(nt=>nt.length)){let{domElement:nt,isExport:st}=this.eventContext,mt=st?document:nt;mt.removeEventListener("pointerdown",this.onMouseDown),mt.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),mt.removeEventListener("pointerdown",this.onAny),mt.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([gt,_t])=>{gt.removeEventListener("userEvent",this.onUserEvent),_t.forEach(Et=>Et.disconnect())})}[...this.eventsPerObject.entries()].forEach(([nt,st])=>{nt.removeEventListener("userEvent",this.onUserEvent),st.forEach(mt=>mt.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},Ob=class{constructor(nt,st,mt,gt,_t,Et){this.id=nt,this.data=st,this.object=mt,this.initialDisabled=!1,this.actions=Kt$1(st,st.actions,gt,_t,Et,mt),this.target=st.target}disconnect(){ur(this.actions)}dispatch(nt){this.initialDisabled||(this.actions.Transition.forEach(st=>{st.object.currentTransitionEvent!==this&&(st.object.currentTransitionEvent=this,st.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.actions.Transition.forEach(st=>{st.data.runMode==="Toggle"?st.toggle():st.play()}),this.actions.Animation.forEach(st=>{st.data.runMode==="Toggle"?st.toggle():st.play()}),this.actions.Reset.forEach(st=>{st.dispatch()}),this.actions.Link.forEach(st=>{st.dispatch()}),this.actions.Reset.forEach(st=>{st.dispatch()}),this.actions.Create.forEach(st=>{st.dispatch()}),this.actions.Destroy.forEach(st=>{st.dispatch(nt??!1)}),this.actions.SetVariable.forEach(st=>st.checkConditions()),this.actions.SetVariable.forEach(st=>st.dispatch()),this.actions.DynamicVariablePlay.forEach(st=>st.dispatch()),this.actions.Audio.forEach(st=>{st.dispatchBasic()}),this.actions.Particles.forEach(st=>{st.dispatchBasic()}),this.actions.Video.forEach(st=>{st.dispatchBasic()}),this.actions.ClearLocalStorage.forEach(st=>st.dispatch()),this.actions.UserAPI.forEach(st=>st.dispatch()))}},Rb=class extends hr{constructor(nt,st,mt,gt,_t){super(nt),this.sharedVariables=st,this.eventManager=mt,this.needsMouse=gt,this.needsRaycast=_t,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.isOutOfFocus=!1,this.events=[],this.onFrame=Et=>{let At=this.eventContext.sharedAssets;if(this.rafId=window.requestAnimationFrame(this.onFrame),this.isOutOfFocus)return;let Rt=new Date,Ft=[],Nt=[];for(let dr=0;dr<this.propertiesToWatch.length;dr++){let{objectId:Mr,property:Tr,prevValue:zr}=this.propertiesToWatch[dr],Fr=this.eventContext.scene.find(Mr),Nr=Dv.propertyPaths[Tr];if(Nr[0]==="width"||Nr[0]==="height"||Nr[0]==="depth")Fr=Fr.geometry.userData.parameters[Nr[0]];else for(let tn=0;tn<Nr.length;tn++)Fr=Fr[Nr[tn]];zr===null?this.propertiesToWatch[dr].prevValue=Fr instanceof E$6?Fr.clone():Fr:(Fr instanceof E$6?!Fr.equals(zr):zr!==Fr)&&(Nt.push({objId:Mr,property:Tr}),Fr instanceof E$6?this.propertiesToWatch[dr].prevValue.copy(Fr):this.propertiesToWatch[dr].prevValue=Fr)}for(let dr=0;dr<this.variablesToWatch.length;dr++){let{id:Mr,prevValue:Tr}=this.variablesToWatch[dr],zr=At.getVariable(Mr);zr!==Tr&&(Ft.push(Mr),this.variablesToWatch[dr].prevValue=zr)}for(let dr=0;dr<this.dynamicVars.length;dr++){let{id:Mr,expectedTime:Tr,last:zr,data:Fr,timerSeconds:Nr,startValue:tn}=this.dynamicVars[dr],rn=1e3;if((Fr.dynamicVariableType==="timer"||Fr.dynamicVariableType==="stopwatch")&&Fr.format==="number3decimal"?rn=1:Fr.dynamicVariableType==="counter"?rn=Fr.updateInterval:Fr.dynamicVariableType==="random"&&(rn=Fr.isStatic?1/0:Fr.updateInterval),Tr===-1){this.dynamicVars[dr].last=Et,this.dynamicVars[dr].expectedTime=Et+rn;continue}if(!((At.getDynamicVariablePlayState(Mr)==="Stopped"||At.getDynamicVariablePlayState(Mr)==="Restarted")&&(this.dynamicVars[dr].last=Et,this.dynamicVars[dr].expectedTime=Et+rn,Fr.dynamicVariableType==="counter"&&At.getVariable(Mr)!==tn&&(At.updateVariable(Mr,tn),this.eventManager.requestRender()),(Fr.dynamicVariableType==="timer"||Fr.dynamicVariableType==="stopwatch")&&this.dynamicVars[dr].timerSeconds!==tn&&(this.dynamicVars[dr].timerSeconds=tn,At.updateVariable(Mr,vn.getFormattedTimerTime(tn,Fr)),this.eventManager.requestRender()),At.getDynamicVariablePlayState(Mr)==="Restarted"&&At.setDynamicVariablePlayState(Mr,"Playing"),At.getDynamicVariablePlayState(Mr)==="Stopped"))){if(At.getDynamicVariablePlayState(Mr)==="Paused"){this.dynamicVars[dr].deltaToExpectedTime===void 0&&(this.dynamicVars[dr].deltaToExpectedTime=Math.max(this.dynamicVars[dr].expectedTime-Et,0)),this.dynamicVars[dr].last=Et-(rn-this.dynamicVars[dr].deltaToExpectedTime),this.dynamicVars[dr].expectedTime=Et+this.dynamicVars[dr].deltaToExpectedTime;continue}else this.dynamicVars[dr].deltaToExpectedTime=void 0;if(Et>=Tr)if(this.dynamicVars[dr].last=Et,this.dynamicVars[dr].expectedTime+=rn,Fr.dynamicVariableType==="random"){let Tn=Fr.min+Math.random()*(Fr.max-Fr.min),$n=Fr.decimals;Tn=Math.round(Tn*Math.pow(10,$n))/Math.pow(10,$n),At.updateVariable(Mr,Tn),Ft.push(Mr),this.eventManager.requestRender()}else if(Fr.dynamicVariableType==="counter"){let Tn=At.getVariable(Mr),$n=At.getDynamicVariableToggleIsForward(Mr)??!0,un=At.getVariable(Mr)+Fr.increment*($n?1:-1);Fr.hasEnd&&(un=Fr.increment>0?we$1.clamp(un,tn,Fr.endValue):we$1.clamp(un,Fr.endValue,tn),un===tn&&At.setDynamicVariableToggleIsForward(Mr,void 0),Fr.repeat?un===Fr.endValue&&(un=tn):(un===tn||un===Fr.endValue)&&At.setDynamicVariablePlayState(Mr,"Paused")),un!==Tn&&(Ft.push(Mr),At.updateVariable(Mr,un),this.eventManager.requestRender())}else if(Fr.dynamicVariableType==="time"){let Tn=At.getVariable(Mr),$n=dE(Rt,Fr);if(typeof Tn=="object"&&"textValue"in Tn&&typeof $n=="object"&&"textValue"in $n){if(Array.isArray(Tn.textValue)&&Array.isArray($n.textValue)){if(Tn.textValue.every((un,es)=>un===$n.textValue[es]))continue}else if(Tn.textValue===$n.textValue)continue}else if(Tn===$n)continue;At.updateVariable(Mr,$n),Ft.push(Mr),this.eventManager.requestRender()}else{let Tn=Lr.isTextValue(Fr.endValue)?CN(Fr.endValue.textValue):Fr.endValue,$n=At.getDynamicVariableToggleIsForward(Mr)??!0,un=Nr+(Et-zr)/1e3*(Fr.dynamicVariableType==="timer"?-1:1)*($n?1:-1);un=Math.max(un,0),Fr.hasEnd&&(un=Fr.dynamicVariableType==="stopwatch"?we$1.clamp(un,tn,Tn):we$1.clamp(un,Tn,tn),un===tn&&At.setDynamicVariableToggleIsForward(Mr,void 0),Fr.repeat?Math.abs(un-Tn)<(Fr.format==="number3decimal"?1e-4:.1)&&(un=tn):(Math.abs(un-tn)<(Fr.format==="number3decimal"?1e-4:.1)||Math.abs(un-Tn)<(Fr.format==="number3decimal"?1e-4:.1))&&At.setDynamicVariablePlayState(Mr,"Paused")),un!==Nr&&(Ft.push(Mr),this.dynamicVars[dr].timerSeconds=un,At.updateVariable(Mr,vn.getFormattedTimerTime(un,Fr)),this.eventManager.requestRender())}}}let Bt=!1;At.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=At.mouseProperty,Bt=!0);let Gt=!1;At.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=At.raycastProperty,Gt=!0),this.events.forEach(dr=>{(Ft.includes(dr.data.variableId)||Nt.find(Mr=>Mr.objId===dr.data.objectId&&Mr.property===dr.data.property)||dr.data.variableId==="mouseProperty"&&Bt||dr.data.variableId==="raycastProperty"&&Gt)&&(dr.dispatch(),this.eventManager.requestRender())})},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()}}pause(){this.isOutOfFocus||(this.isOutOfFocus=!0,this.pauseTime=Date.now())}resume(){if(!this.isOutOfFocus)return;this.isOutOfFocus=!1;let nt=Date.now()-this.pauseTime;for(let st=0;st<this.dynamicVars.length;st++)this.dynamicVars[st].last+=nt,this.dynamicVars[st].expectedTime+=nt}connect(){this.eventContext.page.traverseEntity(st=>{var mt;(mt=st.data)==null||mt.events.filter(gt=>gt.data.type==="VariableChange"&&!gt.data.disabled).forEach(gt=>{this.events.push(new QM(gt.id,gt.data,st,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.propertiesToWatch=this.events.filter(st=>st.data.variableId==="objectProperty"&&st.data.objectId!==null).map(st=>({objectId:st.data.objectId,property:st.data.property,prevValue:null}));let nt=this.eventContext.sharedAssets;this.sharedVariables.forEach(({id:st,data:mt})=>{if(!("dynamicVariableType"in mt)){this.events.find(_t=>_t.data.variableId===st)&&this.variablesToWatch.push({id:st,prevValue:nt.getVariable(st)});return}let gt;if(mt.dynamicVariableType==="timer"||mt.dynamicVariableType==="stopwatch"){let _t;if(Lr.isTextValue(mt.value)&&Array.isArray(mt.value.textValue)){let Et=mt.value.textValue;Et.length===3?_t=Et[2]+Et[1]*60+Et[0]*3600:_t=Et[1]+Et[0]*60}else _t=mt.value;gt=_t,this.dynamicVars.push({id:st,last:-1,expectedTime:-1,data:mt,timerSeconds:_t,startValue:gt})}else mt.dynamicVariableType==="time"&&nt.updateVariable(st,dE(new Date,mt)),mt.dynamicVariableType==="counter"&&(gt=Lr.isTextValue(mt.value)?CN(mt.value.textValue):mt.value),this.dynamicVars.push({id:st,last:-1,expectedTime:-1,data:mt,startValue:gt})}),this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach(nt=>nt.dispose())}},QM=class{constructor(nt,st,mt,gt,_t,Et){this.id=nt,this.data=st,this.object=mt,this.actions=Kt$1(st,st.actions,gt,_t,Et,mt)}dispatch(){let nt=this.actions;nt.Audio.forEach(st=>st.dispatchConditional()),nt.Particles.forEach(st=>st.dispatchConditional()),nt.Video.forEach(st=>st.dispatchConditional()),nt.Create.forEach(st=>st.dispatch()),nt.Destroy.forEach(st=>st.dispatch()),nt.Reset.forEach(st=>st.dispatch()),nt.Transition.forEach(st=>{st.object.currentTransitionEvent!==this&&(st.object.currentTransitionEvent=this),st.init()}),nt.Transition.forEach(st=>st.play()),nt.Animation.forEach(st=>st.play()),nt.SwitchCamera.forEach(st=>st.play()),nt.SceneTransition.forEach(st=>st.dispatch()),nt.SetVariable.forEach(st=>st.checkConditions()),nt.SetVariable.forEach(st=>st.dispatch()),nt.DynamicVariablePlay.forEach(st=>st.dispatch()),nt.ClearLocalStorage.forEach(st=>st.dispatch()),nt.UserAPI.forEach(st=>st.dispatch())}dispose(){ur(this.actions)}};function CN(nt){return nt.length===3?nt[2]+nt[1]*60+nt[0]*3600:nt[1]+nt[0]*60}var _N="https://unpkg.com/@splinetool/runtime@1.9.30/build/",OJ="https://unpkg.com/@splinetool/navmesh-wasm@1.9.30/build/",RJ=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${_N}' + 'navmesh.js'),
		fetch('${OJ}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,LJ=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,BJ=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,PN=.001,NJ={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},DN,Ot,en;Q2.then(nt=>{DN=nt,Ot=new nt.Vec3,en=new nt.Vec3});var FJ=new E$6,Lb=class{constructor(nt=!1,st=!1){this.usePhysics=nt,this.isExport=st,this.onPointerDown=mt=>{if(Je$1.length!==1)return;let{raycaster:gt,page:_t}=this.eventContext;this.eventContext.updateRaycaster(mt);let Et=_t.raycastWithClones(gt);if(Et.length!==0){if(this.gameControl){let At=FJ.copy(this.gameControl.colliderWorldPosition);At.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(At,Et[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(mt,gt)=>_t=>{var dr,Mr,Tr,zr,Fr,Nr,tn;let Et;if(_t instanceof Gi)if(_t.objectForSample){if(_t.objectForSample.dataPatched.physics.fusedBody)return;Et=_t.object}else return _t.object.dataPatched.physics.fusedBody===!0&&_t.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(_t instanceof Br)Et=_t.object;else if(Et=_t,((dr=Et.dataPatched.cloner)==null?void 0:dr.disabled)===!1&&((Mr=Et.dataPatched.cloner)==null?void 0:Mr.hideBase)&&((Tr=Et.dataPatched.physics)==null?void 0:Tr.fusedBody)!==!0)return!0;if(gt&&!Et.userData.navmesh)return;let At=Et.dataPatched;if(!At.visible&&((zr=At.physics)==null?void 0:zr.enabled)!==!0)return!0;_t.updateMatrixWorldSVD();let Rt=fg(At),Ft=Et.userData.hasDestroy,Nt=Et.userData.hasDrag,Bt=!1,Gt=!1;for(let rn of At.events)rn.data.disabled!==!0&&(rn.data.type==="GameControl"?Bt=!0:rn.data.type==="Follow"&&(Gt=!0));if(Bt||Rt||Gt||Ft||Nt)return!0;if(this.usePhysics&&((Fr=At.physics)==null?void 0:Fr.rigidBody)==="dynamic"){if(this.usePhysics&&((Nr=At.physics)!=null&&Nr.fusedBody))return!0}else if("geometry"in _t&&_t.geometry&&mt.push(io(_t.geometry,_t.matrixWorld)),this.usePhysics&&((tn=At.physics)==null?void 0:tn.fusedBody))return _t.traverseObject((rn,Tn)=>{var es,kn;if(Tn===0)return;let $n;if(rn instanceof Gi)if(rn.objectForSample){if(rn.objectForSample.dataPatched.physics.fusedBody)return;$n=rn.object}else return rn.object.dataPatched.physics.fusedBody===!0&&rn.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(rn instanceof Br)$n=rn.object;else if($n=rn,(es=rn.dataPatched.cloner)==null?void 0:es.hideBase)return!0;let un=$n.dataPatched;if(!un.visible&&((kn=un.physics)==null?void 0:kn.enabled)!==!0)return!0;"geometry"in rn&&rn.geometry&&mt.push(io(rn.geometry,rn.matrixWorld))}),!0},this.traverseNoPhysics=(mt,gt)=>_t=>{let Et;if(_t instanceof Gi)return;_t instanceof Br?Et=_t.object:Et=_t;let At=Et.dataPatched;if(At.physics.enabled==="visibility"?!At.visible:!At.physics.enabled)return!0;if(gt&&!Et.userData.navmesh)return;let Rt=_t.geometry,Ft=Et.userData.hasDestroy===!0,Nt=Et.userData.hasDrag===!0;if(fg(At)||Ft||Nt||Et.dataPatched.events.some(Bt=>Bt.data.disabled!==!0&&Bt.data.type==="GameControl"))return!0;Rt&&mt.push(io(Rt,_t.matrixWorld))},this.navmeshWasm=DN,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(st?RJ:LJ)+BJ])),this._worker=new Worker(this._workerURL)}init(nt,st,mt){this.gameControl=st,this.eventContext=mt,this.setDefaultQueryExtent(new E$6().setScalar(nt.ch*nt.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(mt.page,nt,gt=>{this.buildFromNavmeshData(gt.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(nt,st,mt){st.objects.forEach(Ft=>{var Bt;let Nt=nt.scene.find(Ft);Nt.traverseEntity(Gt=>{Gt.userData.navmesh=!0}),(Bt=Nt.cloner)==null||Bt.traverseObject(Gt=>{Gt.userData.navmesh=!0})});let gt=[],_t=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(gt,st.zones==="custom");if(nt.traverseChildren(_t),st.objects.forEach(Ft=>{var Bt;let Nt=nt.scene.find(Ft);Nt.traverseEntity(Gt=>{Gt.userData.navmesh=void 0}),(Bt=Nt.cloner)==null||Bt.traverseObject(Gt=>{Gt.userData.navmesh=void 0})}),gt.length===0)return!1;let Et=ks(gt),{positions:At,triIndices:Rt}=Uc(Et.getAttribute("position"),Et.getIndex());return this._worker.postMessage([At,At.length/3,Rt,Rt.length,{...NJ,...st}]),this._worker.onmessage=mt,!0}createDebugNavGeometry(){let nt,st,mt=this.navMesh.getDebugNavMesh(),gt=mt.getTriangleCount(),_t=new Uint32Array(gt*3),Et=new Float32Array(gt*3*3);for(nt=0;nt<gt*3;nt++)_t[nt]=nt;for(nt=0;nt<gt;nt++)for(st=0;st<3;st++){let Rt=mt.getTriangle(nt).getPoint(st);Et[nt*9+st*3+0]=Rt.x,Et[nt*9+st*3+1]=Rt.y,Et[nt*9+st*3+2]=Rt.z}let At=new _e$1;return At.setIndex(new Xe$1(_t,1)),At.setAttribute("position",new Xe$1(Et,3)),At}getClosestPoint(nt){return Ot.x=nt.x,Ot.y=nt.y,Ot.z=nt.z,this.navMesh.getClosestPoint(Ot)}getClosestPointToRef(nt,st){Ot.x=nt.x,Ot.y=nt.y,Ot.z=nt.z;let mt=this.navMesh.getClosestPoint(Ot);st.set(mt.x,mt.y,mt.z)}getRandomPointAround(nt,st){return Ot.x=nt.x,Ot.y=nt.y,Ot.z=nt.z,this.navMesh.getRandomPointAround(Ot,st)}getRandomPointAroundToRef(nt,st,mt){Ot.x=nt.x,Ot.y=nt.y,Ot.z=nt.z;let gt=this.navMesh.getRandomPointAround(Ot,st);mt.set(gt.x,gt.y,gt.z)}moveAlong(nt,st){return Ot.x=nt.x,Ot.y=nt.y,Ot.z=nt.z,en.x=st.x,en.y=st.y,en.z=st.z,this.navMesh.moveAlong(Ot,en)}moveAlongToRef(nt,st,mt){return Ot.x=nt.x,Ot.y=nt.y,Ot.z=nt.z,en.x=st.x,en.y=st.y,en.z=st.z,this.navMesh.moveAlong(Ot,en)}computePath(nt,st){let mt=this.getClosestPoint(st);if(en.x=mt.x,en.y=mt.y,en.z=mt.z,Math.sqrt(Math.pow(st.x-mt.x,2)+Math.pow(st.y-mt.y,2)+Math.pow(st.z-mt.z,2))>this.getDefaultQueryExtent().y)return[];this.getClosestPoint(nt);let gt=this.navMesh.computePath(Ot,en),_t=gt.getPointCount(),Et=[];for(let At=0;At<_t;At++){let Rt=gt.getPoint(At);Et.push(new E$6(Rt.x,Rt.y,Rt.z))}return Et}createCrowd(nt,st){return new KM(this,nt,st)}setDefaultQueryExtent(nt){Ot.x=nt.x,Ot.y=nt.y,Ot.z=nt.z,this.navMesh.setDefaultQueryExtent(Ot)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(nt){let st=nt.length*nt.BYTES_PER_ELEMENT,mt=this.navmeshWasm._malloc(st),gt=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,mt,st);gt.set(nt);let _t=new this.navmeshWasm.NavmeshData;_t.dataPointer=gt.byteOffset,_t.size=nt.length,this.navMesh.buildFromNavmeshData(_t),this.navmeshWasm._free(gt.byteOffset)}getNavmeshData(){let nt=this.navMesh.getNavmeshData(),st=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,nt.dataPointer,nt.size),mt=new Uint8Array(nt.size);return mt.set(st),this.navMesh.freeNavmeshData(nt),mt}getDefaultQueryExtentToRef(nt){let st=this.navMesh.getDefaultQueryExtent();nt.set(st.x,st.y,st.z)}dispose(){var nt;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(nt=this.eventContext)==null||nt.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(nt,st,mt){return Ot.x=nt.x,Ot.y=nt.y,Ot.z=nt.z,this.navMesh.addCylinderObstacle(Ot,st,mt)}addBoxObstacle(nt,st,mt){return Ot.x=nt.x,Ot.y=nt.y,Ot.z=nt.z,en.x=st.x,en.y=st.y,en.z=st.z,this.navMesh.addBoxObstacle(Ot,en,mt)}removeObstacle(nt){this.navMesh.removeObstacle(nt)}isSupported(){return this.navmeshWasm!==void 0}},KM=class{constructor(nt,st,mt){this.navmeshWasmWrapper=nt,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(st,mt,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(nt,st){}addAgent(nt,st,mt){let gt=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;gt.radius=st.radius,gt.height=st.height,gt.maxAcceleration=st.maxAcceleration,gt.maxSpeed=st.maxSpeed,gt.collisionQueryRange=st.collisionQueryRange,gt.pathOptimizationRange=st.pathOptimizationRange,gt.separationWeight=st.separationWeight,gt.updateFlags=7,gt.obstacleAvoidanceType=0,gt.queryFilterType=0,gt.userData=0;let _t=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(nt.x,nt.y,nt.z),gt);return this.transforms.push(mt),this.agents.push(_t),this.reachRadii.push(st.reachRadius?st.reachRadius:st.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new E$6(0,0,0)),_t}getAgentPosition(nt){return this.crowd.getAgentPosition(nt)}getAgentPositionToRef(nt,st){let mt=this.crowd.getAgentPosition(nt);st.set(mt.x,mt.y,mt.z)}getAgentVelocity(nt){return this.crowd.getAgentVelocity(nt)}getAgentVelocityToRef(nt,st){let mt=this.crowd.getAgentVelocity(nt);st.set(mt.x,mt.y,mt.z)}getAgentNextTargetPath(nt){return this.crowd.getAgentNextTargetPath(nt)}getAgentNextTargetPathToRef(nt,st){let mt=this.crowd.getAgentNextTargetPath(nt);st.set(mt.x,mt.y,mt.z)}getAgentState(nt){return this.crowd.getAgentState(nt)}overOffmeshConnection(nt){return this.crowd.overOffmeshConnection(nt)}agentGoto(nt,st){this.crowd.agentGoto(nt,new this.navmeshWasmWrapper.navmeshWasm.Vec3(st.x,st.y,st.z));let mt=this.agents.indexOf(nt);mt>-1&&(this._agentDestinationArmed[mt]=!0,this._agentDestination[mt].set(st.x,st.y,st.z))}agentTeleport(nt,st){this.crowd.agentTeleport(nt,new this.navmeshWasmWrapper.navmeshWasm.Vec3(st.x,st.y,st.z))}updateAgentParameters(nt,st){let mt=this.crowd.getAgentParameters(nt);st.radius!==void 0&&(mt.radius=st.radius),st.height!==void 0&&(mt.height=st.height),st.maxAcceleration!==void 0&&(mt.maxAcceleration=st.maxAcceleration),st.maxSpeed!==void 0&&(mt.maxSpeed=st.maxSpeed),st.collisionQueryRange!==void 0&&(mt.collisionQueryRange=st.collisionQueryRange),st.pathOptimizationRange!==void 0&&(mt.pathOptimizationRange=st.pathOptimizationRange),st.separationWeight!==void 0&&(mt.separationWeight=st.separationWeight),this.crowd.setAgentParameters(nt,mt)}removeAgent(nt){this.crowd.removeAgent(nt);let st=this.agents.indexOf(nt);st>-1&&(this.agents.splice(st,1),this.transforms.splice(st,1),this.reachRadii.splice(st,1),this._agentDestinationArmed.splice(st,1),this._agentDestination.splice(st,1))}getAgents(){return this.agents}update(nt){if(this.navmeshWasmWrapper.navMesh.update(),nt<=PN)return;let st=1/60,mt=10;{let gt=Math.floor(nt/st);gt>mt&&(gt=mt),gt<1&&(gt=1);let _t=nt/gt;for(let Et=0;Et<gt;Et++)this.crowd.update(_t)}for(let gt=0;gt<this.agents.length;gt++){let _t=this.agents[gt],Et=this.getAgentPosition(_t);if(this.transforms[gt].copy(Et),this._agentDestinationArmed[gt]){let At=Et.x-this._agentDestination[gt].x,Rt=Et.z-this._agentDestination[gt].z,Ft=this.reachRadii[gt],Nt=this._agentDestination[gt].y-this.reachRadii[gt],Bt=this._agentDestination[gt].y+this.reachRadii[gt],Gt=At*At+Rt*Rt;Et.y>Nt&&Et.y<Bt&&Gt<Ft*Ft&&(this.onReachTarget(_t,this._agentDestination[gt]),this._agentDestinationArmed[gt]=!1)}}}setDefaultQueryExtent(nt){let st=new this.navmeshWasmWrapper.navmeshWasm.Vec3(nt.x,nt.y,nt.z);this.crowd.setDefaultQueryExtent(st)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(nt){let st=this.crowd.getDefaultQueryExtent();nt.set(st.x,st.y,st.z)}getCorners(nt){let st,mt=this.crowd.getCorners(nt),gt=mt.getPointCount(),_t=[];for(st=0;st<gt;st++){let Et=mt.getPoint(st);_t.push(new E$6(Et.x,Et.y,Et.z))}return _t}dispose(){this.crowd.destroy()}};function ZM(nt){let st=!1;return nt.scene.objects.forEach(mt=>{mt.data.type==="Page"&&!st&&mt.data.publish.gameControlObject&&El.traverseModuleInstances(nt,mt.id,(gt,_t,Et)=>{for(let At of Et)At.data.type==="GameControl"&&At.data.navmesh.enabled&&(st=!0)})}),st}var VJ={type:"change"},IN={type:"changeZoom"},UJ={type:"changePan"},ou={type:"start"},au={type:"end",changed:!0},zJ={type:"end",changed:!1},JM=new Qe$1,ON=new U$1,kJ=2*Math.PI,GJ=1e-8,jJ=.01,$M=new E$6,Bb=new U$1,eT=new E$6,Nb=new Qe$1,RN=new ue$1,HJ={type:"requestRender"},zf=class extends pr{constructor(nt,st,mt={isPlayMode:!1,isExport:!1}){super(),this.object=nt,this.domElement=st,this.options=mt,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Xn.DOLLY_ROTATE,Xn.PAN],this.offset=new E$6,this.eye=new E$6,this.lastPosition=new E$6,this.lastQuaternion=new Qe$1,this.current=new U$1,this.overShoot=new U$1,this.overRatio=new U$1,this.spherical=new bp,this.sphericalDelta=new bp,this.panOffset=new E$6,this.panLeftV=new E$6,this.panUpV=new E$6,this.panV=new E$6,this.rotateStart=new U$1,this.rotateEnd=new U$1,this.rotateDelta=new U$1,this.panStart=new U$1,this.panEnd=new U$1,this.panDelta=new U$1,this.dollyStart=new U$1,this.dollyEnd=new U$1,this.dollyDelta=new U$1,this.rotationRangeFactor=new U$1,this.panRangeFactor=new U$1,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=gt=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=gt.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(eT,Nb,$M),this.offset.copy(eT).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&this.object.isPerspectiveCamera&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(JM.copy(Nb).invert()),this.panOffset.applyQuaternion(JM),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(Nb),this.panOffset.applyQuaternion(Nb)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),eT.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(RN.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(RN));let gt=this.spherical.phi%kJ;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(Mt.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),gt>0&&gt>Math.PI||gt<0&&gt>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0){let _t=this.hoverRotatePanMode===1?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-_t,this.sphericalDelta.phi*=1-_t}else this.sphericalDelta.set(0,0,0);return this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>jJ||8*(1-this.lastQuaternion.dot(this.object.quaternion))>GJ?(this.dispatchEvent(VJ),this.object.dispatchEvent(HJ),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=gt=>{this.enabled!==!1&&(gt.pointerType==="touch"||gt.pointerType==="pen"&&Ci?this.onPointerDownTouch(gt):this.onPointerDownMouse(gt),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(ou),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),gt.stopPropagation(),gt.pointerType==="touch"||gt.pointerType==="pen"&&Ci||this.domElement.setPointerCapture(gt.pointerId)))},this.onPointerLeave=gt=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,$M.subVectors(this.position0,this.target0),this.spherical.setFromVector3($M),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=gt},this.onPointerEnter=gt=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?Bb.set(gt.clientX-this.domElement.clientWidth/2,gt.clientY-this.domElement.clientHeight/2):Bb.set(gt.clientX-this.pointerLeaveEvent.clientX,gt.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(Bb).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(ON,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(gt.clientX,gt.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(Bb).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(gt.clientX,gt.clientY)),this.update()},this.onPointerMove=gt=>{this.enabled!==!1&&(this.checkRaycastLock()||(gt.pointerType==="touch"||gt.pointerType==="pen"&&Ci?this.onPointerMoveTouch(gt):this.onPointerMoveMouse(gt),gt.stopPropagation()))},this.onPointerUp=gt=>{this.isPointerDown=!1,Je$1.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),Je$1.length>1&&gt.preventDefault(),this.hasChange?this.dispatchEvent(au):this.dispatchEvent(zJ),this.state=-1,gt&&(gt.stopPropagation(),gt.pointerType==="touch"||gt.pointerType==="pen"&&Ci||this.domElement.releasePointerCapture(gt.pointerId))},this.onPointerDownMouse=gt=>{let _t;switch(this.useKeyEvents?_t=this.mouseButtons[gt.button]:_t=this.mouseButtonsPlay[gt.button],_t){case 0:if(gt.altKey===!0&&!gt.shiftKey&&!Ip(gt)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(gt),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(gt),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(gt),this.state=2;break;case 3:if(Ip(gt)||gt.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(gt),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(gt),this.state=0}break;case 5:if(Ip(gt)||gt.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(gt),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(gt),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=gt=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(gt);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(gt);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(gt);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=gt=>{switch(Je$1.length>1&&gt.preventDefault(),this.touches[Je$1.length-1]){case Xn.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case Xn.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case Xn.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case Xn.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=gt=>{switch(Je$1.length>1&&gt.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(gt),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(gt),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(gt),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(gt),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=Tc(()=>this.dispatchEvent(au),33),this.onMouseWheel=gt=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&gt.preventDefault(),this.dispatchEvent(ou),this.handleMouseWheel(gt),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=gt=>{if(gt.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!go)if(gt.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(ou),gt.scale>this.prevScale?this.dollyIn(this.getZoomScale()):gt.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=gt.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(au)},this.onContextMenu=gt=>{gt.preventDefault()},this.onTouchEnd=gt=>{gt.preventDefault()},this.onKeyDown=gt=>{this.enabled!==!1&&(this.key=gt.key,gt.key===" "&&this.dispatchEvent(ou))},this.onKeyUp=gt=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&gt.key==="Alt"&&this.onPointerUp(Je$1[0]),gt.key===" "&&this.dispatchEvent(au))},this.onPointerHover=gt=>{gt.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(gt,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(gt,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=gt=>{gt.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.initialSphericalRadius=this.spherical.radius,this.addEventListenersToCamera()}dispatchEvent(nt){nt.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(nt)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(nt){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=nt,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let st=this.useWindowEvents?window:this.domElement;st.addEventListener("pointerleave",this.onPointerLeave),st.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(nt,st){this.setEnableDampingSpeed(nt.enableDamping),this.enablePan=nt.enablePan,this.enableZoom=nt.enableZoom,this.enableRotate=nt.enableRotate,this.rotationLimitsMode=nt.rotationLimitsMode,this.thetaIsFree=nt.rotationHorizontalOffset.min===nt.rotationHorizontalOffset.max&&nt.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=nt.rotationVerticalOffset.min===nt.rotationVerticalOffset.max&&nt.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=nt.panLimitsMode,this.panSoftLimit=nt.panSoftLimit,this.rotationSoftLimit=nt.rotationSoftLimit,this.hoverRotatePanMode=nt.hoverRotatePanMode,this.hoverRotateDamping=nt.hoverRotateDamping??this.dampingFactor,this.useWindowEvents=st==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let mt=nt.hoverRotatePanStrength/100;this.hoverRotatePanStrength=mt**2,this.zoomLimitsEnabled=nt.zoomLimitsEnabled,this.minZoom=nt.zoomLimits.min,this.maxZoom=Math.max(nt.zoomLimits.min,nt.zoomLimits.max),this.minDistance=1e3/nt.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/nt.zoomLimits.min),this.autoRotate=nt.autoRotate,this.autoRotateSpeed=nt.autoRotateSpeed,this.autoRotateClockwise=nt.autoRotateClockwise;let gt=this.object.getTarget().applyQuaternion(JM.copy(this.object.quaternion).invert());this.minV=-nt.panVerticalOffset.min+gt.y,this.maxV=nt.panVerticalOffset.max+gt.y,this.minH=-nt.panHorizontalOffset.min+gt.x,this.maxH=nt.panHorizontalOffset.max+gt.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=Qo(this.spherical.phi-nt.rotationVerticalOffset.min),this.maxPhi=Qo(this.spherical.phi+nt.rotationVerticalOffset.max),this.minTheta=Qo(Qo(this.spherical.theta)-nt.rotationHorizontalOffset.min),this.maxTheta=Qo(Qo(this.spherical.theta)+nt.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,nt.orbitTouches===1&&(this.touches[0]=Xn.ROTATE),nt.panTouches===1&&(this.touches[0]=Xn.PAN),nt.orbitTouches===2&&(this.touches[1]=Xn.DOLLY_ROTATE),nt.panTouches===2&&(this.touches[1]=Xn.DOLLY_PAN),nt.orbitTouches===3&&(this.touches[2]=Xn.ROTATE),nt.panTouches===3&&(this.touches[2]=Xn.PAN),this.isTouchZoom=nt.isTouchZoom,this.resetHoverEffectOnPointerLeave=nt.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let nt=this.useWindowEvents?window:this.domElement;nt.addEventListener("pointerleave",this.onPointerLeave),nt.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(nt,st,mt,gt,_t,Et,At,Rt){this.overShoot.set(0,0);let Ft,Nt,Bt;nt instanceof E$6?(Ft=nt.x,Nt=nt.y,this.current.set(this.target.x,this.target.y),Bt=!0):(Ft=nt.theta,Nt=nt.phi,this.current.set(Qo(this.spherical.theta),Qo(this.spherical.phi)),Bt=!1),mt===0&&(this.current.x+=Ft,this.current.y+=Nt),(st===3||st===2)&&(!Bt&&this.isThetaFlipped?this.current.x>gt&&this.current.x<0?this.overShoot.x=gt-this.current.x:this.current.x<_t&&this.current.x>0&&(this.overShoot.x=_t-this.current.x):this.current.x>gt?this.overShoot.x=gt-this.current.x:this.current.x<_t&&(this.overShoot.x=_t-this.current.x)),(st===3||st===1)&&(this.current.y>Et?this.overShoot.y=Et-this.current.y:this.current.y<At&&(this.overShoot.y=At-this.current.y)),Bt||(this.overShoot.x=Qo(this.overShoot.x),this.overShoot.y=Qo(this.overShoot.y)),mt!==0?(this.overRatio.copy(this.overShoot).divide(Rt),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),mt===1&&(this.overRatio.x=LN(Math.abs(this.overRatio.x)),this.overRatio.y=LN(Math.abs(this.overRatio.y))),this.isPointerDown||mt===1?mt===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(Ft*this.overShoot.x<0&&!this.thetaIsFree&&(Ft*=1-this.overRatio.x),Nt*this.overShoot.y<0&&!this.phiIsFree&&(Nt*=1-this.overRatio.y)):mt===2&&(!Bt&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||Bt&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(Ft=this.overShoot.x*.05),this.phiIsFree||(Nt=this.overShoot.y*.05),Bt?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):Bt?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(Ft+=this.overShoot.x,Nt+=this.overShoot.y),nt instanceof E$6?(nt.x=Ft,nt.y=Nt):(this.thetaIsFree||(nt.theta=Ft),this.phiIsFree||(nt.phi=Nt))}setEnableDampingSpeed(nt){this.enableDamping=nt,this.rotateSpeed=nt===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(nt){this.sphericalDelta.theta-=nt}rotateUp(nt){this.sphericalDelta.phi-=nt}panLeft(nt,st){this.panLeftV.setFromMatrixColumn(st,0),this.panLeftV.multiplyScalar(-nt),this.panOffset.add(this.panLeftV)}panUp(nt,st){this.panUpV.setFromMatrixColumn(st,1),this.panUpV.multiplyScalar(nt),this.panOffset.add(this.panUpV)}pan(nt,st){let mt=this.domElement;if(mt&&this.object.isPerspectiveCamera){let gt=this.object.position;this.panV.copy(gt).sub(this.target);let _t=this.panV.length();_t*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*nt*_t/mt.clientHeight,this.object.matrixWorld),this.panUp(2*st*_t/mt.clientHeight,this.object.matrixWorld)}else mt&&this.object.isOrthographicCamera&&(this.panLeft(nt*(this.object.right-this.object.left)/this.object.zoom/mt.clientWidth,this.object.matrixWorld),this.panUp(st*(this.object.top-this.object.bottom)/this.object.zoom/mt.clientHeight,this.object.matrixWorld));this.dispatchEvent(UJ)}dollyOut(nt){this.object.isPerspectiveCamera?this.scale/=nt:this.object.isOrthographicCamera&&(this.object.zoom*=nt,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(IN)}dollyIn(nt){this.object.isPerspectiveCamera?this.scale*=nt:this.object.isOrthographicCamera&&(this.object.zoom/=nt,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(IN)}zoomOut(nt=this.getZoomScale()){this.dispatchEvent(ou),this.dollyOut(nt),this.dispatchEvent(au)}zoomIn(nt=this.getZoomScale()){this.dispatchEvent(ou),this.dollyIn(nt),this.dispatchEvent(au)}setZoom(nt){if(this.dispatchEvent(ou),this.object.isPerspectiveCamera){let st=this.initialSphericalRadius/nt/this.spherical.radius;this.scale=st}else this.object.isOrthographicCamera&&(this.object.zoom=nt,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0);this.dispatchEvent(au)}handleMouseDownRotate(nt){this.rotateStart.set(nt.clientX,nt.clientY)}handleMouseDownDolly(nt){this.dollyStart.set(nt.clientX,nt.clientY)}handleMouseDownPan(nt){this.panStart.set(nt.clientX,nt.clientY)}handleMouseMoveRotate(nt,st=1){nt.movementX!==void 0?this.rotateDelta.set(nt.movementX,nt.movementY):(this.rotateEnd.set(nt.clientX,nt.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*st).rotateAround(ON,-this.object.angleOffsetFromUp);let mt=this.domElement,gt=this.useWindowEvents?window.innerHeight:mt.clientHeight,_t=2*Math.PI*this.rotateDelta.x/gt,Et=2*Math.PI*this.rotateDelta.y/gt;this.rotateLeft(_t),this.rotateUp(Et),this.update()}handleMouseMoveDolly(nt){this.dollyEnd.set(nt.clientX,nt.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(nt,st=1){nt.movementX!==void 0?this.panDelta.set(nt.movementX,nt.movementY):(this.panEnd.set(nt.clientX,nt.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*st),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(nt){if(U2===!1&&Ip(nt)===!1&&k2(nt)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-nt.deltaX,-nt.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),nt.altKey?this.pan(0,this.panDelta.y):nt.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1||this.gesture)return;nt.deltaY===0?nt.deltaX<0?this.dollyIn(this.getZoomScale()):nt.deltaX>0&&this.dollyOut(this.getZoomScale()):nt.deltaY<0?this.dollyIn(this.getZoomScale()):nt.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(Je$1.length===2){let nt=.5*(Je$1[0].pageX+Je$1[1].pageX),st=.5*(Je$1[0].pageY+Je$1[1].pageY);this.rotateStart.set(nt,st)}else this.rotateStart.set(Je$1[0].pageX,Je$1[0].pageY)}handleTouchStartPan(){if(Je$1.length===2){let nt=.5*(Je$1[0].pageX+Je$1[1].pageX),st=.5*(Je$1[0].pageY+Je$1[1].pageY);this.panStart.set(nt,st)}else this.panStart.set(Je$1[0].pageX,Je$1[0].pageY)}handleTouchStartDolly(){let nt=Je$1[0].pageX-Je$1[1].pageX,st=Je$1[0].pageY-Je$1[1].pageY,mt=Math.sqrt(nt*nt+st*st);this.dollyStart.set(0,mt)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(nt){if(Je$1.length===2){let mt=ov(nt),gt=.5*(nt.pageX+mt.x),_t=.5*(nt.pageY+mt.y);this.rotateEnd.set(gt,_t)}else{if(nt.pointerId!==Je$1[0].pointerId)return;this.rotateEnd.set(nt.pageX,nt.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let st=this.domElement;st&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/st.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/st.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(nt){if(Je$1.length===2){let st=ov(nt),mt=.5*(nt.pageX+st.x),gt=.5*(nt.pageY+st.y);this.panEnd.set(mt,gt)}else{if(nt.pointerId!==Je$1[0].pointerId)return;this.panEnd.set(nt.pageX,nt.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(nt){let st=ov(nt),mt=nt.pageX-st.x,gt=nt.pageY-st.y,_t=Math.sqrt(mt*mt+gt*gt);this.dollyEnd.set(0,_t),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(nt){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(nt),this.enablePan&&this.handleTouchMovePan(nt)}handleTouchMoveDollyRotate(nt){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(nt),this.enableRotate&&this.handleTouchMoveRotate(nt)}checkRaycastLock(){var nt;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let st=(nt=this.options)==null?void 0:nt.showCameraLock;return st&&st(),!0}}else return!1}};function Qo(nt){let st=Math.PI*2;for(;nt<=-Math.PI;)nt+=st;for(;nt>Math.PI;)nt-=st;return nt}function LN(nt){return 1-Math.pow(1-nt,4)}var pg=class{constructor(nt,st,mt,gt,_t,Et){this.id=nt,this.data=st,this.object=mt,this.page=gt,this.currentIntersectedObjects=[],this.actions=Kt$1(st,st.actions,gt,_t,Et,mt),this.target=st.target,this.triggeringObjects=[];for(let At of st.triggeringObjects){let Rt=gt.scene.find(At);Rt&&this.triggeringObjects.push(Rt)}}isValidTriggeringObject(nt){return this.target==="all"?!0:this.triggeringObjects.some(st=>st===nt||st.isAncestorOf(nt.uuid)||nt.isAncestorOf(st.uuid))}disconnect(){ur(this.actions)}dispatch(){this.object.destroyedInAction||(this.actions.Transition.forEach(nt=>{nt.object.currentTransitionEvent!==this&&(nt.object.currentTransitionEvent=this,nt.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.actions.Transition.forEach(nt=>{nt.data.runMode==="Toggle"?nt.toggle():nt.play()}),this.actions.SwitchCamera.forEach(nt=>{nt.data.runMode==="Toggle"?nt.toggle():nt.play()}),this.actions.Link.forEach(nt=>{nt.dispatch()}),this.actions.Reset.forEach(nt=>{nt.dispatch()}),this.actions.Create.forEach(nt=>{nt.dispatch()}),this.actions.Destroy.forEach(nt=>{nt.dispatch(!1)}),this.actions.Audio.forEach(nt=>{nt.dispatchBasic()}),this.actions.Particles.forEach(nt=>{nt.dispatchBasic()}),this.actions.Video.forEach(nt=>{nt.dispatchBasic()}),this.actions.SceneTransition.forEach(nt=>{nt.dispatch()}),this.actions.SetVariable.forEach(nt=>nt.checkConditions()),this.actions.SetVariable.forEach(nt=>nt.dispatch()),this.actions.DynamicVariablePlay.forEach(nt=>nt.dispatch()),this.actions.ClearLocalStorage.forEach(nt=>nt.dispatch()),this.actions.UserAPI.forEach(nt=>nt.dispatch()))}},kt;J2.then(nt=>kt=nt);var bi=new E$6,so=new Qe$1,rc=new E$6,tT=new ir(0,0,0,"YXZ"),BN=new ir(0,0,0,"XYZ"),oo=new E$6,rT=new E$6,iT=new E$6(1,1,1),kf=new Qe$1,Fb=new ue$1,NN=new ue$1,WJ={type:"updateMatrix"},FN=new Qe$1,nT=new Or,vb={type:"beginEvent",eventName:"Collision"},qJ={type:"beginEvent",eventName:"Trigger"};function VN(nt){if(El.physicsEnabled(nt.scene.objects))return!0;let st=!1;return nt.scene.objects.traverse((mt,gt)=>{if(gt.events){if(Array.isArray(gt.events)){for(let _t of gt.events)if(_t.data.disabled!==!0&&_t.data.type==="GameControl"&&_t.data.collisionEnabled){st=!0;break}}else for(let _t of Object.values(gt.events))if(_t.disabled!==!0&&_t.type==="GameControl"&&_t.collisionEnabled){st=!0;break}}}),st}var fg=nt=>nt.states.some(st=>st.data.position!==void 0||st.data.rotation!==void 0||st.data.hiddenMatrix!==void 0||st.data.cloner!==void 0||st.data.pathSnapping!==void 0),Vb=class{constructor(nt){this.eventContext=nt,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=st=>{if(st.bodyType()!==kt.RigidBodyType.Dynamic)return;st.isSleeping()||this.nActiveRigidBodies++;let[mt,gt,_t]=this.rigidBodyToMesh.get(st.handle);if(bi.copy(st.translation()).multiplyScalar(this.pixelsPerMeter),so.copy(st.rotation()),mt.matrixWorld.compose(bi,so,gt),mt.hasNonUniformScale&&mt.matrixWorld.multiply(mt.shearScale),mt.dispatchEvent(WJ),_t){let Et=mt.cloner;if(Et&&Et.objectForSample===void 0){Et.matrixWorld.copy(mt.matrixWorld);for(let At of Et.children)At.updateMatrixWorld(!0)}for(let At of mt.children)At.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(st,mt,gt)=>{var At,Rt,Ft,Nt;if(gt===!1)return;let _t,Et;if(this.sensorToTriggerEvent[st]?(_t=this.sensorToTriggerEvent[st],Et=this.sharedGameControlGlobals.colliderToEntity.get(mt)):this.sensorToTriggerEvent[mt]&&(_t=this.sensorToTriggerEvent[mt],Et=this.sharedGameControlGlobals.colliderToEntity.get(st)),_t&&Et&&_t.isValidTriggeringObject(Et)){_t.dispatch();return}for(let Bt=this.sharedGameControlGlobals.createdObjects.length-1;Bt>=0;Bt--){let Gt=this.sharedGameControlGlobals.createdObjects[Bt];if(Gt.userData.hasCollisionDestroy&&(((At=Gt.rigidBody)==null?void 0:At.collider(0).handle)===st||((Rt=Gt.rigidBody)==null?void 0:Rt.collider(0).handle)===mt)){this.sharedGameControlGlobals.createdObjects.splice(Bt,1),Gt.removeFromParent(),requestAnimationFrame(()=>{var dr;return(dr=this.sharedGameControlGlobals.rapierWorld)==null?void 0:dr.removeRigidBody(Gt.rigidBody)});break}}if(((Ft=this.gameControl)==null?void 0:Ft.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(st)){let Bt=this.sharedGameControlGlobals.colliderToEntity.get(mt),Gt=this.sharedGameControlGlobals.entityToCollisionEvents[Bt.uuid];if(Gt===void 0)return;for(let dr of Gt)dr.data.target==="character"&&this.dispatchCollisionEvent(dr,Bt,mt)}else if(((Nt=this.gameControl)==null?void 0:Nt.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(mt)){let Bt=this.sharedGameControlGlobals.colliderToEntity.get(st),Gt=this.sharedGameControlGlobals.entityToCollisionEvents[Bt.uuid];if(Gt===void 0)return;for(let dr of Gt)dr.data.target==="character"&&this.dispatchCollisionEvent(dr,Bt,st)}else{let Bt=this.sharedGameControlGlobals.colliderToEntity.get(st),Gt=this.sharedGameControlGlobals.entityToCollisionEvents[Bt.uuid];if(Gt!==void 0)for(let Tr of Gt)Tr.data.target==="scene"&&this.dispatchCollisionEvent(Tr,Bt,st);let dr=this.sharedGameControlGlobals.colliderToEntity.get(mt),Mr=this.sharedGameControlGlobals.entityToCollisionEvents[dr==null?void 0:dr.uuid];if(Mr!==void 0)for(let Tr of Mr)Tr.data.target==="scene"&&this.dispatchCollisionEvent(Tr,dr,mt)}},this.isExport=nt.isExport,this.sharedAssets=nt.sharedAssets,this.renderer=nt.renderer,this.requestRender=nt.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=IM,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(nt){nt.forEach(st=>{st.addEventListener("connected",mt=>{"gamepad"in mt.data&&"axes"in mt.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(mt.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(nt=>{var mt,gt;let st=nt.dataPatched;for(let _t of st.events){if(_t.data.disabled===!0)continue;let Et=(gt=(mt=_t.data.actions)==null?void 0:mt.find(At=>At.data.type==="Destroy"))==null?void 0:gt.data;if(Et)for(let At of Et.objects){let Rt=this.page.scene.find(At);Rt&&(Rt.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(nt=>{let st=nt.dataPatched;for(let mt of st.events)if(!(mt.data.disabled===!0||mt.data.type!=="DragDrop"))for(let gt of mt.data.objects){let _t=this.page.scene.find(gt);_t&&(_t.userData.hasDrag=!0)}})}initBVH(){let nt=[];if(this.page.traverseChildren(st=>{var Nt,Bt;let mt,gt=st instanceof kl,_t=st instanceof Zl;if(st instanceof Gi||gt||_t)return;st instanceof Br?mt=st.object:mt=st;let Et=mt.dataPatched;if(((Nt=Et.physics)==null?void 0:Nt.enabled)==="visibility"?!Et.visible:!((Bt=Et.physics)!=null&&Bt.enabled))return!0;let At=st.geometry,Rt=mt.userData.hasDestroy===!0,Ft=mt.userData.hasDrag===!0;if(fg(Et)||Rt||Ft||mt.dataPatched.events.some(Gt=>Gt.data.disabled!==!0&&Gt.data.type==="GameControl"))return st.updateMatrixWorldSVD(),this.addBoundsTree(st),!0;At&&nt.push(io(At,st.matrixWorld))}),nt.length>0){let st=ks(nt,!1);this.sharedGameControlGlobals.staticMeshBVH=new Po(st)}}addRigidBody(nt,st,mt){let gt=[],_t="geometry"in nt?nt.geometry:void 0,Et=st.dataPatched;if((_t==null?void 0:_t.getAttribute("position"))!==void 0&&gt.push(io(_t,nt.shearScale)),Et.physics.fusedBody){let At=this.gatherChildrenGeom(nt,gt);nt.traverseObject(At),nt.children.forEach(Ft=>Ft.updateMatrixWorld(!0));let Rt=nt.cloner;Rt&&Rt.objectForSample===void 0&&Et.physics.rigidBody==="dynamic"&&(Rt.traverseObject(At),Rt.children.forEach(Ft=>Ft.updateMatrixWorld(!0)))}if(gt.length>0){let At,Rt=!mt.fromCreate&&Et.physics.rigidBody==="dynamic"||mt.fromCreate&&mt.dynamic;Rt?(At=kt.RigidBodyDesc.dynamic(),At.setLinearDamping(Et.physics.damping).setAngularDamping(Et.physics.damping).setAdditionalMass(1e-9).setGravityScale(Et.physics.gravityScale).enabledRotations(...Et.physics.enabledRotation).enabledTranslations(...Et.physics.enabledTranslation)):(mt.hasTransformAnim||mt.hasFollow||mt.hasDrag)&&!mt.fromCreate?(At=kt.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(nt)):At=kt.RigidBodyDesc.fixed();let Ft=ks(gt);(nt.hasNonUniformScale?nt.matrixWorldRigid:nt.matrixWorld).decompose(bi,so,rc),nt.position0=bi.clone().divideScalar(this.pixelsPerMeter),nt.rotation0=so.clone(),bi.divideScalar(this.pixelsPerMeter),At.setTranslation(bi.x,bi.y,bi.z).setRotation(so),_t?Ft==null||Ft.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):Ft==null||Ft.scale(rc.x/this.pixelsPerMeter,rc.y/this.pixelsPerMeter,rc.z/this.pixelsPerMeter);let Nt=this.sharedGameControlGlobals.rapierWorld.createRigidBody(At);Rt&&this.rigidBodyToMesh.set(Nt.handle,[nt,rc.clone(),Et.physics.fusedBody]);let Bt=!(Et.geometry===void 0||Et.geometry.type==="SubdivGeometry"||Et.geometry.type==="NonParametricGeometry"||Et.geometry.type==="BooleanGeometry"||Et.geometry.type==="VectorGeometry"||Et.geometry.type==="StarGeometry"||Et.geometry.type==="RectangleGeometry"||Et.geometry.type==="EllipseGeometry"||Et.geometry.type==="TriangleGeometry"||Et.geometry.type==="TorusGeometry"||Et.geometry.type==="HelixGeometry");try{this.addCollider(Nt,Et.physics,Ft,st,Bt)}catch{try{this.addCollider(Nt,Et.physics,Ft,st,!1)}catch(Gt){console.error(Gt)}}nt.rigidBody=Nt}}addBoundsTree(nt){var mt,gt;let st=[];if(((mt=nt.geometry)==null?void 0:mt.getAttribute("position"))!==void 0&&((gt=nt.geometry)==null?void 0:gt.getAttribute("position").count)>0&&st.push(io(nt.geometry,nt.shearScale)),nt.traverseObject(this.gatherChildrenGeom(nt,st)),nt.children.forEach(_t=>_t.updateMatrixWorld(!0)),st.length>0){let _t=ks(st,!1);nt.bvhGeometry=_t,_t.getAttribute("position").count>0&&(nt.bvhGeometry.boundsTree=new Po(_t),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(nt))}}addCollider(nt,st,mt,gt,_t=!0){var Rt,Ft;if((mt==null?void 0:mt.getAttribute("position").count)===0||((Rt=mt==null?void 0:mt.getIndex())==null?void 0:Rt.count)===0)return;let Et;mt&&(st.colliderType==="trimesh"?Et=kt.ColliderDesc.trimesh(mt.getAttribute("position").array,mt.getIndex().array):Et=kt.ColliderDesc.convexMesh(mt.getAttribute("position").array,_t?mt.getIndex().array:void 0)),Et.setFrictionCombineRule(kt.CoefficientCombineRule.Average).setRestitutionCombineRule(kt.CoefficientCombineRule.Average).setDensity(st.density).setFriction(st.friction).setRestitution(st.restitution);let At=this.sharedGameControlGlobals.rapierWorld.createCollider(Et,nt);this.sharedGameControlGlobals.colliderToEntity.set(At.handle,gt),(Ft=this.sharedGameControlGlobals.entityToCollisionEvents[gt.uuid])!=null&&Ft.some(Nt=>Nt.target==="scene")&&At.setActiveEvents(kt.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(nt,st){return(mt,gt)=>{var Rt;if(gt===0)return;let _t;if(mt instanceof Gi)if(mt.objectForSample){if(mt.objectForSample.dataPatched.physics.fusedBody)return;_t=mt.object}else return mt.object.dataPatched.physics.fusedBody===!0&&mt.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(mt instanceof Br)_t=mt.object;else if(_t=mt,(Rt=_t.dataPatched.cloner)==null?void 0:Rt.hideBase)return!0;let Et=_t.dataPatched;if(Et.physics.enabled==="visibility"?!Et.visible:!Et.physics.enabled)return!0;gt===1?nt.hasNonUniformScale?mt.matrixWorld.multiplyMatrices(nt.shearScale,mt.hiddenMatrix):mt.matrixWorld.copy(mt.hiddenMatrix):mt.matrixWorld.multiplyMatrices(mt.parent.matrixWorld,mt.hiddenMatrix),mt.matrixWorld.multiply(mt.matrix);let At=mt.geometry;(At==null?void 0:At.getAttribute("position"))!==void 0&&st.push(io(At,mt.matrixWorld))}}activate(nt){var dr,Mr;if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=nt,this.usePhysics=this.page.data.globalPhysics.usePhysics;let st=this.page.playCamera,mt=!1,gt=5,_t=8,Et=9,At="drag",Rt=this.page.data.publish.gameControlObject,Ft=Rt!==null?this.page.find(Rt):null,Nt=null;if(Ft)for(let Tr of Ft.data.events){if(Tr.data.disabled||Tr.data.type!=="GameControl")continue;let zr=Ft;for(;this.usePhysics&&((dr=zr=zr.parent)==null?void 0:dr.parent)!==null;)(Mr=zr.data.physics)==null||Mr.fusedBody;Tr.data.collisionEnabled&&(this.needsCollisionDetection=!0),Nt===null&&(Nt=Tr.data)}if(this.page.traverseEntity(Tr=>{for(let zr of Tr.dataPatched.events)if(zr.data.disabled===!1&&zr.data.type==="Trigger")return this.needsCollisionDetection=!0,!0}),Ft&&Nt&&(Ft.data.visible===!0||Ft.data.physics.enabled===!0)){mt=mt||Nt.camera===st.uuid||Ft.uuid===st.uuid;let Tr=new og(Ft,this.renderer.domElement,Nt,this.eventContext.page.data.globalPhysics,this,Ft.uuid!==st.uuid&&Nt.camera===st.uuid,st,this.page,this.sharedAssets);this.gameControl=Tr,gt=Nt.joystickPosLoc,_t=Nt.joystickRotLoc,Et=Nt.jumpTouchButtonLoc,At=Nt.rotByTouch,Ci&&Nt.touchControl&&(this.joystickToGameControls[gt]="pos",Nt.moveMode==="walk"&&(this.joystickToGameControls[Et]="jmp"),At==="joystick"&&(this.joystickToGameControls[_t]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let Tr=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new Lb(this.usePhysics,this.isExport);let zr;Tr.collider.type==="sphere"?zr=Tr.collider.radius*2:zr=Tr.collider.height,zr=Math.floor(zr/Tr.navmesh.ch-1),this.navigationMeshWrapper.init({...Tr.navmesh,walkableHeight:zr},this.gameControl,this.eventContext)}}if(mt===!1){let{enableRotate:Tr,enablePan:zr,enableZoom:Fr,autoRotate:Nr,hoverRotatePanMode:tn}=this.eventManager.publish.orbitControls;(Tr||zr||Fr||Nr||tn!==0)&&(this.orbitControls=new zf(st,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let Bt=this.renderer.domElement.width/this.renderer.getPixelRatio(),Gt=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((Tr,zr)=>{let Fr=document.body.appendChild(document.createElement("div")),[Nr,tn,rn]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[zr],Tn=(Bt-5*Nr)/4+Nr,$n={},un=Tr==="jmp",es=un?0:Nr;zr<10?(zr<5?$n.top=es/2:$n.bottom=es/2,$n.left=es/2+zr%5*Tn):zr===10?($n.left=es/2,$n.top=Gt/2):($n.right=es/2,$n.top=Gt/2),$n.top?$n.top-=tn[1]:$n.bottom+=tn[1],$n.left?$n.left+=tn[0]:$n.right-=tn[0];for(let Ko in $n)$n[Ko]+="px";if(un){let Ko=Fr.appendChild(document.createElement("div"));Object.assign(Ko.style,$n,{position:"absolute",width:Nr+"px",height:Nr+"px",backgroundColor:`rgba(255,255,255,${rn==="show"?.4:0})`,zIndex:"9999",borderRadius:Nr+"px",border:rn==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let ds=Nr/16*16*.4;rn==="show"&&(Ko.innerHTML=`
						<svg width="${ds}" height="${Nr*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),Ko.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),Ko.addEventListener("touchend",Il=>Il.preventDefault()),this.joysticks[zr]=[void 0,Fr];return}let kn={zone:Fr,mode:"static",position:$n,size:Nr};rn==="hide"&&(kn.restOpacity=0);let ts=mB.create(kn);ts.on("move",(Ko,ds)=>{let Il=this.gameControl;Tr==="pos"?ds.force<.2?Il.moveForce=0:(Il.movementState.movePosZ=Math.sin(-ds.angle.radian),Il.movementState.movePosX=Math.cos(-ds.angle.radian),ds.force>1.2?Il.movementState.run=1:Il.movementState.run=0,ds.force<.3?Il.moveForce=(ds.force-.2)/.1:Il.moveForce=1):Tr==="rot"&&(ds.force<.2?Il.rotForce=0:(Il.movementState.rotPosX=ds.vector.y,Il.movementState.rotPosY=-ds.vector.x,ds.force<.3?Il.rotForce=(ds.force-.2)/.1:Il.rotForce=1)),this.requestRender()}),ts.on("end",(Ko,ds)=>{let Il=this.gameControl;Tr==="pos"?(Il.movementState.movePosZ=0,Il.movementState.movePosX=0,Il.moveForce=1):Tr==="rot"&&(Il.movementState.rotPosX=0,Il.movementState.rotPosY=0,Il.rotForce=1)}),this.joysticks[zr]=[ts,Fr]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(Tr=>Tr.initialDisabled=!1)},80)}initPhysics(){var At;(At=this.sharedGameControlGlobals.rapierWorld)==null||At.free(),this.sharedGameControlGlobals.rapierWorld=new kt.World(new kt.Vector3(0,this.gravity,0)),this.events=new kt.EventQueue(!0);let nt=[],st=[];if(this.page.traverseChildren(Rt=>{var Nr,tn,rn,Tn;let Ft;if(Rt instanceof Gi)if(Rt.objectForSample){if(Rt.objectForSample.dataPatched.physics.fusedBody)return;Ft=Rt.object}else return Rt.object.dataPatched.physics.fusedBody===!0&&Rt.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(Rt instanceof Br)Ft=Rt.object;else{if(Rt instanceof Zl||Rt instanceof kl)return;if(Ft=Rt,((Nr=Ft.dataPatched.cloner)==null?void 0:Nr.disabled)===!1&&((tn=Ft.dataPatched.cloner)==null?void 0:tn.hideBase)&&((rn=Ft.dataPatched.physics)==null?void 0:rn.fusedBody)!==!0)return!0}let Nt=Ft.dataPatched,Bt;for(let $n of Nt.events)$n.data.disabled!==!0&&$n.data.type==="GameControl"&&(Bt=$n.data);if(!Nt.physics||(Nt.physics.enabled==="visibility"?!Nt.visible:!Nt.physics.enabled))return!0;Rt.updateMatrixWorldSVD();let Gt=fg(Nt),dr=!1,Mr=Ft.userData.hasDestroy,Tr=Ft.userData.hasDrag,zr=!1;for(let $n of Nt.events)if($n.data.disabled!==!0){if($n.data.type==="Collision"){dr=!0;let un=new Ob($n.id,$n.data,Ft,this.page,this.sharedAssets,this.eventManager);un.initialDisabled=!0,this.collisionEvents.push(un),this.sharedGameControlGlobals.entityToCollisionEvents[Ft.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[Ft.uuid].every(es=>es.id!==$n.id)?this.sharedGameControlGlobals.entityToCollisionEvents[Ft.uuid].push(un):this.sharedGameControlGlobals.entityToCollisionEvents[Ft.uuid]=[un]}else if($n.data.type==="Follow"){zr=!0;let un=$n.data.target;Rt.traverseVisible(es=>{es.userData.isFollowingObj=un})}}Nt.physics.rigidBody==="dynamic"&&Nt.physics.fusedBody===!1&&(Rt.matrixWorldFusedFalse=Rt.matrixWorld.clone());let Fr=Rt.geometry;if(Bt!==void 0){let $n=kt.RigidBodyDesc.kinematicPositionBased();(Rt.hasNonUniformScale?Rt.matrixWorldRigid:Rt.matrixWorld).decompose(bi,so,rc),Rt.position0=bi.clone().divideScalar(this.pixelsPerMeter),Rt.rotation0=so.clone(),bi.divideScalar(this.pixelsPerMeter),$n.setTranslation(bi.x,bi.y,bi.z).setRotation(so);let un=this.sharedGameControlGlobals.rapierWorld.createRigidBody($n);Rt.rigidBody=un;let es;Bt.collider.type==="sphere"?es=kt.ColliderDesc.ball(Bt.collider.radius/this.pixelsPerMeter):Bt.collider.type==="capsule"?es=kt.ColliderDesc.capsule((Bt.collider.height/2-Bt.collider.radius)/this.pixelsPerMeter,Bt.collider.radius/this.pixelsPerMeter):es=kt.ColliderDesc.cuboid(Bt.collider.width/this.pixelsPerMeter/2,Bt.collider.height/this.pixelsPerMeter/2,Bt.collider.depth/this.pixelsPerMeter/2),es.setFrictionCombineRule(kt.CoefficientCombineRule.Average).setRestitutionCombineRule(kt.CoefficientCombineRule.Average).setDensity(Nt.physics.density).setFriction(Nt.physics.friction).setRestitution(Nt.physics.restitution);let kn=this.sharedGameControlGlobals.rapierWorld.createCollider(es,un);this.sharedGameControlGlobals.colliderToEntity.set(kn.handle,Ft),bi.fromArray(Bt.collider.position).multiply(rc.setFromMatrixScale(Ft.matrixWorld)).divideScalar(this.pixelsPerMeter),kn.setTranslationWrtParent(bi);let ts=new Qe$1().setFromEuler(new ir().setFromVector3(new E$6().fromArray(Bt.collider.rotation)));kn.setRotationWrtParent(ts),kn.setActiveEvents(kt.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(Ft,!0)}else Nt.physics.rigidBody==="dynamic"||Gt||zr||Mr||Tr||dr?(this.addRigidBody(Rt,Ft,{hasFollow:zr,hasTransformAnim:Gt,hasDrag:Tr}),this.generateSensorColliderDescs(Ft,Nt.physics.fusedBody)):(Fr&&nt.push(io(Fr,Rt.matrixWorld)),Nt.physics.fusedBody&&Rt.traverseObject(($n,un)=>{var Ko;if(un===0)return;let es;if($n instanceof Gi)if($n.objectForSample){if($n.objectForSample.dataPatched.physics.fusedBody)return;es=$n.object}else return $n.object.dataPatched.physics.fusedBody===!0&&$n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else{if($n instanceof Zl||$n instanceof kl)return;if($n instanceof Br)es=$n.object;else if(es=$n,(Ko=es.dataPatched.cloner)==null?void 0:Ko.hideBase)return!0}let kn=es.dataPatched;if(kn.physics.enabled==="visibility"?!kn.visible:!kn.physics.enabled)return!0;let ts=$n.geometry;(ts==null?void 0:ts.getAttribute("position"))!==void 0&&nt.push(io(ts,$n.matrixWorld))}),this.generateSensorColliderDescs(Ft,Nt.physics.fusedBody,st));if(((Tn=Nt.physics)==null?void 0:Tn.fusedBody)===!0||Bt)return!0}),nt.length===0)return;let mt=ks(nt);mt.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let gt=kt.RigidBodyDesc.fixed(),_t=this.sharedGameControlGlobals.rapierWorld.createRigidBody(gt),Et=kt.ColliderDesc.trimesh(mt.getAttribute("position").array,mt.getIndex().array).setFrictionCombineRule(kt.CoefficientCombineRule.Multiply).setRestitutionCombineRule(kt.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(Et,_t);for(let[Rt,Ft]of st){let Nt=this.sharedGameControlGlobals.rapierWorld.createCollider(Rt,_t);this.sensorToTriggerEvent[Nt.handle]=Ft}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity(nt=>{for(let st of nt.dataPatched.events)if(st.data.type==="Trigger"&&st.data.disabled!==!0){let mt=new pg(st.id,st.data,nt,this.page,this.sharedAssets,this.eventManager),gt=new ue$1().compose(oo.fromArray(st.data.position),kf.setFromEuler(BN.fromArray(st.data.rotation)),iT);if(st.data.triggerZone==="box"){let _t=new jt;_t.min.fromArray(st.data.size).multiplyScalar(-.5),_t.max.fromArray(st.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([_t,gt,nt,mt])}else this.sharedGameControlGlobals.triggers.push([st.data.radius,gt,nt,mt])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(nt=>nt.disconnect()),this.sharedGameControlGlobals.triggers.forEach(nt=>nt[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var nt,st,mt,gt;if(this.isEnabled){this.isEnabled=!1,this.page.traverse(_t=>{let Et=_t;Et.matrixWorldFusedFalse&&(Et.matrixWorldFusedFalse=void 0),Et.rigidBody&&(Et.rigidBody=void 0),Et.position0&&(Et.position0=void 0),Et.rotation0&&(Et.rotation0=void 0)}),(nt=this.sharedGameControlGlobals.rapierWorld)==null||nt.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(st=this.gameControl)==null||st.reset(),(mt=this.gameControl)==null||mt.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([_t,Et])=>{_t==null||_t.destroy(),Et.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(gt=this.navigationMeshWrapper)==null||gt.dispose(),this.navigationMeshWrapper=void 0;for(let _t of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))_t.forEach(Et=>Et.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(nt,st,mt){if(!this.isEnabled)return!0;let gt=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(gt=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,gt=!1):this.initializationCounter===2&&this.gameControl&&(gt=!this.gameControl.update(nt,st,mt)&&gt),this.usePhysics===!1&&this.checkTrigger(),this.usePhysics){let _t=.016666666666666666;if(nt===0)gt=this.stepPhysics()&&gt;else{let Et=nt/1e3;Et<_t&&Et>_t*.55&&(Et=_t),this.accumulator+=Et;let At=performance.now(),Rt=0,Ft=6;for(;this.accumulator>=_t&&Rt<Ft&&(gt=this.stepPhysics()&&gt,this.accumulator-=_t,Rt++,!(performance.now()-At>_t*1e3)););this.accumulator=this.accumulator%_t}}return gt}stepPhysics(){var nt;for(let st of this.sharedGameControlGlobals.entitiesWithTransformAnim){(st.hasNonUniformScale?st.matrixWorldRigid:st.matrixWorld).decompose(bi,so,rc),tT.setFromQuaternion(so);let mt=st;mt.prevR===void 0?(mt.prevR=tT.clone(),mt.prevT=bi.clone()):(mt.prevR.copy(tT),mt.prevT.copy(bi)),st.rigidBody&&(st.rigidBody.setNextKinematicTranslation(bi.divideScalar(this.pixelsPerMeter)),st.rigidBody.setNextKinematicRotation(so))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),(nt=this.events)==null||nt.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(nt,st,mt){var Et;let gt=((Et=this.sharedGameControlGlobals.rapierWorld)==null?void 0:Et.getCollider(mt))._parent,_t;if(st.cloner){for(let At of st.cloner.children)if(At.rigidBody===gt){_t=At;break}}nt.dispatch(_t),st.dispatchEvent(vb)}updateUseWindowEvents(nt){var st;(st=this.orbitControls)==null||st.updateUseWindowEvents(nt)}generateSensorColliderDescs(nt,st,mt){let gt=NN.copy(nt.matrixWorld).invert();nt.traverseEntity((_t,Et)=>{if(st===!1&&Et===1)return!0;for(let At of _t.dataPatched.events)if(At.data.type==="Trigger"&&At.data.disabled!==!0){let Rt=new pg(At.id,At.data,_t,this.page,this.sharedAssets,this.eventManager),Ft;if(At.data.triggerZone==="box"?Ft=kt.ColliderDesc.cuboid(...At.data.size.map(Nt=>Nt/(2*this.pixelsPerMeter))):Ft=kt.ColliderDesc.ball(At.data.radius/this.pixelsPerMeter),Ft.setDensity(0).setSensor(!0).setActiveEvents(kt.ActiveEvents.COLLISION_EVENTS),oo.fromArray(At.data.position),kf.setFromEuler(BN.fromArray(At.data.rotation)),Fb.compose(oo,kf,iT).premultiply(_t.matrixWorld),mt?(Fb.decompose(oo,kf,rT),Ft.setActiveCollisionTypes(kt.ActiveCollisionTypes.KINEMATIC_FIXED|kt.ActiveCollisionTypes.DYNAMIC_FIXED)):(Fb.premultiply(gt).decompose(oo,kf,rT),nt.rigidBody.bodyType()===kt.RigidBodyType.Dynamic||(nt.rigidBody.bodyType()===kt.RigidBodyType.Fixed?Ft.setActiveCollisionTypes(kt.ActiveCollisionTypes.KINEMATIC_FIXED|kt.ActiveCollisionTypes.DYNAMIC_FIXED):Ft.setActiveCollisionTypes(kt.ActiveCollisionTypes.KINEMATIC_KINEMATIC|kt.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),oo.divideScalar(this.pixelsPerMeter),Ft.setTranslation(oo.x,oo.y,oo.z),Ft.setRotation(kf),mt)mt.push([Ft,Rt]);else{let Nt=this.sharedGameControlGlobals.rapierWorld.createCollider(Ft,nt.rigidBody);this.sensorToTriggerEvent[Nt.handle]=Rt}}})}checkTrigger(){let nt;for(let st=0;st<this.sharedGameControlGlobals.triggers.length;st++){let[mt,gt,_t,Et]=this.sharedGameControlGlobals.triggers[st];for(let At=0;At<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;At++){let Rt=this.sharedGameControlGlobals.entitiesWithTransformAnim[At];if(_t===Rt||Et.isValidTriggeringObject(yt.is(Rt)?Rt:Rt.object)===!1)continue;let Ft=NN.copy(_t.matrixWorld).decompose(oo,FN,rT).compose(oo,FN,iT).multiply(gt),Nt=Fb.copy(Rt.matrixWorld).invert().multiply(Ft);mt instanceof jt?nt=Rt.bvhGeometry.boundsTree.intersectsBox(mt,Nt):(nT.radius=mt,nT.center.setFromMatrixPosition(Nt),nt=Rt.bvhGeometry.boundsTree.intersectsSphere(nT)),nt?Et.currentIntersectedObjects.indexOf(Rt)===-1&&(Et.currentIntersectedObjects.push(Rt),Et.dispatch(),_t.dispatchEvent(qJ)):Et.currentIntersectedObjects=Et.currentIntersectedObjects.filter(Bt=>Bt!==Rt)}}}};function UN(nt){let st=this._clip.duration,mt=this._clip.start??0,gt=this.loop,_t=this.time+nt,Et=this._loopCount,At=gt===Sp;if(nt===0)return Et===-1?_t:At&&(Et&1)===1?st-(_t-mt):_t;if(gt===Aw){Et===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(_t>=st)_t=st;else if(_t<0)_t=0;else{this.time=_t;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=_t,this._mixer.dispatchEvent({type:"finished",action:this,direction:nt<0?-1:1})}}else{if(Et===-1&&(nt>=0?(Et=0,this._setEndings(!0,this.repetitions===0,At)):this._setEndings(this.repetitions===0,!0,At)),_t>=st||_t<mt){let Rt=Math.floor((_t-mt)/(st-mt));_t-=(st-mt)*Rt,Et+=Math.abs(Rt);let Ft=this.repetitions-Et;if(Ft<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,At||(_t=nt>0?st:mt,this.repetitions===1&&(_t=st)),this.time=_t,this._mixer.dispatchEvent({type:"finished",action:this,direction:nt>0?1:-1});else{if(Ft===1){let Nt=nt<0;this._setEndings(Nt,!Nt,At)}else this._setEndings(!1,!1,At);this._loopCount=Et,this.time=_t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:Rt})}}else this.time=_t;if(At&&(Et&1)===1)return st-(_t-mt)}return _t}var zN=!1,Ub=class{constructor(nt,st,mt,gt){this.scene=nt,this.requestRender=st,this.updateDisplayProgress=mt,this.animationInspectorState=gt,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=_t=>{_t.data.type==="Empty"&&_t.data.animations&&_t.data.animations.forEach((Et,At)=>{let Rt=Et[0]+"/";if(Array.isArray(_t.identity)?Rt+=_t.identity[0]:Rt+=_t.uuid,this.clipIdToAction[Rt])return;let Ft=qu.parse(JSON.parse(Et[2]));_t.animations[At]=Ft;let Nt=this.mixer.clipAction(Ft,_t);zN===!1&&(Object.getPrototypeOf(Nt)._updateTime=UN,zN=!0),Nt.clampWhenFinished=!0,this.clipIdToAction[Rt]=Nt})},this.mixer=new vy(nt),this.scene.traverseEntity(this.addClip)}deleteClip(nt,st){let mt=this.scene.find(st);if(!mt)return;let gt=mt.animations.find(Et=>Et.uuid===nt);if(!gt)return;let _t=this.clipIdToAction[nt];!_t||(_t.stop(),this.mixer.uncacheClip(gt),delete this.clipIdToAction[nt],mt.animations=mt.animations.filter(Et=>Et.uuid!==nt))}get isPlaying(){return Object.values(this.clipIdToAction).some(nt=>nt.isRunning())}playFromInspector(nt){this.mixer.stopAllAction();let st=this.clipIdToAction[nt];!st||(st.play(),this.activeClip=st.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(nt=>{nt.repetitions=1/0,nt.loop=Ew}),this.mixer.stopAllAction(),this.requestRender()}play(nt){let st=nt.clipId+"/"+nt.object,mt=this.clipIdToAction[st];if(mt)return nt&&(nt.repeat>=0&&(mt.repetitions=nt.repeat+1),nt.direction==="pingpong"&&nt.repeat!==0&&(mt.loop=Sp)),mt.play(),mt.paused=!1,this.requestRender(),mt}resumeFromInspector(nt){let st=this.clipIdToAction[nt];!st||(st.play(),st.paused=!1,this.requestRender())}pauseFromInspector(nt){let st=this.clipIdToAction[nt];!st||(st.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(nt){var st;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(st=this.animationInspectorState)!=null&&st.isScrubbing)return;this.mixer.update(nt/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*(this.maxFrames-1)%(this.maxFrames-1))),this.requestRender()}get maxFrames(){return CM(this.activeClip??void 0)}setProgressFromInspector(nt,st){if(!this.clipIdToAction[st])return;this.activeClip!==this.clipIdToAction[st].getClip()&&this.playFromInspector(st);let mt=this.clipIdToAction[st].paused;this.clipIdToAction[st].paused=!1,this.mixer.setTime(Math.min(nt/(this.maxFrames-1),.9999)*this.activeClip.duration),this.requestRender(),mt&&(this.clipIdToAction[st].paused=!0)}},sT=new WeakMap,zb=class extends nl{constructor(nt){super(nt),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(nt){return this.decoderPath=nt,this}setDecoderConfig(nt){return this.decoderConfig=nt,this}setWorkerLimit(nt){return this.workerLimit=nt,this}load(nt,st,mt,gt){let _t=new Yu(this.manager);_t.setPath(this.path),_t.setResponseType("arraybuffer"),_t.setRequestHeader(this.requestHeader),_t.setWithCredentials(this.withCredentials),_t.load(nt,Et=>{this.decodeDracoFile(Et,st).catch(gt)},mt,gt)}decodeDracoFile(nt,st,mt,gt){let _t={attributeIDs:mt||this.defaultAttributeIDs,attributeTypes:gt||this.defaultAttributeTypes,useUniqueIDs:!!mt};return this.decodeGeometry(nt,_t).then(st)}decodeGeometry(nt,st){let mt=JSON.stringify(st);if(sT.has(nt)){let Rt=sT.get(nt);if(Rt.key===mt)return Rt.promise;if(nt.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let gt,_t=this.workerNextTaskID++,Et=nt.byteLength,At=this._getWorker(_t,Et).then(Rt=>(gt=Rt,new Promise((Ft,Nt)=>{gt._callbacks[_t]={resolve:Ft,reject:Nt},gt.postMessage({type:"decode",id:_t,taskConfig:st,buffer:nt},[nt])}))).then(Rt=>this._createGeometry(Rt.geometry));return At.catch(()=>!0).then(()=>{gt&&_t&&this._releaseTask(gt,_t)}),sT.set(nt,{key:mt,promise:At}),At}_createGeometry(nt){let st=new _e$1;nt.index&&st.setIndex(new Xe$1(nt.index.array,1));for(let mt=0;mt<nt.attributes.length;mt++){let gt=nt.attributes[mt],_t=gt.name,Et=gt.array,At=gt.itemSize;st.setAttribute(_t,new Xe$1(Et,At))}return st}_loadLibrary(nt,st){let mt=new Yu(this.manager);return mt.setPath(this.decoderPath),mt.setResponseType(st),mt.setWithCredentials(this.withCredentials),new Promise((gt,_t)=>{mt.load(nt,gt,void 0,_t)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let nt=typeof WebAssembly!="object"||this.decoderConfig.type==="js",st=[];return nt?st.push(this._loadLibrary("draco_decoder.js","text")):(st.push(this._loadLibrary("draco_wasm_wrapper.js","text")),st.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(st).then(mt=>{let gt=mt[0];nt||(this.decoderConfig.wasmBinary=mt[1]);let _t=YJ.toString(),Et=["/* draco decoder */",gt,"","/* worker */",_t.substring(_t.indexOf("{")+1,_t.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([Et]))}),this.decoderPending}_getWorker(nt,st){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let gt=new Worker(this.workerSourceURL);gt._callbacks={},gt._taskCosts={},gt._taskLoad=0,gt.postMessage({type:"init",decoderConfig:this.decoderConfig}),gt.onmessage=function(_t){let Et=_t.data;switch(Et.type){case"decode":gt._callbacks[Et.id].resolve(Et);break;case"error":gt._callbacks[Et.id].reject(Et);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+Et.type+'"')}},this.workerPool.push(gt)}else this.workerPool.sort(function(gt,_t){return gt._taskLoad>_t._taskLoad?-1:1});let mt=this.workerPool[this.workerPool.length-1];return mt._taskCosts[nt]=st,mt._taskLoad+=st,mt})}_releaseTask(nt,st){nt._taskLoad-=nt._taskCosts[st],delete nt._callbacks[st],delete nt._taskCosts[st]}debug(){console.log("Task load: ",this.workerPool.map(nt=>nt._taskLoad))}dispose(){for(let nt=0;nt<this.workerPool.length;++nt)this.workerPool[nt].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function YJ(){let nt,st;onmessage=function(At){let Rt=At.data;switch(Rt.type){case"init":nt=Rt.decoderConfig,st=new Promise(function(Bt){nt.onModuleLoaded=function(Gt){Bt({draco:Gt})},DracoDecoderModule(nt)});break;case"decode":let Ft=Rt.buffer,Nt=Rt.taskConfig;st.then(Bt=>{let Gt=Bt.draco,dr=new Gt.Decoder,Mr=new Gt.DecoderBuffer;Mr.Init(new Int8Array(Ft),Ft.byteLength);try{let Tr=mt(Gt,dr,Mr,Nt),zr=Tr.attributes.map(Fr=>Fr.array.buffer);Tr.index&&zr.push(Tr.index.array.buffer),self.postMessage({type:"decode",id:Rt.id,geometry:Tr},zr)}catch(Tr){console.error(Tr),self.postMessage({type:"error",id:Rt.id,error:Tr.message})}finally{Gt.destroy(Mr),Gt.destroy(dr)}});break}};function mt(At,Rt,Ft,Nt){let Bt=Nt.attributeIDs,Gt=Nt.attributeTypes,dr,Mr,Tr=Rt.GetEncodedGeometryType(Ft);if(Tr===At.TRIANGULAR_MESH)dr=new At.Mesh,Mr=Rt.DecodeBufferToMesh(Ft,dr);else if(Tr===At.POINT_CLOUD)dr=new At.PointCloud,Mr=Rt.DecodeBufferToPointCloud(Ft,dr);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!Mr.ok()||dr.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+Mr.error_msg());let zr={index:null,attributes:[]};for(let Fr in Bt){let Nr=self[Gt[Fr]],tn,rn;if(Nt.useUniqueIDs)rn=Bt[Fr],tn=Rt.GetAttributeByUniqueId(dr,rn);else{if(rn=Rt.GetAttributeId(dr,At[Bt[Fr]]),rn===-1)continue;tn=Rt.GetAttribute(dr,rn)}zr.attributes.push(_t(At,Rt,dr,Fr,Nr,tn))}return Tr===At.TRIANGULAR_MESH&&(zr.index=gt(At,Rt,dr)),At.destroy(dr),zr}function gt(At,Rt,Ft){let Nt=Ft.num_faces()*3,Bt=Nt*4,Gt=At._malloc(Bt);Rt.GetTrianglesUInt32Array(Ft,Bt,Gt);let dr=new Uint32Array(At.HEAPF32.buffer,Gt,Nt).slice();return At._free(Gt),{array:dr,itemSize:1}}function _t(At,Rt,Ft,Nt,Bt,Gt){let dr=Gt.num_components(),Mr=Ft.num_points()*dr,Tr=Mr*Bt.BYTES_PER_ELEMENT,zr=Et(At,Bt),Fr=At._malloc(Tr);Rt.GetAttributeDataArrayForAllPoints(Ft,Gt,zr,Tr,Fr);let Nr=new Bt(At.HEAPF32.buffer,Fr,Mr).slice();return At._free(Fr),{name:Nt,array:Nr,itemSize:dr}}function Et(At,Rt){switch(Rt){case Float32Array:return At.DT_FLOAT32;case Int8Array:return At.DT_INT8;case Int16Array:return At.DT_INT16;case Int32Array:return At.DT_INT32;case Uint8Array:return At.DT_UINT8;case Uint16Array:return At.DT_UINT16;case Uint32Array:return At.DT_UINT32}}}var ic;function kN(){return ic||(ic=new zb,ic.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),ic.decoderPending}async function XJ(nt){if(ic){let st={attributeIDs:ic.defaultAttributeIDs,attributeTypes:ic.defaultAttributeTypes,useUniqueIDs:!1},mt;try{mt=await ic.decodeGeometry(new Int8Array(nt).buffer,st)}catch(gt){console.error(gt)}if(mt)return{index:mt.index?{array:mt.index.array}:void 0,attributes:Object.entries(mt.attributes).map(([gt,_t])=>({name:gt,itemSize:_t.itemSize,array:_t.array}))}}return null}async function GN(nt,st){let[mt,gt]=n1(Mv.deserialize(new Uint8Array(nt)));return Xv(mt),gt.result().data}function jN(nt){let st=[];return nt.scene.objects.traverse((mt,gt)=>{gt.type==="Mesh"&&gt.geometry.type==="NonParametricGeometry"&&gt.geometry.data.draco!==void 0&&st.push(gt)}),st}async function HN(nt){for(let st of nt){let mt=await XJ(st.geometry.data.draco);if(mt){let gt=st.geometry.data;mt.index&&(gt.index={array:mt.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let _t={};mt.attributes.forEach(({name:Et,array:At,itemSize:Rt})=>{_t[Et]={array:At,itemSize:Rt,type:"Float32Array",normalized:!1}}),gt.attributes=_t,gt.draco=void 0}}}var kb=class{constructor(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0],this._delay=500,this._distance=2,this._onMouseDown=nt=>{let st=[nt.clientX,nt.clientY],mt=new Date().getTime();if(this._clickCount>0){let gt=st[0]-this._lastPosition[0],_t=st[1]-this._lastPosition[1];Math.sqrt(gt*gt+_t*_t)>this._distance&&(this._clickCount=0)}this._lastPosition=st,this._clickCount=mt-this._lastTime>this._delay?1:this._clickCount+1,this._lastTime=mt},this._onMouseUp=nt=>{}}start(nt,st=500,mt=2){this._target&&this.stop(),this.reset(),this._delay=st,this._distance=mt,this._target=nt,this._target.addEventListener("pointerdown",this._onMouseDown,!1),this._target.addEventListener("pointerup",this._onMouseUp,!1)}stop(){this._target&&(this._target.removeEventListener("pointerdown",this._onMouseDown,!1),this._target.removeEventListener("pointerup",this._onMouseUp,!1),this._target=void 0)}get clickCount(){return this._clickCount}reset(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0]}},oT=class{constructor(nt,st,mt,gt,_t,Et,At,Rt){this.eventId=nt,this.id=st,this.data=mt,this.dataEvent=gt,this.object=_t,this.stage=!1,this.actions=Kt$1(gt,mt.actions,Et,At,Rt,_t)}disconnect(){ur(this.actions)}dispatchIn(){this.actions.Audio.forEach(nt=>nt.dispatchBasic()),this.actions.Particles.forEach(nt=>nt.dispatchBasic()),this.actions.Video.forEach(nt=>nt.dispatchBasic()),this.actions.Create.forEach(nt=>nt.dispatch()),this.actions.Destroy.forEach(nt=>nt.dispatch()),this.actions.Reset.forEach(nt=>nt.dispatch()),this.actions.Link.forEach(nt=>nt.dispatch()),this.actions.Transition.forEach(nt=>{nt.object.currentTransitionEvent!==this&&(nt.object.currentTransitionEvent=this,nt.init())}),this.actions.Transition.forEach(nt=>nt.toggle()),this.actions.Animation.forEach(nt=>nt.play()),this.actions.SwitchCamera.forEach(nt=>nt.play()),this.actions.SceneTransition.forEach(nt=>nt.dispatch()),this.actions.SetVariable.forEach(nt=>nt.checkConditions()),this.actions.SetVariable.forEach(nt=>nt.dispatch()),this.actions.DynamicVariablePlay.forEach(nt=>nt.dispatch()),this.actions.ClearLocalStorage.forEach(nt=>nt.dispatch()),this.actions.UserAPI.forEach(nt=>nt.dispatch())}dispatchOut(){this.actions.Transition.forEach(nt=>{nt.toggle()})}},Gb=class extends hr{constructor(nt,st){super(nt),this.eventManager=st,this.breakpoints=[],this.resize=(mt,gt)=>{this.breakpoints.forEach(_t=>{let Et=_v.deviceToSize(_t.data.size),At=_t.dataEvent.orientation==="horizontal"?mt:gt,Rt;switch(_t.data.operator){case"<":Rt=At<Et[0];break;case">":Rt=At>Et[0];break;case"<>":Rt=At>Et[0]&&At<Et[1];break}_t.stage!==Rt&&(_t.stage=Rt,_t.stage?_t.dispatchIn():_t.dispatchOut())})},this.onResizeObserver=new ResizeObserver(mt=>{for(let gt of mt){let{width:_t,height:Et}=gt.contentRect;this.resize(_t,Et)}})}connect(){let{page:nt,sharedAssets:st,domElement:mt}=this.eventContext;this.onResizeObserver.observe(mt);let gt=_t=>{var Et;if(!(!_t.visible||!((Et=_t.data)!=null&&Et.events.length)))for(let{data:At,id:Rt}of _t.data.events)At.disabled||At.type==="Resize"&&At.breakpoints.forEach(({data:Ft,id:Nt})=>{try{let Bt=new oT(Rt,Nt,Ft,At,_t,nt,st,this.eventManager);this.breakpoints.push(Bt)}catch{}})};nt.traverseEntity(_t=>{var Et;(_t instanceof Er||_t instanceof cr)&&((Et=_t.frame)==null||Et.traverse(At=>{gt(At)})),gt(_t)})}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach(nt=>{nt.disconnect()}),this.breakpoints=[]}},jb=class extends hr{constructor(nt,st){super(nt),this.eventManager=st,this.userAPIs={},this.events=[],this.onSuccess=({userAPIId:mt})=>{this.events.forEach(gt=>{gt.data.userAPIId===mt&&gt.dispatchSuccess()})},this.onError=({userAPIId:mt})=>{this.events.forEach(gt=>{gt.data.userAPIId===mt&&gt.dispatchError()})},this.userAPIs=nt.sharedAssets.getUserAPIs()}connect(){this.eventContext.page.traverseEntity(nt=>{var st;(st=nt.data)==null||st.events.filter(mt=>mt.data.type==="API"&&!mt.data.disabled).forEach(mt=>{this.events.push(new aT(mt.id,mt.data,nt,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userAPIs).forEach(([nt,st])=>{st.on("success",this.onSuccess),st.on("error",this.onError),st.autostart&&st.callUserAPI(this.eventContext.sharedAssets)})}disconnect(){Object.entries(this.userAPIs).forEach(([nt,st])=>{st.off("success",this.onSuccess),st.off("error",this.onError)})}},aT=class{constructor(nt,st,mt,gt,_t,Et){this.id=nt,this.data=st,this.object=mt,this.successActions=Kt$1(st,st.successActions,gt,_t,Et,mt),this.errorActions=Kt$1(st,st.errorActions,gt,_t,Et,mt)}dispatchSuccess(){this.dispatchActions(this.successActions)}dispatchError(){this.dispatchActions(this.errorActions)}dispatchActions(nt){nt.Audio.forEach(st=>st.dispatchConditional()),nt.Particles.forEach(st=>st.dispatchConditional()),nt.Video.forEach(st=>st.dispatchConditional()),nt.Create.forEach(st=>st.dispatch()),nt.Destroy.forEach(st=>st.dispatch()),nt.Reset.forEach(st=>st.dispatch()),nt.Transition.forEach(st=>{st.object.currentTransitionEvent!==this&&(st.object.currentTransitionEvent=this),st.init()}),nt.Transition.forEach(st=>st.play()),nt.Animation.forEach(st=>st.play()),nt.SwitchCamera.forEach(st=>st.play()),nt.SceneTransition.forEach(st=>st.dispatch()),nt.SetVariable.forEach(st=>st.checkConditions()),nt.SetVariable.forEach(st=>st.dispatch()),nt.DynamicVariablePlay.forEach(st=>st.dispatch()),nt.ClearLocalStorage.forEach(st=>st.dispatch()),nt.UserAPI.forEach(st=>st.dispatch())}},Hb=class extends hr{constructor(nt,st){super(nt),this.eventManager=st,this.userWebhooks={},this.events=[],this.onMessage=({userWebhookId:mt})=>{this.events.forEach(gt=>{gt.data.userWebhookId===mt&&gt.dispatch()})},this.userWebhooks=nt.sharedAssets.getUserWebhooks()}connect(){this.eventContext.page.traverseEntity(nt=>{var st;(st=nt.data)==null||st.events.filter(mt=>mt.data.type==="WEBHOOK"&&!mt.data.disabled).forEach(mt=>{this.events.push(new lT(mt.id,mt.data,nt,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userWebhooks).forEach(([nt,st])=>{st.connect(),st.on("message",this.onMessage)})}disconnect(){Object.entries(this.userWebhooks).forEach(([nt,st])=>{st.off("message",this.onMessage),st.disconnect()})}},lT=class{constructor(nt,st,mt,gt,_t,Et){this.id=nt,this.data=st,this.object=mt,this.actions=Kt$1(st,st.actions,gt,_t,Et,mt)}dispatch(){let nt=this.actions;nt.Audio.forEach(st=>st.dispatchConditional()),nt.Particles.forEach(st=>st.dispatchConditional()),nt.Video.forEach(st=>st.dispatchConditional()),nt.Create.forEach(st=>st.dispatch()),nt.Destroy.forEach(st=>st.dispatch()),nt.Reset.forEach(st=>st.dispatch()),nt.Transition.forEach(st=>{st.object.currentTransitionEvent!==this&&(st.object.currentTransitionEvent=this),st.init()}),nt.Transition.forEach(st=>st.play()),nt.Animation.forEach(st=>st.play()),nt.SwitchCamera.forEach(st=>st.play()),nt.SceneTransition.forEach(st=>st.dispatch()),nt.SetVariable.forEach(st=>st.checkConditions()),nt.SetVariable.forEach(st=>st.dispatch()),nt.DynamicVariablePlay.forEach(st=>st.dispatch()),nt.ClearLocalStorage.forEach(st=>st.dispatch()),nt.UserAPI.forEach(st=>st.dispatch())}};function QJ(){let nt=document.createElement("textarea");return nt.style.position="fixed",nt.style.top="200px",nt.style.left="400px",nt.style.zIndex="-1",nt.style.border="1px solid rgba(255,0,0,0.5)",nt.style.width="10px",nt.style.height="500px",nt.style.color="white",nt.style.opacity="0.5",nt.style.background="transparent",nt.style.display="none",nt.style.margin="0px",nt.style.padding="0px",nt.style.boxSizing="content-box",nt.style.pointerEvents="none",nt}var KJ=new E$6(0,0,1),WN=new E$6,qN=new E$6,YN=new fr,Wb=class{constructor(nt,st,mt,gt,_t){this.containerScene=nt,this.raycaster=st,this.sharedAssets=mt,this.requestRender=gt,this.onExit=_t,this.htmlInput=null,this.virtualInput=null,this.helper=new Sf,this.doubleClickHandler=new kb,this.isDragging=!1,this.plane=new Vr,this.caretInterval=0,this.planeIntersection=new E$6,this.projected=new U$1,this._lastIndex=0,this._isFirstDragMove=!1,this.selectionOnDragStart=0,this.onTextMaterialChanged=()=>{var At;let Et=(At=this.virtualInput)==null?void 0:At.data;if(this.virtualInput!==void 0&&Et){let Rt=Et.material,Ft=typeof Rt=="string"?this.sharedAssets.data.materials[Rt]:Rt,Nt=K3(Ft,this.sharedAssets);this.helper.setCaretColor(Nt)}},this.stopAnimateTextCursor=()=>{clearInterval(this.caretInterval),this.helper&&(this.helper.caretMesh.visible=!1)},this.startAnimateTextCursor=()=>{this.stopAnimateTextCursor(),this.helper&&(this.helper.caretMesh.visible=!0,this.caretInterval=setInterval(()=>{this.helper&&(this.helper.caretMesh.visible=!this.helper.caretMesh.visible),this.requestRender()},600))},this.handleCaretUpdate=Et=>{if(!this.htmlInput||!this.virtualInput)return;let At=this.helper,Rt=(Et==null?void 0:Et.key)==="ArrowLeft"||(Et==null?void 0:Et.key)==="ArrowRight",Ft=(Et==null?void 0:Et.key)==="ArrowUp"||(Et==null?void 0:Et.key)==="ArrowDown";this.htmlInput.selectionStart===this.htmlInput.selectionEnd?(At.setCaretPosition(this.htmlInput.selectionStart,{horizontalKeyMove:Rt,verticalKeyMove:Ft}),this.startAnimateTextCursor()):At.setSelection(this.htmlInput.selectionStart,this.htmlInput.selectionEnd),this.requestRender()},this.containerScene.add(this.helper)}createInput(){return this.htmlInput=QJ(),this.htmlInput}connect(){}disconnect(){var nt;this.stopAnimateTextCursor(),this.helper.hide(),(nt=this.htmlInput)==null||nt.remove(),this.doubleClickHandler.stop()}handleMouseDown(){var Et,At;if(!this.htmlInput||!this.virtualInput)return!0;this.getPointOnPlane();let nt=this.doubleClickHandler.clickCount,{index:st,lineIndex:mt,characterIndex:gt}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,nt>1?"inside":"previous")??{index:0,lineIndex:0,characterIndex:0};(At=(Et=this.virtualInput)==null?void 0:Et.wrappedText)!=null&&At.length&&this.virtualInput.wrappedText[mt][Math.max(0,gt-1)]===`
`&&(st--,gt--),this._lastIndex=st,this._isFirstDragMove=!0;let _t=this.checkClickedObject();if(nt===1){if(_t===null)return this.onExit(this.virtualInput),!0;this.selectionOnDragStart=st,this.isDragging=!0,this.setInputSelection(st)}else _t===this.virtualInput&&(nt===2?this.selectClosestWord(mt,gt):nt>2&&(this.setInputSelection(0,this.htmlInput.value.length),this.doubleClickHandler.reset()))}handleMouseUp(){this.applyRangeToTextInput(),this.isDragging=!1,this._isFirstDragMove=!1}handleMouseMove(){!this.virtualInput||(this._isFirstDragMove&&this.doubleClickHandler.clickCount>1&&(this.selectionOnDragStart=this._lastIndex,this.isDragging=!0,this.setInputSelection(this._lastIndex)),this._isFirstDragMove=!1,this.getPointOnPlane(),this.applyRangeToTextInput())}focus(nt){var st;if(this.virtualInput=nt,this.updateTextInputStyles(),this.htmlInput)if(nt){let mt=(st=this.data)==null?void 0:st.geometry.text;this.htmlInput.value=typeof mt=="string"?"":(mt==null?void 0:mt.textValue.toString())??""}else this.htmlInput.value=""}blur(){}get data(){let{virtualInput:nt}=this;if(nt)return nt.dataPatched}applyRangeToTextInput(){var _t;if(!this.isDragging||!this.virtualInput||!this.htmlInput)return;let nt=this.selectionOnDragStart,{index:st,lineIndex:mt,characterIndex:gt}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,this.doubleClickHandler.clickCount>2?"inside":"previous")??{index:0};mt!==void 0&&gt!==void 0&&((_t=this.virtualInput)==null?void 0:_t.wrappedText[mt][gt-1])===`
`&&st--,this.htmlInput.setSelectionRange(Math.min(nt,st),Math.max(nt,st))}checkClickedObject(){if(this.virtualInput){let nt=this.raycaster.intersectObject(this.virtualInput,!1);if(nt.length>0){let st=nt[0];if(st.object instanceof Ql)return st.object}}return null}selectClosestWord(nt,st){if(!this.virtualInput)return;let mt=this.virtualInput.wrappedText,gt=mt[nt],_t=st+1,Et=st;gt[st]!==" "&&(_t=this.findNextCharOccurence(gt,st,"forward"," "),Et=this.findNextCharOccurence(gt,st,"backward"," "),Et>0&&Et++,_t>=gt.length-1&&nt===mt.length-1&&_t++);let At=this.helper,Rt=At.getGlobalIndexFromLineAndCharIndexes(mt,nt,Et),Ft=At.getGlobalIndexFromLineAndCharIndexes(mt,nt,_t);this.setInputSelection(Rt,Ft)}findNextCharOccurence(nt,st,mt,gt=" "){let _t=Math.max(0,nt.length-1),Et=mt==="forward"?_t:0,At=mt==="forward"?1:-1,Rt=Math.max(Math.min(st,_t),0);for(;Rt!==Et;)if(Rt+=At,nt.charAt(Rt)===gt)return Rt;return Et}getPointOnPlane(){var st;let nt=(st=this.virtualInput)==null?void 0:st.data;if(!(!this.virtualInput||!nt)&&this.raycaster.ray.intersectsPlane(this.plane)){this.planeIntersection===null&&(this.planeIntersection=new E$6);let mt=this.raycaster.ray.intersectPlane(this.plane,this.planeIntersection);if(mt){this.planeIntersection.copy(this.virtualInput.worldToLocal(mt));let gt=typeof nt.geometry.width=="number"?nt.geometry.width:1,_t=typeof nt.geometry.height=="number"?nt.geometry.height:1;this.projected.set(mt.x+gt*.5,mt.y-_t*.5)}}}updatePlane(){var st;let nt=(st=this.virtualInput)==null?void 0:st.data;this.virtualInput&&nt&&(YN.getNormalMatrix(this.virtualInput.matrixWorld),WN.copy(KJ).applyMatrix3(YN).normalize(),this.virtualInput.localToWorld(qN.set(0,0,nt.geometry.depth)),this.plane.setFromNormalAndCoplanarPoint(WN,qN))}setInputSelection(nt,st=nt){var mt;(mt=this.htmlInput)==null||mt.setSelectionRange(nt,st),setTimeout(()=>{var gt;(gt=this.htmlInput)==null||gt.focus()})}updateTextInputStyles(){var st;let nt=(st=this.virtualInput)==null?void 0:st.data;this.virtualInput&&nt&&this.htmlInput&&(this.htmlInput.style.fontSize=nt.geometry.fontSize+"px",this.htmlInput.style.letterSpacing=nt.geometry.letterSpacing*nt.geometry.fontSize+"px",this.htmlInput.style.lineHeight=nt.geometry.fontSize*nt.geometry.lineHeight+"px",this.htmlInput.style.width=nt.geometry.width+"px",this.htmlInput.style.height=nt.geometry.height+"px",this.htmlInput.style.textAlign=ZJ(nt.geometry.horizontalAlign))}};function ZJ(nt){return nt===4?"justify":nt===2?"right":nt===3?"center":"left"}var QN=(nt,st)=>{if(typeof nt=="string"){let mt=st.data(nt);if(mt)return QN(mt.value,st)}return Lr.getDisplayedValue(nt)};function XN(nt,st){let mt=nt.text,gt="";if(typeof mt=="string"){let _t=st.variables.data(gt);_t&&(gt=QN(_t.value,st.variables))}else gt=mt.textValue.toString();return gt}var qb=class extends hr{constructor(nt,st){super(nt),this.eventManager=st,this._textInputs=[],this.sceneHelpers=new ei,this.helper=new Sf,this._onMouseDownFocusIn=mt=>{if(Je$1.length>1)return;this.eventContext.updateRaycaster(mt);let gt=null;if(this.eventContext.raycaster){for(let _t of this._textInputs)if(this.eventContext.raycaster.intersectObject(_t,!0).length>0){gt=_t;break}}this.focusOnTextInput(gt),this._onCaretUpdate(),this._onMouseUp(),this.textInputManager.doubleClickHandler.start(this.eventContext.domElement),this.textInputManager.doubleClickHandler._onMouseDown(mt),this._onMouseDown(mt)},this.onExit=()=>{let{virtualInput:mt}=this.textInputManager;if(mt===null)return;let gt=this.textInputManager.htmlInput;this.helper.hide(),gt==null||gt.setSelectionRange(gt.value.length,gt.value.length),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0);let{domElement:_t}=this.eventContext;_t.removeEventListener("pointerdown",this._onMouseDown,!1),_t.removeEventListener("pointerup",this._onMouseUp,!1),_t.removeEventListener("pointermove",this._onMouseMove,!1),window.removeEventListener("keydown",this._onKeyPress),this.textInputManager.doubleClickHandler.reset(),_t.addEventListener("pointerdown",this._onMouseDownFocusIn),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers()},this._onMouseDown=mt=>{this.eventContext.updateRaycaster(mt),this.textInputManager.handleMouseDown(),this.textInputManager.virtualInput&&this.eventContext.raycaster.intersectObject(this.textInputManager.virtualInput,!0).length>0&&this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1)},this._onMouseUp=()=>{this.textInputManager.handleMouseUp(),this.eventManager.controlsManager.orbitControls&&!this.eventManager.controlsManager.orbitControls.enabled&&(this.eventManager.controlsManager.orbitControls.enabled=!0)},this._onMouseMove=mt=>{this.eventContext.updateRaycaster(mt),this.textInputManager.handleMouseMove()},this._onTextEdit=mt=>{let{htmlInput:gt,virtualInput:_t,helper:Et}=this.textInputManager;if(!gt||!_t)return;let At=gt.value;_t.textGeometry.setText(At).then(()=>{this.eventContext.requestRender()});let Rt=_t.data;Et.update();let Ft=Rt.geometry.text;if(typeof Ft=="string"){let Nt=Ft;this.eventContext.sharedAssets.updateVariable(Nt,{textValue:At})}this.textInputManager.updateTextInputStyles(),this._onCaretUpdate()},this._onCaretUpdate=mt=>{this.textInputManager.handleCaretUpdate(mt)},this._onKeyPress=mt=>{mt.key==="Escape"&&this.onExit()},this.textInputManager=new Wb(this.sceneHelpers,nt.raycaster,nt.sharedAssets,nt.requestRender,this.onExit)}connect(){let nt=[];if(this.eventContext.scene.traverseEntity(gt=>{gt instanceof Ql&&nt.push(gt)}),this._textInputs=nt,nt.length===0)return;let{domElement:st}=this.eventContext;st.addEventListener("pointerdown",this._onMouseDownFocusIn),this.textInputManager.connect();let mt=this.textInputManager.createInput();document.body.appendChild(mt),mt.style.display="none",mt.addEventListener("keyup",this._onCaretUpdate),mt.addEventListener("keydown",this._onCaretUpdate),mt.addEventListener("beforeinput",this._onCaretUpdate),mt.addEventListener("paste",this._onCaretUpdate),mt.addEventListener("cut",this._onCaretUpdate),mt.addEventListener("select",this._onCaretUpdate),mt.addEventListener("selectstart",this._onCaretUpdate)}disconnect(){let nt=this.textInputManager.htmlInput,{domElement:st}=this.eventContext;st.removeEventListener("pointerdown",this._onMouseDownFocusIn),nt==null||nt.removeEventListener("keyup",this._onCaretUpdate),nt==null||nt.removeEventListener("keydown",this._onCaretUpdate),nt==null||nt.removeEventListener("beforeinput",this._onCaretUpdate),nt==null||nt.removeEventListener("paste",this._onCaretUpdate),nt==null||nt.removeEventListener("cut",this._onCaretUpdate),nt==null||nt.removeEventListener("select",this._onCaretUpdate),nt==null||nt.removeEventListener("selectstart",this._onCaretUpdate),this._textInputs.forEach(mt=>{let gt=XN(mt.data.geometry,this.eventContext.sharedAssets.data);mt.textGeometry.setText(gt)}),st.removeEventListener("pointerdown",this._onMouseDown,!1),st.removeEventListener("pointerup",this._onMouseUp,!1),st.removeEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers(),this.textInputManager.disconnect()}focusOnTextInput(nt){this.textInputManager.focus(nt),this.textInputManager.onTextMaterialChanged();let st=this.textInputManager.htmlInput;if(!st||nt===null)return;this.textInputManager.updateTextInputStyles(),this.eventContext.renderer.sceneHelpersOnTop=this.sceneHelpers,this.eventContext.renderer.pipeline.enableHelpers(),this.textInputManager.isDragging=!1;let mt=XN(nt.textGeometry.userData.parameters,this.eventContext.sharedAssets.data);st.value=mt,st.setSelectionRange(0,0),this.textInputManager.helper.show(nt),st.style.display="block",st.addEventListener("input",this._onTextEdit),this.textInputManager.updatePlane();let{domElement:gt}=this.eventContext;gt.removeEventListener("pointerdown",this._onMouseDownFocusIn),gt.addEventListener("pointerdown",this._onMouseDown,!1),gt.addEventListener("pointerup",this._onMouseUp,!1),gt.addEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress)}},Yb=class{constructor(nt,st,mt,gt,_t){this.publish=nt,this.controlsManager=st,this.animationControls=mt,this.eventContext=gt,this.sharedVariables=_t,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=Et=>{let At=window.parent!==window,Rt=document.documentElement.scrollHeight>document.documentElement.clientHeight||document.documentElement.scrollWidth>document.documentElement.clientWidth;(Et.touches.length>1||this.preventTouchScroll||At===!1&&Rt===!1)&&Et.preventDefault()},this.onMouseWheelPreventScroll=Et=>{this.preventScroll&&Et.preventDefault()},this.onMouseMove=Et=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(Et),pressed:Et.buttons>0}},this.onMouseDown=Et=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(Et),pressed:!0}},this.onMouseUp=Et=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(Et),pressed:!1}},this.getMousePosition=Et=>{var Nt;let{domRect:At}=this.eventContext,{pageX:Rt,pageY:Ft}=((Nt=Et.touches)==null?void 0:Nt.length)>0?Et.touches[0]:Et;return{x:Rt-(At.left+window.scrollX),y:Ft-(At.top+window.scrollY)}},this.stopRaycast=nt.stopRaycast,this.preventScroll=nt.preventScroll,this.preventTouchScroll=nt.preventTouchScroll,this.hideCursor=nt.hideCursor,this.requestRender=gt.requestRender}activate(){if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new Sb(this.eventContext),VariableChange:new Rb(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),API:new jb(this.eventContext,this),WEBHOOK:new Hb(this.eventContext,this),Conditional:new Eb(this.eventContext,this),Start:new Ib(this.eventContext,this),Basic:new wb(this.eventContext,this,this.needsRaycast),MouseHover:new _b(this.eventContext,this),Scroll:new Db(this.eventContext,this),Follow:new Tb(this.eventContext,this),DragDrop:new Mb(this.eventContext,this),LookAt:new Pb(this.eventContext),Resize:new Gb(this.eventContext,this),Textfields:new qb(this.eventContext,this)};let{page:nt,domElement:st}=this.eventContext;this.hideCursor&&(st.style.cursor="none"),nt.traverseEntity(mt=>{mt.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(mt=>mt.connect()),st.addEventListener("wheel",this.onMouseWheelPreventScroll),st.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++}deactivate(){var mt;if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:nt,domElement:st}=this.eventContext;st.style.cursor="",Object.values(this.handlers).forEach(gt=>gt.disconnect()),(mt=this.controlsManager.gameControl)==null||mt.disposeActions(),this.controlsManager.disconnectEvents(),nt.traverseEntity(gt=>{gt.removeEventListener("requestRender",this.requestRender),gt.destroyedInAction=!1}),st.removeEventListener("touchmove",this.onTouchMovePreventScroll),st.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(),this.activate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(nt){let st=this.isEnabled;st&&this.deactivate(),this.eventContext.useWindowEvents=nt,st&&this.activate()}initializeActionsDependentStates(){let nt=this.eventContext.sharedAssets;nt.resetDynamicVariablePlayState();let st=mt=>{if(mt.data.type==="Conditional"&&(mt.data.ifActions.forEach(st),mt.data.elseActions.forEach(st)),mt.data.type==="Conditional"||mt.data.type==="SetVariable")for(let gt of mt.data.type==="Conditional"?mt.data.condition:mt.data.expression)"id"in gt&&Array.isArray(gt.id)&&(gt.id[0]==="mouse"&&(this.needsMouse=!0),gt.id[0]==="raycast"&&(this.needsRaycast=!0));mt.data.type==="DynamicVariablePlay"&&mt.data.variableId!==""&&(mt.data.mode==="Play"||mt.data.mode==="PlayPause"||mt.data.mode==="Toggle")&&nt.setDynamicVariablePlayState(mt.data.variableId,"Stopped")};this.eventContext.page.traverseEntity(mt=>{var gt;if((gt=mt.data)!=null&&gt.events.length)for(let _t of mt.data.events)if(_t.data.type==="VariableChange"&&(_t.data.variableId==="mouseProperty"&&(this.needsMouse=!0),_t.data.variableId==="raycastProperty"&&(this.needsRaycast=!0)),_t.data.type==="Conditional")for(let Et of["inActions","outActions"])_t.data[Et].forEach(st);else if(_t.data.type==="DragDrop")for(let Et of["drag","drop"])_t.data.dragDropActions[Et].forEach(st);else if(_t.data.type==="GameControl")for(let Et of["idle","move","jump","run"])_t.data.gameActions[Et].forEach(st);else if(_t.data.type==="Resize")for(let Et of _t.data.breakpoints)Et.data.actions.forEach(st);else _t.data.type==="LookAt"||_t.data.type==="API"||_t.data.actions.forEach(st)})}},Xb=class{constructor(nt,st,mt,gt,_t){this._aspect=1,this.enableResponsive=!1,this._renderer=nt,this._camera=st,this._frameSize=new U$1().copy(mt),this._editorSize=new U$1().copy(gt),this._aspect=st.aspect,this._fov=_t??st.fov}set frameSize(nt){this._frameSize.copy(nt)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let nt=this._frameSize.x,st=this._frameSize.y,mt=this._editorSize.y;this._aspect=nt/st,st<=mt&&(this._camera.zoom*=mt/st),this._renderer.setViewport(0,0,nt,st)}updateCamera(nt=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let st=this._frameSize.y,mt=this._editorSize.y,gt=this._fov;if(nt&&st>mt){let _t=JJ(st,1080,2160,1,15)/100;gt*=st/mt,gt*=1-_t}this._camera.aspect=this._aspect,this._camera.fov=gt,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(nt){this._camera=nt,this._aspect=nt.aspect,this._fov=nt.fov}revert(){let nt=window.innerWidth,st=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,nt,st),this._renderer.setSize(nt,st)),this._camera&&(this._camera.aspect=nt/st,this._camera.fov=this._fov,this._camera.setViewplaneSize(nt,st,this.enableResponsive),this._camera.updateProjectionMatrix())}};function JJ(nt,st,mt,gt,_t){return(nt-st)/(mt-st)*(_t-gt)+gt}var Qb=class{get sharedAssets(){return this.shared}constructor(nt,st={},mt=!0){this.shared=new Xc(nt.shared,st,!0,mt),this.scene=new Hl(nt.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(nt,st){this.scene.clearScene(),this.sharedAssets.reset(nt.shared),this.scene.resetAfterClear(nt.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let nt of this.scene.children)nt instanceof cr&&!nt.uiScene&&nt.personalCamera.updateState(nt.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(nt=>{nt instanceof lr&&nt.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},Kb=class{constructor({x:nt=10,y:st=10}){this._startTime=0;let mt=document.getElementById("spe-perfs");mt?this.element=mt:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${nt}px`,this.element.style.top=`${st}px`}dispose(){var nt;(nt=this.element.parentElement)==null||nt.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let nt=performance.now()-this._startTime;this.element.innerHTML=nt.toFixed(3)+" ms"}};function $J(nt){let st;if(nt.index)for(let mt=0;mt<nt.index.array.length;mt+=3)st=nt.index.array[mt],nt.index.array[mt]=nt.index.array[mt+2],nt.index.array[mt+2]=st}function mg(nt){return nt instanceof Ks?"SubdivObject":nt.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function e$(nt,st){let mt={};return nt.traverseEntity(gt=>{var Ft;if(!gt.visible||!(gt instanceof mr)||gt.type!=="Mesh"||Array.isArray(gt.material)||gt.states&&Object.keys(gt.states).length)return;let _t=gt.parent;for(;_t;){if(_t instanceof mr&&gt.states&&Object.keys(gt.states).length)return;_t=_t.parent}let Et=gt.material.uuid,At=st.shared.materials[Et];if(At){if(!Qr.isMergable(At))return}else{let Nt=(Ft=st.scene.objects.get(gt.uuid))==null?void 0:Ft.data;if(Nt&&"material"in Nt&&typeof Nt.material!="string"){if(!Qr.isMergable(Nt.material))return;Et=Qr.getHash(Nt.material)}}mt[Et]||(mt[Et]={});let Rt=mt[Et][mg(gt)];if(Rt){if(Rt.push(gt),gt.cloner)for(let Nt of gt.cloner.children)Rt.push(Nt)}else if(mt[Et][mg(gt)]=[gt],gt.cloner)for(let Nt of gt.cloner.children)mt[Et][mg(gt)].push(Nt)}),mt}function t$(nt){let st=0;return Object.values(nt).forEach(mt=>{Object.values(mt).forEach(gt=>{let _t=gt.length;_t>st&&(st=_t)})}),st}function KN(nt,st){let mt=e$(st,nt),gt=t$(mt),_t=new Array(gt),Et=0,At=new Array(gt),Rt=0,Ft=new Array(gt),Nt=0,Bt=new Array(gt),Gt=0;for(let[dr,Mr]of Object.entries(mt))for(let Tr of Object.values(Mr)){if(Rt=0,Nt=0,Tr.forEach(Fr=>{Fr instanceof mr&&(At[Rt++]=Fr.geometry.clone(),Ft[Nt++]=Fr)}),Nt<2)continue;for(let Fr=0;Fr<Nt;Fr++)Ft[Fr].updateWorldMatrix(!0,!1),At[Fr].applyMatrix4(Ft[Fr].matrixWorld),Ft[Fr].matrixWorld.determinant()<0&&$J(At[Fr]);let zr=ks(At.slice(0,Rt),!1);if(zr){let Fr;switch(dr){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),Fr=new Ut(zr,Ft[0].material);break}default:{Fr=new Ut(zr,Ft[0].material);break}}Fr.castShadow=Ft[0].castShadow,Fr.receiveShadow=Ft[0].receiveShadow,st.add(Fr);let Nr=tn=>{Gt=0;for(let rn of tn)rn.children&&Nr(rn.children),rn instanceof mr&&(Array.isArray(rn.material)||mt[rn.material.uuid]&&mt[rn.material.uuid][mg(rn)]&&mt[rn.material.uuid][mg(rn)].length>1||(Bt[Gt++]=rn));for(let rn=0;rn<Gt;rn++)st.attach(Bt[rn])};for(let tn=0;tn<Nt;tn++){let rn=Ft[tn];Nr(rn.children),_t[Et++]=rn}}}for(let dr=0;dr<Et;dr++)_t[dr].removeFromParent()}var eF=Jo(JN(),1),i$=new U$1;function n$(nt){let st="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";nt.endsWith(".spline")?console.warn(st+" The .spline files are only meant to be used by the Editor."):nt.endsWith(".splinecode")||console.warn(st)}var $N=class{constructor(nt,{renderOnDemand:st,renderMode:mt="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=gt=>{var _t,Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr;if(this.time=gt,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,(_t=this._perfs)==null||_t.start(),!this._renderer){(Et=this._perfs)==null||Et.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(At=this._perfs)==null||At.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((Rt=this._eventManager.handlers)!=null&&Rt.Start.hasVideoAction||(Ft=this._eventManager.handlers)!=null&&Ft.Basic.hasVideoAction||(Nt=this._eventManager.handlers)!=null&&Nt.Conditional.hasVideoAction)&&(this._skipRender=!1),(Bt=this._animationControls)==null||Bt.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,(Gt=this._scene)==null||Gt.traverseVisibleEntity(Nr=>{Nr.type==="ParticleSystem"&&(Nr.update(this.dt),this._skipRender=!1)}),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),(dr=this._eventManager)!=null&&dr.isEnabled&&(((Mr=this._eventManager.handlers)==null?void 0:Mr.Follow).onAnimationFrameDamping(),((Tr=this._eventManager.handlers)==null?void 0:Tr.LookAt).onAnimationFrameDamping(),((zr=this._eventManager.handlers)==null?void 0:zr.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let Nr=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=Nr,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(Fr=this._perfs)==null||Fr.end()},this._resize=gt=>{var _t,Et,At,Rt,Ft,Nt,Bt,Gt,dr,Mr;if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=i$.set(this._viewportWidth,this._viewportHeight)),gt){let Tr=this._viewportWidth,zr=this._viewportHeight;this._renderer.setSize(Tr-1,zr-1,!1),this._renderer.setSize(Tr,zr,!1)}else this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1);if(this._camera=(_t=this._scene)==null?void 0:_t.activeCamera,(Bt=this._scene)==null||Bt.updateViewPlaneSize(((At=(Et=this._frameView)==null?void 0:Et.frameSize)==null?void 0:At.x)??this._viewportWidth,((Ft=(Rt=this._frameView)==null?void 0:Rt.frameSize)==null?void 0:Ft.y)??this._viewportHeight,((Nt=this._frameView)==null?void 0:Nt.enableResponsive)??!1),this._camera){let Tr=Object.values(((Gt=this._data)==null?void 0:Gt.frames)??{})[0].preset??"fullscreen";(dr=this._frameView)==null||dr.setCamera(this._camera),(Mr=this._frameView)==null||Mr.updateCamera(Tr!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=Tc(this._resize,10),this._onScroll=gt=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=nt,this.renderMode=st?"auto":mt,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new Kb({x:10,y:10})),q2(nt)}async load(nt,st,mt){n$(nt),this.disposed=!1;let gt=await(await fetch(nt,mt)).arrayBuffer();await this.start(gt,{variables:st})}async start(nt,{interactive:st=!0,variables:mt}={}){var Ft,Nt,Bt,Gt;if(this.disposed)return;let gt=await GN(nt);this._data=gt;let _t=jN(gt);gt.version&&(0,eF.default)(gt.version,"1.9.30")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([_t.length&&kN(),DE(gt)&&KO(),qR(gt)&&jO(),El.physicsEnabled(gt.scene.objects)&&$2(),wE(gt)&&FR(),Jx(gt)&&nM(),LR(gt)&&OR(),GE(gt)&&uL(),ZM(gt)&&K2()].filter(Boolean)),_t.length&&await HN(_t),(Ft=this._eventManager)==null||Ft.deactivate(),(Nt=this._controls)==null||Nt.deactivate(),(Bt=this._scene)==null||Bt.dispose();let Et=new Qb(gt);if(Et.resetPersonalCameraFromDocumentData(),this._scene=Et.scene,this._sharedAssetsManager=Et.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let dr=performance.now();KN(gt,Et.scene);let Mr=performance.now();console.log("Merged geometries in ",Mr-dr," ms")}DE(gt)&&this._scene.traverse(dr=>{En(dr)&&dr.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var dr;this._requestRenderAutoMode(),(dr=this._scene)==null||dr.traverse(Mr=>{Mr instanceof Gi&&Mr.pendingMediaLoad&&Mr.update()})}),(Gt=this._scene)==null||Gt.traverse(dr=>{dr.type==="ParticleSystem"&&(dr.wakeUp(),dr.data.autoPlay?dr.start():dr.stop())});let At=Object.keys(gt.shared.fonts).map(dr=>this._sharedAssetsManager.getFont(dr).loadingPromise);if(Promise.all(At).then(()=>{Et.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),wE(gt)&&VN(gt)&&await Promise.all(At),GE(gt)){let dr=[];this._scene.traverseEntity(Mr=>{(Mr instanceof Er||Mr instanceof cr)&&Mr.uiCanvas&&dr.push(Mr.uiCanvas)}),await Promise.all(dr.map(Mr=>Mr.promise))}if(this._scene.rewriteEventsBeforeGoToPlayMode(),If(this._scene.activePage,this._sharedAssetsManager),!this._renderer&&(this._renderer=new Px({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=gt.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode),gt.shared.images.SplineWatermark)){let dr=this._sharedAssetsManager.getImage("SplineWatermark");await dr.loadPromise;let Mr=dr.getTexture(1001);this._renderer.pipeline.setWatermark(Mr)}Jx(gt)&&this._scene.initializeSplatViewer(),gt.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(gt.scene.blueNoiseTextureData);let Rt=Object.values(gt.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(Rt.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=Rt.size[0],this._viewportHeight=Rt.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new Xb(this._renderer,this._camera,new U$1(this._viewportWidth,this._viewportHeight),new U$1(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(Rt.allowResponsive??!1)&&Rt.preset==="fullscreen"),st){let dr=new bb(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,Rt);this._scene.updateMatrixWorld(!0),this._controls=new Vb(dr),this._animationControls=new Ub(this._scene,this._requestRenderAutoMode),this._eventManager=new Yb(gt.scene.publish,this._controls,this._animationControls,dr,gt.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this._scene.activePage.data.postprocessing.depthOfField.enabled&&Promise.all(this._sharedAssetsManager.getImageLoadPromises()).then(()=>{this._resize(!0)}),mt!==void 0&&this.setVariables(mt),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{var dr;(dr=this._renderer)==null||dr.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300),document.addEventListener("scroll",this._onScroll)}setVariables(nt){if(this._data!==void 0){let st=Object.entries(nt);for(let[mt,gt]of st)this.setVariable(mt,gt)}}setVariable(nt,st){var gt;let mt=this._getVariableByName(nt);if(mt&&!("dynamicVariableType"in mt.data)){let _t=st;typeof mt.data.value=="number"?_t=typeof st=="number"?st:typeof st=="boolean"?st===!0?1:0:parseFloat(st):typeof mt.data.value=="boolean"?_t=typeof st=="number"?!!st:typeof st=="boolean"?st:st.toLocaleLowerCase()==="false"?!1:!!st:typeof mt.data.value!="string"&&mt.data.value.textValue!==void 0&&(_t=st.toString());let Et=typeof _t=="string"?{textValue:_t}:_t;(gt=this._sharedAssetsManager)==null||gt.updateVariable(mt.id,Et),this.requestRender(),this._requestRenderAutoMode()}else mt===void 0?console.warn(`No variable named ${nt} was found in your Spline file. Make sure to create it from Spline editor.`):"dynamicVariableType"in mt.data&&console.warn(`Dynamic variables like ${nt} cannot be updated from code.`)}getVariables(){let nt={};return this._data&&this._data.shared.variables.forEach(st=>{nt[st.data.name]===void 0&&(nt[st.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(st.id)))}),nt}getVariable(nt){let st=this._getVariableByName(nt);if(st){let mt=this._sharedAssetsManager.getVariable(st.id);return this._getVariableValue(mt)}}_getVariableValue(nt){return typeof nt!="string"&&Lr.isTextValue(nt)?Lr.getDisplayedValue(nt):nt}_getVariableByName(nt){if(this._data){if(this._variablesCache.has(nt))return this._variablesCache.get(nt);let st=this._data.shared.variables.find(mt=>mt.data.name===nt);return st&&this._variablesCache.set(nt,st),st}}findObjectById(nt){var mt;let st=(mt=this._scene)==null?void 0:mt.getObjectByProperty("uuid",nt);return this._createProxyObject(st)}findObjectByName(nt){var mt;let st=(mt=this._scene)==null?void 0:mt.getObjectByName(nt);return this._createProxyObject(st)}getAllObjects(){var st;let nt=[];return(st=this._scene)==null||st.traverseEntity(mt=>{if(mt.uuid!==hs&&!this._scene.isInvisibleObjects(mt)&&!(mt instanceof cr)){let gt=this._createProxyObject(mt);gt&&nt.push(gt)}}),nt}getSplineEvents(){var nt,st;return((st=(nt=this._eventManager)==null?void 0:nt.handlers)==null?void 0:st.Spline).splineEvents}emitEvent(nt,st){var mt;(mt=this.findObjectById(st)||this.findObjectByName(st))==null||mt.emitEvent(nt)}emitEventReverse(nt,st){var mt;(mt=this.findObjectById(st)||this.findObjectByName(st))==null||mt.emitEventReverse(nt)}addEventListener(nt,st){this.canvas.addEventListener(nt,st)}removeEventListener(nt,st){this.canvas.removeEventListener(nt,st)}setZoom(nt){var st,mt;((st=this._controls)==null?void 0:st.orbitControls)instanceof zf&&((mt=this._controls)==null||mt.orbitControls.setZoom(nt))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(nt,st){this._viewportWidth=nt,this._viewportHeight=st,this._viewportMode=2,this._resize()}setBackgroundColor(nt){var At;let{r:st,g:mt,b:gt,a:_t}={r:0,g:0,b:0,a:1},Et=new vr(st,mt,gt,_t);try{Et.setStyle(nt)}catch{console.error("This is not a valid css color",nt)}(At=this._scene)==null||At.activePage.setBackgroundColor(Et),this._requestRenderAutoMode()}dispose(){var nt,st,mt,gt,_t,Et,At;this.disposed=!0,(nt=this._eventManager)==null||nt.deactivate(),(st=this._scene)==null||st.dispose(),(mt=this._sharedAssetsManager)==null||mt.dispose(),this._proxyObjectCache.forEach(Rt=>{Gw.unsubscribe(Rt)}),this._variablesCache.clear(),(gt=this._renderer)==null||gt.setAnimationLoop(null),(_t=this._renderer)==null||_t.dispose(),this._renderer=void 0,(Et=this._sharedAssetsManager)==null||Et.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(At=this._controls)==null||At.deactivate(),this.dt=0,Y2(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){var nt,st,mt;this._isPaused||((nt=this._renderer)==null||nt.setAnimationLoop(null),this._isPaused=!0,(st=this._eventManager)==null||st.pause(),(mt=this._controls)!=null&&mt.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var nt,st,mt;!this._isPaused||(this._isPaused=!1,(nt=this._eventManager)==null||nt.resume(),(st=this._controls)!=null&&st.orbitControls&&(this._controls.orbitControls.enabled=!0),(mt=this._renderer)==null||mt.setAnimationLoop(this.render))}setGlobalEvents(nt){var st;(st=this._eventManager)==null||st.updateUseWindowEvents(nt)}get data(){return this._data}_createProxyObject(nt){var _t;if(nt==null)return;if(this._proxyObjectCache.has(nt.uuid))return this._proxyObjectCache.get(nt.uuid);let st;nt.traverseAncestors(Et=>{Et instanceof cr&&(st=Et.name)});let mt={name:nt.name,uuid:nt.uuid,visible:nt.visible,intensity:nt.intensity,position:nt.position,rotation:nt.rotation,scale:nt.scale,type:nt.data.type,page:st,parentUuid:nt.parent instanceof cr||nt instanceof Hl||(_t=nt.parent)==null?void 0:_t.uuid,emitEvent(Et){nt.dispatchEvent({type:"userEvent",eventName:Et})},emitEventReverse(Et){nt.dispatchEvent({type:"userEvent",eventName:Et,reverse:!0})}},gt=Gw(mt,(Et,At)=>{var Rt;typeof nt[Et]!="object"&&((Rt=Object.getOwnPropertyDescriptor(nt,Et))!=null&&Rt.writable)&&(nt[Et]=At),this._requestRenderAutoMode(),nt.updateMatrix()});return this._proxyObjectCache.set(nt.uuid,gt),gt}setUIWasmUrl(nt){z0.skiaWasmUrl=nt}},FUNC_ERROR_TEXT="Expected a function",NAN=NaN,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function debounce(nt,st,mt){var gt,_t,Et,At,Rt,Ft,Nt=0,Bt=!1,Gt=!1,dr=!0;if(typeof nt!="function")throw new TypeError(FUNC_ERROR_TEXT);st=toNumber(st)||0,isObject(mt)&&(Bt=!!mt.leading,Gt="maxWait"in mt,Et=Gt?nativeMax(toNumber(mt.maxWait)||0,st):Et,dr="trailing"in mt?!!mt.trailing:dr);function Mr(un){var es=gt,kn=_t;return gt=_t=void 0,Nt=un,At=nt.apply(kn,es),At}function Tr(un){return Nt=un,Rt=setTimeout(Nr,st),Bt?Mr(un):At}function zr(un){var es=un-Ft,kn=un-Nt,ts=st-es;return Gt?nativeMin(ts,Et-kn):ts}function Fr(un){var es=un-Ft,kn=un-Nt;return Ft===void 0||es>=st||es<0||Gt&&kn>=Et}function Nr(){var un=now();if(Fr(un))return tn(un);Rt=setTimeout(Nr,zr(un))}function tn(un){return Rt=void 0,dr&&gt?Mr(un):(gt=_t=void 0,At)}function rn(){Rt!==void 0&&clearTimeout(Rt),Nt=0,gt=Ft=_t=Rt=void 0}function Tn(){return Rt===void 0?At:tn(now())}function $n(){var un=now(),es=Fr(un);if(gt=arguments,_t=this,Ft=un,es){if(Rt===void 0)return Tr(Ft);if(Gt)return Rt=setTimeout(Nr,st),Mr(Ft)}return Rt===void 0&&(Rt=setTimeout(Nr,st)),At}return $n.cancel=rn,$n.flush=Tn,$n}function isObject(nt){var st=typeof nt;return!!nt&&(st=="object"||st=="function")}function isObjectLike(nt){return!!nt&&typeof nt=="object"}function isSymbol(nt){return typeof nt=="symbol"||isObjectLike(nt)&&objectToString.call(nt)==symbolTag}function toNumber(nt){if(typeof nt=="number")return nt;if(isSymbol(nt))return NAN;if(isObject(nt)){var st=typeof nt.valueOf=="function"?nt.valueOf():nt;nt=isObject(st)?st+"":st}if(typeof nt!="string")return nt===0?nt:+nt;nt=nt.replace(reTrim,"");var mt=reIsBinary.test(nt);return mt||reIsOctal.test(nt)?freeParseInt(nt.slice(2),mt?2:8):reIsBadHex.test(nt)?NAN:+nt}var lodash_debounce=debounce;const b$6=getDefaultExportFromCjs(lodash_debounce);function o$f(nt){return st=>{nt.forEach(mt=>{typeof mt=="function"?mt(st):mt!=null&&(mt.current=st)})}}const I$4=[],K$1={width:"100%",height:"100%"},M$4=reactExports.forwardRef(function({className:nt,children:st,debounceTime:mt=300,ignoreDimensions:gt=I$4,parentSizeStyles:_t,enableDebounceLeadingCall:Et=!0,resizeObserverPolyfill:At,...Rt},Ft){const Nt=reactExports.useRef(null),Bt=reactExports.useRef(0),[Gt,dr]=reactExports.useState({width:0,height:0,top:0,left:0}),Mr=reactExports.useMemo(()=>{const Tr=Array.isArray(gt)?gt:[gt];return b$6(zr=>{dr(Fr=>Object.keys(Fr).filter(Nr=>Fr[Nr]!==zr[Nr]).every(Nr=>Tr.includes(Nr))?Fr:zr)},mt,{leading:Et})},[mt,Et,gt]);return reactExports.useEffect(()=>{const Tr=At||window.ResizeObserver,zr=new Tr(Fr=>{Fr.forEach(Nr=>{const{left:tn,top:rn,width:Tn,height:$n}=(Nr==null?void 0:Nr.contentRect)??{};Bt.current=window.requestAnimationFrame(()=>{Mr({width:Tn,height:$n,top:rn,left:tn})})})});return Nt.current&&zr.observe(Nt.current),()=>{window.cancelAnimationFrame(Bt.current),zr.disconnect(),Mr.cancel()}},[Mr,At]),jsxRuntimeExports.jsx("div",{style:{...K$1,..._t},ref:o$f([Ft,Nt]),className:nt,...Rt,children:st({...Gt,ref:Nt.current,resize:Mr})})}),C$5=reactExports.forwardRef(({scene:nt,style:st,onSplineMouseDown:mt,onSplineMouseUp:gt,onSplineMouseHover:_t,onSplineKeyDown:Et,onSplineKeyUp:At,onSplineStart:Rt,onSplineLookAt:Ft,onSplineFollow:Nt,onSplineScroll:Bt,onLoad:Gt,renderOnDemand:dr=!0,children:Mr,...Tr},zr)=>{const Fr=reactExports.useRef(null),[Nr,tn]=reactExports.useState(!0),[rn,Tn]=reactExports.useState();if(rn)throw rn;return reactExports.useEffect(()=>{tn(!0);let $n;const un=[{name:"mouseDown",cb:mt},{name:"mouseUp",cb:gt},{name:"mouseHover",cb:_t},{name:"keyDown",cb:Et},{name:"keyUp",cb:At},{name:"start",cb:Rt},{name:"lookAt",cb:Ft},{name:"follow",cb:Nt},{name:"scroll",cb:Bt}];if(Fr.current){$n=new $N(Fr.current,{renderOnDemand:dr});async function es(){await $n.load(nt);for(let kn of un)kn.cb&&$n.addEventListener(kn.name,kn.cb);tn(!1),Gt==null||Gt($n)}es().catch(kn=>{Tn(kn)})}return()=>{for(let es of un)es.cb&&$n.removeEventListener(es.name,es.cb);$n.dispose()}},[nt]),jsxRuntimeExports.jsx(M$4,{ref:zr,parentSizeStyles:{overflow:"hidden",...st},debounceTime:50,...Tr,children:()=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Nr&&Mr,jsxRuntimeExports.jsx("canvas",{ref:Fr,style:{display:Nr?"none":"block"}})]})})});var __assign=function(){return __assign=Object.assign||function(st){for(var mt,gt=1,_t=arguments.length;gt<_t;gt++){mt=arguments[gt];for(var Et in mt)Object.prototype.hasOwnProperty.call(mt,Et)&&(st[Et]=mt[Et])}return st},__assign.apply(this,arguments)};function __spreadArray(nt,st,mt){if(mt||arguments.length===2)for(var gt=0,_t=st.length,Et;gt<_t;gt++)(Et||!(gt in st))&&(Et||(Et=Array.prototype.slice.call(st,0,gt)),Et[gt]=st[gt]);return nt.concat(Et||Array.prototype.slice.call(st))}typeof SuppressedError=="function"&&SuppressedError;var MS="-ms-",MOZ="-moz-",WEBKIT="-webkit-",COMMENT="comm",RULESET="rule",DECLARATION="decl",IMPORT="@import",KEYFRAMES="@keyframes",LAYER="@layer",abs=Math.abs,from=String.fromCharCode,assign=Object.assign;function hash(nt,st){return charat(nt,0)^45?(((st<<2^charat(nt,0))<<2^charat(nt,1))<<2^charat(nt,2))<<2^charat(nt,3):0}function trim(nt){return nt.trim()}function match(nt,st){return(nt=st.exec(nt))?nt[0]:nt}function replace$1(nt,st,mt){return nt.replace(st,mt)}function indexof(nt,st,mt){return nt.indexOf(st,mt)}function charat(nt,st){return nt.charCodeAt(st)|0}function substr(nt,st,mt){return nt.slice(st,mt)}function strlen(nt){return nt.length}function sizeof(nt){return nt.length}function append(nt,st){return st.push(nt),nt}function combine(nt,st){return nt.map(st).join("")}function filter(nt,st){return nt.filter(function(mt){return!match(mt,st)})}var line=1,column=1,length=0,position=0,character=0,characters="";function node(nt,st,mt,gt,_t,Et,At,Rt){return{value:nt,root:st,parent:mt,type:gt,props:_t,children:Et,line,column,length:At,return:"",siblings:Rt}}function copy(nt,st){return assign(node("",null,null,"",null,null,0,nt.siblings),nt,{length:-nt.length},st)}function lift(nt){for(;nt.root;)nt=copy(nt.root,{children:[nt]});append(nt,nt.siblings)}function char(){return character}function prev(){return character=position>0?charat(characters,--position):0,column--,character===10&&(column=1,line--),character}function next(){return character=position<length?charat(characters,position++):0,column++,character===10&&(column=1,line++),character}function peek(){return charat(characters,position)}function caret(){return position}function slice(nt,st){return substr(characters,nt,st)}function token(nt){switch(nt){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc(nt){return line=column=1,length=strlen(characters=nt),position=0,[]}function dealloc(nt){return characters="",nt}function delimit(nt){return trim(slice(position-1,delimiter(nt===91?nt+2:nt===40?nt+1:nt)))}function whitespace(nt){for(;(character=peek())&&character<33;)next();return token(nt)>2||token(character)>3?"":" "}function escaping(nt,st){for(;--st&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice(nt,caret()+(st<6&&peek()==32&&next()==32))}function delimiter(nt){for(;next();)switch(character){case nt:return position;case 34:case 39:nt!==34&&nt!==39&&delimiter(character);break;case 40:nt===41&&delimiter(nt);break;case 92:next();break}return position}function commenter(nt,st){for(;next()&&nt+character!==57;)if(nt+character===84&&peek()===47)break;return"/*"+slice(st,position-1)+"*"+from(nt===47?nt:next())}function identifier(nt){for(;!token(peek());)next();return slice(nt,position)}function compile(nt){return dealloc(parse$2("",null,null,null,[""],nt=alloc(nt),0,[0],nt))}function parse$2(nt,st,mt,gt,_t,Et,At,Rt,Ft){for(var Nt=0,Bt=0,Gt=At,dr=0,Mr=0,Tr=0,zr=1,Fr=1,Nr=1,tn=0,rn="",Tn=_t,$n=Et,un=gt,es=rn;Fr;)switch(Tr=tn,tn=next()){case 40:if(Tr!=108&&charat(es,Gt-1)==58){indexof(es+=replace$1(delimit(tn),"&","&\f"),"&\f",abs(Nt?Rt[Nt-1]:0))!=-1&&(Nr=-1);break}case 34:case 39:case 91:es+=delimit(tn);break;case 9:case 10:case 13:case 32:es+=whitespace(Tr);break;case 92:es+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:append(comment(commenter(next(),caret()),st,mt,Ft),Ft);break;default:es+="/"}break;case 123*zr:Rt[Nt++]=strlen(es)*Nr;case 125*zr:case 59:case 0:switch(tn){case 0:case 125:Fr=0;case 59+Bt:Nr==-1&&(es=replace$1(es,/\f/g,"")),Mr>0&&strlen(es)-Gt&&append(Mr>32?declaration(es+";",gt,mt,Gt-1,Ft):declaration(replace$1(es," ","")+";",gt,mt,Gt-2,Ft),Ft);break;case 59:es+=";";default:if(append(un=ruleset(es,st,mt,Nt,Bt,_t,Rt,rn,Tn=[],$n=[],Gt,Et),Et),tn===123)if(Bt===0)parse$2(es,st,un,un,Tn,Et,Gt,Rt,$n);else switch(dr===99&&charat(es,3)===110?100:dr){case 100:case 108:case 109:case 115:parse$2(nt,un,un,gt&&append(ruleset(nt,un,un,0,0,_t,Rt,rn,_t,Tn=[],Gt,$n),$n),_t,$n,Gt,Rt,gt?Tn:$n);break;default:parse$2(es,un,un,un,[""],$n,0,Rt,$n)}}Nt=Bt=Mr=0,zr=Nr=1,rn=es="",Gt=At;break;case 58:Gt=1+strlen(es),Mr=Tr;default:if(zr<1){if(tn==123)--zr;else if(tn==125&&zr++==0&&prev()==125)continue}switch(es+=from(tn),tn*zr){case 38:Nr=Bt>0?1:(es+="\f",-1);break;case 44:Rt[Nt++]=(strlen(es)-1)*Nr,Nr=1;break;case 64:peek()===45&&(es+=delimit(next())),dr=peek(),Bt=Gt=strlen(rn=es+=identifier(caret())),tn++;break;case 45:Tr===45&&strlen(es)==2&&(zr=0)}}return Et}function ruleset(nt,st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt){for(var dr=_t-1,Mr=_t===0?Et:[""],Tr=sizeof(Mr),zr=0,Fr=0,Nr=0;zr<gt;++zr)for(var tn=0,rn=substr(nt,dr+1,dr=abs(Fr=At[zr])),Tn=nt;tn<Tr;++tn)(Tn=trim(Fr>0?Mr[tn]+" "+rn:replace$1(rn,/&\f/g,Mr[tn])))&&(Ft[Nr++]=Tn);return node(nt,st,mt,_t===0?RULESET:Rt,Ft,Nt,Bt,Gt)}function comment(nt,st,mt,gt){return node(nt,st,mt,COMMENT,from(char()),substr(nt,2,-2),0,gt)}function declaration(nt,st,mt,gt,_t){return node(nt,st,mt,DECLARATION,substr(nt,0,gt),substr(nt,gt+1,-1),gt,_t)}function prefix(nt,st,mt){switch(hash(nt,st)){case 5103:return WEBKIT+"print-"+nt+nt;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return WEBKIT+nt+nt;case 4789:return MOZ+nt+nt;case 5349:case 4246:case 4810:case 6968:case 2756:return WEBKIT+nt+MOZ+nt+MS+nt+nt;case 5936:switch(charat(nt,st+11)){case 114:return WEBKIT+nt+MS+replace$1(nt,/[svh]\w+-[tblr]{2}/,"tb")+nt;case 108:return WEBKIT+nt+MS+replace$1(nt,/[svh]\w+-[tblr]{2}/,"tb-rl")+nt;case 45:return WEBKIT+nt+MS+replace$1(nt,/[svh]\w+-[tblr]{2}/,"lr")+nt}case 6828:case 4268:case 2903:return WEBKIT+nt+MS+nt+nt;case 6165:return WEBKIT+nt+MS+"flex-"+nt+nt;case 5187:return WEBKIT+nt+replace$1(nt,/(\w+).+(:[^]+)/,WEBKIT+"box-$1$2"+MS+"flex-$1$2")+nt;case 5443:return WEBKIT+nt+MS+"flex-item-"+replace$1(nt,/flex-|-self/g,"")+(match(nt,/flex-|baseline/)?"":MS+"grid-row-"+replace$1(nt,/flex-|-self/g,""))+nt;case 4675:return WEBKIT+nt+MS+"flex-line-pack"+replace$1(nt,/align-content|flex-|-self/g,"")+nt;case 5548:return WEBKIT+nt+MS+replace$1(nt,"shrink","negative")+nt;case 5292:return WEBKIT+nt+MS+replace$1(nt,"basis","preferred-size")+nt;case 6060:return WEBKIT+"box-"+replace$1(nt,"-grow","")+WEBKIT+nt+MS+replace$1(nt,"grow","positive")+nt;case 4554:return WEBKIT+replace$1(nt,/([^-])(transform)/g,"$1"+WEBKIT+"$2")+nt;case 6187:return replace$1(replace$1(replace$1(nt,/(zoom-|grab)/,WEBKIT+"$1"),/(image-set)/,WEBKIT+"$1"),nt,"")+nt;case 5495:case 3959:return replace$1(nt,/(image-set\([^]*)/,WEBKIT+"$1$`$1");case 4968:return replace$1(replace$1(nt,/(.+:)(flex-)?(.*)/,WEBKIT+"box-pack:$3"+MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+WEBKIT+nt+nt;case 4200:if(!match(nt,/flex-|baseline/))return MS+"grid-column-align"+substr(nt,st)+nt;break;case 2592:case 3360:return MS+replace$1(nt,"template-","")+nt;case 4384:case 3616:return mt&&mt.some(function(gt,_t){return st=_t,match(gt.props,/grid-\w+-end/)})?~indexof(nt+(mt=mt[st].value),"span",0)?nt:MS+replace$1(nt,"-start","")+nt+MS+"grid-row-span:"+(~indexof(mt,"span",0)?match(mt,/\d+/):+match(mt,/\d+/)-+match(nt,/\d+/))+";":MS+replace$1(nt,"-start","")+nt;case 4896:case 4128:return mt&&mt.some(function(gt){return match(gt.props,/grid-\w+-start/)})?nt:MS+replace$1(replace$1(nt,"-end","-span"),"span ","")+nt;case 4095:case 3583:case 4068:case 2532:return replace$1(nt,/(.+)-inline(.+)/,WEBKIT+"$1$2")+nt;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(strlen(nt)-1-st>6)switch(charat(nt,st+1)){case 109:if(charat(nt,st+4)!==45)break;case 102:return replace$1(nt,/(.+:)(.+)-([^]+)/,"$1"+WEBKIT+"$2-$3$1"+MOZ+(charat(nt,st+3)==108?"$3":"$2-$3"))+nt;case 115:return~indexof(nt,"stretch",0)?prefix(replace$1(nt,"stretch","fill-available"),st,mt)+nt:nt}break;case 5152:case 5920:return replace$1(nt,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(gt,_t,Et,At,Rt,Ft,Nt){return MS+_t+":"+Et+Nt+(At?MS+_t+"-span:"+(Rt?Ft:+Ft-+Et)+Nt:"")+nt});case 4949:if(charat(nt,st+6)===121)return replace$1(nt,":",":"+WEBKIT)+nt;break;case 6444:switch(charat(nt,charat(nt,14)===45?18:11)){case 120:return replace$1(nt,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+WEBKIT+(charat(nt,14)===45?"inline-":"")+"box$3$1"+WEBKIT+"$2$3$1"+MS+"$2box$3")+nt;case 100:return replace$1(nt,":",":"+MS)+nt}break;case 5719:case 2647:case 2135:case 3927:case 2391:return replace$1(nt,"scroll-","scroll-snap-")+nt}return nt}function serialize(nt,st){for(var mt="",gt=0;gt<nt.length;gt++)mt+=st(nt[gt],gt,nt,st)||"";return mt}function stringify(nt,st,mt,gt){switch(nt.type){case LAYER:if(nt.children.length)break;case IMPORT:case DECLARATION:return nt.return=nt.return||nt.value;case COMMENT:return"";case KEYFRAMES:return nt.return=nt.value+"{"+serialize(nt.children,gt)+"}";case RULESET:if(!strlen(nt.value=nt.props.join(",")))return""}return strlen(mt=serialize(nt.children,gt))?nt.return=nt.value+"{"+mt+"}":""}function middleware(nt){var st=sizeof(nt);return function(mt,gt,_t,Et){for(var At="",Rt=0;Rt<st;Rt++)At+=nt[Rt](mt,gt,_t,Et)||"";return At}}function rulesheet(nt){return function(st){st.root||(st=st.return)&&nt(st)}}function prefixer(nt,st,mt,gt){if(nt.length>-1&&!nt.return)switch(nt.type){case DECLARATION:nt.return=prefix(nt.value,nt.length,mt);return;case KEYFRAMES:return serialize([copy(nt,{value:replace$1(nt.value,"@","@"+WEBKIT)})],gt);case RULESET:if(nt.length)return combine(mt=nt.props,function(_t){switch(match(_t,gt=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":lift(copy(nt,{props:[replace$1(_t,/:(read-\w+)/,":"+MOZ+"$1")]})),lift(copy(nt,{props:[_t]})),assign(nt,{props:filter(mt,gt)});break;case"::placeholder":lift(copy(nt,{props:[replace$1(_t,/:(plac\w+)/,":"+WEBKIT+"input-$1")]})),lift(copy(nt,{props:[replace$1(_t,/:(plac\w+)/,":"+MOZ+"$1")]})),lift(copy(nt,{props:[replace$1(_t,/:(plac\w+)/,MS+"input-$1")]})),lift(copy(nt,{props:[_t]})),assign(nt,{props:filter(mt,gt)});break}return""})}}var unitlessKeys={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},define_process_env_default$1={},f$a=typeof process<"u"&&define_process_env_default$1!==void 0&&(define_process_env_default$1.REACT_APP_SC_ATTR||define_process_env_default$1.SC_ATTR)||"data-styled",m$a="active",y$3="data-styled-version",v$6="6.1.13",g$6=`/*!sc*/
`,S$5=typeof window<"u"&&"HTMLElement"in window,w$2=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&define_process_env_default$1!==void 0&&define_process_env_default$1.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&define_process_env_default$1.REACT_APP_SC_DISABLE_SPEEDY!==""?define_process_env_default$1.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&define_process_env_default$1.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&define_process_env_default$1!==void 0&&define_process_env_default$1.SC_DISABLE_SPEEDY!==void 0&&define_process_env_default$1.SC_DISABLE_SPEEDY!==""&&define_process_env_default$1.SC_DISABLE_SPEEDY!=="false"&&define_process_env_default$1.SC_DISABLE_SPEEDY),b$5={},_$1=Object.freeze([]),C$4=Object.freeze({});function I$3(nt,st,mt){return mt===void 0&&(mt=C$4),nt.theme!==mt.theme&&nt.theme||st||mt.theme}var A=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),O=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,D$1=/(^-|-$)/g;function R(nt){return nt.replace(O,"-").replace(D$1,"")}var T$1=/(a)(d)/gi,k$4=52,j$1=function(nt){return String.fromCharCode(nt+(nt>25?39:97))};function x$2(nt){var st,mt="";for(st=Math.abs(nt);st>k$4;st=st/k$4|0)mt=j$1(st%k$4)+mt;return(j$1(st%k$4)+mt).replace(T$1,"$1-$2")}var V,F$1=5381,M$3=function(nt,st){for(var mt=st.length;mt;)nt=33*nt^st.charCodeAt(--mt);return nt},z$1=function(nt){return M$3(F$1,nt)};function $(nt){return x$2(z$1(nt)>>>0)}function B(nt){return nt.displayName||nt.name||"Component"}function L$1(nt){return typeof nt=="string"&&!0}var G=typeof Symbol=="function"&&Symbol.for,Y=G?Symbol.for("react.memo"):60115,W=G?Symbol.for("react.forward_ref"):60112,q={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},H={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},U={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},J=((V={})[W]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},V[Y]=U,V);function X(nt){return("type"in(st=nt)&&st.type.$$typeof)===Y?U:"$$typeof"in nt?J[nt.$$typeof]:q;var st}var Z$1=Object.defineProperty,K=Object.getOwnPropertyNames,Q=Object.getOwnPropertySymbols,ee=Object.getOwnPropertyDescriptor,te=Object.getPrototypeOf,ne=Object.prototype;function oe(nt,st,mt){if(typeof st!="string"){if(ne){var gt=te(st);gt&&gt!==ne&&oe(nt,gt,mt)}var _t=K(st);Q&&(_t=_t.concat(Q(st)));for(var Et=X(nt),At=X(st),Rt=0;Rt<_t.length;++Rt){var Ft=_t[Rt];if(!(Ft in H||mt&&mt[Ft]||At&&Ft in At||Et&&Ft in Et)){var Nt=ee(st,Ft);try{Z$1(nt,Ft,Nt)}catch{}}}}return nt}function re(nt){return typeof nt=="function"}function se(nt){return typeof nt=="object"&&"styledComponentId"in nt}function ie(nt,st){return nt&&st?"".concat(nt," ").concat(st):nt||st||""}function ae(nt,st){if(nt.length===0)return"";for(var mt=nt[0],gt=1;gt<nt.length;gt++)mt+=nt[gt];return mt}function ce(nt){return nt!==null&&typeof nt=="object"&&nt.constructor.name===Object.name&&!("props"in nt&&nt.$$typeof)}function le(nt,st,mt){if(mt===void 0&&(mt=!1),!mt&&!ce(nt)&&!Array.isArray(nt))return st;if(Array.isArray(st))for(var gt=0;gt<st.length;gt++)nt[gt]=le(nt[gt],st[gt]);else if(ce(st))for(var gt in st)nt[gt]=le(nt[gt],st[gt]);return nt}function ue(nt,st){Object.defineProperty(nt,"toString",{value:st})}function he(nt){for(var st=[],mt=1;mt<arguments.length;mt++)st[mt-1]=arguments[mt];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(nt," for more information.").concat(st.length>0?" Args: ".concat(st.join(", ")):""))}var fe=function(){function nt(st){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=st}return nt.prototype.indexOfGroup=function(st){for(var mt=0,gt=0;gt<st;gt++)mt+=this.groupSizes[gt];return mt},nt.prototype.insertRules=function(st,mt){if(st>=this.groupSizes.length){for(var gt=this.groupSizes,_t=gt.length,Et=_t;st>=Et;)if((Et<<=1)<0)throw he(16,"".concat(st));this.groupSizes=new Uint32Array(Et),this.groupSizes.set(gt),this.length=Et;for(var At=_t;At<Et;At++)this.groupSizes[At]=0}for(var Rt=this.indexOfGroup(st+1),Ft=(At=0,mt.length);At<Ft;At++)this.tag.insertRule(Rt,mt[At])&&(this.groupSizes[st]++,Rt++)},nt.prototype.clearGroup=function(st){if(st<this.length){var mt=this.groupSizes[st],gt=this.indexOfGroup(st),_t=gt+mt;this.groupSizes[st]=0;for(var Et=gt;Et<_t;Et++)this.tag.deleteRule(gt)}},nt.prototype.getGroup=function(st){var mt="";if(st>=this.length||this.groupSizes[st]===0)return mt;for(var gt=this.groupSizes[st],_t=this.indexOfGroup(st),Et=_t+gt,At=_t;At<Et;At++)mt+="".concat(this.tag.getRule(At)).concat(g$6);return mt},nt}(),ye=new Map,ve=new Map,ge=1,Se=function(nt){if(ye.has(nt))return ye.get(nt);for(;ve.has(ge);)ge++;var st=ge++;return ye.set(nt,st),ve.set(st,nt),st},we=function(nt,st){ge=st+1,ye.set(nt,st),ve.set(st,nt)},be="style[".concat(f$a,"][").concat(y$3,'="').concat(v$6,'"]'),Ee=new RegExp("^".concat(f$a,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),Ne=function(nt,st,mt){for(var gt,_t=mt.split(","),Et=0,At=_t.length;Et<At;Et++)(gt=_t[Et])&&nt.registerName(st,gt)},Pe=function(nt,st){for(var mt,gt=((mt=st.textContent)!==null&&mt!==void 0?mt:"").split(g$6),_t=[],Et=0,At=gt.length;Et<At;Et++){var Rt=gt[Et].trim();if(Rt){var Ft=Rt.match(Ee);if(Ft){var Nt=0|parseInt(Ft[1],10),Bt=Ft[2];Nt!==0&&(we(Bt,Nt),Ne(nt,Bt,Ft[3]),nt.getTag().insertRules(Nt,_t)),_t.length=0}else _t.push(Rt)}}},_e=function(nt){for(var st=document.querySelectorAll(be),mt=0,gt=st.length;mt<gt;mt++){var _t=st[mt];_t&&_t.getAttribute(f$a)!==m$a&&(Pe(nt,_t),_t.parentNode&&_t.parentNode.removeChild(_t))}};function Ce(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var Ie=function(nt){var st=document.head,mt=nt||st,gt=document.createElement("style"),_t=function(Rt){var Ft=Array.from(Rt.querySelectorAll("style[".concat(f$a,"]")));return Ft[Ft.length-1]}(mt),Et=_t!==void 0?_t.nextSibling:null;gt.setAttribute(f$a,m$a),gt.setAttribute(y$3,v$6);var At=Ce();return At&&gt.setAttribute("nonce",At),mt.insertBefore(gt,Et),gt},Ae=function(){function nt(st){this.element=Ie(st),this.element.appendChild(document.createTextNode("")),this.sheet=function(mt){if(mt.sheet)return mt.sheet;for(var gt=document.styleSheets,_t=0,Et=gt.length;_t<Et;_t++){var At=gt[_t];if(At.ownerNode===mt)return At}throw he(17)}(this.element),this.length=0}return nt.prototype.insertRule=function(st,mt){try{return this.sheet.insertRule(mt,st),this.length++,!0}catch{return!1}},nt.prototype.deleteRule=function(st){this.sheet.deleteRule(st),this.length--},nt.prototype.getRule=function(st){var mt=this.sheet.cssRules[st];return mt&&mt.cssText?mt.cssText:""},nt}(),Oe=function(){function nt(st){this.element=Ie(st),this.nodes=this.element.childNodes,this.length=0}return nt.prototype.insertRule=function(st,mt){if(st<=this.length&&st>=0){var gt=document.createTextNode(mt);return this.element.insertBefore(gt,this.nodes[st]||null),this.length++,!0}return!1},nt.prototype.deleteRule=function(st){this.element.removeChild(this.nodes[st]),this.length--},nt.prototype.getRule=function(st){return st<this.length?this.nodes[st].textContent:""},nt}(),De=function(){function nt(st){this.rules=[],this.length=0}return nt.prototype.insertRule=function(st,mt){return st<=this.length&&(this.rules.splice(st,0,mt),this.length++,!0)},nt.prototype.deleteRule=function(st){this.rules.splice(st,1),this.length--},nt.prototype.getRule=function(st){return st<this.length?this.rules[st]:""},nt}(),Re=S$5,Te={isServer:!S$5,useCSSOMInjection:!w$2},ke=function(){function nt(st,mt,gt){st===void 0&&(st=C$4),mt===void 0&&(mt={});var _t=this;this.options=__assign(__assign({},Te),st),this.gs=mt,this.names=new Map(gt),this.server=!!st.isServer,!this.server&&S$5&&Re&&(Re=!1,_e(this)),ue(this,function(){return function(Et){for(var At=Et.getTag(),Rt=At.length,Ft="",Nt=function(Gt){var dr=function(Nr){return ve.get(Nr)}(Gt);if(dr===void 0)return"continue";var Mr=Et.names.get(dr),Tr=At.getGroup(Gt);if(Mr===void 0||!Mr.size||Tr.length===0)return"continue";var zr="".concat(f$a,".g").concat(Gt,'[id="').concat(dr,'"]'),Fr="";Mr!==void 0&&Mr.forEach(function(Nr){Nr.length>0&&(Fr+="".concat(Nr,","))}),Ft+="".concat(Tr).concat(zr,'{content:"').concat(Fr,'"}').concat(g$6)},Bt=0;Bt<Rt;Bt++)Nt(Bt);return Ft}(_t)})}return nt.registerId=function(st){return Se(st)},nt.prototype.rehydrate=function(){!this.server&&S$5&&_e(this)},nt.prototype.reconstructWithOptions=function(st,mt){return mt===void 0&&(mt=!0),new nt(__assign(__assign({},this.options),st),this.gs,mt&&this.names||void 0)},nt.prototype.allocateGSInstance=function(st){return this.gs[st]=(this.gs[st]||0)+1},nt.prototype.getTag=function(){return this.tag||(this.tag=(st=function(mt){var gt=mt.useCSSOMInjection,_t=mt.target;return mt.isServer?new De(_t):gt?new Ae(_t):new Oe(_t)}(this.options),new fe(st)));var st},nt.prototype.hasNameForId=function(st,mt){return this.names.has(st)&&this.names.get(st).has(mt)},nt.prototype.registerName=function(st,mt){if(Se(st),this.names.has(st))this.names.get(st).add(mt);else{var gt=new Set;gt.add(mt),this.names.set(st,gt)}},nt.prototype.insertRules=function(st,mt,gt){this.registerName(st,mt),this.getTag().insertRules(Se(st),gt)},nt.prototype.clearNames=function(st){this.names.has(st)&&this.names.get(st).clear()},nt.prototype.clearRules=function(st){this.getTag().clearGroup(Se(st)),this.clearNames(st)},nt.prototype.clearTag=function(){this.tag=void 0},nt}(),je=/&/g,xe=/^\s*\/\/.*$/gm;function Ve(nt,st){return nt.map(function(mt){return mt.type==="rule"&&(mt.value="".concat(st," ").concat(mt.value),mt.value=mt.value.replaceAll(",",",".concat(st," ")),mt.props=mt.props.map(function(gt){return"".concat(st," ").concat(gt)})),Array.isArray(mt.children)&&mt.type!=="@keyframes"&&(mt.children=Ve(mt.children,st)),mt})}function Fe(nt){var st,mt,gt,_t=C$4,Et=_t.options,At=Et===void 0?C$4:Et,Rt=_t.plugins,Ft=Rt===void 0?_$1:Rt,Nt=function(dr,Mr,Tr){return Tr.startsWith(mt)&&Tr.endsWith(mt)&&Tr.replaceAll(mt,"").length>0?".".concat(st):dr},Bt=Ft.slice();Bt.push(function(dr){dr.type===RULESET&&dr.value.includes("&")&&(dr.props[0]=dr.props[0].replace(je,mt).replace(gt,Nt))}),At.prefix&&Bt.push(prefixer),Bt.push(stringify);var Gt=function(dr,Mr,Tr,zr){Mr===void 0&&(Mr=""),Tr===void 0&&(Tr=""),zr===void 0&&(zr="&"),st=zr,mt=Mr,gt=new RegExp("\\".concat(mt,"\\b"),"g");var Fr=dr.replace(xe,""),Nr=compile(Tr||Mr?"".concat(Tr," ").concat(Mr," { ").concat(Fr," }"):Fr);At.namespace&&(Nr=Ve(Nr,At.namespace));var tn=[];return serialize(Nr,middleware(Bt.concat(rulesheet(function(rn){return tn.push(rn)})))),tn};return Gt.hash=Ft.length?Ft.reduce(function(dr,Mr){return Mr.name||he(15),M$3(dr,Mr.name)},F$1).toString():"",Gt}var Me=new ke,ze=Fe(),$e=React.createContext({shouldForwardProp:void 0,styleSheet:Me,stylis:ze});$e.Consumer;React.createContext(void 0);function Ge(){return reactExports.useContext($e)}var We=function(){function nt(st,mt){var gt=this;this.inject=function(_t,Et){Et===void 0&&(Et=ze);var At=gt.name+Et.hash;_t.hasNameForId(gt.id,At)||_t.insertRules(gt.id,At,Et(gt.rules,At,"@keyframes"))},this.name=st,this.id="sc-keyframes-".concat(st),this.rules=mt,ue(this,function(){throw he(12,String(gt.name))})}return nt.prototype.getName=function(st){return st===void 0&&(st=ze),this.name+st.hash},nt}(),qe=function(nt){return nt>="A"&&nt<="Z"};function He(nt){for(var st="",mt=0;mt<nt.length;mt++){var gt=nt[mt];if(mt===1&&gt==="-"&&nt[0]==="-")return nt;qe(gt)?st+="-"+gt.toLowerCase():st+=gt}return st.startsWith("ms-")?"-"+st:st}var Ue=function(nt){return nt==null||nt===!1||nt===""},Je=function(nt){var st,mt,gt=[];for(var _t in nt){var Et=nt[_t];nt.hasOwnProperty(_t)&&!Ue(Et)&&(Array.isArray(Et)&&Et.isCss||re(Et)?gt.push("".concat(He(_t),":"),Et,";"):ce(Et)?gt.push.apply(gt,__spreadArray(__spreadArray(["".concat(_t," {")],Je(Et),!1),["}"],!1)):gt.push("".concat(He(_t),": ").concat((st=_t,(mt=Et)==null||typeof mt=="boolean"||mt===""?"":typeof mt!="number"||mt===0||st in unitlessKeys||st.startsWith("--")?String(mt).trim():"".concat(mt,"px")),";")))}return gt};function Xe(nt,st,mt,gt){if(Ue(nt))return[];if(se(nt))return[".".concat(nt.styledComponentId)];if(re(nt)){if(!re(Et=nt)||Et.prototype&&Et.prototype.isReactComponent||!st)return[nt];var _t=nt(st);return Xe(_t,st,mt,gt)}var Et;return nt instanceof We?mt?(nt.inject(mt,gt),[nt.getName(gt)]):[nt]:ce(nt)?Je(nt):Array.isArray(nt)?Array.prototype.concat.apply(_$1,nt.map(function(At){return Xe(At,st,mt,gt)})):[nt.toString()]}function Ze(nt){for(var st=0;st<nt.length;st+=1){var mt=nt[st];if(re(mt)&&!se(mt))return!1}return!0}var Ke=z$1(v$6),Qe=function(){function nt(st,mt,gt){this.rules=st,this.staticRulesId="",this.isStatic=(gt===void 0||gt.isStatic)&&Ze(st),this.componentId=mt,this.baseHash=M$3(Ke,mt),this.baseStyle=gt,ke.registerId(mt)}return nt.prototype.generateAndInjectStyles=function(st,mt,gt){var _t=this.baseStyle?this.baseStyle.generateAndInjectStyles(st,mt,gt):"";if(this.isStatic&&!gt.hash)if(this.staticRulesId&&mt.hasNameForId(this.componentId,this.staticRulesId))_t=ie(_t,this.staticRulesId);else{var Et=ae(Xe(this.rules,st,mt,gt)),At=x$2(M$3(this.baseHash,Et)>>>0);if(!mt.hasNameForId(this.componentId,At)){var Rt=gt(Et,".".concat(At),void 0,this.componentId);mt.insertRules(this.componentId,At,Rt)}_t=ie(_t,At),this.staticRulesId=At}else{for(var Ft=M$3(this.baseHash,gt.hash),Nt="",Bt=0;Bt<this.rules.length;Bt++){var Gt=this.rules[Bt];if(typeof Gt=="string")Nt+=Gt;else if(Gt){var dr=ae(Xe(Gt,st,mt,gt));Ft=M$3(Ft,dr+Bt),Nt+=dr}}if(Nt){var Mr=x$2(Ft>>>0);mt.hasNameForId(this.componentId,Mr)||mt.insertRules(this.componentId,Mr,gt(Nt,".".concat(Mr),void 0,this.componentId)),_t=ie(_t,Mr)}}return _t},nt}(),et=React.createContext(void 0);et.Consumer;var rt={};function it(nt,st,mt){var gt=se(nt),_t=nt,Et=!L$1(nt),At=st.attrs,Rt=At===void 0?_$1:At,Ft=st.componentId,Nt=Ft===void 0?function(Tn,$n){var un=typeof Tn!="string"?"sc":R(Tn);rt[un]=(rt[un]||0)+1;var es="".concat(un,"-").concat($(v$6+un+rt[un]));return $n?"".concat($n,"-").concat(es):es}(st.displayName,st.parentComponentId):Ft,Bt=st.displayName,Gt=Bt===void 0?function(Tn){return L$1(Tn)?"styled.".concat(Tn):"Styled(".concat(B(Tn),")")}(nt):Bt,dr=st.displayName&&st.componentId?"".concat(R(st.displayName),"-").concat(st.componentId):st.componentId||Nt,Mr=gt&&_t.attrs?_t.attrs.concat(Rt).filter(Boolean):Rt,Tr=st.shouldForwardProp;if(gt&&_t.shouldForwardProp){var zr=_t.shouldForwardProp;if(st.shouldForwardProp){var Fr=st.shouldForwardProp;Tr=function(Tn,$n){return zr(Tn,$n)&&Fr(Tn,$n)}}else Tr=zr}var Nr=new Qe(mt,dr,gt?_t.componentStyle:void 0);function tn(Tn,$n){return function(un,es,kn){var ts=un.attrs,Ko=un.componentStyle,ds=un.defaultProps,Il=un.foldedComponentIds,ru=un.styledComponentId,uu=un.target,p0=React.useContext(et),X1=Ge(),q0=un.shouldForwardProp||X1.shouldForwardProp,W0=I$3(es,p0,ds)||C$4,hu=function(b0,l1,LE){for(var eS,SA=__assign(__assign({},l1),{className:void 0,theme:LE}),o$=0;o$<b0.length;o$+=1){var h$=re(eS=b0[o$])?eS(SA):eS;for(var d$ in h$)SA[d$]=d$==="className"?ie(SA[d$],h$[d$]):d$==="style"?__assign(__assign({},SA[d$]),h$[d$]):h$[d$]}return l1.className&&(SA.className=ie(SA.className,l1.className)),SA}(ts,es,W0),a1=hu.as||uu,Vx={};for(var t0 in hu)hu[t0]===void 0||t0[0]==="$"||t0==="as"||t0==="theme"&&hu.theme===W0||(t0==="forwardedAs"?Vx.as=hu.forwardedAs:q0&&!q0(t0,a1)||(Vx[t0]=hu[t0]));var cu=function(b0,l1){var LE=Ge(),eS=b0.generateAndInjectStyles(l1,LE.styleSheet,LE.stylis);return eS}(Ko,hu),lu=ie(Il,ru);return cu&&(lu+=" "+cu),hu.className&&(lu+=" "+hu.className),Vx[L$1(a1)&&!A.has(a1)?"class":"className"]=lu,Vx.ref=kn,reactExports.createElement(a1,Vx)}(rn,Tn,$n)}tn.displayName=Gt;var rn=React.forwardRef(tn);return rn.attrs=Mr,rn.componentStyle=Nr,rn.displayName=Gt,rn.shouldForwardProp=Tr,rn.foldedComponentIds=gt?ie(_t.foldedComponentIds,_t.styledComponentId):"",rn.styledComponentId=dr,rn.target=gt?_t.target:nt,Object.defineProperty(rn,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(Tn){this._foldedDefaultProps=gt?function($n){for(var un=[],es=1;es<arguments.length;es++)un[es-1]=arguments[es];for(var kn=0,ts=un;kn<ts.length;kn++)le($n,ts[kn],!0);return $n}({},_t.defaultProps,Tn):Tn}}),ue(rn,function(){return".".concat(rn.styledComponentId)}),Et&&oe(rn,nt,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),rn}function at(nt,st){for(var mt=[nt[0]],gt=0,_t=st.length;gt<_t;gt+=1)mt.push(st[gt],nt[gt+1]);return mt}var ct=function(nt){return Object.assign(nt,{isCss:!0})};function lt(nt){for(var st=[],mt=1;mt<arguments.length;mt++)st[mt-1]=arguments[mt];if(re(nt)||ce(nt))return ct(Xe(at(_$1,__spreadArray([nt],st,!0))));var gt=nt;return st.length===0&&gt.length===1&&typeof gt[0]=="string"?Xe(gt):ct(Xe(at(gt,st)))}function ut(nt,st,mt){if(mt===void 0&&(mt=C$4),!st)throw he(1,st);var gt=function(_t){for(var Et=[],At=1;At<arguments.length;At++)Et[At-1]=arguments[At];return nt(st,mt,lt.apply(void 0,__spreadArray([_t],Et,!1)))};return gt.attrs=function(_t){return ut(nt,st,__assign(__assign({},mt),{attrs:Array.prototype.concat(mt.attrs,_t).filter(Boolean)}))},gt.withConfig=function(_t){return ut(nt,st,__assign(__assign({},mt),_t))},gt}var pt=function(nt){return ut(it,nt)},dt=pt;A.forEach(function(nt){dt[nt]=pt(nt)});var ht=function(){function nt(st,mt){this.rules=st,this.componentId=mt,this.isStatic=Ze(st),ke.registerId(this.componentId+1)}return nt.prototype.createStyles=function(st,mt,gt,_t){var Et=_t(ae(Xe(this.rules,mt,gt,_t)),""),At=this.componentId+st;gt.insertRules(At,At,Et)},nt.prototype.removeStyles=function(st,mt){mt.clearRules(this.componentId+st)},nt.prototype.renderStyles=function(st,mt,gt,_t){st>2&&ke.registerId(this.componentId+st),this.removeStyles(st,gt),this.createStyles(st,mt,gt,_t)},nt}();function ft(nt){for(var st=[],mt=1;mt<arguments.length;mt++)st[mt-1]=arguments[mt];var gt=lt.apply(void 0,__spreadArray([nt],st,!1)),_t="sc-global-".concat($(JSON.stringify(gt))),Et=new ht(gt,_t),At=function(Ft){var Nt=Ge(),Bt=React.useContext(et),Gt=React.useRef(Nt.styleSheet.allocateGSInstance(_t)).current;return Nt.styleSheet.server&&Rt(Gt,Ft,Nt.styleSheet,Bt,Nt.stylis),React.useLayoutEffect(function(){if(!Nt.styleSheet.server)return Rt(Gt,Ft,Nt.styleSheet,Bt,Nt.stylis),function(){return Et.removeStyles(Gt,Nt.styleSheet)}},[Gt,Ft,Nt.styleSheet,Bt,Nt.stylis]),null};function Rt(Ft,Nt,Bt,Gt,dr){if(Et.isStatic)Et.renderStyles(Ft,b$5,Bt,dr);else{var Mr=__assign(__assign({},Nt),{theme:I$3(Nt,Gt,At.defaultProps)});Et.renderStyles(Ft,Mr,Bt,dr)}}return React.memo(At)}const noop=()=>{};let _WINDOW={},_DOCUMENT={},_MUTATION_OBSERVER=null,_PERFORMANCE={mark:noop,measure:noop};try{typeof window<"u"&&(_WINDOW=window),typeof document<"u"&&(_DOCUMENT=document),typeof MutationObserver<"u"&&(_MUTATION_OBSERVER=MutationObserver),typeof performance<"u"&&(_PERFORMANCE=performance)}catch{}const{userAgent=""}=_WINDOW.navigator||{},WINDOW=_WINDOW,DOCUMENT=_DOCUMENT,MUTATION_OBSERVER=_MUTATION_OBSERVER,PERFORMANCE=_PERFORMANCE;WINDOW.document;const IS_DOM=!!DOCUMENT.documentElement&&!!DOCUMENT.head&&typeof DOCUMENT.addEventListener=="function"&&typeof DOCUMENT.createElement=="function",IS_IE=~userAgent.indexOf("MSIE")||~userAgent.indexOf("Trident/");var a$f="classic",t$f="duotone",r$f="sharp",o$e="sharp-duotone",c$f=[a$f,t$f,r$f,o$e],et$1={classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds"}},bt={kit:{fak:"kit","fa-kit":"kit"},"kit-duotone":{fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"}},Ct=["kit"],Dt=/fa(s|r|l|t|d|b|k|kd|ss|sr|sl|st|sds)?[\-\ ]/,Kt=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,ao={"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"}},eo={"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds"}},lo={classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds"}},y$2={classic:["fas","far","fal","fat"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds"]},no={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid"}},fo={classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds"}},ho={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid"}},x$1$1=["solid","regular","light","thin","duotone","brands"],u$1$1=[1,2,3,4,5,6,7,8,9,10],m$1$1=u$1$1.concat([11,12,13,14,15,16,17,18,19,20]),t$1$1={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},yo=[...Object.keys(y$2),...x$1$1,"2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",t$1$1.GROUP,t$1$1.SWAP_OPACITY,t$1$1.PRIMARY,t$1$1.SECONDARY].concat(u$1$1.map(nt=>"".concat(nt,"x"))).concat(m$1$1.map(nt=>"w-".concat(nt))),mo={"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}},Io={kit:{"fa-kit":"fak"},"kit-duotone":{"fa-kit-duotone":"fakd"}},Fo={kit:{fak:"fa-kit"},"kit-duotone":{fakd:"fa-kit-duotone"}},So={kit:{kit:"fak"},"kit-duotone":{"kit-duotone":"fakd"}};const NAMESPACE_IDENTIFIER="___FONT_AWESOME___",UNITS_IN_GRID=16,DEFAULT_CSS_PREFIX="fa",DEFAULT_REPLACEMENT_CLASS="svg-inline--fa",DATA_FA_I2SVG="data-fa-i2svg",DATA_FA_PSEUDO_ELEMENT="data-fa-pseudo-element",DATA_FA_PSEUDO_ELEMENT_PENDING="data-fa-pseudo-element-pending",DATA_PREFIX="data-prefix",DATA_ICON="data-icon",HTML_CLASS_I2SVG_BASE_CLASS="fontawesome-i2svg",MUTATION_APPROACH_ASYNC="async",TAGNAMES_TO_SKIP_FOR_PSEUDOELEMENTS=["HTML","HEAD","STYLE","SCRIPT"],PRODUCTION$1=(()=>{try{return!0}catch{return!1}})(),FAMILIES=[a$f,r$f,o$e];function familyProxy(nt){return new Proxy(nt,{get(st,mt){return mt in st?st[mt]:st[a$f]}})}const _PREFIX_TO_STYLE={...ho};_PREFIX_TO_STYLE[a$f]={...ho[a$f],...bt.kit,...bt["kit-duotone"]};const PREFIX_TO_STYLE=familyProxy(_PREFIX_TO_STYLE),_STYLE_TO_PREFIX={...fo};_STYLE_TO_PREFIX[a$f]={..._STYLE_TO_PREFIX[a$f],...So.kit,...So["kit-duotone"]};const STYLE_TO_PREFIX=familyProxy(_STYLE_TO_PREFIX),_PREFIX_TO_LONG_STYLE={...no};_PREFIX_TO_LONG_STYLE[a$f]={..._PREFIX_TO_LONG_STYLE[a$f],...Fo.kit};const PREFIX_TO_LONG_STYLE=familyProxy(_PREFIX_TO_LONG_STYLE),_LONG_STYLE_TO_PREFIX={...lo};_LONG_STYLE_TO_PREFIX[a$f]={..._LONG_STYLE_TO_PREFIX[a$f],...Io.kit};const LONG_STYLE_TO_PREFIX=familyProxy(_LONG_STYLE_TO_PREFIX),ICON_SELECTION_SYNTAX_PATTERN=Dt,LAYERS_TEXT_CLASSNAME="fa-layers-text",FONT_FAMILY_PATTERN=Kt,_FONT_WEIGHT_TO_PREFIX={...et$1};familyProxy(_FONT_WEIGHT_TO_PREFIX);const ATTRIBUTES_WATCHED_FOR_MUTATION=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],DUOTONE_CLASSES=t$1$1,prefixes=new Set;Object.keys(STYLE_TO_PREFIX[a$f]).map(prefixes.add.bind(prefixes));Object.keys(STYLE_TO_PREFIX[r$f]).map(prefixes.add.bind(prefixes));Object.keys(STYLE_TO_PREFIX[o$e]).map(prefixes.add.bind(prefixes));const RESERVED_CLASSES=[...Ct,...yo],initial=WINDOW.FontAwesomeConfig||{};function getAttrConfig(nt){var st=DOCUMENT.querySelector("script["+nt+"]");if(st)return st.getAttribute(nt)}function coerce(nt){return nt===""?!0:nt==="false"?!1:nt==="true"?!0:nt}DOCUMENT&&typeof DOCUMENT.querySelector=="function"&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(st=>{let[mt,gt]=st;const _t=coerce(getAttrConfig(mt));_t!=null&&(initial[gt]=_t)});const _default={styleDefault:"solid",familyDefault:"classic",cssPrefix:DEFAULT_CSS_PREFIX,replacementClass:DEFAULT_REPLACEMENT_CLASS,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};initial.familyPrefix&&(initial.cssPrefix=initial.familyPrefix);const _config={..._default,...initial};_config.autoReplaceSvg||(_config.observeMutations=!1);const config={};Object.keys(_default).forEach(nt=>{Object.defineProperty(config,nt,{enumerable:!0,set:function(st){_config[nt]=st,_onChangeCb.forEach(mt=>mt(config))},get:function(){return _config[nt]}})});Object.defineProperty(config,"familyPrefix",{enumerable:!0,set:function(nt){_config.cssPrefix=nt,_onChangeCb.forEach(st=>st(config))},get:function(){return _config.cssPrefix}});WINDOW.FontAwesomeConfig=config;const _onChangeCb=[];function onChange(nt){return _onChangeCb.push(nt),()=>{_onChangeCb.splice(_onChangeCb.indexOf(nt),1)}}const d$2$1=UNITS_IN_GRID,meaninglessTransform={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function insertCss(nt){if(!nt||!IS_DOM)return;const st=DOCUMENT.createElement("style");st.setAttribute("type","text/css"),st.innerHTML=nt;const mt=DOCUMENT.head.childNodes;let gt=null;for(let _t=mt.length-1;_t>-1;_t--){const Et=mt[_t],At=(Et.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(At)>-1&&(gt=Et)}return DOCUMENT.head.insertBefore(st,gt),nt}const idPool="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function nextUniqueId(){let nt=12,st="";for(;nt-- >0;)st+=idPool[Math.random()*62|0];return st}function toArray(nt){const st=[];for(let mt=(nt||[]).length>>>0;mt--;)st[mt]=nt[mt];return st}function classArray(nt){return nt.classList?toArray(nt.classList):(nt.getAttribute("class")||"").split(" ").filter(st=>st)}function htmlEscape(nt){return"".concat(nt).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function joinAttributes(nt){return Object.keys(nt||{}).reduce((st,mt)=>st+"".concat(mt,'="').concat(htmlEscape(nt[mt]),'" '),"").trim()}function joinStyles(nt){return Object.keys(nt||{}).reduce((st,mt)=>st+"".concat(mt,": ").concat(nt[mt].trim(),";"),"")}function transformIsMeaningful(nt){return nt.size!==meaninglessTransform.size||nt.x!==meaninglessTransform.x||nt.y!==meaninglessTransform.y||nt.rotate!==meaninglessTransform.rotate||nt.flipX||nt.flipY}function transformForSvg(nt){let{transform:st,containerWidth:mt,iconWidth:gt}=nt;const _t={transform:"translate(".concat(mt/2," 256)")},Et="translate(".concat(st.x*32,", ").concat(st.y*32,") "),At="scale(".concat(st.size/16*(st.flipX?-1:1),", ").concat(st.size/16*(st.flipY?-1:1),") "),Rt="rotate(".concat(st.rotate," 0 0)"),Ft={transform:"".concat(Et," ").concat(At," ").concat(Rt)},Nt={transform:"translate(".concat(gt/2*-1," -256)")};return{outer:_t,inner:Ft,path:Nt}}function transformForCss(nt){let{transform:st,width:mt=UNITS_IN_GRID,height:gt=UNITS_IN_GRID,startCentered:_t=!1}=nt,Et="";return _t&&IS_IE?Et+="translate(".concat(st.x/d$2$1-mt/2,"em, ").concat(st.y/d$2$1-gt/2,"em) "):_t?Et+="translate(calc(-50% + ".concat(st.x/d$2$1,"em), calc(-50% + ").concat(st.y/d$2$1,"em)) "):Et+="translate(".concat(st.x/d$2$1,"em, ").concat(st.y/d$2$1,"em) "),Et+="scale(".concat(st.size/d$2$1*(st.flipX?-1:1),", ").concat(st.size/d$2$1*(st.flipY?-1:1),") "),Et+="rotate(".concat(st.rotate,"deg) "),Et}var baseStyles=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-counter-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(-1 * var(--fa-li-width, 2em));
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  animation-name: fa-beat;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  animation-name: fa-bounce;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  animation-name: fa-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  animation-name: fa-beat-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  animation-name: fa-flip;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  animation-name: fa-shake;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  animation-name: fa-spin;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 2s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  animation-name: fa-spin;
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    animation-delay: -1ms;
    animation-duration: 1ms;
    animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@keyframes fa-beat {
  0%, 90% {
    transform: scale(1);
  }
  45% {
    transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-bounce {
  0% {
    transform: scale(1, 1) translateY(0);
  }
  10% {
    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    transform: scale(1, 1) translateY(0);
  }
  100% {
    transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-flip {
  50% {
    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-shake {
  0% {
    transform: rotate(-15deg);
  }
  4% {
    transform: rotate(15deg);
  }
  8%, 24% {
    transform: rotate(-18deg);
  }
  12%, 28% {
    transform: rotate(18deg);
  }
  16% {
    transform: rotate(-22deg);
  }
  20% {
    transform: rotate(22deg);
  }
  32% {
    transform: rotate(-12deg);
  }
  36% {
    transform: rotate(12deg);
  }
  40%, 100% {
    transform: rotate(0deg);
  }
}
@keyframes fa-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  transform: rotate(90deg);
}

.fa-rotate-180 {
  transform: rotate(180deg);
}

.fa-rotate-270 {
  transform: rotate(270deg);
}

.fa-flip-horizontal {
  transform: scale(-1, 1);
}

.fa-flip-vertical {
  transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  transform: scale(-1, -1);
}

.fa-rotate-by {
  transform: rotate(var(--fa-rotate-angle, 0));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse,
.fa-duotone.fa-inverse {
  color: var(--fa-inverse, #fff);
}`;function css(){const nt=DEFAULT_CSS_PREFIX,st=DEFAULT_REPLACEMENT_CLASS,mt=config.cssPrefix,gt=config.replacementClass;let _t=baseStyles;if(mt!==nt||gt!==st){const Et=new RegExp("\\.".concat(nt,"\\-"),"g"),At=new RegExp("\\--".concat(nt,"\\-"),"g"),Rt=new RegExp("\\.".concat(st),"g");_t=_t.replace(Et,".".concat(mt,"-")).replace(At,"--".concat(mt,"-")).replace(Rt,".".concat(gt))}return _t}let _cssInserted=!1;function ensureCss(){config.autoAddCss&&!_cssInserted&&(insertCss(css()),_cssInserted=!0)}var InjectCSS={mixout(){return{dom:{css,insertCss:ensureCss}}},hooks(){return{beforeDOMElementCreation(){ensureCss()},beforeI2svg(){ensureCss()}}}};const w$1$1=WINDOW||{};w$1$1[NAMESPACE_IDENTIFIER]||(w$1$1[NAMESPACE_IDENTIFIER]={});w$1$1[NAMESPACE_IDENTIFIER].styles||(w$1$1[NAMESPACE_IDENTIFIER].styles={});w$1$1[NAMESPACE_IDENTIFIER].hooks||(w$1$1[NAMESPACE_IDENTIFIER].hooks={});w$1$1[NAMESPACE_IDENTIFIER].shims||(w$1$1[NAMESPACE_IDENTIFIER].shims=[]);var namespace=w$1$1[NAMESPACE_IDENTIFIER];const functions=[],listener=function(){DOCUMENT.removeEventListener("DOMContentLoaded",listener),loaded=1,functions.map(nt=>nt())};let loaded=!1;IS_DOM&&(loaded=(DOCUMENT.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(DOCUMENT.readyState),loaded||DOCUMENT.addEventListener("DOMContentLoaded",listener));function domready(nt){IS_DOM&&(loaded?setTimeout(nt,0):functions.push(nt))}function toHtml(nt){const{tag:st,attributes:mt={},children:gt=[]}=nt;return typeof nt=="string"?htmlEscape(nt):"<".concat(st," ").concat(joinAttributes(mt),">").concat(gt.map(toHtml).join(""),"</").concat(st,">")}function iconFromMapping(nt,st,mt){if(nt&&nt[st]&&nt[st][mt])return{prefix:st,iconName:mt,icon:nt[st][mt]}}var reduce=function(st,mt,gt,_t){var Et=Object.keys(st),At=Et.length,Rt=mt,Ft,Nt,Bt;for(gt===void 0?(Ft=1,Bt=st[Et[0]]):(Ft=0,Bt=gt);Ft<At;Ft++)Nt=Et[Ft],Bt=Rt(Bt,st[Nt],Nt,st);return Bt};function ucs2decode(nt){const st=[];let mt=0;const gt=nt.length;for(;mt<gt;){const _t=nt.charCodeAt(mt++);if(_t>=55296&&_t<=56319&&mt<gt){const Et=nt.charCodeAt(mt++);(Et&64512)==56320?st.push(((_t&1023)<<10)+(Et&1023)+65536):(st.push(_t),mt--)}else st.push(_t)}return st}function toHex(nt){const st=ucs2decode(nt);return st.length===1?st[0].toString(16):null}function codePointAt(nt,st){const mt=nt.length;let gt=nt.charCodeAt(st),_t;return gt>=55296&&gt<=56319&&mt>st+1&&(_t=nt.charCodeAt(st+1),_t>=56320&&_t<=57343)?(gt-55296)*1024+_t-56320+65536:gt}function normalizeIcons(nt){return Object.keys(nt).reduce((st,mt)=>{const gt=nt[mt];return!!gt.icon?st[gt.iconName]=gt.icon:st[mt]=gt,st},{})}function defineIcons(nt,st){let mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{skipHooks:gt=!1}=mt,_t=normalizeIcons(st);typeof namespace.hooks.addPack=="function"&&!gt?namespace.hooks.addPack(nt,normalizeIcons(st)):namespace.styles[nt]={...namespace.styles[nt]||{},..._t},nt==="fas"&&defineIcons("fa",st)}const{styles,shims}=namespace,LONG_STYLE={[a$f]:Object.values(PREFIX_TO_LONG_STYLE[a$f]),[r$f]:Object.values(PREFIX_TO_LONG_STYLE[r$f]),[o$e]:Object.values(PREFIX_TO_LONG_STYLE[o$e])};let _defaultUsablePrefix=null,_byUnicode={},_byLigature={},_byOldName={},_byOldUnicode={},_byAlias={};const PREFIXES={[a$f]:Object.keys(PREFIX_TO_STYLE[a$f]),[r$f]:Object.keys(PREFIX_TO_STYLE[r$f]),[o$e]:Object.keys(PREFIX_TO_STYLE[o$e])};function isReserved(nt){return~RESERVED_CLASSES.indexOf(nt)}function getIconName(nt,st){const mt=st.split("-"),gt=mt[0],_t=mt.slice(1).join("-");return gt===nt&&_t!==""&&!isReserved(_t)?_t:null}const build=()=>{const nt=gt=>reduce(styles,(_t,Et,At)=>(_t[At]=reduce(Et,gt,{}),_t),{});_byUnicode=nt((gt,_t,Et)=>(_t[3]&&(gt[_t[3]]=Et),_t[2]&&_t[2].filter(Rt=>typeof Rt=="number").forEach(Rt=>{gt[Rt.toString(16)]=Et}),gt)),_byLigature=nt((gt,_t,Et)=>(gt[Et]=Et,_t[2]&&_t[2].filter(Rt=>typeof Rt=="string").forEach(Rt=>{gt[Rt]=Et}),gt)),_byAlias=nt((gt,_t,Et)=>{const At=_t[2];return gt[Et]=Et,At.forEach(Rt=>{gt[Rt]=Et}),gt});const st="far"in styles||config.autoFetchSvg,mt=reduce(shims,(gt,_t)=>{const Et=_t[0];let At=_t[1];const Rt=_t[2];return At==="far"&&!st&&(At="fas"),typeof Et=="string"&&(gt.names[Et]={prefix:At,iconName:Rt}),typeof Et=="number"&&(gt.unicodes[Et.toString(16)]={prefix:At,iconName:Rt}),gt},{names:{},unicodes:{}});_byOldName=mt.names,_byOldUnicode=mt.unicodes,_defaultUsablePrefix=getCanonicalPrefix(config.styleDefault,{family:config.familyDefault})};onChange(nt=>{_defaultUsablePrefix=getCanonicalPrefix(nt.styleDefault,{family:config.familyDefault})});build();function byUnicode(nt,st){return(_byUnicode[nt]||{})[st]}function byLigature(nt,st){return(_byLigature[nt]||{})[st]}function byAlias(nt,st){return(_byAlias[nt]||{})[st]}function byOldName(nt){return _byOldName[nt]||{prefix:null,iconName:null}}function byOldUnicode(nt){const st=_byOldUnicode[nt],mt=byUnicode("fas",nt);return st||(mt?{prefix:"fas",iconName:mt}:null)||{prefix:null,iconName:null}}function getDefaultUsablePrefix(){return _defaultUsablePrefix}const emptyCanonicalIcon=()=>({prefix:null,iconName:null,rest:[]});function getCanonicalPrefix(nt){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{family:mt=a$f}=st,gt=PREFIX_TO_STYLE[mt][nt],_t=STYLE_TO_PREFIX[mt][nt]||STYLE_TO_PREFIX[mt][gt],Et=nt in namespace.styles?nt:null;return _t||Et||null}const PREFIXES_FOR_FAMILY={[a$f]:Object.keys(PREFIX_TO_LONG_STYLE[a$f]),[r$f]:Object.keys(PREFIX_TO_LONG_STYLE[r$f]),[o$e]:Object.keys(PREFIX_TO_LONG_STYLE[o$e])};function getCanonicalIcon(nt){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{skipLookups:mt=!1}=st,gt={[a$f]:"".concat(config.cssPrefix,"-").concat(a$f),[r$f]:"".concat(config.cssPrefix,"-").concat(r$f),[o$e]:"".concat(config.cssPrefix,"-").concat(o$e)};let _t=null,Et=a$f;const At=c$f.filter(Ft=>Ft!==t$f);At.forEach(Ft=>{(nt.includes(gt[Ft])||nt.some(Nt=>PREFIXES_FOR_FAMILY[Ft].includes(Nt)))&&(Et=Ft)});const Rt=nt.reduce((Ft,Nt)=>{const Bt=getIconName(config.cssPrefix,Nt);if(styles[Nt]?(Nt=LONG_STYLE[Et].includes(Nt)?LONG_STYLE_TO_PREFIX[Et][Nt]:Nt,_t=Nt,Ft.prefix=Nt):PREFIXES[Et].indexOf(Nt)>-1?(_t=Nt,Ft.prefix=getCanonicalPrefix(Nt,{family:Et})):Bt?Ft.iconName=Bt:Nt!==config.replacementClass&&!At.some(Gt=>Nt===gt[Gt])&&Ft.rest.push(Nt),!mt&&Ft.prefix&&Ft.iconName){const Gt=_t==="fa"?byOldName(Ft.iconName):{},dr=byAlias(Ft.prefix,Ft.iconName);Gt.prefix&&(_t=null),Ft.iconName=Gt.iconName||dr||Ft.iconName,Ft.prefix=Gt.prefix||Ft.prefix,Ft.prefix==="far"&&!styles.far&&styles.fas&&!config.autoFetchSvg&&(Ft.prefix="fas")}return Ft},emptyCanonicalIcon());return(nt.includes("fa-brands")||nt.includes("fab"))&&(Rt.prefix="fab"),(nt.includes("fa-duotone")||nt.includes("fad"))&&(Rt.prefix="fad"),!Rt.prefix&&Et===r$f&&(styles.fass||config.autoFetchSvg)&&(Rt.prefix="fass",Rt.iconName=byAlias(Rt.prefix,Rt.iconName)||Rt.iconName),!Rt.prefix&&Et===o$e&&(styles.fasds||config.autoFetchSvg)&&(Rt.prefix="fasds",Rt.iconName=byAlias(Rt.prefix,Rt.iconName)||Rt.iconName),(Rt.prefix==="fa"||_t==="fa")&&(Rt.prefix=getDefaultUsablePrefix()||"fas"),Rt}class Library{constructor(){this.definitions={}}add(){for(var st=arguments.length,mt=new Array(st),gt=0;gt<st;gt++)mt[gt]=arguments[gt];const _t=mt.reduce(this._pullDefinitions,{});Object.keys(_t).forEach(Et=>{this.definitions[Et]={...this.definitions[Et]||{},..._t[Et]},defineIcons(Et,_t[Et]);const At=PREFIX_TO_LONG_STYLE[a$f][Et];At&&defineIcons(At,_t[Et]),build()})}reset(){this.definitions={}}_pullDefinitions(st,mt){const gt=mt.prefix&&mt.iconName&&mt.icon?{0:mt}:mt;return Object.keys(gt).map(_t=>{const{prefix:Et,iconName:At,icon:Rt}=gt[_t],Ft=Rt[2];st[Et]||(st[Et]={}),Ft.length>0&&Ft.forEach(Nt=>{typeof Nt=="string"&&(st[Et][Nt]=Rt)}),st[Et][At]=Rt}),st}}let _plugins=[],_hooks={};const providers={},defaultProviderKeys=Object.keys(providers);function registerPlugins(nt,st){let{mixoutsTo:mt}=st;return _plugins=nt,_hooks={},Object.keys(providers).forEach(gt=>{defaultProviderKeys.indexOf(gt)===-1&&delete providers[gt]}),_plugins.forEach(gt=>{const _t=gt.mixout?gt.mixout():{};if(Object.keys(_t).forEach(Et=>{typeof _t[Et]=="function"&&(mt[Et]=_t[Et]),typeof _t[Et]=="object"&&Object.keys(_t[Et]).forEach(At=>{mt[Et]||(mt[Et]={}),mt[Et][At]=_t[Et][At]})}),gt.hooks){const Et=gt.hooks();Object.keys(Et).forEach(At=>{_hooks[At]||(_hooks[At]=[]),_hooks[At].push(Et[At])})}gt.provides&&gt.provides(providers)}),mt}function chainHooks(nt,st){for(var mt=arguments.length,gt=new Array(mt>2?mt-2:0),_t=2;_t<mt;_t++)gt[_t-2]=arguments[_t];return(_hooks[nt]||[]).forEach(At=>{st=At.apply(null,[st,...gt])}),st}function callHooks(nt){for(var st=arguments.length,mt=new Array(st>1?st-1:0),gt=1;gt<st;gt++)mt[gt-1]=arguments[gt];(_hooks[nt]||[]).forEach(Et=>{Et.apply(null,mt)})}function callProvided(){const nt=arguments[0],st=Array.prototype.slice.call(arguments,1);return providers[nt]?providers[nt].apply(null,st):void 0}function findIconDefinition(nt){nt.prefix==="fa"&&(nt.prefix="fas");let{iconName:st}=nt;const mt=nt.prefix||getDefaultUsablePrefix();if(st)return st=byAlias(mt,st)||st,iconFromMapping(library.definitions,mt,st)||iconFromMapping(namespace.styles,mt,st)}const library=new Library,noAuto=()=>{config.autoReplaceSvg=!1,config.observeMutations=!1,callHooks("noAuto")},dom={i2svg:function(){let nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return IS_DOM?(callHooks("beforeI2svg",nt),callProvided("pseudoElements2svg",nt),callProvided("i2svg",nt)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:st}=nt;config.autoReplaceSvg===!1&&(config.autoReplaceSvg=!0),config.observeMutations=!0,domready(()=>{autoReplace({autoReplaceSvgRoot:st}),callHooks("watch",nt)})}},parse={icon:nt=>{if(nt===null)return null;if(typeof nt=="object"&&nt.prefix&&nt.iconName)return{prefix:nt.prefix,iconName:byAlias(nt.prefix,nt.iconName)||nt.iconName};if(Array.isArray(nt)&&nt.length===2){const st=nt[1].indexOf("fa-")===0?nt[1].slice(3):nt[1],mt=getCanonicalPrefix(nt[0]);return{prefix:mt,iconName:byAlias(mt,st)||st}}if(typeof nt=="string"&&(nt.indexOf("".concat(config.cssPrefix,"-"))>-1||nt.match(ICON_SELECTION_SYNTAX_PATTERN))){const st=getCanonicalIcon(nt.split(" "),{skipLookups:!0});return{prefix:st.prefix||getDefaultUsablePrefix(),iconName:byAlias(st.prefix,st.iconName)||st.iconName}}if(typeof nt=="string"){const st=getDefaultUsablePrefix();return{prefix:st,iconName:byAlias(st,nt)||nt}}}},api={noAuto,config,dom,parse,library,findIconDefinition,toHtml},autoReplace=function(){let nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:st=DOCUMENT}=nt;(Object.keys(namespace.styles).length>0||config.autoFetchSvg)&&IS_DOM&&config.autoReplaceSvg&&api.dom.i2svg({node:st})};function domVariants(nt,st){return Object.defineProperty(nt,"abstract",{get:st}),Object.defineProperty(nt,"html",{get:function(){return nt.abstract.map(mt=>toHtml(mt))}}),Object.defineProperty(nt,"node",{get:function(){if(!IS_DOM)return;const mt=DOCUMENT.createElement("div");return mt.innerHTML=nt.html,mt.children}}),nt}function asIcon(nt){let{children:st,main:mt,mask:gt,attributes:_t,styles:Et,transform:At}=nt;if(transformIsMeaningful(At)&&mt.found&&!gt.found){const{width:Rt,height:Ft}=mt,Nt={x:Rt/Ft/2,y:.5};_t.style=joinStyles({...Et,"transform-origin":"".concat(Nt.x+At.x/16,"em ").concat(Nt.y+At.y/16,"em")})}return[{tag:"svg",attributes:_t,children:st}]}function asSymbol(nt){let{prefix:st,iconName:mt,children:gt,attributes:_t,symbol:Et}=nt;const At=Et===!0?"".concat(st,"-").concat(config.cssPrefix,"-").concat(mt):Et;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:{..._t,id:At},children:gt}]}]}function makeInlineSvgAbstract(nt){const{icons:{main:st,mask:mt},prefix:gt,iconName:_t,transform:Et,symbol:At,title:Rt,maskId:Ft,titleId:Nt,extra:Bt,watchable:Gt=!1}=nt,{width:dr,height:Mr}=mt.found?mt:st,Tr=gt==="fak",zr=[config.replacementClass,_t?"".concat(config.cssPrefix,"-").concat(_t):""].filter($n=>Bt.classes.indexOf($n)===-1).filter($n=>$n!==""||!!$n).concat(Bt.classes).join(" ");let Fr={children:[],attributes:{...Bt.attributes,"data-prefix":gt,"data-icon":_t,class:zr,role:Bt.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(dr," ").concat(Mr)}};const Nr=Tr&&!~Bt.classes.indexOf("fa-fw")?{width:"".concat(dr/Mr*16*.0625,"em")}:{};Gt&&(Fr.attributes[DATA_FA_I2SVG]=""),Rt&&(Fr.children.push({tag:"title",attributes:{id:Fr.attributes["aria-labelledby"]||"title-".concat(Nt||nextUniqueId())},children:[Rt]}),delete Fr.attributes.title);const tn={...Fr,prefix:gt,iconName:_t,main:st,mask:mt,maskId:Ft,transform:Et,symbol:At,styles:{...Nr,...Bt.styles}},{children:rn,attributes:Tn}=mt.found&&st.found?callProvided("generateAbstractMask",tn)||{children:[],attributes:{}}:callProvided("generateAbstractIcon",tn)||{children:[],attributes:{}};return tn.children=rn,tn.attributes=Tn,At?asSymbol(tn):asIcon(tn)}function makeLayersTextAbstract(nt){const{content:st,width:mt,height:gt,transform:_t,title:Et,extra:At,watchable:Rt=!1}=nt,Ft={...At.attributes,...Et?{title:Et}:{},class:At.classes.join(" ")};Rt&&(Ft[DATA_FA_I2SVG]="");const Nt={...At.styles};transformIsMeaningful(_t)&&(Nt.transform=transformForCss({transform:_t,startCentered:!0,width:mt,height:gt}),Nt["-webkit-transform"]=Nt.transform);const Bt=joinStyles(Nt);Bt.length>0&&(Ft.style=Bt);const Gt=[];return Gt.push({tag:"span",attributes:Ft,children:[st]}),Et&&Gt.push({tag:"span",attributes:{class:"sr-only"},children:[Et]}),Gt}function makeLayersCounterAbstract(nt){const{content:st,title:mt,extra:gt}=nt,_t={...gt.attributes,...mt?{title:mt}:{},class:gt.classes.join(" ")},Et=joinStyles(gt.styles);Et.length>0&&(_t.style=Et);const At=[];return At.push({tag:"span",attributes:_t,children:[st]}),mt&&At.push({tag:"span",attributes:{class:"sr-only"},children:[mt]}),At}const{styles:styles$1}=namespace;function asFoundIcon(nt){const st=nt[0],mt=nt[1],[gt]=nt.slice(4);let _t=null;return Array.isArray(gt)?_t={tag:"g",attributes:{class:"".concat(config.cssPrefix,"-").concat(DUOTONE_CLASSES.GROUP)},children:[{tag:"path",attributes:{class:"".concat(config.cssPrefix,"-").concat(DUOTONE_CLASSES.SECONDARY),fill:"currentColor",d:gt[0]}},{tag:"path",attributes:{class:"".concat(config.cssPrefix,"-").concat(DUOTONE_CLASSES.PRIMARY),fill:"currentColor",d:gt[1]}}]}:_t={tag:"path",attributes:{fill:"currentColor",d:gt}},{found:!0,width:st,height:mt,icon:_t}}const missingIconResolutionMixin={found:!1,width:512,height:512};function maybeNotifyMissing(nt,st){!PRODUCTION$1&&!config.showMissingIcons&&nt&&console.error('Icon with name "'.concat(nt,'" and prefix "').concat(st,'" is missing.'))}function findIcon(nt,st){let mt=st;return st==="fa"&&config.styleDefault!==null&&(st=getDefaultUsablePrefix()),new Promise((gt,_t)=>{if(mt==="fa"){const Et=byOldName(nt)||{};nt=Et.iconName||nt,st=Et.prefix||st}if(nt&&st&&styles$1[st]&&styles$1[st][nt]){const Et=styles$1[st][nt];return gt(asFoundIcon(Et))}maybeNotifyMissing(nt,st),gt({...missingIconResolutionMixin,icon:config.showMissingIcons&&nt?callProvided("missingIconAbstract")||{}:{}})})}const noop$1=()=>{},p$2$1=config.measurePerformance&&PERFORMANCE&&PERFORMANCE.mark&&PERFORMANCE.measure?PERFORMANCE:{mark:noop$1,measure:noop$1},preamble='FA "6.6.0"',begin=nt=>(p$2$1.mark("".concat(preamble," ").concat(nt," begins")),()=>end(nt)),end=nt=>{p$2$1.mark("".concat(preamble," ").concat(nt," ends")),p$2$1.measure("".concat(preamble," ").concat(nt),"".concat(preamble," ").concat(nt," begins"),"".concat(preamble," ").concat(nt," ends"))};var perf={begin,end};const noop$2=()=>{};function isWatched(nt){return typeof(nt.getAttribute?nt.getAttribute(DATA_FA_I2SVG):null)=="string"}function hasPrefixAndIcon(nt){const st=nt.getAttribute?nt.getAttribute(DATA_PREFIX):null,mt=nt.getAttribute?nt.getAttribute(DATA_ICON):null;return st&&mt}function hasBeenReplaced(nt){return nt&&nt.classList&&nt.classList.contains&&nt.classList.contains(config.replacementClass)}function getMutator(){return config.autoReplaceSvg===!0?mutators.replace:mutators[config.autoReplaceSvg]||mutators.replace}function createElementNS(nt){return DOCUMENT.createElementNS("http://www.w3.org/2000/svg",nt)}function createElement(nt){return DOCUMENT.createElement(nt)}function convertSVG(nt){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{ceFn:mt=nt.tag==="svg"?createElementNS:createElement}=st;if(typeof nt=="string")return DOCUMENT.createTextNode(nt);const gt=mt(nt.tag);return Object.keys(nt.attributes||[]).forEach(function(Et){gt.setAttribute(Et,nt.attributes[Et])}),(nt.children||[]).forEach(function(Et){gt.appendChild(convertSVG(Et,{ceFn:mt}))}),gt}function nodeAsComment(nt){let st=" ".concat(nt.outerHTML," ");return st="".concat(st,"Font Awesome fontawesome.com "),st}const mutators={replace:function(nt){const st=nt[0];if(st.parentNode)if(nt[1].forEach(mt=>{st.parentNode.insertBefore(convertSVG(mt),st)}),st.getAttribute(DATA_FA_I2SVG)===null&&config.keepOriginalSource){let mt=DOCUMENT.createComment(nodeAsComment(st));st.parentNode.replaceChild(mt,st)}else st.remove()},nest:function(nt){const st=nt[0],mt=nt[1];if(~classArray(st).indexOf(config.replacementClass))return mutators.replace(nt);const gt=new RegExp("".concat(config.cssPrefix,"-.*"));if(delete mt[0].attributes.id,mt[0].attributes.class){const Et=mt[0].attributes.class.split(" ").reduce((At,Rt)=>(Rt===config.replacementClass||Rt.match(gt)?At.toSvg.push(Rt):At.toNode.push(Rt),At),{toNode:[],toSvg:[]});mt[0].attributes.class=Et.toSvg.join(" "),Et.toNode.length===0?st.removeAttribute("class"):st.setAttribute("class",Et.toNode.join(" "))}const _t=mt.map(Et=>toHtml(Et)).join(`
`);st.setAttribute(DATA_FA_I2SVG,""),st.innerHTML=_t}};function performOperationSync(nt){nt()}function perform(nt,st){const mt=typeof st=="function"?st:noop$2;if(nt.length===0)mt();else{let gt=performOperationSync;config.mutateApproach===MUTATION_APPROACH_ASYNC&&(gt=WINDOW.requestAnimationFrame||performOperationSync),gt(()=>{const _t=getMutator(),Et=perf.begin("mutate");nt.map(_t),Et(),mt()})}}let disabled=!1;function disableObservation(){disabled=!0}function enableObservation(){disabled=!1}let mo$1=null;function observe(nt){if(!MUTATION_OBSERVER||!config.observeMutations)return;const{treeCallback:st=noop$2,nodeCallback:mt=noop$2,pseudoElementsCallback:gt=noop$2,observeMutationsRoot:_t=DOCUMENT}=nt;mo$1=new MUTATION_OBSERVER(Et=>{if(disabled)return;const At=getDefaultUsablePrefix();toArray(Et).forEach(Rt=>{if(Rt.type==="childList"&&Rt.addedNodes.length>0&&!isWatched(Rt.addedNodes[0])&&(config.searchPseudoElements&&gt(Rt.target),st(Rt.target)),Rt.type==="attributes"&&Rt.target.parentNode&&config.searchPseudoElements&&gt(Rt.target.parentNode),Rt.type==="attributes"&&isWatched(Rt.target)&&~ATTRIBUTES_WATCHED_FOR_MUTATION.indexOf(Rt.attributeName))if(Rt.attributeName==="class"&&hasPrefixAndIcon(Rt.target)){const{prefix:Ft,iconName:Nt}=getCanonicalIcon(classArray(Rt.target));Rt.target.setAttribute(DATA_PREFIX,Ft||At),Nt&&Rt.target.setAttribute(DATA_ICON,Nt)}else hasBeenReplaced(Rt.target)&&mt(Rt.target)})}),IS_DOM&&mo$1.observe(_t,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function disconnect(){mo$1&&mo$1.disconnect()}function styleParser(nt){const st=nt.getAttribute("style");let mt=[];return st&&(mt=st.split(";").reduce((gt,_t)=>{const Et=_t.split(":"),At=Et[0],Rt=Et.slice(1);return At&&Rt.length>0&&(gt[At]=Rt.join(":").trim()),gt},{})),mt}function classParser(nt){const st=nt.getAttribute("data-prefix"),mt=nt.getAttribute("data-icon"),gt=nt.innerText!==void 0?nt.innerText.trim():"";let _t=getCanonicalIcon(classArray(nt));return _t.prefix||(_t.prefix=getDefaultUsablePrefix()),st&&mt&&(_t.prefix=st,_t.iconName=mt),_t.iconName&&_t.prefix||(_t.prefix&&gt.length>0&&(_t.iconName=byLigature(_t.prefix,nt.innerText)||byUnicode(_t.prefix,toHex(nt.innerText))),!_t.iconName&&config.autoFetchSvg&&nt.firstChild&&nt.firstChild.nodeType===Node.TEXT_NODE&&(_t.iconName=nt.firstChild.data)),_t}function attributesParser(nt){const st=toArray(nt.attributes).reduce((_t,Et)=>(_t.name!=="class"&&_t.name!=="style"&&(_t[Et.name]=Et.value),_t),{}),mt=nt.getAttribute("title"),gt=nt.getAttribute("data-fa-title-id");return config.autoA11y&&(mt?st["aria-labelledby"]="".concat(config.replacementClass,"-title-").concat(gt||nextUniqueId()):(st["aria-hidden"]="true",st.focusable="false")),st}function blankMeta(){return{iconName:null,title:null,titleId:null,prefix:null,transform:meaninglessTransform,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function parseMeta(nt){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0};const{iconName:mt,prefix:gt,rest:_t}=classParser(nt),Et=attributesParser(nt),At=chainHooks("parseNodeAttributes",{},nt);let Rt=st.styleParser?styleParser(nt):[];return{iconName:mt,title:nt.getAttribute("title"),titleId:nt.getAttribute("data-fa-title-id"),prefix:gt,transform:meaninglessTransform,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:_t,styles:Rt,attributes:Et},...At}}const{styles:styles$2}=namespace;function generateMutation(nt){const st=config.autoReplaceSvg==="nest"?parseMeta(nt,{styleParser:!1}):parseMeta(nt);return~st.extra.classes.indexOf(LAYERS_TEXT_CLASSNAME)?callProvided("generateLayersText",nt,st):callProvided("generateSvgReplacementMutation",nt,st)}let knownPrefixes=new Set;FAMILIES.map(nt=>{knownPrefixes.add("fa-".concat(nt))});Object.keys(PREFIX_TO_STYLE[a$f]).map(knownPrefixes.add.bind(knownPrefixes));Object.keys(PREFIX_TO_STYLE[r$f]).map(knownPrefixes.add.bind(knownPrefixes));Object.keys(PREFIX_TO_STYLE[o$e]).map(knownPrefixes.add.bind(knownPrefixes));knownPrefixes=[...knownPrefixes];function onTree(nt){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!IS_DOM)return Promise.resolve();const mt=DOCUMENT.documentElement.classList,gt=Bt=>mt.add("".concat(HTML_CLASS_I2SVG_BASE_CLASS,"-").concat(Bt)),_t=Bt=>mt.remove("".concat(HTML_CLASS_I2SVG_BASE_CLASS,"-").concat(Bt)),Et=config.autoFetchSvg?knownPrefixes:FAMILIES.map(Bt=>"fa-".concat(Bt)).concat(Object.keys(styles$2));Et.includes("fa")||Et.push("fa");const At=[".".concat(LAYERS_TEXT_CLASSNAME,":not([").concat(DATA_FA_I2SVG,"])")].concat(Et.map(Bt=>".".concat(Bt,":not([").concat(DATA_FA_I2SVG,"])"))).join(", ");if(At.length===0)return Promise.resolve();let Rt=[];try{Rt=toArray(nt.querySelectorAll(At))}catch{}if(Rt.length>0)gt("pending"),_t("complete");else return Promise.resolve();const Ft=perf.begin("onTree"),Nt=Rt.reduce((Bt,Gt)=>{try{const dr=generateMutation(Gt);dr&&Bt.push(dr)}catch(dr){PRODUCTION$1||dr.name==="MissingIcon"&&console.error(dr)}return Bt},[]);return new Promise((Bt,Gt)=>{Promise.all(Nt).then(dr=>{perform(dr,()=>{gt("active"),gt("complete"),_t("pending"),typeof st=="function"&&st(),Ft(),Bt()})}).catch(dr=>{Ft(),Gt(dr)})})}function onNode(nt){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;generateMutation(nt).then(mt=>{mt&&perform([mt],st)})}function resolveIcons(nt){return function(st){let mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const gt=(st||{}).icon?st:findIconDefinition(st||{});let{mask:_t}=mt;return _t&&(_t=(_t||{}).icon?_t:findIconDefinition(_t||{})),nt(gt,{...mt,mask:_t})}}const render=function(nt){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:mt=meaninglessTransform,symbol:gt=!1,mask:_t=null,maskId:Et=null,title:At=null,titleId:Rt=null,classes:Ft=[],attributes:Nt={},styles:Bt={}}=st;if(!nt)return;const{prefix:Gt,iconName:dr,icon:Mr}=nt;return domVariants({type:"icon",...nt},()=>(callHooks("beforeDOMElementCreation",{iconDefinition:nt,params:st}),config.autoA11y&&(At?Nt["aria-labelledby"]="".concat(config.replacementClass,"-title-").concat(Rt||nextUniqueId()):(Nt["aria-hidden"]="true",Nt.focusable="false")),makeInlineSvgAbstract({icons:{main:asFoundIcon(Mr),mask:_t?asFoundIcon(_t.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Gt,iconName:dr,transform:{...meaninglessTransform,...mt},symbol:gt,title:At,maskId:Et,titleId:Rt,extra:{attributes:Nt,styles:Bt,classes:Ft}})))};var ReplaceElements={mixout(){return{icon:resolveIcons(render)}},hooks(){return{mutationObserverCallbacks(nt){return nt.treeCallback=onTree,nt.nodeCallback=onNode,nt}}},provides(nt){nt.i2svg=function(st){const{node:mt=DOCUMENT,callback:gt=()=>{}}=st;return onTree(mt,gt)},nt.generateSvgReplacementMutation=function(st,mt){const{iconName:gt,title:_t,titleId:Et,prefix:At,transform:Rt,symbol:Ft,mask:Nt,maskId:Bt,extra:Gt}=mt;return new Promise((dr,Mr)=>{Promise.all([findIcon(gt,At),Nt.iconName?findIcon(Nt.iconName,Nt.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(Tr=>{let[zr,Fr]=Tr;dr([st,makeInlineSvgAbstract({icons:{main:zr,mask:Fr},prefix:At,iconName:gt,transform:Rt,symbol:Ft,maskId:Bt,title:_t,titleId:Et,extra:Gt,watchable:!0})])}).catch(Mr)})},nt.generateAbstractIcon=function(st){let{children:mt,attributes:gt,main:_t,transform:Et,styles:At}=st;const Rt=joinStyles(At);Rt.length>0&&(gt.style=Rt);let Ft;return transformIsMeaningful(Et)&&(Ft=callProvided("generateAbstractTransformGrouping",{main:_t,transform:Et,containerWidth:_t.width,iconWidth:_t.width})),mt.push(Ft||_t.icon),{children:mt,attributes:gt}}}},Layers={mixout(){return{layer(nt){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{classes:mt=[]}=st;return domVariants({type:"layer"},()=>{callHooks("beforeDOMElementCreation",{assembler:nt,params:st});let gt=[];return nt(_t=>{Array.isArray(_t)?_t.map(Et=>{gt=gt.concat(Et.abstract)}):gt=gt.concat(_t.abstract)}),[{tag:"span",attributes:{class:["".concat(config.cssPrefix,"-layers"),...mt].join(" ")},children:gt}]})}}}},LayersCounter={mixout(){return{counter(nt){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{title:mt=null,classes:gt=[],attributes:_t={},styles:Et={}}=st;return domVariants({type:"counter",content:nt},()=>(callHooks("beforeDOMElementCreation",{content:nt,params:st}),makeLayersCounterAbstract({content:nt.toString(),title:mt,extra:{attributes:_t,styles:Et,classes:["".concat(config.cssPrefix,"-layers-counter"),...gt]}})))}}}},LayersText={mixout(){return{text(nt){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:mt=meaninglessTransform,title:gt=null,classes:_t=[],attributes:Et={},styles:At={}}=st;return domVariants({type:"text",content:nt},()=>(callHooks("beforeDOMElementCreation",{content:nt,params:st}),makeLayersTextAbstract({content:nt,transform:{...meaninglessTransform,...mt},title:gt,extra:{attributes:Et,styles:At,classes:["".concat(config.cssPrefix,"-layers-text"),..._t]}})))}}},provides(nt){nt.generateLayersText=function(st,mt){const{title:gt,transform:_t,extra:Et}=mt;let At=null,Rt=null;if(IS_IE){const Ft=parseInt(getComputedStyle(st).fontSize,10),Nt=st.getBoundingClientRect();At=Nt.width/Ft,Rt=Nt.height/Ft}return config.autoA11y&&!gt&&(Et.attributes["aria-hidden"]="true"),Promise.resolve([st,makeLayersTextAbstract({content:st.innerHTML,width:At,height:Rt,transform:_t,title:gt,extra:Et,watchable:!0})])}}};const CLEAN_CONTENT_PATTERN=new RegExp('"',"ug"),SECONDARY_UNICODE_RANGE=[1105920,1112319],_FONT_FAMILY_WEIGHT_TO_PREFIX={FontAwesome:{normal:"fas",400:"fas"},...eo,...ao,...mo},FONT_FAMILY_WEIGHT_TO_PREFIX=Object.keys(_FONT_FAMILY_WEIGHT_TO_PREFIX).reduce((nt,st)=>(nt[st.toLowerCase()]=_FONT_FAMILY_WEIGHT_TO_PREFIX[st],nt),{}),FONT_FAMILY_WEIGHT_FALLBACK=Object.keys(FONT_FAMILY_WEIGHT_TO_PREFIX).reduce((nt,st)=>{const mt=FONT_FAMILY_WEIGHT_TO_PREFIX[st];return nt[st]=mt[900]||[...Object.entries(mt)][0][1],nt},{});function hexValueFromContent(nt){const st=nt.replace(CLEAN_CONTENT_PATTERN,""),mt=codePointAt(st,0),gt=mt>=SECONDARY_UNICODE_RANGE[0]&&mt<=SECONDARY_UNICODE_RANGE[1],_t=st.length===2?st[0]===st[1]:!1;return{value:toHex(_t?st[0]:st),isSecondary:gt||_t}}function getPrefix(nt,st){const mt=nt.replace(/^['"]|['"]$/g,"").toLowerCase(),gt=parseInt(st),_t=isNaN(gt)?"normal":gt;return(FONT_FAMILY_WEIGHT_TO_PREFIX[mt]||{})[_t]||FONT_FAMILY_WEIGHT_FALLBACK[mt]}function replaceForPosition(nt,st){const mt="".concat(DATA_FA_PSEUDO_ELEMENT_PENDING).concat(st.replace(":","-"));return new Promise((gt,_t)=>{if(nt.getAttribute(mt)!==null)return gt();const At=toArray(nt.children).filter(dr=>dr.getAttribute(DATA_FA_PSEUDO_ELEMENT)===st)[0],Rt=WINDOW.getComputedStyle(nt,st),Ft=Rt.getPropertyValue("font-family"),Nt=Ft.match(FONT_FAMILY_PATTERN),Bt=Rt.getPropertyValue("font-weight"),Gt=Rt.getPropertyValue("content");if(At&&!Nt)return nt.removeChild(At),gt();if(Nt&&Gt!=="none"&&Gt!==""){const dr=Rt.getPropertyValue("content");let Mr=getPrefix(Ft,Bt);const{value:Tr,isSecondary:zr}=hexValueFromContent(dr),Fr=Nt[0].startsWith("FontAwesome");let Nr=byUnicode(Mr,Tr),tn=Nr;if(Fr){const rn=byOldUnicode(Tr);rn.iconName&&rn.prefix&&(Nr=rn.iconName,Mr=rn.prefix)}if(Nr&&!zr&&(!At||At.getAttribute(DATA_PREFIX)!==Mr||At.getAttribute(DATA_ICON)!==tn)){nt.setAttribute(mt,tn),At&&nt.removeChild(At);const rn=blankMeta(),{extra:Tn}=rn;Tn.attributes[DATA_FA_PSEUDO_ELEMENT]=st,findIcon(Nr,Mr).then($n=>{const un=makeInlineSvgAbstract({...rn,icons:{main:$n,mask:emptyCanonicalIcon()},prefix:Mr,iconName:tn,extra:Tn,watchable:!0}),es=DOCUMENT.createElementNS("http://www.w3.org/2000/svg","svg");st==="::before"?nt.insertBefore(es,nt.firstChild):nt.appendChild(es),es.outerHTML=un.map(kn=>toHtml(kn)).join(`
`),nt.removeAttribute(mt),gt()}).catch(_t)}else gt()}else gt()})}function replace(nt){return Promise.all([replaceForPosition(nt,"::before"),replaceForPosition(nt,"::after")])}function processable(nt){return nt.parentNode!==document.head&&!~TAGNAMES_TO_SKIP_FOR_PSEUDOELEMENTS.indexOf(nt.tagName.toUpperCase())&&!nt.getAttribute(DATA_FA_PSEUDO_ELEMENT)&&(!nt.parentNode||nt.parentNode.tagName!=="svg")}function searchPseudoElements(nt){if(IS_DOM)return new Promise((st,mt)=>{const gt=toArray(nt.querySelectorAll("*")).filter(processable).map(replace),_t=perf.begin("searchPseudoElements");disableObservation(),Promise.all(gt).then(()=>{_t(),enableObservation(),st()}).catch(()=>{_t(),enableObservation(),mt()})})}var PseudoElements={hooks(){return{mutationObserverCallbacks(nt){return nt.pseudoElementsCallback=searchPseudoElements,nt}}},provides(nt){nt.pseudoElements2svg=function(st){const{node:mt=DOCUMENT}=st;config.searchPseudoElements&&searchPseudoElements(mt)}}};let _unwatched=!1;var MutationObserver$1={mixout(){return{dom:{unwatch(){disableObservation(),_unwatched=!0}}}},hooks(){return{bootstrap(){observe(chainHooks("mutationObserverCallbacks",{}))},noAuto(){disconnect()},watch(nt){const{observeMutationsRoot:st}=nt;_unwatched?enableObservation():observe(chainHooks("mutationObserverCallbacks",{observeMutationsRoot:st}))}}}};const parseTransformString=nt=>{let st={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return nt.toLowerCase().split(" ").reduce((mt,gt)=>{const _t=gt.toLowerCase().split("-"),Et=_t[0];let At=_t.slice(1).join("-");if(Et&&At==="h")return mt.flipX=!0,mt;if(Et&&At==="v")return mt.flipY=!0,mt;if(At=parseFloat(At),isNaN(At))return mt;switch(Et){case"grow":mt.size=mt.size+At;break;case"shrink":mt.size=mt.size-At;break;case"left":mt.x=mt.x-At;break;case"right":mt.x=mt.x+At;break;case"up":mt.y=mt.y-At;break;case"down":mt.y=mt.y+At;break;case"rotate":mt.rotate=mt.rotate+At;break}return mt},st)};var PowerTransforms={mixout(){return{parse:{transform:nt=>parseTransformString(nt)}}},hooks(){return{parseNodeAttributes(nt,st){const mt=st.getAttribute("data-fa-transform");return mt&&(nt.transform=parseTransformString(mt)),nt}}},provides(nt){nt.generateAbstractTransformGrouping=function(st){let{main:mt,transform:gt,containerWidth:_t,iconWidth:Et}=st;const At={transform:"translate(".concat(_t/2," 256)")},Rt="translate(".concat(gt.x*32,", ").concat(gt.y*32,") "),Ft="scale(".concat(gt.size/16*(gt.flipX?-1:1),", ").concat(gt.size/16*(gt.flipY?-1:1),") "),Nt="rotate(".concat(gt.rotate," 0 0)"),Bt={transform:"".concat(Rt," ").concat(Ft," ").concat(Nt)},Gt={transform:"translate(".concat(Et/2*-1," -256)")},dr={outer:At,inner:Bt,path:Gt};return{tag:"g",attributes:{...dr.outer},children:[{tag:"g",attributes:{...dr.inner},children:[{tag:mt.icon.tag,children:mt.icon.children,attributes:{...mt.icon.attributes,...dr.path}}]}]}}}};const ALL_SPACE={x:0,y:0,width:"100%",height:"100%"};function fillBlack(nt){let st=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return nt.attributes&&(nt.attributes.fill||st)&&(nt.attributes.fill="black"),nt}function deGroup(nt){return nt.tag==="g"?nt.children:[nt]}var Masks={hooks(){return{parseNodeAttributes(nt,st){const mt=st.getAttribute("data-fa-mask"),gt=mt?getCanonicalIcon(mt.split(" ").map(_t=>_t.trim())):emptyCanonicalIcon();return gt.prefix||(gt.prefix=getDefaultUsablePrefix()),nt.mask=gt,nt.maskId=st.getAttribute("data-fa-mask-id"),nt}}},provides(nt){nt.generateAbstractMask=function(st){let{children:mt,attributes:gt,main:_t,mask:Et,maskId:At,transform:Rt}=st;const{width:Ft,icon:Nt}=_t,{width:Bt,icon:Gt}=Et,dr=transformForSvg({transform:Rt,containerWidth:Bt,iconWidth:Ft}),Mr={tag:"rect",attributes:{...ALL_SPACE,fill:"white"}},Tr=Nt.children?{children:Nt.children.map(fillBlack)}:{},zr={tag:"g",attributes:{...dr.inner},children:[fillBlack({tag:Nt.tag,attributes:{...Nt.attributes,...dr.path},...Tr})]},Fr={tag:"g",attributes:{...dr.outer},children:[zr]},Nr="mask-".concat(At||nextUniqueId()),tn="clip-".concat(At||nextUniqueId()),rn={tag:"mask",attributes:{...ALL_SPACE,id:Nr,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"},children:[Mr,Fr]},Tn={tag:"defs",children:[{tag:"clipPath",attributes:{id:tn},children:deGroup(Gt)},rn]};return mt.push(Tn,{tag:"rect",attributes:{fill:"currentColor","clip-path":"url(#".concat(tn,")"),mask:"url(#".concat(Nr,")"),...ALL_SPACE}}),{children:mt,attributes:gt}}}},MissingIconIndicator={provides(nt){let st=!1;WINDOW.matchMedia&&(st=WINDOW.matchMedia("(prefers-reduced-motion: reduce)").matches),nt.missingIconAbstract=function(){const mt=[],gt={fill:"currentColor"},_t={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};mt.push({tag:"path",attributes:{...gt,d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}});const Et={..._t,attributeName:"opacity"},At={tag:"circle",attributes:{...gt,cx:"256",cy:"364",r:"28"},children:[]};return st||At.children.push({tag:"animate",attributes:{..._t,attributeName:"r",values:"28;14;28;28;14;28;"}},{tag:"animate",attributes:{...Et,values:"1;0;1;1;0;1;"}}),mt.push(At),mt.push({tag:"path",attributes:{...gt,opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"},children:st?[]:[{tag:"animate",attributes:{...Et,values:"1;0;0;0;0;1;"}}]}),st||mt.push({tag:"path",attributes:{...gt,opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"},children:[{tag:"animate",attributes:{...Et,values:"0;0;1;1;0;0;"}}]}),{tag:"g",attributes:{class:"missing"},children:mt}}}},SvgSymbols={hooks(){return{parseNodeAttributes(nt,st){const mt=st.getAttribute("data-fa-symbol"),gt=mt===null?!1:mt===""?!0:mt;return nt.symbol=gt,nt}}}},plugins=[InjectCSS,ReplaceElements,Layers,LayersCounter,LayersText,PseudoElements,MutationObserver$1,PowerTransforms,Masks,MissingIconIndicator,SvgSymbols];registerPlugins(plugins,{mixoutsTo:api});api.noAuto;api.config;api.library;api.dom;const parse$1=api.parse;api.findIconDefinition;api.toHtml;const icon=api.icon;api.layer;api.text;api.counter;var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function nt(gt,_t,Et,At,Rt,Ft){if(Ft!==ReactPropTypesSecret){var Nt=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw Nt.name="Invariant Violation",Nt}}nt.isRequired=nt;function st(){return nt}var mt={array:nt,bigint:nt,bool:nt,func:nt,number:nt,object:nt,string:nt,symbol:nt,any:nt,arrayOf:st,element:nt,elementType:nt,instanceOf:st,node:nt,objectOf:st,oneOf:st,oneOfType:st,shape:st,exact:st,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return mt.PropTypes=mt,mt};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs(propTypesExports);function ownKeys$5(nt,st){var mt=Object.keys(nt);if(Object.getOwnPropertySymbols){var gt=Object.getOwnPropertySymbols(nt);st&&(gt=gt.filter(function(_t){return Object.getOwnPropertyDescriptor(nt,_t).enumerable})),mt.push.apply(mt,gt)}return mt}function _objectSpread2(nt){for(var st=1;st<arguments.length;st++){var mt=arguments[st]!=null?arguments[st]:{};st%2?ownKeys$5(Object(mt),!0).forEach(function(gt){_defineProperty$5(nt,gt,mt[gt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(mt)):ownKeys$5(Object(mt)).forEach(function(gt){Object.defineProperty(nt,gt,Object.getOwnPropertyDescriptor(mt,gt))})}return nt}function _typeof$5(nt){"@babel/helpers - typeof";return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(st){return typeof st}:function(st){return st&&typeof Symbol=="function"&&st.constructor===Symbol&&st!==Symbol.prototype?"symbol":typeof st},_typeof$5(nt)}function _defineProperty$5(nt,st,mt){return st in nt?Object.defineProperty(nt,st,{value:mt,enumerable:!0,configurable:!0,writable:!0}):nt[st]=mt,nt}function _objectWithoutPropertiesLoose$1(nt,st){if(nt==null)return{};var mt={},gt=Object.keys(nt),_t,Et;for(Et=0;Et<gt.length;Et++)_t=gt[Et],!(st.indexOf(_t)>=0)&&(mt[_t]=nt[_t]);return mt}function _objectWithoutProperties$1(nt,st){if(nt==null)return{};var mt=_objectWithoutPropertiesLoose$1(nt,st),gt,_t;if(Object.getOwnPropertySymbols){var Et=Object.getOwnPropertySymbols(nt);for(_t=0;_t<Et.length;_t++)gt=Et[_t],!(st.indexOf(gt)>=0)&&Object.prototype.propertyIsEnumerable.call(nt,gt)&&(mt[gt]=nt[gt])}return mt}function _toConsumableArray(nt){return _arrayWithoutHoles(nt)||_iterableToArray(nt)||_unsupportedIterableToArray(nt)||_nonIterableSpread()}function _arrayWithoutHoles(nt){if(Array.isArray(nt))return _arrayLikeToArray(nt)}function _iterableToArray(nt){if(typeof Symbol<"u"&&nt[Symbol.iterator]!=null||nt["@@iterator"]!=null)return Array.from(nt)}function _unsupportedIterableToArray(nt,st){if(nt){if(typeof nt=="string")return _arrayLikeToArray(nt,st);var mt=Object.prototype.toString.call(nt).slice(8,-1);if(mt==="Object"&&nt.constructor&&(mt=nt.constructor.name),mt==="Map"||mt==="Set")return Array.from(nt);if(mt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(mt))return _arrayLikeToArray(nt,st)}}function _arrayLikeToArray(nt,st){(st==null||st>nt.length)&&(st=nt.length);for(var mt=0,gt=new Array(st);mt<st;mt++)gt[mt]=nt[mt];return gt}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function classList(nt){var st,mt=nt.beat,gt=nt.fade,_t=nt.beatFade,Et=nt.bounce,At=nt.shake,Rt=nt.flash,Ft=nt.spin,Nt=nt.spinPulse,Bt=nt.spinReverse,Gt=nt.pulse,dr=nt.fixedWidth,Mr=nt.inverse,Tr=nt.border,zr=nt.listItem,Fr=nt.flip,Nr=nt.size,tn=nt.rotation,rn=nt.pull,Tn=(st={"fa-beat":mt,"fa-fade":gt,"fa-beat-fade":_t,"fa-bounce":Et,"fa-shake":At,"fa-flash":Rt,"fa-spin":Ft,"fa-spin-reverse":Bt,"fa-spin-pulse":Nt,"fa-pulse":Gt,"fa-fw":dr,"fa-inverse":Mr,"fa-border":Tr,"fa-li":zr,"fa-flip":Fr===!0,"fa-flip-horizontal":Fr==="horizontal"||Fr==="both","fa-flip-vertical":Fr==="vertical"||Fr==="both"},_defineProperty$5(st,"fa-".concat(Nr),typeof Nr<"u"&&Nr!==null),_defineProperty$5(st,"fa-rotate-".concat(tn),typeof tn<"u"&&tn!==null&&tn!==0),_defineProperty$5(st,"fa-pull-".concat(rn),typeof rn<"u"&&rn!==null),_defineProperty$5(st,"fa-swap-opacity",nt.swapOpacity),st);return Object.keys(Tn).map(function($n){return Tn[$n]?$n:null}).filter(function($n){return $n})}function _isNumerical(nt){return nt=nt-0,nt===nt}function camelize(nt){return _isNumerical(nt)?nt:(nt=nt.replace(/[\-_\s]+(.)?/g,function(st,mt){return mt?mt.toUpperCase():""}),nt.substr(0,1).toLowerCase()+nt.substr(1))}var _excluded=["style"];function capitalize(nt){return nt.charAt(0).toUpperCase()+nt.slice(1)}function styleToObject(nt){return nt.split(";").map(function(st){return st.trim()}).filter(function(st){return st}).reduce(function(st,mt){var gt=mt.indexOf(":"),_t=camelize(mt.slice(0,gt)),Et=mt.slice(gt+1).trim();return _t.startsWith("webkit")?st[capitalize(_t)]=Et:st[_t]=Et,st},{})}function convert(nt,st){var mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof st=="string")return st;var gt=(st.children||[]).map(function(Ft){return convert(nt,Ft)}),_t=Object.keys(st.attributes||{}).reduce(function(Ft,Nt){var Bt=st.attributes[Nt];switch(Nt){case"class":Ft.attrs.className=Bt,delete st.attributes.class;break;case"style":Ft.attrs.style=styleToObject(Bt);break;default:Nt.indexOf("aria-")===0||Nt.indexOf("data-")===0?Ft.attrs[Nt.toLowerCase()]=Bt:Ft.attrs[camelize(Nt)]=Bt}return Ft},{attrs:{}}),Et=mt.style,At=Et===void 0?{}:Et,Rt=_objectWithoutProperties$1(mt,_excluded);return _t.attrs.style=_objectSpread2(_objectSpread2({},_t.attrs.style),At),nt.apply(void 0,[st.tag,_objectSpread2(_objectSpread2({},_t.attrs),Rt)].concat(_toConsumableArray(gt)))}var PRODUCTION=!1;try{PRODUCTION=!0}catch{}function log(){if(!PRODUCTION&&console&&typeof console.error=="function"){var nt;(nt=console).error.apply(nt,arguments)}}function normalizeIconArgs(nt){if(nt&&_typeof$5(nt)==="object"&&nt.prefix&&nt.iconName&&nt.icon)return nt;if(parse$1.icon)return parse$1.icon(nt);if(nt===null)return null;if(nt&&_typeof$5(nt)==="object"&&nt.prefix&&nt.iconName)return nt;if(Array.isArray(nt)&&nt.length===2)return{prefix:nt[0],iconName:nt[1]};if(typeof nt=="string")return{prefix:"fas",iconName:nt}}function objectWithKey(nt,st){return Array.isArray(st)&&st.length>0||!Array.isArray(st)&&st?_defineProperty$5({},nt,st):{}}var defaultProps$1={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1},FontAwesomeIcon=React.forwardRef(function(nt,st){var mt=_objectSpread2(_objectSpread2({},defaultProps$1),nt),gt=mt.icon,_t=mt.mask,Et=mt.symbol,At=mt.className,Rt=mt.title,Ft=mt.titleId,Nt=mt.maskId,Bt=normalizeIconArgs(gt),Gt=objectWithKey("classes",[].concat(_toConsumableArray(classList(mt)),_toConsumableArray((At||"").split(" ")))),dr=objectWithKey("transform",typeof mt.transform=="string"?parse$1.transform(mt.transform):mt.transform),Mr=objectWithKey("mask",normalizeIconArgs(_t)),Tr=icon(Bt,_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2({},Gt),dr),Mr),{},{symbol:Et,title:Rt,titleId:Ft,maskId:Nt}));if(!Tr)return log("Could not find icon",Bt),null;var zr=Tr.abstract,Fr={ref:st};return Object.keys(mt).forEach(function(Nr){defaultProps$1.hasOwnProperty(Nr)||(Fr[Nr]=mt[Nr])}),convertCurry(zr[0],Fr)});FontAwesomeIcon.displayName="FontAwesomeIcon";FontAwesomeIcon.propTypes={beat:PropTypes.bool,border:PropTypes.bool,beatFade:PropTypes.bool,bounce:PropTypes.bool,className:PropTypes.string,fade:PropTypes.bool,flash:PropTypes.bool,mask:PropTypes.oneOfType([PropTypes.object,PropTypes.array,PropTypes.string]),maskId:PropTypes.string,fixedWidth:PropTypes.bool,inverse:PropTypes.bool,flip:PropTypes.oneOf([!0,!1,"horizontal","vertical","both"]),icon:PropTypes.oneOfType([PropTypes.object,PropTypes.array,PropTypes.string]),listItem:PropTypes.bool,pull:PropTypes.oneOf(["right","left"]),pulse:PropTypes.bool,rotation:PropTypes.oneOf([0,90,180,270]),shake:PropTypes.bool,size:PropTypes.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:PropTypes.bool,spinPulse:PropTypes.bool,spinReverse:PropTypes.bool,symbol:PropTypes.oneOfType([PropTypes.bool,PropTypes.string]),title:PropTypes.string,titleId:PropTypes.string,transform:PropTypes.oneOfType([PropTypes.string,PropTypes.object]),swapOpacity:PropTypes.bool};var convertCurry=convert.bind(null,React.createElement);const faLinkedin={prefix:"fab",iconName:"linkedin",icon:[448,512,[],"f08c","M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"]},faGithub={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},faEnvelope={prefix:"far",iconName:"envelope",icon:[512,512,[128386,9993,61443],"f0e0","M64 112c-8.8 0-16 7.2-16 16l0 22.1L220.5 291.7c20.7 17 50.4 17 71.1 0L464 150.1l0-22.1c0-8.8-7.2-16-16-16L64 112zM48 212.2L48 384c0 8.8 7.2 16 16 16l384 0c8.8 0 16-7.2 16-16l0-171.8L322 328.8c-38.4 31.5-93.7 31.5-132 0L48 212.2zM0 128C0 92.7 28.7 64 64 64l384 0c35.3 0 64 28.7 64 64l0 256c0 35.3-28.7 64-64 64L64 448c-35.3 0-64-28.7-64-64L0 128z"]},NavSections=dt.div`
  padding: 4rem 2rem;
  border-left: 1px solid var(--dividing-line);
  box-sizing: border-box;


  @media (max-width: 800px) {
    padding: 2rem 0.5rem;
  }
  @media (max-width: 576px) {
    padding: 1rem 0.25rem;
  }
`,NavLogoSection=dt(NavSections)`
  flex-basis: calc(100%/3);
  
  border-left: 0px;
  border-top: 0px;

  @media (max-width: 576px) {
    display: flex;
    justify-content: center;
  }
`,NavLinkSection=dt(NavSections)`
  display: flex;
  flex-basis: calc(100% / 3);
  align-items: center;
  justify-content: center;
`,NavAboutSection=dt(NavSections)`
  display: flex;
  flex-grow: 1; 
  align-items: center;
  justify-content: center;
  cursor: pointer;  /* Change cursor to hand icon on hover */
  
  transition: background-color 0.3s ease;
  
  &:hover {
    background-color: #a2aebe;  /* Color on hover */

    a {
      color: #1a2937;  /* Text color on hover */
    }
  }
`,Nav=dt.div`
  display: flex;
  width: 100%;
  border-bottom: 1px solid var(--dividing-line) ;
`,NBTitle=dt.p`
  padding-left: 20px;

  @media (max-width: 576px) {
    display: none;
  }
`,LogoBox=dt.div`
  display: flex;
  gap: 1rem;
  align-items: center;

  @media (max-width: 800px) {
    transform: scale(0.75);
  }
  @media (max-width: 576px) {
    transform: scale(0.5);
  }
`,LinkBox=dt.div`
  display: flex;
  gap: 6rem;

  @media (max-width: 1200px) {
    gap: 4rem;
  }

  @media (max-width: 992px) {
    gap: 3rem;
  }

  @media (max-width: 768px) {
    gap: 2rem;
  }

  @media (max-width: 576px) {
    gap: 1rem;
  }
`,Logo=dt.img`
  // width: 50px;
  // height:auto;
  // margin-right: 15px;
  
`,logoImg="/website/assets/nb-logo-CL_Xp5GM.png";function HomePage(){const nt=useNavigate();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GlobalStyle$9,{}),jsxRuntimeExports.jsxs(Nav,{children:[jsxRuntimeExports.jsx(NavLogoSection,{children:jsxRuntimeExports.jsxs(LogoBox,{children:[jsxRuntimeExports.jsxs("a",{href:"/portfolio/",children:[jsxRuntimeExports.jsx(Logo,{src:logoImg,alt:"Logo"})," "]}),jsxRuntimeExports.jsx(NBTitle,{children:"Nick Brady"})]})}),jsxRuntimeExports.jsx(NavLinkSection,{children:jsxRuntimeExports.jsxs(LinkBox,{children:[jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLinkedin,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"mailto:nickbrady8444@example.com",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faEnvelope,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]})}),jsxRuntimeExports.jsx(NavAboutSection,{onClick:()=>nt("/about"),children:jsxRuntimeExports.jsx("a",{children:"About"})})]}),jsxRuntimeExports.jsx(Main$4,{children:jsxRuntimeExports.jsxs(MainGrid$3,{children:[jsxRuntimeExports.jsx(ImageSection,{children:jsxRuntimeExports.jsx(SplineWrapper,{children:jsxRuntimeExports.jsx(C$5,{scene:"https://prod.spline.design/uaj1TktepL98W7fs/scene.splinecode"})})}),jsxRuntimeExports.jsx(DescriptionSection$1,{children:jsxRuntimeExports.jsxs(DescriptionText$1,{children:[" Hi, I'm a student at ",jsxRuntimeExports.jsx("strong",{children:"Duke University"})," passionate about",jsxRuntimeExports.jsx("strong",{children:" software development, computer vision, and machine learning."})," "]})}),jsxRuntimeExports.jsx(LowerLeftSection,{onClick:()=>nt("/projects"),children:jsxRuntimeExports.jsx(ProjectSection,{children:jsxRuntimeExports.jsxs(ProjectContainer,{children:[jsxRuntimeExports.jsx(BoldTitle$4,{children:"Projects"}),jsxRuntimeExports.jsxs(PlusIcon,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",width:"50",height:"50",children:[jsxRuntimeExports.jsx("rect",{fill:"currentColor",x:"24.5",width:"1",height:"50"}),jsxRuntimeExports.jsx("rect",{fill:"currentColor",x:"24.5",width:"1",height:"50",transform:"translate(50) rotate(90)"})]})]})})}),jsxRuntimeExports.jsx(ExperienceSection$1,{onClick:()=>nt("/experience"),children:jsxRuntimeExports.jsxs(ExperienceContainer,{children:[jsxRuntimeExports.jsx(BoldTitle$4,{children:"Experience"}),jsxRuntimeExports.jsx(ArrowIcon,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 33.49 45.68",fill:"none",stroke:"currentColor",strokeMiterlimit:"10",children:jsxRuntimeExports.jsx("polyline",{points:".29 .41 32.61 22.84 .29 45.27"})})]})})]})})]})}const GlobalStyle$9=ft`
  :root {
    --light-gray: #b7b7b7;
    --dividing-line: #303f4d;
    --background: #f5f5f5;
  }


  h1, h2, h3, a, p, span{
  font-family: "Lexend Exa", sans-serif;
  font-weight: 400;
  color: var(--light-gray);
  }

  a {
    font-size: 10pt;
    text-decoration: none;
    text-transform: uppercase;
  }

  strong {
    font-weight: 400;
  }

`,Main$4=dt.div`
  flex-grow: 1;
  height: calc(100vh - 175px);
  width: 100%;

  @media (max-width: 576px) {
    height: calc(100vh - 80px);
    overflow-y: auto;
    /* background-color: red; */
  }
`,MainGrid$3=dt.div`
  display: grid;
  height: 100%;
  grid-template-columns: 2fr 1fr;
  grid-template-rows: 2fr 1fr;

  @media (max-width: 576px) {
    grid-template-columns: 1fr;
    grid-template-rows: 1fr 1fr 1fr 1fr;
    margin-bottom: 100px;
    /* grid-template-rows: auto repeat(4, 1fr);  */
    /* height: calc(100vh - 100px); */
    /* overflow-y: auto; */
    /* height: 100vh; */
  }
`,GridSection=dt.div`
  height: 100%;
  border-bottom: 0.5px solid var(--dividing-line);
  border-left: 0.5px solid var(--dividing-line);
`,ImageSection=dt(GridSection)`
  border-left: 0px;
  position: relative;
  overflow: hidden;
`,SplineWrapper=dt.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
`,DescriptionText$1=dt.p`
  font-size: 16px;
  font-weight: 200;
  padding-left: 30px;
  padding-right: 30px;
  padding-bottom: 40px;
  line-height: 3;

  @media (max-width: 1200px) {
    font-size: 16px;
    padding-left: 25px;
    padding-right: 25px;
    padding-bottom: 35px;
  }

  @media (max-width: 992px) {
    font-size: 14px;
    padding-left: 20px;
    padding-right: 20px;
    padding-bottom: 30px;
  }

  @media (max-width: 768px) {
    font-size: 12px;
    padding-left: 15px;
    padding-right: 15px;
    padding-bottom: 25px;
  }

  @media (max-width: 576px) {
    font-size: 10px;
    padding-left: 10px;
    padding-right: 10px;
    padding-bottom: 0px;
    padding-bottom: 0px;
  }
`,DescriptionSection$1=dt(GridSection)`
  display: flex;
  flex-direction: column;
  justify-content: flex-end;

  @media (max-width: 576px) {
    justify-content: center;
    align-items: center;
    text-align: center;
  }
`,LowerLeftSection=dt(GridSection)`
  display: flex;
  border-left: 0px;
`,BoldTitle$4=dt.a`
  font-size: 40px;
  font-weight: bolder;
  padding-right: 15%;
  transition: color 1s ease;

  @media (max-width: 1200px) {
    font-size: 35px;
  padding-right: 15%;
  }

  @media (max-width: 992px) {
    font-size: 30px;
  padding-right: 10%;
  }

  @media (max-width: 768px) {
    font-size: 25px;
  padding-right: 8%;
  }

  @media (max-width: 576px) {
    font-size: 20px;
  padding-right: 5%;
  }
`,PlusIcon=dt.svg`
  height: 115px;
  width: 115px;

  transition: transform 0.5s ease;
  color: #a2aebe;

  @media (max-width: 1200px) {
    height: 100px;
    width: 100px;
  }

  @media (max-width: 992px) {
    height: 85px;
    width: 85px;
  }

  @media (max-width: 768px) {
    height: 70px;
    width: 70px;
  }

  @media (max-width: 576px) {
    height: 55px;
    width: 55px;
  }
`,ArrowIcon=dt.svg`
  height: 115px;
  width: 115px;
  transition: transform 0.5s ease;
  color: #a2aebe;

  @media (max-width: 1200px) {
    height: 100px;
    width: 100px;
  }

  @media (max-width: 992px) {
    height: 85px;
    width: 85px;
  }

  @media (max-width: 768px) {
    height: 70px;
    width: 70px;
  }

  @media (max-width: 576px) {
    height: 55px;
    width: 55px;
  }
`,ProjectSection=dt(GridSection)`
  cursor: pointer;
  
  display: flex;
  align-items: center;  
  justify-content: center;

  flex-basis: 100%;

  transition: background-color 0.3s ease;
  padding: 0 20px;

  &:hover {
    background-color: #a2aebe;  /* Color on hover */
    
    ${BoldTitle$4} {
      color: #1a2937;  /* Text color on hover */
    }

    ${PlusIcon} {
      transform: rotate(90deg);  /* Rotate the image 90 degrees on hover */
      color: #1a2937; 
    }

    ${ArrowIcon} {
      transform: scaleX(-1);
      color: #1a2937; 
    }
  }
`,ProjectContainer=dt.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  width: 100%;
  /* margin-bottom: 40px; */

  @media (max-width: 576px) {
    margin-bottom: 0;
  }
`,ExperienceSection$1=dt(ProjectSection)`
  cursor: pointer;
`,ExperienceContainer=dt(ProjectContainer)`
  
`,BubbleDiv=dt.div`
  display: flex;
  gap: 10px;
  flex-wrap: wrap; /* Allow elements to wrap like text */
  row-gap: 0px; /* Adjust the spacing between rows */
  padding: 20px 0; /* Adjust padding to remove vertical space */

  @media (max-width: 1000px) {
    padding-bottom: 15px;
  }
  @media (max-width: 800px) {
    padding: 5px 0;
    gap: 5px;
  }
`,KeywordBubble=dt.span`
  background-color: #5d708330;
  color: #a2a2a2;
  padding: 10px 30px; /* Adjust padding to remove vertical space */
  border-radius: 50px;
  font-size: 12px;
  white-space: nowrap; /* Prevent text from wrapping */
  align-items: center;
  justify-content: center;
  text-align: center;
  line-height: 2;
  align-self: flex-start; /* Prevent flex item from stretching */
  margin-top: 10px; /* Add margin to separate bubbles */

  @media (max-width: 1000px) {
    line-height: 1;
  }
  @media (max-width: 800px) {
    line-height: 1;
  }
`,GithubBubble=dt.span`
  background-color: #5d708330;
  color: #dfdfdf;
  padding: 10px 30px; /* Adjust padding to remove vertical space */
  border-radius: 50px;
  font-size: 12px;
  white-space: nowrap; /* Prevent text from wrapping */
  align-items: center;
  justify-content: center;
  text-align: center;
  line-height: 2;
  align-self: flex-start; /* Prevent flex item from stretching */
  margin-top: 10px; /* Add margin to separate bubbles */
  outline: 2px solid white; /* Add white outline */
  cursor: pointer;
  @media (max-width: 1000px) {
    line-height: 1;
  }
  @media (max-width: 800px) {
    line-height: 1;
  }
`,CEDImg="/website/assets/CED-D1E1wmOp.jpg",diffEdgeImg="/website/assets/diffusionEdge-CLhOpnRH.png",orthoticOrthoticImg="/website/assets/orthotic-a_He-kVt.jpg",kidney="/website/assets/hero2-BPmcFpD3.webp",appImg="/website/assets/hero-CplFLrfF.jpg",herdImg2="/website/assets/herdImg2-B6SwUCGI.png";function ProjectsPage(){const nt=useNavigate();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GlobalStyle$8,{}),"  ",jsxRuntimeExports.jsxs(Nav,{children:[jsxRuntimeExports.jsx(NavLogoSection,{children:jsxRuntimeExports.jsxs(LogoBox,{children:[jsxRuntimeExports.jsxs("a",{href:"/portfolio/",children:[jsxRuntimeExports.jsx(Logo,{src:logoImg,alt:"Logo"})," "]}),jsxRuntimeExports.jsx(NBTitle,{children:"Nick Brady"})]})}),jsxRuntimeExports.jsx(NavLinkSection,{children:jsxRuntimeExports.jsxs(LinkBox,{children:[jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLinkedin,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"mailto:nickbrady8444@example.com",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faEnvelope,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]})})]}),jsxRuntimeExports.jsx(Main$3,{children:jsxRuntimeExports.jsxs(MainGrid$2,{children:[jsxRuntimeExports.jsx(ProjectsSection,{children:jsxRuntimeExports.jsx(BoldTitle$3,{children:"Projects"})}),jsxRuntimeExports.jsxs(ContentSection$1,{children:[jsxRuntimeExports.jsxs(Row$1,{onClick:()=>nt("/projects/herd"),children:[jsxRuntimeExports.jsx(PlusSign,{children:"+"}),jsxRuntimeExports.jsxs(LeftCol,{children:[jsxRuntimeExports.jsx(ProjectTitle,{children:"Herd: Music App"}),jsxRuntimeExports.jsx(Paragraph$2,{children:"Worked with a client to create the complete front-end for an upcoming music-based social media mobile app, Herd. Implemented smooth, gratifying, gesture-based ranking system. Written with React Native with Supabase backend."}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsx(KeywordBubble,{children:"Software Development"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Graphical User Interface"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Javascript"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"React Native"})]})]}),jsxRuntimeExports.jsx(RightCol,{children:jsxRuntimeExports.jsx(ImageWrapper,{children:jsxRuntimeExports.jsx(ProjectImage,{src:herdImg2})})})]}),jsxRuntimeExports.jsxs(Row$1,{onClick:()=>nt("/projects/compositeelementdetection"),children:[jsxRuntimeExports.jsx(PlusSign,{children:"+"}),jsxRuntimeExports.jsxs(LeftCol,{children:[jsxRuntimeExports.jsx(ProjectTitle,{children:"Composite Element Detection"}),jsxRuntimeExports.jsx(Paragraph$2,{children:"Fully featured GUI for the automatic segmentation and statistical characterization of boron, tungsten, carbon, and polymer from cross-sectional images of a composite material."}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsx(KeywordBubble,{children:"Software Development"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Graphical User Interface"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Computer Vision"})]})]}),jsxRuntimeExports.jsx(RightCol,{children:jsxRuntimeExports.jsx(ImageWrapper,{children:jsxRuntimeExports.jsx(ProjectImage,{src:CEDImg})})})]}),jsxRuntimeExports.jsxs(Row$1,{onClick:()=>nt("/projects/diffusionedge"),children:[jsxRuntimeExports.jsx(PlusSign,{children:"+"}),jsxRuntimeExports.jsxs(LeftCol,{children:[jsxRuntimeExports.jsx(ProjectTitle,{children:"Diffusion Probabilistic Model Based Boron Grain Detection"}),jsxRuntimeExports.jsx(Paragraph$2,{children:"Implemented a state-of-the-art diffusion-based edge detection model to create automated boron grain segmentation and statistical characterization software."}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsx(KeywordBubble,{children:"Convolutional Neural Networks"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Software Development"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Computer Vision"})]})]}),jsxRuntimeExports.jsx(RightCol,{children:jsxRuntimeExports.jsx(ImageWrapper,{children:jsxRuntimeExports.jsx(ProjectImage,{src:diffEdgeImg})})})]}),jsxRuntimeExports.jsxs(Row$1,{onClick:()=>nt("/projects/orthoticprosthetic"),children:[jsxRuntimeExports.jsx(PlusSign,{children:"+"}),jsxRuntimeExports.jsxs(LeftCol,{children:[jsxRuntimeExports.jsx(ProjectTitle,{children:"Algorithmically Generated Prosthetic and Orthotic Devices"}),jsxRuntimeExports.jsx(Paragraph$2,{children:"Developed a novel moldable workflow for open-source orthotic and prosthetic solutions with superior functionality and comfort. Wrote software to generate medical device size and shape from only multi-axial pictures of patient appendages. Collaborated with 2ft Prosthetics on prototyping and deployment."}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsx(KeywordBubble,{children:"Procedural Modeling"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Python"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"OpenCV"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"3D Printing"})]})]}),jsxRuntimeExports.jsx(RightCol,{children:jsxRuntimeExports.jsx(ImageWrapper,{children:jsxRuntimeExports.jsx(ProjectImage,{src:orthoticOrthoticImg})})})]}),jsxRuntimeExports.jsxs(Row$1,{onClick:()=>nt("/projects/kidneystonenavigation"),children:[jsxRuntimeExports.jsx(PlusSign,{children:"+"}),jsxRuntimeExports.jsxs(LeftCol,{children:[jsxRuntimeExports.jsx(ProjectTitle,{children:"Kidney Stone Removal via Autonomous Aiming of a Robotic Ureteroscope during Laser Lithotripsy"}),jsxRuntimeExports.jsx(Paragraph$2,{children:"Created an open-source 3D Slicer extension for the detection of and two-stage navigation toward kidney stones using a robotic ureteroscope. During gross guidance, preliminary targets are identified with hue, stabilized through temporal averaging, and validated with K-means grouping. Then, during fine guidance, a hue-and-lightness based region growing algorithm accurately segments stones in preparation for laser lithotripsy (ablation)."}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsx(KeywordBubble,{children:"Computer Vision"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Software Development"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"3D Slicer"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Robotics"})]})]}),jsxRuntimeExports.jsx(RightCol,{children:jsxRuntimeExports.jsx(ImageWrapper,{children:jsxRuntimeExports.jsx(ProjectImage,{src:kidney})})})]}),jsxRuntimeExports.jsxs(Row$1,{onClick:()=>window.open("https://apps.apple.com/us/app/focus-interval-timer/id6443711772","_blank"),children:[jsxRuntimeExports.jsx(PlusSign,{children:"+"}),jsxRuntimeExports.jsxs(LeftCol,{children:[jsxRuntimeExports.jsx(ProjectTitle,{children:"Interval Timer App on AppStore (for iPhone)"}),jsxRuntimeExports.jsx(Paragraph$2,{children:"Created a minimalist timer with over 1.5k downloads that sends reminder notifications on a set interval over a chosen time period. Designed to be used optionally with Apple Focus."}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsx(KeywordBubble,{children:"Software Development"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Swift"})]})]}),jsxRuntimeExports.jsx(RightCol,{children:jsxRuntimeExports.jsx(ImageWrapper,{children:jsxRuntimeExports.jsx(ProjectImage,{src:appImg,alt:"E-commerce Platform"})})})]})]})]})})]})}const GlobalStyle$8=ft`
  :root {
    --light-gray: #b7b7b7;
    --dividing-line: #303f4d;
    --background: #f5f5f5;
  }

  h1, h2, h3, a, p, span {
    font-family: "Lexend Exa", sans-serif;
    font-weight: 400;
    color: var(--light-gray);
  }

  a {
    font-size: 10pt;
    text-decoration: none;
    text-transform: uppercase;
  }

  strong {
    font-weight: 400;
  }

`,Main$3=dt.div`
  flex-grow: 1;
  height: calc(100vh - 200px);
  overflow-y: auto;
  scrollbar-width: none; /* Firefox */
  scrollbar-color: var(--dividing-line) var(--background); /* Firefox */
  overflow-x: hidden;
  @media (max-width: 800px) {
    height: calc(100vh - 120px);
  }

  @media (max-width: 576px) {
    height: calc(100vh - 75px);
  }

`,MainGrid$2=dt.div`
  display: grid;
  height: 100%;
  grid-template-columns: 10% 90%;
`,ProjectsSection=dt.div`
  display: flex;
  align-items: flex-start; /* Align items to the top */
  justify-content: center;
  border-left: 0.5px solid var(--dividing-line);
  border-bottom: 0.5px solid var(--dividing-line);
  overflow-y: auto;
`,ContentSection$1=dt.div`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: flex-start; /* Push items to the top */
  border-left: 0.5px solid var(--dividing-line);
  border-bottom: 0.5px solid var(--dividing-line);

  @media (max-width: 576px) {
    padding-bottom: 100px;
  }
`,LeftCol=dt.div`
  flex-basis: 30%;
  padding: 70px;

  @media (max-width: 1000px) {
    padding: 25px;
  }
  @media (max-width: 800px) {
    padding: 30px;
    flex: none;
  }
`,RightCol=dt.div`
  flex-basis: 70%;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: 20px;
  padding-top: 70px;
  position: relative;
  border-left: 0.5px solid var(--dividing-line);

  @media (max-width: 800px) {
    padding: 30px;
    flex-basis: auto;
    height: 200px;  
  }
`,ImageWrapper=dt.div`
  width: 100%;
  height: 90%;
  position: absolute;
  top: 0;
  overflow: hidden;
  display: flex;

  @media (max-width: 800px) {
    height: 100%;
    padding-left: 1rem;
  }
`,ProjectImage=dt.img`
  width: 100%;
  height: 100%;
  object-fit: cover;
  top: 50%;

  @media (max-width: 800px) {
    height: auto;
  }
`,ProjectTitle=dt.h3`
  font-size: 16px;
  font-weight: 600;
  margin: 0;
  padding-bottom: 35px;
`,Paragraph$2=dt.p`
  padding-left: 20px;
  padding-bottom: 20px;
  font-size: 16px;
  font-weight: 200;
  line-height: 1.5;
  margin: 0px;

  @media (max-width: 1000px) {
    font-size: 14px;
    padding-bottom: 15px;
    padding-left: 10px;
  }

  @media (max-width: 800px) {
    padding-left: 10px;
    font-size: 14px;
  }
`,BoldTitle$3=dt.a`
  font-size: 40px;
  font-weight: bolder;
  writing-mode: vertical-rl;
  text-orientation: mixed;
  transform: rotate(180deg);
  transition: color 1s ease;
  padding-bottom: 40px;

  @media (max-width: 800px) {
    font-size: 20px;
    padding-bottom: 20px;
  }
  
  @media (max-width: 576px) {
    font-size: 16px;
  }
`,PlusSign=dt.div`
  position: absolute;
  left: 0px;
  top: 50%;
  transform: translateY(-50%);
  opacity: 0;
  transition: opacity 0.3s ease;
  font-size: 30px;
  color: var(--light-gray);
  pointer-events: none;

  @media (max-width: 768px) {
    display: none; /* Hide the plus sign on mobile devices */
  }
`,Row$1=dt.div`
  display: flex;
  width: 100%;
  border-bottom: 0.5px solid var(--dividing-line);
  transition: transform 0.3s ease;
  letter-spacing: 0.5px;
  position: relative;
  cursor: pointer;

  &:hover {
    transform: translateX(30px);
  }

  &:hover ${PlusSign} {
    opacity: 1;
  }

  @media (max-width: 768px) {
    flex-direction: column;
    &:hover {
      transform: none;
    }

    &:hover ${PlusSign} {
      opacity: 0;
    }
  }
`;function ExperiencePage(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GlobalStyle$7,{}),"  ",jsxRuntimeExports.jsxs(Nav,{children:[jsxRuntimeExports.jsx(NavLogoSection,{children:jsxRuntimeExports.jsxs(LogoBox,{children:[jsxRuntimeExports.jsxs("a",{href:"/portfolio/",children:[jsxRuntimeExports.jsx(Logo,{src:logoImg,alt:"Logo"})," "]}),jsxRuntimeExports.jsx(NBTitle,{children:"Nick Brady"})]})}),jsxRuntimeExports.jsx(WideNavLinkSection$7,{children:jsxRuntimeExports.jsxs(LinkBox,{children:[jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLinkedin,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"mailto:nickbrady8444@example.com",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faEnvelope,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]})})]}),jsxRuntimeExports.jsx(Main$2,{children:jsxRuntimeExports.jsxs(MainGrid$1,{children:[jsxRuntimeExports.jsx(ExperienceSection,{children:jsxRuntimeExports.jsx(BoldTitle$2,{children:"Experience"})}),jsxRuntimeExports.jsxs(ContentSection,{children:[jsxRuntimeExports.jsxs(Row,{children:[jsxRuntimeExports.jsxs(Column70,{children:[jsxRuntimeExports.jsx(ExperienceTitle,{children:"Software Engineering Intern at Specialty Materials, Inc."}),jsxRuntimeExports.jsx(ExperienceDate,{children:"June - October 2024"}),jsxRuntimeExports.jsx(Paragraph$1,{children:"Implemented a state-of-the-art diffusion-based edge detection model to create automated boron grain segmentation and statistical characterization software"}),jsxRuntimeExports.jsx(Paragraph$1,{children:"Built software with a fully featured GUI for the automatic segmentation and statistical characterization of boron, tungsten, carbon, and polymer from cross-sectional images of a composite material. "}),jsxRuntimeExports.jsx(Paragraph$1,{children:"Implemented a multi-output random forest regressor to predict material properties of boron-carbon composites, trained on a dataset generated through scripting Ansys Mechanical. Characterized samples with optical and SEM microscopes.  "})]}),jsxRuntimeExports.jsx(Column30,{})]}),jsxRuntimeExports.jsxs(Row,{children:[jsxRuntimeExports.jsxs(Column70,{children:[jsxRuntimeExports.jsx(ExperienceTitle,{children:"Research Intern at Harvard Surgical Navigation and Robotics Lab"}),jsxRuntimeExports.jsx(ExperienceDate,{children:"Summer 2023"}),jsxRuntimeExports.jsx(Paragraph$1,{children:"Created an open-source 3D Slicer extension for the detection of and two-stage navigation toward kidney stones using a robotic ureteroscope. During gross guidance, preliminary targets are identified with hue, stabilized through temporal averaging, and validated with K-means grouping. Then, during fine guidance, a hue-and-lightness based region growing algorithm accurately segments stones in preparation for laser lithotripsy (ablation).  "})]}),jsxRuntimeExports.jsx(Column30,{})]})]})]})})]})}const GlobalStyle$7=ft`
  :root {
    --light-gray: #b7b7b7;
    --dividing-line: #303f4d;
    --background: #f5f5f5;
  }

  h1, h2, h3, a, p, span {
    font-family: "Lexend Exa", sans-serif;
    font-weight: 400;
    color: var(--light-gray);
  }

  a {
    font-size: 10pt;
    text-decoration: none;
    text-transform: uppercase;
  }

  strong {
    font-weight: 400;
  }
`,WideNavLinkSection$7=dt(NavLinkSection)`
  flex-basis: 100%;
`,Main$2=dt.div`
  flex-grow: 1;
  height: calc(100vh - 100px);
    overflow-y: auto;
  scrollbar-width: none; /* Firefox */
  scrollbar-color: var(--dividing-line) var(--background); /* Firefox */
`,MainGrid$1=dt.div`
  display: grid;
  height: 100%;
  grid-template-columns: 10% 90%;
`,ExperienceSection=dt.div`
  display: flex;
  align-items: flex-start; /* Align items to the top */
  justify-content: center;
  border-left: 0.5px solid var(--dividing-line);
  border-bottom: 0.5px solid var(--dividing-line);
`,ContentSection=dt.div`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: flex-start; /* Push items to the top */
  border-left: 0.5px solid var(--dividing-line);
  border-bottom: 0.5px solid var(--dividing-line);

  @media (max-width: 576px) {
    padding-bottom: 100px;
  }
`,Row=dt.div`
  display: flex;
  width: 100%;
  /* margin-top: 20px; */
  /* margin-bottom: 80px; */
  border-bottom: 0.5px solid var(--dividing-line);
  @media (max-width: 800px) {
    flex-direction: column;
  }
`,Column70=dt.div`
  flex-basis: 70%;
  padding: 70px;

  @media (max-width: 1000px) {
    padding: 25px;
  }
  @media (max-width: 800px) {
    padding: 30px;
    padding-bottom: 0px;
  }
`,Column30=dt.div`
  padding: 20px;
  padding-top: 70px;

  @media (max-width: 800px) {
    padding-top: 0px; 
    padding-bottom: 30px;
  }
`,ExperienceDate=dt.p`
  font-size: 16px;
  font-weight: 300;
  margin: 0;
  color: #868d94;
  padding-bottom: 20px;
`,ExperienceTitle=dt.h3`
  font-size: 16px;
  font-weight: 500;
  margin: 0;
  padding-bottom: 5px;
`,Paragraph$1=dt.p`
  padding-left: 20px;
  padding-bottom: 20px;
  font-size: 16px;
  font-weight: 200;
  line-height: 1.5;
  margin: 0px;

  @media (max-width: 1000px) {
    font-size: 14px;
    padding-bottom: 15px;
    padding-left: 10px;
  }

  @media (max-width: 800px) {
    padding-left: 10px;
    padding-bottom: 10px;
    font-size: 14px;
  }
`,BoldTitle$2=dt.a`
  font-size: 40px;
  font-weight: bolder;
  writing-mode: vertical-rl;
  text-orientation: mixed;
  transform: rotate(180deg);
  transition: color 1s ease;
  padding-bottom: 40px;

  @media (max-width: 800px) {
    font-size: 20px;
    padding-bottom: 20px;
  }
`,headshotImg="/website/assets/headshot-kO5b7auM.png";function AboutPage(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GlobalStyle$6,{}),"  ",jsxRuntimeExports.jsxs(Nav,{children:[jsxRuntimeExports.jsx(NavLogoSection,{children:jsxRuntimeExports.jsxs(LogoBox,{children:[jsxRuntimeExports.jsxs("a",{href:"/portfolio/",children:[jsxRuntimeExports.jsx(Logo,{src:logoImg,alt:"Logo"})," "]}),jsxRuntimeExports.jsx(NBTitle,{children:"Nick Brady"})]})}),jsxRuntimeExports.jsx(WideNavLinkSection$6,{children:jsxRuntimeExports.jsxs(LinkBox,{children:[jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLinkedin,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"mailto:nickbrady8444@example.com",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faEnvelope,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]})})]}),jsxRuntimeExports.jsx(Main$1,{children:jsxRuntimeExports.jsxs(MainGrid,{children:[jsxRuntimeExports.jsx(AboutSection,{children:jsxRuntimeExports.jsx(BoldTitle$1,{children:"About"})}),jsxRuntimeExports.jsxs(DescriptionSection,{children:[jsxRuntimeExports.jsxs(Section,{children:[jsxRuntimeExports.jsx(RoundedImage,{src:headshotImg,alt:"Headshot"}),jsxRuntimeExports.jsx(AboutHeaderText,{children:" Hi, Im a student at Duke University passionate about software development, computer vision, and machine learning."})]}),jsxRuntimeExports.jsxs(DescriptionText,{children:["I was first introduced to computer science through my engineering projects, and it didn't take long to transition from a complementary tool to my primary focus.",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),"Working with computers grants me the same problem-solving power as in the real world, but is innately less restrained. With more freedom comes more ability, and unlike the physical world, I have never once sat in front of a computer and felt there was something I physically could not do. It is this passion, combined with an extremely high standard for my work, that I believe sets me apart.",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),"The 'Projects' section features a tour of my favorite work over the years. For more information, including instructions, files, code, and everything else, please visit the GitHub repository link for each.",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{})]})]})]})})]})}const GlobalStyle$6=ft`
  :root {
    --light-gray: #b7b7b7;
    --dividing-line: #303f4d;
    --background: #f5f5f5;
  }

  h1, h2, h3, a, p, span {
    font-family: "Lexend Exa", sans-serif;
    font-weight: 400;
    color: var(--light-gray);
  }

  a {
    font-size: 10pt;
    text-decoration: none;
    text-transform: uppercase;
  }

  strong {
    font-weight: 400;
  }
`,WideNavLinkSection$6=dt(NavLinkSection)`
  flex-basis: 100%;
`,Main$1=dt.div`
  flex-grow: 1;
  height: calc(100vh - 100px);
  overflow-y: auto;
`,MainGrid=dt.div`
  display: grid;
  height: 100%;
  grid-template-columns: 10% 90%;
`,AboutSection=dt.div`
  display: flex;
  align-items: flex-start; /* Align items to the top */
  justify-content: center;
  border-left: 0.5px solid var(--dividing-line);
  border-bottom: 0.5px solid var(--dividing-line);
`,DescriptionSection=dt.div`
  display: flex;
  align-items: flex-start;
  flex-direction: column;
  /* justify-content: center; */
  border-left: 0.5px solid var(--dividing-line);
  border-bottom: 0.5px solid var(--dividing-line);
  
  @media (max-width: 576px) {
    padding-bottom: 100px;
  }
`,DescriptionText=dt.p`
  margin-top: 50px;
  font-size: 18px;
  font-weight: 200;
  padding: 30px;
  line-height: 1.5;
  
  @media (max-width: 576px) {
    font-size: 14px;
  }
`,BoldTitle$1=dt.a`
  font-size: 40px;
  font-weight: bolder;
  writing-mode: vertical-rl;
  text-orientation: mixed;
  transform: rotate(180deg);
  transition: color 1s ease;
  padding-bottom: 40px;

  @media (max-width: 800px) {
    font-size: 20px;
    padding-bottom: 20px;
  }
`,RoundedImage=dt.img`
  /* max-height: 300px; */
  height: 100%;
  max-height: 500px;
  max-width: 30%;
  display: block;
  object-fit: cover;

  @media (max-width: 800px) {
    max-width: 40%;
  }
  
  @media (max-width: 500px) {
    max-width: 100%;
    width: 100%;
  }
`,Section=dt.div`
  width: 100%;
  border-bottom: 0.5px solid var(--dividing-line);
  display: flex;
  flex-direction: row;
  align-items: center;
  
  @media (max-width: 500px) {
    flex-direction: column;
  }
`,AboutHeaderText=dt(DescriptionText)`
  font-size: 25px;
  margin-bottom: 50px;
  font-weight: 300; 
  padding: 0px 80px;

  @media (max-width: 800px) {
    font-size: 20px;
    padding-bottom: 20px;
    padding: 0px 40px;
  }

  @media (max-width: 500px) {
    font-size: 18px;
    padding: 0px 20px;
  }
`;var lib$i={},slider={},innerSlider={},initialState={};(function(nt){Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=void 0;var st={animating:!1,autoplaying:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,dragging:!1,edgeDragged:!1,initialized:!1,lazyLoadedList:[],listHeight:null,listWidth:null,scrolling:!1,slideCount:null,slideHeight:null,slideWidth:null,swipeLeft:null,swiped:!1,swiping:!1,touchObject:{startX:0,startY:0,curX:0,curY:0},trackStyle:{},trackWidth:0,targetSlide:0};nt.default=st})(initialState);var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(nt){(function(){var st={}.hasOwnProperty;function mt(){for(var Et="",At=0;At<arguments.length;At++){var Rt=arguments[At];Rt&&(Et=_t(Et,gt(Rt)))}return Et}function gt(Et){if(typeof Et=="string"||typeof Et=="number")return Et;if(typeof Et!="object")return"";if(Array.isArray(Et))return mt.apply(null,Et);if(Et.toString!==Object.prototype.toString&&!Et.toString.toString().includes("[native code]"))return Et.toString();var At="";for(var Rt in Et)st.call(Et,Rt)&&Et[Rt]&&(At=_t(At,Rt));return At}function _t(Et,At){return At?Et?Et+" "+At:Et+At:Et}nt.exports?(mt.default=mt,nt.exports=mt):window.classNames=mt})()})(classnames);var classnamesExports=classnames.exports,innerSliderUtils={},defaultProps={};(function(nt){Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=void 0;var st=mt(reactExports);function mt(_t){return _t&&_t.__esModule?_t:{default:_t}}var gt={accessibility:!0,adaptiveHeight:!1,afterChange:null,appendDots:function(Et){return st.default.createElement("ul",{style:{display:"block"}},Et)},arrows:!0,autoplay:!1,autoplaySpeed:3e3,beforeChange:null,centerMode:!1,centerPadding:"50px",className:"",cssEase:"ease",customPaging:function(Et){return st.default.createElement("button",null,Et+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:null,nextArrow:null,onEdge:null,onInit:null,onLazyLoadError:null,onReInit:null,pauseOnDotsHover:!1,pauseOnFocus:!1,pauseOnHover:!0,prevArrow:null,responsive:null,rows:1,rtl:!1,slide:"div",slidesPerRow:1,slidesToScroll:1,slidesToShow:1,speed:500,swipe:!0,swipeEvent:null,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,waitForAnimate:!0,asNavFor:null};nt.default=gt})(defaultProps);Object.defineProperty(innerSliderUtils,"__esModule",{value:!0});innerSliderUtils.checkSpecKeys=innerSliderUtils.checkNavigable=innerSliderUtils.changeSlide=innerSliderUtils.canUseDOM=innerSliderUtils.canGoNext=void 0;innerSliderUtils.clamp=clamp;innerSliderUtils.extractObject=void 0;innerSliderUtils.filterSettings=filterSettings;innerSliderUtils.validSettings=innerSliderUtils.swipeStart=innerSliderUtils.swipeMove=innerSliderUtils.swipeEnd=innerSliderUtils.slidesOnRight=innerSliderUtils.slidesOnLeft=innerSliderUtils.slideHandler=innerSliderUtils.siblingDirection=innerSliderUtils.safePreventDefault=innerSliderUtils.lazyStartIndex=innerSliderUtils.lazySlidesOnRight=innerSliderUtils.lazySlidesOnLeft=innerSliderUtils.lazyEndIndex=innerSliderUtils.keyHandler=innerSliderUtils.initializedState=innerSliderUtils.getWidth=innerSliderUtils.getTrackLeft=innerSliderUtils.getTrackCSS=innerSliderUtils.getTrackAnimateCSS=innerSliderUtils.getTotalSlides=innerSliderUtils.getSwipeDirection=innerSliderUtils.getSlideCount=innerSliderUtils.getRequiredLazySlides=innerSliderUtils.getPreClones=innerSliderUtils.getPostClones=innerSliderUtils.getOnDemandLazySlides=innerSliderUtils.getNavigableIndexes=innerSliderUtils.getHeight=void 0;var _react$4=_interopRequireDefault$4(reactExports),_defaultProps=_interopRequireDefault$4(defaultProps);function _interopRequireDefault$4(nt){return nt&&nt.__esModule?nt:{default:nt}}function _typeof$4(nt){"@babel/helpers - typeof";return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(st){return typeof st}:function(st){return st&&typeof Symbol=="function"&&st.constructor===Symbol&&st!==Symbol.prototype?"symbol":typeof st},_typeof$4(nt)}function ownKeys$4(nt,st){var mt=Object.keys(nt);if(Object.getOwnPropertySymbols){var gt=Object.getOwnPropertySymbols(nt);st&&(gt=gt.filter(function(_t){return Object.getOwnPropertyDescriptor(nt,_t).enumerable})),mt.push.apply(mt,gt)}return mt}function _objectSpread$4(nt){for(var st=1;st<arguments.length;st++){var mt=arguments[st]!=null?arguments[st]:{};st%2?ownKeys$4(Object(mt),!0).forEach(function(gt){_defineProperty$4(nt,gt,mt[gt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(mt)):ownKeys$4(Object(mt)).forEach(function(gt){Object.defineProperty(nt,gt,Object.getOwnPropertyDescriptor(mt,gt))})}return nt}function _defineProperty$4(nt,st,mt){return st=_toPropertyKey$4(st),st in nt?Object.defineProperty(nt,st,{value:mt,enumerable:!0,configurable:!0,writable:!0}):nt[st]=mt,nt}function _toPropertyKey$4(nt){var st=_toPrimitive$4(nt,"string");return _typeof$4(st)=="symbol"?st:String(st)}function _toPrimitive$4(nt,st){if(_typeof$4(nt)!="object"||!nt)return nt;var mt=nt[Symbol.toPrimitive];if(mt!==void 0){var gt=mt.call(nt,st||"default");if(_typeof$4(gt)!="object")return gt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(st==="string"?String:Number)(nt)}function clamp(nt,st,mt){return Math.max(st,Math.min(nt,mt))}var safePreventDefault=innerSliderUtils.safePreventDefault=function(st){var mt=["onTouchStart","onTouchMove","onWheel"];mt.includes(st._reactName)||st.preventDefault()},getOnDemandLazySlides=innerSliderUtils.getOnDemandLazySlides=function(st){for(var mt=[],gt=lazyStartIndex(st),_t=lazyEndIndex(st),Et=gt;Et<_t;Et++)st.lazyLoadedList.indexOf(Et)<0&&mt.push(Et);return mt};innerSliderUtils.getRequiredLazySlides=function(st){for(var mt=[],gt=lazyStartIndex(st),_t=lazyEndIndex(st),Et=gt;Et<_t;Et++)mt.push(Et);return mt};var lazyStartIndex=innerSliderUtils.lazyStartIndex=function(st){return st.currentSlide-lazySlidesOnLeft(st)},lazyEndIndex=innerSliderUtils.lazyEndIndex=function(st){return st.currentSlide+lazySlidesOnRight(st)},lazySlidesOnLeft=innerSliderUtils.lazySlidesOnLeft=function(st){return st.centerMode?Math.floor(st.slidesToShow/2)+(parseInt(st.centerPadding)>0?1:0):0},lazySlidesOnRight=innerSliderUtils.lazySlidesOnRight=function(st){return st.centerMode?Math.floor((st.slidesToShow-1)/2)+1+(parseInt(st.centerPadding)>0?1:0):st.slidesToShow},getWidth=innerSliderUtils.getWidth=function(st){return st&&st.offsetWidth||0},getHeight=innerSliderUtils.getHeight=function(st){return st&&st.offsetHeight||0},getSwipeDirection=innerSliderUtils.getSwipeDirection=function(st){var mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,gt,_t,Et,At;return gt=st.startX-st.curX,_t=st.startY-st.curY,Et=Math.atan2(_t,gt),At=Math.round(Et*180/Math.PI),At<0&&(At=360-Math.abs(At)),At<=45&&At>=0||At<=360&&At>=315?"left":At>=135&&At<=225?"right":mt===!0?At>=35&&At<=135?"up":"down":"vertical"},canGoNext=innerSliderUtils.canGoNext=function(st){var mt=!0;return st.infinite||(st.centerMode&&st.currentSlide>=st.slideCount-1||st.slideCount<=st.slidesToShow||st.currentSlide>=st.slideCount-st.slidesToShow)&&(mt=!1),mt};innerSliderUtils.extractObject=function(st,mt){var gt={};return mt.forEach(function(_t){return gt[_t]=st[_t]}),gt};innerSliderUtils.initializedState=function(st){var mt=_react$4.default.Children.count(st.children),gt=st.listRef,_t=Math.ceil(getWidth(gt)),Et=st.trackRef&&st.trackRef.node,At=Math.ceil(getWidth(Et)),Rt;if(st.vertical)Rt=_t;else{var Ft=st.centerMode&&parseInt(st.centerPadding)*2;typeof st.centerPadding=="string"&&st.centerPadding.slice(-1)==="%"&&(Ft*=_t/100),Rt=Math.ceil((_t-Ft)/st.slidesToShow)}var Nt=gt&&getHeight(gt.querySelector('[data-index="0"]')),Bt=Nt*st.slidesToShow,Gt=st.currentSlide===void 0?st.initialSlide:st.currentSlide;st.rtl&&st.currentSlide===void 0&&(Gt=mt-1-st.initialSlide);var dr=st.lazyLoadedList||[],Mr=getOnDemandLazySlides(_objectSpread$4(_objectSpread$4({},st),{},{currentSlide:Gt,lazyLoadedList:dr}));dr=dr.concat(Mr);var Tr={slideCount:mt,slideWidth:Rt,listWidth:_t,trackWidth:At,currentSlide:Gt,slideHeight:Nt,listHeight:Bt,lazyLoadedList:dr};return st.autoplaying===null&&st.autoplay&&(Tr.autoplaying="playing"),Tr};innerSliderUtils.slideHandler=function(st){var mt=st.waitForAnimate,gt=st.animating,_t=st.fade,Et=st.infinite,At=st.index,Rt=st.slideCount,Ft=st.lazyLoad,Nt=st.currentSlide,Bt=st.centerMode,Gt=st.slidesToScroll,dr=st.slidesToShow,Mr=st.useCSS,Tr=st.lazyLoadedList;if(mt&&gt)return{};var zr=At,Fr,Nr,tn,rn={},Tn={},$n=Et?At:clamp(At,0,Rt-1);if(_t){if(!Et&&(At<0||At>=Rt))return{};At<0?zr=At+Rt:At>=Rt&&(zr=At-Rt),Ft&&Tr.indexOf(zr)<0&&(Tr=Tr.concat(zr)),rn={animating:!0,currentSlide:zr,lazyLoadedList:Tr,targetSlide:zr},Tn={animating:!1,targetSlide:zr}}else Fr=zr,zr<0?(Fr=zr+Rt,Et?Rt%Gt!==0&&(Fr=Rt-Rt%Gt):Fr=0):!canGoNext(st)&&zr>Nt?zr=Fr=Nt:Bt&&zr>=Rt?(zr=Et?Rt:Rt-1,Fr=Et?0:Rt-1):zr>=Rt&&(Fr=zr-Rt,Et?Rt%Gt!==0&&(Fr=0):Fr=Rt-dr),!Et&&zr+dr>=Rt&&(Fr=Rt-dr),Nr=getTrackLeft(_objectSpread$4(_objectSpread$4({},st),{},{slideIndex:zr})),tn=getTrackLeft(_objectSpread$4(_objectSpread$4({},st),{},{slideIndex:Fr})),Et||(Nr===tn&&(zr=Fr),Nr=tn),Ft&&(Tr=Tr.concat(getOnDemandLazySlides(_objectSpread$4(_objectSpread$4({},st),{},{currentSlide:zr})))),Mr?(rn={animating:!0,currentSlide:Fr,trackStyle:getTrackAnimateCSS(_objectSpread$4(_objectSpread$4({},st),{},{left:Nr})),lazyLoadedList:Tr,targetSlide:$n},Tn={animating:!1,currentSlide:Fr,trackStyle:getTrackCSS(_objectSpread$4(_objectSpread$4({},st),{},{left:tn})),swipeLeft:null,targetSlide:$n}):rn={currentSlide:Fr,trackStyle:getTrackCSS(_objectSpread$4(_objectSpread$4({},st),{},{left:tn})),lazyLoadedList:Tr,targetSlide:$n};return{state:rn,nextState:Tn}};innerSliderUtils.changeSlide=function(st,mt){var gt,_t,Et,At,Rt,Ft=st.slidesToScroll,Nt=st.slidesToShow,Bt=st.slideCount,Gt=st.currentSlide,dr=st.targetSlide,Mr=st.lazyLoad,Tr=st.infinite;if(At=Bt%Ft!==0,gt=At?0:(Bt-Gt)%Ft,mt.message==="previous")Et=gt===0?Ft:Nt-gt,Rt=Gt-Et,Mr&&!Tr&&(_t=Gt-Et,Rt=_t===-1?Bt-1:_t),Tr||(Rt=dr-Ft);else if(mt.message==="next")Et=gt===0?Ft:gt,Rt=Gt+Et,Mr&&!Tr&&(Rt=(Gt+Ft)%Bt+gt),Tr||(Rt=dr+Ft);else if(mt.message==="dots")Rt=mt.index*mt.slidesToScroll;else if(mt.message==="children"){if(Rt=mt.index,Tr){var zr=siblingDirection(_objectSpread$4(_objectSpread$4({},st),{},{targetSlide:Rt}));Rt>mt.currentSlide&&zr==="left"?Rt=Rt-Bt:Rt<mt.currentSlide&&zr==="right"&&(Rt=Rt+Bt)}}else mt.message==="index"&&(Rt=Number(mt.index));return Rt};innerSliderUtils.keyHandler=function(st,mt,gt){return st.target.tagName.match("TEXTAREA|INPUT|SELECT")||!mt?"":st.keyCode===37?gt?"next":"previous":st.keyCode===39?gt?"previous":"next":""};innerSliderUtils.swipeStart=function(st,mt,gt){return st.target.tagName==="IMG"&&safePreventDefault(st),!mt||!gt&&st.type.indexOf("mouse")!==-1?"":{dragging:!0,touchObject:{startX:st.touches?st.touches[0].pageX:st.clientX,startY:st.touches?st.touches[0].pageY:st.clientY,curX:st.touches?st.touches[0].pageX:st.clientX,curY:st.touches?st.touches[0].pageY:st.clientY}}};innerSliderUtils.swipeMove=function(st,mt){var gt=mt.scrolling,_t=mt.animating,Et=mt.vertical,At=mt.swipeToSlide,Rt=mt.verticalSwiping,Ft=mt.rtl,Nt=mt.currentSlide,Bt=mt.edgeFriction,Gt=mt.edgeDragged,dr=mt.onEdge,Mr=mt.swiped,Tr=mt.swiping,zr=mt.slideCount,Fr=mt.slidesToScroll,Nr=mt.infinite,tn=mt.touchObject,rn=mt.swipeEvent,Tn=mt.listHeight,$n=mt.listWidth;if(!gt){if(_t)return safePreventDefault(st);Et&&At&&Rt&&safePreventDefault(st);var un,es={},kn=getTrackLeft(mt);tn.curX=st.touches?st.touches[0].pageX:st.clientX,tn.curY=st.touches?st.touches[0].pageY:st.clientY,tn.swipeLength=Math.round(Math.sqrt(Math.pow(tn.curX-tn.startX,2)));var ts=Math.round(Math.sqrt(Math.pow(tn.curY-tn.startY,2)));if(!Rt&&!Tr&&ts>10)return{scrolling:!0};Rt&&(tn.swipeLength=ts);var Ko=(Ft?-1:1)*(tn.curX>tn.startX?1:-1);Rt&&(Ko=tn.curY>tn.startY?1:-1);var ds=Math.ceil(zr/Fr),Il=getSwipeDirection(mt.touchObject,Rt),ru=tn.swipeLength;return Nr||(Nt===0&&(Il==="right"||Il==="down")||Nt+1>=ds&&(Il==="left"||Il==="up")||!canGoNext(mt)&&(Il==="left"||Il==="up"))&&(ru=tn.swipeLength*Bt,Gt===!1&&dr&&(dr(Il),es.edgeDragged=!0)),!Mr&&rn&&(rn(Il),es.swiped=!0),Et?un=kn+ru*(Tn/$n)*Ko:Ft?un=kn-ru*Ko:un=kn+ru*Ko,Rt&&(un=kn+ru*Ko),es=_objectSpread$4(_objectSpread$4({},es),{},{touchObject:tn,swipeLeft:un,trackStyle:getTrackCSS(_objectSpread$4(_objectSpread$4({},mt),{},{left:un}))}),Math.abs(tn.curX-tn.startX)<Math.abs(tn.curY-tn.startY)*.8||tn.swipeLength>10&&(es.swiping=!0,safePreventDefault(st)),es}};innerSliderUtils.swipeEnd=function(st,mt){var gt=mt.dragging,_t=mt.swipe,Et=mt.touchObject,At=mt.listWidth,Rt=mt.touchThreshold,Ft=mt.verticalSwiping,Nt=mt.listHeight,Bt=mt.swipeToSlide,Gt=mt.scrolling,dr=mt.onSwipe,Mr=mt.targetSlide,Tr=mt.currentSlide,zr=mt.infinite;if(!gt)return _t&&safePreventDefault(st),{};var Fr=Ft?Nt/Rt:At/Rt,Nr=getSwipeDirection(Et,Ft),tn={dragging:!1,edgeDragged:!1,scrolling:!1,swiping:!1,swiped:!1,swipeLeft:null,touchObject:{}};if(Gt||!Et.swipeLength)return tn;if(Et.swipeLength>Fr){safePreventDefault(st),dr&&dr(Nr);var rn,Tn,$n=zr?Tr:Mr;switch(Nr){case"left":case"up":Tn=$n+getSlideCount(mt),rn=Bt?checkNavigable(mt,Tn):Tn,tn.currentDirection=0;break;case"right":case"down":Tn=$n-getSlideCount(mt),rn=Bt?checkNavigable(mt,Tn):Tn,tn.currentDirection=1;break;default:rn=$n}tn.triggerSlideHandler=rn}else{var un=getTrackLeft(mt);tn.trackStyle=getTrackAnimateCSS(_objectSpread$4(_objectSpread$4({},mt),{},{left:un}))}return tn};var getNavigableIndexes=innerSliderUtils.getNavigableIndexes=function(st){for(var mt=st.infinite?st.slideCount*2:st.slideCount,gt=st.infinite?st.slidesToShow*-1:0,_t=st.infinite?st.slidesToShow*-1:0,Et=[];gt<mt;)Et.push(gt),gt=_t+st.slidesToScroll,_t+=Math.min(st.slidesToScroll,st.slidesToShow);return Et},checkNavigable=innerSliderUtils.checkNavigable=function(st,mt){var gt=getNavigableIndexes(st),_t=0;if(mt>gt[gt.length-1])mt=gt[gt.length-1];else for(var Et in gt){if(mt<gt[Et]){mt=_t;break}_t=gt[Et]}return mt},getSlideCount=innerSliderUtils.getSlideCount=function(st){var mt=st.centerMode?st.slideWidth*Math.floor(st.slidesToShow/2):0;if(st.swipeToSlide){var gt,_t=st.listRef,Et=_t.querySelectorAll&&_t.querySelectorAll(".slick-slide")||[];if(Array.from(Et).every(function(Ft){if(st.vertical){if(Ft.offsetTop+getHeight(Ft)/2>st.swipeLeft*-1)return gt=Ft,!1}else if(Ft.offsetLeft-mt+getWidth(Ft)/2>st.swipeLeft*-1)return gt=Ft,!1;return!0}),!gt)return 0;var At=st.rtl===!0?st.slideCount-st.currentSlide:st.currentSlide,Rt=Math.abs(gt.dataset.index-At)||1;return Rt}else return st.slidesToScroll},checkSpecKeys=innerSliderUtils.checkSpecKeys=function(st,mt){return mt.reduce(function(gt,_t){return gt&&st.hasOwnProperty(_t)},!0)?null:console.error("Keys Missing:",st)},getTrackCSS=innerSliderUtils.getTrackCSS=function(st){checkSpecKeys(st,["left","variableWidth","slideCount","slidesToShow","slideWidth"]);var mt,gt,_t=st.slideCount+2*st.slidesToShow;st.vertical?gt=_t*st.slideHeight:mt=getTotalSlides(st)*st.slideWidth;var Et={opacity:1,transition:"",WebkitTransition:""};if(st.useTransform){var At=st.vertical?"translate3d(0px, "+st.left+"px, 0px)":"translate3d("+st.left+"px, 0px, 0px)",Rt=st.vertical?"translate3d(0px, "+st.left+"px, 0px)":"translate3d("+st.left+"px, 0px, 0px)",Ft=st.vertical?"translateY("+st.left+"px)":"translateX("+st.left+"px)";Et=_objectSpread$4(_objectSpread$4({},Et),{},{WebkitTransform:At,transform:Rt,msTransform:Ft})}else st.vertical?Et.top=st.left:Et.left=st.left;return st.fade&&(Et={opacity:1}),mt&&(Et.width=mt),gt&&(Et.height=gt),window&&!window.addEventListener&&window.attachEvent&&(st.vertical?Et.marginTop=st.left+"px":Et.marginLeft=st.left+"px"),Et},getTrackAnimateCSS=innerSliderUtils.getTrackAnimateCSS=function(st){checkSpecKeys(st,["left","variableWidth","slideCount","slidesToShow","slideWidth","speed","cssEase"]);var mt=getTrackCSS(st);return st.useTransform?(mt.WebkitTransition="-webkit-transform "+st.speed+"ms "+st.cssEase,mt.transition="transform "+st.speed+"ms "+st.cssEase):st.vertical?mt.transition="top "+st.speed+"ms "+st.cssEase:mt.transition="left "+st.speed+"ms "+st.cssEase,mt},getTrackLeft=innerSliderUtils.getTrackLeft=function(st){if(st.unslick)return 0;checkSpecKeys(st,["slideIndex","trackRef","infinite","centerMode","slideCount","slidesToShow","slidesToScroll","slideWidth","listWidth","variableWidth","slideHeight"]);var mt=st.slideIndex,gt=st.trackRef,_t=st.infinite,Et=st.centerMode,At=st.slideCount,Rt=st.slidesToShow,Ft=st.slidesToScroll,Nt=st.slideWidth,Bt=st.listWidth,Gt=st.variableWidth,dr=st.slideHeight,Mr=st.fade,Tr=st.vertical,zr=0,Fr,Nr,tn=0;if(Mr||st.slideCount===1)return 0;var rn=0;if(_t?(rn=-getPreClones(st),At%Ft!==0&&mt+Ft>At&&(rn=-(mt>At?Rt-(mt-At):At%Ft)),Et&&(rn+=parseInt(Rt/2))):(At%Ft!==0&&mt+Ft>At&&(rn=Rt-At%Ft),Et&&(rn=parseInt(Rt/2))),zr=rn*Nt,tn=rn*dr,Tr?Fr=mt*dr*-1+tn:Fr=mt*Nt*-1+zr,Gt===!0){var Tn,$n=gt&&gt.node;if(Tn=mt+getPreClones(st),Nr=$n&&$n.childNodes[Tn],Fr=Nr?Nr.offsetLeft*-1:0,Et===!0){Tn=_t?mt+getPreClones(st):mt,Nr=$n&&$n.children[Tn],Fr=0;for(var un=0;un<Tn;un++)Fr-=$n&&$n.children[un]&&$n.children[un].offsetWidth;Fr-=parseInt(st.centerPadding),Fr+=Nr&&(Bt-Nr.offsetWidth)/2}}return Fr},getPreClones=innerSliderUtils.getPreClones=function(st){return st.unslick||!st.infinite?0:st.variableWidth?st.slideCount:st.slidesToShow+(st.centerMode?1:0)},getPostClones=innerSliderUtils.getPostClones=function(st){return st.unslick||!st.infinite?0:st.slideCount},getTotalSlides=innerSliderUtils.getTotalSlides=function(st){return st.slideCount===1?1:getPreClones(st)+st.slideCount+getPostClones(st)},siblingDirection=innerSliderUtils.siblingDirection=function(st){return st.targetSlide>st.currentSlide?st.targetSlide>st.currentSlide+slidesOnRight(st)?"left":"right":st.targetSlide<st.currentSlide-slidesOnLeft(st)?"right":"left"},slidesOnRight=innerSliderUtils.slidesOnRight=function(st){var mt=st.slidesToShow,gt=st.centerMode,_t=st.rtl,Et=st.centerPadding;if(gt){var At=(mt-1)/2+1;return parseInt(Et)>0&&(At+=1),_t&&mt%2===0&&(At+=1),At}return _t?0:mt-1},slidesOnLeft=innerSliderUtils.slidesOnLeft=function(st){var mt=st.slidesToShow,gt=st.centerMode,_t=st.rtl,Et=st.centerPadding;if(gt){var At=(mt-1)/2+1;return parseInt(Et)>0&&(At+=1),!_t&&mt%2===0&&(At+=1),At}return _t?mt-1:0};innerSliderUtils.canUseDOM=function(){return!!(typeof window<"u"&&window.document&&window.document.createElement)};var validSettings=innerSliderUtils.validSettings=Object.keys(_defaultProps.default);function filterSettings(nt){return validSettings.reduce(function(st,mt){return nt.hasOwnProperty(mt)&&(st[mt]=nt[mt]),st},{})}var track={};Object.defineProperty(track,"__esModule",{value:!0});track.Track=void 0;var _react$3=_interopRequireDefault$3(reactExports),_classnames$3=_interopRequireDefault$3(classnamesExports),_innerSliderUtils$3=innerSliderUtils;function _interopRequireDefault$3(nt){return nt&&nt.__esModule?nt:{default:nt}}function _typeof$3(nt){"@babel/helpers - typeof";return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(st){return typeof st}:function(st){return st&&typeof Symbol=="function"&&st.constructor===Symbol&&st!==Symbol.prototype?"symbol":typeof st},_typeof$3(nt)}function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(nt){for(var st=1;st<arguments.length;st++){var mt=arguments[st];for(var gt in mt)Object.prototype.hasOwnProperty.call(mt,gt)&&(nt[gt]=mt[gt])}return nt},_extends$2.apply(this,arguments)}function _classCallCheck$3(nt,st){if(!(nt instanceof st))throw new TypeError("Cannot call a class as a function")}function _defineProperties$3(nt,st){for(var mt=0;mt<st.length;mt++){var gt=st[mt];gt.enumerable=gt.enumerable||!1,gt.configurable=!0,"value"in gt&&(gt.writable=!0),Object.defineProperty(nt,_toPropertyKey$3(gt.key),gt)}}function _createClass$3(nt,st,mt){return st&&_defineProperties$3(nt.prototype,st),Object.defineProperty(nt,"prototype",{writable:!1}),nt}function _inherits$3(nt,st){if(typeof st!="function"&&st!==null)throw new TypeError("Super expression must either be null or a function");nt.prototype=Object.create(st&&st.prototype,{constructor:{value:nt,writable:!0,configurable:!0}}),Object.defineProperty(nt,"prototype",{writable:!1}),st&&_setPrototypeOf$3(nt,st)}function _setPrototypeOf$3(nt,st){return _setPrototypeOf$3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(gt,_t){return gt.__proto__=_t,gt},_setPrototypeOf$3(nt,st)}function _createSuper$3(nt){var st=_isNativeReflectConstruct$3();return function(){var gt=_getPrototypeOf$3(nt),_t;if(st){var Et=_getPrototypeOf$3(this).constructor;_t=Reflect.construct(gt,arguments,Et)}else _t=gt.apply(this,arguments);return _possibleConstructorReturn$3(this,_t)}}function _possibleConstructorReturn$3(nt,st){if(st&&(_typeof$3(st)==="object"||typeof st=="function"))return st;if(st!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$3(nt)}function _assertThisInitialized$3(nt){if(nt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return nt}function _isNativeReflectConstruct$3(){try{var nt=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$3=function(){return!!nt})()}function _getPrototypeOf$3(nt){return _getPrototypeOf$3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(mt){return mt.__proto__||Object.getPrototypeOf(mt)},_getPrototypeOf$3(nt)}function ownKeys$3(nt,st){var mt=Object.keys(nt);if(Object.getOwnPropertySymbols){var gt=Object.getOwnPropertySymbols(nt);st&&(gt=gt.filter(function(_t){return Object.getOwnPropertyDescriptor(nt,_t).enumerable})),mt.push.apply(mt,gt)}return mt}function _objectSpread$3(nt){for(var st=1;st<arguments.length;st++){var mt=arguments[st]!=null?arguments[st]:{};st%2?ownKeys$3(Object(mt),!0).forEach(function(gt){_defineProperty$3(nt,gt,mt[gt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(mt)):ownKeys$3(Object(mt)).forEach(function(gt){Object.defineProperty(nt,gt,Object.getOwnPropertyDescriptor(mt,gt))})}return nt}function _defineProperty$3(nt,st,mt){return st=_toPropertyKey$3(st),st in nt?Object.defineProperty(nt,st,{value:mt,enumerable:!0,configurable:!0,writable:!0}):nt[st]=mt,nt}function _toPropertyKey$3(nt){var st=_toPrimitive$3(nt,"string");return _typeof$3(st)=="symbol"?st:String(st)}function _toPrimitive$3(nt,st){if(_typeof$3(nt)!="object"||!nt)return nt;var mt=nt[Symbol.toPrimitive];if(mt!==void 0){var gt=mt.call(nt,st||"default");if(_typeof$3(gt)!="object")return gt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(st==="string"?String:Number)(nt)}var getSlideClasses=function(st){var mt,gt,_t,Et,At;st.rtl?At=st.slideCount-1-st.index:At=st.index,_t=At<0||At>=st.slideCount,st.centerMode?(Et=Math.floor(st.slidesToShow/2),gt=(At-st.currentSlide)%st.slideCount===0,At>st.currentSlide-Et-1&&At<=st.currentSlide+Et&&(mt=!0)):mt=st.currentSlide<=At&&At<st.currentSlide+st.slidesToShow;var Rt;st.targetSlide<0?Rt=st.targetSlide+st.slideCount:st.targetSlide>=st.slideCount?Rt=st.targetSlide-st.slideCount:Rt=st.targetSlide;var Ft=At===Rt;return{"slick-slide":!0,"slick-active":mt,"slick-center":gt,"slick-cloned":_t,"slick-current":Ft}},getSlideStyle=function(st){var mt={};return(st.variableWidth===void 0||st.variableWidth===!1)&&(mt.width=st.slideWidth),st.fade&&(mt.position="relative",st.vertical?mt.top=-st.index*parseInt(st.slideHeight):mt.left=-st.index*parseInt(st.slideWidth),mt.opacity=st.currentSlide===st.index?1:0,mt.zIndex=st.currentSlide===st.index?999:998,st.useCSS&&(mt.transition="opacity "+st.speed+"ms "+st.cssEase+", visibility "+st.speed+"ms "+st.cssEase)),mt},getKey=function(st,mt){return st.key||mt},renderSlides=function(st){var mt,gt=[],_t=[],Et=[],At=_react$3.default.Children.count(st.children),Rt=(0,_innerSliderUtils$3.lazyStartIndex)(st),Ft=(0,_innerSliderUtils$3.lazyEndIndex)(st);return _react$3.default.Children.forEach(st.children,function(Nt,Bt){var Gt,dr={message:"children",index:Bt,slidesToScroll:st.slidesToScroll,currentSlide:st.currentSlide};!st.lazyLoad||st.lazyLoad&&st.lazyLoadedList.indexOf(Bt)>=0?Gt=Nt:Gt=_react$3.default.createElement("div",null);var Mr=getSlideStyle(_objectSpread$3(_objectSpread$3({},st),{},{index:Bt})),Tr=Gt.props.className||"",zr=getSlideClasses(_objectSpread$3(_objectSpread$3({},st),{},{index:Bt}));if(gt.push(_react$3.default.cloneElement(Gt,{key:"original"+getKey(Gt,Bt),"data-index":Bt,className:(0,_classnames$3.default)(zr,Tr),tabIndex:"-1","aria-hidden":!zr["slick-active"],style:_objectSpread$3(_objectSpread$3({outline:"none"},Gt.props.style||{}),Mr),onClick:function(tn){Gt.props&&Gt.props.onClick&&Gt.props.onClick(tn),st.focusOnSelect&&st.focusOnSelect(dr)}})),st.infinite&&st.fade===!1){var Fr=At-Bt;Fr<=(0,_innerSliderUtils$3.getPreClones)(st)&&(mt=-Fr,mt>=Rt&&(Gt=Nt),zr=getSlideClasses(_objectSpread$3(_objectSpread$3({},st),{},{index:mt})),_t.push(_react$3.default.cloneElement(Gt,{key:"precloned"+getKey(Gt,mt),"data-index":mt,tabIndex:"-1",className:(0,_classnames$3.default)(zr,Tr),"aria-hidden":!zr["slick-active"],style:_objectSpread$3(_objectSpread$3({},Gt.props.style||{}),Mr),onClick:function(tn){Gt.props&&Gt.props.onClick&&Gt.props.onClick(tn),st.focusOnSelect&&st.focusOnSelect(dr)}}))),mt=At+Bt,mt<Ft&&(Gt=Nt),zr=getSlideClasses(_objectSpread$3(_objectSpread$3({},st),{},{index:mt})),Et.push(_react$3.default.cloneElement(Gt,{key:"postcloned"+getKey(Gt,mt),"data-index":mt,tabIndex:"-1",className:(0,_classnames$3.default)(zr,Tr),"aria-hidden":!zr["slick-active"],style:_objectSpread$3(_objectSpread$3({},Gt.props.style||{}),Mr),onClick:function(tn){Gt.props&&Gt.props.onClick&&Gt.props.onClick(tn),st.focusOnSelect&&st.focusOnSelect(dr)}}))}}),st.rtl?_t.concat(gt,Et).reverse():_t.concat(gt,Et)};track.Track=function(nt){_inherits$3(mt,nt);var st=_createSuper$3(mt);function mt(){var gt;_classCallCheck$3(this,mt);for(var _t=arguments.length,Et=new Array(_t),At=0;At<_t;At++)Et[At]=arguments[At];return gt=st.call.apply(st,[this].concat(Et)),_defineProperty$3(_assertThisInitialized$3(gt),"node",null),_defineProperty$3(_assertThisInitialized$3(gt),"handleRef",function(Rt){gt.node=Rt}),gt}return _createClass$3(mt,[{key:"render",value:function(){var _t=renderSlides(this.props),Et=this.props,At=Et.onMouseEnter,Rt=Et.onMouseOver,Ft=Et.onMouseLeave,Nt={onMouseEnter:At,onMouseOver:Rt,onMouseLeave:Ft};return _react$3.default.createElement("div",_extends$2({ref:this.handleRef,className:"slick-track",style:this.props.trackStyle},Nt),_t)}}]),mt}(_react$3.default.PureComponent);var dots={};function _typeof$2(nt){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(st){return typeof st}:function(st){return st&&typeof Symbol=="function"&&st.constructor===Symbol&&st!==Symbol.prototype?"symbol":typeof st},_typeof$2(nt)}Object.defineProperty(dots,"__esModule",{value:!0});dots.Dots=void 0;var _react$2=_interopRequireDefault$2(reactExports),_classnames$2=_interopRequireDefault$2(classnamesExports),_innerSliderUtils$2=innerSliderUtils;function _interopRequireDefault$2(nt){return nt&&nt.__esModule?nt:{default:nt}}function ownKeys$2(nt,st){var mt=Object.keys(nt);if(Object.getOwnPropertySymbols){var gt=Object.getOwnPropertySymbols(nt);st&&(gt=gt.filter(function(_t){return Object.getOwnPropertyDescriptor(nt,_t).enumerable})),mt.push.apply(mt,gt)}return mt}function _objectSpread$2(nt){for(var st=1;st<arguments.length;st++){var mt=arguments[st]!=null?arguments[st]:{};st%2?ownKeys$2(Object(mt),!0).forEach(function(gt){_defineProperty$2(nt,gt,mt[gt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(mt)):ownKeys$2(Object(mt)).forEach(function(gt){Object.defineProperty(nt,gt,Object.getOwnPropertyDescriptor(mt,gt))})}return nt}function _defineProperty$2(nt,st,mt){return st=_toPropertyKey$2(st),st in nt?Object.defineProperty(nt,st,{value:mt,enumerable:!0,configurable:!0,writable:!0}):nt[st]=mt,nt}function _classCallCheck$2(nt,st){if(!(nt instanceof st))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2(nt,st){for(var mt=0;mt<st.length;mt++){var gt=st[mt];gt.enumerable=gt.enumerable||!1,gt.configurable=!0,"value"in gt&&(gt.writable=!0),Object.defineProperty(nt,_toPropertyKey$2(gt.key),gt)}}function _createClass$2(nt,st,mt){return st&&_defineProperties$2(nt.prototype,st),Object.defineProperty(nt,"prototype",{writable:!1}),nt}function _toPropertyKey$2(nt){var st=_toPrimitive$2(nt,"string");return _typeof$2(st)=="symbol"?st:String(st)}function _toPrimitive$2(nt,st){if(_typeof$2(nt)!="object"||!nt)return nt;var mt=nt[Symbol.toPrimitive];if(mt!==void 0){var gt=mt.call(nt,st||"default");if(_typeof$2(gt)!="object")return gt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(st==="string"?String:Number)(nt)}function _inherits$2(nt,st){if(typeof st!="function"&&st!==null)throw new TypeError("Super expression must either be null or a function");nt.prototype=Object.create(st&&st.prototype,{constructor:{value:nt,writable:!0,configurable:!0}}),Object.defineProperty(nt,"prototype",{writable:!1}),st&&_setPrototypeOf$2(nt,st)}function _setPrototypeOf$2(nt,st){return _setPrototypeOf$2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(gt,_t){return gt.__proto__=_t,gt},_setPrototypeOf$2(nt,st)}function _createSuper$2(nt){var st=_isNativeReflectConstruct$2();return function(){var gt=_getPrototypeOf$2(nt),_t;if(st){var Et=_getPrototypeOf$2(this).constructor;_t=Reflect.construct(gt,arguments,Et)}else _t=gt.apply(this,arguments);return _possibleConstructorReturn$2(this,_t)}}function _possibleConstructorReturn$2(nt,st){if(st&&(_typeof$2(st)==="object"||typeof st=="function"))return st;if(st!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$2(nt)}function _assertThisInitialized$2(nt){if(nt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return nt}function _isNativeReflectConstruct$2(){try{var nt=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$2=function(){return!!nt})()}function _getPrototypeOf$2(nt){return _getPrototypeOf$2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(mt){return mt.__proto__||Object.getPrototypeOf(mt)},_getPrototypeOf$2(nt)}var getDotCount=function(st){var mt;return st.infinite?mt=Math.ceil(st.slideCount/st.slidesToScroll):mt=Math.ceil((st.slideCount-st.slidesToShow)/st.slidesToScroll)+1,mt};dots.Dots=function(nt){_inherits$2(mt,nt);var st=_createSuper$2(mt);function mt(){return _classCallCheck$2(this,mt),st.apply(this,arguments)}return _createClass$2(mt,[{key:"clickHandler",value:function(_t,Et){Et.preventDefault(),this.props.clickHandler(_t)}},{key:"render",value:function(){for(var _t=this.props,Et=_t.onMouseEnter,At=_t.onMouseOver,Rt=_t.onMouseLeave,Ft=_t.infinite,Nt=_t.slidesToScroll,Bt=_t.slidesToShow,Gt=_t.slideCount,dr=_t.currentSlide,Mr=getDotCount({slideCount:Gt,slidesToScroll:Nt,slidesToShow:Bt,infinite:Ft}),Tr={onMouseEnter:Et,onMouseOver:At,onMouseLeave:Rt},zr=[],Fr=0;Fr<Mr;Fr++){var Nr=(Fr+1)*Nt-1,tn=Ft?Nr:(0,_innerSliderUtils$2.clamp)(Nr,0,Gt-1),rn=tn-(Nt-1),Tn=Ft?rn:(0,_innerSliderUtils$2.clamp)(rn,0,Gt-1),$n=(0,_classnames$2.default)({"slick-active":Ft?dr>=Tn&&dr<=tn:dr===Tn}),un={message:"dots",index:Fr,slidesToScroll:Nt,currentSlide:dr},es=this.clickHandler.bind(this,un);zr=zr.concat(_react$2.default.createElement("li",{key:Fr,className:$n},_react$2.default.cloneElement(this.props.customPaging(Fr),{onClick:es})))}return _react$2.default.cloneElement(this.props.appendDots(zr),_objectSpread$2({className:this.props.dotsClass},Tr))}}]),mt}(_react$2.default.PureComponent);var arrows={};function _typeof$1(nt){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(st){return typeof st}:function(st){return st&&typeof Symbol=="function"&&st.constructor===Symbol&&st!==Symbol.prototype?"symbol":typeof st},_typeof$1(nt)}Object.defineProperty(arrows,"__esModule",{value:!0});arrows.PrevArrow=arrows.NextArrow=void 0;var _react$1=_interopRequireDefault$1(reactExports),_classnames$1=_interopRequireDefault$1(classnamesExports),_innerSliderUtils$1=innerSliderUtils;function _interopRequireDefault$1(nt){return nt&&nt.__esModule?nt:{default:nt}}function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(nt){for(var st=1;st<arguments.length;st++){var mt=arguments[st];for(var gt in mt)Object.prototype.hasOwnProperty.call(mt,gt)&&(nt[gt]=mt[gt])}return nt},_extends$1.apply(this,arguments)}function ownKeys$1(nt,st){var mt=Object.keys(nt);if(Object.getOwnPropertySymbols){var gt=Object.getOwnPropertySymbols(nt);st&&(gt=gt.filter(function(_t){return Object.getOwnPropertyDescriptor(nt,_t).enumerable})),mt.push.apply(mt,gt)}return mt}function _objectSpread$1(nt){for(var st=1;st<arguments.length;st++){var mt=arguments[st]!=null?arguments[st]:{};st%2?ownKeys$1(Object(mt),!0).forEach(function(gt){_defineProperty$1(nt,gt,mt[gt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(mt)):ownKeys$1(Object(mt)).forEach(function(gt){Object.defineProperty(nt,gt,Object.getOwnPropertyDescriptor(mt,gt))})}return nt}function _defineProperty$1(nt,st,mt){return st=_toPropertyKey$1(st),st in nt?Object.defineProperty(nt,st,{value:mt,enumerable:!0,configurable:!0,writable:!0}):nt[st]=mt,nt}function _classCallCheck$1(nt,st){if(!(nt instanceof st))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(nt,st){for(var mt=0;mt<st.length;mt++){var gt=st[mt];gt.enumerable=gt.enumerable||!1,gt.configurable=!0,"value"in gt&&(gt.writable=!0),Object.defineProperty(nt,_toPropertyKey$1(gt.key),gt)}}function _createClass$1(nt,st,mt){return st&&_defineProperties$1(nt.prototype,st),Object.defineProperty(nt,"prototype",{writable:!1}),nt}function _toPropertyKey$1(nt){var st=_toPrimitive$1(nt,"string");return _typeof$1(st)=="symbol"?st:String(st)}function _toPrimitive$1(nt,st){if(_typeof$1(nt)!="object"||!nt)return nt;var mt=nt[Symbol.toPrimitive];if(mt!==void 0){var gt=mt.call(nt,st||"default");if(_typeof$1(gt)!="object")return gt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(st==="string"?String:Number)(nt)}function _inherits$1(nt,st){if(typeof st!="function"&&st!==null)throw new TypeError("Super expression must either be null or a function");nt.prototype=Object.create(st&&st.prototype,{constructor:{value:nt,writable:!0,configurable:!0}}),Object.defineProperty(nt,"prototype",{writable:!1}),st&&_setPrototypeOf$1(nt,st)}function _setPrototypeOf$1(nt,st){return _setPrototypeOf$1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(gt,_t){return gt.__proto__=_t,gt},_setPrototypeOf$1(nt,st)}function _createSuper$1(nt){var st=_isNativeReflectConstruct$1();return function(){var gt=_getPrototypeOf$1(nt),_t;if(st){var Et=_getPrototypeOf$1(this).constructor;_t=Reflect.construct(gt,arguments,Et)}else _t=gt.apply(this,arguments);return _possibleConstructorReturn$1(this,_t)}}function _possibleConstructorReturn$1(nt,st){if(st&&(_typeof$1(st)==="object"||typeof st=="function"))return st;if(st!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1(nt)}function _assertThisInitialized$1(nt){if(nt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return nt}function _isNativeReflectConstruct$1(){try{var nt=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$1=function(){return!!nt})()}function _getPrototypeOf$1(nt){return _getPrototypeOf$1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(mt){return mt.__proto__||Object.getPrototypeOf(mt)},_getPrototypeOf$1(nt)}arrows.PrevArrow=function(nt){_inherits$1(mt,nt);var st=_createSuper$1(mt);function mt(){return _classCallCheck$1(this,mt),st.apply(this,arguments)}return _createClass$1(mt,[{key:"clickHandler",value:function(_t,Et){Et&&Et.preventDefault(),this.props.clickHandler(_t,Et)}},{key:"render",value:function(){var _t={"slick-arrow":!0,"slick-prev":!0},Et=this.clickHandler.bind(this,{message:"previous"});!this.props.infinite&&(this.props.currentSlide===0||this.props.slideCount<=this.props.slidesToShow)&&(_t["slick-disabled"]=!0,Et=null);var At={key:"0","data-role":"none",className:(0,_classnames$1.default)(_t),style:{display:"block"},onClick:Et},Rt={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},Ft;return this.props.prevArrow?Ft=_react$1.default.cloneElement(this.props.prevArrow,_objectSpread$1(_objectSpread$1({},At),Rt)):Ft=_react$1.default.createElement("button",_extends$1({key:"0",type:"button"},At)," ","Previous"),Ft}}]),mt}(_react$1.default.PureComponent);arrows.NextArrow=function(nt){_inherits$1(mt,nt);var st=_createSuper$1(mt);function mt(){return _classCallCheck$1(this,mt),st.apply(this,arguments)}return _createClass$1(mt,[{key:"clickHandler",value:function(_t,Et){Et&&Et.preventDefault(),this.props.clickHandler(_t,Et)}},{key:"render",value:function(){var _t={"slick-arrow":!0,"slick-next":!0},Et=this.clickHandler.bind(this,{message:"next"});(0,_innerSliderUtils$1.canGoNext)(this.props)||(_t["slick-disabled"]=!0,Et=null);var At={key:"1","data-role":"none",className:(0,_classnames$1.default)(_t),style:{display:"block"},onClick:Et},Rt={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},Ft;return this.props.nextArrow?Ft=_react$1.default.cloneElement(this.props.nextArrow,_objectSpread$1(_objectSpread$1({},At),Rt)):Ft=_react$1.default.createElement("button",_extends$1({key:"1",type:"button"},At)," ","Next"),Ft}}]),mt}(_react$1.default.PureComponent);var MapShim=function(){if(typeof Map<"u")return Map;function nt(st,mt){var gt=-1;return st.some(function(_t,Et){return _t[0]===mt?(gt=Et,!0):!1}),gt}return function(){function st(){this.__entries__=[]}return Object.defineProperty(st.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),st.prototype.get=function(mt){var gt=nt(this.__entries__,mt),_t=this.__entries__[gt];return _t&&_t[1]},st.prototype.set=function(mt,gt){var _t=nt(this.__entries__,mt);~_t?this.__entries__[_t][1]=gt:this.__entries__.push([mt,gt])},st.prototype.delete=function(mt){var gt=this.__entries__,_t=nt(gt,mt);~_t&&gt.splice(_t,1)},st.prototype.has=function(mt){return!!~nt(this.__entries__,mt)},st.prototype.clear=function(){this.__entries__.splice(0)},st.prototype.forEach=function(mt,gt){gt===void 0&&(gt=null);for(var _t=0,Et=this.__entries__;_t<Et.length;_t++){var At=Et[_t];mt.call(gt,At[1],At[0])}},st}()}(),isBrowser=typeof window<"u"&&typeof document<"u"&&window.document===document,global$1=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),requestAnimationFrame$1=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(global$1):function(nt){return setTimeout(function(){return nt(Date.now())},1e3/60)}}(),trailingTimeout=2;function throttle(nt,st){var mt=!1,gt=!1,_t=0;function Et(){mt&&(mt=!1,nt()),gt&&Rt()}function At(){requestAnimationFrame$1(Et)}function Rt(){var Ft=Date.now();if(mt){if(Ft-_t<trailingTimeout)return;gt=!0}else mt=!0,gt=!1,setTimeout(At,st);_t=Ft}return Rt}var REFRESH_DELAY=20,transitionKeys=["top","right","bottom","left","width","height","size","weight"],mutationObserverSupported=typeof MutationObserver<"u",ResizeObserverController=function(){function nt(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=throttle(this.refresh.bind(this),REFRESH_DELAY)}return nt.prototype.addObserver=function(st){~this.observers_.indexOf(st)||this.observers_.push(st),this.connected_||this.connect_()},nt.prototype.removeObserver=function(st){var mt=this.observers_,gt=mt.indexOf(st);~gt&&mt.splice(gt,1),!mt.length&&this.connected_&&this.disconnect_()},nt.prototype.refresh=function(){var st=this.updateObservers_();st&&this.refresh()},nt.prototype.updateObservers_=function(){var st=this.observers_.filter(function(mt){return mt.gatherActive(),mt.hasActive()});return st.forEach(function(mt){return mt.broadcastActive()}),st.length>0},nt.prototype.connect_=function(){!isBrowser||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),mutationObserverSupported?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},nt.prototype.disconnect_=function(){!isBrowser||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},nt.prototype.onTransitionEnd_=function(st){var mt=st.propertyName,gt=mt===void 0?"":mt,_t=transitionKeys.some(function(Et){return!!~gt.indexOf(Et)});_t&&this.refresh()},nt.getInstance=function(){return this.instance_||(this.instance_=new nt),this.instance_},nt.instance_=null,nt}(),defineConfigurable=function(nt,st){for(var mt=0,gt=Object.keys(st);mt<gt.length;mt++){var _t=gt[mt];Object.defineProperty(nt,_t,{value:st[_t],enumerable:!1,writable:!1,configurable:!0})}return nt},getWindowOf=function(nt){var st=nt&&nt.ownerDocument&&nt.ownerDocument.defaultView;return st||global$1},emptyRect=createRectInit(0,0,0,0);function toFloat(nt){return parseFloat(nt)||0}function getBordersSize(nt){for(var st=[],mt=1;mt<arguments.length;mt++)st[mt-1]=arguments[mt];return st.reduce(function(gt,_t){var Et=nt["border-"+_t+"-width"];return gt+toFloat(Et)},0)}function getPaddings(nt){for(var st=["top","right","bottom","left"],mt={},gt=0,_t=st;gt<_t.length;gt++){var Et=_t[gt],At=nt["padding-"+Et];mt[Et]=toFloat(At)}return mt}function getSVGContentRect(nt){var st=nt.getBBox();return createRectInit(0,0,st.width,st.height)}function getHTMLElementContentRect(nt){var st=nt.clientWidth,mt=nt.clientHeight;if(!st&&!mt)return emptyRect;var gt=getWindowOf(nt).getComputedStyle(nt),_t=getPaddings(gt),Et=_t.left+_t.right,At=_t.top+_t.bottom,Rt=toFloat(gt.width),Ft=toFloat(gt.height);if(gt.boxSizing==="border-box"&&(Math.round(Rt+Et)!==st&&(Rt-=getBordersSize(gt,"left","right")+Et),Math.round(Ft+At)!==mt&&(Ft-=getBordersSize(gt,"top","bottom")+At)),!isDocumentElement(nt)){var Nt=Math.round(Rt+Et)-st,Bt=Math.round(Ft+At)-mt;Math.abs(Nt)!==1&&(Rt-=Nt),Math.abs(Bt)!==1&&(Ft-=Bt)}return createRectInit(_t.left,_t.top,Rt,Ft)}var isSVGGraphicsElement=function(){return typeof SVGGraphicsElement<"u"?function(nt){return nt instanceof getWindowOf(nt).SVGGraphicsElement}:function(nt){return nt instanceof getWindowOf(nt).SVGElement&&typeof nt.getBBox=="function"}}();function isDocumentElement(nt){return nt===getWindowOf(nt).document.documentElement}function getContentRect(nt){return isBrowser?isSVGGraphicsElement(nt)?getSVGContentRect(nt):getHTMLElementContentRect(nt):emptyRect}function createReadOnlyRect(nt){var st=nt.x,mt=nt.y,gt=nt.width,_t=nt.height,Et=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,At=Object.create(Et.prototype);return defineConfigurable(At,{x:st,y:mt,width:gt,height:_t,top:mt,right:st+gt,bottom:_t+mt,left:st}),At}function createRectInit(nt,st,mt,gt){return{x:nt,y:st,width:mt,height:gt}}var ResizeObservation=function(){function nt(st){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=createRectInit(0,0,0,0),this.target=st}return nt.prototype.isActive=function(){var st=getContentRect(this.target);return this.contentRect_=st,st.width!==this.broadcastWidth||st.height!==this.broadcastHeight},nt.prototype.broadcastRect=function(){var st=this.contentRect_;return this.broadcastWidth=st.width,this.broadcastHeight=st.height,st},nt}(),ResizeObserverEntry=function(){function nt(st,mt){var gt=createReadOnlyRect(mt);defineConfigurable(this,{target:st,contentRect:gt})}return nt}(),ResizeObserverSPI=function(){function nt(st,mt,gt){if(this.activeObservations_=[],this.observations_=new MapShim,typeof st!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=st,this.controller_=mt,this.callbackCtx_=gt}return nt.prototype.observe=function(st){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(st instanceof getWindowOf(st).Element))throw new TypeError('parameter 1 is not of type "Element".');var mt=this.observations_;mt.has(st)||(mt.set(st,new ResizeObservation(st)),this.controller_.addObserver(this),this.controller_.refresh())}},nt.prototype.unobserve=function(st){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(st instanceof getWindowOf(st).Element))throw new TypeError('parameter 1 is not of type "Element".');var mt=this.observations_;mt.has(st)&&(mt.delete(st),mt.size||this.controller_.removeObserver(this))}},nt.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},nt.prototype.gatherActive=function(){var st=this;this.clearActive(),this.observations_.forEach(function(mt){mt.isActive()&&st.activeObservations_.push(mt)})},nt.prototype.broadcastActive=function(){if(this.hasActive()){var st=this.callbackCtx_,mt=this.activeObservations_.map(function(gt){return new ResizeObserverEntry(gt.target,gt.broadcastRect())});this.callback_.call(st,mt,st),this.clearActive()}},nt.prototype.clearActive=function(){this.activeObservations_.splice(0)},nt.prototype.hasActive=function(){return this.activeObservations_.length>0},nt}(),observers=typeof WeakMap<"u"?new WeakMap:new MapShim,ResizeObserver$1=function(){function nt(st){if(!(this instanceof nt))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var mt=ResizeObserverController.getInstance(),gt=new ResizeObserverSPI(st,mt,this);observers.set(this,gt)}return nt}();["observe","unobserve","disconnect"].forEach(function(nt){ResizeObserver$1.prototype[nt]=function(){var st;return(st=observers.get(this))[nt].apply(st,arguments)}});var index=function(){return typeof global$1.ResizeObserver<"u"?global$1.ResizeObserver:ResizeObserver$1}();const ResizeObserver_es=Object.freeze(Object.defineProperty({__proto__:null,default:index},Symbol.toStringTag,{value:"Module"})),require$$8=getAugmentedNamespace(ResizeObserver_es);Object.defineProperty(innerSlider,"__esModule",{value:!0});innerSlider.InnerSlider=void 0;var _react=_interopRequireDefault(reactExports),_initialState=_interopRequireDefault(initialState),_lodash=_interopRequireDefault(lodash_debounce),_classnames=_interopRequireDefault(classnamesExports),_innerSliderUtils=innerSliderUtils,_track=track,_dots=dots,_arrows=arrows,_resizeObserverPolyfill=_interopRequireDefault(require$$8);function _interopRequireDefault(nt){return nt&&nt.__esModule?nt:{default:nt}}function _typeof(nt){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(st){return typeof st}:function(st){return st&&typeof Symbol=="function"&&st.constructor===Symbol&&st!==Symbol.prototype?"symbol":typeof st},_typeof(nt)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(nt){for(var st=1;st<arguments.length;st++){var mt=arguments[st];for(var gt in mt)Object.prototype.hasOwnProperty.call(mt,gt)&&(nt[gt]=mt[gt])}return nt},_extends.apply(this,arguments)}function _objectWithoutProperties(nt,st){if(nt==null)return{};var mt=_objectWithoutPropertiesLoose(nt,st),gt,_t;if(Object.getOwnPropertySymbols){var Et=Object.getOwnPropertySymbols(nt);for(_t=0;_t<Et.length;_t++)gt=Et[_t],!(st.indexOf(gt)>=0)&&Object.prototype.propertyIsEnumerable.call(nt,gt)&&(mt[gt]=nt[gt])}return mt}function _objectWithoutPropertiesLoose(nt,st){if(nt==null)return{};var mt={},gt=Object.keys(nt),_t,Et;for(Et=0;Et<gt.length;Et++)_t=gt[Et],!(st.indexOf(_t)>=0)&&(mt[_t]=nt[_t]);return mt}function ownKeys(nt,st){var mt=Object.keys(nt);if(Object.getOwnPropertySymbols){var gt=Object.getOwnPropertySymbols(nt);st&&(gt=gt.filter(function(_t){return Object.getOwnPropertyDescriptor(nt,_t).enumerable})),mt.push.apply(mt,gt)}return mt}function _objectSpread(nt){for(var st=1;st<arguments.length;st++){var mt=arguments[st]!=null?arguments[st]:{};st%2?ownKeys(Object(mt),!0).forEach(function(gt){_defineProperty(nt,gt,mt[gt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(mt)):ownKeys(Object(mt)).forEach(function(gt){Object.defineProperty(nt,gt,Object.getOwnPropertyDescriptor(mt,gt))})}return nt}function _classCallCheck(nt,st){if(!(nt instanceof st))throw new TypeError("Cannot call a class as a function")}function _defineProperties(nt,st){for(var mt=0;mt<st.length;mt++){var gt=st[mt];gt.enumerable=gt.enumerable||!1,gt.configurable=!0,"value"in gt&&(gt.writable=!0),Object.defineProperty(nt,_toPropertyKey(gt.key),gt)}}function _createClass(nt,st,mt){return st&&_defineProperties(nt.prototype,st),Object.defineProperty(nt,"prototype",{writable:!1}),nt}function _inherits(nt,st){if(typeof st!="function"&&st!==null)throw new TypeError("Super expression must either be null or a function");nt.prototype=Object.create(st&&st.prototype,{constructor:{value:nt,writable:!0,configurable:!0}}),Object.defineProperty(nt,"prototype",{writable:!1}),st&&_setPrototypeOf(nt,st)}function _setPrototypeOf(nt,st){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(gt,_t){return gt.__proto__=_t,gt},_setPrototypeOf(nt,st)}function _createSuper(nt){var st=_isNativeReflectConstruct();return function(){var gt=_getPrototypeOf(nt),_t;if(st){var Et=_getPrototypeOf(this).constructor;_t=Reflect.construct(gt,arguments,Et)}else _t=gt.apply(this,arguments);return _possibleConstructorReturn(this,_t)}}function _possibleConstructorReturn(nt,st){if(st&&(_typeof(st)==="object"||typeof st=="function"))return st;if(st!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(nt)}function _assertThisInitialized(nt){if(nt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return nt}function _isNativeReflectConstruct(){try{var nt=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct=function(){return!!nt})()}function _getPrototypeOf(nt){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(mt){return mt.__proto__||Object.getPrototypeOf(mt)},_getPrototypeOf(nt)}function _defineProperty(nt,st,mt){return st=_toPropertyKey(st),st in nt?Object.defineProperty(nt,st,{value:mt,enumerable:!0,configurable:!0,writable:!0}):nt[st]=mt,nt}function _toPropertyKey(nt){var st=_toPrimitive(nt,"string");return _typeof(st)=="symbol"?st:String(st)}function _toPrimitive(nt,st){if(_typeof(nt)!="object"||!nt)return nt;var mt=nt[Symbol.toPrimitive];if(mt!==void 0){var gt=mt.call(nt,st||"default");if(_typeof(gt)!="object")return gt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(st==="string"?String:Number)(nt)}innerSlider.InnerSlider=function(nt){_inherits(mt,nt);var st=_createSuper(mt);function mt(gt){var _t;_classCallCheck(this,mt),_t=st.call(this,gt),_defineProperty(_assertThisInitialized(_t),"listRefHandler",function(At){return _t.list=At}),_defineProperty(_assertThisInitialized(_t),"trackRefHandler",function(At){return _t.track=At}),_defineProperty(_assertThisInitialized(_t),"adaptHeight",function(){if(_t.props.adaptiveHeight&&_t.list){var At=_t.list.querySelector('[data-index="'.concat(_t.state.currentSlide,'"]'));_t.list.style.height=(0,_innerSliderUtils.getHeight)(At)+"px"}}),_defineProperty(_assertThisInitialized(_t),"componentDidMount",function(){if(_t.props.onInit&&_t.props.onInit(),_t.props.lazyLoad){var At=(0,_innerSliderUtils.getOnDemandLazySlides)(_objectSpread(_objectSpread({},_t.props),_t.state));At.length>0&&(_t.setState(function(Ft){return{lazyLoadedList:Ft.lazyLoadedList.concat(At)}}),_t.props.onLazyLoad&&_t.props.onLazyLoad(At))}var Rt=_objectSpread({listRef:_t.list,trackRef:_t.track},_t.props);_t.updateState(Rt,!0,function(){_t.adaptHeight(),_t.props.autoplay&&_t.autoPlay("update")}),_t.props.lazyLoad==="progressive"&&(_t.lazyLoadTimer=setInterval(_t.progressiveLazyLoad,1e3)),_t.ro=new _resizeObserverPolyfill.default(function(){_t.state.animating?(_t.onWindowResized(!1),_t.callbackTimers.push(setTimeout(function(){return _t.onWindowResized()},_t.props.speed))):_t.onWindowResized()}),_t.ro.observe(_t.list),document.querySelectorAll&&Array.prototype.forEach.call(document.querySelectorAll(".slick-slide"),function(Ft){Ft.onfocus=_t.props.pauseOnFocus?_t.onSlideFocus:null,Ft.onblur=_t.props.pauseOnFocus?_t.onSlideBlur:null}),window.addEventListener?window.addEventListener("resize",_t.onWindowResized):window.attachEvent("onresize",_t.onWindowResized)}),_defineProperty(_assertThisInitialized(_t),"componentWillUnmount",function(){_t.animationEndCallback&&clearTimeout(_t.animationEndCallback),_t.lazyLoadTimer&&clearInterval(_t.lazyLoadTimer),_t.callbackTimers.length&&(_t.callbackTimers.forEach(function(At){return clearTimeout(At)}),_t.callbackTimers=[]),window.addEventListener?window.removeEventListener("resize",_t.onWindowResized):window.detachEvent("onresize",_t.onWindowResized),_t.autoplayTimer&&clearInterval(_t.autoplayTimer),_t.ro.disconnect()}),_defineProperty(_assertThisInitialized(_t),"componentDidUpdate",function(At){if(_t.checkImagesLoad(),_t.props.onReInit&&_t.props.onReInit(),_t.props.lazyLoad){var Rt=(0,_innerSliderUtils.getOnDemandLazySlides)(_objectSpread(_objectSpread({},_t.props),_t.state));Rt.length>0&&(_t.setState(function(Bt){return{lazyLoadedList:Bt.lazyLoadedList.concat(Rt)}}),_t.props.onLazyLoad&&_t.props.onLazyLoad(Rt))}_t.adaptHeight();var Ft=_objectSpread(_objectSpread({listRef:_t.list,trackRef:_t.track},_t.props),_t.state),Nt=_t.didPropsChange(At);Nt&&_t.updateState(Ft,Nt,function(){_t.state.currentSlide>=_react.default.Children.count(_t.props.children)&&_t.changeSlide({message:"index",index:_react.default.Children.count(_t.props.children)-_t.props.slidesToShow,currentSlide:_t.state.currentSlide}),_t.props.autoplay?_t.autoPlay("update"):_t.pause("paused")})}),_defineProperty(_assertThisInitialized(_t),"onWindowResized",function(At){_t.debouncedResize&&_t.debouncedResize.cancel(),_t.debouncedResize=(0,_lodash.default)(function(){return _t.resizeWindow(At)},50),_t.debouncedResize()}),_defineProperty(_assertThisInitialized(_t),"resizeWindow",function(){var At=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,Rt=!!(_t.track&&_t.track.node);if(Rt){var Ft=_objectSpread(_objectSpread({listRef:_t.list,trackRef:_t.track},_t.props),_t.state);_t.updateState(Ft,At,function(){_t.props.autoplay?_t.autoPlay("update"):_t.pause("paused")}),_t.setState({animating:!1}),clearTimeout(_t.animationEndCallback),delete _t.animationEndCallback}}),_defineProperty(_assertThisInitialized(_t),"updateState",function(At,Rt,Ft){var Nt=(0,_innerSliderUtils.initializedState)(At);At=_objectSpread(_objectSpread(_objectSpread({},At),Nt),{},{slideIndex:Nt.currentSlide});var Bt=(0,_innerSliderUtils.getTrackLeft)(At);At=_objectSpread(_objectSpread({},At),{},{left:Bt});var Gt=(0,_innerSliderUtils.getTrackCSS)(At);(Rt||_react.default.Children.count(_t.props.children)!==_react.default.Children.count(At.children))&&(Nt.trackStyle=Gt),_t.setState(Nt,Ft)}),_defineProperty(_assertThisInitialized(_t),"ssrInit",function(){if(_t.props.variableWidth){var At=0,Rt=0,Ft=[],Nt=(0,_innerSliderUtils.getPreClones)(_objectSpread(_objectSpread(_objectSpread({},_t.props),_t.state),{},{slideCount:_t.props.children.length})),Bt=(0,_innerSliderUtils.getPostClones)(_objectSpread(_objectSpread(_objectSpread({},_t.props),_t.state),{},{slideCount:_t.props.children.length}));_t.props.children.forEach(function(es){Ft.push(es.props.style.width),At+=es.props.style.width});for(var Gt=0;Gt<Nt;Gt++)Rt+=Ft[Ft.length-1-Gt],At+=Ft[Ft.length-1-Gt];for(var dr=0;dr<Bt;dr++)At+=Ft[dr];for(var Mr=0;Mr<_t.state.currentSlide;Mr++)Rt+=Ft[Mr];var Tr={width:At+"px",left:-Rt+"px"};if(_t.props.centerMode){var zr="".concat(Ft[_t.state.currentSlide],"px");Tr.left="calc(".concat(Tr.left," + (100% - ").concat(zr,") / 2 ) ")}return{trackStyle:Tr}}var Fr=_react.default.Children.count(_t.props.children),Nr=_objectSpread(_objectSpread(_objectSpread({},_t.props),_t.state),{},{slideCount:Fr}),tn=(0,_innerSliderUtils.getPreClones)(Nr)+(0,_innerSliderUtils.getPostClones)(Nr)+Fr,rn=100/_t.props.slidesToShow*tn,Tn=100/tn,$n=-Tn*((0,_innerSliderUtils.getPreClones)(Nr)+_t.state.currentSlide)*rn/100;_t.props.centerMode&&($n+=(100-Tn*rn/100)/2);var un={width:rn+"%",left:$n+"%"};return{slideWidth:Tn+"%",trackStyle:un}}),_defineProperty(_assertThisInitialized(_t),"checkImagesLoad",function(){var At=_t.list&&_t.list.querySelectorAll&&_t.list.querySelectorAll(".slick-slide img")||[],Rt=At.length,Ft=0;Array.prototype.forEach.call(At,function(Nt){var Bt=function(){return++Ft&&Ft>=Rt&&_t.onWindowResized()};if(!Nt.onclick)Nt.onclick=function(){return Nt.parentNode.focus()};else{var Gt=Nt.onclick;Nt.onclick=function(dr){Gt(dr),Nt.parentNode.focus()}}Nt.onload||(_t.props.lazyLoad?Nt.onload=function(){_t.adaptHeight(),_t.callbackTimers.push(setTimeout(_t.onWindowResized,_t.props.speed))}:(Nt.onload=Bt,Nt.onerror=function(){Bt(),_t.props.onLazyLoadError&&_t.props.onLazyLoadError()}))})}),_defineProperty(_assertThisInitialized(_t),"progressiveLazyLoad",function(){for(var At=[],Rt=_objectSpread(_objectSpread({},_t.props),_t.state),Ft=_t.state.currentSlide;Ft<_t.state.slideCount+(0,_innerSliderUtils.getPostClones)(Rt);Ft++)if(_t.state.lazyLoadedList.indexOf(Ft)<0){At.push(Ft);break}for(var Nt=_t.state.currentSlide-1;Nt>=-(0,_innerSliderUtils.getPreClones)(Rt);Nt--)if(_t.state.lazyLoadedList.indexOf(Nt)<0){At.push(Nt);break}At.length>0?(_t.setState(function(Bt){return{lazyLoadedList:Bt.lazyLoadedList.concat(At)}}),_t.props.onLazyLoad&&_t.props.onLazyLoad(At)):_t.lazyLoadTimer&&(clearInterval(_t.lazyLoadTimer),delete _t.lazyLoadTimer)}),_defineProperty(_assertThisInitialized(_t),"slideHandler",function(At){var Rt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Ft=_t.props,Nt=Ft.asNavFor,Bt=Ft.beforeChange,Gt=Ft.onLazyLoad,dr=Ft.speed,Mr=Ft.afterChange,Tr=_t.state.currentSlide,zr=(0,_innerSliderUtils.slideHandler)(_objectSpread(_objectSpread(_objectSpread({index:At},_t.props),_t.state),{},{trackRef:_t.track,useCSS:_t.props.useCSS&&!Rt})),Fr=zr.state,Nr=zr.nextState;if(Fr){Bt&&Bt(Tr,Fr.currentSlide);var tn=Fr.lazyLoadedList.filter(function(rn){return _t.state.lazyLoadedList.indexOf(rn)<0});Gt&&tn.length>0&&Gt(tn),!_t.props.waitForAnimate&&_t.animationEndCallback&&(clearTimeout(_t.animationEndCallback),Mr&&Mr(Tr),delete _t.animationEndCallback),_t.setState(Fr,function(){Nt&&_t.asNavForIndex!==At&&(_t.asNavForIndex=At,Nt.innerSlider.slideHandler(At)),Nr&&(_t.animationEndCallback=setTimeout(function(){var rn=Nr.animating,Tn=_objectWithoutProperties(Nr,["animating"]);_t.setState(Tn,function(){_t.callbackTimers.push(setTimeout(function(){return _t.setState({animating:rn})},10)),Mr&&Mr(Fr.currentSlide),delete _t.animationEndCallback})},dr))})}}),_defineProperty(_assertThisInitialized(_t),"changeSlide",function(At){var Rt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Ft=_objectSpread(_objectSpread({},_t.props),_t.state),Nt=(0,_innerSliderUtils.changeSlide)(Ft,At);if(!(Nt!==0&&!Nt)&&(Rt===!0?_t.slideHandler(Nt,Rt):_t.slideHandler(Nt),_t.props.autoplay&&_t.autoPlay("update"),_t.props.focusOnSelect)){var Bt=_t.list.querySelectorAll(".slick-current");Bt[0]&&Bt[0].focus()}}),_defineProperty(_assertThisInitialized(_t),"clickHandler",function(At){_t.clickable===!1&&(At.stopPropagation(),At.preventDefault()),_t.clickable=!0}),_defineProperty(_assertThisInitialized(_t),"keyHandler",function(At){var Rt=(0,_innerSliderUtils.keyHandler)(At,_t.props.accessibility,_t.props.rtl);Rt!==""&&_t.changeSlide({message:Rt})}),_defineProperty(_assertThisInitialized(_t),"selectHandler",function(At){_t.changeSlide(At)}),_defineProperty(_assertThisInitialized(_t),"disableBodyScroll",function(){var At=function(Ft){Ft=Ft||window.event,Ft.preventDefault&&Ft.preventDefault(),Ft.returnValue=!1};window.ontouchmove=At}),_defineProperty(_assertThisInitialized(_t),"enableBodyScroll",function(){window.ontouchmove=null}),_defineProperty(_assertThisInitialized(_t),"swipeStart",function(At){_t.props.verticalSwiping&&_t.disableBodyScroll();var Rt=(0,_innerSliderUtils.swipeStart)(At,_t.props.swipe,_t.props.draggable);Rt!==""&&_t.setState(Rt)}),_defineProperty(_assertThisInitialized(_t),"swipeMove",function(At){var Rt=(0,_innerSliderUtils.swipeMove)(At,_objectSpread(_objectSpread(_objectSpread({},_t.props),_t.state),{},{trackRef:_t.track,listRef:_t.list,slideIndex:_t.state.currentSlide}));Rt&&(Rt.swiping&&(_t.clickable=!1),_t.setState(Rt))}),_defineProperty(_assertThisInitialized(_t),"swipeEnd",function(At){var Rt=(0,_innerSliderUtils.swipeEnd)(At,_objectSpread(_objectSpread(_objectSpread({},_t.props),_t.state),{},{trackRef:_t.track,listRef:_t.list,slideIndex:_t.state.currentSlide}));if(Rt){var Ft=Rt.triggerSlideHandler;delete Rt.triggerSlideHandler,_t.setState(Rt),Ft!==void 0&&(_t.slideHandler(Ft),_t.props.verticalSwiping&&_t.enableBodyScroll())}}),_defineProperty(_assertThisInitialized(_t),"touchEnd",function(At){_t.swipeEnd(At),_t.clickable=!0}),_defineProperty(_assertThisInitialized(_t),"slickPrev",function(){_t.callbackTimers.push(setTimeout(function(){return _t.changeSlide({message:"previous"})},0))}),_defineProperty(_assertThisInitialized(_t),"slickNext",function(){_t.callbackTimers.push(setTimeout(function(){return _t.changeSlide({message:"next"})},0))}),_defineProperty(_assertThisInitialized(_t),"slickGoTo",function(At){var Rt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(At=Number(At),isNaN(At))return"";_t.callbackTimers.push(setTimeout(function(){return _t.changeSlide({message:"index",index:At,currentSlide:_t.state.currentSlide},Rt)},0))}),_defineProperty(_assertThisInitialized(_t),"play",function(){var At;if(_t.props.rtl)At=_t.state.currentSlide-_t.props.slidesToScroll;else if((0,_innerSliderUtils.canGoNext)(_objectSpread(_objectSpread({},_t.props),_t.state)))At=_t.state.currentSlide+_t.props.slidesToScroll;else return!1;_t.slideHandler(At)}),_defineProperty(_assertThisInitialized(_t),"autoPlay",function(At){_t.autoplayTimer&&clearInterval(_t.autoplayTimer);var Rt=_t.state.autoplaying;if(At==="update"){if(Rt==="hovered"||Rt==="focused"||Rt==="paused")return}else if(At==="leave"){if(Rt==="paused"||Rt==="focused")return}else if(At==="blur"&&(Rt==="paused"||Rt==="hovered"))return;_t.autoplayTimer=setInterval(_t.play,_t.props.autoplaySpeed+50),_t.setState({autoplaying:"playing"})}),_defineProperty(_assertThisInitialized(_t),"pause",function(At){_t.autoplayTimer&&(clearInterval(_t.autoplayTimer),_t.autoplayTimer=null);var Rt=_t.state.autoplaying;At==="paused"?_t.setState({autoplaying:"paused"}):At==="focused"?(Rt==="hovered"||Rt==="playing")&&_t.setState({autoplaying:"focused"}):Rt==="playing"&&_t.setState({autoplaying:"hovered"})}),_defineProperty(_assertThisInitialized(_t),"onDotsOver",function(){return _t.props.autoplay&&_t.pause("hovered")}),_defineProperty(_assertThisInitialized(_t),"onDotsLeave",function(){return _t.props.autoplay&&_t.state.autoplaying==="hovered"&&_t.autoPlay("leave")}),_defineProperty(_assertThisInitialized(_t),"onTrackOver",function(){return _t.props.autoplay&&_t.pause("hovered")}),_defineProperty(_assertThisInitialized(_t),"onTrackLeave",function(){return _t.props.autoplay&&_t.state.autoplaying==="hovered"&&_t.autoPlay("leave")}),_defineProperty(_assertThisInitialized(_t),"onSlideFocus",function(){return _t.props.autoplay&&_t.pause("focused")}),_defineProperty(_assertThisInitialized(_t),"onSlideBlur",function(){return _t.props.autoplay&&_t.state.autoplaying==="focused"&&_t.autoPlay("blur")}),_defineProperty(_assertThisInitialized(_t),"render",function(){var At=(0,_classnames.default)("slick-slider",_t.props.className,{"slick-vertical":_t.props.vertical,"slick-initialized":!0}),Rt=_objectSpread(_objectSpread({},_t.props),_t.state),Ft=(0,_innerSliderUtils.extractObject)(Rt,["fade","cssEase","speed","infinite","centerMode","focusOnSelect","currentSlide","lazyLoad","lazyLoadedList","rtl","slideWidth","slideHeight","listHeight","vertical","slidesToShow","slidesToScroll","slideCount","trackStyle","variableWidth","unslick","centerPadding","targetSlide","useCSS"]),Nt=_t.props.pauseOnHover;Ft=_objectSpread(_objectSpread({},Ft),{},{onMouseEnter:Nt?_t.onTrackOver:null,onMouseLeave:Nt?_t.onTrackLeave:null,onMouseOver:Nt?_t.onTrackOver:null,focusOnSelect:_t.props.focusOnSelect&&_t.clickable?_t.selectHandler:null});var Bt;if(_t.props.dots===!0&&_t.state.slideCount>=_t.props.slidesToShow){var Gt=(0,_innerSliderUtils.extractObject)(Rt,["dotsClass","slideCount","slidesToShow","currentSlide","slidesToScroll","clickHandler","children","customPaging","infinite","appendDots"]),dr=_t.props.pauseOnDotsHover;Gt=_objectSpread(_objectSpread({},Gt),{},{clickHandler:_t.changeSlide,onMouseEnter:dr?_t.onDotsLeave:null,onMouseOver:dr?_t.onDotsOver:null,onMouseLeave:dr?_t.onDotsLeave:null}),Bt=_react.default.createElement(_dots.Dots,Gt)}var Mr,Tr,zr=(0,_innerSliderUtils.extractObject)(Rt,["infinite","centerMode","currentSlide","slideCount","slidesToShow","prevArrow","nextArrow"]);zr.clickHandler=_t.changeSlide,_t.props.arrows&&(Mr=_react.default.createElement(_arrows.PrevArrow,zr),Tr=_react.default.createElement(_arrows.NextArrow,zr));var Fr=null;_t.props.vertical&&(Fr={height:_t.state.listHeight});var Nr=null;_t.props.vertical===!1?_t.props.centerMode===!0&&(Nr={padding:"0px "+_t.props.centerPadding}):_t.props.centerMode===!0&&(Nr={padding:_t.props.centerPadding+" 0px"});var tn=_objectSpread(_objectSpread({},Fr),Nr),rn=_t.props.touchMove,Tn={className:"slick-list",style:tn,onClick:_t.clickHandler,onMouseDown:rn?_t.swipeStart:null,onMouseMove:_t.state.dragging&&rn?_t.swipeMove:null,onMouseUp:rn?_t.swipeEnd:null,onMouseLeave:_t.state.dragging&&rn?_t.swipeEnd:null,onTouchStart:rn?_t.swipeStart:null,onTouchMove:_t.state.dragging&&rn?_t.swipeMove:null,onTouchEnd:rn?_t.touchEnd:null,onTouchCancel:_t.state.dragging&&rn?_t.swipeEnd:null,onKeyDown:_t.props.accessibility?_t.keyHandler:null},$n={className:At,dir:"ltr",style:_t.props.style};return _t.props.unslick&&(Tn={className:"slick-list"},$n={className:At}),_react.default.createElement("div",$n,_t.props.unslick?"":Mr,_react.default.createElement("div",_extends({ref:_t.listRefHandler},Tn),_react.default.createElement(_track.Track,_extends({ref:_t.trackRefHandler},Ft),_t.props.children)),_t.props.unslick?"":Tr,_t.props.unslick?"":Bt)}),_t.list=null,_t.track=null,_t.state=_objectSpread(_objectSpread({},_initialState.default),{},{currentSlide:_t.props.initialSlide,targetSlide:_t.props.initialSlide?_t.props.initialSlide:0,slideCount:_react.default.Children.count(_t.props.children)}),_t.callbackTimers=[],_t.clickable=!0,_t.debouncedResize=null;var Et=_t.ssrInit();return _t.state=_objectSpread(_objectSpread({},_t.state),Et),_t}return _createClass(mt,[{key:"didPropsChange",value:function(_t){for(var Et=!1,At=0,Rt=Object.keys(this.props);At<Rt.length;At++){var Ft=Rt[At];if(!_t.hasOwnProperty(Ft)){Et=!0;break}if(!(_typeof(_t[Ft])==="object"||typeof _t[Ft]=="function"||isNaN(_t[Ft]))&&_t[Ft]!==this.props[Ft]){Et=!0;break}}return Et||_react.default.Children.count(this.props.children)!==_react.default.Children.count(_t.children)}}]),mt}(_react.default.Component);var camel2hyphen$1=function(nt){return nt.replace(/[A-Z]/g,function(st){return"-"+st.toLowerCase()}).toLowerCase()},camel2hyphen_1=camel2hyphen$1,camel2hyphen=camel2hyphen_1,isDimension=function(nt){var st=/[height|width]$/;return st.test(nt)},obj2mq=function(nt){var st="",mt=Object.keys(nt);return mt.forEach(function(gt,_t){var Et=nt[gt];gt=camel2hyphen(gt),isDimension(gt)&&typeof Et=="number"&&(Et=Et+"px"),Et===!0?st+=gt:Et===!1?st+="not "+gt:st+="("+gt+": "+Et+")",_t<mt.length-1&&(st+=" and ")}),st},json2mq=function(nt){var st="";return typeof nt=="string"?nt:nt instanceof Array?(nt.forEach(function(mt,gt){st+=obj2mq(mt),gt<nt.length-1&&(st+=", ")}),st):obj2mq(nt)},json2mq_1=json2mq,QueryHandler_1,hasRequiredQueryHandler;function requireQueryHandler(){if(hasRequiredQueryHandler)return QueryHandler_1;hasRequiredQueryHandler=1;function nt(st){this.options=st,!st.deferSetup&&this.setup()}return nt.prototype={constructor:nt,setup:function(){this.options.setup&&this.options.setup(),this.initialised=!0},on:function(){!this.initialised&&this.setup(),this.options.match&&this.options.match()},off:function(){this.options.unmatch&&this.options.unmatch()},destroy:function(){this.options.destroy?this.options.destroy():this.off()},equals:function(st){return this.options===st||this.options.match===st}},QueryHandler_1=nt,QueryHandler_1}var Util,hasRequiredUtil;function requireUtil(){if(hasRequiredUtil)return Util;hasRequiredUtil=1;function nt(gt,_t){var Et=0,At=gt.length,Rt;for(Et;Et<At&&(Rt=_t(gt[Et],Et),Rt!==!1);Et++);}function st(gt){return Object.prototype.toString.apply(gt)==="[object Array]"}function mt(gt){return typeof gt=="function"}return Util={isFunction:mt,isArray:st,each:nt},Util}var MediaQuery_1,hasRequiredMediaQuery;function requireMediaQuery(){if(hasRequiredMediaQuery)return MediaQuery_1;hasRequiredMediaQuery=1;var nt=requireQueryHandler(),st=requireUtil().each;function mt(gt,_t){this.query=gt,this.isUnconditional=_t,this.handlers=[],this.mql=window.matchMedia(gt);var Et=this;this.listener=function(At){Et.mql=At.currentTarget||At,Et.assess()},this.mql.addListener(this.listener)}return mt.prototype={constuctor:mt,addHandler:function(gt){var _t=new nt(gt);this.handlers.push(_t),this.matches()&&_t.on()},removeHandler:function(gt){var _t=this.handlers;st(_t,function(Et,At){if(Et.equals(gt))return Et.destroy(),!_t.splice(At,1)})},matches:function(){return this.mql.matches||this.isUnconditional},clear:function(){st(this.handlers,function(gt){gt.destroy()}),this.mql.removeListener(this.listener),this.handlers.length=0},assess:function(){var gt=this.matches()?"on":"off";st(this.handlers,function(_t){_t[gt]()})}},MediaQuery_1=mt,MediaQuery_1}var MediaQueryDispatch_1,hasRequiredMediaQueryDispatch;function requireMediaQueryDispatch(){if(hasRequiredMediaQueryDispatch)return MediaQueryDispatch_1;hasRequiredMediaQueryDispatch=1;var nt=requireMediaQuery(),st=requireUtil(),mt=st.each,gt=st.isFunction,_t=st.isArray;function Et(){if(!window.matchMedia)throw new Error("matchMedia not present, legacy browsers require a polyfill");this.queries={},this.browserIsIncapable=!window.matchMedia("only all").matches}return Et.prototype={constructor:Et,register:function(At,Rt,Ft){var Nt=this.queries,Bt=Ft&&this.browserIsIncapable;return Nt[At]||(Nt[At]=new nt(At,Bt)),gt(Rt)&&(Rt={match:Rt}),_t(Rt)||(Rt=[Rt]),mt(Rt,function(Gt){gt(Gt)&&(Gt={match:Gt}),Nt[At].addHandler(Gt)}),this},unregister:function(At,Rt){var Ft=this.queries[At];return Ft&&(Rt?Ft.removeHandler(Rt):(Ft.clear(),delete this.queries[At])),this}},MediaQueryDispatch_1=Et,MediaQueryDispatch_1}var src,hasRequiredSrc;function requireSrc(){if(hasRequiredSrc)return src;hasRequiredSrc=1;var nt=requireMediaQueryDispatch();return src=new nt,src}(function(nt){Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=void 0;var st=At(reactExports),mt=innerSlider,gt=At(json2mq_1),_t=At(defaultProps),Et=innerSliderUtils;function At(ts){return ts&&ts.__esModule?ts:{default:ts}}function Rt(ts){"@babel/helpers - typeof";return Rt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ko){return typeof Ko}:function(Ko){return Ko&&typeof Symbol=="function"&&Ko.constructor===Symbol&&Ko!==Symbol.prototype?"symbol":typeof Ko},Rt(ts)}function Ft(){return Ft=Object.assign?Object.assign.bind():function(ts){for(var Ko=1;Ko<arguments.length;Ko++){var ds=arguments[Ko];for(var Il in ds)Object.prototype.hasOwnProperty.call(ds,Il)&&(ts[Il]=ds[Il])}return ts},Ft.apply(this,arguments)}function Nt(ts,Ko){var ds=Object.keys(ts);if(Object.getOwnPropertySymbols){var Il=Object.getOwnPropertySymbols(ts);Ko&&(Il=Il.filter(function(ru){return Object.getOwnPropertyDescriptor(ts,ru).enumerable})),ds.push.apply(ds,Il)}return ds}function Bt(ts){for(var Ko=1;Ko<arguments.length;Ko++){var ds=arguments[Ko]!=null?arguments[Ko]:{};Ko%2?Nt(Object(ds),!0).forEach(function(Il){$n(ts,Il,ds[Il])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ts,Object.getOwnPropertyDescriptors(ds)):Nt(Object(ds)).forEach(function(Il){Object.defineProperty(ts,Il,Object.getOwnPropertyDescriptor(ds,Il))})}return ts}function Gt(ts,Ko){if(!(ts instanceof Ko))throw new TypeError("Cannot call a class as a function")}function dr(ts,Ko){for(var ds=0;ds<Ko.length;ds++){var Il=Ko[ds];Il.enumerable=Il.enumerable||!1,Il.configurable=!0,"value"in Il&&(Il.writable=!0),Object.defineProperty(ts,un(Il.key),Il)}}function Mr(ts,Ko,ds){return Ko&&dr(ts.prototype,Ko),Object.defineProperty(ts,"prototype",{writable:!1}),ts}function Tr(ts,Ko){if(typeof Ko!="function"&&Ko!==null)throw new TypeError("Super expression must either be null or a function");ts.prototype=Object.create(Ko&&Ko.prototype,{constructor:{value:ts,writable:!0,configurable:!0}}),Object.defineProperty(ts,"prototype",{writable:!1}),Ko&&zr(ts,Ko)}function zr(ts,Ko){return zr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Il,ru){return Il.__proto__=ru,Il},zr(ts,Ko)}function Fr(ts){var Ko=rn();return function(){var Il=Tn(ts),ru;if(Ko){var uu=Tn(this).constructor;ru=Reflect.construct(Il,arguments,uu)}else ru=Il.apply(this,arguments);return Nr(this,ru)}}function Nr(ts,Ko){if(Ko&&(Rt(Ko)==="object"||typeof Ko=="function"))return Ko;if(Ko!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tn(ts)}function tn(ts){if(ts===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ts}function rn(){try{var ts=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rn=function(){return!!ts})()}function Tn(ts){return Tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ds){return ds.__proto__||Object.getPrototypeOf(ds)},Tn(ts)}function $n(ts,Ko,ds){return Ko=un(Ko),Ko in ts?Object.defineProperty(ts,Ko,{value:ds,enumerable:!0,configurable:!0,writable:!0}):ts[Ko]=ds,ts}function un(ts){var Ko=es(ts,"string");return Rt(Ko)=="symbol"?Ko:String(Ko)}function es(ts,Ko){if(Rt(ts)!="object"||!ts)return ts;var ds=ts[Symbol.toPrimitive];if(ds!==void 0){var Il=ds.call(ts,Ko||"default");if(Rt(Il)!="object")return Il;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Ko==="string"?String:Number)(ts)}var kn=(0,Et.canUseDOM)()&&requireSrc();nt.default=function(ts){Tr(ds,ts);var Ko=Fr(ds);function ds(Il){var ru;return Gt(this,ds),ru=Ko.call(this,Il),$n(tn(ru),"innerSliderRefHandler",function(uu){return ru.innerSlider=uu}),$n(tn(ru),"slickPrev",function(){return ru.innerSlider.slickPrev()}),$n(tn(ru),"slickNext",function(){return ru.innerSlider.slickNext()}),$n(tn(ru),"slickGoTo",function(uu){var p0=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return ru.innerSlider.slickGoTo(uu,p0)}),$n(tn(ru),"slickPause",function(){return ru.innerSlider.pause("paused")}),$n(tn(ru),"slickPlay",function(){return ru.innerSlider.autoPlay("play")}),ru.state={breakpoint:null},ru._responsiveMediaHandlers=[],ru}return Mr(ds,[{key:"media",value:function(ru,uu){kn.register(ru,uu),this._responsiveMediaHandlers.push({query:ru,handler:uu})}},{key:"componentDidMount",value:function(){var ru=this;if(this.props.responsive){var uu=this.props.responsive.map(function(X1){return X1.breakpoint});uu.sort(function(X1,q0){return X1-q0}),uu.forEach(function(X1,q0){var W0;q0===0?W0=(0,gt.default)({minWidth:0,maxWidth:X1}):W0=(0,gt.default)({minWidth:uu[q0-1]+1,maxWidth:X1}),(0,Et.canUseDOM)()&&ru.media(W0,function(){ru.setState({breakpoint:X1})})});var p0=(0,gt.default)({minWidth:uu.slice(-1)[0]});(0,Et.canUseDOM)()&&this.media(p0,function(){ru.setState({breakpoint:null})})}}},{key:"componentWillUnmount",value:function(){this._responsiveMediaHandlers.forEach(function(ru){kn.unregister(ru.query,ru.handler)})}},{key:"render",value:function(){var ru=this,uu,p0;this.state.breakpoint?(p0=this.props.responsive.filter(function(b0){return b0.breakpoint===ru.state.breakpoint}),uu=p0[0].settings==="unslick"?"unslick":Bt(Bt(Bt({},_t.default),this.props),p0[0].settings)):uu=Bt(Bt({},_t.default),this.props),uu.centerMode&&(uu.slidesToScroll>1,uu.slidesToScroll=1),uu.fade&&(uu.slidesToShow>1,uu.slidesToScroll>1,uu.slidesToShow=1,uu.slidesToScroll=1);var X1=st.default.Children.toArray(this.props.children);X1=X1.filter(function(b0){return typeof b0=="string"?!!b0.trim():!!b0}),uu.variableWidth&&(uu.rows>1||uu.slidesPerRow>1)&&(console.warn("variableWidth is not supported in case of rows > 1 or slidesPerRow > 1"),uu.variableWidth=!1);for(var q0=[],W0=null,hu=0;hu<X1.length;hu+=uu.rows*uu.slidesPerRow){for(var a1=[],Vx=hu;Vx<hu+uu.rows*uu.slidesPerRow;Vx+=uu.slidesPerRow){for(var t0=[],cu=Vx;cu<Vx+uu.slidesPerRow&&(uu.variableWidth&&X1[cu].props.style&&(W0=X1[cu].props.style.width),!(cu>=X1.length));cu+=1)t0.push(st.default.cloneElement(X1[cu],{key:100*hu+10*Vx+cu,tabIndex:-1,style:{width:"".concat(100/uu.slidesPerRow,"%"),display:"inline-block"}}));a1.push(st.default.createElement("div",{key:10*hu+Vx},t0))}uu.variableWidth?q0.push(st.default.createElement("div",{key:hu,style:{width:W0}},a1)):q0.push(st.default.createElement("div",{key:hu},a1))}if(uu==="unslick"){var lu="regular slider "+(this.props.className||"");return st.default.createElement("div",{className:lu},X1)}else q0.length<=uu.slidesToShow&&!uu.infinite&&(uu.unslick=!0);return st.default.createElement(mt.InnerSlider,Ft({style:this.props.style,ref:this.innerSliderRefHandler},(0,Et.filterSettings)(uu)),q0)}}]),ds}(st.default.Component)})(slider);(function(nt){Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=void 0;var st=mt(slider);function mt(gt){return gt&&gt.__esModule?gt:{default:gt}}nt.default=st.default})(lib$i);const Slider=getDefaultExportFromCjs(lib$i);dt.div`
  background-color: #5d708330;
  border-radius: 10px;
  padding: 40px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  margin: 5px;

  @media (max-width: 1024px) {
    padding: 30px;
  }

  @media (max-width: 768px) {
    padding: 25px;
  }
`;dt.h2`
  font-size: 18px;
  font-weight: bold;
  margin: 0;
  color: #b7b7b7;
`;dt.p`
  font-size: 14px;
  font-weight: 300;
  color: #b7b7b7;
  margin: 5px 0;
`;dt.p`
  font-size: 16px;
  font-weight: 300;
  color: #b7b7b7;
  margin: 10px 0 0;
  line-height: 1.4;

  @media (max-width: 1024px) {
    font-size: 15px;
  }

  @media (max-width: 768px) {
    font-size: 14px;
  }

  @media (max-width: 480px) {
    font-size: 13px;
  }
`;PropTypes.string.isRequired,PropTypes.string.isRequired,PropTypes.string.isRequired;function SampleNextArrow(nt){const{className:st,style:mt,onClick:gt}=nt;return jsxRuntimeExports.jsx("div",{className:st,style:{...mt,opacity:"0.5",paddingLeft:"50px"},onClick:gt})}SampleNextArrow.propTypes={className:PropTypes.string,style:PropTypes.object,onClick:PropTypes.func};function SamplePrevArrow(nt){const{className:st,style:mt,onClick:gt}=nt;return jsxRuntimeExports.jsx("div",{className:st,style:{...mt,opacity:"0.5"},onClick:gt})}SamplePrevArrow.propTypes={className:PropTypes.string,style:PropTypes.object,onClick:PropTypes.func};const SliderContainer=dt.div` 
  padding: 0px 20px;
  padding-bottom: 30px;
`,Main=dt.div`
  flex-grow: 1;
  height: calc(100vh - 100px);
  overflow-y: auto;
  scrollbar-width: none;
  scrollbar-color: var(--dividing-line) var(--background); /* Firefox */
`,ContentContainer=dt.div`
  max-width: 1200px;
  margin: 0 auto;
  padding: 30px;

  padding-top: 50px;
  padding-bottom: 200px;

  @media (max-width: 800px) {
    padding: 50px 15px;
  }
  
  @media (max-width: 576px) {
    padding-bottom: 100px;
  }
`,BoldTitle=dt.a`
  font-size: 40px;
  font-weight: bolder;
  transition: color 1s ease;
  padding-bottom: 40px;
  padding-right: 40px;
  
  @media (max-width: 576px){
    font-size: 30px;
  }
`,BoldSubHeading=dt.p`
    font-size: 30px;
    font-weight: 500;
    padding-top: 40px; /* Adjust this value as needed */
`,SubHeading=dt.p`
    font-size: 20px;
    font-weight: 500;
    padding-top: 30px; 
    
    @media (max-width: 576px){
      padding-top: 0px;
    }
`,Paragraph=dt.p`
  font-size: 16px;
  font-weight: 200;
  line-height: 2.0;
  padding: 0px 0;
  
  @media (max-width: 576px){
    font-size: 14px;
  }
`,Image$1=dt.img`
  width: 100%;
  height: auto;
  margin: 20px 0;
  margin-top: 40px;

  @media (max-width: 800px) {
    margin-top: 30px;
  }
`,PdfContainer=dt.div`
  padding-top: 50px;
`,ImageSliderDiv=dt.div`
  height: 700px;
  /* height: auto; */
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;

  @media (max-width: 1200px) {
    height: 600px;
  }

  @media (max-width: 800px) {
    height: 500px;
  }

  @media (max-width: 600px) {
    height: 400px;
  }
`,FullHeightImageSliderDiv=dt.div`
  height: 70vh;
  /* height: auto; */
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
`,SliderImage=dt.img`
  height: 100%;
  width: 100%;
  object-fit: cover;
`,SliderImg2=dt.img`
  height: 100%;
  width: 100%;
  object-fit: contain;
`;dt.div`
  display: flex;
  flex-direction: row;
  justify-content: center;
`;const orthoticImg="/website/assets/moldingGif-DMzlrqiY.gif",img1="/website/assets/1-DHsA8CH0.jpg",img2="/website/assets/2-oCfm1BCV.jpg",img3="/website/assets/3-AOjSMx24.jpg",v2Img="/website/assets/V2Socket-CxZbRuMI.jpg",smallSocket="/website/assets/smallSocket-DF8KeK4R.jpeg",smallSocket2="/website/assets/smallSocket2-BS8bhH_V.jpeg",generationImg="/website/assets/generationGif-C3HCDnia.gif",modelImg="/website/assets/3D%20models-M3dpXQGo.png",handshotImg="/website/assets/handShots-Cao8DoGM.png",outlineImg="/website/assets/foot%20outline-B2YSAcst.png";function OrthoticProstheticPage$2(){const nt={dots:!0,adaptiveHeight:!1,infinite:!0,slidesToShow:1,slidesToScroll:1,autoplay:!1,pauseOnHover:!0,nextArrow:jsxRuntimeExports.jsx(SampleNextArrow,{}),prevArrow:jsxRuntimeExports.jsx(SamplePrevArrow,{})};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GlobalStyle$5,{}),jsxRuntimeExports.jsxs(Nav,{children:[jsxRuntimeExports.jsx(NavLogoSection,{children:jsxRuntimeExports.jsxs(LogoBox,{children:[jsxRuntimeExports.jsxs("a",{href:"/portfolio/",children:[jsxRuntimeExports.jsx(Logo,{src:logoImg,alt:"Logo"})," "]}),jsxRuntimeExports.jsx(NBTitle,{children:"Nick Brady"})]})}),jsxRuntimeExports.jsx(WideNavLinkSection$5,{children:jsxRuntimeExports.jsxs(LinkBox,{children:[jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLinkedin,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"mailto:nickbrady8444@example.com",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faEnvelope,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]})})]}),jsxRuntimeExports.jsx(Main,{children:jsxRuntimeExports.jsxs(ContentContainer,{children:[jsxRuntimeExports.jsx(BoldTitle,{children:"Moldable Orthopedic Prosthetic Algorithmic Generation"}),jsxRuntimeExports.jsx(Paragraph,{children:"Leveraging a novel thermal workflow, this repo outlines my work on algorithmically generated moldable orthotic and prosthetic solutions that deliver superior functionality and comfort."}),jsxRuntimeExports.jsx(Paragraph,{children:"Employing the gyroid minimal surface as the principle structural element, the resulting devices are highly moldable, agnostic of axis. Due to the accessible thermal characteristics of popular thermoplastics, healthcare providers and patients are able to form a custom shape that hardens in minutes and can be remolded following subsequent heating. Coupled with elastic plastics such as TPU, cushioned areas complement the rigid molded structure for comfort and control."}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsxs(GithubBubble,{onClick:()=>window.open("https://github.com/NickMBrady/orthopedicProstheticGeneration","_blank"),children:["Github",jsxRuntimeExports.jsx("a",{href:"https://github.com/NickMBrady/orthopedicProstheticGeneration",target:"_blank",rel:"noopener noreferrer",style:{paddingLeft:"10px"},children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Material Dynamics"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"3D Printing"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Procedural Modeling"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Python"})]}),jsxRuntimeExports.jsx(Image$1,{src:orthoticImg,alt:"Orthotic Device"}),jsxRuntimeExports.jsx(BoldSubHeading,{children:"Orthotic Insert and Prosthetic Generative Algorithm"}),jsxRuntimeExports.jsx(Paragraph,{children:"The orthotic and prosthetic generative workflows operate in theree stages: image aquisition, algorithmic processing, and 3D generation."}),jsxRuntimeExports.jsx(SliderContainer,{style:{paddingTop:30},children:jsxRuntimeExports.jsx("div",{className:"slider-container",children:jsxRuntimeExports.jsxs(Slider,{...nt,children:[jsxRuntimeExports.jsx(ImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImage,{src:generationImg,alt:"Orthotic Device"})}),jsxRuntimeExports.jsx(ImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImage,{src:modelImg,alt:"Orthotic Device"})}),jsxRuntimeExports.jsx(ImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImage,{src:handshotImg,alt:"Orthotic Device"})}),jsxRuntimeExports.jsx(ImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImage,{src:outlineImg,alt:"Orthotic Device"})})]})})}),jsxRuntimeExports.jsx(SubHeading,{children:"Orthotic Generation"}),jsxRuntimeExports.jsx(Paragraph,{children:"A patient first traces their existing shoe insole on standard, letter paper and takes a picture. The script corrects for distortion and applies morphological operations to vertically align and segment the outline. The outline is measured using scale inferred from the paper and dimensions are passed to Blender, where an insole of specified height is constructed."}),jsxRuntimeExports.jsx(SubHeading,{children:"Prosthetic Generation"}),jsxRuntimeExports.jsx(Paragraph,{children:"A patient first longitudinally places green markers of known distance on the appendage: two dorsally, two radially. A dorsal and radial picture is taken, and the two images undergo initial processing separately. The algorithm identifies the markers, then distortion corrects, scales, and vertically aligns the image. Multiple morphological operations are applied to segment and outline the apendage, per axis. The outline is measured using scale inferred from the markers, and dorsal and radial dimensions are passed to Blender at several cross sections. With an additional length criteria specified, a socket of specified curvature and size is constructed."}),jsxRuntimeExports.jsx(BoldSubHeading,{children:"Applied Devices"}),jsxRuntimeExports.jsx(SubHeading,{children:"Orthotic Insert"}),jsxRuntimeExports.jsx(SliderContainer,{style:{paddingTop:30},children:jsxRuntimeExports.jsx("div",{className:"slider-container",children:jsxRuntimeExports.jsxs(Slider,{...nt,children:[jsxRuntimeExports.jsx(ImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImage,{src:orthoticOrthoticImg,alt:"Orthotic Device"})}),jsxRuntimeExports.jsx(ImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImage,{src:img1,alt:"Orthotic Device"})}),jsxRuntimeExports.jsx(ImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImage,{src:img2,alt:"Orthotic Device"})}),jsxRuntimeExports.jsx(ImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImage,{src:img3,alt:"Orthotic Device"})})]})})}),jsxRuntimeExports.jsx(Paragraph,{children:"Designed for limb-length discrepancy and asymmetry patients, the moldable insert conforms to support and cushion. A hyper-moldable structure of rigid PLA plastic comprises the majority of the height. A thin layer of flexible TPU is printed on top for elastic cushioning."}),jsxRuntimeExports.jsx(Paragraph,{children:"Project files and detailed forming instructions are available on Github."}),jsxRuntimeExports.jsx(SubHeading,{children:"Prosthetic Socket"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SliderContainer,{style:{paddingTop:30,maxWidth:"600px",margin:"0 auto"},children:jsxRuntimeExports.jsx("div",{className:"slider-container",children:jsxRuntimeExports.jsxs(Slider,{...nt,children:[jsxRuntimeExports.jsx(ImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImage,{src:v2Img,alt:"Orthotic Device"})}),jsxRuntimeExports.jsx(ImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImage,{src:smallSocket,alt:"Orthotic Device"})}),jsxRuntimeExports.jsx(ImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImage,{src:smallSocket2,alt:"Orthotic Device"})})]})})})}),jsxRuntimeExports.jsx(Paragraph,{children:"Targeted as a temporary or low-cost alternative, the prosthetic socket can be formed to precisely accomodate the residual limb."}),jsxRuntimeExports.jsx(Paragraph,{children:"Traditional polypropelene workflows require involved molding and casting, a costly and time-consuming process. This workflow allows for a socket of approximate fit to be precisely contoured to the patient's limb in minutes and at a fraction of the cost."}),jsxRuntimeExports.jsx(Paragraph,{children:"Project files and detailed forming instructions are available on Github."})]})})]})}const GlobalStyle$5=ft`
  :root {
    --light-gray: #b7b7b7;
    --dividing-line: #303f4d;
    --background: #f5f5f5;
  }

  h1, h2, h3, a, p, span {
    font-family: "Lexend Exa", sans-serif;
    font-weight: 400;
    color: var(--light-gray);
  }

  a {
    font-size: 10pt;
    text-decoration: none;
    text-transform: uppercase;
  }

  strong {
    font-weight: 400;
  }
  
`,WideNavLinkSection$5=dt(NavLinkSection)`
  flex-basis: 100%;
`,GUIssImg="/website/assets/GUIss-DFJA9yXx.png";function OrthoticProstheticPage$1(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GlobalStyle$4,{}),jsxRuntimeExports.jsxs(Nav,{children:[jsxRuntimeExports.jsx(NavLogoSection,{children:jsxRuntimeExports.jsxs(LogoBox,{children:[jsxRuntimeExports.jsxs("a",{href:"/portfolio/",children:[jsxRuntimeExports.jsx(Logo,{src:logoImg,alt:"Logo"})," "]}),jsxRuntimeExports.jsx(NBTitle,{children:"Nick Brady"})]})}),jsxRuntimeExports.jsx(WideNavLinkSection$4,{children:jsxRuntimeExports.jsxs(LinkBox,{children:[jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLinkedin,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"mailto:nickbrady8444@example.com",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faEnvelope,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]})})]}),jsxRuntimeExports.jsx(Main,{children:jsxRuntimeExports.jsxs(ContentContainer,{children:[jsxRuntimeExports.jsx(BoldTitle,{children:"Composite Element Detection"}),jsxRuntimeExports.jsx(Paragraph,{children:"Fully featured GUI for the automatic segmentation and statistical characterization of boron, tungsten, carbon, and polymer from cross-sectional images of a composite material."}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsxs(GithubBubble,{onClick:()=>window.open("https://github.com/SpecialtyMaterials/Composite-Element-Detection","_blank"),children:["Github",jsxRuntimeExports.jsx("a",{href:"https://github.com/SpecialtyMaterials/Composite-Element-Detection",target:"_blank",rel:"noopener noreferrer",style:{paddingLeft:"10px"},children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Software Development"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Graphical User Interface"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Computer Vision"})]}),jsxRuntimeExports.jsx(Image$1,{src:GUIssImg,alt:"Orthotic Device"}),jsxRuntimeExports.jsx(SubHeading,{children:"Overview"}),jsxRuntimeExports.jsx(Paragraph,{children:"I developed this software for my position at Specialty Materials, inc. A critical element for the characterization of composite materials is the percentage of the material that each distinct element occupies. This can be efficiently accomplished by viewing cross sections of the material under a microscope, at which point the elements can be manually identified."}),jsxRuntimeExports.jsx(Paragraph,{children:"I was tasked to build software with a fully-featured GUI that, given a composite cross sectional image, automatically identifies different elements for characterization. The computer vision logic is described below. I used OpenCV for image processing and Python to package the software into an executable."}),jsxRuntimeExports.jsx(SubHeading,{children:"Logic"}),jsxRuntimeExports.jsx(Paragraph,{children:"Composite Element Detection operates in two modes: BCP, for boron carbon polymer composites, and BTP, for boron tungsten polymer composites."}),jsxRuntimeExports.jsx(SubHeading,{children:"BCP Logic"}),jsxRuntimeExports.jsx(Paragraph,{children:"BCP operation has three primary stages: circle fitting, to identify whole boron fibers; circle validation, to remove invalid boron detection; and thresholding, to identify boron fragments, carbon, and polymer regions. Circle fitting is used in addition to thresholding to include boron voids, which would otherwise be incorrectly identified as polymer."}),jsxRuntimeExports.jsx(Paragraph,{children:"Circle fitting is excessive to ensure all boron is identified; as a result, many extraneous circles are also identified. Circle sensitivity is controlled with Parameter 3. Circle candidates are validated by analyzing the average brightness of the original image in the area contained by each circle; a low average brightness is likely polymer, and high, boron. Brightness detection threshold is controlled with Parameter 4. The remaining circles are assumed to be correctly identified boron fibers and the associated regions are removed from the subsequent thresholding steps."}),jsxRuntimeExports.jsx(Paragraph,{children:"The image is then thresholded for three brightnesses: high, which identifies boron fragments that circle detection did not identify, middle, which identifies carbon fiber, and low, which identifies polymer."}),jsxRuntimeExports.jsx(SubHeading,{children:"BTP Logic"}),jsxRuntimeExports.jsx(Paragraph,{children:"BTP operation is similar to BCP. Boron and tungsten are grouped identified and validated with the same circle and thresholding logic. To separate boron from tungsten, a subtle hue difference is used. The remaining polymer is thresholded, and the image is returned to the user for optional correction. Using a mouse, tungsten fibers or fragments that have been mischaracterized as boron are identified. The algorithm runs a second time with these data, and the final detection is produced."}),jsxRuntimeExports.jsx(SubHeading,{children:"Usage"}),jsxRuntimeExports.jsx(Paragraph,{children:"For instructions on downloading and usage, please refer to the Github linked above."})]})})]})}const GlobalStyle$4=ft`
  :root {
    --light-gray: #b7b7b7;
    --dividing-line: #303f4d;
    --background: #f5f5f5;
  }

  h1, h2, h3, a, p, span {
    font-family: "Lexend Exa", sans-serif;
    font-weight: 400;
    color: var(--light-gray);
  }

  a {
    font-size: 10pt;
    text-decoration: none;
    text-transform: uppercase;
  }

  strong {
    font-weight: 400;
  }

`,WideNavLinkSection$4=dt(NavLinkSection)`
  flex-basis: 100%;
`;function DiffusionEdgePage(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GlobalStyle$3,{}),jsxRuntimeExports.jsxs(Nav,{children:[jsxRuntimeExports.jsx(NavLogoSection,{children:jsxRuntimeExports.jsxs(LogoBox,{children:[jsxRuntimeExports.jsxs("a",{href:"/portfolio/",children:[jsxRuntimeExports.jsx(Logo,{src:logoImg,alt:"Logo"})," "]}),jsxRuntimeExports.jsx(NBTitle,{children:"Nick Brady"})]})}),jsxRuntimeExports.jsx(WideNavLinkSection$3,{children:jsxRuntimeExports.jsxs(LinkBox,{children:[jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLinkedin,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"mailto:nickbrady8444@example.com",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faEnvelope,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]})})]}),jsxRuntimeExports.jsx(Main,{children:jsxRuntimeExports.jsxs(ContentContainer,{children:[jsxRuntimeExports.jsx(BoldTitle,{children:"Diffusion Grain"}),jsxRuntimeExports.jsx(Paragraph,{children:"Implemented a state-of-the-art diffusion-based edge detection model to create automated boron grain segmentation and statistical characterization software."}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsxs(GithubBubble,{onClick:()=>window.open("https://github.com/SpecialtyMaterials/diffusionGrain","_blank"),children:["Github",jsxRuntimeExports.jsx("a",{href:"https://github.com/SpecialtyMaterials/diffusionGrain",target:"_blank",rel:"noopener noreferrer",style:{paddingLeft:"10px"},children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Convolutional Neural Networks"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Software Development"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Computer Vision"})]}),jsxRuntimeExports.jsx(Image$1,{src:diffEdgeImg,alt:"Orthotic Device"}),jsxRuntimeExports.jsx(SubHeading,{children:"Overview"}),jsxRuntimeExports.jsx(Paragraph,{children:"I developed this software for my position at Specialty Materials, inc. A critical element for the characterization of metallic fibers is the size and shape of the cells that compose it. This can be efficiently observed by viewing the fiber under high magnification, at which point the cells can be manually identified."}),jsxRuntimeExports.jsx(Paragraph,{children:"I was tasked to build software that, given an input image of a metallic fiber, could automatically characterize the size and shape of each cell. I accomplished this by training an edge detection algorithm on a custom dataset, then packaging the model into an algorithm that cleans the results, allows for fast manual correction of misidentifed cells, and generates data based on the detection results."}),jsxRuntimeExports.jsx(SubHeading,{children:"Grain Detection and Augmentation"}),jsxRuntimeExports.jsx(Paragraph,{children:"For instructions on checkpoints, my weights, and training, see the Github (linked above)."}),jsxRuntimeExports.jsx(Paragraph,{children:"A minimum of 400 images post-augmentation should be used for training, ideally more than 800. Data augmentation can be done with the provided augmentation script 'augmentation.py,' an easily adaptable framework with a wide array of procesing methods. Early training can be dramatically hastened by using a batch size of one until the gradients become unstable, at which point training can be resumed with a batch size of two."}),jsxRuntimeExports.jsx(SubHeading,{children:"Grain Processor"}),jsxRuntimeExports.jsx(Paragraph,{children:"Grain Processor is a Python algorithm that operates after the edge detection model produces a segmentation. Using OpenCV it cleans and skeletonizes the result, then presents the user a colored view of the identified grains. The user may click on extraneous segmentations to remove them from processing. Once complete ('d' on the keyboard twice), data for the width, heigh, area, and aspect ratio of each identified grain will be exported to a file. Default units are microns, defined by a scaling factor of nanometers per pixel."})]})})]})}const GlobalStyle$3=ft`
  :root {
    --light-gray: #b7b7b7;
    --dividing-line: #303f4d;
    --background: #f5f5f5;
  }

  h1, h2, h3, a, p, span {
    font-family: "Lexend Exa", sans-serif;
    font-weight: 400;
    color: var(--light-gray);
  }

  a {
    font-size: 10pt;
    text-decoration: none;
    text-transform: uppercase;
  }

  strong {
    font-weight: 400;
  }

`,WideNavLinkSection$3=dt(NavLinkSection)`
  flex-basis: 100%;
`;var lib$h={exports:{}},core_min={};function commonjsRequire(nt){throw new Error('Could not dynamically require "'+nt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(st,mt){module.exports=st.pdfjsLib=mt()})(globalThis,()=>(()=>{var __webpack_modules__=[,(nt,st)=>{var I7;Object.defineProperty(st,"__esModule",{value:!0}),st.VerbosityLevel=st.Util=st.UnknownErrorException=st.UnexpectedResponseException=st.TextRenderingMode=st.RenderingIntentFlag=st.PromiseCapability=st.PermissionFlag=st.PasswordResponses=st.PasswordException=st.PageActionEventType=st.OPS=st.MissingPDFException=st.MAX_IMAGE_SIZE_TO_CACHE=st.LINE_FACTOR=st.LINE_DESCENT_FACTOR=st.InvalidPDFException=st.ImageKind=st.IDENTITY_MATRIX=st.FormatError=st.FeatureTest=st.FONT_IDENTITY_MATRIX=st.DocumentActionEventType=st.CMapCompressionType=st.BaseException=st.BASELINE_FACTOR=st.AnnotationType=st.AnnotationReplyType=st.AnnotationPrefix=st.AnnotationMode=st.AnnotationFlag=st.AnnotationFieldFlag=st.AnnotationEditorType=st.AnnotationEditorPrefix=st.AnnotationEditorParamsType=st.AnnotationBorderStyleType=st.AnnotationActionEventType=st.AbortException=void 0,st.assert=hu,st.bytesToString=h$,st.createValidAbsoluteUrl=Vx,st.getModificationDate=F$,st.getUuid=gD,st.getVerbosityLevel=p0,st.info=X1,st.isArrayBuffer=u$,st.isArrayEqual=UE,st.isNodeJS=void 0,st.normalizeUnicode=J$,st.objectFromMap=M$,st.objectSize=R$,st.setVerbosityLevel=uu,st.shadow=t0,st.string32=y$,st.stringToBytes=d$,st.stringToPDFString=tA,st.stringToUTF8String=tS,st.unreachable=W0,st.utf8StringToString=m$,st.warn=q0;const mt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");st.isNodeJS=mt;const gt=[1,0,0,1,0,0];st.IDENTITY_MATRIX=gt;const _t=[.001,0,0,.001,0,0];st.FONT_IDENTITY_MATRIX=_t;const Et=1e7;st.MAX_IMAGE_SIZE_TO_CACHE=Et;const At=1.35;st.LINE_FACTOR=At;const Rt=.35;st.LINE_DESCENT_FACTOR=Rt;const Ft=Rt/At;st.BASELINE_FACTOR=Ft;const Nt={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};st.RenderingIntentFlag=Nt;const Bt={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};st.AnnotationMode=Bt;const Gt="pdfjs_internal_editor_";st.AnnotationEditorPrefix=Gt;const dr={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};st.AnnotationEditorType=dr;const Mr={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};st.AnnotationEditorParamsType=Mr;const Tr={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};st.PermissionFlag=Tr;const zr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};st.TextRenderingMode=zr;const Fr={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};st.ImageKind=Fr;const Nr={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};st.AnnotationType=Nr;const tn={GROUP:"Group",REPLY:"R"};st.AnnotationReplyType=tn;const rn={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};st.AnnotationFlag=rn;const Tn={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};st.AnnotationFieldFlag=Tn;const $n={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};st.AnnotationBorderStyleType=$n;const un={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};st.AnnotationActionEventType=un;const es={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};st.DocumentActionEventType=es;const kn={O:"PageOpen",C:"PageClose"};st.PageActionEventType=kn;const ts={ERRORS:0,WARNINGS:1,INFOS:5};st.VerbosityLevel=ts;const Ko={NONE:0,BINARY:1};st.CMapCompressionType=Ko;const ds={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};st.OPS=ds;const Il={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};st.PasswordResponses=Il;let ru=ts.WARNINGS;function uu(j$){Number.isInteger(j$)&&(ru=j$)}function p0(){return ru}function X1(j$){ru>=ts.INFOS&&console.log(`Info: ${j$}`)}function q0(j$){ru>=ts.WARNINGS&&console.log(`Warning: ${j$}`)}function W0(j$){throw new Error(j$)}function hu(j$,_$){j$||W0(_$)}function a1(j$){switch(j$==null?void 0:j$.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Vx(j$,_$=null,I$=null){if(!j$)return null;try{if(I$&&typeof j$=="string"){if(I$.addDefaultProtocol&&j$.startsWith("www.")){const w$=j$.match(/\./g);(w$==null?void 0:w$.length)>=2&&(j$=`http://${j$}`)}if(I$.tryConvertEncoding)try{j$=tS(j$)}catch{}}const GL=_$?new URL(j$,_$):new URL(j$);if(a1(GL))return GL}catch{}return null}function t0(j$,_$,I$,GL=!1){return Object.defineProperty(j$,_$,{value:I$,enumerable:!GL,configurable:!0,writable:!1}),I$}const cu=function(){function _$(I$,GL){this.constructor===_$&&W0("Cannot initialize BaseException."),this.message=I$,this.name=GL}return _$.prototype=new Error,_$.constructor=_$,_$}();st.BaseException=cu;class lu extends cu{constructor(_$,I$){super(_$,"PasswordException"),this.code=I$}}st.PasswordException=lu;class b0 extends cu{constructor(_$,I$){super(_$,"UnknownErrorException"),this.details=I$}}st.UnknownErrorException=b0;class l1 extends cu{constructor(_$){super(_$,"InvalidPDFException")}}st.InvalidPDFException=l1;class LE extends cu{constructor(_$){super(_$,"MissingPDFException")}}st.MissingPDFException=LE;class eS extends cu{constructor(_$,I$){super(_$,"UnexpectedResponseException"),this.status=I$}}st.UnexpectedResponseException=eS;class SA extends cu{constructor(_$){super(_$,"FormatError")}}st.FormatError=SA;class o$ extends cu{constructor(_$){super(_$,"AbortException")}}st.AbortException=o$;function h$(j$){(typeof j$!="object"||(j$==null?void 0:j$.length)===void 0)&&W0("Invalid argument for bytesToString");const _$=j$.length,I$=8192;if(_$<I$)return String.fromCharCode.apply(null,j$);const GL=[];for(let w$=0;w$<_$;w$+=I$){const B$=Math.min(w$+I$,_$),r$=j$.subarray(w$,B$);GL.push(String.fromCharCode.apply(null,r$))}return GL.join("")}function d$(j$){typeof j$!="string"&&W0("Invalid argument for stringToBytes");const _$=j$.length,I$=new Uint8Array(_$);for(let GL=0;GL<_$;++GL)I$[GL]=j$.charCodeAt(GL)&255;return I$}function y$(j$){return String.fromCharCode(j$>>24&255,j$>>16&255,j$>>8&255,j$&255)}function R$(j$){return Object.keys(j$).length}function M$(j$){const _$=Object.create(null);for(const[I$,GL]of j$)_$[I$]=GL;return _$}function x$(){const j$=new Uint8Array(4);return j$[0]=1,new Uint32Array(j$.buffer,0,1)[0]===1}function v$(){try{return new Function(""),!0}catch{return!1}}class rS{static get isLittleEndian(){return t0(this,"isLittleEndian",x$())}static get isEvalSupported(){return t0(this,"isEvalSupported",v$())}static get isOffscreenCanvasSupported(){return t0(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?t0(this,"platform",{isWin:!1,isMac:!1}):t0(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var _$,I$;return t0(this,"isCSSRoundSupported",(I$=(_$=globalThis.CSS)==null?void 0:_$.supports)==null?void 0:I$.call(_$,"width: round(1.5px, 1px)"))}}st.FeatureTest=rS;const wA=[...Array(256).keys()].map(j$=>j$.toString(16).padStart(2,"0"));class g${static makeHexColor(_$,I$,GL){return`#${wA[_$]}${wA[I$]}${wA[GL]}`}static scaleMinMax(_$,I$){let GL;_$[0]?(_$[0]<0&&(GL=I$[0],I$[0]=I$[1],I$[1]=GL),I$[0]*=_$[0],I$[1]*=_$[0],_$[3]<0&&(GL=I$[2],I$[2]=I$[3],I$[3]=GL),I$[2]*=_$[3],I$[3]*=_$[3]):(GL=I$[0],I$[0]=I$[2],I$[2]=GL,GL=I$[1],I$[1]=I$[3],I$[3]=GL,_$[1]<0&&(GL=I$[2],I$[2]=I$[3],I$[3]=GL),I$[2]*=_$[1],I$[3]*=_$[1],_$[2]<0&&(GL=I$[0],I$[0]=I$[1],I$[1]=GL),I$[0]*=_$[2],I$[1]*=_$[2]),I$[0]+=_$[4],I$[1]+=_$[4],I$[2]+=_$[5],I$[3]+=_$[5]}static transform(_$,I$){return[_$[0]*I$[0]+_$[2]*I$[1],_$[1]*I$[0]+_$[3]*I$[1],_$[0]*I$[2]+_$[2]*I$[3],_$[1]*I$[2]+_$[3]*I$[3],_$[0]*I$[4]+_$[2]*I$[5]+_$[4],_$[1]*I$[4]+_$[3]*I$[5]+_$[5]]}static applyTransform(_$,I$){const GL=_$[0]*I$[0]+_$[1]*I$[2]+I$[4],w$=_$[0]*I$[1]+_$[1]*I$[3]+I$[5];return[GL,w$]}static applyInverseTransform(_$,I$){const GL=I$[0]*I$[3]-I$[1]*I$[2],w$=(_$[0]*I$[3]-_$[1]*I$[2]+I$[2]*I$[5]-I$[4]*I$[3])/GL,B$=(-_$[0]*I$[1]+_$[1]*I$[0]+I$[4]*I$[1]-I$[5]*I$[0])/GL;return[w$,B$]}static getAxialAlignedBoundingBox(_$,I$){const GL=this.applyTransform(_$,I$),w$=this.applyTransform(_$.slice(2,4),I$),B$=this.applyTransform([_$[0],_$[3]],I$),r$=this.applyTransform([_$[2],_$[1]],I$);return[Math.min(GL[0],w$[0],B$[0],r$[0]),Math.min(GL[1],w$[1],B$[1],r$[1]),Math.max(GL[0],w$[0],B$[0],r$[0]),Math.max(GL[1],w$[1],B$[1],r$[1])]}static inverseTransform(_$){const I$=_$[0]*_$[3]-_$[1]*_$[2];return[_$[3]/I$,-_$[1]/I$,-_$[2]/I$,_$[0]/I$,(_$[2]*_$[5]-_$[4]*_$[3])/I$,(_$[4]*_$[1]-_$[5]*_$[0])/I$]}static singularValueDecompose2dScale(_$){const I$=[_$[0],_$[2],_$[1],_$[3]],GL=_$[0]*I$[0]+_$[1]*I$[2],w$=_$[0]*I$[1]+_$[1]*I$[3],B$=_$[2]*I$[0]+_$[3]*I$[2],r$=_$[2]*I$[1]+_$[3]*I$[3],O$=(GL+r$)/2,Z$=Math.sqrt((GL+r$)**2-4*(GL*r$-B$*w$))/2,mL=O$+Z$||1,P7=O$-Z$||1;return[Math.sqrt(mL),Math.sqrt(P7)]}static normalizeRect(_$){const I$=_$.slice(0);return _$[0]>_$[2]&&(I$[0]=_$[2],I$[2]=_$[0]),_$[1]>_$[3]&&(I$[1]=_$[3],I$[3]=_$[1]),I$}static intersect(_$,I$){const GL=Math.max(Math.min(_$[0],_$[2]),Math.min(I$[0],I$[2])),w$=Math.min(Math.max(_$[0],_$[2]),Math.max(I$[0],I$[2]));if(GL>w$)return null;const B$=Math.max(Math.min(_$[1],_$[3]),Math.min(I$[1],I$[3])),r$=Math.min(Math.max(_$[1],_$[3]),Math.max(I$[1],I$[3]));return B$>r$?null:[GL,B$,w$,r$]}static bezierBoundingBox(_$,I$,GL,w$,B$,r$,O$,Z$){const mL=[],P7=[[],[]];let L9,f$,l$,T$,q$,Q$,gR,kI;for(let Y$=0;Y$<2;++Y$){if(Y$===0?(f$=6*_$-12*GL+6*B$,L9=-3*_$+9*GL-9*B$+3*O$,l$=3*GL-3*_$):(f$=6*I$-12*w$+6*r$,L9=-3*I$+9*w$-9*r$+3*Z$,l$=3*w$-3*I$),Math.abs(L9)<1e-12){if(Math.abs(f$)<1e-12)continue;T$=-l$/f$,0<T$&&T$<1&&mL.push(T$);continue}gR=f$*f$-4*l$*L9,kI=Math.sqrt(gR),!(gR<0)&&(q$=(-f$+kI)/(2*L9),0<q$&&q$<1&&mL.push(q$),Q$=(-f$-kI)/(2*L9),0<Q$&&Q$<1&&mL.push(Q$))}let Pq=mL.length,s$;const C$=Pq;for(;Pq--;)T$=mL[Pq],s$=1-T$,P7[0][Pq]=s$*s$*s$*_$+3*s$*s$*T$*GL+3*s$*T$*T$*B$+T$*T$*T$*O$,P7[1][Pq]=s$*s$*s$*I$+3*s$*s$*T$*w$+3*s$*T$*T$*r$+T$*T$*T$*Z$;return P7[0][C$]=_$,P7[1][C$]=I$,P7[0][C$+1]=O$,P7[1][C$+1]=Z$,P7[0].length=P7[1].length=C$+2,[Math.min(...P7[0]),Math.min(...P7[1]),Math.max(...P7[0]),Math.max(...P7[1])]}}st.Util=g$;const S$=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function tA(j$){if(j$[0]>=""){let I$;if(j$[0]===""&&j$[1]===""?I$="utf-16be":j$[0]===""&&j$[1]===""?I$="utf-16le":j$[0]===""&&j$[1]===""&&j$[2]===""&&(I$="utf-8"),I$)try{const GL=new TextDecoder(I$,{fatal:!0}),w$=d$(j$);return GL.decode(w$)}catch(GL){q0(`stringToPDFString: "${GL}".`)}}const _$=[];for(let I$=0,GL=j$.length;I$<GL;I$++){const w$=S$[j$.charCodeAt(I$)];_$.push(w$?String.fromCharCode(w$):j$.charAt(I$))}return _$.join("")}function tS(j$){return decodeURIComponent(escape(j$))}function m$(j$){return unescape(encodeURIComponent(j$))}function u$(j$){return typeof j$=="object"&&(j$==null?void 0:j$.byteLength)!==void 0}function UE(j$,_$){if(j$.length!==_$.length)return!1;for(let I$=0,GL=j$.length;I$<GL;I$++)if(j$[I$]!==_$[I$])return!1;return!0}function F$(j$=new Date){return[j$.getUTCFullYear().toString(),(j$.getUTCMonth()+1).toString().padStart(2,"0"),j$.getUTCDate().toString().padStart(2,"0"),j$.getUTCHours().toString().padStart(2,"0"),j$.getUTCMinutes().toString().padStart(2,"0"),j$.getUTCSeconds().toString().padStart(2,"0")].join("")}class EI{constructor(){G$(this,I7,!1);this.promise=new Promise((_$,I$)=>{this.resolve=GL=>{K$(this,I7,!0),_$(GL)},this.reject=GL=>{K$(this,I7,!0),I$(GL)}})}get settled(){return Sv(this,I7)}}I7=new WeakMap,st.PromiseCapability=EI;let pR=null,X$=null;function J$(j$){return pR||(pR=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,X$=new Map([["","t"]])),j$.replaceAll(pR,(_$,I$,GL)=>I$?I$.normalize("NFKC"):X$.get(GL))}function gD(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const j$=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(j$);else for(let _$=0;_$<32;_$++)j$[_$]=Math.floor(Math.random()*255);return h$(j$)}const fL="pdfjs_internal_id_";st.AnnotationPrefix=fL},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var nt,mt,gt,_t,rte,Ete,Rt,Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Ate,Nr,tn,Kte,Tn,$n;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(es){if(typeof es=="string"||es instanceof URL?es={url:es}:(0,_util.isArrayBuffer)(es)&&(es={data:es}),typeof es!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!es.url&&!es.data&&!es.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const kn=new PDFDocumentLoadingTask,{docId:ts}=kn,Ko=es.url?getUrlProp(es.url):null,ds=es.data?getDataProp(es.data):null,Il=es.httpHeaders||null,ru=es.withCredentials===!0,uu=es.password??null,p0=es.range instanceof PDFDataRangeTransport?es.range:null,X1=Number.isInteger(es.rangeChunkSize)&&es.rangeChunkSize>0?es.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let q0=es.worker instanceof PDFWorker?es.worker:null;const W0=es.verbosity,hu=typeof es.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(es.docBaseUrl)?es.docBaseUrl:null,a1=typeof es.cMapUrl=="string"?es.cMapUrl:null,Vx=es.cMapPacked!==!1,t0=es.CMapReaderFactory||DefaultCMapReaderFactory,cu=typeof es.standardFontDataUrl=="string"?es.standardFontDataUrl:null,lu=es.StandardFontDataFactory||DefaultStandardFontDataFactory,b0=es.stopAtErrors!==!0,l1=Number.isInteger(es.maxImageSize)&&es.maxImageSize>-1?es.maxImageSize:-1,LE=es.isEvalSupported!==!1,eS=typeof es.isOffscreenCanvasSupported=="boolean"?es.isOffscreenCanvasSupported:!_util.isNodeJS,SA=Number.isInteger(es.canvasMaxAreaInBytes)?es.canvasMaxAreaInBytes:-1,o$=typeof es.disableFontFace=="boolean"?es.disableFontFace:_util.isNodeJS,h$=es.fontExtraProperties===!0,d$=es.enableXfa===!0,y$=es.ownerDocument||globalThis.document,R$=es.disableRange===!0,M$=es.disableStream===!0,x$=es.disableAutoFetch===!0,v$=es.pdfBug===!0,rS=p0?p0.length:es.length??NaN,wA=typeof es.useSystemFonts=="boolean"?es.useSystemFonts:!_util.isNodeJS&&!o$,g$=typeof es.useWorkerFetch=="boolean"?es.useWorkerFetch:t0===_display_utils.DOMCMapReaderFactory&&lu===_display_utils.DOMStandardFontDataFactory&&a1&&cu&&(0,_display_utils.isValidFetchUrl)(a1,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(cu,document.baseURI),S$=es.canvasFactory||new DefaultCanvasFactory({ownerDocument:y$}),tA=es.filterFactory||new DefaultFilterFactory({docId:ts,ownerDocument:y$}),tS=null;(0,_util.setVerbosityLevel)(W0);const m$={canvasFactory:S$,filterFactory:tA};if(g$||(m$.cMapReaderFactory=new t0({baseUrl:a1,isCompressed:Vx}),m$.standardFontDataFactory=new lu({baseUrl:cu})),!q0){const F$={verbosity:W0,port:_worker_options.GlobalWorkerOptions.workerPort};q0=F$.port?PDFWorker.fromPort(F$):new PDFWorker(F$),kn._worker=q0}const u$={docId:ts,apiVersion:"3.11.174",data:ds,password:uu,disableAutoFetch:x$,rangeChunkSize:X1,length:rS,docBaseUrl:hu,enableXfa:d$,evaluatorOptions:{maxImageSize:l1,disableFontFace:o$,ignoreErrors:b0,isEvalSupported:LE,isOffscreenCanvasSupported:eS,canvasMaxAreaInBytes:SA,fontExtraProperties:h$,useSystemFonts:wA,cMapUrl:g$?a1:null,standardFontDataUrl:g$?cu:null}},UE={ignoreErrors:b0,isEvalSupported:LE,disableFontFace:o$,fontExtraProperties:h$,enableXfa:d$,ownerDocument:y$,disableAutoFetch:x$,pdfBug:v$,styleElement:tS};return q0.promise.then(function(){if(kn.destroyed)throw new Error("Loading aborted");const F$=_fetchDocument(q0,u$),EI=new Promise(function(pR){let X$;p0?X$=new _transport_stream.PDFDataTransportStream({length:rS,initialData:p0.initialData,progressiveDone:p0.progressiveDone,contentDispositionFilename:p0.contentDispositionFilename,disableRange:R$,disableStream:M$},p0):ds||(X$=(gD=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(gD):(0,_display_utils.isValidFetchUrl)(gD.url)?new _displayFetch_stream.PDFFetchStream(gD):new _displayNetwork.PDFNetworkStream(gD))({url:Ko,length:rS,httpHeaders:Il,withCredentials:ru,rangeChunkSize:X1,disableRange:R$,disableStream:M$})),pR(X$)});return Promise.all([F$,EI]).then(function([pR,X$]){if(kn.destroyed)throw new Error("Loading aborted");const J$=new _message_handler.MessageHandler(ts,pR,q0.port),gD=new WorkerTransport(J$,kn,X$,UE,m$);kn._transport=gD,J$.send("Ready",null)})}).catch(kn._capability.reject),kn}async function _fetchDocument(es,kn){if(es.destroyed)throw new Error("Worker was destroyed");const ts=await es.messageHandler.sendWithPromise("GetDocRequest",kn,kn.data?[kn.data.buffer]:null);if(es.destroyed)throw new Error("Worker was destroyed");return ts}function getUrlProp(es){if(es instanceof URL)return es.href;try{return new URL(es,window.location).href}catch{if(_util.isNodeJS&&typeof es=="string")return es}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(es){if(_util.isNodeJS&&typeof Buffer<"u"&&es instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(es instanceof Uint8Array&&es.byteLength===es.buffer.byteLength)return es;if(typeof es=="string")return(0,_util.stringToBytes)(es);if(typeof es=="object"&&!isNaN(es==null?void 0:es.length)||(0,_util.isArrayBuffer)(es))return new Uint8Array(es);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const st=class st{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${hte(st,nt)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var kn,ts,Ko;this.destroyed=!0;try{(kn=this._worker)!=null&&kn.port&&(this._worker._pendingDestroy=!0),await((ts=this._transport)==null?void 0:ts.destroy())}catch(ds){throw(Ko=this._worker)!=null&&Ko.port&&delete this._worker._pendingDestroy,ds}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};nt=new WeakMap,G$(st,nt,0);let PDFDocumentLoadingTask=st;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(kn,ts,Ko=!1,ds=null){this.length=kn,this.initialData=ts,this.progressiveDone=Ko,this.contentDispositionFilename=ds,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(kn){this._rangeListeners.push(kn)}addProgressListener(kn){this._progressListeners.push(kn)}addProgressiveReadListener(kn){this._progressiveReadListeners.push(kn)}addProgressiveDoneListener(kn){this._progressiveDoneListeners.push(kn)}onDataRange(kn,ts){for(const Ko of this._rangeListeners)Ko(kn,ts)}onDataProgress(kn,ts){this._readyCapability.promise.then(()=>{for(const Ko of this._progressListeners)Ko(kn,ts)})}onDataProgressiveRead(kn){this._readyCapability.promise.then(()=>{for(const ts of this._progressiveReadListeners)ts(kn)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const kn of this._progressiveDoneListeners)kn()})}transportReady(){this._readyCapability.resolve()}requestDataRange(kn,ts){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(kn,ts){this._pdfInfo=kn,this._transport=ts,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(Ko=>{if(!Ko)return Ko;const ds=[];for(const Il in Ko)ds.push(...Ko[Il]);return ds}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(kn){return this._transport.getPage(kn)}getPageIndex(kn){return this._transport.getPageIndex(kn)}getDestinations(){return this._transport.getDestinations()}getDestination(kn){return this._transport.getDestination(kn)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(kn=!1){return this._transport.startCleanup(kn||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(kn,ts,Ko,ds=!1){G$(this,_t);G$(this,mt,null);G$(this,gt,!1);this._pageIndex=kn,this._pageInfo=ts,this._transport=Ko,this._stats=ds?new _display_utils.StatTimer:null,this._pdfBug=ds,this.commonObjs=Ko.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:kn,rotation:ts=this.rotate,offsetX:Ko=0,offsetY:ds=0,dontFlip:Il=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:kn,rotation:ts,offsetX:Ko,offsetY:ds,dontFlip:Il})}getAnnotations({intent:kn="display"}={}){const ts=this._transport.getRenderingIntent(kn);return this._transport.getAnnotations(this._pageIndex,ts.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var kn;return((kn=this._transport._htmlForXfa)==null?void 0:kn.children[this._pageIndex])||null}render({canvasContext:kn,viewport:ts,intent:Ko="display",annotationMode:ds=_util.AnnotationMode.ENABLE,transform:Il=null,background:ru=null,optionalContentConfigPromise:uu=null,annotationCanvasMap:p0=null,pageColors:X1=null,printAnnotationStorage:q0=null}){var lu,b0;(lu=this._stats)==null||lu.time("Overall");const W0=this._transport.getRenderingIntent(Ko,ds,q0);K$(this,gt,!1),L$(this,_t,Ete).call(this),uu||(uu=this._transport.getOptionalContentConfig());let hu=this._intentStates.get(W0.cacheKey);hu||(hu=Object.create(null),this._intentStates.set(W0.cacheKey,hu)),hu.streamReaderCancelTimeout&&(clearTimeout(hu.streamReaderCancelTimeout),hu.streamReaderCancelTimeout=null);const a1=!!(W0.renderingIntent&_util.RenderingIntentFlag.PRINT);hu.displayReadyCapability||(hu.displayReadyCapability=new _util.PromiseCapability,hu.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(b0=this._stats)==null||b0.time("Page Request"),this._pumpOperatorList(W0));const Vx=l1=>{var LE,eS;hu.renderTasks.delete(t0),(this._maybeCleanupAfterRender||a1)&&K$(this,gt,!0),L$(this,_t,rte).call(this,!a1),l1?(t0.capability.reject(l1),this._abortOperatorList({intentState:hu,reason:l1 instanceof Error?l1:new Error(l1)})):t0.capability.resolve(),(LE=this._stats)==null||LE.timeEnd("Rendering"),(eS=this._stats)==null||eS.timeEnd("Overall")},t0=new InternalRenderTask({callback:Vx,params:{canvasContext:kn,viewport:ts,transform:Il,background:ru},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:p0,operatorList:hu.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!a1,pdfBug:this._pdfBug,pageColors:X1});(hu.renderTasks||(hu.renderTasks=new Set)).add(t0);const cu=t0.task;return Promise.all([hu.displayReadyCapability.promise,uu]).then(([l1,LE])=>{var eS;if(this.destroyed){Vx();return}(eS=this._stats)==null||eS.time("Rendering"),t0.initializeGraphics({transparency:l1,optionalContentConfig:LE}),t0.operatorListChanged()}).catch(Vx),cu}getOperatorList({intent:kn="display",annotationMode:ts=_util.AnnotationMode.ENABLE,printAnnotationStorage:Ko=null}={}){var p0;function ds(){ru.operatorList.lastChunk&&(ru.opListReadCapability.resolve(ru.operatorList),ru.renderTasks.delete(uu))}const Il=this._transport.getRenderingIntent(kn,ts,Ko,!0);let ru=this._intentStates.get(Il.cacheKey);ru||(ru=Object.create(null),this._intentStates.set(Il.cacheKey,ru));let uu;return ru.opListReadCapability||(uu=Object.create(null),uu.operatorListChanged=ds,ru.opListReadCapability=new _util.PromiseCapability,(ru.renderTasks||(ru.renderTasks=new Set)).add(uu),ru.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(p0=this._stats)==null||p0.time("Page Request"),this._pumpOperatorList(Il)),ru.opListReadCapability.promise}streamTextContent({includeMarkedContent:kn=!1,disableNormalization:ts=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:kn===!0,disableNormalization:ts===!0},{highWaterMark:100,size(ds){return ds.items.length}})}getTextContent(kn={}){if(this._transport._htmlForXfa)return this.getXfa().then(Ko=>_xfa_text.XfaText.textContent(Ko));const ts=this.streamTextContent(kn);return new Promise(function(Ko,ds){function Il(){ru.read().then(function({value:p0,done:X1}){if(X1){Ko(uu);return}Object.assign(uu.styles,p0.styles),uu.items.push(...p0.items),Il()},ds)}const ru=ts.getReader(),uu={items:[],styles:Object.create(null)};Il()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const kn=[];for(const ts of this._intentStates.values())if(this._abortOperatorList({intentState:ts,reason:new Error("Page was destroyed."),force:!0}),!ts.opListReadCapability)for(const Ko of ts.renderTasks)kn.push(Ko.completed),Ko.cancel();return this.objs.clear(),K$(this,gt,!1),L$(this,_t,Ete).call(this),Promise.all(kn)}cleanup(kn=!1){K$(this,gt,!0);const ts=L$(this,_t,rte).call(this,!1);return kn&&ts&&this._stats&&(this._stats=new _display_utils.StatTimer),ts}_startRenderPage(kn,ts){var ds,Il;const Ko=this._intentStates.get(ts);Ko&&((ds=this._stats)==null||ds.timeEnd("Page Request"),(Il=Ko.displayReadyCapability)==null||Il.resolve(kn))}_renderPageChunk(kn,ts){for(let Ko=0,ds=kn.length;Ko<ds;Ko++)ts.operatorList.fnArray.push(kn.fnArray[Ko]),ts.operatorList.argsArray.push(kn.argsArray[Ko]);ts.operatorList.lastChunk=kn.lastChunk,ts.operatorList.separateAnnots=kn.separateAnnots;for(const Ko of ts.renderTasks)Ko.operatorListChanged();kn.lastChunk&&L$(this,_t,rte).call(this,!0)}_pumpOperatorList({renderingIntent:kn,cacheKey:ts,annotationStorageSerializable:Ko}){const{map:ds,transfers:Il}=Ko,uu=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:kn,cacheKey:ts,annotationStorage:ds},Il).getReader(),p0=this._intentStates.get(ts);p0.streamReader=uu;const X1=()=>{uu.read().then(({value:q0,done:W0})=>{if(W0){p0.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(q0,p0),X1())},q0=>{if(p0.streamReader=null,!this._transport.destroyed){if(p0.operatorList){p0.operatorList.lastChunk=!0;for(const W0 of p0.renderTasks)W0.operatorListChanged();L$(this,_t,rte).call(this,!0)}if(p0.displayReadyCapability)p0.displayReadyCapability.reject(q0);else if(p0.opListReadCapability)p0.opListReadCapability.reject(q0);else throw q0}})};X1()}_abortOperatorList({intentState:kn,reason:ts,force:Ko=!1}){if(kn.streamReader){if(kn.streamReaderCancelTimeout&&(clearTimeout(kn.streamReaderCancelTimeout),kn.streamReaderCancelTimeout=null),!Ko){if(kn.renderTasks.size>0)return;if(ts instanceof _display_utils.RenderingCancelledException){let ds=RENDERING_CANCELLED_TIMEOUT;ts.extraDelay>0&&ts.extraDelay<1e3&&(ds+=ts.extraDelay),kn.streamReaderCancelTimeout=setTimeout(()=>{kn.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:kn,reason:ts,force:!0})},ds);return}}if(kn.streamReader.cancel(new _util.AbortException(ts.message)).catch(()=>{}),kn.streamReader=null,!this._transport.destroyed){for(const[ds,Il]of this._intentStates)if(Il===kn){this._intentStates.delete(ds);break}this.cleanup()}}}get stats(){return this._stats}}mt=new WeakMap,gt=new WeakMap,_t=new WeakSet,rte=function(kn=!1){if(L$(this,_t,Ete).call(this),!Sv(this,gt)||this.destroyed)return!1;if(kn)return K$(this,mt,setTimeout(()=>{K$(this,mt,null),L$(this,_t,rte).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:ts,operatorList:Ko}of this._intentStates.values())if(ts.size>0||!Ko.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),K$(this,gt,!1),!0},Ete=function(){Sv(this,mt)&&(clearTimeout(Sv(this,mt)),K$(this,mt,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){G$(this,Rt,new Set);G$(this,Ft,Promise.resolve())}postMessage(kn,ts){const Ko={data:structuredClone(kn,ts?{transfer:ts}:null)};Sv(this,Ft).then(()=>{for(const ds of Sv(this,Rt))ds.call(this,Ko)})}addEventListener(kn,ts){Sv(this,Rt).add(ts)}removeEventListener(kn,ts){Sv(this,Rt).delete(ts)}terminate(){Sv(this,Rt).clear()}}Rt=new WeakMap,Ft=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const es=(Nt=document==null?void 0:document.currentScript)==null?void 0:Nt.src;es&&(PDFWorkerUtil.fallbackWorkerSrc=es.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(es,kn){let ts;try{if(ts=new URL(es),!ts.origin||ts.origin==="null")return!1}catch{return!1}const Ko=new URL(kn,ts);return ts.origin===Ko.origin},PDFWorkerUtil.createCDNWrapper=function(es){const kn=`importScripts("${es}");`;return URL.createObjectURL(new Blob([kn]))}}const _PDFWorker=class _PDFWorker{constructor({name:es=null,port:kn=null,verbosity:ts=(0,_util.getVerbosityLevel)()}={}){var Ko;if(this.name=es,this.destroyed=!1,this.verbosity=ts,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,kn){if((Ko=Sv(_PDFWorker,Bt))!=null&&Ko.has(kn))throw new Error("Cannot use more than one PDFWorker per port.");(Sv(_PDFWorker,Bt)||K$(_PDFWorker,Bt,new WeakMap)).set(kn,this),this._initializeFromPort(kn);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(es){this._port=es,this._messageHandler=new _message_handler.MessageHandler("main","worker",es),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:es}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,es)||(es=PDFWorkerUtil.createCDNWrapper(new URL(es,window.location).href));const kn=new Worker(es),ts=new _message_handler.MessageHandler("main","worker",kn),Ko=()=>{kn.removeEventListener("error",ds),ts.destroy(),kn.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},ds=()=>{this._webWorker||Ko()};kn.addEventListener("error",ds),ts.on("test",ru=>{if(kn.removeEventListener("error",ds),this.destroyed){Ko();return}ru?(this._messageHandler=ts,this._port=kn,this._webWorker=kn,this._readyCapability.resolve(),ts.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),ts.destroy(),kn.terminate())}),ts.on("ready",ru=>{if(kn.removeEventListener("error",ds),this.destroyed){Ko();return}try{Il()}catch{this._setupFakeWorker()}});const Il=()=>{const ru=new Uint8Array;ts.send("test",ru,[ru.buffer])};Il();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(es=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const kn=new LoopbackPort;this._port=kn;const ts=`fake${PDFWorkerUtil.fakeWorkerId++}`,Ko=new _message_handler.MessageHandler(ts+"_worker",ts,kn);es.setup(Ko,kn);const ds=new _message_handler.MessageHandler(ts,ts+"_worker",kn);this._messageHandler=ds,this._readyCapability.resolve(),ds.send("configure",{verbosity:this.verbosity})}).catch(es=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${es.message}".`))})}destroy(){var es;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(es=Sv(_PDFWorker,Bt))==null||es.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(es){var ts;if(!(es!=null&&es.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const kn=(ts=Sv(this,Bt))==null?void 0:ts.get(es.port);if(kn){if(kn._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return kn}return new _PDFWorker(es)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var es;try{return((es=globalThis.pdfjsWorker)==null?void 0:es.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};Bt=new WeakMap,G$(_PDFWorker,Bt);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(kn,ts,Ko,ds,Il){G$(this,zr);G$(this,Gt,new Map);G$(this,dr,new Map);G$(this,Mr,new Map);G$(this,Tr,null);this.messageHandler=kn,this.loadingTask=ts,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:ds.ownerDocument,styleElement:ds.styleElement}),this._params=ds,this.canvasFactory=Il.canvasFactory,this.filterFactory=Il.filterFactory,this.cMapReaderFactory=Il.cMapReaderFactory,this.standardFontDataFactory=Il.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=Ko,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(kn,ts=_util.AnnotationMode.ENABLE,Ko=null,ds=!1){let Il=_util.RenderingIntentFlag.DISPLAY,ru=_annotation_storage.SerializableEmpty;switch(kn){case"any":Il=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":Il=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${kn}`)}switch(ts){case _util.AnnotationMode.DISABLE:Il+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:Il+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:Il+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,ru=(Il&_util.RenderingIntentFlag.PRINT&&Ko instanceof _annotation_storage.PrintAnnotationStorage?Ko:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${ts}`)}return ds&&(Il+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:Il,cacheKey:`${Il}_${ru.hash}`,annotationStorageSerializable:ru}}destroy(){var Ko;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(Ko=Sv(this,Tr))==null||Ko.reject(new Error("Worker was destroyed during onPassword callback"));const kn=[];for(const ds of Sv(this,dr).values())kn.push(ds._destroy());Sv(this,dr).clear(),Sv(this,Mr).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const ts=this.messageHandler.sendWithPromise("Terminate",null);return kn.push(ts),Promise.all(kn).then(()=>{var ds;this.commonObjs.clear(),this.fontLoader.clear(),Sv(this,Gt).clear(),this.filterFactory.destroy(),(ds=this._networkStream)==null||ds.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:kn,loadingTask:ts}=this;kn.on("GetReader",(Ko,ds)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Il=>{this._lastProgress={loaded:Il.loaded,total:Il.total}},ds.onPull=()=>{this._fullReader.read().then(function({value:Il,done:ru}){if(ru){ds.close();return}(0,_util.assert)(Il instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),ds.enqueue(new Uint8Array(Il),1,[Il])}).catch(Il=>{ds.error(Il)})},ds.onCancel=Il=>{this._fullReader.cancel(Il),ds.ready.catch(ru=>{if(!this.destroyed)throw ru})}}),kn.on("ReaderHeadersReady",Ko=>{const ds=new _util.PromiseCapability,Il=this._fullReader;return Il.headersReady.then(()=>{var ru;(!Il.isStreamingSupported||!Il.isRangeSupported)&&(this._lastProgress&&((ru=ts.onProgress)==null||ru.call(ts,this._lastProgress)),Il.onProgress=uu=>{var p0;(p0=ts.onProgress)==null||p0.call(ts,{loaded:uu.loaded,total:uu.total})}),ds.resolve({isStreamingSupported:Il.isStreamingSupported,isRangeSupported:Il.isRangeSupported,contentLength:Il.contentLength})},ds.reject),ds.promise}),kn.on("GetRangeReader",(Ko,ds)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Il=this._networkStream.getRangeReader(Ko.begin,Ko.end);if(!Il){ds.close();return}ds.onPull=()=>{Il.read().then(function({value:ru,done:uu}){if(uu){ds.close();return}(0,_util.assert)(ru instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),ds.enqueue(new Uint8Array(ru),1,[ru])}).catch(ru=>{ds.error(ru)})},ds.onCancel=ru=>{Il.cancel(ru),ds.ready.catch(uu=>{if(!this.destroyed)throw uu})}}),kn.on("GetDoc",({pdfInfo:Ko})=>{this._numPages=Ko.numPages,this._htmlForXfa=Ko.htmlForXfa,delete Ko.htmlForXfa,ts._capability.resolve(new PDFDocumentProxy(Ko,this))}),kn.on("DocException",function(Ko){let ds;switch(Ko.name){case"PasswordException":ds=new _util.PasswordException(Ko.message,Ko.code);break;case"InvalidPDFException":ds=new _util.InvalidPDFException(Ko.message);break;case"MissingPDFException":ds=new _util.MissingPDFException(Ko.message);break;case"UnexpectedResponseException":ds=new _util.UnexpectedResponseException(Ko.message,Ko.status);break;case"UnknownErrorException":ds=new _util.UnknownErrorException(Ko.message,Ko.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}ts._capability.reject(ds)}),kn.on("PasswordRequest",Ko=>{if(K$(this,Tr,new _util.PromiseCapability),ts.onPassword){const ds=Il=>{Il instanceof Error?Sv(this,Tr).reject(Il):Sv(this,Tr).resolve({password:Il})};try{ts.onPassword(ds,Ko.code)}catch(Il){Sv(this,Tr).reject(Il)}}else Sv(this,Tr).reject(new _util.PasswordException(Ko.message,Ko.code));return Sv(this,Tr).promise}),kn.on("DataLoaded",Ko=>{var ds;(ds=ts.onProgress)==null||ds.call(ts,{loaded:Ko.length,total:Ko.length}),this.downloadInfoCapability.resolve(Ko)}),kn.on("StartRenderPage",Ko=>{if(this.destroyed)return;Sv(this,dr).get(Ko.pageIndex)._startRenderPage(Ko.transparency,Ko.cacheKey)}),kn.on("commonobj",([Ko,ds,Il])=>{var ru;if(!this.destroyed&&!this.commonObjs.has(Ko))switch(ds){case"Font":const uu=this._params;if("error"in Il){const q0=Il.error;(0,_util.warn)(`Error during font loading: ${q0}`),this.commonObjs.resolve(Ko,q0);break}const p0=uu.pdfBug&&((ru=globalThis.FontInspector)!=null&&ru.enabled)?(q0,W0)=>globalThis.FontInspector.fontAdded(q0,W0):null,X1=new _font_loader.FontFaceObject(Il,{isEvalSupported:uu.isEvalSupported,disableFontFace:uu.disableFontFace,ignoreErrors:uu.ignoreErrors,inspectFont:p0});this.fontLoader.bind(X1).catch(q0=>kn.sendWithPromise("FontFallback",{id:Ko})).finally(()=>{!uu.fontExtraProperties&&X1.data&&(X1.data=null),this.commonObjs.resolve(Ko,X1)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(Ko,Il);break;default:throw new Error(`Got unknown common object type ${ds}`)}}),kn.on("obj",([Ko,ds,Il,ru])=>{var p0;if(this.destroyed)return;const uu=Sv(this,dr).get(ds);if(!uu.objs.has(Ko))switch(Il){case"Image":if(uu.objs.resolve(Ko,ru),ru){let X1;if(ru.bitmap){const{width:q0,height:W0}=ru;X1=q0*W0*4}else X1=((p0=ru.data)==null?void 0:p0.length)||0;X1>_util.MAX_IMAGE_SIZE_TO_CACHE&&(uu._maybeCleanupAfterRender=!0)}break;case"Pattern":uu.objs.resolve(Ko,ru);break;default:throw new Error(`Got unknown object type ${Il}`)}}),kn.on("DocProgress",Ko=>{var ds;this.destroyed||(ds=ts.onProgress)==null||ds.call(ts,{loaded:Ko.loaded,total:Ko.total})}),kn.on("FetchBuiltInCMap",Ko=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(Ko):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),kn.on("FetchStandardFontData",Ko=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(Ko):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var Ko;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:kn,transfers:ts}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:kn,filename:((Ko=this._fullReader)==null?void 0:Ko.filename)??null},ts).finally(()=>{this.annotationStorage.resetModified()})}getPage(kn){if(!Number.isInteger(kn)||kn<=0||kn>this._numPages)return Promise.reject(new Error("Invalid page request."));const ts=kn-1,Ko=Sv(this,Mr).get(ts);if(Ko)return Ko;const ds=this.messageHandler.sendWithPromise("GetPage",{pageIndex:ts}).then(Il=>{if(this.destroyed)throw new Error("Transport destroyed");const ru=new PDFPageProxy(ts,Il,this,this._params.pdfBug);return Sv(this,dr).set(ts,ru),ru});return Sv(this,Mr).set(ts,ds),ds}getPageIndex(kn){return typeof kn!="object"||kn===null||!Number.isInteger(kn.num)||kn.num<0||!Number.isInteger(kn.gen)||kn.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:kn.num,gen:kn.gen})}getAnnotations(kn,ts){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:kn,intent:ts})}getFieldObjects(){return L$(this,zr,Ate).call(this,"GetFieldObjects")}hasJSActions(){return L$(this,zr,Ate).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(kn){return typeof kn!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:kn})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return L$(this,zr,Ate).call(this,"GetDocJSActions")}getPageJSActions(kn){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:kn})}getStructTree(kn){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:kn})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(kn=>new _optional_content_config.OptionalContentConfig(kn))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const kn="GetMetadata",ts=Sv(this,Gt).get(kn);if(ts)return ts;const Ko=this.messageHandler.sendWithPromise(kn,null).then(ds=>{var Il,ru;return{info:ds[0],metadata:ds[1]?new _metadata.Metadata(ds[1]):null,contentDispositionFilename:((Il=this._fullReader)==null?void 0:Il.filename)??null,contentLength:((ru=this._fullReader)==null?void 0:ru.contentLength)??null}});return Sv(this,Gt).set(kn,Ko),Ko}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(kn=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const ts of Sv(this,dr).values())if(!ts.cleanup())throw new Error(`startCleanup: Page ${ts.pageNumber} is currently rendering.`);this.commonObjs.clear(),kn||this.fontLoader.clear(),Sv(this,Gt).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:kn,enableXfa:ts}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:kn,enableXfa:ts})}}Gt=new WeakMap,dr=new WeakMap,Mr=new WeakMap,Tr=new WeakMap,zr=new WeakSet,Ate=function(kn,ts=null){const Ko=Sv(this,Gt).get(kn);if(Ko)return Ko;const ds=this.messageHandler.sendWithPromise(kn,ts);return Sv(this,Gt).set(kn,ds),ds};class PDFObjects{constructor(){G$(this,tn);G$(this,Nr,Object.create(null))}get(kn,ts=null){if(ts){const ds=L$(this,tn,Kte).call(this,kn);return ds.capability.promise.then(()=>ts(ds.data)),null}const Ko=Sv(this,Nr)[kn];if(!(Ko!=null&&Ko.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${kn}.`);return Ko.data}has(kn){const ts=Sv(this,Nr)[kn];return(ts==null?void 0:ts.capability.settled)||!1}resolve(kn,ts=null){const Ko=L$(this,tn,Kte).call(this,kn);Ko.data=ts,Ko.capability.resolve()}clear(){var kn;for(const ts in Sv(this,Nr)){const{data:Ko}=Sv(this,Nr)[ts];(kn=Ko==null?void 0:Ko.bitmap)==null||kn.close()}K$(this,Nr,Object.create(null))}}Nr=new WeakMap,tn=new WeakSet,Kte=function(kn){var ts;return(ts=Sv(this,Nr))[kn]||(ts[kn]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(kn){G$(this,Tn,null);K$(this,Tn,kn),this.onContinue=null}get promise(){return Sv(this,Tn).capability.promise}cancel(kn=0){Sv(this,Tn).cancel(null,kn)}get separateAnnots(){const{separateAnnots:kn}=Sv(this,Tn).operatorList;if(!kn)return!1;const{annotationCanvasMap:ts}=Sv(this,Tn);return kn.form||kn.canvas&&(ts==null?void 0:ts.size)>0}}Tn=new WeakMap,exports.RenderTask=RenderTask;const un=class un{constructor({callback:kn,params:ts,objs:Ko,commonObjs:ds,annotationCanvasMap:Il,operatorList:ru,pageIndex:uu,canvasFactory:p0,filterFactory:X1,useRequestAnimationFrame:q0=!1,pdfBug:W0=!1,pageColors:hu=null}){this.callback=kn,this.params=ts,this.objs=Ko,this.commonObjs=ds,this.annotationCanvasMap=Il,this.operatorListIdx=null,this.operatorList=ru,this._pageIndex=uu,this.canvasFactory=p0,this.filterFactory=X1,this._pdfBug=W0,this.pageColors=hu,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=q0===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=ts.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:kn=!1,optionalContentConfig:ts}){var uu,p0;if(this.cancelled)return;if(this._canvas){if(Sv(un,$n).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Sv(un,$n).add(this._canvas)}this._pdfBug&&((uu=globalThis.StepperManager)!=null&&uu.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:Ko,viewport:ds,transform:Il,background:ru}=this.params;this.gfx=new _canvas.CanvasGraphics(Ko,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:ts},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Il,viewport:ds,transparency:kn,background:ru}),this.operatorListIdx=0,this.graphicsReady=!0,(p0=this.graphicsReadyCallback)==null||p0.call(this)}cancel(kn=null,ts=0){var Ko;this.running=!1,this.cancelled=!0,(Ko=this.gfx)==null||Ko.endDrawing(),Sv(un,$n).delete(this._canvas),this.callback(kn||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,ts))}operatorListChanged(){var kn;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(kn=this.stepper)==null||kn.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Sv(un,$n).delete(this._canvas),this.callback())))}};$n=new WeakMap,G$(un,$n,new WeakSet);let InternalRenderTask=un;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(nt,st,mt)=>{var Nt,Bt,Gt,Gie,Mr;Object.defineProperty(st,"__esModule",{value:!0}),st.SerializableEmpty=st.PrintAnnotationStorage=st.AnnotationStorage=void 0;var gt=mt(1),_t=mt(4),Et=mt(8);const At=Object.freeze({map:null,hash:"",transfers:void 0});st.SerializableEmpty=At;class Rt{constructor(){G$(this,Gt);G$(this,Nt,!1);G$(this,Bt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(zr,Fr){const Nr=Sv(this,Bt).get(zr);return Nr===void 0?Fr:Object.assign(Fr,Nr)}getRawValue(zr){return Sv(this,Bt).get(zr)}remove(zr){if(Sv(this,Bt).delete(zr),Sv(this,Bt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const Fr of Sv(this,Bt).values())if(Fr instanceof _t.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(zr,Fr){const Nr=Sv(this,Bt).get(zr);let tn=!1;if(Nr!==void 0)for(const[rn,Tn]of Object.entries(Fr))Nr[rn]!==Tn&&(tn=!0,Nr[rn]=Tn);else tn=!0,Sv(this,Bt).set(zr,Fr);tn&&L$(this,Gt,Gie).call(this),Fr instanceof _t.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(Fr.constructor._type)}has(zr){return Sv(this,Bt).has(zr)}getAll(){return Sv(this,Bt).size>0?(0,gt.objectFromMap)(Sv(this,Bt)):null}setAll(zr){for(const[Fr,Nr]of Object.entries(zr))this.setValue(Fr,Nr)}get size(){return Sv(this,Bt).size}resetModified(){Sv(this,Nt)&&(K$(this,Nt,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Ft(this)}get serializable(){if(Sv(this,Bt).size===0)return At;const zr=new Map,Fr=new Et.MurmurHash3_64,Nr=[],tn=Object.create(null);let rn=!1;for(const[Tn,$n]of Sv(this,Bt)){const un=$n instanceof _t.AnnotationEditor?$n.serialize(!1,tn):$n;un&&(zr.set(Tn,un),Fr.update(`${Tn}:${JSON.stringify(un)}`),rn||(rn=!!un.bitmap))}if(rn)for(const Tn of zr.values())Tn.bitmap&&Nr.push(Tn.bitmap);return zr.size>0?{map:zr,hash:Fr.hexdigest(),transfers:Nr}:At}}Nt=new WeakMap,Bt=new WeakMap,Gt=new WeakSet,Gie=function(){Sv(this,Nt)||(K$(this,Nt,!0),typeof this.onSetModified=="function"&&this.onSetModified())},st.AnnotationStorage=Rt;class Ft extends Rt{constructor(Fr){super();G$(this,Mr);const{map:Nr,hash:tn,transfers:rn}=Fr.serializable,Tn=structuredClone(Nr,rn?{transfer:rn}:null);K$(this,Mr,{map:Tn,hash:tn,transfers:rn})}get print(){(0,gt.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return Sv(this,Mr)}}Mr=new WeakMap,st.PrintAnnotationStorage=Ft},(nt,st,mt)=>{var Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr,Nr,tn,rn,Tn,$n,un,Qte,Zte,ts,Jte,eie,qie,Xie,Yie,tie,Kie;Object.defineProperty(st,"__esModule",{value:!0}),st.AnnotationEditor=void 0;var gt=mt(5),_t=mt(1),Et=mt(6);const q0=class q0{constructor(hu){G$(this,un);G$(this,Ft,"");G$(this,Nt,!1);G$(this,Bt,null);G$(this,Gt,null);G$(this,dr,null);G$(this,Mr,!1);G$(this,Tr,null);G$(this,zr,this.focusin.bind(this));G$(this,Fr,this.focusout.bind(this));G$(this,Nr,!1);G$(this,tn,!1);G$(this,rn,!1);lee(this,"_initialOptions",Object.create(null));lee(this,"_uiManager",null);lee(this,"_focusEventsAllowed",!0);lee(this,"_l10nPromise",null);G$(this,Tn,!1);G$(this,$n,q0._zIndex++);this.constructor===q0&&(0,_t.unreachable)("Cannot initialize AnnotationEditor."),this.parent=hu.parent,this.id=hu.id,this.width=this.height=null,this.pageIndex=hu.parent.pageIndex,this.name=hu.name,this.div=null,this._uiManager=hu.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=hu.isCentered,this._structTreeParentId=null;const{rotation:a1,rawDims:{pageWidth:Vx,pageHeight:t0,pageX:cu,pageY:lu}}=this.parent.viewport;this.rotation=a1,this.pageRotation=(360+a1-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Vx,t0],this.pageTranslation=[cu,lu];const[b0,l1]=this.parentDimensions;this.x=hu.x/b0,this.y=hu.y/l1,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,_t.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(hu){const a1=new Rt({id:hu.parent.getNextId(),parent:hu.parent,uiManager:hu._uiManager});a1.annotationElementId=hu.annotationElementId,a1.deleted=!0,a1._uiManager.addToAnnotationStorage(a1)}static initialize(hu,a1=null){if(q0._l10nPromise||(q0._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(t0=>[t0,hu.get(t0)]))),a1!=null&&a1.strings)for(const t0 of a1.strings)q0._l10nPromise.set(t0,hu.get(t0));if(q0._borderLineWidth!==-1)return;const Vx=getComputedStyle(document.documentElement);q0._borderLineWidth=parseFloat(Vx.getPropertyValue("--outline-width"))||0}static updateDefaultParams(hu,a1){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(hu){return!1}static paste(hu,a1){(0,_t.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return Sv(this,Tn)}set _isDraggable(hu){var a1;K$(this,Tn,hu),(a1=this.div)==null||a1.classList.toggle("draggable",hu)}center(){const[hu,a1]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*a1/(hu*2),this.y+=this.width*hu/(a1*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*a1/(hu*2),this.y-=this.width*hu/(a1*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(hu){this._uiManager.addCommands(hu)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=Sv(this,$n)}setParent(hu){hu!==null&&(this.pageIndex=hu.pageIndex,this.pageDimensions=hu.pageDimensions),this.parent=hu}focusin(hu){this._focusEventsAllowed&&(Sv(this,Nr)?K$(this,Nr,!1):this.parent.setSelected(this))}focusout(hu){var Vx;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const a1=hu.relatedTarget;a1!=null&&a1.closest(`#${this.id}`)||(hu.preventDefault(),(Vx=this.parent)!=null&&Vx.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(hu,a1,Vx,t0){const[cu,lu]=this.parentDimensions;[Vx,t0]=this.screenToPageTranslation(Vx,t0),this.x=(hu+Vx)/cu,this.y=(a1+t0)/lu,this.fixAndSetPosition()}translate(hu,a1){L$(this,un,Qte).call(this,this.parentDimensions,hu,a1)}translateInPage(hu,a1){L$(this,un,Qte).call(this,this.pageDimensions,hu,a1),this.div.scrollIntoView({block:"nearest"})}drag(hu,a1){const[Vx,t0]=this.parentDimensions;if(this.x+=hu/Vx,this.y+=a1/t0,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:LE,y:eS}=this.div.getBoundingClientRect();this.parent.findNewParent(this,LE,eS)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:cu,y:lu}=this;const[b0,l1]=L$(this,un,Zte).call(this);cu+=b0,lu+=l1,this.div.style.left=`${(100*cu).toFixed(2)}%`,this.div.style.top=`${(100*lu).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[hu,a1]=this.pageDimensions;let{x:Vx,y:t0,width:cu,height:lu}=this;switch(cu*=hu,lu*=a1,Vx*=hu,t0*=a1,this.rotation){case 0:Vx=Math.max(0,Math.min(hu-cu,Vx)),t0=Math.max(0,Math.min(a1-lu,t0));break;case 90:Vx=Math.max(0,Math.min(hu-lu,Vx)),t0=Math.min(a1,Math.max(cu,t0));break;case 180:Vx=Math.min(hu,Math.max(cu,Vx)),t0=Math.min(a1,Math.max(lu,t0));break;case 270:Vx=Math.min(hu,Math.max(lu,Vx)),t0=Math.max(0,Math.min(a1-cu,t0));break}this.x=Vx/=hu,this.y=t0/=a1;const[b0,l1]=L$(this,un,Zte).call(this);Vx+=b0,t0+=l1;const{style:LE}=this.div;LE.left=`${(100*Vx).toFixed(2)}%`,LE.top=`${(100*t0).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(hu,a1){var Vx;return L$(Vx=q0,ts,Jte).call(Vx,hu,a1,this.parentRotation)}pageTranslationToScreen(hu,a1){var Vx;return L$(Vx=q0,ts,Jte).call(Vx,hu,a1,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:hu,pageDimensions:[a1,Vx]}=this,t0=a1*hu,cu=Vx*hu;return _t.FeatureTest.isCSSRoundSupported?[Math.round(t0),Math.round(cu)]:[t0,cu]}setDims(hu,a1){var cu;const[Vx,t0]=this.parentDimensions;this.div.style.width=`${(100*hu/Vx).toFixed(2)}%`,Sv(this,Mr)||(this.div.style.height=`${(100*a1/t0).toFixed(2)}%`),(cu=Sv(this,Bt))==null||cu.classList.toggle("small",hu<q0.SMALL_EDITOR_SIZE||a1<q0.SMALL_EDITOR_SIZE)}fixDims(){const{style:hu}=this.div,{height:a1,width:Vx}=hu,t0=Vx.endsWith("%"),cu=!Sv(this,Mr)&&a1.endsWith("%");if(t0&&cu)return;const[lu,b0]=this.parentDimensions;t0||(hu.width=`${(100*parseFloat(Vx)/lu).toFixed(2)}%`),!Sv(this,Mr)&&!cu&&(hu.height=`${(100*parseFloat(a1)/b0).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(Sv(this,Bt))return;const hu=K$(this,Bt,document.createElement("button"));hu.className="altText";const a1=await q0._l10nPromise.get("editor_alt_text_button_label");hu.textContent=a1,hu.setAttribute("aria-label",a1),hu.tabIndex="0",hu.addEventListener("contextmenu",Et.noContextMenu),hu.addEventListener("pointerdown",Vx=>Vx.stopPropagation()),hu.addEventListener("click",Vx=>{Vx.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),hu.addEventListener("keydown",Vx=>{Vx.target===hu&&Vx.key==="Enter"&&(Vx.preventDefault(),this._uiManager.editAltText(this))}),L$(this,un,tie).call(this),this.div.append(hu),q0.SMALL_EDITOR_SIZE||(q0.SMALL_EDITOR_SIZE=Math.min(128,Math.round(hu.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:Sv(this,Ft),decorative:Sv(this,Nt)}}set altTextData({altText:hu,decorative:a1}){Sv(this,Ft)===hu&&Sv(this,Nt)===a1||(K$(this,Ft,hu),K$(this,Nt,a1),L$(this,un,tie).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",Sv(this,zr)),this.div.addEventListener("focusout",Sv(this,Fr));const[hu,a1]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*a1/hu).toFixed(2)}%`,this.div.style.maxHeight=`${(100*hu/a1).toFixed(2)}%`);const[Vx,t0]=this.getInitialTranslation();return this.translate(Vx,t0),(0,gt.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(hu){const{isMac:a1}=_t.FeatureTest.platform;if(hu.button!==0||hu.ctrlKey&&a1){hu.preventDefault();return}K$(this,Nr,!0),L$(this,un,Kie).call(this,hu)}moveInDOM(){var hu;(hu=this.parent)==null||hu.moveEditorInDOM(this)}_setParentAndPosition(hu,a1,Vx){hu.changeParent(this),this.x=a1,this.y=Vx,this.fixAndSetPosition()}getRect(hu,a1){const Vx=this.parentScale,[t0,cu]=this.pageDimensions,[lu,b0]=this.pageTranslation,l1=hu/Vx,LE=a1/Vx,eS=this.x*t0,SA=this.y*cu,o$=this.width*t0,h$=this.height*cu;switch(this.rotation){case 0:return[eS+l1+lu,cu-SA-LE-h$+b0,eS+l1+o$+lu,cu-SA-LE+b0];case 90:return[eS+LE+lu,cu-SA+l1+b0,eS+LE+h$+lu,cu-SA+l1+o$+b0];case 180:return[eS-l1-o$+lu,cu-SA+LE+b0,eS-l1+lu,cu-SA+LE+h$+b0];case 270:return[eS-LE-h$+lu,cu-SA-l1-o$+b0,eS-LE+lu,cu-SA-l1+b0];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(hu,a1){const[Vx,t0,cu,lu]=hu,b0=cu-Vx,l1=lu-t0;switch(this.rotation){case 0:return[Vx,a1-lu,b0,l1];case 90:return[Vx,a1-t0,l1,b0];case 180:return[cu,a1-t0,b0,l1];case 270:return[cu,a1-lu,l1,b0];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){K$(this,rn,!0)}disableEditMode(){K$(this,rn,!1)}isInEditMode(){return Sv(this,rn)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var hu,a1;(hu=this.div)==null||hu.addEventListener("focusin",Sv(this,zr)),(a1=this.div)==null||a1.addEventListener("focusout",Sv(this,Fr))}serialize(hu=!1,a1=null){(0,_t.unreachable)("An editor must be serializable")}static deserialize(hu,a1,Vx){const t0=new this.prototype.constructor({parent:a1,id:a1.getNextId(),uiManager:Vx});t0.rotation=hu.rotation;const[cu,lu]=t0.pageDimensions,[b0,l1,LE,eS]=t0.getRectInCurrentCoords(hu.rect,lu);return t0.x=b0/cu,t0.y=l1/lu,t0.width=LE/cu,t0.height=eS/lu,t0}remove(){var hu;this.div.removeEventListener("focusin",Sv(this,zr)),this.div.removeEventListener("focusout",Sv(this,Fr)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(hu=Sv(this,Bt))==null||hu.remove(),K$(this,Bt,null),K$(this,Gt,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(L$(this,un,qie).call(this),Sv(this,Tr).classList.remove("hidden"))}select(){var hu;this.makeResizable(),(hu=this.div)==null||hu.classList.add("selectedEditor")}unselect(){var hu,a1,Vx;(hu=Sv(this,Tr))==null||hu.classList.add("hidden"),(a1=this.div)==null||a1.classList.remove("selectedEditor"),(Vx=this.div)!=null&&Vx.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(hu,a1){}disableEditing(){Sv(this,Bt)&&(Sv(this,Bt).hidden=!0)}enableEditing(){Sv(this,Bt)&&(Sv(this,Bt).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return Sv(this,tn)}set isEditing(hu){K$(this,tn,hu),this.parent&&(hu?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(hu,a1){K$(this,Mr,!0);const Vx=hu/a1,{style:t0}=this.div;t0.aspectRatio=Vx,t0.height="auto"}static get MIN_SIZE(){return 16}};Ft=new WeakMap,Nt=new WeakMap,Bt=new WeakMap,Gt=new WeakMap,dr=new WeakMap,Mr=new WeakMap,Tr=new WeakMap,zr=new WeakMap,Fr=new WeakMap,Nr=new WeakMap,tn=new WeakMap,rn=new WeakMap,Tn=new WeakMap,$n=new WeakMap,un=new WeakSet,Qte=function([hu,a1],Vx,t0){[Vx,t0]=this.screenToPageTranslation(Vx,t0),this.x+=Vx/hu,this.y+=t0/a1,this.fixAndSetPosition()},Zte=function(){const[hu,a1]=this.parentDimensions,{_borderLineWidth:Vx}=q0,t0=Vx/hu,cu=Vx/a1;switch(this.rotation){case 90:return[-t0,cu];case 180:return[t0,cu];case 270:return[t0,-cu];default:return[-t0,-cu]}},ts=new WeakSet,Jte=function(hu,a1,Vx){switch(Vx){case 90:return[a1,-hu];case 180:return[-hu,-a1];case 270:return[-a1,hu];default:return[hu,a1]}},eie=function(hu){switch(hu){case 90:{const[a1,Vx]=this.pageDimensions;return[0,-a1/Vx,Vx/a1,0]}case 180:return[-1,0,0,-1];case 270:{const[a1,Vx]=this.pageDimensions;return[0,a1/Vx,-Vx/a1,0]}default:return[1,0,0,1]}},qie=function(){if(Sv(this,Tr))return;K$(this,Tr,document.createElement("div")),Sv(this,Tr).classList.add("resizers");const hu=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||hu.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const a1 of hu){const Vx=document.createElement("div");Sv(this,Tr).append(Vx),Vx.classList.add("resizer",a1),Vx.addEventListener("pointerdown",L$(this,un,Xie).bind(this,a1)),Vx.addEventListener("contextmenu",Et.noContextMenu)}this.div.prepend(Sv(this,Tr))},Xie=function(hu,a1){a1.preventDefault();const{isMac:Vx}=_t.FeatureTest.platform;if(a1.button!==0||a1.ctrlKey&&Vx)return;const t0=L$(this,un,Yie).bind(this,hu),cu=this._isDraggable;this._isDraggable=!1;const lu={passive:!0,capture:!0};window.addEventListener("pointermove",t0,lu);const b0=this.x,l1=this.y,LE=this.width,eS=this.height,SA=this.parent.div.style.cursor,o$=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(a1.target).cursor;const h$=()=>{this._isDraggable=cu,window.removeEventListener("pointerup",h$),window.removeEventListener("blur",h$),window.removeEventListener("pointermove",t0,lu),this.parent.div.style.cursor=SA,this.div.style.cursor=o$;const d$=this.x,y$=this.y,R$=this.width,M$=this.height;d$===b0&&y$===l1&&R$===LE&&M$===eS||this.addCommands({cmd:()=>{this.width=R$,this.height=M$,this.x=d$,this.y=y$;const[x$,v$]=this.parentDimensions;this.setDims(x$*R$,v$*M$),this.fixAndSetPosition()},undo:()=>{this.width=LE,this.height=eS,this.x=b0,this.y=l1;const[x$,v$]=this.parentDimensions;this.setDims(x$*LE,v$*eS),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",h$),window.addEventListener("blur",h$)},Yie=function(hu,a1){const[Vx,t0]=this.parentDimensions,cu=this.x,lu=this.y,b0=this.width,l1=this.height,LE=q0.MIN_SIZE/Vx,eS=q0.MIN_SIZE/t0,SA=J$=>Math.round(J$*1e4)/1e4,o$=L$(this,un,eie).call(this,this.rotation),h$=(J$,gD)=>[o$[0]*J$+o$[2]*gD,o$[1]*J$+o$[3]*gD],d$=L$(this,un,eie).call(this,360-this.rotation),y$=(J$,gD)=>[d$[0]*J$+d$[2]*gD,d$[1]*J$+d$[3]*gD];let R$,M$,x$=!1,v$=!1;switch(hu){case"topLeft":x$=!0,R$=(J$,gD)=>[0,0],M$=(J$,gD)=>[J$,gD];break;case"topMiddle":R$=(J$,gD)=>[J$/2,0],M$=(J$,gD)=>[J$/2,gD];break;case"topRight":x$=!0,R$=(J$,gD)=>[J$,0],M$=(J$,gD)=>[0,gD];break;case"middleRight":v$=!0,R$=(J$,gD)=>[J$,gD/2],M$=(J$,gD)=>[0,gD/2];break;case"bottomRight":x$=!0,R$=(J$,gD)=>[J$,gD],M$=(J$,gD)=>[0,0];break;case"bottomMiddle":R$=(J$,gD)=>[J$/2,gD],M$=(J$,gD)=>[J$/2,0];break;case"bottomLeft":x$=!0,R$=(J$,gD)=>[0,gD],M$=(J$,gD)=>[J$,0];break;case"middleLeft":v$=!0,R$=(J$,gD)=>[0,gD/2],M$=(J$,gD)=>[J$,gD/2];break}const rS=R$(b0,l1),wA=M$(b0,l1);let g$=h$(...wA);const S$=SA(cu+g$[0]),tA=SA(lu+g$[1]);let tS=1,m$=1,[u$,UE]=this.screenToPageTranslation(a1.movementX,a1.movementY);if([u$,UE]=y$(u$/Vx,UE/t0),x$){const J$=Math.hypot(b0,l1);tS=m$=Math.max(Math.min(Math.hypot(wA[0]-rS[0]-u$,wA[1]-rS[1]-UE)/J$,1/b0,1/l1),LE/b0,eS/l1)}else v$?tS=Math.max(LE,Math.min(1,Math.abs(wA[0]-rS[0]-u$)))/b0:m$=Math.max(eS,Math.min(1,Math.abs(wA[1]-rS[1]-UE)))/l1;const F$=SA(b0*tS),EI=SA(l1*m$);g$=h$(...M$(F$,EI));const pR=S$-g$[0],X$=tA-g$[1];this.width=F$,this.height=EI,this.x=pR,this.y=X$,this.setDims(Vx*F$,t0*EI),this.fixAndSetPosition()},tie=async function(){var Vx;const hu=Sv(this,Bt);if(!hu)return;if(!Sv(this,Ft)&&!Sv(this,Nt)){hu.classList.remove("done"),(Vx=Sv(this,Gt))==null||Vx.remove();return}q0._l10nPromise.get("editor_alt_text_edit_button_label").then(t0=>{hu.setAttribute("aria-label",t0)});let a1=Sv(this,Gt);if(!a1){K$(this,Gt,a1=document.createElement("span")),a1.className="tooltip",a1.setAttribute("role","tooltip");const t0=a1.id=`alt-text-tooltip-${this.id}`;hu.setAttribute("aria-describedby",t0);const cu=100;hu.addEventListener("mouseenter",()=>{K$(this,dr,setTimeout(()=>{K$(this,dr,null),Sv(this,Gt).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},cu))}),hu.addEventListener("mouseleave",()=>{var lu;clearTimeout(Sv(this,dr)),K$(this,dr,null),(lu=Sv(this,Gt))==null||lu.classList.remove("show")})}hu.classList.add("done"),a1.innerText=Sv(this,Nt)?await q0._l10nPromise.get("editor_alt_text_decorative_tooltip"):Sv(this,Ft),a1.parentNode||hu.append(a1)},Kie=function(hu){if(!this._isDraggable)return;const a1=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Vx,t0;a1&&(Vx={passive:!0,capture:!0},t0=lu=>{const[b0,l1]=this.screenToPageTranslation(lu.movementX,lu.movementY);this._uiManager.dragSelectedEditors(b0,l1)},window.addEventListener("pointermove",t0,Vx));const cu=()=>{if(window.removeEventListener("pointerup",cu),window.removeEventListener("blur",cu),a1&&window.removeEventListener("pointermove",t0,Vx),K$(this,Nr,!1),!this._uiManager.endDragSession()){const{isMac:lu}=_t.FeatureTest.platform;hu.ctrlKey&&!lu||hu.shiftKey||hu.metaKey&&lu?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",cu),window.addEventListener("blur",cu)},G$(q0,ts),lee(q0,"_borderLineWidth",-1),lee(q0,"_colorManager",new gt.ColorManager),lee(q0,"_zIndex",1),lee(q0,"SMALL_EDITOR_SIZE",0);let At=q0;st.AnnotationEditor=At;class Rt extends At{constructor(hu){super(hu),this.annotationElementId=hu.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(nt,st,mt)=>{var Mr,Tr,zr,Fr,Nr,iie,Tn,$n,un,es,kn,Qie,ds,Il,ru,uu,p0,X1,q0,W0,hu,a1,Vx,t0,cu,lu,b0,l1,LE,eS,SA,o$,h$,d$,y$,R$,M$,x$,v$,rS,wA,g$,S$,tA,tS,m$,u$,Zie,rie,nie,Cte,aie,sie,Iee,dte,Jie,ere,oie,pte,lie;Object.defineProperty(st,"__esModule",{value:!0}),st.KeyboardManager=st.CommandManager=st.ColorManager=st.AnnotationEditorUIManager=void 0,st.bindEvents=Et,st.opacityToHex=At;var gt=mt(1),_t=mt(6);function Et(B$,r$,O$){for(const Z$ of O$)r$.addEventListener(Z$,B$[Z$].bind(B$))}function At(B$){return Math.round(Math.min(255,Math.max(1,255*B$))).toString(16).padStart(2,"0")}class Rt{constructor(){G$(this,Mr,0)}getId(){return`${gt.AnnotationEditorPrefix}${hte(this,Mr)._++}`}}Mr=new WeakMap;const rn=class rn{constructor(){G$(this,Nr);G$(this,Tr,(0,gt.getUuid)());G$(this,zr,0);G$(this,Fr,null)}static get _isSVGFittingCanvas(){const r$='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Z$=new OffscreenCanvas(1,3).getContext("2d"),mL=new Image;mL.src=r$;const P7=mL.decode().then(()=>(Z$.drawImage(mL,0,0,1,1,0,0,1,3),new Uint32Array(Z$.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,gt.shadow)(this,"_isSVGFittingCanvas",P7)}async getFromFile(r$){const{lastModified:O$,name:Z$,size:mL,type:P7}=r$;return L$(this,Nr,iie).call(this,`${O$}_${Z$}_${mL}_${P7}`,r$)}async getFromUrl(r$){return L$(this,Nr,iie).call(this,r$,r$)}async getFromId(r$){Sv(this,Fr)||K$(this,Fr,new Map);const O$=Sv(this,Fr).get(r$);return O$?O$.bitmap?(O$.refCounter+=1,O$):O$.file?this.getFromFile(O$.file):this.getFromUrl(O$.url):null}getSvgUrl(r$){const O$=Sv(this,Fr).get(r$);return O$!=null&&O$.isSvg?O$.svgUrl:null}deleteId(r$){Sv(this,Fr)||K$(this,Fr,new Map);const O$=Sv(this,Fr).get(r$);O$&&(O$.refCounter-=1,O$.refCounter===0&&(O$.bitmap=null))}isValidId(r$){return r$.startsWith(`image_${Sv(this,Tr)}_`)}};Tr=new WeakMap,zr=new WeakMap,Fr=new WeakMap,Nr=new WeakSet,iie=async function(r$,O$){Sv(this,Fr)||K$(this,Fr,new Map);let Z$=Sv(this,Fr).get(r$);if(Z$===null)return null;if(Z$!=null&&Z$.bitmap)return Z$.refCounter+=1,Z$;try{Z$||(Z$={bitmap:null,id:`image_${Sv(this,Tr)}_${hte(this,zr)._++}`,refCounter:0,isSvg:!1});let mL;if(typeof O$=="string"){Z$.url=O$;const P7=await fetch(O$);if(!P7.ok)throw new Error(P7.statusText);mL=await P7.blob()}else mL=Z$.file=O$;if(mL.type==="image/svg+xml"){const P7=rn._isSVGFittingCanvas,L9=new FileReader,f$=new Image,l$=new Promise((T$,q$)=>{f$.onload=()=>{Z$.bitmap=f$,Z$.isSvg=!0,T$()},L9.onload=async()=>{const Q$=Z$.svgUrl=L9.result;f$.src=await P7?`${Q$}#svgView(preserveAspectRatio(none))`:Q$},f$.onerror=L9.onerror=q$});L9.readAsDataURL(mL),await l$}else Z$.bitmap=await createImageBitmap(mL);Z$.refCounter=1}catch(mL){console.error(mL),Z$=null}return Sv(this,Fr).set(r$,Z$),Z$&&Sv(this,Fr).set(Z$.id,Z$),Z$};let Ft=rn;class Nt{constructor(r$=128){G$(this,Tn,[]);G$(this,$n,!1);G$(this,un);G$(this,es,-1);K$(this,un,r$)}add({cmd:r$,undo:O$,mustExec:Z$,type:mL=NaN,overwriteIfSameType:P7=!1,keepUndo:L9=!1}){if(Z$&&r$(),Sv(this,$n))return;const f$={cmd:r$,undo:O$,type:mL};if(Sv(this,es)===-1){Sv(this,Tn).length>0&&(Sv(this,Tn).length=0),K$(this,es,0),Sv(this,Tn).push(f$);return}if(P7&&Sv(this,Tn)[Sv(this,es)].type===mL){L9&&(f$.undo=Sv(this,Tn)[Sv(this,es)].undo),Sv(this,Tn)[Sv(this,es)]=f$;return}const l$=Sv(this,es)+1;l$===Sv(this,un)?Sv(this,Tn).splice(0,1):(K$(this,es,l$),l$<Sv(this,Tn).length&&Sv(this,Tn).splice(l$)),Sv(this,Tn).push(f$)}undo(){Sv(this,es)!==-1&&(K$(this,$n,!0),Sv(this,Tn)[Sv(this,es)].undo(),K$(this,$n,!1),K$(this,es,Sv(this,es)-1))}redo(){Sv(this,es)<Sv(this,Tn).length-1&&(K$(this,es,Sv(this,es)+1),K$(this,$n,!0),Sv(this,Tn)[Sv(this,es)].cmd(),K$(this,$n,!1))}hasSomethingToUndo(){return Sv(this,es)!==-1}hasSomethingToRedo(){return Sv(this,es)<Sv(this,Tn).length-1}destroy(){K$(this,Tn,null)}}Tn=new WeakMap,$n=new WeakMap,un=new WeakMap,es=new WeakMap,st.CommandManager=Nt;class Bt{constructor(r$){G$(this,kn);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:O$}=gt.FeatureTest.platform;for(const[Z$,mL,P7={}]of r$)for(const L9 of Z$){const f$=L9.startsWith("mac+");O$&&f$?(this.callbacks.set(L9.slice(4),{callback:mL,options:P7}),this.allKeys.add(L9.split("+").at(-1))):!O$&&!f$&&(this.callbacks.set(L9,{callback:mL,options:P7}),this.allKeys.add(L9.split("+").at(-1)))}}exec(r$,O$){if(!this.allKeys.has(O$.key))return;const Z$=this.callbacks.get(L$(this,kn,Qie).call(this,O$));if(!Z$)return;const{callback:mL,options:{bubbles:P7=!1,args:L9=[],checker:f$=null}}=Z$;f$&&!f$(r$,O$)||(mL.bind(r$,...L9)(),P7||(O$.stopPropagation(),O$.preventDefault()))}}kn=new WeakSet,Qie=function(r$){r$.altKey&&this.buffer.push("alt"),r$.ctrlKey&&this.buffer.push("ctrl"),r$.metaKey&&this.buffer.push("meta"),r$.shiftKey&&this.buffer.push("shift"),this.buffer.push(r$.key);const O$=this.buffer.join("+");return this.buffer.length=0,O$},st.KeyboardManager=Bt;const Ko=class Ko{get _colors(){const r$=new Map([["CanvasText",null],["Canvas",null]]);return(0,_t.getColorValues)(r$),(0,gt.shadow)(this,"_colors",r$)}convert(r$){const O$=(0,_t.getRGB)(r$);if(!window.matchMedia("(forced-colors: active)").matches)return O$;for(const[Z$,mL]of this._colors)if(mL.every((P7,L9)=>P7===O$[L9]))return Ko._colorsMapping.get(Z$);return O$}getHexCode(r$){const O$=this._colors.get(r$);return O$?gt.Util.makeHexColor(...O$):r$}};lee(Ko,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Gt=Ko;st.ColorManager=Gt;const w$=class w${constructor(r$,O$,Z$,mL,P7,L9){G$(this,u$);G$(this,ds,null);G$(this,Il,new Map);G$(this,ru,new Map);G$(this,uu,null);G$(this,p0,null);G$(this,X1,new Nt);G$(this,q0,0);G$(this,W0,new Set);G$(this,hu,null);G$(this,a1,null);G$(this,Vx,new Set);G$(this,t0,null);G$(this,cu,new Rt);G$(this,lu,!1);G$(this,b0,!1);G$(this,l1,null);G$(this,LE,gt.AnnotationEditorType.NONE);G$(this,eS,new Set);G$(this,SA,null);G$(this,o$,this.blur.bind(this));G$(this,h$,this.focus.bind(this));G$(this,d$,this.copy.bind(this));G$(this,y$,this.cut.bind(this));G$(this,R$,this.paste.bind(this));G$(this,M$,this.keydown.bind(this));G$(this,x$,this.onEditingAction.bind(this));G$(this,v$,this.onPageChanging.bind(this));G$(this,rS,this.onScaleChanging.bind(this));G$(this,wA,this.onRotationChanging.bind(this));G$(this,g$,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});G$(this,S$,[0,0]);G$(this,tA,null);G$(this,tS,null);G$(this,m$,null);K$(this,tS,r$),K$(this,m$,O$),K$(this,uu,Z$),this._eventBus=mL,this._eventBus._on("editingaction",Sv(this,x$)),this._eventBus._on("pagechanging",Sv(this,v$)),this._eventBus._on("scalechanging",Sv(this,rS)),this._eventBus._on("rotationchanging",Sv(this,wA)),K$(this,p0,P7.annotationStorage),K$(this,t0,P7.filterFactory),K$(this,SA,L9),this.viewParameters={realScale:_t.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const r$=w$.prototype,O$=P7=>{const{activeElement:L9}=document;return L9&&Sv(P7,tS).contains(L9)&&P7.hasSomethingToControl()},Z$=this.TRANSLATE_SMALL,mL=this.TRANSLATE_BIG;return(0,gt.shadow)(this,"_keyboardManager",new Bt([[["ctrl+a","mac+meta+a"],r$.selectAll],[["ctrl+z","mac+meta+z"],r$.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],r$.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],r$.delete],[["Escape","mac+Escape"],r$.unselectAll],[["ArrowLeft","mac+ArrowLeft"],r$.translateSelectedEditors,{args:[-Z$,0],checker:O$}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],r$.translateSelectedEditors,{args:[-mL,0],checker:O$}],[["ArrowRight","mac+ArrowRight"],r$.translateSelectedEditors,{args:[Z$,0],checker:O$}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],r$.translateSelectedEditors,{args:[mL,0],checker:O$}],[["ArrowUp","mac+ArrowUp"],r$.translateSelectedEditors,{args:[0,-Z$],checker:O$}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],r$.translateSelectedEditors,{args:[0,-mL],checker:O$}],[["ArrowDown","mac+ArrowDown"],r$.translateSelectedEditors,{args:[0,Z$],checker:O$}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],r$.translateSelectedEditors,{args:[0,mL],checker:O$}]]))}destroy(){L$(this,u$,Cte).call(this),L$(this,u$,rie).call(this),this._eventBus._off("editingaction",Sv(this,x$)),this._eventBus._off("pagechanging",Sv(this,v$)),this._eventBus._off("scalechanging",Sv(this,rS)),this._eventBus._off("rotationchanging",Sv(this,wA));for(const r$ of Sv(this,ru).values())r$.destroy();Sv(this,ru).clear(),Sv(this,Il).clear(),Sv(this,Vx).clear(),K$(this,ds,null),Sv(this,eS).clear(),Sv(this,X1).destroy(),Sv(this,uu).destroy()}get hcmFilter(){return(0,gt.shadow)(this,"hcmFilter",Sv(this,SA)?Sv(this,t0).addHCMFilter(Sv(this,SA).foreground,Sv(this,SA).background):"none")}get direction(){return(0,gt.shadow)(this,"direction",getComputedStyle(Sv(this,tS)).direction)}editAltText(r$){var O$;(O$=Sv(this,uu))==null||O$.editAltText(this,r$)}onPageChanging({pageNumber:r$}){K$(this,q0,r$-1)}focusMainContainer(){Sv(this,tS).focus()}findParent(r$,O$){for(const Z$ of Sv(this,ru).values()){const{x:mL,y:P7,width:L9,height:f$}=Z$.div.getBoundingClientRect();if(r$>=mL&&r$<=mL+L9&&O$>=P7&&O$<=P7+f$)return Z$}return null}disableUserSelect(r$=!1){Sv(this,m$).classList.toggle("noUserSelect",r$)}addShouldRescale(r$){Sv(this,Vx).add(r$)}removeShouldRescale(r$){Sv(this,Vx).delete(r$)}onScaleChanging({scale:r$}){this.commitOrRemove(),this.viewParameters.realScale=r$*_t.PixelsPerInch.PDF_TO_CSS_UNITS;for(const O$ of Sv(this,Vx))O$.onScaleChanging()}onRotationChanging({pagesRotation:r$}){this.commitOrRemove(),this.viewParameters.rotation=r$}addToAnnotationStorage(r$){!r$.isEmpty()&&Sv(this,p0)&&!Sv(this,p0).has(r$.id)&&Sv(this,p0).setValue(r$.id,r$)}blur(){if(!this.hasSelection)return;const{activeElement:r$}=document;for(const O$ of Sv(this,eS))if(O$.div.contains(r$)){K$(this,l1,[O$,r$]),O$._focusEventsAllowed=!1;break}}focus(){if(!Sv(this,l1))return;const[r$,O$]=Sv(this,l1);K$(this,l1,null),O$.addEventListener("focusin",()=>{r$._focusEventsAllowed=!0},{once:!0}),O$.focus()}addEditListeners(){L$(this,u$,nie).call(this),L$(this,u$,aie).call(this)}removeEditListeners(){L$(this,u$,Cte).call(this),L$(this,u$,sie).call(this)}copy(r$){var Z$;if(r$.preventDefault(),(Z$=Sv(this,ds))==null||Z$.commitOrRemove(),!this.hasSelection)return;const O$=[];for(const mL of Sv(this,eS)){const P7=mL.serialize(!0);P7&&O$.push(P7)}O$.length!==0&&r$.clipboardData.setData("application/pdfjs",JSON.stringify(O$))}cut(r$){this.copy(r$),this.delete()}paste(r$){r$.preventDefault();const{clipboardData:O$}=r$;for(const P7 of O$.items)for(const L9 of Sv(this,a1))if(L9.isHandlingMimeForPasting(P7.type)){L9.paste(P7,this.currentLayer);return}let Z$=O$.getData("application/pdfjs");if(!Z$)return;try{Z$=JSON.parse(Z$)}catch(P7){(0,gt.warn)(`paste: "${P7.message}".`);return}if(!Array.isArray(Z$))return;this.unselectAll();const mL=this.currentLayer;try{const P7=[];for(const l$ of Z$){const T$=mL.deserialize(l$);if(!T$)return;P7.push(T$)}const L9=()=>{for(const l$ of P7)L$(this,u$,oie).call(this,l$);L$(this,u$,lie).call(this,P7)},f$=()=>{for(const l$ of P7)l$.remove()};this.addCommands({cmd:L9,undo:f$,mustExec:!0})}catch(P7){(0,gt.warn)(`paste: "${P7.message}".`)}}keydown(r$){var O$;(O$=this.getActive())!=null&&O$.shouldGetKeyboardEvents()||w$._keyboardManager.exec(this,r$)}onEditingAction(r$){["undo","redo","delete","selectAll"].includes(r$.name)&&this[r$.name]()}setEditingState(r$){r$?(L$(this,u$,Zie).call(this),L$(this,u$,nie).call(this),L$(this,u$,aie).call(this),L$(this,u$,Iee).call(this,{isEditing:Sv(this,LE)!==gt.AnnotationEditorType.NONE,isEmpty:L$(this,u$,pte).call(this),hasSomethingToUndo:Sv(this,X1).hasSomethingToUndo(),hasSomethingToRedo:Sv(this,X1).hasSomethingToRedo(),hasSelectedEditor:!1})):(L$(this,u$,rie).call(this),L$(this,u$,Cte).call(this),L$(this,u$,sie).call(this),L$(this,u$,Iee).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(r$){if(!Sv(this,a1)){K$(this,a1,r$);for(const O$ of Sv(this,a1))L$(this,u$,dte).call(this,O$.defaultPropertiesToUpdate)}}getId(){return Sv(this,cu).getId()}get currentLayer(){return Sv(this,ru).get(Sv(this,q0))}getLayer(r$){return Sv(this,ru).get(r$)}get currentPageIndex(){return Sv(this,q0)}addLayer(r$){Sv(this,ru).set(r$.pageIndex,r$),Sv(this,lu)?r$.enable():r$.disable()}removeLayer(r$){Sv(this,ru).delete(r$.pageIndex)}updateMode(r$,O$=null){if(Sv(this,LE)!==r$){if(K$(this,LE,r$),r$===gt.AnnotationEditorType.NONE){this.setEditingState(!1),L$(this,u$,ere).call(this);return}this.setEditingState(!0),L$(this,u$,Jie).call(this),this.unselectAll();for(const Z$ of Sv(this,ru).values())Z$.updateMode(r$);if(O$){for(const Z$ of Sv(this,Il).values())if(Z$.annotationElementId===O$){this.setSelected(Z$),Z$.enterInEditMode();break}}}}updateToolbar(r$){r$!==Sv(this,LE)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:r$})}updateParams(r$,O$){if(Sv(this,a1)){if(r$===gt.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(r$);return}for(const Z$ of Sv(this,eS))Z$.updateParams(r$,O$);for(const Z$ of Sv(this,a1))Z$.updateDefaultParams(r$,O$)}}enableWaiting(r$=!1){if(Sv(this,b0)!==r$){K$(this,b0,r$);for(const O$ of Sv(this,ru).values())r$?O$.disableClick():O$.enableClick(),O$.div.classList.toggle("waiting",r$)}}getEditors(r$){const O$=[];for(const Z$ of Sv(this,Il).values())Z$.pageIndex===r$&&O$.push(Z$);return O$}getEditor(r$){return Sv(this,Il).get(r$)}addEditor(r$){Sv(this,Il).set(r$.id,r$)}removeEditor(r$){var O$;Sv(this,Il).delete(r$.id),this.unselect(r$),(!r$.annotationElementId||!Sv(this,W0).has(r$.annotationElementId))&&((O$=Sv(this,p0))==null||O$.remove(r$.id))}addDeletedAnnotationElement(r$){Sv(this,W0).add(r$.annotationElementId),r$.deleted=!0}isDeletedAnnotationElement(r$){return Sv(this,W0).has(r$)}removeDeletedAnnotationElement(r$){Sv(this,W0).delete(r$.annotationElementId),r$.deleted=!1}setActiveEditor(r$){Sv(this,ds)!==r$&&(K$(this,ds,r$),r$&&L$(this,u$,dte).call(this,r$.propertiesToUpdate))}toggleSelected(r$){if(Sv(this,eS).has(r$)){Sv(this,eS).delete(r$),r$.unselect(),L$(this,u$,Iee).call(this,{hasSelectedEditor:this.hasSelection});return}Sv(this,eS).add(r$),r$.select(),L$(this,u$,dte).call(this,r$.propertiesToUpdate),L$(this,u$,Iee).call(this,{hasSelectedEditor:!0})}setSelected(r$){for(const O$ of Sv(this,eS))O$!==r$&&O$.unselect();Sv(this,eS).clear(),Sv(this,eS).add(r$),r$.select(),L$(this,u$,dte).call(this,r$.propertiesToUpdate),L$(this,u$,Iee).call(this,{hasSelectedEditor:!0})}isSelected(r$){return Sv(this,eS).has(r$)}unselect(r$){r$.unselect(),Sv(this,eS).delete(r$),L$(this,u$,Iee).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return Sv(this,eS).size!==0}undo(){Sv(this,X1).undo(),L$(this,u$,Iee).call(this,{hasSomethingToUndo:Sv(this,X1).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:L$(this,u$,pte).call(this)})}redo(){Sv(this,X1).redo(),L$(this,u$,Iee).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:Sv(this,X1).hasSomethingToRedo(),isEmpty:L$(this,u$,pte).call(this)})}addCommands(r$){Sv(this,X1).add(r$),L$(this,u$,Iee).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:L$(this,u$,pte).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const r$=[...Sv(this,eS)],O$=()=>{for(const mL of r$)mL.remove()},Z$=()=>{for(const mL of r$)L$(this,u$,oie).call(this,mL)};this.addCommands({cmd:O$,undo:Z$,mustExec:!0})}commitOrRemove(){var r$;(r$=Sv(this,ds))==null||r$.commitOrRemove()}hasSomethingToControl(){return Sv(this,ds)||this.hasSelection}selectAll(){for(const r$ of Sv(this,eS))r$.commit();L$(this,u$,lie).call(this,Sv(this,Il).values())}unselectAll(){if(Sv(this,ds)){Sv(this,ds).commitOrRemove();return}if(this.hasSelection){for(const r$ of Sv(this,eS))r$.unselect();Sv(this,eS).clear(),L$(this,u$,Iee).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(r$,O$,Z$=!1){if(Z$||this.commitOrRemove(),!this.hasSelection)return;Sv(this,S$)[0]+=r$,Sv(this,S$)[1]+=O$;const[mL,P7]=Sv(this,S$),L9=[...Sv(this,eS)],f$=1e3;Sv(this,tA)&&clearTimeout(Sv(this,tA)),K$(this,tA,setTimeout(()=>{K$(this,tA,null),Sv(this,S$)[0]=Sv(this,S$)[1]=0,this.addCommands({cmd:()=>{for(const l$ of L9)Sv(this,Il).has(l$.id)&&l$.translateInPage(mL,P7)},undo:()=>{for(const l$ of L9)Sv(this,Il).has(l$.id)&&l$.translateInPage(-mL,-P7)},mustExec:!1})},f$));for(const l$ of L9)l$.translateInPage(r$,O$)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),K$(this,hu,new Map);for(const r$ of Sv(this,eS))Sv(this,hu).set(r$,{savedX:r$.x,savedY:r$.y,savedPageIndex:r$.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!Sv(this,hu))return!1;this.disableUserSelect(!1);const r$=Sv(this,hu);K$(this,hu,null);let O$=!1;for(const[{x:mL,y:P7,pageIndex:L9},f$]of r$)f$.newX=mL,f$.newY=P7,f$.newPageIndex=L9,O$||(O$=mL!==f$.savedX||P7!==f$.savedY||L9!==f$.savedPageIndex);if(!O$)return!1;const Z$=(mL,P7,L9,f$)=>{if(Sv(this,Il).has(mL.id)){const l$=Sv(this,ru).get(f$);l$?mL._setParentAndPosition(l$,P7,L9):(mL.pageIndex=f$,mL.x=P7,mL.y=L9)}};return this.addCommands({cmd:()=>{for(const[mL,{newX:P7,newY:L9,newPageIndex:f$}]of r$)Z$(mL,P7,L9,f$)},undo:()=>{for(const[mL,{savedX:P7,savedY:L9,savedPageIndex:f$}]of r$)Z$(mL,P7,L9,f$)},mustExec:!0}),!0}dragSelectedEditors(r$,O$){if(Sv(this,hu))for(const Z$ of Sv(this,hu).keys())Z$.drag(r$,O$)}rebuild(r$){if(r$.parent===null){const O$=this.getLayer(r$.pageIndex);O$?(O$.changeParent(r$),O$.addOrRebuild(r$)):(this.addEditor(r$),this.addToAnnotationStorage(r$),r$.rebuild())}else r$.parent.addOrRebuild(r$)}isActive(r$){return Sv(this,ds)===r$}getActive(){return Sv(this,ds)}getMode(){return Sv(this,LE)}get imageManager(){return(0,gt.shadow)(this,"imageManager",new Ft)}};ds=new WeakMap,Il=new WeakMap,ru=new WeakMap,uu=new WeakMap,p0=new WeakMap,X1=new WeakMap,q0=new WeakMap,W0=new WeakMap,hu=new WeakMap,a1=new WeakMap,Vx=new WeakMap,t0=new WeakMap,cu=new WeakMap,lu=new WeakMap,b0=new WeakMap,l1=new WeakMap,LE=new WeakMap,eS=new WeakMap,SA=new WeakMap,o$=new WeakMap,h$=new WeakMap,d$=new WeakMap,y$=new WeakMap,R$=new WeakMap,M$=new WeakMap,x$=new WeakMap,v$=new WeakMap,rS=new WeakMap,wA=new WeakMap,g$=new WeakMap,S$=new WeakMap,tA=new WeakMap,tS=new WeakMap,m$=new WeakMap,u$=new WeakSet,Zie=function(){window.addEventListener("focus",Sv(this,h$)),window.addEventListener("blur",Sv(this,o$))},rie=function(){window.removeEventListener("focus",Sv(this,h$)),window.removeEventListener("blur",Sv(this,o$))},nie=function(){window.addEventListener("keydown",Sv(this,M$),{capture:!0})},Cte=function(){window.removeEventListener("keydown",Sv(this,M$),{capture:!0})},aie=function(){document.addEventListener("copy",Sv(this,d$)),document.addEventListener("cut",Sv(this,y$)),document.addEventListener("paste",Sv(this,R$))},sie=function(){document.removeEventListener("copy",Sv(this,d$)),document.removeEventListener("cut",Sv(this,y$)),document.removeEventListener("paste",Sv(this,R$))},Iee=function(r$){Object.entries(r$).some(([Z$,mL])=>Sv(this,g$)[Z$]!==mL)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(Sv(this,g$),r$)})},dte=function(r$){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:r$})},Jie=function(){if(!Sv(this,lu)){K$(this,lu,!0);for(const r$ of Sv(this,ru).values())r$.enable()}},ere=function(){if(this.unselectAll(),Sv(this,lu)){K$(this,lu,!1);for(const r$ of Sv(this,ru).values())r$.disable()}},oie=function(r$){const O$=Sv(this,ru).get(r$.pageIndex);O$?O$.addOrRebuild(r$):this.addEditor(r$)},pte=function(){if(Sv(this,Il).size===0)return!0;if(Sv(this,Il).size===1)for(const r$ of Sv(this,Il).values())return r$.isEmpty();return!1},lie=function(r$){Sv(this,eS).clear();for(const O$ of r$)O$.isEmpty()||(Sv(this,eS).add(O$),O$.select());L$(this,u$,Iee).call(this,{hasSelectedEditor:!0})},lee(w$,"TRANSLATE_SMALL",1),lee(w$,"TRANSLATE_BIG",10);let dr=w$;st.AnnotationEditorUIManager=dr},(nt,st,mt)=>{var q0,W0,hu,a1,Vx,t0,cu,lu,b0,l1,LE,eS,nte,ate,cie,Mte,Pte,fte,mte;Object.defineProperty(st,"__esModule",{value:!0}),st.StatTimer=st.RenderingCancelledException=st.PixelsPerInch=st.PageViewport=st.PDFDateString=st.DOMStandardFontDataFactory=st.DOMSVGFactory=st.DOMFilterFactory=st.DOMCanvasFactory=st.DOMCMapReaderFactory=void 0,st.deprecated=es,st.getColorValues=Il,st.getCurrentTransform=ru,st.getCurrentTransformInverse=uu,st.getFilenameFromUrl=Nr,st.getPdfFilenameFromUrl=tn,st.getRGB=ds,st.getXfaPageViewport=Ko,st.isDataScheme=zr,st.isPdfFile=Fr,st.isValidFetchUrl=Tn,st.loadScript=un,st.noContextMenu=$n,st.setLayerDimensions=p0;var gt=mt(7),_t=mt(1);const Et="http://www.w3.org/2000/svg",X1=class X1{};lee(X1,"CSS",96),lee(X1,"PDF",72),lee(X1,"PDF_TO_CSS_UNITS",X1.CSS/X1.PDF);let At=X1;st.PixelsPerInch=At;class Rt extends gt.BaseFilterFactory{constructor({docId:rS,ownerDocument:wA=globalThis.document}={}){super();G$(this,eS);G$(this,q0);G$(this,W0);G$(this,hu);G$(this,a1);G$(this,Vx);G$(this,t0);G$(this,cu);G$(this,lu);G$(this,b0);G$(this,l1);G$(this,LE,0);K$(this,hu,rS),K$(this,a1,wA)}addFilter(rS){if(!rS)return"none";let wA=Sv(this,eS,nte).get(rS);if(wA)return wA;let g$,S$,tA,tS;if(rS.length===1){const F$=rS[0],EI=new Array(256);for(let pR=0;pR<256;pR++)EI[pR]=F$[pR]/255;tS=g$=S$=tA=EI.join(",")}else{const[F$,EI,pR]=rS,X$=new Array(256),J$=new Array(256),gD=new Array(256);for(let fL=0;fL<256;fL++)X$[fL]=F$[fL]/255,J$[fL]=EI[fL]/255,gD[fL]=pR[fL]/255;g$=X$.join(","),S$=J$.join(","),tA=gD.join(","),tS=`${g$}${S$}${tA}`}if(wA=Sv(this,eS,nte).get(tS),wA)return Sv(this,eS,nte).set(rS,wA),wA;const m$=`g_${Sv(this,hu)}_transfer_map_${hte(this,LE)._++}`,u$=`url(#${m$})`;Sv(this,eS,nte).set(rS,u$),Sv(this,eS,nte).set(tS,u$);const UE=L$(this,eS,Mte).call(this,m$);return L$(this,eS,fte).call(this,g$,S$,tA,UE),u$}addHCMFilter(rS,wA){var EI;const g$=`${rS}-${wA}`;if(Sv(this,t0)===g$)return Sv(this,cu);if(K$(this,t0,g$),K$(this,cu,"none"),(EI=Sv(this,Vx))==null||EI.remove(),!rS||!wA)return Sv(this,cu);const S$=L$(this,eS,mte).call(this,rS);rS=_t.Util.makeHexColor(...S$);const tA=L$(this,eS,mte).call(this,wA);if(wA=_t.Util.makeHexColor(...tA),Sv(this,eS,ate).style.color="",rS==="#000000"&&wA==="#ffffff"||rS===wA)return Sv(this,cu);const tS=new Array(256);for(let pR=0;pR<=255;pR++){const X$=pR/255;tS[pR]=X$<=.03928?X$/12.92:((X$+.055)/1.055)**2.4}const m$=tS.join(","),u$=`g_${Sv(this,hu)}_hcm_filter`,UE=K$(this,lu,L$(this,eS,Mte).call(this,u$));L$(this,eS,fte).call(this,m$,m$,m$,UE),L$(this,eS,cie).call(this,UE);const F$=(pR,X$)=>{const J$=S$[pR]/255,gD=tA[pR]/255,fL=new Array(X$+1);for(let I7=0;I7<=X$;I7++)fL[I7]=J$+I7/X$*(gD-J$);return fL.join(",")};return L$(this,eS,fte).call(this,F$(0,5),F$(1,5),F$(2,5),UE),K$(this,cu,`url(#${u$})`),Sv(this,cu)}addHighlightHCMFilter(rS,wA,g$,S$){var gD;const tA=`${rS}-${wA}-${g$}-${S$}`;if(Sv(this,b0)===tA)return Sv(this,l1);if(K$(this,b0,tA),K$(this,l1,"none"),(gD=Sv(this,lu))==null||gD.remove(),!rS||!wA)return Sv(this,l1);const[tS,m$]=[rS,wA].map(L$(this,eS,mte).bind(this));let u$=Math.round(.2126*tS[0]+.7152*tS[1]+.0722*tS[2]),UE=Math.round(.2126*m$[0]+.7152*m$[1]+.0722*m$[2]),[F$,EI]=[g$,S$].map(L$(this,eS,mte).bind(this));UE<u$&&([u$,UE,F$,EI]=[UE,u$,EI,F$]),Sv(this,eS,ate).style.color="";const pR=(fL,I7,j$)=>{const _$=new Array(256),I$=(UE-u$)/j$,GL=fL/255,w$=(I7-fL)/(255*j$);let B$=0;for(let r$=0;r$<=j$;r$++){const O$=Math.round(u$+r$*I$),Z$=GL+r$*w$;for(let mL=B$;mL<=O$;mL++)_$[mL]=Z$;B$=O$+1}for(let r$=B$;r$<256;r$++)_$[r$]=_$[B$-1];return _$.join(",")},X$=`g_${Sv(this,hu)}_hcm_highlight_filter`,J$=K$(this,lu,L$(this,eS,Mte).call(this,X$));return L$(this,eS,cie).call(this,J$),L$(this,eS,fte).call(this,pR(F$[0],EI[0],5),pR(F$[1],EI[1],5),pR(F$[2],EI[2],5),J$),K$(this,l1,`url(#${X$})`),Sv(this,l1)}destroy(rS=!1){rS&&(Sv(this,cu)||Sv(this,l1))||(Sv(this,W0)&&(Sv(this,W0).parentNode.parentNode.remove(),K$(this,W0,null)),Sv(this,q0)&&(Sv(this,q0).clear(),K$(this,q0,null)),K$(this,LE,0))}}q0=new WeakMap,W0=new WeakMap,hu=new WeakMap,a1=new WeakMap,Vx=new WeakMap,t0=new WeakMap,cu=new WeakMap,lu=new WeakMap,b0=new WeakMap,l1=new WeakMap,LE=new WeakMap,eS=new WeakSet,nte=function(){return Sv(this,q0)||K$(this,q0,new Map)},ate=function(){if(!Sv(this,W0)){const rS=Sv(this,a1).createElement("div"),{style:wA}=rS;wA.visibility="hidden",wA.contain="strict",wA.width=wA.height=0,wA.position="absolute",wA.top=wA.left=0,wA.zIndex=-1;const g$=Sv(this,a1).createElementNS(Et,"svg");g$.setAttribute("width",0),g$.setAttribute("height",0),K$(this,W0,Sv(this,a1).createElementNS(Et,"defs")),rS.append(g$),g$.append(Sv(this,W0)),Sv(this,a1).body.append(rS)}return Sv(this,W0)},cie=function(rS){const wA=Sv(this,a1).createElementNS(Et,"feColorMatrix");wA.setAttribute("type","matrix"),wA.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),rS.append(wA)},Mte=function(rS){const wA=Sv(this,a1).createElementNS(Et,"filter");return wA.setAttribute("color-interpolation-filters","sRGB"),wA.setAttribute("id",rS),Sv(this,eS,ate).append(wA),wA},Pte=function(rS,wA,g$){const S$=Sv(this,a1).createElementNS(Et,wA);S$.setAttribute("type","discrete"),S$.setAttribute("tableValues",g$),rS.append(S$)},fte=function(rS,wA,g$,S$){const tA=Sv(this,a1).createElementNS(Et,"feComponentTransfer");S$.append(tA),L$(this,eS,Pte).call(this,tA,"feFuncR",rS),L$(this,eS,Pte).call(this,tA,"feFuncG",wA),L$(this,eS,Pte).call(this,tA,"feFuncB",g$)},mte=function(rS){return Sv(this,eS,ate).style.color=rS,ds(getComputedStyle(Sv(this,eS,ate)).getPropertyValue("color"))},st.DOMFilterFactory=Rt;class Ft extends gt.BaseCanvasFactory{constructor({ownerDocument:v$=globalThis.document}={}){super(),this._document=v$}_createCanvas(v$,rS){const wA=this._document.createElement("canvas");return wA.width=v$,wA.height=rS,wA}}st.DOMCanvasFactory=Ft;async function Nt(x$,v$=!1){if(Tn(x$,document.baseURI)){const rS=await fetch(x$);if(!rS.ok)throw new Error(rS.statusText);return v$?new Uint8Array(await rS.arrayBuffer()):(0,_t.stringToBytes)(await rS.text())}return new Promise((rS,wA)=>{const g$=new XMLHttpRequest;g$.open("GET",x$,!0),v$&&(g$.responseType="arraybuffer"),g$.onreadystatechange=()=>{if(g$.readyState===XMLHttpRequest.DONE){if(g$.status===200||g$.status===0){let S$;if(v$&&g$.response?S$=new Uint8Array(g$.response):!v$&&g$.responseText&&(S$=(0,_t.stringToBytes)(g$.responseText)),S$){rS(S$);return}}wA(new Error(g$.statusText))}},g$.send(null)})}class Bt extends gt.BaseCMapReaderFactory{_fetchData(v$,rS){return Nt(v$,this.isCompressed).then(wA=>({cMapData:wA,compressionType:rS}))}}st.DOMCMapReaderFactory=Bt;class Gt extends gt.BaseStandardFontDataFactory{_fetchData(v$){return Nt(v$,!0)}}st.DOMStandardFontDataFactory=Gt;class dr extends gt.BaseSVGFactory{_createSVG(v$){return document.createElementNS(Et,v$)}}st.DOMSVGFactory=dr;class Mr{constructor({viewBox:v$,scale:rS,rotation:wA,offsetX:g$=0,offsetY:S$=0,dontFlip:tA=!1}){this.viewBox=v$,this.scale=rS,this.rotation=wA,this.offsetX=g$,this.offsetY=S$;const tS=(v$[2]+v$[0])/2,m$=(v$[3]+v$[1])/2;let u$,UE,F$,EI;switch(wA%=360,wA<0&&(wA+=360),wA){case 180:u$=-1,UE=0,F$=0,EI=1;break;case 90:u$=0,UE=1,F$=1,EI=0;break;case 270:u$=0,UE=-1,F$=-1,EI=0;break;case 0:u$=1,UE=0,F$=0,EI=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}tA&&(F$=-F$,EI=-EI);let pR,X$,J$,gD;u$===0?(pR=Math.abs(m$-v$[1])*rS+g$,X$=Math.abs(tS-v$[0])*rS+S$,J$=(v$[3]-v$[1])*rS,gD=(v$[2]-v$[0])*rS):(pR=Math.abs(tS-v$[0])*rS+g$,X$=Math.abs(m$-v$[1])*rS+S$,J$=(v$[2]-v$[0])*rS,gD=(v$[3]-v$[1])*rS),this.transform=[u$*rS,UE*rS,F$*rS,EI*rS,pR-u$*rS*tS-F$*rS*m$,X$-UE*rS*tS-EI*rS*m$],this.width=J$,this.height=gD}get rawDims(){const{viewBox:v$}=this;return(0,_t.shadow)(this,"rawDims",{pageWidth:v$[2]-v$[0],pageHeight:v$[3]-v$[1],pageX:v$[0],pageY:v$[1]})}clone({scale:v$=this.scale,rotation:rS=this.rotation,offsetX:wA=this.offsetX,offsetY:g$=this.offsetY,dontFlip:S$=!1}={}){return new Mr({viewBox:this.viewBox.slice(),scale:v$,rotation:rS,offsetX:wA,offsetY:g$,dontFlip:S$})}convertToViewportPoint(v$,rS){return _t.Util.applyTransform([v$,rS],this.transform)}convertToViewportRectangle(v$){const rS=_t.Util.applyTransform([v$[0],v$[1]],this.transform),wA=_t.Util.applyTransform([v$[2],v$[3]],this.transform);return[rS[0],rS[1],wA[0],wA[1]]}convertToPdfPoint(v$,rS){return _t.Util.applyInverseTransform([v$,rS],this.transform)}}st.PageViewport=Mr;class Tr extends _t.BaseException{constructor(v$,rS=0){super(v$,"RenderingCancelledException"),this.extraDelay=rS}}st.RenderingCancelledException=Tr;function zr(x$){const v$=x$.length;let rS=0;for(;rS<v$&&x$[rS].trim()==="";)rS++;return x$.substring(rS,rS+5).toLowerCase()==="data:"}function Fr(x$){return typeof x$=="string"&&/\.pdf$/i.test(x$)}function Nr(x$,v$=!1){return v$||([x$]=x$.split(/[#?]/,1)),x$.substring(x$.lastIndexOf("/")+1)}function tn(x$,v$="document.pdf"){if(typeof x$!="string")return v$;if(zr(x$))return(0,_t.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),v$;const rS=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,wA=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,g$=rS.exec(x$);let S$=wA.exec(g$[1])||wA.exec(g$[2])||wA.exec(g$[3]);if(S$&&(S$=S$[0],S$.includes("%")))try{S$=wA.exec(decodeURIComponent(S$))[0]}catch{}return S$||v$}class rn{constructor(){lee(this,"started",Object.create(null));lee(this,"times",[])}time(v$){v$ in this.started&&(0,_t.warn)(`Timer is already running for ${v$}`),this.started[v$]=Date.now()}timeEnd(v$){v$ in this.started||(0,_t.warn)(`Timer has not been started for ${v$}`),this.times.push({name:v$,start:this.started[v$],end:Date.now()}),delete this.started[v$]}toString(){const v$=[];let rS=0;for(const{name:wA}of this.times)rS=Math.max(wA.length,rS);for(const{name:wA,start:g$,end:S$}of this.times)v$.push(`${wA.padEnd(rS)} ${S$-g$}ms
`);return v$.join("")}}st.StatTimer=rn;function Tn(x$,v$){try{const{protocol:rS}=v$?new URL(x$,v$):new URL(x$);return rS==="http:"||rS==="https:"}catch{return!1}}function $n(x$){x$.preventDefault()}function un(x$,v$=!1){return new Promise((rS,wA)=>{const g$=document.createElement("script");g$.src=x$,g$.onload=function(S$){v$&&g$.remove(),rS(S$)},g$.onerror=function(){wA(new Error(`Cannot load script at: ${g$.src}`))},(document.head||document.documentElement).append(g$)})}function es(x$){console.log("Deprecated API usage: "+x$)}let kn;class ts{static toDateObject(v$){if(!v$||typeof v$!="string")return null;kn||(kn=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const rS=kn.exec(v$);if(!rS)return null;const wA=parseInt(rS[1],10);let g$=parseInt(rS[2],10);g$=g$>=1&&g$<=12?g$-1:0;let S$=parseInt(rS[3],10);S$=S$>=1&&S$<=31?S$:1;let tA=parseInt(rS[4],10);tA=tA>=0&&tA<=23?tA:0;let tS=parseInt(rS[5],10);tS=tS>=0&&tS<=59?tS:0;let m$=parseInt(rS[6],10);m$=m$>=0&&m$<=59?m$:0;const u$=rS[7]||"Z";let UE=parseInt(rS[8],10);UE=UE>=0&&UE<=23?UE:0;let F$=parseInt(rS[9],10)||0;return F$=F$>=0&&F$<=59?F$:0,u$==="-"?(tA+=UE,tS+=F$):u$==="+"&&(tA-=UE,tS-=F$),new Date(Date.UTC(wA,g$,S$,tA,tS,m$))}}st.PDFDateString=ts;function Ko(x$,{scale:v$=1,rotation:rS=0}){const{width:wA,height:g$}=x$.attributes.style,S$=[0,0,parseInt(wA),parseInt(g$)];return new Mr({viewBox:S$,scale:v$,rotation:rS})}function ds(x$){if(x$.startsWith("#")){const v$=parseInt(x$.slice(1),16);return[(v$&16711680)>>16,(v$&65280)>>8,v$&255]}return x$.startsWith("rgb(")?x$.slice(4,-1).split(",").map(v$=>parseInt(v$)):x$.startsWith("rgba(")?x$.slice(5,-1).split(",").map(v$=>parseInt(v$)).slice(0,3):((0,_t.warn)(`Not a valid color format: "${x$}"`),[0,0,0])}function Il(x$){const v$=document.createElement("span");v$.style.visibility="hidden",document.body.append(v$);for(const rS of x$.keys()){v$.style.color=rS;const wA=window.getComputedStyle(v$).color;x$.set(rS,ds(wA))}v$.remove()}function ru(x$){const{a:v$,b:rS,c:wA,d:g$,e:S$,f:tA}=x$.getTransform();return[v$,rS,wA,g$,S$,tA]}function uu(x$){const{a:v$,b:rS,c:wA,d:g$,e:S$,f:tA}=x$.getTransform().invertSelf();return[v$,rS,wA,g$,S$,tA]}function p0(x$,v$,rS=!1,wA=!0){if(v$ instanceof Mr){const{pageWidth:g$,pageHeight:S$}=v$.rawDims,{style:tA}=x$,tS=_t.FeatureTest.isCSSRoundSupported,m$=`var(--scale-factor) * ${g$}px`,u$=`var(--scale-factor) * ${S$}px`,UE=tS?`round(${m$}, 1px)`:`calc(${m$})`,F$=tS?`round(${u$}, 1px)`:`calc(${u$})`;!rS||v$.rotation%180===0?(tA.width=UE,tA.height=F$):(tA.width=F$,tA.height=UE)}wA&&x$.setAttribute("data-main-rotation",v$.rotation)}},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.BaseStandardFontDataFactory=st.BaseSVGFactory=st.BaseFilterFactory=st.BaseCanvasFactory=st.BaseCMapReaderFactory=void 0;var gt=mt(1);class _t{constructor(){this.constructor===_t&&(0,gt.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(Bt){return"none"}addHCMFilter(Bt,Gt){return"none"}addHighlightHCMFilter(Bt,Gt,dr,Mr){return"none"}destroy(Bt=!1){}}st.BaseFilterFactory=_t;class Et{constructor(){this.constructor===Et&&(0,gt.unreachable)("Cannot initialize BaseCanvasFactory.")}create(Bt,Gt){if(Bt<=0||Gt<=0)throw new Error("Invalid canvas size");const dr=this._createCanvas(Bt,Gt);return{canvas:dr,context:dr.getContext("2d")}}reset(Bt,Gt,dr){if(!Bt.canvas)throw new Error("Canvas is not specified");if(Gt<=0||dr<=0)throw new Error("Invalid canvas size");Bt.canvas.width=Gt,Bt.canvas.height=dr}destroy(Bt){if(!Bt.canvas)throw new Error("Canvas is not specified");Bt.canvas.width=0,Bt.canvas.height=0,Bt.canvas=null,Bt.context=null}_createCanvas(Bt,Gt){(0,gt.unreachable)("Abstract method `_createCanvas` called.")}}st.BaseCanvasFactory=Et;class At{constructor({baseUrl:Bt=null,isCompressed:Gt=!0}){this.constructor===At&&(0,gt.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=Bt,this.isCompressed=Gt}async fetch({name:Bt}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!Bt)throw new Error("CMap name must be specified.");const Gt=this.baseUrl+Bt+(this.isCompressed?".bcmap":""),dr=this.isCompressed?gt.CMapCompressionType.BINARY:gt.CMapCompressionType.NONE;return this._fetchData(Gt,dr).catch(Mr=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${Gt}`)})}_fetchData(Bt,Gt){(0,gt.unreachable)("Abstract method `_fetchData` called.")}}st.BaseCMapReaderFactory=At;class Rt{constructor({baseUrl:Bt=null}){this.constructor===Rt&&(0,gt.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=Bt}async fetch({filename:Bt}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!Bt)throw new Error("Font filename must be specified.");const Gt=`${this.baseUrl}${Bt}`;return this._fetchData(Gt).catch(dr=>{throw new Error(`Unable to load font data at: ${Gt}`)})}_fetchData(Bt){(0,gt.unreachable)("Abstract method `_fetchData` called.")}}st.BaseStandardFontDataFactory=Rt;class Ft{constructor(){this.constructor===Ft&&(0,gt.unreachable)("Cannot initialize BaseSVGFactory.")}create(Bt,Gt,dr=!1){if(Bt<=0||Gt<=0)throw new Error("Invalid SVG dimensions");const Mr=this._createSVG("svg:svg");return Mr.setAttribute("version","1.1"),dr||(Mr.setAttribute("width",`${Bt}px`),Mr.setAttribute("height",`${Gt}px`)),Mr.setAttribute("preserveAspectRatio","none"),Mr.setAttribute("viewBox",`0 0 ${Bt} ${Gt}`),Mr}createElement(Bt){if(typeof Bt!="string")throw new Error("Invalid SVG element type");return this._createSVG(Bt)}_createSVG(Bt){(0,gt.unreachable)("Abstract method `_createSVG` called.")}}st.BaseSVGFactory=Ft},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.MurmurHash3_64=void 0;var gt=mt(1);const _t=3285377520,Et=4294901760,At=65535;class Rt{constructor(Nt){this.h1=Nt?Nt&4294967295:_t,this.h2=Nt?Nt&4294967295:_t}update(Nt){let Bt,Gt;if(typeof Nt=="string"){Bt=new Uint8Array(Nt.length*2),Gt=0;for(let es=0,kn=Nt.length;es<kn;es++){const ts=Nt.charCodeAt(es);ts<=255?Bt[Gt++]=ts:(Bt[Gt++]=ts>>>8,Bt[Gt++]=ts&255)}}else if((0,gt.isArrayBuffer)(Nt))Bt=Nt.slice(),Gt=Bt.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const dr=Gt>>2,Mr=Gt-dr*4,Tr=new Uint32Array(Bt.buffer,0,dr);let zr=0,Fr=0,Nr=this.h1,tn=this.h2;const rn=3432918353,Tn=461845907,$n=rn&At,un=Tn&At;for(let es=0;es<dr;es++)es&1?(zr=Tr[es],zr=zr*rn&Et|zr*$n&At,zr=zr<<15|zr>>>17,zr=zr*Tn&Et|zr*un&At,Nr^=zr,Nr=Nr<<13|Nr>>>19,Nr=Nr*5+3864292196):(Fr=Tr[es],Fr=Fr*rn&Et|Fr*$n&At,Fr=Fr<<15|Fr>>>17,Fr=Fr*Tn&Et|Fr*un&At,tn^=Fr,tn=tn<<13|tn>>>19,tn=tn*5+3864292196);switch(zr=0,Mr){case 3:zr^=Bt[dr*4+2]<<16;case 2:zr^=Bt[dr*4+1]<<8;case 1:zr^=Bt[dr*4],zr=zr*rn&Et|zr*$n&At,zr=zr<<15|zr>>>17,zr=zr*Tn&Et|zr*un&At,dr&1?Nr^=zr:tn^=zr}this.h1=Nr,this.h2=tn}hexdigest(){let Nt=this.h1,Bt=this.h2;return Nt^=Bt>>>1,Nt=Nt*3981806797&Et|Nt*36045&At,Bt=Bt*4283543511&Et|((Bt<<16|Nt>>>16)*2950163797&Et)>>>16,Nt^=Bt>>>1,Nt=Nt*444984403&Et|Nt*60499&At,Bt=Bt*3301882366&Et|((Bt<<16|Nt>>>16)*3120437893&Et)>>>16,Nt^=Bt>>>1,(Nt>>>0).toString(16).padStart(8,"0")+(Bt>>>0).toString(16).padStart(8,"0")}}st.MurmurHash3_64=Rt},(nt,st,mt)=>{var At;Object.defineProperty(st,"__esModule",{value:!0}),st.FontLoader=st.FontFaceObject=void 0;var gt=mt(1);class _t{constructor({ownerDocument:Ft=globalThis.document,styleElement:Nt=null}){G$(this,At,new Set);this._document=Ft,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(Ft){this.nativeFontFaces.add(Ft),this._document.fonts.add(Ft)}removeNativeFontFace(Ft){this.nativeFontFaces.delete(Ft),this._document.fonts.delete(Ft)}insertRule(Ft){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const Nt=this.styleElement.sheet;Nt.insertRule(Ft,Nt.cssRules.length)}clear(){for(const Ft of this.nativeFontFaces)this._document.fonts.delete(Ft);this.nativeFontFaces.clear(),Sv(this,At).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(Ft){if(!(!Ft||Sv(this,At).has(Ft.loadedName))){if((0,gt.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:Nt,src:Bt,style:Gt}=Ft,dr=new FontFace(Nt,Bt,Gt);this.addNativeFontFace(dr);try{await dr.load(),Sv(this,At).add(Nt)}catch{(0,gt.warn)(`Cannot load system font: ${Ft.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(dr)}return}(0,gt.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(Ft){if(Ft.attached||Ft.missingFile&&!Ft.systemFontInfo)return;if(Ft.attached=!0,Ft.systemFontInfo){await this.loadSystemFont(Ft.systemFontInfo);return}if(this.isFontLoadingAPISupported){const Bt=Ft.createNativeFontFace();if(Bt){this.addNativeFontFace(Bt);try{await Bt.loaded}catch(Gt){throw(0,gt.warn)(`Failed to load font '${Bt.family}': '${Gt}'.`),Ft.disableFontFace=!0,Gt}}return}const Nt=Ft.createFontFaceRule();if(Nt){if(this.insertRule(Nt),this.isSyncFontLoadingSupported)return;await new Promise(Bt=>{const Gt=this._queueLoadingCallback(Bt);this._prepareFontLoadEvent(Ft,Gt)})}}get isFontLoadingAPISupported(){var Nt;const Ft=!!((Nt=this._document)!=null&&Nt.fonts);return(0,gt.shadow)(this,"isFontLoadingAPISupported",Ft)}get isSyncFontLoadingSupported(){let Ft=!1;return(gt.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(Ft=!0),(0,gt.shadow)(this,"isSyncFontLoadingSupported",Ft)}_queueLoadingCallback(Ft){function Nt(){for((0,gt.assert)(!Gt.done,"completeRequest() cannot be called twice."),Gt.done=!0;Bt.length>0&&Bt[0].done;){const dr=Bt.shift();setTimeout(dr.callback,0)}}const{loadingRequests:Bt}=this,Gt={done:!1,complete:Nt,callback:Ft};return Bt.push(Gt),Gt}get _loadTestFont(){const Ft=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,gt.shadow)(this,"_loadTestFont",Ft)}_prepareFontLoadEvent(Ft,Nt){function Bt(ds,Il){return ds.charCodeAt(Il)<<24|ds.charCodeAt(Il+1)<<16|ds.charCodeAt(Il+2)<<8|ds.charCodeAt(Il+3)&255}function Gt(ds,Il,ru,uu){const p0=ds.substring(0,Il),X1=ds.substring(Il+ru);return p0+uu+X1}let dr,Mr;const Tr=this._document.createElement("canvas");Tr.width=1,Tr.height=1;const zr=Tr.getContext("2d");let Fr=0;function Nr(ds,Il){if(++Fr>30){(0,gt.warn)("Load test font never loaded."),Il();return}if(zr.font="30px "+ds,zr.fillText(".",0,20),zr.getImageData(0,0,1,1).data[3]>0){Il();return}setTimeout(Nr.bind(null,ds,Il))}const tn=`lt${Date.now()}${this.loadTestFontId++}`;let rn=this._loadTestFont;rn=Gt(rn,976,tn.length,tn);const $n=16,un=1482184792;let es=Bt(rn,$n);for(dr=0,Mr=tn.length-3;dr<Mr;dr+=4)es=es-un+Bt(tn,dr)|0;dr<tn.length&&(es=es-un+Bt(tn+"XXX",dr)|0),rn=Gt(rn,$n,4,(0,gt.string32)(es));const kn=`url(data:font/opentype;base64,${btoa(rn)});`,ts=`@font-face {font-family:"${tn}";src:${kn}}`;this.insertRule(ts);const Ko=this._document.createElement("div");Ko.style.visibility="hidden",Ko.style.width=Ko.style.height="10px",Ko.style.position="absolute",Ko.style.top=Ko.style.left="0px";for(const ds of[Ft.loadedName,tn]){const Il=this._document.createElement("span");Il.textContent="Hi",Il.style.fontFamily=ds,Ko.append(Il)}this._document.body.append(Ko),Nr(tn,()=>{Ko.remove(),Nt.complete()})}}At=new WeakMap,st.FontLoader=_t;class Et{constructor(Ft,{isEvalSupported:Nt=!0,disableFontFace:Bt=!1,ignoreErrors:Gt=!1,inspectFont:dr=null}){this.compiledGlyphs=Object.create(null);for(const Mr in Ft)this[Mr]=Ft[Mr];this.isEvalSupported=Nt!==!1,this.disableFontFace=Bt===!0,this.ignoreErrors=Gt===!0,this._inspectFont=dr}createNativeFontFace(){var Nt;if(!this.data||this.disableFontFace)return null;let Ft;if(!this.cssFontInfo)Ft=new FontFace(this.loadedName,this.data,{});else{const Bt={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(Bt.style=`oblique ${this.cssFontInfo.italicAngle}deg`),Ft=new FontFace(this.cssFontInfo.fontFamily,this.data,Bt)}return(Nt=this._inspectFont)==null||Nt.call(this,this),Ft}createFontFaceRule(){var Gt;if(!this.data||this.disableFontFace)return null;const Ft=(0,gt.bytesToString)(this.data),Nt=`url(data:${this.mimetype};base64,${btoa(Ft)});`;let Bt;if(!this.cssFontInfo)Bt=`@font-face {font-family:"${this.loadedName}";src:${Nt}}`;else{let dr=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(dr+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),Bt=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${dr}src:${Nt}}`}return(Gt=this._inspectFont)==null||Gt.call(this,this,Nt),Bt}getPathGenerator(Ft,Nt){if(this.compiledGlyphs[Nt]!==void 0)return this.compiledGlyphs[Nt];let Bt;try{Bt=Ft.get(this.loadedName+"_path_"+Nt)}catch(Gt){if(!this.ignoreErrors)throw Gt;return(0,gt.warn)(`getPathGenerator - ignoring character: "${Gt}".`),this.compiledGlyphs[Nt]=function(dr,Mr){}}if(this.isEvalSupported&&gt.FeatureTest.isEvalSupported){const Gt=[];for(const dr of Bt){const Mr=dr.args!==void 0?dr.args.join(","):"";Gt.push("c.",dr.cmd,"(",Mr,`);
`)}return this.compiledGlyphs[Nt]=new Function("c","size",Gt.join(""))}return this.compiledGlyphs[Nt]=function(Gt,dr){for(const Mr of Bt)Mr.cmd==="scale"&&(Mr.args=[dr,-dr]),Gt[Mr.cmd].apply(Gt,Mr.args)}}}st.FontFaceObject=Et},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.NodeStandardFontDataFactory=st.NodeFilterFactory=st.NodeCanvasFactory=st.NodeCMapReaderFactory=void 0;var gt=mt(7);mt(1);const _t=function(Nt){return new Promise((Bt,Gt)=>{require$$5.readFile(Nt,(Mr,Tr)=>{if(Mr||!Tr){Gt(new Error(Mr));return}Bt(new Uint8Array(Tr))})})};class Et extends gt.BaseFilterFactory{}st.NodeFilterFactory=Et;class At extends gt.BaseCanvasFactory{_createCanvas(Bt,Gt){return require$$5.createCanvas(Bt,Gt)}}st.NodeCanvasFactory=At;class Rt extends gt.BaseCMapReaderFactory{_fetchData(Bt,Gt){return _t(Bt).then(dr=>({cMapData:dr,compressionType:Gt}))}}st.NodeCMapReaderFactory=Rt;class Ft extends gt.BaseStandardFontDataFactory{_fetchData(Bt){return _t(Bt)}}st.NodeStandardFontDataFactory=Ft},(nt,st,mt)=>{var W0,uie,hie;Object.defineProperty(st,"__esModule",{value:!0}),st.CanvasGraphics=void 0;var gt=mt(1),_t=mt(6),Et=mt(12),At=mt(13);const Rt=16,Ft=100,Nt=4096,Bt=15,Gt=10,dr=1e3,Mr=16;function Tr(t0,cu){if(t0._removeMirroring)throw new Error("Context is already forwarding operations.");t0.__originalSave=t0.save,t0.__originalRestore=t0.restore,t0.__originalRotate=t0.rotate,t0.__originalScale=t0.scale,t0.__originalTranslate=t0.translate,t0.__originalTransform=t0.transform,t0.__originalSetTransform=t0.setTransform,t0.__originalResetTransform=t0.resetTransform,t0.__originalClip=t0.clip,t0.__originalMoveTo=t0.moveTo,t0.__originalLineTo=t0.lineTo,t0.__originalBezierCurveTo=t0.bezierCurveTo,t0.__originalRect=t0.rect,t0.__originalClosePath=t0.closePath,t0.__originalBeginPath=t0.beginPath,t0._removeMirroring=()=>{t0.save=t0.__originalSave,t0.restore=t0.__originalRestore,t0.rotate=t0.__originalRotate,t0.scale=t0.__originalScale,t0.translate=t0.__originalTranslate,t0.transform=t0.__originalTransform,t0.setTransform=t0.__originalSetTransform,t0.resetTransform=t0.__originalResetTransform,t0.clip=t0.__originalClip,t0.moveTo=t0.__originalMoveTo,t0.lineTo=t0.__originalLineTo,t0.bezierCurveTo=t0.__originalBezierCurveTo,t0.rect=t0.__originalRect,t0.closePath=t0.__originalClosePath,t0.beginPath=t0.__originalBeginPath,delete t0._removeMirroring},t0.save=function(){cu.save(),this.__originalSave()},t0.restore=function(){cu.restore(),this.__originalRestore()},t0.translate=function(b0,l1){cu.translate(b0,l1),this.__originalTranslate(b0,l1)},t0.scale=function(b0,l1){cu.scale(b0,l1),this.__originalScale(b0,l1)},t0.transform=function(b0,l1,LE,eS,SA,o$){cu.transform(b0,l1,LE,eS,SA,o$),this.__originalTransform(b0,l1,LE,eS,SA,o$)},t0.setTransform=function(b0,l1,LE,eS,SA,o$){cu.setTransform(b0,l1,LE,eS,SA,o$),this.__originalSetTransform(b0,l1,LE,eS,SA,o$)},t0.resetTransform=function(){cu.resetTransform(),this.__originalResetTransform()},t0.rotate=function(b0){cu.rotate(b0),this.__originalRotate(b0)},t0.clip=function(b0){cu.clip(b0),this.__originalClip(b0)},t0.moveTo=function(lu,b0){cu.moveTo(lu,b0),this.__originalMoveTo(lu,b0)},t0.lineTo=function(lu,b0){cu.lineTo(lu,b0),this.__originalLineTo(lu,b0)},t0.bezierCurveTo=function(lu,b0,l1,LE,eS,SA){cu.bezierCurveTo(lu,b0,l1,LE,eS,SA),this.__originalBezierCurveTo(lu,b0,l1,LE,eS,SA)},t0.rect=function(lu,b0,l1,LE){cu.rect(lu,b0,l1,LE),this.__originalRect(lu,b0,l1,LE)},t0.closePath=function(){cu.closePath(),this.__originalClosePath()},t0.beginPath=function(){cu.beginPath(),this.__originalBeginPath()}}class zr{constructor(cu){this.canvasFactory=cu,this.cache=Object.create(null)}getCanvas(cu,lu,b0){let l1;return this.cache[cu]!==void 0?(l1=this.cache[cu],this.canvasFactory.reset(l1,lu,b0)):(l1=this.canvasFactory.create(lu,b0),this.cache[cu]=l1),l1}delete(cu){delete this.cache[cu]}clear(){for(const cu in this.cache){const lu=this.cache[cu];this.canvasFactory.destroy(lu),delete this.cache[cu]}}}function Fr(t0,cu,lu,b0,l1,LE,eS,SA,o$,h$){const[d$,y$,R$,M$,x$,v$]=(0,_t.getCurrentTransform)(t0);if(y$===0&&R$===0){const g$=eS*d$+x$,S$=Math.round(g$),tA=SA*M$+v$,tS=Math.round(tA),m$=(eS+o$)*d$+x$,u$=Math.abs(Math.round(m$)-S$)||1,UE=(SA+h$)*M$+v$,F$=Math.abs(Math.round(UE)-tS)||1;return t0.setTransform(Math.sign(d$),0,0,Math.sign(M$),S$,tS),t0.drawImage(cu,lu,b0,l1,LE,0,0,u$,F$),t0.setTransform(d$,y$,R$,M$,x$,v$),[u$,F$]}if(d$===0&&M$===0){const g$=SA*R$+x$,S$=Math.round(g$),tA=eS*y$+v$,tS=Math.round(tA),m$=(SA+h$)*R$+x$,u$=Math.abs(Math.round(m$)-S$)||1,UE=(eS+o$)*y$+v$,F$=Math.abs(Math.round(UE)-tS)||1;return t0.setTransform(0,Math.sign(y$),Math.sign(R$),0,S$,tS),t0.drawImage(cu,lu,b0,l1,LE,0,0,F$,u$),t0.setTransform(d$,y$,R$,M$,x$,v$),[F$,u$]}t0.drawImage(cu,lu,b0,l1,LE,eS,SA,o$,h$);const rS=Math.hypot(d$,y$),wA=Math.hypot(R$,M$);return[rS*o$,wA*h$]}function Nr(t0){const{width:cu,height:lu}=t0;if(cu>dr||lu>dr)return null;const b0=1e3,l1=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),LE=cu+1;let eS=new Uint8Array(LE*(lu+1)),SA,o$,h$;const d$=cu+7&-8;let y$=new Uint8Array(d$*lu),R$=0;for(const wA of t0.data){let g$=128;for(;g$>0;)y$[R$++]=wA&g$?0:255,g$>>=1}let M$=0;for(R$=0,y$[R$]!==0&&(eS[0]=1,++M$),o$=1;o$<cu;o$++)y$[R$]!==y$[R$+1]&&(eS[o$]=y$[R$]?2:1,++M$),R$++;for(y$[R$]!==0&&(eS[o$]=2,++M$),SA=1;SA<lu;SA++){R$=SA*d$,h$=SA*LE,y$[R$-d$]!==y$[R$]&&(eS[h$]=y$[R$]?1:8,++M$);let wA=(y$[R$]?4:0)+(y$[R$-d$]?8:0);for(o$=1;o$<cu;o$++)wA=(wA>>2)+(y$[R$+1]?4:0)+(y$[R$-d$+1]?8:0),l1[wA]&&(eS[h$+o$]=l1[wA],++M$),R$++;if(y$[R$-d$]!==y$[R$]&&(eS[h$+o$]=y$[R$]?2:4,++M$),M$>b0)return null}for(R$=d$*(lu-1),h$=SA*LE,y$[R$]!==0&&(eS[h$]=8,++M$),o$=1;o$<cu;o$++)y$[R$]!==y$[R$+1]&&(eS[h$+o$]=y$[R$]?4:8,++M$),R$++;if(y$[R$]!==0&&(eS[h$+o$]=4,++M$),M$>b0)return null;const x$=new Int32Array([0,LE,-1,0,-LE,0,0,0,1]),v$=new Path2D;for(SA=0;M$&&SA<=lu;SA++){let wA=SA*LE;const g$=wA+cu;for(;wA<g$&&!eS[wA];)wA++;if(wA===g$)continue;v$.moveTo(wA%LE,SA);const S$=wA;let tA=eS[wA];do{const tS=x$[tA];do wA+=tS;while(!eS[wA]);const m$=eS[wA];m$!==5&&m$!==10?(tA=m$,eS[wA]=0):(tA=m$&51*tA>>4,eS[wA]&=tA>>2|tA<<2),v$.lineTo(wA%LE,wA/LE|0),eS[wA]||--M$}while(S$!==wA);--SA}return y$=null,eS=null,function(wA){wA.save(),wA.scale(1/cu,-1/lu),wA.translate(0,-lu),wA.fill(v$),wA.beginPath(),wA.restore()}}class tn{constructor(cu,lu){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=gt.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=gt.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=gt.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,cu,lu])}clone(){const cu=Object.create(this);return cu.clipBox=this.clipBox.slice(),cu}setCurrentPoint(cu,lu){this.x=cu,this.y=lu}updatePathMinMax(cu,lu,b0){[lu,b0]=gt.Util.applyTransform([lu,b0],cu),this.minX=Math.min(this.minX,lu),this.minY=Math.min(this.minY,b0),this.maxX=Math.max(this.maxX,lu),this.maxY=Math.max(this.maxY,b0)}updateRectMinMax(cu,lu){const b0=gt.Util.applyTransform(lu,cu),l1=gt.Util.applyTransform(lu.slice(2),cu);this.minX=Math.min(this.minX,b0[0],l1[0]),this.minY=Math.min(this.minY,b0[1],l1[1]),this.maxX=Math.max(this.maxX,b0[0],l1[0]),this.maxY=Math.max(this.maxY,b0[1],l1[1])}updateScalingPathMinMax(cu,lu){gt.Util.scaleMinMax(cu,lu),this.minX=Math.min(this.minX,lu[0]),this.maxX=Math.max(this.maxX,lu[1]),this.minY=Math.min(this.minY,lu[2]),this.maxY=Math.max(this.maxY,lu[3])}updateCurvePathMinMax(cu,lu,b0,l1,LE,eS,SA,o$,h$,d$){const y$=gt.Util.bezierBoundingBox(lu,b0,l1,LE,eS,SA,o$,h$);if(d$){d$[0]=Math.min(d$[0],y$[0],y$[2]),d$[1]=Math.max(d$[1],y$[0],y$[2]),d$[2]=Math.min(d$[2],y$[1],y$[3]),d$[3]=Math.max(d$[3],y$[1],y$[3]);return}this.updateRectMinMax(cu,y$)}getPathBoundingBox(cu=Et.PathType.FILL,lu=null){const b0=[this.minX,this.minY,this.maxX,this.maxY];if(cu===Et.PathType.STROKE){lu||(0,gt.unreachable)("Stroke bounding box must include transform.");const l1=gt.Util.singularValueDecompose2dScale(lu),LE=l1[0]*this.lineWidth/2,eS=l1[1]*this.lineWidth/2;b0[0]-=LE,b0[1]-=eS,b0[2]+=LE,b0[3]+=eS}return b0}updateClipFromPath(){const cu=gt.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(cu||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(cu){this.clipBox=cu,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(cu=Et.PathType.FILL,lu=null){return gt.Util.intersect(this.clipBox,this.getPathBoundingBox(cu,lu))}}function rn(t0,cu){if(typeof ImageData<"u"&&cu instanceof ImageData){t0.putImageData(cu,0,0);return}const lu=cu.height,b0=cu.width,l1=lu%Mr,LE=(lu-l1)/Mr,eS=l1===0?LE:LE+1,SA=t0.createImageData(b0,Mr);let o$=0,h$;const d$=cu.data,y$=SA.data;let R$,M$,x$,v$;if(cu.kind===gt.ImageKind.GRAYSCALE_1BPP){const rS=d$.byteLength,wA=new Uint32Array(y$.buffer,0,y$.byteLength>>2),g$=wA.length,S$=b0+7>>3,tA=4294967295,tS=gt.FeatureTest.isLittleEndian?4278190080:255;for(R$=0;R$<eS;R$++){for(x$=R$<LE?Mr:l1,h$=0,M$=0;M$<x$;M$++){const m$=rS-o$;let u$=0;const UE=m$>S$?b0:m$*8-7,F$=UE&-8;let EI=0,pR=0;for(;u$<F$;u$+=8)pR=d$[o$++],wA[h$++]=pR&128?tA:tS,wA[h$++]=pR&64?tA:tS,wA[h$++]=pR&32?tA:tS,wA[h$++]=pR&16?tA:tS,wA[h$++]=pR&8?tA:tS,wA[h$++]=pR&4?tA:tS,wA[h$++]=pR&2?tA:tS,wA[h$++]=pR&1?tA:tS;for(;u$<UE;u$++)EI===0&&(pR=d$[o$++],EI=128),wA[h$++]=pR&EI?tA:tS,EI>>=1}for(;h$<g$;)wA[h$++]=0;t0.putImageData(SA,0,R$*Mr)}}else if(cu.kind===gt.ImageKind.RGBA_32BPP){for(M$=0,v$=b0*Mr*4,R$=0;R$<LE;R$++)y$.set(d$.subarray(o$,o$+v$)),o$+=v$,t0.putImageData(SA,0,M$),M$+=Mr;R$<eS&&(v$=b0*l1*4,y$.set(d$.subarray(o$,o$+v$)),t0.putImageData(SA,0,M$))}else if(cu.kind===gt.ImageKind.RGB_24BPP)for(x$=Mr,v$=b0*x$,R$=0;R$<eS;R$++){for(R$>=LE&&(x$=l1,v$=b0*x$),h$=0,M$=v$;M$--;)y$[h$++]=d$[o$++],y$[h$++]=d$[o$++],y$[h$++]=d$[o$++],y$[h$++]=255;t0.putImageData(SA,0,R$*Mr)}else throw new Error(`bad image kind: ${cu.kind}`)}function Tn(t0,cu){if(cu.bitmap){t0.drawImage(cu.bitmap,0,0);return}const lu=cu.height,b0=cu.width,l1=lu%Mr,LE=(lu-l1)/Mr,eS=l1===0?LE:LE+1,SA=t0.createImageData(b0,Mr);let o$=0;const h$=cu.data,d$=SA.data;for(let y$=0;y$<eS;y$++){const R$=y$<LE?Mr:l1;({srcPos:o$}=(0,At.convertBlackAndWhiteToRGBA)({src:h$,srcPos:o$,dest:d$,width:b0,height:R$,nonBlackColor:0})),t0.putImageData(SA,0,y$*Mr)}}function $n(t0,cu){const lu=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const b0 of lu)t0[b0]!==void 0&&(cu[b0]=t0[b0]);t0.setLineDash!==void 0&&(cu.setLineDash(t0.getLineDash()),cu.lineDashOffset=t0.lineDashOffset)}function un(t0){if(t0.strokeStyle=t0.fillStyle="#000000",t0.fillRule="nonzero",t0.globalAlpha=1,t0.lineWidth=1,t0.lineCap="butt",t0.lineJoin="miter",t0.miterLimit=10,t0.globalCompositeOperation="source-over",t0.font="10px sans-serif",t0.setLineDash!==void 0&&(t0.setLineDash([]),t0.lineDashOffset=0),!gt.isNodeJS){const{filter:cu}=t0;cu!=="none"&&cu!==""&&(t0.filter="none")}}function es(t0,cu,lu,b0){const l1=t0.length;for(let LE=3;LE<l1;LE+=4){const eS=t0[LE];if(eS===0)t0[LE-3]=cu,t0[LE-2]=lu,t0[LE-1]=b0;else if(eS<255){const SA=255-eS;t0[LE-3]=t0[LE-3]*eS+cu*SA>>8,t0[LE-2]=t0[LE-2]*eS+lu*SA>>8,t0[LE-1]=t0[LE-1]*eS+b0*SA>>8}}}function kn(t0,cu,lu){const b0=t0.length,l1=1/255;for(let LE=3;LE<b0;LE+=4){const eS=lu?lu[t0[LE]]:t0[LE];cu[LE]=cu[LE]*eS*l1|0}}function ts(t0,cu,lu){const b0=t0.length;for(let l1=3;l1<b0;l1+=4){const LE=t0[l1-3]*77+t0[l1-2]*152+t0[l1-1]*28;cu[l1]=lu?cu[l1]*lu[LE>>8]>>8:cu[l1]*LE>>16}}function Ko(t0,cu,lu,b0,l1,LE,eS,SA,o$,h$,d$){const y$=!!LE,R$=y$?LE[0]:0,M$=y$?LE[1]:0,x$=y$?LE[2]:0,v$=l1==="Luminosity"?ts:kn,wA=Math.min(b0,Math.ceil(1048576/lu));for(let g$=0;g$<b0;g$+=wA){const S$=Math.min(wA,b0-g$),tA=t0.getImageData(SA-h$,g$+(o$-d$),lu,S$),tS=cu.getImageData(SA,g$+o$,lu,S$);y$&&es(tA.data,R$,M$,x$),v$(tA.data,tS.data,eS),cu.putImageData(tS,SA,g$+o$)}}function ds(t0,cu,lu,b0){const l1=b0[0],LE=b0[1],eS=b0[2]-l1,SA=b0[3]-LE;eS===0||SA===0||(Ko(cu.context,lu,eS,SA,cu.subtype,cu.backdrop,cu.transferMap,l1,LE,cu.offsetX,cu.offsetY),t0.save(),t0.globalAlpha=1,t0.globalCompositeOperation="source-over",t0.setTransform(1,0,0,1,0,0),t0.drawImage(lu.canvas,0,0),t0.restore())}function Il(t0,cu){const lu=gt.Util.singularValueDecompose2dScale(t0);lu[0]=Math.fround(lu[0]),lu[1]=Math.fround(lu[1]);const b0=Math.fround((globalThis.devicePixelRatio||1)*_t.PixelsPerInch.PDF_TO_CSS_UNITS);return cu!==void 0?cu:lu[0]<=b0||lu[1]<=b0}const ru=["butt","round","square"],uu=["miter","round","bevel"],p0={},X1={},Vx=class Vx{constructor(cu,lu,b0,l1,LE,{optionalContentConfig:eS,markedContentStack:SA=null},o$,h$){G$(this,W0);this.ctx=cu,this.current=new tn(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=lu,this.objs=b0,this.canvasFactory=l1,this.filterFactory=LE,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=SA||[],this.optionalContentConfig=eS,this.cachedCanvases=new zr(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o$,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h$,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(cu,lu=null){return typeof cu=="string"?cu.startsWith("g_")?this.commonObjs.get(cu):this.objs.get(cu):lu}beginDrawing({transform:cu,viewport:lu,transparency:b0=!1,background:l1=null}){const LE=this.ctx.canvas.width,eS=this.ctx.canvas.height,SA=this.ctx.fillStyle;if(this.ctx.fillStyle=l1||"#ffffff",this.ctx.fillRect(0,0,LE,eS),this.ctx.fillStyle=SA,b0){const o$=this.cachedCanvases.getCanvas("transparent",LE,eS);this.compositeCtx=this.ctx,this.transparentCanvas=o$.canvas,this.ctx=o$.context,this.ctx.save(),this.ctx.transform(...(0,_t.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),un(this.ctx),cu&&(this.ctx.transform(...cu),this.outputScaleX=cu[0],this.outputScaleY=cu[0]),this.ctx.transform(...lu.transform),this.viewportScale=lu.scale,this.baseTransform=(0,_t.getCurrentTransform)(this.ctx)}executeOperatorList(cu,lu,b0,l1){const LE=cu.argsArray,eS=cu.fnArray;let SA=lu||0;const o$=LE.length;if(o$===SA)return SA;const h$=o$-SA>Gt&&typeof b0=="function",d$=h$?Date.now()+Bt:0;let y$=0;const R$=this.commonObjs,M$=this.objs;let x$;for(;;){if(l1!==void 0&&SA===l1.nextBreakPoint)return l1.breakIt(SA,b0),SA;if(x$=eS[SA],x$!==gt.OPS.dependency)this[x$].apply(this,LE[SA]);else for(const v$ of LE[SA]){const rS=v$.startsWith("g_")?R$:M$;if(!rS.has(v$))return rS.get(v$,b0),SA}if(SA++,SA===o$)return SA;if(h$&&++y$>Gt){if(Date.now()>d$)return b0(),SA;y$=0}}}endDrawing(){L$(this,W0,uie).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const cu of this._cachedBitmapsMap.values()){for(const lu of cu.values())typeof HTMLCanvasElement<"u"&&lu instanceof HTMLCanvasElement&&(lu.width=lu.height=0);cu.clear()}this._cachedBitmapsMap.clear(),L$(this,W0,hie).call(this)}_scaleImage(cu,lu){const b0=cu.width,l1=cu.height;let LE=Math.max(Math.hypot(lu[0],lu[1]),1),eS=Math.max(Math.hypot(lu[2],lu[3]),1),SA=b0,o$=l1,h$="prescale1",d$,y$;for(;LE>2&&SA>1||eS>2&&o$>1;){let R$=SA,M$=o$;LE>2&&SA>1&&(R$=SA>=16384?Math.floor(SA/2)-1||1:Math.ceil(SA/2),LE/=SA/R$),eS>2&&o$>1&&(M$=o$>=16384?Math.floor(o$/2)-1||1:Math.ceil(o$)/2,eS/=o$/M$),d$=this.cachedCanvases.getCanvas(h$,R$,M$),y$=d$.context,y$.clearRect(0,0,R$,M$),y$.drawImage(cu,0,0,SA,o$,0,0,R$,M$),cu=d$.canvas,SA=R$,o$=M$,h$=h$==="prescale1"?"prescale2":"prescale1"}return{img:cu,paintWidth:SA,paintHeight:o$}}_createMaskCanvas(cu){const lu=this.ctx,{width:b0,height:l1}=cu,LE=this.current.fillColor,eS=this.current.patternFill,SA=(0,_t.getCurrentTransform)(lu);let o$,h$,d$,y$;if((cu.bitmap||cu.data)&&cu.count>1){const u$=cu.bitmap||cu.data.buffer;h$=JSON.stringify(eS?SA:[SA.slice(0,4),LE]),o$=this._cachedBitmapsMap.get(u$),o$||(o$=new Map,this._cachedBitmapsMap.set(u$,o$));const UE=o$.get(h$);if(UE&&!eS){const F$=Math.round(Math.min(SA[0],SA[2])+SA[4]),EI=Math.round(Math.min(SA[1],SA[3])+SA[5]);return{canvas:UE,offsetX:F$,offsetY:EI}}d$=UE}d$||(y$=this.cachedCanvases.getCanvas("maskCanvas",b0,l1),Tn(y$.context,cu));let R$=gt.Util.transform(SA,[1/b0,0,0,-1/l1,0,0]);R$=gt.Util.transform(R$,[1,0,0,1,0,-l1]);const M$=gt.Util.applyTransform([0,0],R$),x$=gt.Util.applyTransform([b0,l1],R$),v$=gt.Util.normalizeRect([M$[0],M$[1],x$[0],x$[1]]),rS=Math.round(v$[2]-v$[0])||1,wA=Math.round(v$[3]-v$[1])||1,g$=this.cachedCanvases.getCanvas("fillCanvas",rS,wA),S$=g$.context,tA=Math.min(M$[0],x$[0]),tS=Math.min(M$[1],x$[1]);S$.translate(-tA,-tS),S$.transform(...R$),d$||(d$=this._scaleImage(y$.canvas,(0,_t.getCurrentTransformInverse)(S$)),d$=d$.img,o$&&eS&&o$.set(h$,d$)),S$.imageSmoothingEnabled=Il((0,_t.getCurrentTransform)(S$),cu.interpolate),Fr(S$,d$,0,0,d$.width,d$.height,0,0,b0,l1),S$.globalCompositeOperation="source-in";const m$=gt.Util.transform((0,_t.getCurrentTransformInverse)(S$),[1,0,0,1,-tA,-tS]);return S$.fillStyle=eS?LE.getPattern(lu,this,m$,Et.PathType.FILL):LE,S$.fillRect(0,0,b0,l1),o$&&!eS&&(this.cachedCanvases.delete("fillCanvas"),o$.set(h$,g$.canvas)),{canvas:g$.canvas,offsetX:Math.round(tA),offsetY:Math.round(tS)}}setLineWidth(cu){cu!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=cu,this.ctx.lineWidth=cu}setLineCap(cu){this.ctx.lineCap=ru[cu]}setLineJoin(cu){this.ctx.lineJoin=uu[cu]}setMiterLimit(cu){this.ctx.miterLimit=cu}setDash(cu,lu){const b0=this.ctx;b0.setLineDash!==void 0&&(b0.setLineDash(cu),b0.lineDashOffset=lu)}setRenderingIntent(cu){}setFlatness(cu){}setGState(cu){for(const[lu,b0]of cu)switch(lu){case"LW":this.setLineWidth(b0);break;case"LC":this.setLineCap(b0);break;case"LJ":this.setLineJoin(b0);break;case"ML":this.setMiterLimit(b0);break;case"D":this.setDash(b0[0],b0[1]);break;case"RI":this.setRenderingIntent(b0);break;case"FL":this.setFlatness(b0);break;case"Font":this.setFont(b0[0],b0[1]);break;case"CA":this.current.strokeAlpha=b0;break;case"ca":this.current.fillAlpha=b0,this.ctx.globalAlpha=b0;break;case"BM":this.ctx.globalCompositeOperation=b0;break;case"SMask":this.current.activeSMask=b0?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(b0);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const cu=this.inSMaskMode;this.current.activeSMask&&!cu?this.beginSMaskMode():!this.current.activeSMask&&cu&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const cu=this.ctx.canvas.width,lu=this.ctx.canvas.height,b0="smaskGroupAt"+this.groupLevel,l1=this.cachedCanvases.getCanvas(b0,cu,lu);this.suspendedCtx=this.ctx,this.ctx=l1.context;const LE=this.ctx;LE.setTransform(...(0,_t.getCurrentTransform)(this.suspendedCtx)),$n(this.suspendedCtx,LE),Tr(LE,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),$n(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(cu){if(!this.current.activeSMask)return;cu?(cu[0]=Math.floor(cu[0]),cu[1]=Math.floor(cu[1]),cu[2]=Math.ceil(cu[2]),cu[3]=Math.ceil(cu[3])):cu=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const lu=this.current.activeSMask,b0=this.suspendedCtx;ds(b0,lu,this.ctx,cu),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?($n(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const cu=this.current;this.stateStack.push(cu),this.current=cu.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),$n(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(cu,lu,b0,l1,LE,eS){this.ctx.transform(cu,lu,b0,l1,LE,eS),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(cu,lu,b0){const l1=this.ctx,LE=this.current;let eS=LE.x,SA=LE.y,o$,h$;const d$=(0,_t.getCurrentTransform)(l1),y$=d$[0]===0&&d$[3]===0||d$[1]===0&&d$[2]===0,R$=y$?b0.slice(0):null;for(let M$=0,x$=0,v$=cu.length;M$<v$;M$++)switch(cu[M$]|0){case gt.OPS.rectangle:eS=lu[x$++],SA=lu[x$++];const rS=lu[x$++],wA=lu[x$++],g$=eS+rS,S$=SA+wA;l1.moveTo(eS,SA),rS===0||wA===0?l1.lineTo(g$,S$):(l1.lineTo(g$,SA),l1.lineTo(g$,S$),l1.lineTo(eS,S$)),y$||LE.updateRectMinMax(d$,[eS,SA,g$,S$]),l1.closePath();break;case gt.OPS.moveTo:eS=lu[x$++],SA=lu[x$++],l1.moveTo(eS,SA),y$||LE.updatePathMinMax(d$,eS,SA);break;case gt.OPS.lineTo:eS=lu[x$++],SA=lu[x$++],l1.lineTo(eS,SA),y$||LE.updatePathMinMax(d$,eS,SA);break;case gt.OPS.curveTo:o$=eS,h$=SA,eS=lu[x$+4],SA=lu[x$+5],l1.bezierCurveTo(lu[x$],lu[x$+1],lu[x$+2],lu[x$+3],eS,SA),LE.updateCurvePathMinMax(d$,o$,h$,lu[x$],lu[x$+1],lu[x$+2],lu[x$+3],eS,SA,R$),x$+=6;break;case gt.OPS.curveTo2:o$=eS,h$=SA,l1.bezierCurveTo(eS,SA,lu[x$],lu[x$+1],lu[x$+2],lu[x$+3]),LE.updateCurvePathMinMax(d$,o$,h$,eS,SA,lu[x$],lu[x$+1],lu[x$+2],lu[x$+3],R$),eS=lu[x$+2],SA=lu[x$+3],x$+=4;break;case gt.OPS.curveTo3:o$=eS,h$=SA,eS=lu[x$+2],SA=lu[x$+3],l1.bezierCurveTo(lu[x$],lu[x$+1],eS,SA,eS,SA),LE.updateCurvePathMinMax(d$,o$,h$,lu[x$],lu[x$+1],eS,SA,eS,SA,R$),x$+=4;break;case gt.OPS.closePath:l1.closePath();break}y$&&LE.updateScalingPathMinMax(d$,R$),LE.setCurrentPoint(eS,SA)}closePath(){this.ctx.closePath()}stroke(cu=!0){const lu=this.ctx,b0=this.current.strokeColor;lu.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof b0=="object"&&(b0!=null&&b0.getPattern)?(lu.save(),lu.strokeStyle=b0.getPattern(lu,this,(0,_t.getCurrentTransformInverse)(lu),Et.PathType.STROKE),this.rescaleAndStroke(!1),lu.restore()):this.rescaleAndStroke(!0)),cu&&this.consumePath(this.current.getClippedPathBoundingBox()),lu.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(cu=!0){const lu=this.ctx,b0=this.current.fillColor,l1=this.current.patternFill;let LE=!1;l1&&(lu.save(),lu.fillStyle=b0.getPattern(lu,this,(0,_t.getCurrentTransformInverse)(lu),Et.PathType.FILL),LE=!0);const eS=this.current.getClippedPathBoundingBox();this.contentVisible&&eS!==null&&(this.pendingEOFill?(lu.fill("evenodd"),this.pendingEOFill=!1):lu.fill()),LE&&lu.restore(),cu&&this.consumePath(eS)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=p0}eoClip(){this.pendingClip=X1}beginText(){this.current.textMatrix=gt.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const cu=this.pendingTextPaths,lu=this.ctx;if(cu===void 0){lu.beginPath();return}lu.save(),lu.beginPath();for(const b0 of cu)lu.setTransform(...b0.transform),lu.translate(b0.x,b0.y),b0.addToPath(lu,b0.fontSize);lu.restore(),lu.clip(),lu.beginPath(),delete this.pendingTextPaths}setCharSpacing(cu){this.current.charSpacing=cu}setWordSpacing(cu){this.current.wordSpacing=cu}setHScale(cu){this.current.textHScale=cu/100}setLeading(cu){this.current.leading=-cu}setFont(cu,lu){var d$;const b0=this.commonObjs.get(cu),l1=this.current;if(!b0)throw new Error(`Can't find font for ${cu}`);if(l1.fontMatrix=b0.fontMatrix||gt.FONT_IDENTITY_MATRIX,(l1.fontMatrix[0]===0||l1.fontMatrix[3]===0)&&(0,gt.warn)("Invalid font matrix for font "+cu),lu<0?(lu=-lu,l1.fontDirection=-1):l1.fontDirection=1,this.current.font=b0,this.current.fontSize=lu,b0.isType3Font)return;const LE=b0.loadedName||"sans-serif",eS=((d$=b0.systemFontInfo)==null?void 0:d$.css)||`"${LE}", ${b0.fallbackName}`;let SA="normal";b0.black?SA="900":b0.bold&&(SA="bold");const o$=b0.italic?"italic":"normal";let h$=lu;lu<Rt?h$=Rt:lu>Ft&&(h$=Ft),this.current.fontSizeScale=lu/h$,this.ctx.font=`${o$} ${SA} ${h$}px ${eS}`}setTextRenderingMode(cu){this.current.textRenderingMode=cu}setTextRise(cu){this.current.textRise=cu}moveText(cu,lu){this.current.x=this.current.lineX+=cu,this.current.y=this.current.lineY+=lu}setLeadingMoveText(cu,lu){this.setLeading(-lu),this.moveText(cu,lu)}setTextMatrix(cu,lu,b0,l1,LE,eS){this.current.textMatrix=[cu,lu,b0,l1,LE,eS],this.current.textMatrixScale=Math.hypot(cu,lu),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(cu,lu,b0,l1){const LE=this.ctx,eS=this.current,SA=eS.font,o$=eS.textRenderingMode,h$=eS.fontSize/eS.fontSizeScale,d$=o$&gt.TextRenderingMode.FILL_STROKE_MASK,y$=!!(o$&gt.TextRenderingMode.ADD_TO_PATH_FLAG),R$=eS.patternFill&&!SA.missingFile;let M$;(SA.disableFontFace||y$||R$)&&(M$=SA.getPathGenerator(this.commonObjs,cu)),SA.disableFontFace||R$?(LE.save(),LE.translate(lu,b0),LE.beginPath(),M$(LE,h$),l1&&LE.setTransform(...l1),(d$===gt.TextRenderingMode.FILL||d$===gt.TextRenderingMode.FILL_STROKE)&&LE.fill(),(d$===gt.TextRenderingMode.STROKE||d$===gt.TextRenderingMode.FILL_STROKE)&&LE.stroke(),LE.restore()):((d$===gt.TextRenderingMode.FILL||d$===gt.TextRenderingMode.FILL_STROKE)&&LE.fillText(cu,lu,b0),(d$===gt.TextRenderingMode.STROKE||d$===gt.TextRenderingMode.FILL_STROKE)&&LE.strokeText(cu,lu,b0)),y$&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,_t.getCurrentTransform)(LE),x:lu,y:b0,fontSize:h$,addToPath:M$})}get isFontSubpixelAAEnabled(){const{context:cu}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);cu.scale(1.5,1),cu.fillText("I",0,10);const lu=cu.getImageData(0,0,10,10).data;let b0=!1;for(let l1=3;l1<lu.length;l1+=4)if(lu[l1]>0&&lu[l1]<255){b0=!0;break}return(0,gt.shadow)(this,"isFontSubpixelAAEnabled",b0)}showText(cu){const lu=this.current,b0=lu.font;if(b0.isType3Font)return this.showType3Text(cu);const l1=lu.fontSize;if(l1===0)return;const LE=this.ctx,eS=lu.fontSizeScale,SA=lu.charSpacing,o$=lu.wordSpacing,h$=lu.fontDirection,d$=lu.textHScale*h$,y$=cu.length,R$=b0.vertical,M$=R$?1:-1,x$=b0.defaultVMetrics,v$=l1*lu.fontMatrix[0],rS=lu.textRenderingMode===gt.TextRenderingMode.FILL&&!b0.disableFontFace&&!lu.patternFill;LE.save(),LE.transform(...lu.textMatrix),LE.translate(lu.x,lu.y+lu.textRise),h$>0?LE.scale(d$,-1):LE.scale(d$,1);let wA;if(lu.patternFill){LE.save();const m$=lu.fillColor.getPattern(LE,this,(0,_t.getCurrentTransformInverse)(LE),Et.PathType.FILL);wA=(0,_t.getCurrentTransform)(LE),LE.restore(),LE.fillStyle=m$}let g$=lu.lineWidth;const S$=lu.textMatrixScale;if(S$===0||g$===0){const m$=lu.textRenderingMode&gt.TextRenderingMode.FILL_STROKE_MASK;(m$===gt.TextRenderingMode.STROKE||m$===gt.TextRenderingMode.FILL_STROKE)&&(g$=this.getSinglePixelWidth())}else g$/=S$;if(eS!==1&&(LE.scale(eS,eS),g$/=eS),LE.lineWidth=g$,b0.isInvalidPDFjsFont){const m$=[];let u$=0;for(const UE of cu)m$.push(UE.unicode),u$+=UE.width;LE.fillText(m$.join(""),0,0),lu.x+=u$*v$*d$,LE.restore(),this.compose();return}let tA=0,tS;for(tS=0;tS<y$;++tS){const m$=cu[tS];if(typeof m$=="number"){tA+=M$*m$*l1/1e3;continue}let u$=!1;const UE=(m$.isSpace?o$:0)+SA,F$=m$.fontChar,EI=m$.accent;let pR,X$,J$=m$.width;if(R$){const fL=m$.vmetric||x$,I7=-(m$.vmetric?fL[1]:J$*.5)*v$,j$=fL[2]*v$;J$=fL?-fL[0]:J$,pR=I7/eS,X$=(tA+j$)/eS}else pR=tA/eS,X$=0;if(b0.remeasure&&J$>0){const fL=LE.measureText(F$).width*1e3/l1*eS;if(J$<fL&&this.isFontSubpixelAAEnabled){const I7=J$/fL;u$=!0,LE.save(),LE.scale(I7,1),pR/=I7}else J$!==fL&&(pR+=(J$-fL)/2e3*l1/eS)}if(this.contentVisible&&(m$.isInFont||b0.missingFile)){if(rS&&!EI)LE.fillText(F$,pR,X$);else if(this.paintChar(F$,pR,X$,wA),EI){const fL=pR+l1*EI.offset.x/eS,I7=X$-l1*EI.offset.y/eS;this.paintChar(EI.fontChar,fL,I7,wA)}}const gD=R$?J$*v$-UE*h$:J$*v$+UE*h$;tA+=gD,u$&&LE.restore()}R$?lu.y-=tA:lu.x+=tA*d$,LE.restore(),this.compose()}showType3Text(cu){const lu=this.ctx,b0=this.current,l1=b0.font,LE=b0.fontSize,eS=b0.fontDirection,SA=l1.vertical?1:-1,o$=b0.charSpacing,h$=b0.wordSpacing,d$=b0.textHScale*eS,y$=b0.fontMatrix||gt.FONT_IDENTITY_MATRIX,R$=cu.length,M$=b0.textRenderingMode===gt.TextRenderingMode.INVISIBLE;let x$,v$,rS,wA;if(!(M$||LE===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,lu.save(),lu.transform(...b0.textMatrix),lu.translate(b0.x,b0.y),lu.scale(d$,eS),x$=0;x$<R$;++x$){if(v$=cu[x$],typeof v$=="number"){wA=SA*v$*LE/1e3,this.ctx.translate(wA,0),b0.x+=wA*d$;continue}const g$=(v$.isSpace?h$:0)+o$,S$=l1.charProcOperatorList[v$.operatorListId];if(!S$){(0,gt.warn)(`Type3 character "${v$.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=v$,this.save(),lu.scale(LE,LE),lu.transform(...y$),this.executeOperatorList(S$),this.restore()),rS=gt.Util.applyTransform([v$.width,0],y$)[0]*LE+g$,lu.translate(rS,0),b0.x+=rS*d$}lu.restore(),this.processingType3=null}}setCharWidth(cu,lu){}setCharWidthAndBounds(cu,lu,b0,l1,LE,eS){this.ctx.rect(b0,l1,LE-b0,eS-l1),this.ctx.clip(),this.endPath()}getColorN_Pattern(cu){let lu;if(cu[0]==="TilingPattern"){const b0=cu[1],l1=this.baseTransform||(0,_t.getCurrentTransform)(this.ctx),LE={createCanvasGraphics:eS=>new Vx(eS,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};lu=new Et.TilingPattern(cu,b0,this.ctx,LE,l1)}else lu=this._getPattern(cu[1],cu[2]);return lu}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(cu,lu,b0){const l1=gt.Util.makeHexColor(cu,lu,b0);this.ctx.strokeStyle=l1,this.current.strokeColor=l1}setFillRGBColor(cu,lu,b0){const l1=gt.Util.makeHexColor(cu,lu,b0);this.ctx.fillStyle=l1,this.current.fillColor=l1,this.current.patternFill=!1}_getPattern(cu,lu=null){let b0;return this.cachedPatterns.has(cu)?b0=this.cachedPatterns.get(cu):(b0=(0,Et.getShadingPattern)(this.getObject(cu)),this.cachedPatterns.set(cu,b0)),lu&&(b0.matrix=lu),b0}shadingFill(cu){if(!this.contentVisible)return;const lu=this.ctx;this.save();const b0=this._getPattern(cu);lu.fillStyle=b0.getPattern(lu,this,(0,_t.getCurrentTransformInverse)(lu),Et.PathType.SHADING);const l1=(0,_t.getCurrentTransformInverse)(lu);if(l1){const{width:LE,height:eS}=lu.canvas,[SA,o$,h$,d$]=gt.Util.getAxialAlignedBoundingBox([0,0,LE,eS],l1);this.ctx.fillRect(SA,o$,h$-SA,d$-o$)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,gt.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,gt.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(cu,lu){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(cu)&&cu.length===6&&this.transform(...cu),this.baseTransform=(0,_t.getCurrentTransform)(this.ctx),lu)){const b0=lu[2]-lu[0],l1=lu[3]-lu[1];this.ctx.rect(lu[0],lu[1],b0,l1),this.current.updateRectMinMax((0,_t.getCurrentTransform)(this.ctx),lu),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(cu){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const lu=this.ctx;cu.isolated||(0,gt.info)("TODO: Support non-isolated groups."),cu.knockout&&(0,gt.warn)("Knockout groups not supported.");const b0=(0,_t.getCurrentTransform)(lu);if(cu.matrix&&lu.transform(...cu.matrix),!cu.bbox)throw new Error("Bounding box is required.");let l1=gt.Util.getAxialAlignedBoundingBox(cu.bbox,(0,_t.getCurrentTransform)(lu));const LE=[0,0,lu.canvas.width,lu.canvas.height];l1=gt.Util.intersect(l1,LE)||[0,0,0,0];const eS=Math.floor(l1[0]),SA=Math.floor(l1[1]);let o$=Math.max(Math.ceil(l1[2])-eS,1),h$=Math.max(Math.ceil(l1[3])-SA,1),d$=1,y$=1;o$>Nt&&(d$=o$/Nt,o$=Nt),h$>Nt&&(y$=h$/Nt,h$=Nt),this.current.startNewPathAndClipBox([0,0,o$,h$]);let R$="groupAt"+this.groupLevel;cu.smask&&(R$+="_smask_"+this.smaskCounter++%2);const M$=this.cachedCanvases.getCanvas(R$,o$,h$),x$=M$.context;x$.scale(1/d$,1/y$),x$.translate(-eS,-SA),x$.transform(...b0),cu.smask?this.smaskStack.push({canvas:M$.canvas,context:x$,offsetX:eS,offsetY:SA,scaleX:d$,scaleY:y$,subtype:cu.smask.subtype,backdrop:cu.smask.backdrop,transferMap:cu.smask.transferMap||null,startTransformInverse:null}):(lu.setTransform(1,0,0,1,0,0),lu.translate(eS,SA),lu.scale(d$,y$),lu.save()),$n(lu,x$),this.ctx=x$,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(lu),this.groupLevel++}endGroup(cu){if(!this.contentVisible)return;this.groupLevel--;const lu=this.ctx,b0=this.groupStack.pop();if(this.ctx=b0,this.ctx.imageSmoothingEnabled=!1,cu.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const l1=(0,_t.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...l1);const LE=gt.Util.getAxialAlignedBoundingBox([0,0,lu.canvas.width,lu.canvas.height],l1);this.ctx.drawImage(lu.canvas,0,0),this.ctx.restore(),this.compose(LE)}}beginAnnotation(cu,lu,b0,l1,LE){if(L$(this,W0,uie).call(this),un(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(lu)&&lu.length===4){const eS=lu[2]-lu[0],SA=lu[3]-lu[1];if(LE&&this.annotationCanvasMap){b0=b0.slice(),b0[4]-=lu[0],b0[5]-=lu[1],lu=lu.slice(),lu[0]=lu[1]=0,lu[2]=eS,lu[3]=SA;const[o$,h$]=gt.Util.singularValueDecompose2dScale((0,_t.getCurrentTransform)(this.ctx)),{viewportScale:d$}=this,y$=Math.ceil(eS*this.outputScaleX*d$),R$=Math.ceil(SA*this.outputScaleY*d$);this.annotationCanvas=this.canvasFactory.create(y$,R$);const{canvas:M$,context:x$}=this.annotationCanvas;this.annotationCanvasMap.set(cu,M$),this.annotationCanvas.savedCtx=this.ctx,this.ctx=x$,this.ctx.save(),this.ctx.setTransform(o$,0,0,-h$,0,SA*h$),un(this.ctx)}else un(this.ctx),this.ctx.rect(lu[0],lu[1],eS,SA),this.ctx.clip(),this.endPath()}this.current=new tn(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...b0),this.transform(...l1)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),L$(this,W0,hie).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(cu){if(!this.contentVisible)return;const lu=cu.count;cu=this.getObject(cu.data,cu),cu.count=lu;const b0=this.ctx,l1=this.processingType3;if(l1&&(l1.compiled===void 0&&(l1.compiled=Nr(cu)),l1.compiled)){l1.compiled(b0);return}const LE=this._createMaskCanvas(cu),eS=LE.canvas;b0.save(),b0.setTransform(1,0,0,1,0,0),b0.drawImage(eS,LE.offsetX,LE.offsetY),b0.restore(),this.compose()}paintImageMaskXObjectRepeat(cu,lu,b0=0,l1=0,LE,eS){if(!this.contentVisible)return;cu=this.getObject(cu.data,cu);const SA=this.ctx;SA.save();const o$=(0,_t.getCurrentTransform)(SA);SA.transform(lu,b0,l1,LE,0,0);const h$=this._createMaskCanvas(cu);SA.setTransform(1,0,0,1,h$.offsetX-o$[4],h$.offsetY-o$[5]);for(let d$=0,y$=eS.length;d$<y$;d$+=2){const R$=gt.Util.transform(o$,[lu,b0,l1,LE,eS[d$],eS[d$+1]]),[M$,x$]=gt.Util.applyTransform([0,0],R$);SA.drawImage(h$.canvas,M$,x$)}SA.restore(),this.compose()}paintImageMaskXObjectGroup(cu){if(!this.contentVisible)return;const lu=this.ctx,b0=this.current.fillColor,l1=this.current.patternFill;for(const LE of cu){const{data:eS,width:SA,height:o$,transform:h$}=LE,d$=this.cachedCanvases.getCanvas("maskCanvas",SA,o$),y$=d$.context;y$.save();const R$=this.getObject(eS,LE);Tn(y$,R$),y$.globalCompositeOperation="source-in",y$.fillStyle=l1?b0.getPattern(y$,this,(0,_t.getCurrentTransformInverse)(lu),Et.PathType.FILL):b0,y$.fillRect(0,0,SA,o$),y$.restore(),lu.save(),lu.transform(...h$),lu.scale(1,-1),Fr(lu,d$.canvas,0,0,SA,o$,0,-1,1,1),lu.restore()}this.compose()}paintImageXObject(cu){if(!this.contentVisible)return;const lu=this.getObject(cu);if(!lu){(0,gt.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(lu)}paintImageXObjectRepeat(cu,lu,b0,l1){if(!this.contentVisible)return;const LE=this.getObject(cu);if(!LE){(0,gt.warn)("Dependent image isn't ready yet");return}const eS=LE.width,SA=LE.height,o$=[];for(let h$=0,d$=l1.length;h$<d$;h$+=2)o$.push({transform:[lu,0,0,b0,l1[h$],l1[h$+1]],x:0,y:0,w:eS,h:SA});this.paintInlineImageXObjectGroup(LE,o$)}applyTransferMapsToCanvas(cu){return this.current.transferMaps!=="none"&&(cu.filter=this.current.transferMaps,cu.drawImage(cu.canvas,0,0),cu.filter="none"),cu.canvas}applyTransferMapsToBitmap(cu){if(this.current.transferMaps==="none")return cu.bitmap;const{bitmap:lu,width:b0,height:l1}=cu,LE=this.cachedCanvases.getCanvas("inlineImage",b0,l1),eS=LE.context;return eS.filter=this.current.transferMaps,eS.drawImage(lu,0,0),eS.filter="none",LE.canvas}paintInlineImageXObject(cu){if(!this.contentVisible)return;const lu=cu.width,b0=cu.height,l1=this.ctx;if(this.save(),!gt.isNodeJS){const{filter:SA}=l1;SA!=="none"&&SA!==""&&(l1.filter="none")}l1.scale(1/lu,-1/b0);let LE;if(cu.bitmap)LE=this.applyTransferMapsToBitmap(cu);else if(typeof HTMLElement=="function"&&cu instanceof HTMLElement||!cu.data)LE=cu;else{const o$=this.cachedCanvases.getCanvas("inlineImage",lu,b0).context;rn(o$,cu),LE=this.applyTransferMapsToCanvas(o$)}const eS=this._scaleImage(LE,(0,_t.getCurrentTransformInverse)(l1));l1.imageSmoothingEnabled=Il((0,_t.getCurrentTransform)(l1),cu.interpolate),Fr(l1,eS.img,0,0,eS.paintWidth,eS.paintHeight,0,-b0,lu,b0),this.compose(),this.restore()}paintInlineImageXObjectGroup(cu,lu){if(!this.contentVisible)return;const b0=this.ctx;let l1;if(cu.bitmap)l1=cu.bitmap;else{const LE=cu.width,eS=cu.height,o$=this.cachedCanvases.getCanvas("inlineImage",LE,eS).context;rn(o$,cu),l1=this.applyTransferMapsToCanvas(o$)}for(const LE of lu)b0.save(),b0.transform(...LE.transform),b0.scale(1,-1),Fr(b0,l1,LE.x,LE.y,LE.w,LE.h,0,-1,1,1),b0.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(cu){}markPointProps(cu,lu){}beginMarkedContent(cu){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(cu,lu){cu==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(lu)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(cu){const lu=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(cu);const b0=this.ctx;this.pendingClip&&(lu||(this.pendingClip===X1?b0.clip("evenodd"):b0.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),b0.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const cu=(0,_t.getCurrentTransform)(this.ctx);if(cu[1]===0&&cu[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(cu[0]),Math.abs(cu[3]));else{const lu=Math.abs(cu[0]*cu[3]-cu[2]*cu[1]),b0=Math.hypot(cu[0],cu[2]),l1=Math.hypot(cu[1],cu[3]);this._cachedGetSinglePixelWidth=Math.max(b0,l1)/lu}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:cu}=this.current,{a:lu,b:b0,c:l1,d:LE}=this.ctx.getTransform();let eS,SA;if(b0===0&&l1===0){const o$=Math.abs(lu),h$=Math.abs(LE);if(o$===h$)if(cu===0)eS=SA=1/o$;else{const d$=o$*cu;eS=SA=d$<1?1/d$:1}else if(cu===0)eS=1/o$,SA=1/h$;else{const d$=o$*cu,y$=h$*cu;eS=d$<1?1/d$:1,SA=y$<1?1/y$:1}}else{const o$=Math.abs(lu*LE-b0*l1),h$=Math.hypot(lu,b0),d$=Math.hypot(l1,LE);if(cu===0)eS=d$/o$,SA=h$/o$;else{const y$=cu*o$;eS=d$>y$?d$/y$:1,SA=h$>y$?h$/y$:1}}this._cachedScaleForStroking[0]=eS,this._cachedScaleForStroking[1]=SA}return this._cachedScaleForStroking}rescaleAndStroke(cu){const{ctx:lu}=this,{lineWidth:b0}=this.current,[l1,LE]=this.getScaleForStroking();if(lu.lineWidth=b0||1,l1===1&&LE===1){lu.stroke();return}const eS=lu.getLineDash();if(cu&&lu.save(),lu.scale(l1,LE),eS.length>0){const SA=Math.max(l1,LE);lu.setLineDash(eS.map(o$=>o$/SA)),lu.lineDashOffset/=SA}lu.stroke(),cu&&lu.restore()}isContentVisible(){for(let cu=this.markedContentStack.length-1;cu>=0;cu--)if(!this.markedContentStack[cu].visible)return!1;return!0}};W0=new WeakSet,uie=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},hie=function(){if(this.pageColors){const cu=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(cu!=="none"){const lu=this.ctx.filter;this.ctx.filter=cu,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=lu}}};let q0=Vx;st.CanvasGraphics=q0;for(const t0 in gt.OPS)q0.prototype[t0]!==void 0&&(q0.prototype[gt.OPS[t0]]=q0.prototype[t0])},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.TilingPattern=st.PathType=void 0,st.getShadingPattern=Mr;var gt=mt(1),_t=mt(6);const Et={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};st.PathType=Et;function At(Nr,tn){if(!tn)return;const rn=tn[2]-tn[0],Tn=tn[3]-tn[1],$n=new Path2D;$n.rect(tn[0],tn[1],rn,Tn),Nr.clip($n)}class Rt{constructor(){this.constructor===Rt&&(0,gt.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,gt.unreachable)("Abstract method `getPattern` called.")}}class Ft extends Rt{constructor(tn){super(),this._type=tn[1],this._bbox=tn[2],this._colorStops=tn[3],this._p0=tn[4],this._p1=tn[5],this._r0=tn[6],this._r1=tn[7],this.matrix=null}_createGradient(tn){let rn;this._type==="axial"?rn=tn.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(rn=tn.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const Tn of this._colorStops)rn.addColorStop(Tn[0],Tn[1]);return rn}getPattern(tn,rn,Tn,$n){let un;if($n===Et.STROKE||$n===Et.FILL){const es=rn.current.getClippedPathBoundingBox($n,(0,_t.getCurrentTransform)(tn))||[0,0,0,0],kn=Math.ceil(es[2]-es[0])||1,ts=Math.ceil(es[3]-es[1])||1,Ko=rn.cachedCanvases.getCanvas("pattern",kn,ts,!0),ds=Ko.context;ds.clearRect(0,0,ds.canvas.width,ds.canvas.height),ds.beginPath(),ds.rect(0,0,ds.canvas.width,ds.canvas.height),ds.translate(-es[0],-es[1]),Tn=gt.Util.transform(Tn,[1,0,0,1,es[0],es[1]]),ds.transform(...rn.baseTransform),this.matrix&&ds.transform(...this.matrix),At(ds,this._bbox),ds.fillStyle=this._createGradient(ds),ds.fill(),un=tn.createPattern(Ko.canvas,"no-repeat");const Il=new DOMMatrix(Tn);un.setTransform(Il)}else At(tn,this._bbox),un=this._createGradient(tn);return un}}function Nt(Nr,tn,rn,Tn,$n,un,es,kn){const ts=tn.coords,Ko=tn.colors,ds=Nr.data,Il=Nr.width*4;let ru;ts[rn+1]>ts[Tn+1]&&(ru=rn,rn=Tn,Tn=ru,ru=un,un=es,es=ru),ts[Tn+1]>ts[$n+1]&&(ru=Tn,Tn=$n,$n=ru,ru=es,es=kn,kn=ru),ts[rn+1]>ts[Tn+1]&&(ru=rn,rn=Tn,Tn=ru,ru=un,un=es,es=ru);const uu=(ts[rn]+tn.offsetX)*tn.scaleX,p0=(ts[rn+1]+tn.offsetY)*tn.scaleY,X1=(ts[Tn]+tn.offsetX)*tn.scaleX,q0=(ts[Tn+1]+tn.offsetY)*tn.scaleY,W0=(ts[$n]+tn.offsetX)*tn.scaleX,hu=(ts[$n+1]+tn.offsetY)*tn.scaleY;if(p0>=hu)return;const a1=Ko[un],Vx=Ko[un+1],t0=Ko[un+2],cu=Ko[es],lu=Ko[es+1],b0=Ko[es+2],l1=Ko[kn],LE=Ko[kn+1],eS=Ko[kn+2],SA=Math.round(p0),o$=Math.round(hu);let h$,d$,y$,R$,M$,x$,v$,rS;for(let wA=SA;wA<=o$;wA++){if(wA<q0){const m$=wA<p0?0:(p0-wA)/(p0-q0);h$=uu-(uu-X1)*m$,d$=a1-(a1-cu)*m$,y$=Vx-(Vx-lu)*m$,R$=t0-(t0-b0)*m$}else{let m$;wA>hu?m$=1:q0===hu?m$=0:m$=(q0-wA)/(q0-hu),h$=X1-(X1-W0)*m$,d$=cu-(cu-l1)*m$,y$=lu-(lu-LE)*m$,R$=b0-(b0-eS)*m$}let g$;wA<p0?g$=0:wA>hu?g$=1:g$=(p0-wA)/(p0-hu),M$=uu-(uu-W0)*g$,x$=a1-(a1-l1)*g$,v$=Vx-(Vx-LE)*g$,rS=t0-(t0-eS)*g$;const S$=Math.round(Math.min(h$,M$)),tA=Math.round(Math.max(h$,M$));let tS=Il*wA+S$*4;for(let m$=S$;m$<=tA;m$++)g$=(h$-m$)/(h$-M$),g$<0?g$=0:g$>1&&(g$=1),ds[tS++]=d$-(d$-x$)*g$|0,ds[tS++]=y$-(y$-v$)*g$|0,ds[tS++]=R$-(R$-rS)*g$|0,ds[tS++]=255}}function Bt(Nr,tn,rn){const Tn=tn.coords,$n=tn.colors;let un,es;switch(tn.type){case"lattice":const kn=tn.verticesPerRow,ts=Math.floor(Tn.length/kn)-1,Ko=kn-1;for(un=0;un<ts;un++){let ds=un*kn;for(let Il=0;Il<Ko;Il++,ds++)Nt(Nr,rn,Tn[ds],Tn[ds+1],Tn[ds+kn],$n[ds],$n[ds+1],$n[ds+kn]),Nt(Nr,rn,Tn[ds+kn+1],Tn[ds+1],Tn[ds+kn],$n[ds+kn+1],$n[ds+1],$n[ds+kn])}break;case"triangles":for(un=0,es=Tn.length;un<es;un+=3)Nt(Nr,rn,Tn[un],Tn[un+1],Tn[un+2],$n[un],$n[un+1],$n[un+2]);break;default:throw new Error("illegal figure")}}class Gt extends Rt{constructor(tn){super(),this._coords=tn[2],this._colors=tn[3],this._figures=tn[4],this._bounds=tn[5],this._bbox=tn[7],this._background=tn[8],this.matrix=null}_createMeshCanvas(tn,rn,Tn){const kn=Math.floor(this._bounds[0]),ts=Math.floor(this._bounds[1]),Ko=Math.ceil(this._bounds[2])-kn,ds=Math.ceil(this._bounds[3])-ts,Il=Math.min(Math.ceil(Math.abs(Ko*tn[0]*1.1)),3e3),ru=Math.min(Math.ceil(Math.abs(ds*tn[1]*1.1)),3e3),uu=Ko/Il,p0=ds/ru,X1={coords:this._coords,colors:this._colors,offsetX:-kn,offsetY:-ts,scaleX:1/uu,scaleY:1/p0},q0=Il+2*2,W0=ru+2*2,hu=Tn.getCanvas("mesh",q0,W0,!1),a1=hu.context,Vx=a1.createImageData(Il,ru);if(rn){const cu=Vx.data;for(let lu=0,b0=cu.length;lu<b0;lu+=4)cu[lu]=rn[0],cu[lu+1]=rn[1],cu[lu+2]=rn[2],cu[lu+3]=255}for(const cu of this._figures)Bt(Vx,cu,X1);return a1.putImageData(Vx,2,2),{canvas:hu.canvas,offsetX:kn-2*uu,offsetY:ts-2*p0,scaleX:uu,scaleY:p0}}getPattern(tn,rn,Tn,$n){At(tn,this._bbox);let un;if($n===Et.SHADING)un=gt.Util.singularValueDecompose2dScale((0,_t.getCurrentTransform)(tn));else if(un=gt.Util.singularValueDecompose2dScale(rn.baseTransform),this.matrix){const kn=gt.Util.singularValueDecompose2dScale(this.matrix);un=[un[0]*kn[0],un[1]*kn[1]]}const es=this._createMeshCanvas(un,$n===Et.SHADING?null:this._background,rn.cachedCanvases);return $n!==Et.SHADING&&(tn.setTransform(...rn.baseTransform),this.matrix&&tn.transform(...this.matrix)),tn.translate(es.offsetX,es.offsetY),tn.scale(es.scaleX,es.scaleY),tn.createPattern(es.canvas,"no-repeat")}}class dr extends Rt{getPattern(){return"hotpink"}}function Mr(Nr){switch(Nr[0]){case"RadialAxial":return new Ft(Nr);case"Mesh":return new Gt(Nr);case"Dummy":return new dr}throw new Error(`Unknown IR type: ${Nr[0]}`)}const Tr={COLORED:1,UNCOLORED:2},Fr=class Fr{constructor(tn,rn,Tn,$n,un){this.operatorList=tn[2],this.matrix=tn[3]||[1,0,0,1,0,0],this.bbox=tn[4],this.xstep=tn[5],this.ystep=tn[6],this.paintType=tn[7],this.tilingType=tn[8],this.color=rn,this.ctx=Tn,this.canvasGraphicsFactory=$n,this.baseTransform=un}createPatternCanvas(tn){const rn=this.operatorList,Tn=this.bbox,$n=this.xstep,un=this.ystep,es=this.paintType,kn=this.tilingType,ts=this.color,Ko=this.canvasGraphicsFactory;(0,gt.info)("TilingType: "+kn);const ds=Tn[0],Il=Tn[1],ru=Tn[2],uu=Tn[3],p0=gt.Util.singularValueDecompose2dScale(this.matrix),X1=gt.Util.singularValueDecompose2dScale(this.baseTransform),q0=[p0[0]*X1[0],p0[1]*X1[1]],W0=this.getSizeAndScale($n,this.ctx.canvas.width,q0[0]),hu=this.getSizeAndScale(un,this.ctx.canvas.height,q0[1]),a1=tn.cachedCanvases.getCanvas("pattern",W0.size,hu.size,!0),Vx=a1.context,t0=Ko.createCanvasGraphics(Vx);t0.groupLevel=tn.groupLevel,this.setFillAndStrokeStyleToContext(t0,es,ts);let cu=ds,lu=Il,b0=ru,l1=uu;return ds<0&&(cu=0,b0+=Math.abs(ds)),Il<0&&(lu=0,l1+=Math.abs(Il)),Vx.translate(-(W0.scale*cu),-(hu.scale*lu)),t0.transform(W0.scale,0,0,hu.scale,0,0),Vx.save(),this.clipBbox(t0,cu,lu,b0,l1),t0.baseTransform=(0,_t.getCurrentTransform)(t0.ctx),t0.executeOperatorList(rn),t0.endDrawing(),{canvas:a1.canvas,scaleX:W0.scale,scaleY:hu.scale,offsetX:cu,offsetY:lu}}getSizeAndScale(tn,rn,Tn){tn=Math.abs(tn);const $n=Math.max(Fr.MAX_PATTERN_SIZE,rn);let un=Math.ceil(tn*Tn);return un>=$n?un=$n:Tn=un/tn,{scale:Tn,size:un}}clipBbox(tn,rn,Tn,$n,un){const es=$n-rn,kn=un-Tn;tn.ctx.rect(rn,Tn,es,kn),tn.current.updateRectMinMax((0,_t.getCurrentTransform)(tn.ctx),[rn,Tn,$n,un]),tn.clip(),tn.endPath()}setFillAndStrokeStyleToContext(tn,rn,Tn){const $n=tn.ctx,un=tn.current;switch(rn){case Tr.COLORED:const es=this.ctx;$n.fillStyle=es.fillStyle,$n.strokeStyle=es.strokeStyle,un.fillColor=es.fillStyle,un.strokeColor=es.strokeStyle;break;case Tr.UNCOLORED:const kn=gt.Util.makeHexColor(Tn[0],Tn[1],Tn[2]);$n.fillStyle=kn,$n.strokeStyle=kn,un.fillColor=kn,un.strokeColor=kn;break;default:throw new gt.FormatError(`Unsupported paint type: ${rn}`)}}getPattern(tn,rn,Tn,$n){let un=Tn;$n!==Et.SHADING&&(un=gt.Util.transform(un,rn.baseTransform),this.matrix&&(un=gt.Util.transform(un,this.matrix)));const es=this.createPatternCanvas(rn);let kn=new DOMMatrix(un);kn=kn.translate(es.offsetX,es.offsetY),kn=kn.scale(1/es.scaleX,1/es.scaleY);const ts=tn.createPattern(es.canvas,"repeat");return ts.setTransform(kn),ts}};lee(Fr,"MAX_PATTERN_SIZE",3e3);let zr=Fr;st.TilingPattern=zr},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.convertBlackAndWhiteToRGBA=Et,st.convertToRGBA=_t,st.grayToRGBA=Rt;var gt=mt(1);function _t(Ft){switch(Ft.kind){case gt.ImageKind.GRAYSCALE_1BPP:return Et(Ft);case gt.ImageKind.RGB_24BPP:return At(Ft)}return null}function Et({src:Ft,srcPos:Nt=0,dest:Bt,width:Gt,height:dr,nonBlackColor:Mr=4294967295,inverseDecode:Tr=!1}){const zr=gt.FeatureTest.isLittleEndian?4278190080:255,[Fr,Nr]=Tr?[Mr,zr]:[zr,Mr],tn=Gt>>3,rn=Gt&7,Tn=Ft.length;Bt=new Uint32Array(Bt.buffer);let $n=0;for(let un=0;un<dr;un++){for(const kn=Nt+tn;Nt<kn;Nt++){const ts=Nt<Tn?Ft[Nt]:255;Bt[$n++]=ts&128?Nr:Fr,Bt[$n++]=ts&64?Nr:Fr,Bt[$n++]=ts&32?Nr:Fr,Bt[$n++]=ts&16?Nr:Fr,Bt[$n++]=ts&8?Nr:Fr,Bt[$n++]=ts&4?Nr:Fr,Bt[$n++]=ts&2?Nr:Fr,Bt[$n++]=ts&1?Nr:Fr}if(rn===0)continue;const es=Nt<Tn?Ft[Nt++]:255;for(let kn=0;kn<rn;kn++)Bt[$n++]=es&1<<7-kn?Nr:Fr}return{srcPos:Nt,destPos:$n}}function At({src:Ft,srcPos:Nt=0,dest:Bt,destPos:Gt=0,width:dr,height:Mr}){let Tr=0;const zr=Ft.length>>2,Fr=new Uint32Array(Ft.buffer,Nt,zr);if(gt.FeatureTest.isLittleEndian){for(;Tr<zr-2;Tr+=3,Gt+=4){const Nr=Fr[Tr],tn=Fr[Tr+1],rn=Fr[Tr+2];Bt[Gt]=Nr|4278190080,Bt[Gt+1]=Nr>>>24|tn<<8|4278190080,Bt[Gt+2]=tn>>>16|rn<<16|4278190080,Bt[Gt+3]=rn>>>8|4278190080}for(let Nr=Tr*4,tn=Ft.length;Nr<tn;Nr+=3)Bt[Gt++]=Ft[Nr]|Ft[Nr+1]<<8|Ft[Nr+2]<<16|4278190080}else{for(;Tr<zr-2;Tr+=3,Gt+=4){const Nr=Fr[Tr],tn=Fr[Tr+1],rn=Fr[Tr+2];Bt[Gt]=Nr|255,Bt[Gt+1]=Nr<<24|tn>>>8|255,Bt[Gt+2]=tn<<16|rn>>>16|255,Bt[Gt+3]=rn<<8|255}for(let Nr=Tr*4,tn=Ft.length;Nr<tn;Nr+=3)Bt[Gt++]=Ft[Nr]<<24|Ft[Nr+1]<<16|Ft[Nr+2]<<8|255}return{srcPos:Nt,destPos:Gt}}function Rt(Ft,Nt){if(gt.FeatureTest.isLittleEndian)for(let Bt=0,Gt=Ft.length;Bt<Gt;Bt++)Nt[Bt]=Ft[Bt]*65793|4278190080;else for(let Bt=0,Gt=Ft.length;Bt<Gt;Bt++)Nt[Bt]=Ft[Bt]*16843008|255}},(nt,st)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.GlobalWorkerOptions=void 0;const mt=Object.create(null);st.GlobalWorkerOptions=mt,mt.workerPort=null,mt.workerSrc=""},(nt,st,mt)=>{var Ft,tre,ire,Tte;Object.defineProperty(st,"__esModule",{value:!0}),st.MessageHandler=void 0;var gt=mt(1);const _t={UNKNOWN:0,DATA:1,ERROR:2},Et={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function At(dr){switch(dr instanceof Error||typeof dr=="object"&&dr!==null||(0,gt.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),dr.name){case"AbortException":return new gt.AbortException(dr.message);case"MissingPDFException":return new gt.MissingPDFException(dr.message);case"PasswordException":return new gt.PasswordException(dr.message,dr.code);case"UnexpectedResponseException":return new gt.UnexpectedResponseException(dr.message,dr.status);case"UnknownErrorException":return new gt.UnknownErrorException(dr.message,dr.details);default:return new gt.UnknownErrorException(dr.message,dr.toString())}}class Rt{constructor(Mr,Tr,zr){G$(this,Ft);this.sourceName=Mr,this.targetName=Tr,this.comObj=zr,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=Fr=>{const Nr=Fr.data;if(Nr.targetName!==this.sourceName)return;if(Nr.stream){L$(this,Ft,ire).call(this,Nr);return}if(Nr.callback){const rn=Nr.callbackId,Tn=this.callbackCapabilities[rn];if(!Tn)throw new Error(`Cannot resolve callback ${rn}`);if(delete this.callbackCapabilities[rn],Nr.callback===_t.DATA)Tn.resolve(Nr.data);else if(Nr.callback===_t.ERROR)Tn.reject(At(Nr.reason));else throw new Error("Unexpected callback case");return}const tn=this.actionHandler[Nr.action];if(!tn)throw new Error(`Unknown action from worker: ${Nr.action}`);if(Nr.callbackId){const rn=this.sourceName,Tn=Nr.sourceName;new Promise(function($n){$n(tn(Nr.data))}).then(function($n){zr.postMessage({sourceName:rn,targetName:Tn,callback:_t.DATA,callbackId:Nr.callbackId,data:$n})},function($n){zr.postMessage({sourceName:rn,targetName:Tn,callback:_t.ERROR,callbackId:Nr.callbackId,reason:At($n)})});return}if(Nr.streamId){L$(this,Ft,tre).call(this,Nr);return}tn(Nr.data)},zr.addEventListener("message",this._onComObjOnMessage)}on(Mr,Tr){const zr=this.actionHandler;if(zr[Mr])throw new Error(`There is already an actionName called "${Mr}"`);zr[Mr]=Tr}send(Mr,Tr,zr){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:Mr,data:Tr},zr)}sendWithPromise(Mr,Tr,zr){const Fr=this.callbackId++,Nr=new gt.PromiseCapability;this.callbackCapabilities[Fr]=Nr;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:Mr,callbackId:Fr,data:Tr},zr)}catch(tn){Nr.reject(tn)}return Nr.promise}sendWithStream(Mr,Tr,zr,Fr){const Nr=this.streamId++,tn=this.sourceName,rn=this.targetName,Tn=this.comObj;return new ReadableStream({start:$n=>{const un=new gt.PromiseCapability;return this.streamControllers[Nr]={controller:$n,startCall:un,pullCall:null,cancelCall:null,isClosed:!1},Tn.postMessage({sourceName:tn,targetName:rn,action:Mr,streamId:Nr,data:Tr,desiredSize:$n.desiredSize},Fr),un.promise},pull:$n=>{const un=new gt.PromiseCapability;return this.streamControllers[Nr].pullCall=un,Tn.postMessage({sourceName:tn,targetName:rn,stream:Et.PULL,streamId:Nr,desiredSize:$n.desiredSize}),un.promise},cancel:$n=>{(0,gt.assert)($n instanceof Error,"cancel must have a valid reason");const un=new gt.PromiseCapability;return this.streamControllers[Nr].cancelCall=un,this.streamControllers[Nr].isClosed=!0,Tn.postMessage({sourceName:tn,targetName:rn,stream:Et.CANCEL,streamId:Nr,reason:At($n)}),un.promise}},zr)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}Ft=new WeakSet,tre=function(Mr){const Tr=Mr.streamId,zr=this.sourceName,Fr=Mr.sourceName,Nr=this.comObj,tn=this,rn=this.actionHandler[Mr.action],Tn={enqueue($n,un=1,es){if(this.isCancelled)return;const kn=this.desiredSize;this.desiredSize-=un,kn>0&&this.desiredSize<=0&&(this.sinkCapability=new gt.PromiseCapability,this.ready=this.sinkCapability.promise),Nr.postMessage({sourceName:zr,targetName:Fr,stream:Et.ENQUEUE,streamId:Tr,chunk:$n},es)},close(){this.isCancelled||(this.isCancelled=!0,Nr.postMessage({sourceName:zr,targetName:Fr,stream:Et.CLOSE,streamId:Tr}),delete tn.streamSinks[Tr])},error($n){(0,gt.assert)($n instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,Nr.postMessage({sourceName:zr,targetName:Fr,stream:Et.ERROR,streamId:Tr,reason:At($n)}))},sinkCapability:new gt.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:Mr.desiredSize,ready:null};Tn.sinkCapability.resolve(),Tn.ready=Tn.sinkCapability.promise,this.streamSinks[Tr]=Tn,new Promise(function($n){$n(rn(Mr.data,Tn))}).then(function(){Nr.postMessage({sourceName:zr,targetName:Fr,stream:Et.START_COMPLETE,streamId:Tr,success:!0})},function($n){Nr.postMessage({sourceName:zr,targetName:Fr,stream:Et.START_COMPLETE,streamId:Tr,reason:At($n)})})},ire=function(Mr){const Tr=Mr.streamId,zr=this.sourceName,Fr=Mr.sourceName,Nr=this.comObj,tn=this.streamControllers[Tr],rn=this.streamSinks[Tr];switch(Mr.stream){case Et.START_COMPLETE:Mr.success?tn.startCall.resolve():tn.startCall.reject(At(Mr.reason));break;case Et.PULL_COMPLETE:Mr.success?tn.pullCall.resolve():tn.pullCall.reject(At(Mr.reason));break;case Et.PULL:if(!rn){Nr.postMessage({sourceName:zr,targetName:Fr,stream:Et.PULL_COMPLETE,streamId:Tr,success:!0});break}rn.desiredSize<=0&&Mr.desiredSize>0&&rn.sinkCapability.resolve(),rn.desiredSize=Mr.desiredSize,new Promise(function(Tn){var $n;Tn(($n=rn.onPull)==null?void 0:$n.call(rn))}).then(function(){Nr.postMessage({sourceName:zr,targetName:Fr,stream:Et.PULL_COMPLETE,streamId:Tr,success:!0})},function(Tn){Nr.postMessage({sourceName:zr,targetName:Fr,stream:Et.PULL_COMPLETE,streamId:Tr,reason:At(Tn)})});break;case Et.ENQUEUE:if((0,gt.assert)(tn,"enqueue should have stream controller"),tn.isClosed)break;tn.controller.enqueue(Mr.chunk);break;case Et.CLOSE:if((0,gt.assert)(tn,"close should have stream controller"),tn.isClosed)break;tn.isClosed=!0,tn.controller.close(),L$(this,Ft,Tte).call(this,tn,Tr);break;case Et.ERROR:(0,gt.assert)(tn,"error should have stream controller"),tn.controller.error(At(Mr.reason)),L$(this,Ft,Tte).call(this,tn,Tr);break;case Et.CANCEL_COMPLETE:Mr.success?tn.cancelCall.resolve():tn.cancelCall.reject(At(Mr.reason)),L$(this,Ft,Tte).call(this,tn,Tr);break;case Et.CANCEL:if(!rn)break;new Promise(function(Tn){var $n;Tn(($n=rn.onCancel)==null?void 0:$n.call(rn,At(Mr.reason)))}).then(function(){Nr.postMessage({sourceName:zr,targetName:Fr,stream:Et.CANCEL_COMPLETE,streamId:Tr,success:!0})},function(Tn){Nr.postMessage({sourceName:zr,targetName:Fr,stream:Et.CANCEL_COMPLETE,streamId:Tr,reason:At(Tn)})}),rn.sinkCapability.reject(At(Mr.reason)),rn.isCancelled=!0,delete this.streamSinks[Tr];break;default:throw new Error("Unexpected stream case")}},Tte=async function(Mr,Tr){var zr,Fr,Nr;await Promise.allSettled([(zr=Mr.startCall)==null?void 0:zr.promise,(Fr=Mr.pullCall)==null?void 0:Fr.promise,(Nr=Mr.cancelCall)==null?void 0:Nr.promise]),delete this.streamControllers[Tr]},st.MessageHandler=Rt},(nt,st,mt)=>{var Et,At;Object.defineProperty(st,"__esModule",{value:!0}),st.Metadata=void 0;var gt=mt(1);class _t{constructor({parsedData:Ft,rawData:Nt}){G$(this,Et);G$(this,At);K$(this,Et,Ft),K$(this,At,Nt)}getRaw(){return Sv(this,At)}get(Ft){return Sv(this,Et).get(Ft)??null}getAll(){return(0,gt.objectFromMap)(Sv(this,Et))}has(Ft){return Sv(this,Et).has(Ft)}}Et=new WeakMap,At=new WeakMap,st.Metadata=_t},(nt,st,mt)=>{var Ft,Nt,Bt,Gt,dr,Mr,die;Object.defineProperty(st,"__esModule",{value:!0}),st.OptionalContentConfig=void 0;var gt=mt(1),_t=mt(8);const Et=Symbol("INTERNAL");class At{constructor(Fr,Nr){G$(this,Ft,!0);this.name=Fr,this.intent=Nr}get visible(){return Sv(this,Ft)}_setVisible(Fr,Nr){Fr!==Et&&(0,gt.unreachable)("Internal method `_setVisible` called."),K$(this,Ft,Nr)}}Ft=new WeakMap;class Rt{constructor(Fr){G$(this,Mr);G$(this,Nt,null);G$(this,Bt,new Map);G$(this,Gt,null);G$(this,dr,null);if(this.name=null,this.creator=null,Fr!==null){this.name=Fr.name,this.creator=Fr.creator,K$(this,dr,Fr.order);for(const Nr of Fr.groups)Sv(this,Bt).set(Nr.id,new At(Nr.name,Nr.intent));if(Fr.baseState==="OFF")for(const Nr of Sv(this,Bt).values())Nr._setVisible(Et,!1);for(const Nr of Fr.on)Sv(this,Bt).get(Nr)._setVisible(Et,!0);for(const Nr of Fr.off)Sv(this,Bt).get(Nr)._setVisible(Et,!1);K$(this,Gt,this.getHash())}}isVisible(Fr){if(Sv(this,Bt).size===0)return!0;if(!Fr)return(0,gt.warn)("Optional content group not defined."),!0;if(Fr.type==="OCG")return Sv(this,Bt).has(Fr.id)?Sv(this,Bt).get(Fr.id).visible:((0,gt.warn)(`Optional content group not found: ${Fr.id}`),!0);if(Fr.type==="OCMD"){if(Fr.expression)return L$(this,Mr,die).call(this,Fr.expression);if(!Fr.policy||Fr.policy==="AnyOn"){for(const Nr of Fr.ids){if(!Sv(this,Bt).has(Nr))return(0,gt.warn)(`Optional content group not found: ${Nr}`),!0;if(Sv(this,Bt).get(Nr).visible)return!0}return!1}else if(Fr.policy==="AllOn"){for(const Nr of Fr.ids){if(!Sv(this,Bt).has(Nr))return(0,gt.warn)(`Optional content group not found: ${Nr}`),!0;if(!Sv(this,Bt).get(Nr).visible)return!1}return!0}else if(Fr.policy==="AnyOff"){for(const Nr of Fr.ids){if(!Sv(this,Bt).has(Nr))return(0,gt.warn)(`Optional content group not found: ${Nr}`),!0;if(!Sv(this,Bt).get(Nr).visible)return!0}return!1}else if(Fr.policy==="AllOff"){for(const Nr of Fr.ids){if(!Sv(this,Bt).has(Nr))return(0,gt.warn)(`Optional content group not found: ${Nr}`),!0;if(Sv(this,Bt).get(Nr).visible)return!1}return!0}return(0,gt.warn)(`Unknown optional content policy ${Fr.policy}.`),!0}return(0,gt.warn)(`Unknown group type ${Fr.type}.`),!0}setVisibility(Fr,Nr=!0){if(!Sv(this,Bt).has(Fr)){(0,gt.warn)(`Optional content group not found: ${Fr}`);return}Sv(this,Bt).get(Fr)._setVisible(Et,!!Nr),K$(this,Nt,null)}get hasInitialVisibility(){return Sv(this,Gt)===null||this.getHash()===Sv(this,Gt)}getOrder(){return Sv(this,Bt).size?Sv(this,dr)?Sv(this,dr).slice():[...Sv(this,Bt).keys()]:null}getGroups(){return Sv(this,Bt).size>0?(0,gt.objectFromMap)(Sv(this,Bt)):null}getGroup(Fr){return Sv(this,Bt).get(Fr)||null}getHash(){if(Sv(this,Nt)!==null)return Sv(this,Nt);const Fr=new _t.MurmurHash3_64;for(const[Nr,tn]of Sv(this,Bt))Fr.update(`${Nr}:${tn.visible}`);return K$(this,Nt,Fr.hexdigest())}}Nt=new WeakMap,Bt=new WeakMap,Gt=new WeakMap,dr=new WeakMap,Mr=new WeakSet,die=function(Fr){const Nr=Fr.length;if(Nr<2)return!0;const tn=Fr[0];for(let rn=1;rn<Nr;rn++){const Tn=Fr[rn];let $n;if(Array.isArray(Tn))$n=L$(this,Mr,die).call(this,Tn);else if(Sv(this,Bt).has(Tn))$n=Sv(this,Bt).get(Tn).visible;else return(0,gt.warn)(`Optional content group not found: ${Tn}`),!0;switch(tn){case"And":if(!$n)return!1;break;case"Or":if($n)return!0;break;case"Not":return!$n;default:return!0}}return tn==="And"},st.OptionalContentConfig=Rt},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.PDFDataTransportStream=void 0;var gt=mt(1),_t=mt(6);class Et{constructor({length:Nt,initialData:Bt,progressiveDone:Gt=!1,contentDispositionFilename:dr=null,disableRange:Mr=!1,disableStream:Tr=!1},zr){if((0,gt.assert)(zr,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=Gt,this._contentDispositionFilename=dr,(Bt==null?void 0:Bt.length)>0){const Fr=Bt instanceof Uint8Array&&Bt.byteLength===Bt.buffer.byteLength?Bt.buffer:new Uint8Array(Bt).buffer;this._queuedChunks.push(Fr)}this._pdfDataRangeTransport=zr,this._isStreamingSupported=!Tr,this._isRangeSupported=!Mr,this._contentLength=Nt,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((Fr,Nr)=>{this._onReceiveData({begin:Fr,chunk:Nr})}),this._pdfDataRangeTransport.addProgressListener((Fr,Nr)=>{this._onProgress({loaded:Fr,total:Nr})}),this._pdfDataRangeTransport.addProgressiveReadListener(Fr=>{this._onReceiveData({chunk:Fr})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:Nt,chunk:Bt}){const Gt=Bt instanceof Uint8Array&&Bt.byteLength===Bt.buffer.byteLength?Bt.buffer:new Uint8Array(Bt).buffer;if(Nt===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(Gt):this._queuedChunks.push(Gt);else{const dr=this._rangeReaders.some(function(Mr){return Mr._begin!==Nt?!1:(Mr._enqueue(Gt),!0)});(0,gt.assert)(dr,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var Nt;return((Nt=this._fullRequestReader)==null?void 0:Nt._loaded)??0}_onProgress(Nt){var Bt,Gt,dr,Mr;Nt.total===void 0?(Gt=(Bt=this._rangeReaders[0])==null?void 0:Bt.onProgress)==null||Gt.call(Bt,{loaded:Nt.loaded}):(Mr=(dr=this._fullRequestReader)==null?void 0:dr.onProgress)==null||Mr.call(dr,{loaded:Nt.loaded,total:Nt.total})}_onProgressiveDone(){var Nt;(Nt=this._fullRequestReader)==null||Nt.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(Nt){const Bt=this._rangeReaders.indexOf(Nt);Bt>=0&&this._rangeReaders.splice(Bt,1)}getFullReader(){(0,gt.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const Nt=this._queuedChunks;return this._queuedChunks=null,new At(this,Nt,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(Nt,Bt){if(Bt<=this._progressiveDataLength)return null;const Gt=new Rt(this,Nt,Bt);return this._pdfDataRangeTransport.requestDataRange(Nt,Bt),this._rangeReaders.push(Gt),Gt}cancelAllRequests(Nt){var Bt;(Bt=this._fullRequestReader)==null||Bt.cancel(Nt);for(const Gt of this._rangeReaders.slice(0))Gt.cancel(Nt);this._pdfDataRangeTransport.abort()}}st.PDFDataTransportStream=Et;class At{constructor(Nt,Bt,Gt=!1,dr=null){this._stream=Nt,this._done=Gt||!1,this._filename=(0,_t.isPdfFile)(dr)?dr:null,this._queuedChunks=Bt||[],this._loaded=0;for(const Mr of this._queuedChunks)this._loaded+=Mr.byteLength;this._requests=[],this._headersReady=Promise.resolve(),Nt._fullRequestReader=this,this.onProgress=null}_enqueue(Nt){this._done||(this._requests.length>0?this._requests.shift().resolve({value:Nt,done:!1}):this._queuedChunks.push(Nt),this._loaded+=Nt.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const Nt=new gt.PromiseCapability;return this._requests.push(Nt),Nt.promise}cancel(Nt){this._done=!0;for(const Bt of this._requests)Bt.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Rt{constructor(Nt,Bt,Gt){this._stream=Nt,this._begin=Bt,this._end=Gt,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(Nt){if(!this._done){if(this._requests.length===0)this._queuedChunk=Nt;else{this._requests.shift().resolve({value:Nt,done:!1});for(const Gt of this._requests)Gt.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const Bt=this._queuedChunk;return this._queuedChunk=null,{value:Bt,done:!1}}if(this._done)return{value:void 0,done:!0};const Nt=new gt.PromiseCapability;return this._requests.push(Nt),Nt.promise}cancel(Nt){this._done=!0;for(const Bt of this._requests)Bt.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.PDFFetchStream=void 0;var gt=mt(1),_t=mt(20);function Et(Gt,dr,Mr){return{method:"GET",headers:Gt,signal:Mr.signal,mode:"cors",credentials:dr?"include":"same-origin",redirect:"follow"}}function At(Gt){const dr=new Headers;for(const Mr in Gt){const Tr=Gt[Mr];Tr!==void 0&&dr.append(Mr,Tr)}return dr}function Rt(Gt){return Gt instanceof Uint8Array?Gt.buffer:Gt instanceof ArrayBuffer?Gt:((0,gt.warn)(`getArrayBuffer - unexpected data format: ${Gt}`),new Uint8Array(Gt).buffer)}class Ft{constructor(dr){this.source=dr,this.isHttp=/^https?:/i.test(dr.url),this.httpHeaders=this.isHttp&&dr.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var dr;return((dr=this._fullRequestReader)==null?void 0:dr._loaded)??0}getFullReader(){return(0,gt.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Nt(this),this._fullRequestReader}getRangeReader(dr,Mr){if(Mr<=this._progressiveDataLength)return null;const Tr=new Bt(this,dr,Mr);return this._rangeRequestReaders.push(Tr),Tr}cancelAllRequests(dr){var Mr;(Mr=this._fullRequestReader)==null||Mr.cancel(dr);for(const Tr of this._rangeRequestReaders.slice(0))Tr.cancel(dr)}}st.PDFFetchStream=Ft;class Nt{constructor(dr){this._stream=dr,this._reader=null,this._loaded=0,this._filename=null;const Mr=dr.source;this._withCredentials=Mr.withCredentials||!1,this._contentLength=Mr.length,this._headersCapability=new gt.PromiseCapability,this._disableRange=Mr.disableRange||!1,this._rangeChunkSize=Mr.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!Mr.disableStream,this._isRangeSupported=!Mr.disableRange,this._headers=At(this._stream.httpHeaders);const Tr=Mr.url;fetch(Tr,Et(this._headers,this._withCredentials,this._abortController)).then(zr=>{if(!(0,_t.validateResponseStatus)(zr.status))throw(0,_t.createResponseStatusError)(zr.status,Tr);this._reader=zr.body.getReader(),this._headersCapability.resolve();const Fr=rn=>zr.headers.get(rn),{allowRangeRequests:Nr,suggestedLength:tn}=(0,_t.validateRangeRequestCapabilities)({getResponseHeader:Fr,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Nr,this._contentLength=tn||this._contentLength,this._filename=(0,_t.extractFilenameFromHeader)(Fr),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new gt.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Tr;await this._headersCapability.promise;const{value:dr,done:Mr}=await this._reader.read();return Mr?{value:dr,done:Mr}:(this._loaded+=dr.byteLength,(Tr=this.onProgress)==null||Tr.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Rt(dr),done:!1})}cancel(dr){var Mr;(Mr=this._reader)==null||Mr.cancel(dr),this._abortController.abort()}}class Bt{constructor(dr,Mr,Tr){this._stream=dr,this._reader=null,this._loaded=0;const zr=dr.source;this._withCredentials=zr.withCredentials||!1,this._readCapability=new gt.PromiseCapability,this._isStreamingSupported=!zr.disableStream,this._abortController=new AbortController,this._headers=At(this._stream.httpHeaders),this._headers.append("Range",`bytes=${Mr}-${Tr-1}`);const Fr=zr.url;fetch(Fr,Et(this._headers,this._withCredentials,this._abortController)).then(Nr=>{if(!(0,_t.validateResponseStatus)(Nr.status))throw(0,_t.createResponseStatusError)(Nr.status,Fr);this._readCapability.resolve(),this._reader=Nr.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Tr;await this._readCapability.promise;const{value:dr,done:Mr}=await this._reader.read();return Mr?{value:dr,done:Mr}:(this._loaded+=dr.byteLength,(Tr=this.onProgress)==null||Tr.call(this,{loaded:this._loaded}),{value:Rt(dr),done:!1})}cancel(dr){var Mr;(Mr=this._reader)==null||Mr.cancel(dr),this._abortController.abort()}}},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.createResponseStatusError=Ft,st.extractFilenameFromHeader=Rt,st.validateRangeRequestCapabilities=At,st.validateResponseStatus=Nt;var gt=mt(1),_t=mt(21),Et=mt(6);function At({getResponseHeader:Bt,isHttp:Gt,rangeChunkSize:dr,disableRange:Mr}){const Tr={allowRangeRequests:!1,suggestedLength:void 0},zr=parseInt(Bt("Content-Length"),10);return!Number.isInteger(zr)||(Tr.suggestedLength=zr,zr<=2*dr)||Mr||!Gt||Bt("Accept-Ranges")!=="bytes"||(Bt("Content-Encoding")||"identity")!=="identity"||(Tr.allowRangeRequests=!0),Tr}function Rt(Bt){const Gt=Bt("Content-Disposition");if(Gt){let dr=(0,_t.getFilenameFromContentDispositionHeader)(Gt);if(dr.includes("%"))try{dr=decodeURIComponent(dr)}catch{}if((0,Et.isPdfFile)(dr))return dr}return null}function Ft(Bt,Gt){return Bt===404||Bt===0&&Gt.startsWith("file:")?new gt.MissingPDFException('Missing PDF "'+Gt+'".'):new gt.UnexpectedResponseException(`Unexpected server response (${Bt}) while retrieving PDF "${Gt}".`,Bt)}function Nt(Bt){return Bt===200||Bt===206}},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.getFilenameFromContentDispositionHeader=_t;var gt=mt(1);function _t(Et){let At=!0,Rt=Ft("filename\\*","i").exec(Et);if(Rt){Rt=Rt[1];let zr=dr(Rt);return zr=unescape(zr),zr=Mr(zr),zr=Tr(zr),Bt(zr)}if(Rt=Gt(Et),Rt){const zr=Tr(Rt);return Bt(zr)}if(Rt=Ft("filename","i").exec(Et),Rt){Rt=Rt[1];let zr=dr(Rt);return zr=Tr(zr),Bt(zr)}function Ft(zr,Fr){return new RegExp("(?:^|;)\\s*"+zr+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',Fr)}function Nt(zr,Fr){if(zr){if(!/^[\x00-\xFF]+$/.test(Fr))return Fr;try{const Nr=new TextDecoder(zr,{fatal:!0}),tn=(0,gt.stringToBytes)(Fr);Fr=Nr.decode(tn),At=!1}catch{}}return Fr}function Bt(zr){return At&&/[\x80-\xff]/.test(zr)&&(zr=Nt("utf-8",zr),At&&(zr=Nt("iso-8859-1",zr))),zr}function Gt(zr){const Fr=[];let Nr;const tn=Ft("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(Nr=tn.exec(zr))!==null;){let[,Tn,$n,un]=Nr;if(Tn=parseInt(Tn,10),Tn in Fr){if(Tn===0)break;continue}Fr[Tn]=[$n,un]}const rn=[];for(let Tn=0;Tn<Fr.length&&Tn in Fr;++Tn){let[$n,un]=Fr[Tn];un=dr(un),$n&&(un=unescape(un),Tn===0&&(un=Mr(un))),rn.push(un)}return rn.join("")}function dr(zr){if(zr.startsWith('"')){const Fr=zr.slice(1).split('\\"');for(let Nr=0;Nr<Fr.length;++Nr){const tn=Fr[Nr].indexOf('"');tn!==-1&&(Fr[Nr]=Fr[Nr].slice(0,tn),Fr.length=Nr+1),Fr[Nr]=Fr[Nr].replaceAll(/\\(.)/g,"$1")}zr=Fr.join('"')}return zr}function Mr(zr){const Fr=zr.indexOf("'");if(Fr===-1)return zr;const Nr=zr.slice(0,Fr),rn=zr.slice(Fr+1).replace(/^[^']*'/,"");return Nt(Nr,rn)}function Tr(zr){return!zr.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(zr)?zr:zr.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(Fr,Nr,tn,rn){if(tn==="q"||tn==="Q")return rn=rn.replaceAll("_"," "),rn=rn.replaceAll(/=([0-9a-fA-F]{2})/g,function(Tn,$n){return String.fromCharCode(parseInt($n,16))}),Nt(Nr,rn);try{rn=atob(rn)}catch{}return Nt(Nr,rn)})}return""}},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.PDFNetworkStream=void 0;var gt=mt(1),_t=mt(20);const Et=200,At=206;function Rt(dr){const Mr=dr.response;return typeof Mr!="string"?Mr:(0,gt.stringToBytes)(Mr).buffer}class Ft{constructor(Mr,Tr={}){this.url=Mr,this.isHttp=/^https?:/i.test(Mr),this.httpHeaders=this.isHttp&&Tr.httpHeaders||Object.create(null),this.withCredentials=Tr.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(Mr,Tr,zr){const Fr={begin:Mr,end:Tr};for(const Nr in zr)Fr[Nr]=zr[Nr];return this.request(Fr)}requestFull(Mr){return this.request(Mr)}request(Mr){const Tr=new XMLHttpRequest,zr=this.currXhrId++,Fr=this.pendingRequests[zr]={xhr:Tr};Tr.open("GET",this.url),Tr.withCredentials=this.withCredentials;for(const Nr in this.httpHeaders){const tn=this.httpHeaders[Nr];tn!==void 0&&Tr.setRequestHeader(Nr,tn)}return this.isHttp&&"begin"in Mr&&"end"in Mr?(Tr.setRequestHeader("Range",`bytes=${Mr.begin}-${Mr.end-1}`),Fr.expectedStatus=At):Fr.expectedStatus=Et,Tr.responseType="arraybuffer",Mr.onError&&(Tr.onerror=function(Nr){Mr.onError(Tr.status)}),Tr.onreadystatechange=this.onStateChange.bind(this,zr),Tr.onprogress=this.onProgress.bind(this,zr),Fr.onHeadersReceived=Mr.onHeadersReceived,Fr.onDone=Mr.onDone,Fr.onError=Mr.onError,Fr.onProgress=Mr.onProgress,Tr.send(null),zr}onProgress(Mr,Tr){var Fr;const zr=this.pendingRequests[Mr];zr&&((Fr=zr.onProgress)==null||Fr.call(zr,Tr))}onStateChange(Mr,Tr){var Tn,$n,un;const zr=this.pendingRequests[Mr];if(!zr)return;const Fr=zr.xhr;if(Fr.readyState>=2&&zr.onHeadersReceived&&(zr.onHeadersReceived(),delete zr.onHeadersReceived),Fr.readyState!==4||!(Mr in this.pendingRequests))return;if(delete this.pendingRequests[Mr],Fr.status===0&&this.isHttp){(Tn=zr.onError)==null||Tn.call(zr,Fr.status);return}const Nr=Fr.status||Et;if(!(Nr===Et&&zr.expectedStatus===At)&&Nr!==zr.expectedStatus){($n=zr.onError)==null||$n.call(zr,Fr.status);return}const rn=Rt(Fr);if(Nr===At){const es=Fr.getResponseHeader("Content-Range"),kn=/bytes (\d+)-(\d+)\/(\d+)/.exec(es);zr.onDone({begin:parseInt(kn[1],10),chunk:rn})}else rn?zr.onDone({begin:0,chunk:rn}):(un=zr.onError)==null||un.call(zr,Fr.status)}getRequestXhr(Mr){return this.pendingRequests[Mr].xhr}isPendingRequest(Mr){return Mr in this.pendingRequests}abortRequest(Mr){const Tr=this.pendingRequests[Mr].xhr;delete this.pendingRequests[Mr],Tr.abort()}}class Nt{constructor(Mr){this._source=Mr,this._manager=new Ft(Mr.url,{httpHeaders:Mr.httpHeaders,withCredentials:Mr.withCredentials}),this._rangeChunkSize=Mr.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(Mr){const Tr=this._rangeRequestReaders.indexOf(Mr);Tr>=0&&this._rangeRequestReaders.splice(Tr,1)}getFullReader(){return(0,gt.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Bt(this._manager,this._source),this._fullRequestReader}getRangeReader(Mr,Tr){const zr=new Gt(this._manager,Mr,Tr);return zr.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(zr),zr}cancelAllRequests(Mr){var Tr;(Tr=this._fullRequestReader)==null||Tr.cancel(Mr);for(const zr of this._rangeRequestReaders.slice(0))zr.cancel(Mr)}}st.PDFNetworkStream=Nt;class Bt{constructor(Mr,Tr){this._manager=Mr;const zr={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=Tr.url,this._fullRequestId=Mr.requestFull(zr),this._headersReceivedCapability=new gt.PromiseCapability,this._disableRange=Tr.disableRange||!1,this._contentLength=Tr.length,this._rangeChunkSize=Tr.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const Mr=this._fullRequestId,Tr=this._manager.getRequestXhr(Mr),zr=tn=>Tr.getResponseHeader(tn),{allowRangeRequests:Fr,suggestedLength:Nr}=(0,_t.validateRangeRequestCapabilities)({getResponseHeader:zr,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});Fr&&(this._isRangeSupported=!0),this._contentLength=Nr||this._contentLength,this._filename=(0,_t.extractFilenameFromHeader)(zr),this._isRangeSupported&&this._manager.abortRequest(Mr),this._headersReceivedCapability.resolve()}_onDone(Mr){if(Mr&&(this._requests.length>0?this._requests.shift().resolve({value:Mr.chunk,done:!1}):this._cachedChunks.push(Mr.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const Tr of this._requests)Tr.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(Mr){this._storedError=(0,_t.createResponseStatusError)(Mr,this._url),this._headersReceivedCapability.reject(this._storedError);for(const Tr of this._requests)Tr.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(Mr){var Tr;(Tr=this.onProgress)==null||Tr.call(this,{loaded:Mr.loaded,total:Mr.lengthComputable?Mr.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const Mr=new gt.PromiseCapability;return this._requests.push(Mr),Mr.promise}cancel(Mr){this._done=!0,this._headersReceivedCapability.reject(Mr);for(const Tr of this._requests)Tr.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Gt{constructor(Mr,Tr,zr){this._manager=Mr;const Fr={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=Mr.url,this._requestId=Mr.requestRange(Tr,zr,Fr),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var Mr;(Mr=this.onClosed)==null||Mr.call(this,this)}_onDone(Mr){const Tr=Mr.chunk;this._requests.length>0?this._requests.shift().resolve({value:Tr,done:!1}):this._queuedChunk=Tr,this._done=!0;for(const zr of this._requests)zr.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(Mr){this._storedError=(0,_t.createResponseStatusError)(Mr,this._url);for(const Tr of this._requests)Tr.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(Mr){var Tr;this.isStreamingSupported||(Tr=this.onProgress)==null||Tr.call(this,{loaded:Mr.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const Tr=this._queuedChunk;return this._queuedChunk=null,{value:Tr,done:!1}}if(this._done)return{value:void 0,done:!0};const Mr=new gt.PromiseCapability;return this._requests.push(Mr),Mr.promise}cancel(Mr){this._done=!0;for(const Tr of this._requests)Tr.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.PDFNodeStream=void 0;var gt=mt(1),_t=mt(20);const Et=/^file:\/\/\/[a-zA-Z]:\//;function At(zr){const Fr=require$$5,Nr=Fr.parse(zr);return Nr.protocol==="file:"||Nr.host?Nr:/^[a-z]:[/\\]/i.test(zr)?Fr.parse(`file:///${zr}`):(Nr.host||(Nr.protocol="file:"),Nr)}class Rt{constructor(Fr){this.source=Fr,this.url=At(Fr.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&Fr.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var Fr;return((Fr=this._fullRequestReader)==null?void 0:Fr._loaded)??0}getFullReader(){return(0,gt.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Mr(this):new Gt(this),this._fullRequestReader}getRangeReader(Fr,Nr){if(Nr<=this._progressiveDataLength)return null;const tn=this.isFsUrl?new Tr(this,Fr,Nr):new dr(this,Fr,Nr);return this._rangeRequestReaders.push(tn),tn}cancelAllRequests(Fr){var Nr;(Nr=this._fullRequestReader)==null||Nr.cancel(Fr);for(const tn of this._rangeRequestReaders.slice(0))tn.cancel(Fr)}}st.PDFNodeStream=Rt;class Ft{constructor(Fr){this._url=Fr.url,this._done=!1,this._storedError=null,this.onProgress=null;const Nr=Fr.source;this._contentLength=Nr.length,this._loaded=0,this._filename=null,this._disableRange=Nr.disableRange||!1,this._rangeChunkSize=Nr.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!Nr.disableStream,this._isRangeSupported=!Nr.disableRange,this._readableStream=null,this._readCapability=new gt.PromiseCapability,this._headersCapability=new gt.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var tn;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const Fr=this._readableStream.read();return Fr===null?(this._readCapability=new gt.PromiseCapability,this.read()):(this._loaded+=Fr.length,(tn=this.onProgress)==null||tn.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(Fr).buffer,done:!1})}cancel(Fr){if(!this._readableStream){this._error(Fr);return}this._readableStream.destroy(Fr)}_error(Fr){this._storedError=Fr,this._readCapability.resolve()}_setReadableStream(Fr){this._readableStream=Fr,Fr.on("readable",()=>{this._readCapability.resolve()}),Fr.on("end",()=>{Fr.destroy(),this._done=!0,this._readCapability.resolve()}),Fr.on("error",Nr=>{this._error(Nr)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new gt.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Nt{constructor(Fr){this._url=Fr.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new gt.PromiseCapability;const Nr=Fr.source;this._isStreamingSupported=!Nr.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var tn;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const Fr=this._readableStream.read();return Fr===null?(this._readCapability=new gt.PromiseCapability,this.read()):(this._loaded+=Fr.length,(tn=this.onProgress)==null||tn.call(this,{loaded:this._loaded}),{value:new Uint8Array(Fr).buffer,done:!1})}cancel(Fr){if(!this._readableStream){this._error(Fr);return}this._readableStream.destroy(Fr)}_error(Fr){this._storedError=Fr,this._readCapability.resolve()}_setReadableStream(Fr){this._readableStream=Fr,Fr.on("readable",()=>{this._readCapability.resolve()}),Fr.on("end",()=>{Fr.destroy(),this._done=!0,this._readCapability.resolve()}),Fr.on("error",Nr=>{this._error(Nr)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function Bt(zr,Fr){return{protocol:zr.protocol,auth:zr.auth,host:zr.hostname,port:zr.port,path:zr.path,method:"GET",headers:Fr}}class Gt extends Ft{constructor(Fr){super(Fr);const Nr=tn=>{if(tn.statusCode===404){const un=new gt.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=un,this._headersCapability.reject(un);return}this._headersCapability.resolve(),this._setReadableStream(tn);const rn=un=>this._readableStream.headers[un.toLowerCase()],{allowRangeRequests:Tn,suggestedLength:$n}=(0,_t.validateRangeRequestCapabilities)({getResponseHeader:rn,isHttp:Fr.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Tn,this._contentLength=$n||this._contentLength,this._filename=(0,_t.extractFilenameFromHeader)(rn)};if(this._request=null,this._url.protocol==="http:"){const tn=require$$5;this._request=tn.request(Bt(this._url,Fr.httpHeaders),Nr)}else{const tn=require$$5;this._request=tn.request(Bt(this._url,Fr.httpHeaders),Nr)}this._request.on("error",tn=>{this._storedError=tn,this._headersCapability.reject(tn)}),this._request.end()}}class dr extends Nt{constructor(Fr,Nr,tn){super(Fr),this._httpHeaders={};for(const Tn in Fr.httpHeaders){const $n=Fr.httpHeaders[Tn];$n!==void 0&&(this._httpHeaders[Tn]=$n)}this._httpHeaders.Range=`bytes=${Nr}-${tn-1}`;const rn=Tn=>{if(Tn.statusCode===404){const $n=new gt.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=$n;return}this._setReadableStream(Tn)};if(this._request=null,this._url.protocol==="http:"){const Tn=require$$5;this._request=Tn.request(Bt(this._url,this._httpHeaders),rn)}else{const Tn=require$$5;this._request=Tn.request(Bt(this._url,this._httpHeaders),rn)}this._request.on("error",Tn=>{this._storedError=Tn}),this._request.end()}}class Mr extends Ft{constructor(Fr){super(Fr);let Nr=decodeURIComponent(this._url.path);Et.test(this._url.href)&&(Nr=Nr.replace(/^\//,""));const tn=require$$5;tn.lstat(Nr,(rn,Tn)=>{if(rn){rn.code==="ENOENT"&&(rn=new gt.MissingPDFException(`Missing PDF "${Nr}".`)),this._storedError=rn,this._headersCapability.reject(rn);return}this._contentLength=Tn.size,this._setReadableStream(tn.createReadStream(Nr)),this._headersCapability.resolve()})}}class Tr extends Nt{constructor(Fr,Nr,tn){super(Fr);let rn=decodeURIComponent(this._url.path);Et.test(this._url.href)&&(rn=rn.replace(/^\//,""));const Tn=require$$5;this._setReadableStream(Tn.createReadStream(rn,{start:Nr,end:tn-1}))}}},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.SVGGraphics=void 0;var gt=mt(6),_t=mt(1);const Et={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},At="http://www.w3.org/XML/1998/namespace",Rt="http://www.w3.org/1999/xlink",Ft=["butt","round","square"],Nt=["miter","round","bevel"],Bt=function(Tn,$n="",un=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!un)return URL.createObjectURL(new Blob([Tn],{type:$n}));const es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let kn=`data:${$n};base64,`;for(let ts=0,Ko=Tn.length;ts<Ko;ts+=3){const ds=Tn[ts]&255,Il=Tn[ts+1]&255,ru=Tn[ts+2]&255,uu=ds>>2,p0=(ds&3)<<4|Il>>4,X1=ts+1<Ko?(Il&15)<<2|ru>>6:64,q0=ts+2<Ko?ru&63:64;kn+=es[uu]+es[p0]+es[X1]+es[q0]}return kn},Gt=function(){const Tn=new Uint8Array([137,80,78,71,13,10,26,10]),$n=12,un=new Int32Array(256);for(let ru=0;ru<256;ru++){let uu=ru;for(let p0=0;p0<8;p0++)uu=uu&1?3988292384^uu>>1&2147483647:uu>>1&2147483647;un[ru]=uu}function es(ru,uu,p0){let X1=-1;for(let q0=uu;q0<p0;q0++){const W0=(X1^ru[q0])&255,hu=un[W0];X1=X1>>>8^hu}return X1^-1}function kn(ru,uu,p0,X1){let q0=X1;const W0=uu.length;p0[q0]=W0>>24&255,p0[q0+1]=W0>>16&255,p0[q0+2]=W0>>8&255,p0[q0+3]=W0&255,q0+=4,p0[q0]=ru.charCodeAt(0)&255,p0[q0+1]=ru.charCodeAt(1)&255,p0[q0+2]=ru.charCodeAt(2)&255,p0[q0+3]=ru.charCodeAt(3)&255,q0+=4,p0.set(uu,q0),q0+=uu.length;const hu=es(p0,X1+4,q0);p0[q0]=hu>>24&255,p0[q0+1]=hu>>16&255,p0[q0+2]=hu>>8&255,p0[q0+3]=hu&255}function ts(ru,uu,p0){let X1=1,q0=0;for(let W0=uu;W0<p0;++W0)X1=(X1+(ru[W0]&255))%65521,q0=(q0+X1)%65521;return q0<<16|X1}function Ko(ru){if(!_t.isNodeJS)return ds(ru);try{const uu=parseInt(process.versions.node)>=8?ru:Buffer.from(ru),p0=require$$5.deflateSync(uu,{level:9});return p0 instanceof Uint8Array?p0:new Uint8Array(p0)}catch(uu){(0,_t.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+uu)}return ds(ru)}function ds(ru){let uu=ru.length;const p0=65535,X1=Math.ceil(uu/p0),q0=new Uint8Array(2+uu+X1*5+4);let W0=0;q0[W0++]=120,q0[W0++]=156;let hu=0;for(;uu>p0;)q0[W0++]=0,q0[W0++]=255,q0[W0++]=255,q0[W0++]=0,q0[W0++]=0,q0.set(ru.subarray(hu,hu+p0),W0),W0+=p0,hu+=p0,uu-=p0;q0[W0++]=1,q0[W0++]=uu&255,q0[W0++]=uu>>8&255,q0[W0++]=~uu&65535&255,q0[W0++]=(~uu&65535)>>8&255,q0.set(ru.subarray(hu),W0),W0+=ru.length-hu;const a1=ts(ru,0,ru.length);return q0[W0++]=a1>>24&255,q0[W0++]=a1>>16&255,q0[W0++]=a1>>8&255,q0[W0++]=a1&255,q0}function Il(ru,uu,p0,X1){const q0=ru.width,W0=ru.height;let hu,a1,Vx;const t0=ru.data;switch(uu){case _t.ImageKind.GRAYSCALE_1BPP:a1=0,hu=1,Vx=q0+7>>3;break;case _t.ImageKind.RGB_24BPP:a1=2,hu=8,Vx=q0*3;break;case _t.ImageKind.RGBA_32BPP:a1=6,hu=8,Vx=q0*4;break;default:throw new Error("invalid format")}const cu=new Uint8Array((1+Vx)*W0);let lu=0,b0=0;for(let h$=0;h$<W0;++h$)cu[lu++]=0,cu.set(t0.subarray(b0,b0+Vx),lu),b0+=Vx,lu+=Vx;if(uu===_t.ImageKind.GRAYSCALE_1BPP&&X1){lu=0;for(let h$=0;h$<W0;h$++){lu++;for(let d$=0;d$<Vx;d$++)cu[lu++]^=255}}const l1=new Uint8Array([q0>>24&255,q0>>16&255,q0>>8&255,q0&255,W0>>24&255,W0>>16&255,W0>>8&255,W0&255,hu,a1,0,0,0]),LE=Ko(cu),eS=Tn.length+$n*3+l1.length+LE.length,SA=new Uint8Array(eS);let o$=0;return SA.set(Tn,o$),o$+=Tn.length,kn("IHDR",l1,SA,o$),o$+=$n+l1.length,kn("IDATA",LE,SA,o$),o$+=$n+LE.length,kn("IEND",new Uint8Array(0),SA,o$),Bt(SA,"image/png",p0)}return function(uu,p0,X1){const q0=uu.kind===void 0?_t.ImageKind.GRAYSCALE_1BPP:uu.kind;return Il(uu,q0,p0,X1)}}();class dr{constructor(){this.fontSizeScale=1,this.fontWeight=Et.fontWeight,this.fontSize=0,this.textMatrix=_t.IDENTITY_MATRIX,this.fontMatrix=_t.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=_t.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=Et.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint($n,un){this.x=$n,this.y=un}}function Mr(Tn){let $n=[];const un=[];for(const es of Tn){if(es.fn==="save"){$n.push({fnId:92,fn:"group",items:[]}),un.push($n),$n=$n.at(-1).items;continue}es.fn==="restore"?$n=un.pop():$n.push(es)}return $n}function Tr(Tn){if(Number.isInteger(Tn))return Tn.toString();const $n=Tn.toFixed(10);let un=$n.length-1;if($n[un]!=="0")return $n;do un--;while($n[un]==="0");return $n.substring(0,$n[un]==="."?un:un+1)}function zr(Tn){if(Tn[4]===0&&Tn[5]===0){if(Tn[1]===0&&Tn[2]===0)return Tn[0]===1&&Tn[3]===1?"":`scale(${Tr(Tn[0])} ${Tr(Tn[3])})`;if(Tn[0]===Tn[3]&&Tn[1]===-Tn[2]){const $n=Math.acos(Tn[0])*180/Math.PI;return`rotate(${Tr($n)})`}}else if(Tn[0]===1&&Tn[1]===0&&Tn[2]===0&&Tn[3]===1)return`translate(${Tr(Tn[4])} ${Tr(Tn[5])})`;return`matrix(${Tr(Tn[0])} ${Tr(Tn[1])} ${Tr(Tn[2])} ${Tr(Tn[3])} ${Tr(Tn[4])} ${Tr(Tn[5])})`}let Fr=0,Nr=0,tn=0;class rn{constructor($n,un,es=!1){(0,gt.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new gt.DOMSVGFactory,this.current=new dr,this.transformMatrix=_t.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=$n,this.objs=un,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!es,this._operatorIdMapping=[];for(const kn in _t.OPS)this._operatorIdMapping[_t.OPS[kn]]=kn}getObject($n,un=null){return typeof $n=="string"?$n.startsWith("g_")?this.commonObjs.get($n):this.objs.get($n):un}save(){this.transformStack.push(this.transformMatrix);const $n=this.current;this.extraStack.push($n),this.current=$n.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group($n){this.save(),this.executeOpTree($n),this.restore()}loadDependencies($n){const un=$n.fnArray,es=$n.argsArray;for(let kn=0,ts=un.length;kn<ts;kn++)if(un[kn]===_t.OPS.dependency)for(const Ko of es[kn]){const ds=Ko.startsWith("g_")?this.commonObjs:this.objs,Il=new Promise(ru=>{ds.get(Ko,ru)});this.current.dependencies.push(Il)}return Promise.all(this.current.dependencies)}transform($n,un,es,kn,ts,Ko){const ds=[$n,un,es,kn,ts,Ko];this.transformMatrix=_t.Util.transform(this.transformMatrix,ds),this.tgrp=null}getSVG($n,un){this.viewport=un;const es=this._initialize(un);return this.loadDependencies($n).then(()=>(this.transformMatrix=_t.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList($n)),es))}convertOpList($n){const un=this._operatorIdMapping,es=$n.argsArray,kn=$n.fnArray,ts=[];for(let Ko=0,ds=kn.length;Ko<ds;Ko++){const Il=kn[Ko];ts.push({fnId:Il,fn:un[Il],args:es[Ko]})}return Mr(ts)}executeOpTree($n){for(const un of $n){const es=un.fn,kn=un.fnId,ts=un.args;switch(kn|0){case _t.OPS.beginText:this.beginText();break;case _t.OPS.dependency:break;case _t.OPS.setLeading:this.setLeading(ts);break;case _t.OPS.setLeadingMoveText:this.setLeadingMoveText(ts[0],ts[1]);break;case _t.OPS.setFont:this.setFont(ts);break;case _t.OPS.showText:this.showText(ts[0]);break;case _t.OPS.showSpacedText:this.showText(ts[0]);break;case _t.OPS.endText:this.endText();break;case _t.OPS.moveText:this.moveText(ts[0],ts[1]);break;case _t.OPS.setCharSpacing:this.setCharSpacing(ts[0]);break;case _t.OPS.setWordSpacing:this.setWordSpacing(ts[0]);break;case _t.OPS.setHScale:this.setHScale(ts[0]);break;case _t.OPS.setTextMatrix:this.setTextMatrix(ts[0],ts[1],ts[2],ts[3],ts[4],ts[5]);break;case _t.OPS.setTextRise:this.setTextRise(ts[0]);break;case _t.OPS.setTextRenderingMode:this.setTextRenderingMode(ts[0]);break;case _t.OPS.setLineWidth:this.setLineWidth(ts[0]);break;case _t.OPS.setLineJoin:this.setLineJoin(ts[0]);break;case _t.OPS.setLineCap:this.setLineCap(ts[0]);break;case _t.OPS.setMiterLimit:this.setMiterLimit(ts[0]);break;case _t.OPS.setFillRGBColor:this.setFillRGBColor(ts[0],ts[1],ts[2]);break;case _t.OPS.setStrokeRGBColor:this.setStrokeRGBColor(ts[0],ts[1],ts[2]);break;case _t.OPS.setStrokeColorN:this.setStrokeColorN(ts);break;case _t.OPS.setFillColorN:this.setFillColorN(ts);break;case _t.OPS.shadingFill:this.shadingFill(ts[0]);break;case _t.OPS.setDash:this.setDash(ts[0],ts[1]);break;case _t.OPS.setRenderingIntent:this.setRenderingIntent(ts[0]);break;case _t.OPS.setFlatness:this.setFlatness(ts[0]);break;case _t.OPS.setGState:this.setGState(ts[0]);break;case _t.OPS.fill:this.fill();break;case _t.OPS.eoFill:this.eoFill();break;case _t.OPS.stroke:this.stroke();break;case _t.OPS.fillStroke:this.fillStroke();break;case _t.OPS.eoFillStroke:this.eoFillStroke();break;case _t.OPS.clip:this.clip("nonzero");break;case _t.OPS.eoClip:this.clip("evenodd");break;case _t.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case _t.OPS.paintImageXObject:this.paintImageXObject(ts[0]);break;case _t.OPS.paintInlineImageXObject:this.paintInlineImageXObject(ts[0]);break;case _t.OPS.paintImageMaskXObject:this.paintImageMaskXObject(ts[0]);break;case _t.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(ts[0],ts[1]);break;case _t.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case _t.OPS.closePath:this.closePath();break;case _t.OPS.closeStroke:this.closeStroke();break;case _t.OPS.closeFillStroke:this.closeFillStroke();break;case _t.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case _t.OPS.nextLine:this.nextLine();break;case _t.OPS.transform:this.transform(ts[0],ts[1],ts[2],ts[3],ts[4],ts[5]);break;case _t.OPS.constructPath:this.constructPath(ts[0],ts[1]);break;case _t.OPS.endPath:this.endPath();break;case 92:this.group(un.items);break;default:(0,_t.warn)(`Unimplemented operator ${es}`);break}}}setWordSpacing($n){this.current.wordSpacing=$n}setCharSpacing($n){this.current.charSpacing=$n}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix($n,un,es,kn,ts,Ko){const ds=this.current;ds.textMatrix=ds.lineMatrix=[$n,un,es,kn,ts,Ko],ds.textMatrixScale=Math.hypot($n,un),ds.x=ds.lineX=0,ds.y=ds.lineY=0,ds.xcoords=[],ds.ycoords=[],ds.tspan=this.svgFactory.createElement("svg:tspan"),ds.tspan.setAttributeNS(null,"font-family",ds.fontFamily),ds.tspan.setAttributeNS(null,"font-size",`${Tr(ds.fontSize)}px`),ds.tspan.setAttributeNS(null,"y",Tr(-ds.y)),ds.txtElement=this.svgFactory.createElement("svg:text"),ds.txtElement.append(ds.tspan)}beginText(){const $n=this.current;$n.x=$n.lineX=0,$n.y=$n.lineY=0,$n.textMatrix=_t.IDENTITY_MATRIX,$n.lineMatrix=_t.IDENTITY_MATRIX,$n.textMatrixScale=1,$n.tspan=this.svgFactory.createElement("svg:tspan"),$n.txtElement=this.svgFactory.createElement("svg:text"),$n.txtgrp=this.svgFactory.createElement("svg:g"),$n.xcoords=[],$n.ycoords=[]}moveText($n,un){const es=this.current;es.x=es.lineX+=$n,es.y=es.lineY+=un,es.xcoords=[],es.ycoords=[],es.tspan=this.svgFactory.createElement("svg:tspan"),es.tspan.setAttributeNS(null,"font-family",es.fontFamily),es.tspan.setAttributeNS(null,"font-size",`${Tr(es.fontSize)}px`),es.tspan.setAttributeNS(null,"y",Tr(-es.y))}showText($n){const un=this.current,es=un.font,kn=un.fontSize;if(kn===0)return;const ts=un.fontSizeScale,Ko=un.charSpacing,ds=un.wordSpacing,Il=un.fontDirection,ru=un.textHScale*Il,uu=es.vertical,p0=uu?1:-1,X1=es.defaultVMetrics,q0=kn*un.fontMatrix[0];let W0=0;for(const Vx of $n){if(Vx===null){W0+=Il*ds;continue}else if(typeof Vx=="number"){W0+=p0*Vx*kn/1e3;continue}const t0=(Vx.isSpace?ds:0)+Ko,cu=Vx.fontChar;let lu,b0,l1=Vx.width;if(uu){let eS;const SA=Vx.vmetric||X1;eS=Vx.vmetric?SA[1]:l1*.5,eS=-eS*q0;const o$=SA[2]*q0;l1=SA?-SA[0]:l1,lu=eS/ts,b0=(W0+o$)/ts}else lu=W0/ts,b0=0;(Vx.isInFont||es.missingFile)&&(un.xcoords.push(un.x+lu),uu&&un.ycoords.push(-un.y+b0),un.tspan.textContent+=cu);const LE=uu?l1*q0-t0*Il:l1*q0+t0*Il;W0+=LE}un.tspan.setAttributeNS(null,"x",un.xcoords.map(Tr).join(" ")),uu?un.tspan.setAttributeNS(null,"y",un.ycoords.map(Tr).join(" ")):un.tspan.setAttributeNS(null,"y",Tr(-un.y)),uu?un.y-=W0:un.x+=W0*ru,un.tspan.setAttributeNS(null,"font-family",un.fontFamily),un.tspan.setAttributeNS(null,"font-size",`${Tr(un.fontSize)}px`),un.fontStyle!==Et.fontStyle&&un.tspan.setAttributeNS(null,"font-style",un.fontStyle),un.fontWeight!==Et.fontWeight&&un.tspan.setAttributeNS(null,"font-weight",un.fontWeight);const hu=un.textRenderingMode&_t.TextRenderingMode.FILL_STROKE_MASK;if(hu===_t.TextRenderingMode.FILL||hu===_t.TextRenderingMode.FILL_STROKE?(un.fillColor!==Et.fillColor&&un.tspan.setAttributeNS(null,"fill",un.fillColor),un.fillAlpha<1&&un.tspan.setAttributeNS(null,"fill-opacity",un.fillAlpha)):un.textRenderingMode===_t.TextRenderingMode.ADD_TO_PATH?un.tspan.setAttributeNS(null,"fill","transparent"):un.tspan.setAttributeNS(null,"fill","none"),hu===_t.TextRenderingMode.STROKE||hu===_t.TextRenderingMode.FILL_STROKE){const Vx=1/(un.textMatrixScale||1);this._setStrokeAttributes(un.tspan,Vx)}let a1=un.textMatrix;un.textRise!==0&&(a1=a1.slice(),a1[5]+=un.textRise),un.txtElement.setAttributeNS(null,"transform",`${zr(a1)} scale(${Tr(ru)}, -1)`),un.txtElement.setAttributeNS(At,"xml:space","preserve"),un.txtElement.append(un.tspan),un.txtgrp.append(un.txtElement),this._ensureTransformGroup().append(un.txtElement)}setLeadingMoveText($n,un){this.setLeading(-un),this.moveText($n,un)}addFontStyle($n){if(!$n.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const un=Bt($n.data,$n.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${$n.loadedName}"; src: url(${un}); }
`}setFont($n){const un=this.current,es=this.commonObjs.get($n[0]);let kn=$n[1];un.font=es,this.embedFonts&&!es.missingFile&&!this.embeddedFonts[es.loadedName]&&(this.addFontStyle(es),this.embeddedFonts[es.loadedName]=es),un.fontMatrix=es.fontMatrix||_t.FONT_IDENTITY_MATRIX;let ts="normal";es.black?ts="900":es.bold&&(ts="bold");const Ko=es.italic?"italic":"normal";kn<0?(kn=-kn,un.fontDirection=-1):un.fontDirection=1,un.fontSize=kn,un.fontFamily=es.loadedName,un.fontWeight=ts,un.fontStyle=Ko,un.tspan=this.svgFactory.createElement("svg:tspan"),un.tspan.setAttributeNS(null,"y",Tr(-un.y)),un.xcoords=[],un.ycoords=[]}endText(){var un;const $n=this.current;$n.textRenderingMode&_t.TextRenderingMode.ADD_TO_PATH_FLAG&&((un=$n.txtElement)!=null&&un.hasChildNodes())&&($n.element=$n.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth($n){$n>0&&(this.current.lineWidth=$n)}setLineCap($n){this.current.lineCap=Ft[$n]}setLineJoin($n){this.current.lineJoin=Nt[$n]}setMiterLimit($n){this.current.miterLimit=$n}setStrokeAlpha($n){this.current.strokeAlpha=$n}setStrokeRGBColor($n,un,es){this.current.strokeColor=_t.Util.makeHexColor($n,un,es)}setFillAlpha($n){this.current.fillAlpha=$n}setFillRGBColor($n,un,es){this.current.fillColor=_t.Util.makeHexColor($n,un,es),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN($n){this.current.strokeColor=this._makeColorN_Pattern($n)}setFillColorN($n){this.current.fillColor=this._makeColorN_Pattern($n)}shadingFill($n){const{width:un,height:es}=this.viewport,kn=_t.Util.inverseTransform(this.transformMatrix),[ts,Ko,ds,Il]=_t.Util.getAxialAlignedBoundingBox([0,0,un,es],kn),ru=this.svgFactory.createElement("svg:rect");ru.setAttributeNS(null,"x",ts),ru.setAttributeNS(null,"y",Ko),ru.setAttributeNS(null,"width",ds-ts),ru.setAttributeNS(null,"height",Il-Ko),ru.setAttributeNS(null,"fill",this._makeShadingPattern($n)),this.current.fillAlpha<1&&ru.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(ru)}_makeColorN_Pattern($n){return $n[0]==="TilingPattern"?this._makeTilingPattern($n):this._makeShadingPattern($n)}_makeTilingPattern($n){const un=$n[1],es=$n[2],kn=$n[3]||_t.IDENTITY_MATRIX,[ts,Ko,ds,Il]=$n[4],ru=$n[5],uu=$n[6],p0=$n[7],X1=`shading${tn++}`,[q0,W0,hu,a1]=_t.Util.normalizeRect([..._t.Util.applyTransform([ts,Ko],kn),..._t.Util.applyTransform([ds,Il],kn)]),[Vx,t0]=_t.Util.singularValueDecompose2dScale(kn),cu=ru*Vx,lu=uu*t0,b0=this.svgFactory.createElement("svg:pattern");b0.setAttributeNS(null,"id",X1),b0.setAttributeNS(null,"patternUnits","userSpaceOnUse"),b0.setAttributeNS(null,"width",cu),b0.setAttributeNS(null,"height",lu),b0.setAttributeNS(null,"x",`${q0}`),b0.setAttributeNS(null,"y",`${W0}`);const l1=this.svg,LE=this.transformMatrix,eS=this.current.fillColor,SA=this.current.strokeColor,o$=this.svgFactory.create(hu-q0,a1-W0);if(this.svg=o$,this.transformMatrix=kn,p0===2){const h$=_t.Util.makeHexColor(...un);this.current.fillColor=h$,this.current.strokeColor=h$}return this.executeOpTree(this.convertOpList(es)),this.svg=l1,this.transformMatrix=LE,this.current.fillColor=eS,this.current.strokeColor=SA,b0.append(o$.childNodes[0]),this.defs.append(b0),`url(#${X1})`}_makeShadingPattern($n){switch(typeof $n=="string"&&($n=this.objs.get($n)),$n[0]){case"RadialAxial":const un=`shading${tn++}`,es=$n[3];let kn;switch($n[1]){case"axial":const ts=$n[4],Ko=$n[5];kn=this.svgFactory.createElement("svg:linearGradient"),kn.setAttributeNS(null,"id",un),kn.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),kn.setAttributeNS(null,"x1",ts[0]),kn.setAttributeNS(null,"y1",ts[1]),kn.setAttributeNS(null,"x2",Ko[0]),kn.setAttributeNS(null,"y2",Ko[1]);break;case"radial":const ds=$n[4],Il=$n[5],ru=$n[6],uu=$n[7];kn=this.svgFactory.createElement("svg:radialGradient"),kn.setAttributeNS(null,"id",un),kn.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),kn.setAttributeNS(null,"cx",Il[0]),kn.setAttributeNS(null,"cy",Il[1]),kn.setAttributeNS(null,"r",uu),kn.setAttributeNS(null,"fx",ds[0]),kn.setAttributeNS(null,"fy",ds[1]),kn.setAttributeNS(null,"fr",ru);break;default:throw new Error(`Unknown RadialAxial type: ${$n[1]}`)}for(const ts of es){const Ko=this.svgFactory.createElement("svg:stop");Ko.setAttributeNS(null,"offset",ts[0]),Ko.setAttributeNS(null,"stop-color",ts[1]),kn.append(Ko)}return this.defs.append(kn),`url(#${un})`;case"Mesh":return(0,_t.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${$n[0]}`)}}setDash($n,un){this.current.dashArray=$n,this.current.dashPhase=un}constructPath($n,un){const es=this.current;let kn=es.x,ts=es.y,Ko=[],ds=0;for(const Il of $n)switch(Il|0){case _t.OPS.rectangle:kn=un[ds++],ts=un[ds++];const ru=un[ds++],uu=un[ds++],p0=kn+ru,X1=ts+uu;Ko.push("M",Tr(kn),Tr(ts),"L",Tr(p0),Tr(ts),"L",Tr(p0),Tr(X1),"L",Tr(kn),Tr(X1),"Z");break;case _t.OPS.moveTo:kn=un[ds++],ts=un[ds++],Ko.push("M",Tr(kn),Tr(ts));break;case _t.OPS.lineTo:kn=un[ds++],ts=un[ds++],Ko.push("L",Tr(kn),Tr(ts));break;case _t.OPS.curveTo:kn=un[ds+4],ts=un[ds+5],Ko.push("C",Tr(un[ds]),Tr(un[ds+1]),Tr(un[ds+2]),Tr(un[ds+3]),Tr(kn),Tr(ts)),ds+=6;break;case _t.OPS.curveTo2:Ko.push("C",Tr(kn),Tr(ts),Tr(un[ds]),Tr(un[ds+1]),Tr(un[ds+2]),Tr(un[ds+3])),kn=un[ds+2],ts=un[ds+3],ds+=4;break;case _t.OPS.curveTo3:kn=un[ds+2],ts=un[ds+3],Ko.push("C",Tr(un[ds]),Tr(un[ds+1]),Tr(kn),Tr(ts),Tr(kn),Tr(ts)),ds+=4;break;case _t.OPS.closePath:Ko.push("Z");break}Ko=Ko.join(" "),es.path&&$n.length>0&&$n[0]!==_t.OPS.rectangle&&$n[0]!==_t.OPS.moveTo?Ko=es.path.getAttributeNS(null,"d")+Ko:(es.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(es.path)),es.path.setAttributeNS(null,"d",Ko),es.path.setAttributeNS(null,"fill","none"),es.element=es.path,es.setCurrentPoint(kn,ts)}endPath(){const $n=this.current;if($n.path=null,!this.pendingClip)return;if(!$n.element){this.pendingClip=null;return}const un=`clippath${Fr++}`,es=this.svgFactory.createElement("svg:clipPath");es.setAttributeNS(null,"id",un),es.setAttributeNS(null,"transform",zr(this.transformMatrix));const kn=$n.element.cloneNode(!0);if(this.pendingClip==="evenodd"?kn.setAttributeNS(null,"clip-rule","evenodd"):kn.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,es.append(kn),this.defs.append(es),$n.activeClipUrl){$n.clipGroup=null;for(const ts of this.extraStack)ts.clipGroup=null;es.setAttributeNS(null,"clip-path",$n.activeClipUrl)}$n.activeClipUrl=`url(#${un})`,this.tgrp=null}clip($n){this.pendingClip=$n}closePath(){const $n=this.current;if($n.path){const un=`${$n.path.getAttributeNS(null,"d")}Z`;$n.path.setAttributeNS(null,"d",un)}}setLeading($n){this.current.leading=-$n}setTextRise($n){this.current.textRise=$n}setTextRenderingMode($n){this.current.textRenderingMode=$n}setHScale($n){this.current.textHScale=$n/100}setRenderingIntent($n){}setFlatness($n){}setGState($n){for(const[un,es]of $n)switch(un){case"LW":this.setLineWidth(es);break;case"LC":this.setLineCap(es);break;case"LJ":this.setLineJoin(es);break;case"ML":this.setMiterLimit(es);break;case"D":this.setDash(es[0],es[1]);break;case"RI":this.setRenderingIntent(es);break;case"FL":this.setFlatness(es);break;case"Font":this.setFont(es);break;case"CA":this.setStrokeAlpha(es);break;case"ca":this.setFillAlpha(es);break;default:(0,_t.warn)(`Unimplemented graphic state operator ${un}`);break}}fill(){const $n=this.current;$n.element&&($n.element.setAttributeNS(null,"fill",$n.fillColor),$n.element.setAttributeNS(null,"fill-opacity",$n.fillAlpha),this.endPath())}stroke(){const $n=this.current;$n.element&&(this._setStrokeAttributes($n.element),$n.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes($n,un=1){const es=this.current;let kn=es.dashArray;un!==1&&kn.length>0&&(kn=kn.map(function(ts){return un*ts})),$n.setAttributeNS(null,"stroke",es.strokeColor),$n.setAttributeNS(null,"stroke-opacity",es.strokeAlpha),$n.setAttributeNS(null,"stroke-miterlimit",Tr(es.miterLimit)),$n.setAttributeNS(null,"stroke-linecap",es.lineCap),$n.setAttributeNS(null,"stroke-linejoin",es.lineJoin),$n.setAttributeNS(null,"stroke-width",Tr(un*es.lineWidth)+"px"),$n.setAttributeNS(null,"stroke-dasharray",kn.map(Tr).join(" ")),$n.setAttributeNS(null,"stroke-dashoffset",Tr(un*es.dashPhase)+"px")}eoFill(){var $n;($n=this.current.element)==null||$n.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var $n;($n=this.current.element)==null||$n.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const $n=this.svgFactory.createElement("svg:rect");$n.setAttributeNS(null,"x","0"),$n.setAttributeNS(null,"y","0"),$n.setAttributeNS(null,"width","1px"),$n.setAttributeNS(null,"height","1px"),$n.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append($n)}paintImageXObject($n){const un=this.getObject($n);if(!un){(0,_t.warn)(`Dependent image with object ID ${$n} is not ready yet`);return}this.paintInlineImageXObject(un)}paintInlineImageXObject($n,un){const es=$n.width,kn=$n.height,ts=Gt($n,this.forceDataSchema,!!un),Ko=this.svgFactory.createElement("svg:rect");Ko.setAttributeNS(null,"x","0"),Ko.setAttributeNS(null,"y","0"),Ko.setAttributeNS(null,"width",Tr(es)),Ko.setAttributeNS(null,"height",Tr(kn)),this.current.element=Ko,this.clip("nonzero");const ds=this.svgFactory.createElement("svg:image");ds.setAttributeNS(Rt,"xlink:href",ts),ds.setAttributeNS(null,"x","0"),ds.setAttributeNS(null,"y",Tr(-kn)),ds.setAttributeNS(null,"width",Tr(es)+"px"),ds.setAttributeNS(null,"height",Tr(kn)+"px"),ds.setAttributeNS(null,"transform",`scale(${Tr(1/es)} ${Tr(-1/kn)})`),un?un.append(ds):this._ensureTransformGroup().append(ds)}paintImageMaskXObject($n){const un=this.getObject($n.data,$n);if(un.bitmap){(0,_t.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const es=this.current,kn=un.width,ts=un.height,Ko=es.fillColor;es.maskId=`mask${Nr++}`;const ds=this.svgFactory.createElement("svg:mask");ds.setAttributeNS(null,"id",es.maskId);const Il=this.svgFactory.createElement("svg:rect");Il.setAttributeNS(null,"x","0"),Il.setAttributeNS(null,"y","0"),Il.setAttributeNS(null,"width",Tr(kn)),Il.setAttributeNS(null,"height",Tr(ts)),Il.setAttributeNS(null,"fill",Ko),Il.setAttributeNS(null,"mask",`url(#${es.maskId})`),this.defs.append(ds),this._ensureTransformGroup().append(Il),this.paintInlineImageXObject(un,ds)}paintFormXObjectBegin($n,un){if(Array.isArray($n)&&$n.length===6&&this.transform($n[0],$n[1],$n[2],$n[3],$n[4],$n[5]),un){const es=un[2]-un[0],kn=un[3]-un[1],ts=this.svgFactory.createElement("svg:rect");ts.setAttributeNS(null,"x",un[0]),ts.setAttributeNS(null,"y",un[1]),ts.setAttributeNS(null,"width",Tr(es)),ts.setAttributeNS(null,"height",Tr(kn)),this.current.element=ts,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize($n){const un=this.svgFactory.create($n.width,$n.height),es=this.svgFactory.createElement("svg:defs");un.append(es),this.defs=es;const kn=this.svgFactory.createElement("svg:g");return kn.setAttributeNS(null,"transform",zr($n.transform)),un.append(kn),this.svg=kn,un}_ensureClipGroup(){if(!this.current.clipGroup){const $n=this.svgFactory.createElement("svg:g");$n.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append($n),this.current.clipGroup=$n}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",zr(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}st.SVGGraphics=rn},(nt,st)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.XfaText=void 0;class mt{static textContent(_t){const Et=[],At={items:Et,styles:Object.create(null)};function Rt(Ft){var Gt;if(!Ft)return;let Nt=null;const Bt=Ft.name;if(Bt==="#text")Nt=Ft.value;else if(mt.shouldBuildText(Bt))(Gt=Ft==null?void 0:Ft.attributes)!=null&&Gt.textContent?Nt=Ft.attributes.textContent:Ft.value&&(Nt=Ft.value);else return;if(Nt!==null&&Et.push({str:Nt}),!!Ft.children)for(const dr of Ft.children)Rt(dr)}return Rt(_t),At}static shouldBuildText(_t){return!(_t==="textarea"||_t==="input"||_t==="option"||_t==="select")}}st.XfaText=mt},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.TextLayerRenderTask=void 0,st.renderTextLayer=zr,st.updateTextLayer=Fr;var gt=mt(1),_t=mt(6);const Et=1e5,At=30,Rt=.8,Ft=new Map;function Nt(Nr,tn){let rn;if(tn&&gt.FeatureTest.isOffscreenCanvasSupported)rn=new OffscreenCanvas(Nr,Nr).getContext("2d",{alpha:!1});else{const Tn=document.createElement("canvas");Tn.width=Tn.height=Nr,rn=Tn.getContext("2d",{alpha:!1})}return rn}function Bt(Nr,tn){const rn=Ft.get(Nr);if(rn)return rn;const Tn=Nt(At,tn);Tn.font=`${At}px ${Nr}`;const $n=Tn.measureText("");let un=$n.fontBoundingBoxAscent,es=Math.abs($n.fontBoundingBoxDescent);if(un){const ts=un/(un+es);return Ft.set(Nr,ts),Tn.canvas.width=Tn.canvas.height=0,ts}Tn.strokeStyle="red",Tn.clearRect(0,0,At,At),Tn.strokeText("g",0,0);let kn=Tn.getImageData(0,0,At,At).data;es=0;for(let ts=kn.length-1-3;ts>=0;ts-=4)if(kn[ts]>0){es=Math.ceil(ts/4/At);break}Tn.clearRect(0,0,At,At),Tn.strokeText("A",0,At),kn=Tn.getImageData(0,0,At,At).data,un=0;for(let ts=0,Ko=kn.length;ts<Ko;ts+=4)if(kn[ts]>0){un=At-Math.floor(ts/4/At);break}if(Tn.canvas.width=Tn.canvas.height=0,un){const ts=un/(un+es);return Ft.set(Nr,ts),ts}return Ft.set(Nr,Rt),Rt}function Gt(Nr,tn,rn){const Tn=document.createElement("span"),$n={angle:0,canvasWidth:0,hasText:tn.str!=="",hasEOL:tn.hasEOL,fontSize:0};Nr._textDivs.push(Tn);const un=gt.Util.transform(Nr._transform,tn.transform);let es=Math.atan2(un[1],un[0]);const kn=rn[tn.fontName];kn.vertical&&(es+=Math.PI/2);const ts=Math.hypot(un[2],un[3]),Ko=ts*Bt(kn.fontFamily,Nr._isOffscreenCanvasSupported);let ds,Il;es===0?(ds=un[4],Il=un[5]-Ko):(ds=un[4]+Ko*Math.sin(es),Il=un[5]-Ko*Math.cos(es));const ru="calc(var(--scale-factor)*",uu=Tn.style;Nr._container===Nr._rootContainer?(uu.left=`${(100*ds/Nr._pageWidth).toFixed(2)}%`,uu.top=`${(100*Il/Nr._pageHeight).toFixed(2)}%`):(uu.left=`${ru}${ds.toFixed(2)}px)`,uu.top=`${ru}${Il.toFixed(2)}px)`),uu.fontSize=`${ru}${ts.toFixed(2)}px)`,uu.fontFamily=kn.fontFamily,$n.fontSize=ts,Tn.setAttribute("role","presentation"),Tn.textContent=tn.str,Tn.dir=tn.dir,Nr._fontInspectorEnabled&&(Tn.dataset.fontName=tn.fontName),es!==0&&($n.angle=es*(180/Math.PI));let p0=!1;if(tn.str.length>1)p0=!0;else if(tn.str!==" "&&tn.transform[0]!==tn.transform[3]){const X1=Math.abs(tn.transform[0]),q0=Math.abs(tn.transform[3]);X1!==q0&&Math.max(X1,q0)/Math.min(X1,q0)>1.5&&(p0=!0)}p0&&($n.canvasWidth=kn.vertical?tn.height:tn.width),Nr._textDivProperties.set(Tn,$n),Nr._isReadableStream&&Nr._layoutText(Tn)}function dr(Nr){const{div:tn,scale:rn,properties:Tn,ctx:$n,prevFontSize:un,prevFontFamily:es}=Nr,{style:kn}=tn;let ts="";if(Tn.canvasWidth!==0&&Tn.hasText){const{fontFamily:Ko}=kn,{canvasWidth:ds,fontSize:Il}=Tn;(un!==Il||es!==Ko)&&($n.font=`${Il*rn}px ${Ko}`,Nr.prevFontSize=Il,Nr.prevFontFamily=Ko);const{width:ru}=$n.measureText(tn.textContent);ru>0&&(ts=`scaleX(${ds*rn/ru})`)}Tn.angle!==0&&(ts=`rotate(${Tn.angle}deg) ${ts}`),ts.length>0&&(kn.transform=ts)}function Mr(Nr){if(Nr._canceled)return;const tn=Nr._textDivs,rn=Nr._capability;if(tn.length>Et){rn.resolve();return}if(!Nr._isReadableStream)for(const $n of tn)Nr._layoutText($n);rn.resolve()}class Tr{constructor({textContentSource:tn,container:rn,viewport:Tn,textDivs:$n,textDivProperties:un,textContentItemsStr:es,isOffscreenCanvasSupported:kn}){var ru;this._textContentSource=tn,this._isReadableStream=tn instanceof ReadableStream,this._container=this._rootContainer=rn,this._textDivs=$n||[],this._textContentItemsStr=es||[],this._isOffscreenCanvasSupported=kn,this._fontInspectorEnabled=!!((ru=globalThis.FontInspector)!=null&&ru.enabled),this._reader=null,this._textDivProperties=un||new WeakMap,this._canceled=!1,this._capability=new gt.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:Tn.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:Nt(0,kn)};const{pageWidth:ts,pageHeight:Ko,pageX:ds,pageY:Il}=Tn.rawDims;this._transform=[1,0,0,-1,-ds,Il+Ko],this._pageWidth=ts,this._pageHeight=Ko,(0,_t.setLayerDimensions)(rn,Tn),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new gt.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new gt.AbortException("TextLayer task cancelled."))}_processItems(tn,rn){for(const Tn of tn){if(Tn.str===void 0){if(Tn.type==="beginMarkedContentProps"||Tn.type==="beginMarkedContent"){const $n=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),Tn.id!==null&&this._container.setAttribute("id",`${Tn.id}`),$n.append(this._container)}else Tn.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(Tn.str),Gt(this,Tn,rn)}}_layoutText(tn){const rn=this._layoutTextParams.properties=this._textDivProperties.get(tn);if(this._layoutTextParams.div=tn,dr(this._layoutTextParams),rn.hasText&&this._container.append(tn),rn.hasEOL){const Tn=document.createElement("br");Tn.setAttribute("role","presentation"),this._container.append(Tn)}}_render(){const tn=new gt.PromiseCapability;let rn=Object.create(null);if(this._isReadableStream){const Tn=()=>{this._reader.read().then(({value:$n,done:un})=>{if(un){tn.resolve();return}Object.assign(rn,$n.styles),this._processItems($n.items,rn),Tn()},tn.reject)};this._reader=this._textContentSource.getReader(),Tn()}else if(this._textContentSource){const{items:Tn,styles:$n}=this._textContentSource;this._processItems(Tn,$n),tn.resolve()}else throw new Error('No "textContentSource" parameter specified.');tn.promise.then(()=>{rn=null,Mr(this)},this._capability.reject)}}st.TextLayerRenderTask=Tr;function zr(Nr){!Nr.textContentSource&&(Nr.textContent||Nr.textContentStream)&&((0,_t.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),Nr.textContentSource=Nr.textContent||Nr.textContentStream);const{container:tn,viewport:rn}=Nr,Tn=getComputedStyle(tn),$n=Tn.getPropertyValue("visibility"),un=parseFloat(Tn.getPropertyValue("--scale-factor"));$n==="visible"&&(!un||Math.abs(un-rn.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const es=new Tr(Nr);return es._render(),es}function Fr({container:Nr,viewport:tn,textDivs:rn,textDivProperties:Tn,isOffscreenCanvasSupported:$n,mustRotate:un=!0,mustRescale:es=!0}){if(un&&(0,_t.setLayerDimensions)(Nr,{rotation:tn.rotation}),es){const kn=Nt(0,$n),Ko={prevFontSize:null,prevFontFamily:null,div:null,scale:tn.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:kn};for(const ds of rn)Ko.properties=Tn.get(ds),Ko.div=ds,dr(Ko)}}},(nt,st,mt)=>{var Bt,Gt,dr,Mr,Tr,zr,Fr,Nr,tn,rn,Tn,pie,$te,fie,mie;Object.defineProperty(st,"__esModule",{value:!0}),st.AnnotationEditorLayer=void 0;var gt=mt(1),_t=mt(4),Et=mt(28),At=mt(33),Rt=mt(6),Ft=mt(34);const ts=class ts{constructor({uiManager:ds,pageIndex:Il,div:ru,accessibilityManager:uu,annotationLayer:p0,viewport:X1,l10n:q0}){G$(this,Tn);G$(this,Bt);G$(this,Gt,!1);G$(this,dr,null);G$(this,Mr,this.pointerup.bind(this));G$(this,Tr,this.pointerdown.bind(this));G$(this,zr,new Map);G$(this,Fr,!1);G$(this,Nr,!1);G$(this,tn,!1);G$(this,rn);const W0=[Et.FreeTextEditor,At.InkEditor,Ft.StampEditor];if(!ts._initialized){ts._initialized=!0;for(const hu of W0)hu.initialize(q0)}ds.registerEditorTypes(W0),K$(this,rn,ds),this.pageIndex=Il,this.div=ru,K$(this,Bt,uu),K$(this,dr,p0),this.viewport=X1,Sv(this,rn).addLayer(this)}get isEmpty(){return Sv(this,zr).size===0}updateToolbar(ds){Sv(this,rn).updateToolbar(ds)}updateMode(ds=Sv(this,rn).getMode()){L$(this,Tn,mie).call(this),ds===gt.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),ds!==gt.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",ds===gt.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",ds===gt.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",ds===gt.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(ds){if(!ds&&Sv(this,rn).getMode()!==gt.AnnotationEditorType.INK)return;if(!ds){for(const ru of Sv(this,zr).values())if(ru.isEmpty()){ru.setInBackground();return}}L$(this,Tn,$te).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(ds){Sv(this,rn).setEditingState(ds)}addCommands(ds){Sv(this,rn).addCommands(ds)}enable(){this.div.style.pointerEvents="auto";const ds=new Set;for(const ru of Sv(this,zr).values())ru.enableEditing(),ru.annotationElementId&&ds.add(ru.annotationElementId);if(!Sv(this,dr))return;const Il=Sv(this,dr).getEditableAnnotations();for(const ru of Il){if(ru.hide(),Sv(this,rn).isDeletedAnnotationElement(ru.data.id)||ds.has(ru.data.id))continue;const uu=this.deserialize(ru);uu&&(this.addOrRebuild(uu),uu.enableEditing())}}disable(){var Il;K$(this,tn,!0),this.div.style.pointerEvents="none";const ds=new Set;for(const ru of Sv(this,zr).values()){if(ru.disableEditing(),!ru.annotationElementId||ru.serialize()!==null){ds.add(ru.annotationElementId);continue}(Il=this.getEditableAnnotation(ru.annotationElementId))==null||Il.show(),ru.remove()}if(Sv(this,dr)){const ru=Sv(this,dr).getEditableAnnotations();for(const uu of ru){const{id:p0}=uu.data;ds.has(p0)||Sv(this,rn).isDeletedAnnotationElement(p0)||uu.show()}}L$(this,Tn,mie).call(this),this.isEmpty&&(this.div.hidden=!0),K$(this,tn,!1)}getEditableAnnotation(ds){var Il;return((Il=Sv(this,dr))==null?void 0:Il.getEditableAnnotation(ds))||null}setActiveEditor(ds){Sv(this,rn).getActive()!==ds&&Sv(this,rn).setActiveEditor(ds)}enableClick(){this.div.addEventListener("pointerdown",Sv(this,Tr)),this.div.addEventListener("pointerup",Sv(this,Mr))}disableClick(){this.div.removeEventListener("pointerdown",Sv(this,Tr)),this.div.removeEventListener("pointerup",Sv(this,Mr))}attach(ds){Sv(this,zr).set(ds.id,ds);const{annotationElementId:Il}=ds;Il&&Sv(this,rn).isDeletedAnnotationElement(Il)&&Sv(this,rn).removeDeletedAnnotationElement(ds)}detach(ds){var Il;Sv(this,zr).delete(ds.id),(Il=Sv(this,Bt))==null||Il.removePointerInTextLayer(ds.contentDiv),!Sv(this,tn)&&ds.annotationElementId&&Sv(this,rn).addDeletedAnnotationElement(ds)}remove(ds){this.detach(ds),Sv(this,rn).removeEditor(ds),ds.div.contains(document.activeElement)&&setTimeout(()=>{Sv(this,rn).focusMainContainer()},0),ds.div.remove(),ds.isAttachedToDOM=!1,Sv(this,Nr)||this.addInkEditorIfNeeded(!1)}changeParent(ds){var Il;ds.parent!==this&&(ds.annotationElementId&&(Sv(this,rn).addDeletedAnnotationElement(ds.annotationElementId),_t.AnnotationEditor.deleteAnnotationElement(ds),ds.annotationElementId=null),this.attach(ds),(Il=ds.parent)==null||Il.detach(ds),ds.setParent(this),ds.div&&ds.isAttachedToDOM&&(ds.div.remove(),this.div.append(ds.div)))}add(ds){if(this.changeParent(ds),Sv(this,rn).addEditor(ds),this.attach(ds),!ds.isAttachedToDOM){const Il=ds.render();this.div.append(Il),ds.isAttachedToDOM=!0}ds.fixAndSetPosition(),ds.onceAdded(),Sv(this,rn).addToAnnotationStorage(ds)}moveEditorInDOM(ds){var ru;if(!ds.isAttachedToDOM)return;const{activeElement:Il}=document;ds.div.contains(Il)&&(ds._focusEventsAllowed=!1,setTimeout(()=>{ds.div.contains(document.activeElement)?ds._focusEventsAllowed=!0:(ds.div.addEventListener("focusin",()=>{ds._focusEventsAllowed=!0},{once:!0}),Il.focus())},0)),ds._structTreeParentId=(ru=Sv(this,Bt))==null?void 0:ru.moveElementInDOM(this.div,ds.div,ds.contentDiv,!0)}addOrRebuild(ds){ds.needsToBeRebuilt()?ds.rebuild():this.add(ds)}addUndoableEditor(ds){const Il=()=>ds._uiManager.rebuild(ds),ru=()=>{ds.remove()};this.addCommands({cmd:Il,undo:ru,mustExec:!1})}getNextId(){return Sv(this,rn).getId()}pasteEditor(ds,Il){Sv(this,rn).updateToolbar(ds),Sv(this,rn).updateMode(ds);const{offsetX:ru,offsetY:uu}=L$(this,Tn,fie).call(this),p0=this.getNextId(),X1=L$(this,Tn,pie).call(this,{parent:this,id:p0,x:ru,y:uu,uiManager:Sv(this,rn),isCentered:!0,...Il});X1&&this.add(X1)}deserialize(ds){switch(ds.annotationType??ds.annotationEditorType){case gt.AnnotationEditorType.FREETEXT:return Et.FreeTextEditor.deserialize(ds,this,Sv(this,rn));case gt.AnnotationEditorType.INK:return At.InkEditor.deserialize(ds,this,Sv(this,rn));case gt.AnnotationEditorType.STAMP:return Ft.StampEditor.deserialize(ds,this,Sv(this,rn))}return null}addNewEditor(){L$(this,Tn,$te).call(this,L$(this,Tn,fie).call(this),!0)}setSelected(ds){Sv(this,rn).setSelected(ds)}toggleSelected(ds){Sv(this,rn).toggleSelected(ds)}isSelected(ds){return Sv(this,rn).isSelected(ds)}unselect(ds){Sv(this,rn).unselect(ds)}pointerup(ds){const{isMac:Il}=gt.FeatureTest.platform;if(!(ds.button!==0||ds.ctrlKey&&Il)&&ds.target===this.div&&Sv(this,Fr)){if(K$(this,Fr,!1),!Sv(this,Gt)){K$(this,Gt,!0);return}if(Sv(this,rn).getMode()===gt.AnnotationEditorType.STAMP){Sv(this,rn).unselectAll();return}L$(this,Tn,$te).call(this,ds,!1)}}pointerdown(ds){if(Sv(this,Fr)){K$(this,Fr,!1);return}const{isMac:Il}=gt.FeatureTest.platform;if(ds.button!==0||ds.ctrlKey&&Il||ds.target!==this.div)return;K$(this,Fr,!0);const ru=Sv(this,rn).getActive();K$(this,Gt,!ru||ru.isEmpty())}findNewParent(ds,Il,ru){const uu=Sv(this,rn).findParent(Il,ru);return uu===null||uu===this?!1:(uu.changeParent(ds),!0)}destroy(){var ds,Il;((ds=Sv(this,rn).getActive())==null?void 0:ds.parent)===this&&(Sv(this,rn).commitOrRemove(),Sv(this,rn).setActiveEditor(null));for(const ru of Sv(this,zr).values())(Il=Sv(this,Bt))==null||Il.removePointerInTextLayer(ru.contentDiv),ru.setParent(null),ru.isAttachedToDOM=!1,ru.div.remove();this.div=null,Sv(this,zr).clear(),Sv(this,rn).removeLayer(this)}render({viewport:ds}){this.viewport=ds,(0,Rt.setLayerDimensions)(this.div,ds);for(const Il of Sv(this,rn).getEditors(this.pageIndex))this.add(Il);this.updateMode()}update({viewport:ds}){Sv(this,rn).commitOrRemove(),this.viewport=ds,(0,Rt.setLayerDimensions)(this.div,{rotation:ds.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:ds,pageHeight:Il}=this.viewport.rawDims;return[ds,Il]}};Bt=new WeakMap,Gt=new WeakMap,dr=new WeakMap,Mr=new WeakMap,Tr=new WeakMap,zr=new WeakMap,Fr=new WeakMap,Nr=new WeakMap,tn=new WeakMap,rn=new WeakMap,Tn=new WeakSet,pie=function(ds){switch(Sv(this,rn).getMode()){case gt.AnnotationEditorType.FREETEXT:return new Et.FreeTextEditor(ds);case gt.AnnotationEditorType.INK:return new At.InkEditor(ds);case gt.AnnotationEditorType.STAMP:return new Ft.StampEditor(ds)}return null},$te=function(ds,Il){const ru=this.getNextId(),uu=L$(this,Tn,pie).call(this,{parent:this,id:ru,x:ds.offsetX,y:ds.offsetY,uiManager:Sv(this,rn),isCentered:Il});return uu&&this.add(uu),uu},fie=function(){const{x:ds,y:Il,width:ru,height:uu}=this.div.getBoundingClientRect(),p0=Math.max(0,ds),X1=Math.max(0,Il),q0=Math.min(window.innerWidth,ds+ru),W0=Math.min(window.innerHeight,Il+uu),hu=(p0+q0)/2-ds,a1=(X1+W0)/2-Il,[Vx,t0]=this.viewport.rotation%180===0?[hu,a1]:[a1,hu];return{offsetX:Vx,offsetY:t0}},mie=function(){K$(this,Nr,!0);for(const ds of Sv(this,zr).values())ds.isEmpty()&&ds.remove();K$(this,Nr,!1)},lee(ts,"_initialized",!1);let Nt=ts;st.AnnotationEditorLayer=Nt},(nt,st,mt)=>{var Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr,Nr,rre,nre,are,gte,gie,sre,vie;Object.defineProperty(st,"__esModule",{value:!0}),st.FreeTextEditor=void 0;var gt=mt(1),_t=mt(5),Et=mt(4),At=mt(29);const ts=class ts extends Et.AnnotationEditor{constructor(Il){super({...Il,name:"freeTextEditor"});G$(this,Nr);G$(this,Ft,this.editorDivBlur.bind(this));G$(this,Nt,this.editorDivFocus.bind(this));G$(this,Bt,this.editorDivInput.bind(this));G$(this,Gt,this.editorDivKeydown.bind(this));G$(this,dr);G$(this,Mr,"");G$(this,Tr,`${this.id}-editor`);G$(this,zr);G$(this,Fr,null);K$(this,dr,Il.color||ts._defaultColor||Et.AnnotationEditor._defaultLineColor),K$(this,zr,Il.fontSize||ts._defaultFontSize)}static get _keyboardManager(){const Il=ts.prototype,ru=X1=>X1.isEmpty(),uu=_t.AnnotationEditorUIManager.TRANSLATE_SMALL,p0=_t.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,gt.shadow)(this,"_keyboardManager",new _t.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],Il.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],Il.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],Il._translateEmpty,{args:[-uu,0],checker:ru}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Il._translateEmpty,{args:[-p0,0],checker:ru}],[["ArrowRight","mac+ArrowRight"],Il._translateEmpty,{args:[uu,0],checker:ru}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Il._translateEmpty,{args:[p0,0],checker:ru}],[["ArrowUp","mac+ArrowUp"],Il._translateEmpty,{args:[0,-uu],checker:ru}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Il._translateEmpty,{args:[0,-p0],checker:ru}],[["ArrowDown","mac+ArrowDown"],Il._translateEmpty,{args:[0,uu],checker:ru}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Il._translateEmpty,{args:[0,p0],checker:ru}]]))}static initialize(Il){Et.AnnotationEditor.initialize(Il,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const ru=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(ru.getPropertyValue("--freetext-padding"))}static updateDefaultParams(Il,ru){switch(Il){case gt.AnnotationEditorParamsType.FREETEXT_SIZE:ts._defaultFontSize=ru;break;case gt.AnnotationEditorParamsType.FREETEXT_COLOR:ts._defaultColor=ru;break}}updateParams(Il,ru){switch(Il){case gt.AnnotationEditorParamsType.FREETEXT_SIZE:L$(this,Nr,rre).call(this,ru);break;case gt.AnnotationEditorParamsType.FREETEXT_COLOR:L$(this,Nr,nre).call(this,ru);break}}static get defaultPropertiesToUpdate(){return[[gt.AnnotationEditorParamsType.FREETEXT_SIZE,ts._defaultFontSize],[gt.AnnotationEditorParamsType.FREETEXT_COLOR,ts._defaultColor||Et.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[gt.AnnotationEditorParamsType.FREETEXT_SIZE,Sv(this,zr)],[gt.AnnotationEditorParamsType.FREETEXT_COLOR,Sv(this,dr)]]}_translateEmpty(Il,ru){this._uiManager.translateSelectedEditors(Il,ru,!0)}getInitialTranslation(){const Il=this.parentScale;return[-ts._internalPadding*Il,-(ts._internalPadding+Sv(this,zr))*Il]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(gt.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",Sv(this,Gt)),this.editorDiv.addEventListener("focus",Sv(this,Nt)),this.editorDiv.addEventListener("blur",Sv(this,Ft)),this.editorDiv.addEventListener("input",Sv(this,Bt)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",Sv(this,Tr)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",Sv(this,Gt)),this.editorDiv.removeEventListener("focus",Sv(this,Nt)),this.editorDiv.removeEventListener("blur",Sv(this,Ft)),this.editorDiv.removeEventListener("input",Sv(this,Bt)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(Il){this._focusEventsAllowed&&(super.focusin(Il),Il.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var Il;if(this.width){L$(this,Nr,vie).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(Il=this._initialOptions)!=null&&Il.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const Il=Sv(this,Mr),ru=K$(this,Mr,L$(this,Nr,are).call(this).trimEnd());if(Il===ru)return;const uu=p0=>{if(K$(this,Mr,p0),!p0){this.remove();return}L$(this,Nr,gie).call(this),this._uiManager.rebuild(this),L$(this,Nr,gte).call(this)};this.addCommands({cmd:()=>{uu(ru)},undo:()=>{uu(Il)},mustExec:!1}),L$(this,Nr,gte).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(Il){this.enterInEditMode()}keydown(Il){Il.target===this.div&&Il.key==="Enter"&&(this.enterInEditMode(),Il.preventDefault())}editorDivKeydown(Il){ts._keyboardManager.exec(this,Il)}editorDivFocus(Il){this.isEditing=!0}editorDivBlur(Il){this.isEditing=!1}editorDivInput(Il){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let Il,ru;this.width&&(Il=this.x,ru=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",Sv(this,Tr)),this.enableEditing(),Et.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(p0=>{var X1;return(X1=this.editorDiv)==null?void 0:X1.setAttribute("aria-label",p0)}),Et.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(p0=>{var X1;return(X1=this.editorDiv)==null?void 0:X1.setAttribute("default-content",p0)}),this.editorDiv.contentEditable=!0;const{style:uu}=this.editorDiv;if(uu.fontSize=`calc(${Sv(this,zr)}px * var(--scale-factor))`,uu.color=Sv(this,dr),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,_t.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[p0,X1]=this.parentDimensions;if(this.annotationElementId){const{position:q0}=Sv(this,Fr);let[W0,hu]=this.getInitialTranslation();[W0,hu]=this.pageTranslationToScreen(W0,hu);const[a1,Vx]=this.pageDimensions,[t0,cu]=this.pageTranslation;let lu,b0;switch(this.rotation){case 0:lu=Il+(q0[0]-t0)/a1,b0=ru+this.height-(q0[1]-cu)/Vx;break;case 90:lu=Il+(q0[0]-t0)/a1,b0=ru-(q0[1]-cu)/Vx,[W0,hu]=[hu,-W0];break;case 180:lu=Il-this.width+(q0[0]-t0)/a1,b0=ru-(q0[1]-cu)/Vx,[W0,hu]=[-W0,-hu];break;case 270:lu=Il+(q0[0]-t0-this.height*Vx)/a1,b0=ru+(q0[1]-cu-this.width*a1)/Vx,[W0,hu]=[-hu,W0];break}this.setAt(lu*p0,b0*X1,W0,hu)}else this.setAt(Il*p0,ru*X1,this.width*p0,this.height*X1);L$(this,Nr,gie).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(Il,ru,uu){let p0=null;if(Il instanceof At.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:q0,fontColor:W0},rect:hu,rotation:a1,id:Vx},textContent:t0,textPosition:cu,parent:{page:{pageNumber:lu}}}=Il;if(!t0||t0.length===0)return null;p0=Il={annotationType:gt.AnnotationEditorType.FREETEXT,color:Array.from(W0),fontSize:q0,value:t0.join(`
`),position:cu,pageIndex:lu-1,rect:hu,rotation:a1,id:Vx,deleted:!1}}const X1=super.deserialize(Il,ru,uu);return K$(X1,zr,Il.fontSize),K$(X1,dr,gt.Util.makeHexColor(...Il.color)),K$(X1,Mr,Il.value),X1.annotationElementId=Il.id||null,K$(X1,Fr,p0),X1}serialize(Il=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const ru=ts._internalPadding*this.parentScale,uu=this.getRect(ru,ru),p0=Et.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:Sv(this,dr)),X1={annotationType:gt.AnnotationEditorType.FREETEXT,color:p0,fontSize:Sv(this,zr),value:Sv(this,Mr),pageIndex:this.pageIndex,rect:uu,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return Il?X1:this.annotationElementId&&!L$(this,Nr,sre).call(this,X1)?null:(X1.id=this.annotationElementId,X1)}};Ft=new WeakMap,Nt=new WeakMap,Bt=new WeakMap,Gt=new WeakMap,dr=new WeakMap,Mr=new WeakMap,Tr=new WeakMap,zr=new WeakMap,Fr=new WeakMap,Nr=new WeakSet,rre=function(Il){const ru=p0=>{this.editorDiv.style.fontSize=`calc(${p0}px * var(--scale-factor))`,this.translate(0,-(p0-Sv(this,zr))*this.parentScale),K$(this,zr,p0),L$(this,Nr,gte).call(this)},uu=Sv(this,zr);this.addCommands({cmd:()=>{ru(Il)},undo:()=>{ru(uu)},mustExec:!0,type:gt.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},nre=function(Il){const ru=Sv(this,dr);this.addCommands({cmd:()=>{K$(this,dr,this.editorDiv.style.color=Il)},undo:()=>{K$(this,dr,this.editorDiv.style.color=ru)},mustExec:!0,type:gt.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},are=function(){const Il=this.editorDiv.getElementsByTagName("div");if(Il.length===0)return this.editorDiv.innerText;const ru=[];for(const uu of Il)ru.push(uu.innerText.replace(/\r\n?|\n/,""));return ru.join(`
`)},gte=function(){const[Il,ru]=this.parentDimensions;let uu;if(this.isAttachedToDOM)uu=this.div.getBoundingClientRect();else{const{currentLayer:p0,div:X1}=this,q0=X1.style.display;X1.style.display="hidden",p0.div.append(this.div),uu=X1.getBoundingClientRect(),X1.remove(),X1.style.display=q0}this.rotation%180===this.parentRotation%180?(this.width=uu.width/Il,this.height=uu.height/ru):(this.width=uu.height/Il,this.height=uu.width/ru),this.fixAndSetPosition()},gie=function(){if(this.editorDiv.replaceChildren(),!!Sv(this,Mr))for(const Il of Sv(this,Mr).split(`
`)){const ru=document.createElement("div");ru.append(Il?document.createTextNode(Il):document.createElement("br")),this.editorDiv.append(ru)}},sre=function(Il){const{value:ru,fontSize:uu,color:p0,rect:X1,pageIndex:q0}=Sv(this,Fr);return Il.value!==ru||Il.fontSize!==uu||Il.rect.some((W0,hu)=>Math.abs(W0-X1[hu])>=1)||Il.color.some((W0,hu)=>W0!==p0[hu])||Il.pageIndex!==q0},vie=function(Il=!1){if(!this.annotationElementId)return;if(L$(this,Nr,gte).call(this),!Il&&(this.width===0||this.height===0)){setTimeout(()=>L$(this,Nr,vie).call(this,!0),0);return}const ru=ts._internalPadding*this.parentScale;Sv(this,Fr).rect=this.getRect(ru,ru)},lee(ts,"_freeTextDefaultContent",""),lee(ts,"_internalPadding",0),lee(ts,"_defaultColor",null),lee(ts,"_defaultFontSize",10),lee(ts,"_type","freetext");let Rt=ts;st.FreeTextEditor=Rt},(nt,st,mt)=>{var b0,LE,Qee,ore,o$,h$,d$,y$,R$,M$,x$,v$,rS,wA,g$,S$,tA,tS,m$,u$,UE,F$,lre,Dte,yie,xie,gD,fL,I7,j$,_$,I$,GL,bie,B$,r$,O$,Z$,cre,wie;Object.defineProperty(st,"__esModule",{value:!0}),st.StampAnnotationElement=st.InkAnnotationElement=st.FreeTextAnnotationElement=st.AnnotationLayer=void 0;var gt=mt(1),_t=mt(6),Et=mt(3),At=mt(30),Rt=mt(31),Ft=mt(32);const Nt=1e3,Bt=9,Gt=new WeakSet;function dr(L9){return{width:L9[2]-L9[0],height:L9[3]-L9[1]}}class Mr{static create(f$){switch(f$.data.annotationType){case gt.AnnotationType.LINK:return new zr(f$);case gt.AnnotationType.TEXT:return new Fr(f$);case gt.AnnotationType.WIDGET:switch(f$.data.fieldType){case"Tx":return new tn(f$);case"Btn":return f$.data.radioButton?new $n(f$):f$.data.checkBox?new Tn(f$):new un(f$);case"Ch":return new es(f$);case"Sig":return new rn(f$)}return new Nr(f$);case gt.AnnotationType.POPUP:return new kn(f$);case gt.AnnotationType.FREETEXT:return new Ko(f$);case gt.AnnotationType.LINE:return new ds(f$);case gt.AnnotationType.SQUARE:return new Il(f$);case gt.AnnotationType.CIRCLE:return new ru(f$);case gt.AnnotationType.POLYLINE:return new uu(f$);case gt.AnnotationType.CARET:return new X1(f$);case gt.AnnotationType.INK:return new q0(f$);case gt.AnnotationType.POLYGON:return new p0(f$);case gt.AnnotationType.HIGHLIGHT:return new W0(f$);case gt.AnnotationType.UNDERLINE:return new hu(f$);case gt.AnnotationType.SQUIGGLY:return new a1(f$);case gt.AnnotationType.STRIKEOUT:return new Vx(f$);case gt.AnnotationType.STAMP:return new t0(f$);case gt.AnnotationType.FILEATTACHMENT:return new cu(f$);default:return new Tr(f$)}}}const l1=class l1{constructor(f$,{isRenderable:l$=!1,ignoreBorder:T$=!1,createQuadrilaterals:q$=!1}={}){G$(this,b0,!1);this.isRenderable=l$,this.data=f$.data,this.layer=f$.layer,this.linkService=f$.linkService,this.downloadManager=f$.downloadManager,this.imageResourcesPath=f$.imageResourcesPath,this.renderForms=f$.renderForms,this.svgFactory=f$.svgFactory,this.annotationStorage=f$.annotationStorage,this.enableScripting=f$.enableScripting,this.hasJSActions=f$.hasJSActions,this._fieldObjects=f$.fieldObjects,this.parent=f$.parent,l$&&(this.container=this._createContainer(T$)),q$&&this._createQuadrilaterals()}static _hasPopupData({titleObj:f$,contentsObj:l$,richText:T$}){return!!(f$!=null&&f$.str||l$!=null&&l$.str||T$!=null&&T$.str)}get hasPopupData(){return l1._hasPopupData(this.data)}_createContainer(f$){const{data:l$,parent:{page:T$,viewport:q$}}=this,Q$=document.createElement("section");Q$.setAttribute("data-annotation-id",l$.id),this instanceof Nr||(Q$.tabIndex=Nt),Q$.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Q$.setAttribute("aria-haspopup","dialog"),l$.noRotate&&Q$.classList.add("norotate");const{pageWidth:gR,pageHeight:kI,pageX:Pq,pageY:s$}=q$.rawDims;if(!l$.rect||this instanceof kn){const{rotation:H3}=l$;return!l$.hasOwnCanvas&&H3!==0&&this.setRotation(H3,Q$),Q$}const{width:C$,height:Y$}=dr(l$.rect),P$=gt.Util.normalizeRect([l$.rect[0],T$.view[3]-l$.rect[1]+T$.view[1],l$.rect[2],T$.view[3]-l$.rect[3]+T$.view[1]]);if(!f$&&l$.borderStyle.width>0){Q$.style.borderWidth=`${l$.borderStyle.width}px`;const H3=l$.borderStyle.horizontalCornerRadius,D7=l$.borderStyle.verticalCornerRadius;if(H3>0||D7>0){const Cq=`calc(${H3}px * var(--scale-factor)) / calc(${D7}px * var(--scale-factor))`;Q$.style.borderRadius=Cq}else if(this instanceof $n){const Cq=`calc(${C$}px * var(--scale-factor)) / calc(${Y$}px * var(--scale-factor))`;Q$.style.borderRadius=Cq}switch(l$.borderStyle.style){case gt.AnnotationBorderStyleType.SOLID:Q$.style.borderStyle="solid";break;case gt.AnnotationBorderStyleType.DASHED:Q$.style.borderStyle="dashed";break;case gt.AnnotationBorderStyleType.BEVELED:(0,gt.warn)("Unimplemented border style: beveled");break;case gt.AnnotationBorderStyleType.INSET:(0,gt.warn)("Unimplemented border style: inset");break;case gt.AnnotationBorderStyleType.UNDERLINE:Q$.style.borderBottomStyle="solid";break}const Tq=l$.borderColor||null;Tq?(K$(this,b0,!0),Q$.style.borderColor=gt.Util.makeHexColor(Tq[0]|0,Tq[1]|0,Tq[2]|0)):Q$.style.borderWidth=0}Q$.style.left=`${100*(P$[0]-Pq)/gR}%`,Q$.style.top=`${100*(P$[1]-s$)/kI}%`;const{rotation:N$}=l$;return l$.hasOwnCanvas||N$===0?(Q$.style.width=`${100*C$/gR}%`,Q$.style.height=`${100*Y$/kI}%`):this.setRotation(N$,Q$),Q$}setRotation(f$,l$=this.container){if(!this.data.rect)return;const{pageWidth:T$,pageHeight:q$}=this.parent.viewport.rawDims,{width:Q$,height:gR}=dr(this.data.rect);let kI,Pq;f$%180===0?(kI=100*Q$/T$,Pq=100*gR/q$):(kI=100*gR/T$,Pq=100*Q$/q$),l$.style.width=`${kI}%`,l$.style.height=`${Pq}%`,l$.setAttribute("data-main-rotation",(360-f$)%360)}get _commonActions(){const f$=(l$,T$,q$)=>{const Q$=q$.detail[l$],gR=Q$[0],kI=Q$.slice(1);q$.target.style[T$]=At.ColorConverters[`${gR}_HTML`](kI),this.annotationStorage.setValue(this.data.id,{[T$]:At.ColorConverters[`${gR}_rgb`](kI)})};return(0,gt.shadow)(this,"_commonActions",{display:l$=>{const{display:T$}=l$.detail,q$=T$%2===1;this.container.style.visibility=q$?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:q$,noPrint:T$===1||T$===2})},print:l$=>{this.annotationStorage.setValue(this.data.id,{noPrint:!l$.detail.print})},hidden:l$=>{const{hidden:T$}=l$.detail;this.container.style.visibility=T$?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:T$,noView:T$})},focus:l$=>{setTimeout(()=>l$.target.focus({preventScroll:!1}),0)},userName:l$=>{l$.target.title=l$.detail.userName},readonly:l$=>{l$.target.disabled=l$.detail.readonly},required:l$=>{this._setRequired(l$.target,l$.detail.required)},bgColor:l$=>{f$("bgColor","backgroundColor",l$)},fillColor:l$=>{f$("fillColor","backgroundColor",l$)},fgColor:l$=>{f$("fgColor","color",l$)},textColor:l$=>{f$("textColor","color",l$)},borderColor:l$=>{f$("borderColor","borderColor",l$)},strokeColor:l$=>{f$("strokeColor","borderColor",l$)},rotation:l$=>{const T$=l$.detail.rotation;this.setRotation(T$),this.annotationStorage.setValue(this.data.id,{rotation:T$})}})}_dispatchEventFromSandbox(f$,l$){const T$=this._commonActions;for(const q$ of Object.keys(l$.detail)){const Q$=f$[q$]||T$[q$];Q$==null||Q$(l$)}}_setDefaultPropertiesFromJS(f$){if(!this.enableScripting)return;const l$=this.annotationStorage.getRawValue(this.data.id);if(!l$)return;const T$=this._commonActions;for(const[q$,Q$]of Object.entries(l$)){const gR=T$[q$];if(gR){const kI={detail:{[q$]:Q$},target:f$};gR(kI),delete l$[q$]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:f$}=this.data;if(!f$)return;const[l$,T$,q$,Q$]=this.data.rect;if(f$.length===1){const[,{x:D7,y:Tq},{x:Cq,y:PK}]=f$[0];if(q$===D7&&Q$===Tq&&l$===Cq&&T$===PK)return}const{style:gR}=this.container;let kI;if(Sv(this,b0)){const{borderColor:D7,borderWidth:Tq}=gR;gR.borderWidth=0,kI=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${D7}" stroke-width="${Tq}">`],this.container.classList.add("hasBorder")}const Pq=q$-l$,s$=Q$-T$,{svgFactory:C$}=this,Y$=C$.createElement("svg");Y$.classList.add("quadrilateralsContainer"),Y$.setAttribute("width",0),Y$.setAttribute("height",0);const P$=C$.createElement("defs");Y$.append(P$);const N$=C$.createElement("clipPath"),H3=`clippath_${this.data.id}`;N$.setAttribute("id",H3),N$.setAttribute("clipPathUnits","objectBoundingBox"),P$.append(N$);for(const[,{x:D7,y:Tq},{x:Cq,y:PK}]of f$){const Nq=C$.createElement("rect"),DK=(Cq-l$)/Pq,yK=(Q$-Tq)/s$,hee=(D7-Cq)/Pq,Cee=(Tq-PK)/s$;Nq.setAttribute("x",DK),Nq.setAttribute("y",yK),Nq.setAttribute("width",hee),Nq.setAttribute("height",Cee),N$.append(Nq),kI==null||kI.push(`<rect vector-effect="non-scaling-stroke" x="${DK}" y="${yK}" width="${hee}" height="${Cee}"/>`)}Sv(this,b0)&&(kI.push("</g></svg>')"),gR.backgroundImage=kI.join("")),this.container.append(Y$),this.container.style.clipPath=`url(#${H3})`}_createPopup(){const{container:f$,data:l$}=this;f$.setAttribute("aria-haspopup","dialog");const T$=new kn({data:{color:l$.color,titleObj:l$.titleObj,modificationDate:l$.modificationDate,contentsObj:l$.contentsObj,richText:l$.richText,parentRect:l$.rect,borderStyle:0,id:`popup_${l$.id}`,rotation:l$.rotation},parent:this.parent,elements:[this]});this.parent.div.append(T$.render())}render(){(0,gt.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(f$,l$=null){const T$=[];if(this._fieldObjects){const q$=this._fieldObjects[f$];if(q$)for(const{page:Q$,id:gR,exportValues:kI}of q$){if(Q$===-1||gR===l$)continue;const Pq=typeof kI=="string"?kI:null,s$=document.querySelector(`[data-element-id="${gR}"]`);if(s$&&!Gt.has(s$)){(0,gt.warn)(`_getElementsByName - element not allowed: ${gR}`);continue}T$.push({id:gR,exportValue:Pq,domElement:s$})}return T$}for(const q$ of document.getElementsByName(f$)){const{exportValue:Q$}=q$,gR=q$.getAttribute("data-element-id");gR!==l$&&Gt.has(q$)&&T$.push({id:gR,exportValue:Q$,domElement:q$})}return T$}show(){var f$;this.container&&(this.container.hidden=!1),(f$=this.popup)==null||f$.maybeShow()}hide(){var f$;this.container&&(this.container.hidden=!0),(f$=this.popup)==null||f$.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const f$=this.getElementsToTriggerPopup();if(Array.isArray(f$))for(const l$ of f$)l$.classList.add("highlightArea");else f$.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:f$,data:{id:l$}}=this;this.container.addEventListener("dblclick",()=>{var T$;(T$=this.linkService.eventBus)==null||T$.dispatch("switchannotationeditormode",{source:this,mode:f$,editId:l$})})}};b0=new WeakMap;let Tr=l1;class zr extends Tr{constructor(l$,T$=null){super(l$,{isRenderable:!0,ignoreBorder:!!(T$!=null&&T$.ignoreBorder),createQuadrilaterals:!0});G$(this,LE);this.isTooltipOnly=l$.data.isTooltipOnly}render(){const{data:l$,linkService:T$}=this,q$=document.createElement("a");q$.setAttribute("data-element-id",l$.id);let Q$=!1;return l$.url?(T$.addLinkAttributes(q$,l$.url,l$.newWindow),Q$=!0):l$.action?(this._bindNamedAction(q$,l$.action),Q$=!0):l$.attachment?(this._bindAttachment(q$,l$.attachment),Q$=!0):l$.setOCGState?(L$(this,LE,ore).call(this,q$,l$.setOCGState),Q$=!0):l$.dest?(this._bindLink(q$,l$.dest),Q$=!0):(l$.actions&&(l$.actions.Action||l$.actions["Mouse Up"]||l$.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(q$,l$),Q$=!0),l$.resetForm?(this._bindResetFormAction(q$,l$.resetForm),Q$=!0):this.isTooltipOnly&&!Q$&&(this._bindLink(q$,""),Q$=!0)),this.container.classList.add("linkAnnotation"),Q$&&this.container.append(q$),this.container}_bindLink(l$,T$){l$.href=this.linkService.getDestinationHash(T$),l$.onclick=()=>(T$&&this.linkService.goToDestination(T$),!1),(T$||T$==="")&&L$(this,LE,Qee).call(this)}_bindNamedAction(l$,T$){l$.href=this.linkService.getAnchorUrl(""),l$.onclick=()=>(this.linkService.executeNamedAction(T$),!1),L$(this,LE,Qee).call(this)}_bindAttachment(l$,T$){l$.href=this.linkService.getAnchorUrl(""),l$.onclick=()=>{var q$;return(q$=this.downloadManager)==null||q$.openOrDownloadData(this.container,T$.content,T$.filename),!1},L$(this,LE,Qee).call(this)}_bindJSAction(l$,T$){l$.href=this.linkService.getAnchorUrl("");const q$=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Q$ of Object.keys(T$.actions)){const gR=q$.get(Q$);gR&&(l$[gR]=()=>{var kI;return(kI=this.linkService.eventBus)==null||kI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T$.id,name:Q$}}),!1})}l$.onclick||(l$.onclick=()=>!1),L$(this,LE,Qee).call(this)}_bindResetFormAction(l$,T$){const q$=l$.onclick;if(q$||(l$.href=this.linkService.getAnchorUrl("")),L$(this,LE,Qee).call(this),!this._fieldObjects){(0,gt.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),q$||(l$.onclick=()=>!1);return}l$.onclick=()=>{var Y$;q$==null||q$();const{fields:Q$,refs:gR,include:kI}=T$,Pq=[];if(Q$.length!==0||gR.length!==0){const P$=new Set(gR);for(const N$ of Q$){const H3=this._fieldObjects[N$]||[];for(const{id:D7}of H3)P$.add(D7)}for(const N$ of Object.values(this._fieldObjects))for(const H3 of N$)P$.has(H3.id)===kI&&Pq.push(H3)}else for(const P$ of Object.values(this._fieldObjects))Pq.push(...P$);const s$=this.annotationStorage,C$=[];for(const P$ of Pq){const{id:N$}=P$;switch(C$.push(N$),P$.type){case"text":{const D7=P$.defaultValue||"";s$.setValue(N$,{value:D7});break}case"checkbox":case"radiobutton":{const D7=P$.defaultValue===P$.exportValues;s$.setValue(N$,{value:D7});break}case"combobox":case"listbox":{const D7=P$.defaultValue||"";s$.setValue(N$,{value:D7});break}default:continue}const H3=document.querySelector(`[data-element-id="${N$}"]`);if(H3){if(!Gt.has(H3)){(0,gt.warn)(`_bindResetFormAction - element not allowed: ${N$}`);continue}}else continue;H3.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Y$=this.linkService.eventBus)==null||Y$.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:C$,name:"ResetForm"}})),!1}}}LE=new WeakSet,Qee=function(){this.container.setAttribute("data-internal-link","")},ore=function(l$,T$){l$.href=this.linkService.getAnchorUrl(""),l$.onclick=()=>(this.linkService.executeSetOCGState(T$),!1),L$(this,LE,Qee).call(this)};class Fr extends Tr{constructor(f$){super(f$,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const f$=document.createElement("img");return f$.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",f$.alt="[{{type}} Annotation]",f$.dataset.l10nId="text_annotation_type",f$.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(f$),this.container}}class Nr extends Tr{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(f$){var l$;this.data.hasOwnCanvas&&(((l$=f$.previousSibling)==null?void 0:l$.nodeName)==="CANVAS"&&(f$.previousSibling.hidden=!0),f$.hidden=!1)}_getKeyModifier(f$){const{isWin:l$,isMac:T$}=gt.FeatureTest.platform;return l$&&f$.ctrlKey||T$&&f$.metaKey}_setEventListener(f$,l$,T$,q$,Q$){T$.includes("mouse")?f$.addEventListener(T$,gR=>{var kI;(kI=this.linkService.eventBus)==null||kI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:q$,value:Q$(gR),shift:gR.shiftKey,modifier:this._getKeyModifier(gR)}})}):f$.addEventListener(T$,gR=>{var kI;if(T$==="blur"){if(!l$.focused||!gR.relatedTarget)return;l$.focused=!1}else if(T$==="focus"){if(l$.focused)return;l$.focused=!0}Q$&&((kI=this.linkService.eventBus)==null||kI.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:q$,value:Q$(gR)}}))})}_setEventListeners(f$,l$,T$,q$){var Q$,gR,kI;for(const[Pq,s$]of T$)(s$==="Action"||(Q$=this.data.actions)!=null&&Q$[s$])&&((s$==="Focus"||s$==="Blur")&&(l$||(l$={focused:!1})),this._setEventListener(f$,l$,Pq,s$,q$),s$==="Focus"&&!((gR=this.data.actions)!=null&&gR.Blur)?this._setEventListener(f$,l$,"blur","Blur",null):s$==="Blur"&&!((kI=this.data.actions)!=null&&kI.Focus)&&this._setEventListener(f$,l$,"focus","Focus",null))}_setBackgroundColor(f$){const l$=this.data.backgroundColor||null;f$.style.backgroundColor=l$===null?"transparent":gt.Util.makeHexColor(l$[0],l$[1],l$[2])}_setTextStyle(f$){const l$=["left","center","right"],{fontColor:T$}=this.data.defaultAppearanceData,q$=this.data.defaultAppearanceData.fontSize||Bt,Q$=f$.style;let gR;const kI=2,Pq=s$=>Math.round(10*s$)/10;if(this.data.multiLine){const s$=Math.abs(this.data.rect[3]-this.data.rect[1]-kI),C$=Math.round(s$/(gt.LINE_FACTOR*q$))||1,Y$=s$/C$;gR=Math.min(q$,Pq(Y$/gt.LINE_FACTOR))}else{const s$=Math.abs(this.data.rect[3]-this.data.rect[1]-kI);gR=Math.min(q$,Pq(s$/gt.LINE_FACTOR))}Q$.fontSize=`calc(${gR}px * var(--scale-factor))`,Q$.color=gt.Util.makeHexColor(T$[0],T$[1],T$[2]),this.data.textAlignment!==null&&(Q$.textAlign=l$[this.data.textAlignment])}_setRequired(f$,l$){l$?f$.setAttribute("required",!0):f$.removeAttribute("required"),f$.setAttribute("aria-required",l$)}}class tn extends Nr{constructor(f$){const l$=f$.renderForms||!f$.data.hasAppearance&&!!f$.data.fieldValue;super(f$,{isRenderable:l$})}setPropertyOnSiblings(f$,l$,T$,q$){const Q$=this.annotationStorage;for(const gR of this._getElementsByName(f$.name,f$.id))gR.domElement&&(gR.domElement[l$]=T$),Q$.setValue(gR.id,{[q$]:T$})}render(){var q$,Q$;const f$=this.annotationStorage,l$=this.data.id;this.container.classList.add("textWidgetAnnotation");let T$=null;if(this.renderForms){const gR=f$.getValue(l$,{value:this.data.fieldValue});let kI=gR.value||"";const Pq=f$.getValue(l$,{charLimit:this.data.maxLen}).charLimit;Pq&&kI.length>Pq&&(kI=kI.slice(0,Pq));let s$=gR.formattedValue||((q$=this.data.textContent)==null?void 0:q$.join(`
`))||null;s$&&this.data.comb&&(s$=s$.replaceAll(/\s+/g,""));const C$={userValue:kI,formattedValue:s$,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(T$=document.createElement("textarea"),T$.textContent=s$??kI,this.data.doNotScroll&&(T$.style.overflowY="hidden")):(T$=document.createElement("input"),T$.type="text",T$.setAttribute("value",s$??kI),this.data.doNotScroll&&(T$.style.overflowX="hidden")),this.data.hasOwnCanvas&&(T$.hidden=!0),Gt.add(T$),T$.setAttribute("data-element-id",l$),T$.disabled=this.data.readOnly,T$.name=this.data.fieldName,T$.tabIndex=Nt,this._setRequired(T$,this.data.required),Pq&&(T$.maxLength=Pq),T$.addEventListener("input",P$=>{f$.setValue(l$,{value:P$.target.value}),this.setPropertyOnSiblings(T$,"value",P$.target.value,"value"),C$.formattedValue=null}),T$.addEventListener("resetform",P$=>{const N$=this.data.defaultFieldValue??"";T$.value=C$.userValue=N$,C$.formattedValue=null});let Y$=P$=>{const{formattedValue:N$}=C$;N$!=null&&(P$.target.value=N$),P$.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){T$.addEventListener("focus",N$=>{if(C$.focused)return;const{target:H3}=N$;C$.userValue&&(H3.value=C$.userValue),C$.lastCommittedValue=H3.value,C$.commitKey=1,C$.focused=!0}),T$.addEventListener("updatefromsandbox",N$=>{this.showElementAndHideCanvas(N$.target);const H3={value(D7){C$.userValue=D7.detail.value??"",f$.setValue(l$,{value:C$.userValue.toString()}),D7.target.value=C$.userValue},formattedValue(D7){const{formattedValue:Tq}=D7.detail;C$.formattedValue=Tq,Tq!=null&&D7.target!==document.activeElement&&(D7.target.value=Tq),f$.setValue(l$,{formattedValue:Tq})},selRange(D7){D7.target.setSelectionRange(...D7.detail.selRange)},charLimit:D7=>{var Nq;const{charLimit:Tq}=D7.detail,{target:Cq}=D7;if(Tq===0){Cq.removeAttribute("maxLength");return}Cq.setAttribute("maxLength",Tq);let PK=C$.userValue;!PK||PK.length<=Tq||(PK=PK.slice(0,Tq),Cq.value=C$.userValue=PK,f$.setValue(l$,{value:PK}),(Nq=this.linkService.eventBus)==null||Nq.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l$,name:"Keystroke",value:PK,willCommit:!0,commitKey:1,selStart:Cq.selectionStart,selEnd:Cq.selectionEnd}}))}};this._dispatchEventFromSandbox(H3,N$)}),T$.addEventListener("keydown",N$=>{var Tq;C$.commitKey=1;let H3=-1;if(N$.key==="Escape"?H3=0:N$.key==="Enter"&&!this.data.multiLine?H3=2:N$.key==="Tab"&&(C$.commitKey=3),H3===-1)return;const{value:D7}=N$.target;C$.lastCommittedValue!==D7&&(C$.lastCommittedValue=D7,C$.userValue=D7,(Tq=this.linkService.eventBus)==null||Tq.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l$,name:"Keystroke",value:D7,willCommit:!0,commitKey:H3,selStart:N$.target.selectionStart,selEnd:N$.target.selectionEnd}}))});const P$=Y$;Y$=null,T$.addEventListener("blur",N$=>{var D7;if(!C$.focused||!N$.relatedTarget)return;C$.focused=!1;const{value:H3}=N$.target;C$.userValue=H3,C$.lastCommittedValue!==H3&&((D7=this.linkService.eventBus)==null||D7.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l$,name:"Keystroke",value:H3,willCommit:!0,commitKey:C$.commitKey,selStart:N$.target.selectionStart,selEnd:N$.target.selectionEnd}})),P$(N$)}),(Q$=this.data.actions)!=null&&Q$.Keystroke&&T$.addEventListener("beforeinput",N$=>{var yK;C$.lastCommittedValue=null;const{data:H3,target:D7}=N$,{value:Tq,selectionStart:Cq,selectionEnd:PK}=D7;let Nq=Cq,DK=PK;switch(N$.inputType){case"deleteWordBackward":{const hee=Tq.substring(0,Cq).match(/\w*[^\w]*$/);hee&&(Nq-=hee[0].length);break}case"deleteWordForward":{const hee=Tq.substring(Cq).match(/^[^\w]*\w*/);hee&&(DK+=hee[0].length);break}case"deleteContentBackward":Cq===PK&&(Nq-=1);break;case"deleteContentForward":Cq===PK&&(DK+=1);break}N$.preventDefault(),(yK=this.linkService.eventBus)==null||yK.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l$,name:"Keystroke",value:Tq,change:H3||"",willCommit:!1,selStart:Nq,selEnd:DK}})}),this._setEventListeners(T$,C$,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],N$=>N$.target.value)}if(Y$&&T$.addEventListener("blur",Y$),this.data.comb){const N$=(this.data.rect[2]-this.data.rect[0])/Pq;T$.classList.add("comb"),T$.style.letterSpacing=`calc(${N$}px * var(--scale-factor) - 1ch)`}}else T$=document.createElement("div"),T$.textContent=this.data.fieldValue,T$.style.verticalAlign="middle",T$.style.display="table-cell";return this._setTextStyle(T$),this._setBackgroundColor(T$),this._setDefaultPropertiesFromJS(T$),this.container.append(T$),this.container}}class rn extends Nr{constructor(f$){super(f$,{isRenderable:!!f$.data.hasOwnCanvas})}}class Tn extends Nr{constructor(f$){super(f$,{isRenderable:f$.renderForms})}render(){const f$=this.annotationStorage,l$=this.data,T$=l$.id;let q$=f$.getValue(T$,{value:l$.exportValue===l$.fieldValue}).value;typeof q$=="string"&&(q$=q$!=="Off",f$.setValue(T$,{value:q$})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Q$=document.createElement("input");return Gt.add(Q$),Q$.setAttribute("data-element-id",T$),Q$.disabled=l$.readOnly,this._setRequired(Q$,this.data.required),Q$.type="checkbox",Q$.name=l$.fieldName,q$&&Q$.setAttribute("checked",!0),Q$.setAttribute("exportValue",l$.exportValue),Q$.tabIndex=Nt,Q$.addEventListener("change",gR=>{const{name:kI,checked:Pq}=gR.target;for(const s$ of this._getElementsByName(kI,T$)){const C$=Pq&&s$.exportValue===l$.exportValue;s$.domElement&&(s$.domElement.checked=C$),f$.setValue(s$.id,{value:C$})}f$.setValue(T$,{value:Pq})}),Q$.addEventListener("resetform",gR=>{const kI=l$.defaultFieldValue||"Off";gR.target.checked=kI===l$.exportValue}),this.enableScripting&&this.hasJSActions&&(Q$.addEventListener("updatefromsandbox",gR=>{const kI={value(Pq){Pq.target.checked=Pq.detail.value!=="Off",f$.setValue(T$,{value:Pq.target.checked})}};this._dispatchEventFromSandbox(kI,gR)}),this._setEventListeners(Q$,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],gR=>gR.target.checked)),this._setBackgroundColor(Q$),this._setDefaultPropertiesFromJS(Q$),this.container.append(Q$),this.container}}class $n extends Nr{constructor(f$){super(f$,{isRenderable:f$.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const f$=this.annotationStorage,l$=this.data,T$=l$.id;let q$=f$.getValue(T$,{value:l$.fieldValue===l$.buttonValue}).value;typeof q$=="string"&&(q$=q$!==l$.buttonValue,f$.setValue(T$,{value:q$}));const Q$=document.createElement("input");if(Gt.add(Q$),Q$.setAttribute("data-element-id",T$),Q$.disabled=l$.readOnly,this._setRequired(Q$,this.data.required),Q$.type="radio",Q$.name=l$.fieldName,q$&&Q$.setAttribute("checked",!0),Q$.tabIndex=Nt,Q$.addEventListener("change",gR=>{const{name:kI,checked:Pq}=gR.target;for(const s$ of this._getElementsByName(kI,T$))f$.setValue(s$.id,{value:!1});f$.setValue(T$,{value:Pq})}),Q$.addEventListener("resetform",gR=>{const kI=l$.defaultFieldValue;gR.target.checked=kI!=null&&kI===l$.buttonValue}),this.enableScripting&&this.hasJSActions){const gR=l$.buttonValue;Q$.addEventListener("updatefromsandbox",kI=>{const Pq={value:s$=>{const C$=gR===s$.detail.value;for(const Y$ of this._getElementsByName(s$.target.name)){const P$=C$&&Y$.id===T$;Y$.domElement&&(Y$.domElement.checked=P$),f$.setValue(Y$.id,{value:P$})}}};this._dispatchEventFromSandbox(Pq,kI)}),this._setEventListeners(Q$,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],kI=>kI.target.checked)}return this._setBackgroundColor(Q$),this._setDefaultPropertiesFromJS(Q$),this.container.append(Q$),this.container}}class un extends zr{constructor(f$){super(f$,{ignoreBorder:f$.data.hasAppearance})}render(){const f$=super.render();f$.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(f$.title=this.data.alternativeText);const l$=f$.lastChild;return this.enableScripting&&this.hasJSActions&&l$&&(this._setDefaultPropertiesFromJS(l$),l$.addEventListener("updatefromsandbox",T$=>{this._dispatchEventFromSandbox({},T$)})),f$}}class es extends Nr{constructor(f$){super(f$,{isRenderable:f$.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const f$=this.annotationStorage,l$=this.data.id,T$=f$.getValue(l$,{value:this.data.fieldValue}),q$=document.createElement("select");Gt.add(q$),q$.setAttribute("data-element-id",l$),q$.disabled=this.data.readOnly,this._setRequired(q$,this.data.required),q$.name=this.data.fieldName,q$.tabIndex=Nt;let Q$=this.data.combo&&this.data.options.length>0;this.data.combo||(q$.size=this.data.options.length,this.data.multiSelect&&(q$.multiple=!0)),q$.addEventListener("resetform",C$=>{const Y$=this.data.defaultFieldValue;for(const P$ of q$.options)P$.selected=P$.value===Y$});for(const C$ of this.data.options){const Y$=document.createElement("option");Y$.textContent=C$.displayValue,Y$.value=C$.exportValue,T$.value.includes(C$.exportValue)&&(Y$.setAttribute("selected",!0),Q$=!1),q$.append(Y$)}let gR=null;if(Q$){const C$=document.createElement("option");C$.value=" ",C$.setAttribute("hidden",!0),C$.setAttribute("selected",!0),q$.prepend(C$),gR=()=>{C$.remove(),q$.removeEventListener("input",gR),gR=null},q$.addEventListener("input",gR)}const kI=C$=>{const Y$=C$?"value":"textContent",{options:P$,multiple:N$}=q$;return N$?Array.prototype.filter.call(P$,H3=>H3.selected).map(H3=>H3[Y$]):P$.selectedIndex===-1?null:P$[P$.selectedIndex][Y$]};let Pq=kI(!1);const s$=C$=>{const Y$=C$.target.options;return Array.prototype.map.call(Y$,P$=>({displayValue:P$.textContent,exportValue:P$.value}))};return this.enableScripting&&this.hasJSActions?(q$.addEventListener("updatefromsandbox",C$=>{const Y$={value(P$){gR==null||gR();const N$=P$.detail.value,H3=new Set(Array.isArray(N$)?N$:[N$]);for(const D7 of q$.options)D7.selected=H3.has(D7.value);f$.setValue(l$,{value:kI(!0)}),Pq=kI(!1)},multipleSelection(P$){q$.multiple=!0},remove(P$){const N$=q$.options,H3=P$.detail.remove;N$[H3].selected=!1,q$.remove(H3),N$.length>0&&Array.prototype.findIndex.call(N$,Tq=>Tq.selected)===-1&&(N$[0].selected=!0),f$.setValue(l$,{value:kI(!0),items:s$(P$)}),Pq=kI(!1)},clear(P$){for(;q$.length!==0;)q$.remove(0);f$.setValue(l$,{value:null,items:[]}),Pq=kI(!1)},insert(P$){const{index:N$,displayValue:H3,exportValue:D7}=P$.detail.insert,Tq=q$.children[N$],Cq=document.createElement("option");Cq.textContent=H3,Cq.value=D7,Tq?Tq.before(Cq):q$.append(Cq),f$.setValue(l$,{value:kI(!0),items:s$(P$)}),Pq=kI(!1)},items(P$){const{items:N$}=P$.detail;for(;q$.length!==0;)q$.remove(0);for(const H3 of N$){const{displayValue:D7,exportValue:Tq}=H3,Cq=document.createElement("option");Cq.textContent=D7,Cq.value=Tq,q$.append(Cq)}q$.options.length>0&&(q$.options[0].selected=!0),f$.setValue(l$,{value:kI(!0),items:s$(P$)}),Pq=kI(!1)},indices(P$){const N$=new Set(P$.detail.indices);for(const H3 of P$.target.options)H3.selected=N$.has(H3.index);f$.setValue(l$,{value:kI(!0)}),Pq=kI(!1)},editable(P$){P$.target.disabled=!P$.detail.editable}};this._dispatchEventFromSandbox(Y$,C$)}),q$.addEventListener("input",C$=>{var P$;const Y$=kI(!0);f$.setValue(l$,{value:Y$}),C$.preventDefault(),(P$=this.linkService.eventBus)==null||P$.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l$,name:"Keystroke",value:Pq,changeEx:Y$,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(q$,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],C$=>C$.target.value)):q$.addEventListener("input",function(C$){f$.setValue(l$,{value:kI(!0)})}),this.data.combo&&this._setTextStyle(q$),this._setBackgroundColor(q$),this._setDefaultPropertiesFromJS(q$),this.container.append(q$),this.container}}class kn extends Tr{constructor(f$){const{data:l$,elements:T$}=f$;super(f$,{isRenderable:Tr._hasPopupData(l$)}),this.elements=T$}render(){this.container.classList.add("popupAnnotation");const f$=new ts({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),l$=[];for(const T$ of this.elements)T$.popup=f$,l$.push(T$.data.id),T$.addHighlightArea();return this.container.setAttribute("aria-controls",l$.map(T$=>`${gt.AnnotationPrefix}${T$}`).join(",")),this.container}}class ts{constructor({container:f$,color:l$,elements:T$,titleObj:q$,modificationDate:Q$,contentsObj:gR,richText:kI,parent:Pq,rect:s$,parentRect:C$,open:Y$}){G$(this,F$);G$(this,o$,null);G$(this,h$,L$(this,F$,lre).bind(this));G$(this,d$,L$(this,F$,xie).bind(this));G$(this,y$,L$(this,F$,yie).bind(this));G$(this,R$,L$(this,F$,Dte).bind(this));G$(this,M$,null);G$(this,x$,null);G$(this,v$,null);G$(this,rS,null);G$(this,wA,null);G$(this,g$,null);G$(this,S$,!1);G$(this,tA,null);G$(this,tS,null);G$(this,m$,null);G$(this,u$,null);G$(this,UE,!1);var N$;K$(this,x$,f$),K$(this,u$,q$),K$(this,v$,gR),K$(this,m$,kI),K$(this,wA,Pq),K$(this,M$,l$),K$(this,tS,s$),K$(this,g$,C$),K$(this,rS,T$);const P$=_t.PDFDateString.toDateObject(Q$);P$&&K$(this,o$,Pq.l10n.get("annotation_date_string",{date:P$.toLocaleDateString(),time:P$.toLocaleTimeString()})),this.trigger=T$.flatMap(H3=>H3.getElementsToTriggerPopup());for(const H3 of this.trigger)H3.addEventListener("click",Sv(this,R$)),H3.addEventListener("mouseenter",Sv(this,y$)),H3.addEventListener("mouseleave",Sv(this,d$)),H3.classList.add("popupTriggerArea");for(const H3 of T$)(N$=H3.container)==null||N$.addEventListener("keydown",Sv(this,h$));Sv(this,x$).hidden=!0,Y$&&L$(this,F$,Dte).call(this)}render(){if(Sv(this,tA))return;const{page:{view:f$},viewport:{rawDims:{pageWidth:l$,pageHeight:T$,pageX:q$,pageY:Q$}}}=Sv(this,wA),gR=K$(this,tA,document.createElement("div"));if(gR.className="popup",Sv(this,M$)){const Nq=gR.style.outlineColor=gt.Util.makeHexColor(...Sv(this,M$));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?gR.style.backgroundColor=`color-mix(in srgb, ${Nq} 30%, white)`:gR.style.backgroundColor=gt.Util.makeHexColor(...Sv(this,M$).map(yK=>Math.floor(.7*(255-yK)+yK)))}const kI=document.createElement("span");kI.className="header";const Pq=document.createElement("h1");if(kI.append(Pq),{dir:Pq.dir,str:Pq.textContent}=Sv(this,u$),gR.append(kI),Sv(this,o$)){const Nq=document.createElement("span");Nq.classList.add("popupDate"),Sv(this,o$).then(DK=>{Nq.textContent=DK}),kI.append(Nq)}const s$=Sv(this,v$),C$=Sv(this,m$);if(C$!=null&&C$.str&&(!(s$!=null&&s$.str)||s$.str===C$.str))Ft.XfaLayer.render({xfaHtml:C$.html,intent:"richText",div:gR}),gR.lastChild.classList.add("richText","popupContent");else{const Nq=this._formatContents(s$);gR.append(Nq)}let Y$=!!Sv(this,g$),P$=Y$?Sv(this,g$):Sv(this,tS);for(const Nq of Sv(this,rS))if(!P$||gt.Util.intersect(Nq.data.rect,P$)!==null){P$=Nq.data.rect,Y$=!0;break}const N$=gt.Util.normalizeRect([P$[0],f$[3]-P$[1]+f$[1],P$[2],f$[3]-P$[3]+f$[1]]),D7=Y$?P$[2]-P$[0]+5:0,Tq=N$[0]+D7,Cq=N$[1],{style:PK}=Sv(this,x$);PK.left=`${100*(Tq-q$)/l$}%`,PK.top=`${100*(Cq-Q$)/T$}%`,Sv(this,x$).append(gR)}_formatContents({str:f$,dir:l$}){const T$=document.createElement("p");T$.classList.add("popupContent"),T$.dir=l$;const q$=f$.split(/(?:\r\n?|\n)/);for(let Q$=0,gR=q$.length;Q$<gR;++Q$){const kI=q$[Q$];T$.append(document.createTextNode(kI)),Q$<gR-1&&T$.append(document.createElement("br"))}return T$}forceHide(){K$(this,UE,this.isVisible),Sv(this,UE)&&(Sv(this,x$).hidden=!0)}maybeShow(){Sv(this,UE)&&(K$(this,UE,!1),Sv(this,x$).hidden=!1)}get isVisible(){return Sv(this,x$).hidden===!1}}o$=new WeakMap,h$=new WeakMap,d$=new WeakMap,y$=new WeakMap,R$=new WeakMap,M$=new WeakMap,x$=new WeakMap,v$=new WeakMap,rS=new WeakMap,wA=new WeakMap,g$=new WeakMap,S$=new WeakMap,tA=new WeakMap,tS=new WeakMap,m$=new WeakMap,u$=new WeakMap,UE=new WeakMap,F$=new WeakSet,lre=function(f$){f$.altKey||f$.shiftKey||f$.ctrlKey||f$.metaKey||(f$.key==="Enter"||f$.key==="Escape"&&Sv(this,S$))&&L$(this,F$,Dte).call(this)},Dte=function(){K$(this,S$,!Sv(this,S$)),Sv(this,S$)?(L$(this,F$,yie).call(this),Sv(this,x$).addEventListener("click",Sv(this,R$)),Sv(this,x$).addEventListener("keydown",Sv(this,h$))):(L$(this,F$,xie).call(this),Sv(this,x$).removeEventListener("click",Sv(this,R$)),Sv(this,x$).removeEventListener("keydown",Sv(this,h$)))},yie=function(){Sv(this,tA)||this.render(),this.isVisible?Sv(this,S$)&&Sv(this,x$).classList.add("focused"):(Sv(this,x$).hidden=!1,Sv(this,x$).style.zIndex=parseInt(Sv(this,x$).style.zIndex)+1e3)},xie=function(){Sv(this,x$).classList.remove("focused"),!(Sv(this,S$)||!this.isVisible)&&(Sv(this,x$).hidden=!0,Sv(this,x$).style.zIndex=parseInt(Sv(this,x$).style.zIndex)-1e3)};class Ko extends Tr{constructor(f$){super(f$,{isRenderable:!0,ignoreBorder:!0}),this.textContent=f$.data.textContent,this.textPosition=f$.data.textPosition,this.annotationEditorType=gt.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const f$=document.createElement("div");f$.classList.add("annotationTextContent"),f$.setAttribute("role","comment");for(const l$ of this.textContent){const T$=document.createElement("span");T$.textContent=l$,f$.append(T$)}this.container.append(f$)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}st.FreeTextAnnotationElement=Ko;class ds extends Tr{constructor(l$){super(l$,{isRenderable:!0,ignoreBorder:!0});G$(this,gD,null)}render(){this.container.classList.add("lineAnnotation");const l$=this.data,{width:T$,height:q$}=dr(l$.rect),Q$=this.svgFactory.create(T$,q$,!0),gR=K$(this,gD,this.svgFactory.createElement("svg:line"));return gR.setAttribute("x1",l$.rect[2]-l$.lineCoordinates[0]),gR.setAttribute("y1",l$.rect[3]-l$.lineCoordinates[1]),gR.setAttribute("x2",l$.rect[2]-l$.lineCoordinates[2]),gR.setAttribute("y2",l$.rect[3]-l$.lineCoordinates[3]),gR.setAttribute("stroke-width",l$.borderStyle.width||1),gR.setAttribute("stroke","transparent"),gR.setAttribute("fill","transparent"),Q$.append(gR),this.container.append(Q$),!l$.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Sv(this,gD)}addHighlightArea(){this.container.classList.add("highlightArea")}}gD=new WeakMap;class Il extends Tr{constructor(l$){super(l$,{isRenderable:!0,ignoreBorder:!0});G$(this,fL,null)}render(){this.container.classList.add("squareAnnotation");const l$=this.data,{width:T$,height:q$}=dr(l$.rect),Q$=this.svgFactory.create(T$,q$,!0),gR=l$.borderStyle.width,kI=K$(this,fL,this.svgFactory.createElement("svg:rect"));return kI.setAttribute("x",gR/2),kI.setAttribute("y",gR/2),kI.setAttribute("width",T$-gR),kI.setAttribute("height",q$-gR),kI.setAttribute("stroke-width",gR||1),kI.setAttribute("stroke","transparent"),kI.setAttribute("fill","transparent"),Q$.append(kI),this.container.append(Q$),!l$.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Sv(this,fL)}addHighlightArea(){this.container.classList.add("highlightArea")}}fL=new WeakMap;class ru extends Tr{constructor(l$){super(l$,{isRenderable:!0,ignoreBorder:!0});G$(this,I7,null)}render(){this.container.classList.add("circleAnnotation");const l$=this.data,{width:T$,height:q$}=dr(l$.rect),Q$=this.svgFactory.create(T$,q$,!0),gR=l$.borderStyle.width,kI=K$(this,I7,this.svgFactory.createElement("svg:ellipse"));return kI.setAttribute("cx",T$/2),kI.setAttribute("cy",q$/2),kI.setAttribute("rx",T$/2-gR/2),kI.setAttribute("ry",q$/2-gR/2),kI.setAttribute("stroke-width",gR||1),kI.setAttribute("stroke","transparent"),kI.setAttribute("fill","transparent"),Q$.append(kI),this.container.append(Q$),!l$.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Sv(this,I7)}addHighlightArea(){this.container.classList.add("highlightArea")}}I7=new WeakMap;class uu extends Tr{constructor(l$){super(l$,{isRenderable:!0,ignoreBorder:!0});G$(this,j$,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const l$=this.data,{width:T$,height:q$}=dr(l$.rect),Q$=this.svgFactory.create(T$,q$,!0);let gR=[];for(const Pq of l$.vertices){const s$=Pq.x-l$.rect[0],C$=l$.rect[3]-Pq.y;gR.push(s$+","+C$)}gR=gR.join(" ");const kI=K$(this,j$,this.svgFactory.createElement(this.svgElementName));return kI.setAttribute("points",gR),kI.setAttribute("stroke-width",l$.borderStyle.width||1),kI.setAttribute("stroke","transparent"),kI.setAttribute("fill","transparent"),Q$.append(kI),this.container.append(Q$),!l$.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Sv(this,j$)}addHighlightArea(){this.container.classList.add("highlightArea")}}j$=new WeakMap;class p0 extends uu{constructor(f$){super(f$),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class X1 extends Tr{constructor(f$){super(f$,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class q0 extends Tr{constructor(l$){super(l$,{isRenderable:!0,ignoreBorder:!0});G$(this,_$,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=gt.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const l$=this.data,{width:T$,height:q$}=dr(l$.rect),Q$=this.svgFactory.create(T$,q$,!0);for(const gR of l$.inkLists){let kI=[];for(const s$ of gR){const C$=s$.x-l$.rect[0],Y$=l$.rect[3]-s$.y;kI.push(`${C$},${Y$}`)}kI=kI.join(" ");const Pq=this.svgFactory.createElement(this.svgElementName);Sv(this,_$).push(Pq),Pq.setAttribute("points",kI),Pq.setAttribute("stroke-width",l$.borderStyle.width||1),Pq.setAttribute("stroke","transparent"),Pq.setAttribute("fill","transparent"),!l$.popupRef&&this.hasPopupData&&this._createPopup(),Q$.append(Pq)}return this.container.append(Q$),this.container}getElementsToTriggerPopup(){return Sv(this,_$)}addHighlightArea(){this.container.classList.add("highlightArea")}}_$=new WeakMap,st.InkAnnotationElement=q0;class W0 extends Tr{constructor(f$){super(f$,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class hu extends Tr{constructor(f$){super(f$,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class a1 extends Tr{constructor(f$){super(f$,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Vx extends Tr{constructor(f$){super(f$,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class t0 extends Tr{constructor(f$){super(f$,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}st.StampAnnotationElement=t0;class cu extends Tr{constructor(l$){var Q$;super(l$,{isRenderable:!0});G$(this,GL);G$(this,I$,null);const{filename:T$,content:q$}=this.data.file;this.filename=(0,_t.getFilenameFromUrl)(T$,!0),this.content=q$,(Q$=this.linkService.eventBus)==null||Q$.dispatch("fileattachmentannotation",{source:this,filename:T$,content:q$})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:l$,data:T$}=this;let q$;T$.hasAppearance||T$.fillAlpha===0?q$=document.createElement("div"):(q$=document.createElement("img"),q$.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(T$.name)?"paperclip":"pushpin"}.svg`,T$.fillAlpha&&T$.fillAlpha<1&&(q$.style=`filter: opacity(${Math.round(T$.fillAlpha*100)}%);`)),q$.addEventListener("dblclick",L$(this,GL,bie).bind(this)),K$(this,I$,q$);const{isMac:Q$}=gt.FeatureTest.platform;return l$.addEventListener("keydown",gR=>{gR.key==="Enter"&&(Q$?gR.metaKey:gR.ctrlKey)&&L$(this,GL,bie).call(this)}),!T$.popupRef&&this.hasPopupData?this._createPopup():q$.classList.add("popupTriggerArea"),l$.append(q$),l$}getElementsToTriggerPopup(){return Sv(this,I$)}addHighlightArea(){this.container.classList.add("highlightArea")}}I$=new WeakMap,GL=new WeakSet,bie=function(){var l$;(l$=this.downloadManager)==null||l$.openOrDownloadData(this.container,this.content,this.filename)};class lu{constructor({div:f$,accessibilityManager:l$,annotationCanvasMap:T$,l10n:q$,page:Q$,viewport:gR}){G$(this,Z$);G$(this,B$,null);G$(this,r$,null);G$(this,O$,new Map);this.div=f$,K$(this,B$,l$),K$(this,r$,T$),this.l10n=q$,this.page=Q$,this.viewport=gR,this.zIndex=0,this.l10n||(this.l10n=Rt.NullL10n)}async render(f$){const{annotations:l$}=f$,T$=this.div;(0,_t.setLayerDimensions)(T$,this.viewport);const q$=new Map,Q$={data:null,layer:T$,linkService:f$.linkService,downloadManager:f$.downloadManager,imageResourcesPath:f$.imageResourcesPath||"",renderForms:f$.renderForms!==!1,svgFactory:new _t.DOMSVGFactory,annotationStorage:f$.annotationStorage||new Et.AnnotationStorage,enableScripting:f$.enableScripting===!0,hasJSActions:f$.hasJSActions,fieldObjects:f$.fieldObjects,parent:this,elements:null};for(const gR of l$){if(gR.noHTML)continue;const kI=gR.annotationType===gt.AnnotationType.POPUP;if(kI){const C$=q$.get(gR.id);if(!C$)continue;Q$.elements=C$}else{const{width:C$,height:Y$}=dr(gR.rect);if(C$<=0||Y$<=0)continue}Q$.data=gR;const Pq=Mr.create(Q$);if(!Pq.isRenderable)continue;if(!kI&&gR.popupRef){const C$=q$.get(gR.popupRef);C$?C$.push(Pq):q$.set(gR.popupRef,[Pq])}Pq.annotationEditorType>0&&Sv(this,O$).set(Pq.data.id,Pq);const s$=Pq.render();gR.hidden&&(s$.style.visibility="hidden"),L$(this,Z$,cre).call(this,s$,gR.id)}L$(this,Z$,wie).call(this),await this.l10n.translate(T$)}update({viewport:f$}){const l$=this.div;this.viewport=f$,(0,_t.setLayerDimensions)(l$,{rotation:f$.rotation}),L$(this,Z$,wie).call(this),l$.hidden=!1}getEditableAnnotations(){return Array.from(Sv(this,O$).values())}getEditableAnnotation(f$){return Sv(this,O$).get(f$)}}B$=new WeakMap,r$=new WeakMap,O$=new WeakMap,Z$=new WeakSet,cre=function(f$,l$){var q$;const T$=f$.firstChild||f$;T$.id=`${gt.AnnotationPrefix}${l$}`,this.div.append(f$),(q$=Sv(this,B$))==null||q$.moveElementInDOM(this.div,f$,T$,!1)},wie=function(){if(!Sv(this,r$))return;const f$=this.div;for(const[l$,T$]of Sv(this,r$)){const q$=f$.querySelector(`[data-annotation-id="${l$}"]`);if(!q$)continue;const{firstChild:Q$}=q$;Q$?Q$.nodeName==="CANVAS"?Q$.replaceWith(T$):Q$.before(T$):q$.append(T$)}Sv(this,r$).clear()},st.AnnotationLayer=lu},(nt,st)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.ColorConverters=void 0;function mt(Et){return Math.floor(Math.max(0,Math.min(1,Et))*255).toString(16).padStart(2,"0")}function gt(Et){return Math.max(0,Math.min(255,255*Et))}class _t{static CMYK_G([At,Rt,Ft,Nt]){return["G",1-Math.min(1,.3*At+.59*Ft+.11*Rt+Nt)]}static G_CMYK([At]){return["CMYK",0,0,0,1-At]}static G_RGB([At]){return["RGB",At,At,At]}static G_rgb([At]){return At=gt(At),[At,At,At]}static G_HTML([At]){const Rt=mt(At);return`#${Rt}${Rt}${Rt}`}static RGB_G([At,Rt,Ft]){return["G",.3*At+.59*Rt+.11*Ft]}static RGB_rgb(At){return At.map(gt)}static RGB_HTML(At){return`#${At.map(mt).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([At,Rt,Ft,Nt]){return["RGB",1-Math.min(1,At+Nt),1-Math.min(1,Ft+Nt),1-Math.min(1,Rt+Nt)]}static CMYK_rgb([At,Rt,Ft,Nt]){return[gt(1-Math.min(1,At+Nt)),gt(1-Math.min(1,Ft+Nt)),gt(1-Math.min(1,Rt+Nt))]}static CMYK_HTML(At){const Rt=this.CMYK_RGB(At).slice(1);return this.RGB_HTML(Rt)}static RGB_CMYK([At,Rt,Ft]){const Nt=1-At,Bt=1-Rt,Gt=1-Ft,dr=Math.min(Nt,Bt,Gt);return["CMYK",Nt,Bt,Gt,dr]}}st.ColorConverters=_t},(nt,st)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.NullL10n=void 0,st.getL10nFallback=gt;const mt={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};mt.print_progress_percent="{{progress}}%";function gt(At,Rt){switch(At){case"find_match_count":At=`find_match_count[${Rt.total===1?"one":"other"}]`;break;case"find_match_count_limit":At=`find_match_count_limit[${Rt.limit===1?"one":"other"}]`;break}return mt[At]||""}function _t(At,Rt){return Rt?At.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(Ft,Nt)=>Nt in Rt?Rt[Nt]:"{{"+Nt+"}}"):At}const Et={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(At,Rt=null,Ft=gt(At,Rt)){return _t(Ft,Rt)},async translate(At){}};st.NullL10n=Et},(nt,st,mt)=>{Object.defineProperty(st,"__esModule",{value:!0}),st.XfaLayer=void 0;var gt=mt(25);class _t{static setupStorage(At,Rt,Ft,Nt,Bt){const Gt=Nt.getValue(Rt,{value:null});switch(Ft.name){case"textarea":if(Gt.value!==null&&(At.textContent=Gt.value),Bt==="print")break;At.addEventListener("input",dr=>{Nt.setValue(Rt,{value:dr.target.value})});break;case"input":if(Ft.attributes.type==="radio"||Ft.attributes.type==="checkbox"){if(Gt.value===Ft.attributes.xfaOn?At.setAttribute("checked",!0):Gt.value===Ft.attributes.xfaOff&&At.removeAttribute("checked"),Bt==="print")break;At.addEventListener("change",dr=>{Nt.setValue(Rt,{value:dr.target.checked?dr.target.getAttribute("xfaOn"):dr.target.getAttribute("xfaOff")})})}else{if(Gt.value!==null&&At.setAttribute("value",Gt.value),Bt==="print")break;At.addEventListener("input",dr=>{Nt.setValue(Rt,{value:dr.target.value})})}break;case"select":if(Gt.value!==null){At.setAttribute("value",Gt.value);for(const dr of Ft.children)dr.attributes.value===Gt.value?dr.attributes.selected=!0:dr.attributes.hasOwnProperty("selected")&&delete dr.attributes.selected}At.addEventListener("input",dr=>{const Mr=dr.target.options,Tr=Mr.selectedIndex===-1?"":Mr[Mr.selectedIndex].value;Nt.setValue(Rt,{value:Tr})});break}}static setAttributes({html:At,element:Rt,storage:Ft=null,intent:Nt,linkService:Bt}){const{attributes:Gt}=Rt,dr=At instanceof HTMLAnchorElement;Gt.type==="radio"&&(Gt.name=`${Gt.name}-${Nt}`);for(const[Mr,Tr]of Object.entries(Gt))if(Tr!=null)switch(Mr){case"class":Tr.length&&At.setAttribute(Mr,Tr.join(" "));break;case"dataId":break;case"id":At.setAttribute("data-element-id",Tr);break;case"style":Object.assign(At.style,Tr);break;case"textContent":At.textContent=Tr;break;default:(!dr||Mr!=="href"&&Mr!=="newWindow")&&At.setAttribute(Mr,Tr)}dr&&Bt.addLinkAttributes(At,Gt.href,Gt.newWindow),Ft&&Gt.dataId&&this.setupStorage(At,Gt.dataId,Rt,Ft)}static render(At){var zr;const Rt=At.annotationStorage,Ft=At.linkService,Nt=At.xfaHtml,Bt=At.intent||"display",Gt=document.createElement(Nt.name);Nt.attributes&&this.setAttributes({html:Gt,element:Nt,intent:Bt,linkService:Ft});const dr=[[Nt,-1,Gt]],Mr=At.div;if(Mr.append(Gt),At.viewport){const Fr=`matrix(${At.viewport.transform.join(",")})`;Mr.style.transform=Fr}Bt!=="richText"&&Mr.setAttribute("class","xfaLayer xfaFont");const Tr=[];for(;dr.length>0;){const[Fr,Nr,tn]=dr.at(-1);if(Nr+1===Fr.children.length){dr.pop();continue}const rn=Fr.children[++dr.at(-1)[1]];if(rn===null)continue;const{name:Tn}=rn;if(Tn==="#text"){const un=document.createTextNode(rn.value);Tr.push(un),tn.append(un);continue}const $n=(zr=rn==null?void 0:rn.attributes)!=null&&zr.xmlns?document.createElementNS(rn.attributes.xmlns,Tn):document.createElement(Tn);if(tn.append($n),rn.attributes&&this.setAttributes({html:$n,element:rn,storage:Rt,intent:Bt,linkService:Ft}),rn.children&&rn.children.length>0)dr.push([rn,-1,$n]);else if(rn.value){const un=document.createTextNode(rn.value);gt.XfaText.shouldBuildText(Tn)&&Tr.push(un),$n.append(un)}}for(const Fr of Mr.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))Fr.setAttribute("readOnly",!0);return{textDivs:Tr}}static update(At){const Rt=`matrix(${At.viewport.transform.join(",")})`;At.div.style.transform=Rt,At.div.hidden=!1}}st.XfaLayer=_t},(nt,st,mt)=>{var Nt,Bt,Gt,dr,Mr,Tr,zr,Fr,Nr,tn,rn,Tn,$n,un,es,ure,hre,dre,pre,Sie,fre,_ie,mre,gre,vre,yre,xre,Uee,Eie,Rte,Ite,ste,Aie,Ote,LE,bre,Cie,wre,Sre,Mie,kte,ote;Object.defineProperty(st,"__esModule",{value:!0}),st.InkEditor=void 0;var gt=mt(1),_t=mt(4),Et=mt(29),At=mt(6),Rt=mt(5);const M$=class M$ extends _t.AnnotationEditor{constructor(rS){super({...rS,name:"inkEditor"});G$(this,es);G$(this,Nt,0);G$(this,Bt,0);G$(this,Gt,this.canvasPointermove.bind(this));G$(this,dr,this.canvasPointerleave.bind(this));G$(this,Mr,this.canvasPointerup.bind(this));G$(this,Tr,this.canvasPointerdown.bind(this));G$(this,zr,new Path2D);G$(this,Fr,!1);G$(this,Nr,!1);G$(this,tn,!1);G$(this,rn,null);G$(this,Tn,0);G$(this,$n,0);G$(this,un,null);this.color=rS.color||null,this.thickness=rS.thickness||null,this.opacity=rS.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(rS){_t.AnnotationEditor.initialize(rS,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(rS,wA){switch(rS){case gt.AnnotationEditorParamsType.INK_THICKNESS:M$._defaultThickness=wA;break;case gt.AnnotationEditorParamsType.INK_COLOR:M$._defaultColor=wA;break;case gt.AnnotationEditorParamsType.INK_OPACITY:M$._defaultOpacity=wA/100;break}}updateParams(rS,wA){switch(rS){case gt.AnnotationEditorParamsType.INK_THICKNESS:L$(this,es,ure).call(this,wA);break;case gt.AnnotationEditorParamsType.INK_COLOR:L$(this,es,hre).call(this,wA);break;case gt.AnnotationEditorParamsType.INK_OPACITY:L$(this,es,dre).call(this,wA);break}}static get defaultPropertiesToUpdate(){return[[gt.AnnotationEditorParamsType.INK_THICKNESS,M$._defaultThickness],[gt.AnnotationEditorParamsType.INK_COLOR,M$._defaultColor||_t.AnnotationEditor._defaultLineColor],[gt.AnnotationEditorParamsType.INK_OPACITY,Math.round(M$._defaultOpacity*100)]]}get propertiesToUpdate(){return[[gt.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||M$._defaultThickness],[gt.AnnotationEditorParamsType.INK_COLOR,this.color||M$._defaultColor||_t.AnnotationEditor._defaultLineColor],[gt.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??M$._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(L$(this,es,Rte).call(this),L$(this,es,Ite).call(this)),this.isAttachedToDOM||(this.parent.add(this),L$(this,es,ste).call(this)),L$(this,es,ote).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,Sv(this,rn).disconnect(),K$(this,rn,null),super.remove())}setParent(rS){!this.parent&&rS?this._uiManager.removeShouldRescale(this):this.parent&&rS===null&&this._uiManager.addShouldRescale(this),super.setParent(rS)}onScaleChanging(){const[rS,wA]=this.parentDimensions,g$=this.width*rS,S$=this.height*wA;this.setDimensions(g$,S$)}enableEditMode(){Sv(this,Fr)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",Sv(this,Tr)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",Sv(this,Tr)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){Sv(this,Fr)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),K$(this,Fr,!0),this.div.classList.add("disabled"),L$(this,es,ote).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(rS){this._focusEventsAllowed&&(super.focusin(rS),this.enableEditMode())}canvasPointerdown(rS){rS.button!==0||!this.isInEditMode()||Sv(this,Fr)||(this.setInForeground(),rS.preventDefault(),rS.type!=="mouse"&&this.div.focus(),L$(this,es,fre).call(this,rS.offsetX,rS.offsetY))}canvasPointermove(rS){rS.preventDefault(),L$(this,es,_ie).call(this,rS.offsetX,rS.offsetY)}canvasPointerup(rS){rS.preventDefault(),L$(this,es,Eie).call(this,rS)}canvasPointerleave(rS){L$(this,es,Eie).call(this,rS)}get isResizable(){return!this.isEmpty()&&Sv(this,Fr)}render(){if(this.div)return this.div;let rS,wA;this.width&&(rS=this.x,wA=this.y),super.render(),_t.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(m$=>{var u$;return(u$=this.div)==null?void 0:u$.setAttribute("aria-label",m$)});const[g$,S$,tA,tS]=L$(this,es,pre).call(this);if(this.setAt(g$,S$,0,0),this.setDims(tA,tS),L$(this,es,Rte).call(this),this.width){const[m$,u$]=this.parentDimensions;this.setAspectRatio(this.width*m$,this.height*u$),this.setAt(rS*m$,wA*u$,this.width*m$,this.height*u$),K$(this,tn,!0),L$(this,es,ste).call(this),this.setDims(this.width*m$,this.height*u$),L$(this,es,Uee).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return L$(this,es,Ite).call(this),this.div}setDimensions(rS,wA){const g$=Math.round(rS),S$=Math.round(wA);if(Sv(this,Tn)===g$&&Sv(this,$n)===S$)return;K$(this,Tn,g$),K$(this,$n,S$),this.canvas.style.visibility="hidden";const[tA,tS]=this.parentDimensions;this.width=rS/tA,this.height=wA/tS,this.fixAndSetPosition(),Sv(this,Fr)&&L$(this,es,Aie).call(this,rS,wA),L$(this,es,ste).call(this),L$(this,es,Uee).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(rS,wA,g$){var gD,fL,I7;if(rS instanceof Et.InkAnnotationElement)return null;const S$=super.deserialize(rS,wA,g$);S$.thickness=rS.thickness,S$.color=gt.Util.makeHexColor(...rS.color),S$.opacity=rS.opacity;const[tA,tS]=S$.pageDimensions,m$=S$.width*tA,u$=S$.height*tS,UE=S$.parentScale,F$=rS.thickness/2;K$(S$,Fr,!0),K$(S$,Tn,Math.round(m$)),K$(S$,$n,Math.round(u$));const{paths:EI,rect:pR,rotation:X$}=rS;for(let{bezier:j$}of EI){j$=L$(gD=M$,LE,wre).call(gD,j$,pR,X$);const _$=[];S$.paths.push(_$);let I$=UE*(j$[0]-F$),GL=UE*(j$[1]-F$);for(let B$=2,r$=j$.length;B$<r$;B$+=6){const O$=UE*(j$[B$]-F$),Z$=UE*(j$[B$+1]-F$),mL=UE*(j$[B$+2]-F$),P7=UE*(j$[B$+3]-F$),L9=UE*(j$[B$+4]-F$),f$=UE*(j$[B$+5]-F$);_$.push([[I$,GL],[O$,Z$],[mL,P7],[L9,f$]]),I$=L9,GL=f$}const w$=L$(this,LE,bre).call(this,_$);S$.bezierPath2D.push(w$)}const J$=L$(fL=S$,es,Mie).call(fL);return K$(S$,Bt,Math.max(_t.AnnotationEditor.MIN_SIZE,J$[2]-J$[0])),K$(S$,Nt,Math.max(_t.AnnotationEditor.MIN_SIZE,J$[3]-J$[1])),L$(I7=S$,es,Aie).call(I7,m$,u$),S$}serialize(){if(this.isEmpty())return null;const rS=this.getRect(0,0),wA=_t.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:gt.AnnotationEditorType.INK,color:wA,thickness:this.thickness,opacity:this.opacity,paths:L$(this,es,Sre).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,rS),pageIndex:this.pageIndex,rect:rS,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};Nt=new WeakMap,Bt=new WeakMap,Gt=new WeakMap,dr=new WeakMap,Mr=new WeakMap,Tr=new WeakMap,zr=new WeakMap,Fr=new WeakMap,Nr=new WeakMap,tn=new WeakMap,rn=new WeakMap,Tn=new WeakMap,$n=new WeakMap,un=new WeakMap,es=new WeakSet,ure=function(rS){const wA=this.thickness;this.addCommands({cmd:()=>{this.thickness=rS,L$(this,es,ote).call(this)},undo:()=>{this.thickness=wA,L$(this,es,ote).call(this)},mustExec:!0,type:gt.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},hre=function(rS){const wA=this.color;this.addCommands({cmd:()=>{this.color=rS,L$(this,es,Uee).call(this)},undo:()=>{this.color=wA,L$(this,es,Uee).call(this)},mustExec:!0,type:gt.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},dre=function(rS){rS/=100;const wA=this.opacity;this.addCommands({cmd:()=>{this.opacity=rS,L$(this,es,Uee).call(this)},undo:()=>{this.opacity=wA,L$(this,es,Uee).call(this)},mustExec:!0,type:gt.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},pre=function(){const{parentRotation:rS,parentDimensions:[wA,g$]}=this;switch(rS){case 90:return[0,g$,g$,wA];case 180:return[wA,g$,wA,g$];case 270:return[wA,0,g$,wA];default:return[0,0,wA,g$]}},Sie=function(){const{ctx:rS,color:wA,opacity:g$,thickness:S$,parentScale:tA,scaleFactor:tS}=this;rS.lineWidth=S$*tA/tS,rS.lineCap="round",rS.lineJoin="round",rS.miterLimit=10,rS.strokeStyle=`${wA}${(0,Rt.opacityToHex)(g$)}`},fre=function(rS,wA){this.canvas.addEventListener("contextmenu",At.noContextMenu),this.canvas.addEventListener("pointerleave",Sv(this,dr)),this.canvas.addEventListener("pointermove",Sv(this,Gt)),this.canvas.addEventListener("pointerup",Sv(this,Mr)),this.canvas.removeEventListener("pointerdown",Sv(this,Tr)),this.isEditing=!0,Sv(this,tn)||(K$(this,tn,!0),L$(this,es,ste).call(this),this.thickness||(this.thickness=M$._defaultThickness),this.color||(this.color=M$._defaultColor||_t.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=M$._defaultOpacity)),this.currentPath.push([rS,wA]),K$(this,Nr,!1),L$(this,es,Sie).call(this),K$(this,un,()=>{L$(this,es,vre).call(this),Sv(this,un)&&window.requestAnimationFrame(Sv(this,un))}),window.requestAnimationFrame(Sv(this,un))},_ie=function(rS,wA){const[g$,S$]=this.currentPath.at(-1);if(this.currentPath.length>1&&rS===g$&&wA===S$)return;const tA=this.currentPath;let tS=Sv(this,zr);if(tA.push([rS,wA]),K$(this,Nr,!0),tA.length<=2){tS.moveTo(...tA[0]),tS.lineTo(rS,wA);return}tA.length===3&&(K$(this,zr,tS=new Path2D),tS.moveTo(...tA[0])),L$(this,es,yre).call(this,tS,...tA.at(-3),...tA.at(-2),rS,wA)},mre=function(){if(this.currentPath.length===0)return;const rS=this.currentPath.at(-1);Sv(this,zr).lineTo(...rS)},gre=function(rS,wA){K$(this,un,null),rS=Math.min(Math.max(rS,0),this.canvas.width),wA=Math.min(Math.max(wA,0),this.canvas.height),L$(this,es,_ie).call(this,rS,wA),L$(this,es,mre).call(this);let g$;if(this.currentPath.length!==1)g$=L$(this,es,xre).call(this);else{const u$=[rS,wA];g$=[[u$,u$.slice(),u$.slice(),u$]]}const S$=Sv(this,zr),tA=this.currentPath;this.currentPath=[],K$(this,zr,new Path2D);const tS=()=>{this.allRawPaths.push(tA),this.paths.push(g$),this.bezierPath2D.push(S$),this.rebuild()},m$=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(L$(this,es,Rte).call(this),L$(this,es,Ite).call(this)),L$(this,es,ote).call(this))};this.addCommands({cmd:tS,undo:m$,mustExec:!0})},vre=function(){if(!Sv(this,Nr))return;K$(this,Nr,!1);const rS=Math.ceil(this.thickness*this.parentScale),wA=this.currentPath.slice(-3),g$=wA.map(tS=>tS[0]),S$=wA.map(tS=>tS[1]);Math.min(...g$)-rS,Math.max(...g$)+rS,Math.min(...S$)-rS,Math.max(...S$)+rS;const{ctx:tA}=this;tA.save(),tA.clearRect(0,0,this.canvas.width,this.canvas.height);for(const tS of this.bezierPath2D)tA.stroke(tS);tA.stroke(Sv(this,zr)),tA.restore()},yre=function(rS,wA,g$,S$,tA,tS,m$){const u$=(wA+S$)/2,UE=(g$+tA)/2,F$=(S$+tS)/2,EI=(tA+m$)/2;rS.bezierCurveTo(u$+2*(S$-u$)/3,UE+2*(tA-UE)/3,F$+2*(S$-F$)/3,EI+2*(tA-EI)/3,F$,EI)},xre=function(){const rS=this.currentPath;if(rS.length<=2)return[[rS[0],rS[0],rS.at(-1),rS.at(-1)]];const wA=[];let g$,[S$,tA]=rS[0];for(g$=1;g$<rS.length-2;g$++){const[pR,X$]=rS[g$],[J$,gD]=rS[g$+1],fL=(pR+J$)/2,I7=(X$+gD)/2,j$=[S$+2*(pR-S$)/3,tA+2*(X$-tA)/3],_$=[fL+2*(pR-fL)/3,I7+2*(X$-I7)/3];wA.push([[S$,tA],j$,_$,[fL,I7]]),[S$,tA]=[fL,I7]}const[tS,m$]=rS[g$],[u$,UE]=rS[g$+1],F$=[S$+2*(tS-S$)/3,tA+2*(m$-tA)/3],EI=[u$+2*(tS-u$)/3,UE+2*(m$-UE)/3];return wA.push([[S$,tA],F$,EI,[u$,UE]]),wA},Uee=function(){if(this.isEmpty()){L$(this,es,Ote).call(this);return}L$(this,es,Sie).call(this);const{canvas:rS,ctx:wA}=this;wA.setTransform(1,0,0,1,0,0),wA.clearRect(0,0,rS.width,rS.height),L$(this,es,Ote).call(this);for(const g$ of this.bezierPath2D)wA.stroke(g$)},Eie=function(rS){this.canvas.removeEventListener("pointerleave",Sv(this,dr)),this.canvas.removeEventListener("pointermove",Sv(this,Gt)),this.canvas.removeEventListener("pointerup",Sv(this,Mr)),this.canvas.addEventListener("pointerdown",Sv(this,Tr)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",At.noContextMenu)},10),L$(this,es,gre).call(this,rS.offsetX,rS.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Rte=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",_t.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(rS=>{var wA;return(wA=this.canvas)==null?void 0:wA.setAttribute("aria-label",rS)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Ite=function(){K$(this,rn,new ResizeObserver(rS=>{const wA=rS[0].contentRect;wA.width&&wA.height&&this.setDimensions(wA.width,wA.height)})),Sv(this,rn).observe(this.div)},ste=function(){if(!Sv(this,tn))return;const[rS,wA]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*rS),this.canvas.height=Math.ceil(this.height*wA),L$(this,es,Ote).call(this)},Aie=function(rS,wA){const g$=L$(this,es,kte).call(this),S$=(rS-g$)/Sv(this,Bt),tA=(wA-g$)/Sv(this,Nt);this.scaleFactor=Math.min(S$,tA)},Ote=function(){const rS=L$(this,es,kte).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+rS,this.translationY*this.scaleFactor+rS)},LE=new WeakSet,bre=function(rS){const wA=new Path2D;for(let g$=0,S$=rS.length;g$<S$;g$++){const[tA,tS,m$,u$]=rS[g$];g$===0&&wA.moveTo(...tA),wA.bezierCurveTo(tS[0],tS[1],m$[0],m$[1],u$[0],u$[1])}return wA},Cie=function(rS,wA,g$){const[S$,tA,tS,m$]=wA;switch(g$){case 0:for(let u$=0,UE=rS.length;u$<UE;u$+=2)rS[u$]+=S$,rS[u$+1]=m$-rS[u$+1];break;case 90:for(let u$=0,UE=rS.length;u$<UE;u$+=2){const F$=rS[u$];rS[u$]=rS[u$+1]+S$,rS[u$+1]=F$+tA}break;case 180:for(let u$=0,UE=rS.length;u$<UE;u$+=2)rS[u$]=tS-rS[u$],rS[u$+1]+=tA;break;case 270:for(let u$=0,UE=rS.length;u$<UE;u$+=2){const F$=rS[u$];rS[u$]=tS-rS[u$+1],rS[u$+1]=m$-F$}break;default:throw new Error("Invalid rotation")}return rS},wre=function(rS,wA,g$){const[S$,tA,tS,m$]=wA;switch(g$){case 0:for(let u$=0,UE=rS.length;u$<UE;u$+=2)rS[u$]-=S$,rS[u$+1]=m$-rS[u$+1];break;case 90:for(let u$=0,UE=rS.length;u$<UE;u$+=2){const F$=rS[u$];rS[u$]=rS[u$+1]-tA,rS[u$+1]=F$-S$}break;case 180:for(let u$=0,UE=rS.length;u$<UE;u$+=2)rS[u$]=tS-rS[u$],rS[u$+1]-=tA;break;case 270:for(let u$=0,UE=rS.length;u$<UE;u$+=2){const F$=rS[u$];rS[u$]=m$-rS[u$+1],rS[u$+1]=tS-F$}break;default:throw new Error("Invalid rotation")}return rS},Sre=function(rS,wA,g$,S$){var UE,F$;const tA=[],tS=this.thickness/2,m$=rS*wA+tS,u$=rS*g$+tS;for(const EI of this.paths){const pR=[],X$=[];for(let J$=0,gD=EI.length;J$<gD;J$++){const[fL,I7,j$,_$]=EI[J$],I$=rS*fL[0]+m$,GL=rS*fL[1]+u$,w$=rS*I7[0]+m$,B$=rS*I7[1]+u$,r$=rS*j$[0]+m$,O$=rS*j$[1]+u$,Z$=rS*_$[0]+m$,mL=rS*_$[1]+u$;J$===0&&(pR.push(I$,GL),X$.push(I$,GL)),pR.push(w$,B$,r$,O$,Z$,mL),X$.push(w$,B$),J$===gD-1&&X$.push(Z$,mL)}tA.push({bezier:L$(UE=M$,LE,Cie).call(UE,pR,S$,this.rotation),points:L$(F$=M$,LE,Cie).call(F$,X$,S$,this.rotation)})}return tA},Mie=function(){let rS=1/0,wA=-1/0,g$=1/0,S$=-1/0;for(const tA of this.paths)for(const[tS,m$,u$,UE]of tA){const F$=gt.Util.bezierBoundingBox(...tS,...m$,...u$,...UE);rS=Math.min(rS,F$[0]),g$=Math.min(g$,F$[1]),wA=Math.max(wA,F$[2]),S$=Math.max(S$,F$[3])}return[rS,g$,wA,S$]},kte=function(){return Sv(this,Fr)?Math.ceil(this.thickness*this.parentScale):0},ote=function(rS=!1){if(this.isEmpty())return;if(!Sv(this,Fr)){L$(this,es,Uee).call(this);return}const wA=L$(this,es,Mie).call(this),g$=L$(this,es,kte).call(this);K$(this,Bt,Math.max(_t.AnnotationEditor.MIN_SIZE,wA[2]-wA[0])),K$(this,Nt,Math.max(_t.AnnotationEditor.MIN_SIZE,wA[3]-wA[1]));const S$=Math.ceil(g$+Sv(this,Bt)*this.scaleFactor),tA=Math.ceil(g$+Sv(this,Nt)*this.scaleFactor),[tS,m$]=this.parentDimensions;this.width=S$/tS,this.height=tA/m$,this.setAspectRatio(S$,tA);const u$=this.translationX,UE=this.translationY;this.translationX=-wA[0],this.translationY=-wA[1],L$(this,es,ste).call(this),L$(this,es,Uee).call(this),K$(this,Tn,S$),K$(this,$n,tA),this.setDims(S$,tA);const F$=rS?g$/this.scaleFactor/2:0;this.translate(u$-this.translationX-F$,UE-this.translationY-F$)},G$(M$,LE),lee(M$,"_defaultColor",null),lee(M$,"_defaultOpacity",1),lee(M$,"_defaultThickness",1),lee(M$,"_type","ink");let Ft=M$;st.InkEditor=Ft},(nt,st,mt)=>{var Ft,Nt,Bt,Gt,dr,Mr,Tr,zr,Fr,Nr,tn,vte,yte,Lte,Pie,_re,Ere,Tie,Fte,Are;Object.defineProperty(st,"__esModule",{value:!0}),st.StampEditor=void 0;var gt=mt(1),_t=mt(4),Et=mt(6),At=mt(29);const Il=class Il extends _t.AnnotationEditor{constructor(p0){super({...p0,name:"stampEditor"});G$(this,tn);G$(this,Ft,null);G$(this,Nt,null);G$(this,Bt,null);G$(this,Gt,null);G$(this,dr,null);G$(this,Mr,null);G$(this,Tr,null);G$(this,zr,null);G$(this,Fr,!1);G$(this,Nr,!1);K$(this,Gt,p0.bitmapUrl),K$(this,dr,p0.bitmapFile)}static initialize(p0){_t.AnnotationEditor.initialize(p0)}static get supportedTypes(){const p0=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,gt.shadow)(this,"supportedTypes",p0.map(X1=>`image/${X1}`))}static get supportedTypesStr(){return(0,gt.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(p0){return this.supportedTypes.includes(p0)}static paste(p0,X1){X1.pasteEditor(gt.AnnotationEditorType.STAMP,{bitmapFile:p0.getAsFile()})}remove(){var p0,X1;Sv(this,Nt)&&(K$(this,Ft,null),this._uiManager.imageManager.deleteId(Sv(this,Nt)),(p0=Sv(this,Mr))==null||p0.remove(),K$(this,Mr,null),(X1=Sv(this,Tr))==null||X1.disconnect(),K$(this,Tr,null)),super.remove()}rebuild(){if(!this.parent){Sv(this,Nt)&&L$(this,tn,Lte).call(this);return}super.rebuild(),this.div!==null&&(Sv(this,Nt)&&L$(this,tn,Lte).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(Sv(this,Bt)||Sv(this,Ft)||Sv(this,Gt)||Sv(this,dr))}get isResizable(){return!0}render(){if(this.div)return this.div;let p0,X1;if(this.width&&(p0=this.x,X1=this.y),super.render(),this.div.hidden=!0,Sv(this,Ft)?L$(this,tn,Pie).call(this):L$(this,tn,Lte).call(this),this.width){const[q0,W0]=this.parentDimensions;this.setAt(p0*q0,X1*W0,this.width*q0,this.height*W0)}return this.div}static deserialize(p0,X1,q0){if(p0 instanceof At.StampAnnotationElement)return null;const W0=super.deserialize(p0,X1,q0),{rect:hu,bitmapUrl:a1,bitmapId:Vx,isSvg:t0,accessibilityData:cu}=p0;Vx&&q0.imageManager.isValidId(Vx)?K$(W0,Nt,Vx):K$(W0,Gt,a1),K$(W0,Fr,t0);const[lu,b0]=W0.pageDimensions;return W0.width=(hu[2]-hu[0])/lu,W0.height=(hu[3]-hu[1])/b0,cu&&(W0.altTextData=cu),W0}serialize(p0=!1,X1=null){if(this.isEmpty())return null;const q0={annotationType:gt.AnnotationEditorType.STAMP,bitmapId:Sv(this,Nt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:Sv(this,Fr),structTreeParentId:this._structTreeParentId};if(p0)return q0.bitmapUrl=L$(this,tn,Fte).call(this,!0),q0.accessibilityData=this.altTextData,q0;const{decorative:W0,altText:hu}=this.altTextData;if(!W0&&hu&&(q0.accessibilityData={type:"Figure",alt:hu}),X1===null)return q0;X1.stamps||(X1.stamps=new Map);const a1=Sv(this,Fr)?(q0.rect[2]-q0.rect[0])*(q0.rect[3]-q0.rect[1]):null;if(!X1.stamps.has(Sv(this,Nt)))X1.stamps.set(Sv(this,Nt),{area:a1,serialized:q0}),q0.bitmap=L$(this,tn,Fte).call(this,!1);else if(Sv(this,Fr)){const Vx=X1.stamps.get(Sv(this,Nt));a1>Vx.area&&(Vx.area=a1,Vx.serialized.bitmap.close(),Vx.serialized.bitmap=L$(this,tn,Fte).call(this,!1))}return q0}};Ft=new WeakMap,Nt=new WeakMap,Bt=new WeakMap,Gt=new WeakMap,dr=new WeakMap,Mr=new WeakMap,Tr=new WeakMap,zr=new WeakMap,Fr=new WeakMap,Nr=new WeakMap,tn=new WeakSet,vte=function(p0,X1=!1){if(!p0){this.remove();return}K$(this,Ft,p0.bitmap),X1||(K$(this,Nt,p0.id),K$(this,Fr,p0.isSvg)),L$(this,tn,Pie).call(this)},yte=function(){K$(this,Bt,null),this._uiManager.enableWaiting(!1),Sv(this,Mr)&&this.div.focus()},Lte=function(){if(Sv(this,Nt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(Sv(this,Nt)).then(X1=>L$(this,tn,vte).call(this,X1,!0)).finally(()=>L$(this,tn,yte).call(this));return}if(Sv(this,Gt)){const X1=Sv(this,Gt);K$(this,Gt,null),this._uiManager.enableWaiting(!0),K$(this,Bt,this._uiManager.imageManager.getFromUrl(X1).then(q0=>L$(this,tn,vte).call(this,q0)).finally(()=>L$(this,tn,yte).call(this)));return}if(Sv(this,dr)){const X1=Sv(this,dr);K$(this,dr,null),this._uiManager.enableWaiting(!0),K$(this,Bt,this._uiManager.imageManager.getFromFile(X1).then(q0=>L$(this,tn,vte).call(this,q0)).finally(()=>L$(this,tn,yte).call(this)));return}const p0=document.createElement("input");p0.type="file",p0.accept=Il.supportedTypesStr,K$(this,Bt,new Promise(X1=>{p0.addEventListener("change",async()=>{if(!p0.files||p0.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const q0=await this._uiManager.imageManager.getFromFile(p0.files[0]);L$(this,tn,vte).call(this,q0)}X1()}),p0.addEventListener("cancel",()=>{this.remove(),X1()})}).finally(()=>L$(this,tn,yte).call(this))),p0.click()},Pie=function(){const{div:p0}=this;let{width:X1,height:q0}=Sv(this,Ft);const[W0,hu]=this.pageDimensions,a1=.75;if(this.width)X1=this.width*W0,q0=this.height*hu;else if(X1>a1*W0||q0>a1*hu){const lu=Math.min(a1*W0/X1,a1*hu/q0);X1*=lu,q0*=lu}const[Vx,t0]=this.parentDimensions;this.setDims(X1*Vx/W0,q0*t0/hu),this._uiManager.enableWaiting(!1);const cu=K$(this,Mr,document.createElement("canvas"));p0.append(cu),p0.hidden=!1,L$(this,tn,Tie).call(this,X1,q0),L$(this,tn,Are).call(this),Sv(this,Nr)||(this.parent.addUndoableEditor(this),K$(this,Nr,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},_re=function(p0,X1){var a1;const[q0,W0]=this.parentDimensions;this.width=p0/q0,this.height=X1/W0,this.setDims(p0,X1),(a1=this._initialOptions)!=null&&a1.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,Sv(this,zr)!==null&&clearTimeout(Sv(this,zr)),K$(this,zr,setTimeout(()=>{K$(this,zr,null),L$(this,tn,Tie).call(this,p0,X1)},200))},Ere=function(p0,X1){const{width:q0,height:W0}=Sv(this,Ft);let hu=q0,a1=W0,Vx=Sv(this,Ft);for(;hu>2*p0||a1>2*X1;){const t0=hu,cu=a1;hu>2*p0&&(hu=hu>=16384?Math.floor(hu/2)-1:Math.ceil(hu/2)),a1>2*X1&&(a1=a1>=16384?Math.floor(a1/2)-1:Math.ceil(a1/2));const lu=new OffscreenCanvas(hu,a1);lu.getContext("2d").drawImage(Vx,0,0,t0,cu,0,0,hu,a1),Vx=lu.transferToImageBitmap()}return Vx},Tie=function(p0,X1){p0=Math.ceil(p0),X1=Math.ceil(X1);const q0=Sv(this,Mr);if(!q0||q0.width===p0&&q0.height===X1)return;q0.width=p0,q0.height=X1;const W0=Sv(this,Fr)?Sv(this,Ft):L$(this,tn,Ere).call(this,p0,X1),hu=q0.getContext("2d");hu.filter=this._uiManager.hcmFilter,hu.drawImage(W0,0,0,W0.width,W0.height,0,0,p0,X1)},Fte=function(p0){if(p0){if(Sv(this,Fr)){const W0=this._uiManager.imageManager.getSvgUrl(Sv(this,Nt));if(W0)return W0}const X1=document.createElement("canvas");return{width:X1.width,height:X1.height}=Sv(this,Ft),X1.getContext("2d").drawImage(Sv(this,Ft),0,0),X1.toDataURL()}if(Sv(this,Fr)){const[X1,q0]=this.pageDimensions,W0=Math.round(this.width*X1*Et.PixelsPerInch.PDF_TO_CSS_UNITS),hu=Math.round(this.height*q0*Et.PixelsPerInch.PDF_TO_CSS_UNITS),a1=new OffscreenCanvas(W0,hu);return a1.getContext("2d").drawImage(Sv(this,Ft),0,0,Sv(this,Ft).width,Sv(this,Ft).height,0,0,W0,hu),a1.transferToImageBitmap()}return structuredClone(Sv(this,Ft))},Are=function(){K$(this,Tr,new ResizeObserver(p0=>{const X1=p0[0].contentRect;X1.width&&X1.height&&L$(this,tn,_re).call(this,X1.width,X1.height)})),Sv(this,Tr).observe(this.div)},lee(Il,"_type","stamp");let Rt=Il;st.StampEditor=Rt}],__webpack_module_cache__={};function __w_pdfjs_require__(nt){var st=__webpack_module_cache__[nt];if(st!==void 0)return st.exports;var mt=__webpack_module_cache__[nt]={exports:{}};return __webpack_modules__[nt](mt,mt.exports,__w_pdfjs_require__),mt.exports}var __webpack_exports__={};return(()=>{var nt=__webpack_exports__;Object.defineProperty(nt,"__esModule",{value:!0}),Object.defineProperty(nt,"AbortException",{enumerable:!0,get:function(){return st.AbortException}}),Object.defineProperty(nt,"AnnotationEditorLayer",{enumerable:!0,get:function(){return Et.AnnotationEditorLayer}}),Object.defineProperty(nt,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return st.AnnotationEditorParamsType}}),Object.defineProperty(nt,"AnnotationEditorType",{enumerable:!0,get:function(){return st.AnnotationEditorType}}),Object.defineProperty(nt,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return At.AnnotationEditorUIManager}}),Object.defineProperty(nt,"AnnotationLayer",{enumerable:!0,get:function(){return Rt.AnnotationLayer}}),Object.defineProperty(nt,"AnnotationMode",{enumerable:!0,get:function(){return st.AnnotationMode}}),Object.defineProperty(nt,"CMapCompressionType",{enumerable:!0,get:function(){return st.CMapCompressionType}}),Object.defineProperty(nt,"DOMSVGFactory",{enumerable:!0,get:function(){return gt.DOMSVGFactory}}),Object.defineProperty(nt,"FeatureTest",{enumerable:!0,get:function(){return st.FeatureTest}}),Object.defineProperty(nt,"GlobalWorkerOptions",{enumerable:!0,get:function(){return Ft.GlobalWorkerOptions}}),Object.defineProperty(nt,"ImageKind",{enumerable:!0,get:function(){return st.ImageKind}}),Object.defineProperty(nt,"InvalidPDFException",{enumerable:!0,get:function(){return st.InvalidPDFException}}),Object.defineProperty(nt,"MissingPDFException",{enumerable:!0,get:function(){return st.MissingPDFException}}),Object.defineProperty(nt,"OPS",{enumerable:!0,get:function(){return st.OPS}}),Object.defineProperty(nt,"PDFDataRangeTransport",{enumerable:!0,get:function(){return mt.PDFDataRangeTransport}}),Object.defineProperty(nt,"PDFDateString",{enumerable:!0,get:function(){return gt.PDFDateString}}),Object.defineProperty(nt,"PDFWorker",{enumerable:!0,get:function(){return mt.PDFWorker}}),Object.defineProperty(nt,"PasswordResponses",{enumerable:!0,get:function(){return st.PasswordResponses}}),Object.defineProperty(nt,"PermissionFlag",{enumerable:!0,get:function(){return st.PermissionFlag}}),Object.defineProperty(nt,"PixelsPerInch",{enumerable:!0,get:function(){return gt.PixelsPerInch}}),Object.defineProperty(nt,"PromiseCapability",{enumerable:!0,get:function(){return st.PromiseCapability}}),Object.defineProperty(nt,"RenderingCancelledException",{enumerable:!0,get:function(){return gt.RenderingCancelledException}}),Object.defineProperty(nt,"SVGGraphics",{enumerable:!0,get:function(){return mt.SVGGraphics}}),Object.defineProperty(nt,"UnexpectedResponseException",{enumerable:!0,get:function(){return st.UnexpectedResponseException}}),Object.defineProperty(nt,"Util",{enumerable:!0,get:function(){return st.Util}}),Object.defineProperty(nt,"VerbosityLevel",{enumerable:!0,get:function(){return st.VerbosityLevel}}),Object.defineProperty(nt,"XfaLayer",{enumerable:!0,get:function(){return Nt.XfaLayer}}),Object.defineProperty(nt,"build",{enumerable:!0,get:function(){return mt.build}}),Object.defineProperty(nt,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return st.createValidAbsoluteUrl}}),Object.defineProperty(nt,"getDocument",{enumerable:!0,get:function(){return mt.getDocument}}),Object.defineProperty(nt,"getFilenameFromUrl",{enumerable:!0,get:function(){return gt.getFilenameFromUrl}}),Object.defineProperty(nt,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return gt.getPdfFilenameFromUrl}}),Object.defineProperty(nt,"getXfaPageViewport",{enumerable:!0,get:function(){return gt.getXfaPageViewport}}),Object.defineProperty(nt,"isDataScheme",{enumerable:!0,get:function(){return gt.isDataScheme}}),Object.defineProperty(nt,"isPdfFile",{enumerable:!0,get:function(){return gt.isPdfFile}}),Object.defineProperty(nt,"loadScript",{enumerable:!0,get:function(){return gt.loadScript}}),Object.defineProperty(nt,"noContextMenu",{enumerable:!0,get:function(){return gt.noContextMenu}}),Object.defineProperty(nt,"normalizeUnicode",{enumerable:!0,get:function(){return st.normalizeUnicode}}),Object.defineProperty(nt,"renderTextLayer",{enumerable:!0,get:function(){return _t.renderTextLayer}}),Object.defineProperty(nt,"setLayerDimensions",{enumerable:!0,get:function(){return gt.setLayerDimensions}}),Object.defineProperty(nt,"shadow",{enumerable:!0,get:function(){return st.shadow}}),Object.defineProperty(nt,"updateTextLayer",{enumerable:!0,get:function(){return _t.updateTextLayer}}),Object.defineProperty(nt,"version",{enumerable:!0,get:function(){return mt.version}});var st=__w_pdfjs_require__(1),mt=__w_pdfjs_require__(2),gt=__w_pdfjs_require__(6),_t=__w_pdfjs_require__(26),Et=__w_pdfjs_require__(27),At=__w_pdfjs_require__(5),Rt=__w_pdfjs_require__(29),Ft=__w_pdfjs_require__(14),Nt=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;(function(nt){var st=reactExports,mt=pdfExports;function gt(q1){var a$=Object.create(null);return q1&&Object.keys(q1).forEach(function(b$){if(b$!=="default"){var E$=Object.getOwnPropertyDescriptor(q1,b$);Object.defineProperty(a$,b$,E$.get?E$:{enumerable:!0,get:function(){return q1[b$]}})}}),a$.default=q1,Object.freeze(a$)}var _t,Et=gt(st),At=gt(mt);nt.AnnotationType=void 0,(_t=nt.AnnotationType||(nt.AnnotationType={}))[_t.Text=1]="Text",_t[_t.Link=2]="Link",_t[_t.FreeText=3]="FreeText",_t[_t.Line=4]="Line",_t[_t.Square=5]="Square",_t[_t.Circle=6]="Circle",_t[_t.Polygon=7]="Polygon",_t[_t.Polyline=8]="Polyline",_t[_t.Highlight=9]="Highlight",_t[_t.Underline=10]="Underline",_t[_t.Squiggly=11]="Squiggly",_t[_t.StrikeOut=12]="StrikeOut",_t[_t.Stamp=13]="Stamp",_t[_t.Caret=14]="Caret",_t[_t.Ink=15]="Ink",_t[_t.Popup=16]="Popup",_t[_t.FileAttachment=17]="FileAttachment";var Rt=function(q1,a$){return Rt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b$,E$){b$.__proto__=E$}||function(b$,E$){for(var D$ in E$)Object.prototype.hasOwnProperty.call(E$,D$)&&(b$[D$]=E$[D$])},Rt(q1,a$)};function Ft(q1,a$){if(typeof a$!="function"&&a$!==null)throw new TypeError("Class extends value "+String(a$)+" is not a constructor or null");function b$(){this.constructor=q1}Rt(q1,a$),q1.prototype=a$===null?Object.create(a$):(b$.prototype=a$.prototype,new b$)}var Nt,Bt=function(){return Bt=Object.assign||function(q1){for(var a$,b$=1,E$=arguments.length;b$<E$;b$++)for(var D$ in a$=arguments[b$])Object.prototype.hasOwnProperty.call(a$,D$)&&(q1[D$]=a$[D$]);return q1},Bt.apply(this,arguments)};nt.TextDirection=void 0,(Nt=nt.TextDirection||(nt.TextDirection={})).RightToLeft="RTL",Nt.LeftToRight="LTR";var Gt,dr=Et.createContext({currentTheme:"light",direction:nt.TextDirection.LeftToRight,setCurrentTheme:function(){}}),Mr=function(q1){var a$=[];return Object.keys(q1).forEach(function(b$){b$&&q1[b$]&&a$.push(b$)}),a$.join(" ")},Tr=typeof window<"u"?Et.useLayoutEffect:Et.useEffect,zr=function(q1){var a$=Et.useRef(null),b$=q1.once,E$=q1.threshold,D$=q1.onVisibilityChanged;return Tr(function(){var k$=a$.current;if(k$){var W$=new IntersectionObserver(function(z$){z$.forEach(function(A$){var V$=A$.isIntersecting,U$=A$.intersectionRatio;D$({isVisible:V$,ratio:U$}),V$&&b$&&(W$.unobserve(k$),W$.disconnect())})},{threshold:E$||0});return W$.observe(k$),function(){W$.unobserve(k$),W$.disconnect()}}},[]),a$},Fr=function(q1){var a$=q1.children,b$=q1.ignoreDirection,E$=b$!==void 0&&b$,D$=q1.size,k$=D$===void 0?24:D$,W$=Et.useContext(dr).direction,z$=!E$&&W$===nt.TextDirection.RightToLeft,A$="".concat(k$||24,"px");return Et.createElement("svg",{"aria-hidden":"true",className:Mr({"rpv-core__icon":!0,"rpv-core__icon--rtl":z$}),focusable:"false",height:A$,viewBox:"0 0 24 24",width:A$},a$)},Nr=function(){return Et.createElement(Fr,{size:16},Et.createElement("path",{d:"M23.5,0.499l-16.5,23l-6.5-6.5"}))},tn=function(q1){var a$=q1.children,b$=q1.testId,E$=q1.onClick,D$=Et.useContext(dr).direction===nt.TextDirection.RightToLeft,k$=b$?{"data-testid":b$}:{};return Et.createElement("button",Bt({className:Mr({"rpv-core__primary-button":!0,"rpv-core__primary-button--rtl":D$}),type:"button",onClick:E$},k$),a$)},rn=function(q1){var a$=q1.size,b$=a$===void 0?"4rem":a$,E$=q1.testId,D$=Et.useState(!1),k$=D$[0],W$=D$[1],z$=E$?{"data-testid":E$}:{},A$=zr({onVisibilityChanged:function(V$){W$(V$.isVisible)}});return Et.createElement("div",Bt({},z$,{className:Mr({"rpv-core__spinner":!0,"rpv-core__spinner--animating":k$}),ref:A$,style:{height:b$,width:b$}}))},Tn=function(q1){var a$=q1.ariaLabel,b$=a$===void 0?"":a$,E$=q1.autoFocus,D$=E$!==void 0&&E$,k$=q1.placeholder,W$=k$===void 0?"":k$,z$=q1.testId,A$=q1.type,V$=A$===void 0?"text":A$,U$=q1.value,mO=U$===void 0?"":U$,NI=q1.onChange,AI=q1.onKeyDown,J7=AI===void 0?function(){}:AI,_7=Et.useContext(dr).direction,B9=Et.useRef(),HQ=_7===nt.TextDirection.RightToLeft,gX={ref:B9,"data-testid":"","aria-label":b$,className:Mr({"rpv-core__textbox":!0,"rpv-core__textbox--rtl":HQ}),placeholder:W$,value:mO,onChange:function(DX){return NI(DX.target.value)},onKeyDown:J7};return z$&&(gX["data-testid"]=z$),Tr(function(){if(D$){var DX=B9.current;if(DX){var gK=window.scrollX,kq=window.scrollY;DX.focus(),window.scrollTo(gK,kq)}}},[]),V$==="text"?Et.createElement("input",Bt({type:"text"},gX)):Et.createElement("input",Bt({type:"password"},gX))};(function(q1){q1[q1.ExitFullScreen=0]="ExitFullScreen",q1[q1.FullScreenChange=1]="FullScreenChange",q1[q1.FullScreenElement=2]="FullScreenElement",q1[q1.FullScreenEnabled=3]="FullScreenEnabled",q1[q1.RequestFullScreen=4]="RequestFullScreen"})(Gt||(Gt={}));var $n,un={ExitFullScreen:"exitFullscreen",FullScreenChange:"fullscreenchange",FullScreenElement:"fullscreenElement",FullScreenEnabled:"fullscreenEnabled",RequestFullScreen:"requestFullscreen"},es={ExitFullScreen:"webkitExitFullscreen",FullScreenChange:"webkitfullscreenchange",FullScreenElement:"webkitFullscreenElement",FullScreenEnabled:"webkitFullscreenEnabled",RequestFullScreen:"webkitRequestFullscreen"},kn={ExitFullScreen:"msExitFullscreen",FullScreenChange:"msFullscreenChange",FullScreenElement:"msFullscreenElement",FullScreenEnabled:"msFullscreenEnabled",RequestFullScreen:"msRequestFullscreen"},ts=typeof window<"u",Ko=ts&&(Gt.FullScreenEnabled in document&&un||es.FullScreenEnabled in document&&es||kn.FullScreenEnabled in document&&kn)||un,ds=function(){return ts&&Ko.FullScreenEnabled in document&&document[Ko.FullScreenEnabled]===!0},Il=function(q1){return ts?q1[Ko.ExitFullScreen]():Promise.resolve({})},ru=function(){return ts?document[Ko.FullScreenElement]:null},uu=function(q1,a$){var b$=Et.useRef(),E$=function(){b$.current&&clearTimeout(b$.current)};return Et.useEffect(function(){return function(){return E$()}},[]),Et.useCallback(function(){for(var D$=[],k$=0;k$<arguments.length;k$++)D$[k$]=arguments[k$];E$(),b$.current=setTimeout(function(){q1.apply(void 0,D$)},a$)},[q1,a$])},p0=function(){var q1=Et.useRef(!1);return Et.useEffect(function(){return q1.current=!0,function(){q1.current=!1}},[]),q1},X1=function(q1){var a$=Et.useRef(q1);return Et.useEffect(function(){a$.current=q1},[q1]),a$.current};(function(q1){q1.NotRenderedYet="NotRenderedYet",q1.Rendering="Rendering",q1.Rendered="Rendered"})($n||($n={}));var q0,W0=-9999,hu=function(q1){var a$=q1.doc,b$=a$.numPages,E$=a$.loadingTask.docId,D$=Et.useMemo(function(){return Array(b$).fill(null).map(function(z$,A$){return{pageIndex:A$,renderStatus:$n.NotRenderedYet,visibility:W0}})},[E$]),k$=Et.useRef({currentRenderingPage:-1,startRange:0,endRange:b$-1,visibilities:D$}),W$=function(z$,A$){k$.current.visibilities[z$].visibility=A$};return{getHighestPriorityPage:function(){var z$=k$.current.visibilities.slice(k$.current.startRange,k$.current.endRange+1).filter(function(NI){return NI.visibility>W0});if(!z$.length)return-1;for(var A$=z$[0].pageIndex,V$=z$[z$.length-1].pageIndex,U$=z$.length,mO=0;mO<U$;mO++){if(z$[mO].renderStatus===$n.Rendering)return-1;if(z$[mO].renderStatus===$n.NotRenderedYet)return z$[mO].pageIndex}return V$+1<b$&&k$.current.visibilities[V$+1].renderStatus!==$n.Rendered?V$+1:A$-1>=0&&k$.current.visibilities[A$-1].renderStatus!==$n.Rendered?A$-1:-1},isInRange:function(z$){return z$>=k$.current.startRange&&z$<=k$.current.endRange},markNotRendered:function(){for(var z$=0;z$<b$;z$++)k$.current.visibilities[z$].renderStatus=$n.NotRenderedYet},markRendered:function(z$){k$.current.visibilities[z$].renderStatus=$n.Rendered},markRendering:function(z$){k$.current.currentRenderingPage!==-1&&k$.current.currentRenderingPage!==z$&&k$.current.visibilities[k$.current.currentRenderingPage].renderStatus===$n.Rendering&&(k$.current.visibilities[k$.current.currentRenderingPage].renderStatus=$n.NotRenderedYet),k$.current.visibilities[z$].renderStatus=$n.Rendering,k$.current.currentRenderingPage=z$},setOutOfRange:function(z$){W$(z$,W0)},setRange:function(z$,A$){k$.current.startRange=z$,k$.current.endRange=A$;for(var V$=0;V$<b$;V$++)(V$<z$||V$>A$)&&(k$.current.visibilities[V$].visibility=W0,k$.current.visibilities[V$].renderStatus=$n.NotRenderedYet)},setVisibility:W$}},a1={core:{askingPassword:{requirePasswordToOpen:"This document requires a password to open",submit:"Submit"},wrongPassword:{tryAgain:"The password is wrong. Please try again"},pageLabel:"Page {{pageIndex}}"}},Vx=Et.createContext({l10n:a1,setL10n:function(){}}),t0=0,cu=function(){return t0++},lu=function(q1,a$,b$){var E$=function(D$){var k$=a$.current;if(k$){var W$=D$.target;if(W$ instanceof Element&&W$.shadowRoot){var z$=D$.composedPath();z$.length>0&&!k$.contains(z$[0])&&b$()}else k$.contains(W$)||b$()}};Et.useEffect(function(){if(q1){var D$={capture:!0};return document.addEventListener("click",E$,D$),function(){document.removeEventListener("click",E$,D$)}}},[])},b0=function(q1){var a$=function(b$){b$.key==="Escape"&&q1()};Et.useEffect(function(){return document.addEventListener("keyup",a$),function(){document.removeEventListener("keyup",a$)}},[])},l1=function(q1){var a$=q1.ariaControlsSuffix,b$=q1.children,E$=q1.closeOnClickOutside,D$=q1.closeOnEscape,k$=q1.onToggle,W$=Et.useRef(),z$=Et.useContext(dr).direction===nt.TextDirection.RightToLeft;return Et.useEffect(function(){var A$=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",function(){document.body.style.overflow=A$}},[]),b0(function(){W$.current&&D$&&k$()}),lu(E$,W$,k$),Tr(function(){var A$=W$.current;if(A$){var V$=.75*document.body.clientHeight;A$.getBoundingClientRect().height>=V$&&(A$.style.overflow="auto",A$.style.maxHeight="".concat(V$,"px"))}},[]),Et.createElement("div",{"aria-modal":"true",className:Mr({"rpv-core__modal-body":!0,"rpv-core__modal-body--rtl":z$}),id:"rpv-core__modal-body-".concat(a$),ref:W$,role:"dialog",tabIndex:-1},b$)},LE=function(q1){var a$=q1.children;return Et.createElement("div",{className:"rpv-core__modal-overlay"},a$)};nt.ToggleStatus=void 0,(q0=nt.ToggleStatus||(nt.ToggleStatus={})).Close="Close",q0.Open="Open",q0.Toggle="Toggle";var eS,SA=function(q1){var a$=Et.useState(q1),b$=a$[0],E$=a$[1];return{opened:b$,toggle:function(D$){switch(D$){case nt.ToggleStatus.Close:E$(!1);break;case nt.ToggleStatus.Open:E$(!0);break;case nt.ToggleStatus.Toggle:default:E$(function(k$){return!k$})}}}},o$=function(q1){var a$=q1.content,b$=q1.isOpened,E$=b$!==void 0&&b$,D$=q1.target,k$=SA(E$),W$=k$.opened,z$=k$.toggle;return Et.createElement(Et.Fragment,null,D$&&D$(z$,W$),W$&&a$(z$))};nt.Position=void 0,(eS=nt.Position||(nt.Position={})).TopLeft="TOP_LEFT",eS.TopCenter="TOP_CENTER",eS.TopRight="TOP_RIGHT",eS.RightTop="RIGHT_TOP",eS.RightCenter="RIGHT_CENTER",eS.RightBottom="RIGHT_BOTTOM",eS.BottomLeft="BOTTOM_LEFT",eS.BottomCenter="BOTTOM_CENTER",eS.BottomRight="BOTTOM_RIGHT",eS.LeftTop="LEFT_TOP",eS.LeftCenter="LEFT_CENTER",eS.LeftBottom="LEFT_BOTTOM";var h$,d$,y$,R$,M$,x$,v$,rS,wA=function(q1,a$,b$,E$,D$){Tr(function(){var k$=a$.current,W$=q1.current,z$=b$.current;if(W$&&k$&&z$){var A$=z$.getBoundingClientRect(),V$=function(NI,AI,J7,_7){var B9=AI.getBoundingClientRect(),HQ=NI.getBoundingClientRect(),gX=HQ.height,DX=HQ.width,gK=0,kq=0;switch(J7){case nt.Position.TopLeft:gK=B9.top-gX,kq=B9.left;break;case nt.Position.TopCenter:gK=B9.top-gX,kq=B9.left+B9.width/2-DX/2;break;case nt.Position.TopRight:gK=B9.top-gX,kq=B9.left+B9.width-DX;break;case nt.Position.RightTop:gK=B9.top,kq=B9.left+B9.width;break;case nt.Position.RightCenter:gK=B9.top+B9.height/2-gX/2,kq=B9.left+B9.width;break;case nt.Position.RightBottom:gK=B9.top+B9.height-gX,kq=B9.left+B9.width;break;case nt.Position.BottomLeft:gK=B9.top+B9.height,kq=B9.left;break;case nt.Position.BottomCenter:gK=B9.top+B9.height,kq=B9.left+B9.width/2-DX/2;break;case nt.Position.BottomRight:gK=B9.top+B9.height,kq=B9.left+B9.width-DX;break;case nt.Position.LeftTop:gK=B9.top,kq=B9.left-DX;break;case nt.Position.LeftCenter:gK=B9.top+B9.height/2-gX/2,kq=B9.left-DX;break;case nt.Position.LeftBottom:gK=B9.top+B9.height-gX,kq=B9.left-DX}return{left:kq+(_7.left||0),top:gK+(_7.top||0)}}(W$,k$,E$,D$),U$=V$.top,mO=V$.left;W$.style.top="".concat(U$-A$.top,"px"),W$.style.left="".concat(mO-A$.left,"px")}},[])},g$=function(q1){var a$,b$=q1.customClassName,E$=q1.position;return Et.createElement("div",{className:Mr((a$={"rpv-core__arrow":!0,"rpv-core__arrow--tl":E$===nt.Position.TopLeft,"rpv-core__arrow--tc":E$===nt.Position.TopCenter,"rpv-core__arrow--tr":E$===nt.Position.TopRight,"rpv-core__arrow--rt":E$===nt.Position.RightTop,"rpv-core__arrow--rc":E$===nt.Position.RightCenter,"rpv-core__arrow--rb":E$===nt.Position.RightBottom,"rpv-core__arrow--bl":E$===nt.Position.BottomLeft,"rpv-core__arrow--bc":E$===nt.Position.BottomCenter,"rpv-core__arrow--br":E$===nt.Position.BottomRight,"rpv-core__arrow--lt":E$===nt.Position.LeftTop,"rpv-core__arrow--lc":E$===nt.Position.LeftCenter,"rpv-core__arrow--lb":E$===nt.Position.LeftBottom},a$["".concat(b$)]=b$!=="",a$))})},S$=function(q1){var a$=q1.ariaControlsSuffix,b$=q1.children,E$=q1.closeOnClickOutside,D$=q1.offset,k$=q1.position,W$=q1.targetRef,z$=q1.onClose,A$=Et.useRef(),V$=Et.useRef(),U$=Et.useRef(),mO=Et.useContext(dr).direction===nt.TextDirection.RightToLeft;lu(E$,A$,z$),wA(A$,W$,U$,k$,D$),Tr(function(){var AI=V$.current;if(AI){var J7=.75*document.body.clientHeight;AI.getBoundingClientRect().height>=J7&&(AI.style.overflow="auto",AI.style.maxHeight="".concat(J7,"px"))}},[]);var NI="rpv-core__popover-body-inner-".concat(a$);return Et.createElement(Et.Fragment,null,Et.createElement("div",{ref:U$,style:{left:0,position:"absolute",top:0}}),Et.createElement("div",{"aria-describedby":NI,className:Mr({"rpv-core__popover-body":!0,"rpv-core__popover-body--rtl":mO}),id:"rpv-core__popover-body-".concat(a$),ref:A$,role:"dialog",tabIndex:-1},Et.createElement(g$,{customClassName:"rpv-core__popover-body-arrow",position:k$}),Et.createElement("div",{id:NI,ref:V$},b$)))},tA=function(q1){var a$=q1.closeOnEscape,b$=q1.onClose,E$=Et.useRef();return b0(function(){E$.current&&a$&&b$()}),Et.createElement("div",{className:"rpv-core__popover-overlay",ref:E$})},tS=function(q1){var a$=q1.ariaControlsSuffix,b$=q1.children,E$=q1.contentRef,D$=q1.offset,k$=q1.position,W$=q1.targetRef,z$=Et.useRef(),A$=Et.useContext(dr).direction===nt.TextDirection.RightToLeft;return wA(E$,W$,z$,k$,D$),Et.createElement(Et.Fragment,null,Et.createElement("div",{ref:z$,style:{left:0,position:"absolute",top:0}}),Et.createElement("div",{className:Mr({"rpv-core__tooltip-body":!0,"rpv-core__tooltip-body--rtl":A$}),id:"rpv-core__tooltip-body-".concat(a$),ref:E$,role:"tooltip"},Et.createElement(g$,{customClassName:"rpv-core__tooltip-body-arrow",position:k$}),Et.createElement("div",{className:"rpv-core__tooltip-body-content"},b$)))};nt.FullScreenMode=void 0,(h$=nt.FullScreenMode||(nt.FullScreenMode={})).Normal="Normal",h$.Entering="Entering",h$.Entered="Entered",h$.EnteredCompletely="EnteredCompletely",h$.Exitting="Exitting",h$.Exited="Exited",nt.LayerRenderStatus=void 0,(d$=nt.LayerRenderStatus||(nt.LayerRenderStatus={}))[d$.PreRender=0]="PreRender",d$[d$.DidRender=1]="DidRender",nt.PageMode=void 0,(y$=nt.PageMode||(nt.PageMode={})).Attachments="UseAttachments",y$.Bookmarks="UseOutlines",y$.ContentGroup="UseOC",y$.Default="UserNone",y$.FullScreen="FullScreen",y$.Thumbnails="UseThumbs",nt.PasswordStatus=void 0,(R$=nt.PasswordStatus||(nt.PasswordStatus={})).RequiredPassword="RequiredPassword",R$.WrongPassword="WrongPassword",nt.RotateDirection=void 0,(M$=nt.RotateDirection||(nt.RotateDirection={})).Backward="Backward",M$.Forward="Forward",nt.ScrollMode=void 0,(x$=nt.ScrollMode||(nt.ScrollMode={})).Page="Page",x$.Horizontal="Horizontal",x$.Vertical="Vertical",x$.Wrapped="Wrapped",nt.SpecialZoomLevel=void 0,(v$=nt.SpecialZoomLevel||(nt.SpecialZoomLevel={})).ActualSize="ActualSize",v$.PageFit="PageFit",v$.PageWidth="PageWidth",nt.ViewMode=void 0,(rS=nt.ViewMode||(nt.ViewMode={})).DualPage="DualPage",rS.DualPageWithCover="DualPageWithCover",rS.SinglePage="SinglePage";var m$,u$=function(q1,a$){return q1.reduce(function(b$,E$,D$){return D$%a$?b$[b$.length-1].push(E$):b$.push([E$]),b$},[])},UE=function(q1,a$){switch(a$[1].name){case"XYZ":return{bottomOffset:function(b$,E$){return a$[3]===null?E$:a$[3]},leftOffset:function(b$,E$){return a$[2]===null?0:a$[2]},pageIndex:q1,scaleTo:a$[4]};case"Fit":case"FitB":return{bottomOffset:0,leftOffset:0,pageIndex:q1,scaleTo:nt.SpecialZoomLevel.PageFit};case"FitH":case"FitBH":return{bottomOffset:a$[2],leftOffset:0,pageIndex:q1,scaleTo:nt.SpecialZoomLevel.PageWidth};default:return{bottomOffset:0,leftOffset:0,pageIndex:q1,scaleTo:1}}},F$=new Map,EI=new Map,pR=function(q1,a$){return"".concat(q1.loadingTask.docId,"___").concat(a$.num,"R").concat(a$.gen===0?"":a$.gen)},X$=function(q1,a$,b$){F$.set(pR(q1,a$),b$)},J$=function(q1,a$){if(!q1)return Promise.reject("The document is not loaded yet");var b$="".concat(q1.loadingTask.docId,"___").concat(a$),E$=EI.get(b$);return E$?Promise.resolve(E$):new Promise(function(D$,k$){q1.getPage(a$+1).then(function(W$){EI.set(b$,W$),W$.ref&&X$(q1,W$.ref,a$),D$(W$)})})},gD=function(q1,a$){return new Promise(function(b$){new Promise(function(E$){typeof a$=="string"?q1.getDestination(a$).then(function(D$){E$(D$)}):E$(a$)}).then(function(E$){if(typeof E$[0]=="object"&&E$[0]!==null){var D$=E$[0],k$=function(z$,A$){var V$=pR(z$,A$);return F$.has(V$)?F$.get(V$):null}(q1,D$);k$===null?q1.getPageIndex(D$).then(function(z$){X$(q1,D$,z$),gD(q1,a$).then(function(A$){return b$(A$)})}):b$(UE(k$,E$))}else{var W$=UE(E$[0],E$);b$(W$)}})})};(function(q1){q1[q1.Solid=1]="Solid",q1[q1.Dashed=2]="Dashed",q1[q1.Beveled=3]="Beveled",q1[q1.Inset=4]="Inset",q1[q1.Underline=5]="Underline"})(m$||(m$={}));var fL,I7=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"),j$=function(q1,a$,b$,E$){var D$=parseInt(q1,10);return D$>=a$&&D$<=b$?D$:E$},_$=function(q1){return q1.contentsObj?q1.contentsObj.str:q1.contents||""},I$=function(q1){return q1.titleObj?q1.titleObj.str:q1.title||""},GL=function(q1){var a$=q1.annotation,b$=Et.useContext(dr).direction,E$=I$(a$),D$=_$(a$),k$=b$===nt.TextDirection.RightToLeft,W$=Et.useRef(),z$="";if(a$.modificationDate){var A$=function(V$){var U$=I7.exec(V$);if(!U$)return null;var mO=parseInt(U$[1],10),NI=j$(U$[2],1,12,1)-1,AI=j$(U$[3],1,31,1),J7=j$(U$[4],0,23,0),_7=j$(U$[5],0,59,0),B9=j$(U$[6],0,59,0),HQ=U$[7]||"Z",gX=j$(U$[8],0,23,0),DX=j$(U$[9],0,59,0);switch(HQ){case"-":J7+=gX,_7+=DX;break;case"+":J7-=gX,_7-=DX}return new Date(Date.UTC(mO,NI,AI,J7,_7,B9))}(a$.modificationDate);z$=A$?"".concat(A$.toLocaleDateString(),", ").concat(A$.toLocaleTimeString()):""}return Et.useLayoutEffect(function(){if(W$.current){var V$=document.querySelector('[data-annotation-id="'.concat(a$.id,'"]'));if(V$){var U$=V$;return U$.style.zIndex+=1,function(){U$.style.zIndex="".concat(parseInt(U$.style.zIndex,10)-1)}}}},[]),Et.createElement("div",{ref:W$,className:Mr({"rpv-core__annotation-popup-wrapper":!0,"rpv-core__annotation-popup-wrapper--rtl":k$}),style:{top:a$.annotationType===nt.AnnotationType.Popup?"":"100%"}},E$&&Et.createElement(Et.Fragment,null,Et.createElement("div",{className:Mr({"rpv-core__annotation-popup-title":!0,"rpv-core__annotation-popup-title--ltr":!k$,"rpv-core__annotation-popup-title--rtl":k$})},E$),Et.createElement("div",{className:"rpv-core__annotation-popup-date"},z$)),D$&&Et.createElement("div",{className:"rpv-core__annotation-popup-content"},D$.split(`
`).map(function(V$,U$){return Et.createElement(Et.Fragment,{key:U$},V$,Et.createElement("br",null))})))};(function(q1){q1.Click="Click",q1.Hover="Hover"})(fL||(fL={}));var w$,B$=function(q1){var a$,b$=q1.annotation,E$=q1.children,D$=q1.ignoreBorder,k$=q1.hasPopup,W$=q1.isRenderable,z$=q1.page,A$=q1.viewport,V$=b$.rect,U$=function(){var DY=SA(!1),JQ=DY.opened,ZQ=DY.toggle,eee=Et.useState(fL.Hover),tee=eee[0],ree=eee[1];return{opened:JQ,closeOnHover:function(){tee===fL.Hover&&ZQ(nt.ToggleStatus.Close)},openOnHover:function(){tee===fL.Hover&&ZQ(nt.ToggleStatus.Open)},toggleOnClick:function(){switch(tee){case fL.Click:JQ&&ree(fL.Hover),ZQ(nt.ToggleStatus.Toggle);break;case fL.Hover:ree(fL.Click),ZQ(nt.ToggleStatus.Open)}}}}(),mO=U$.closeOnHover,NI=U$.opened,AI=U$.openOnHover,J7=U$.toggleOnClick,_7=(a$=[V$[0],z$.view[3]+z$.view[1]-V$[1],V$[2],z$.view[3]+z$.view[1]-V$[3]],[Math.min(a$[0],a$[2]),Math.min(a$[1],a$[3]),Math.max(a$[0],a$[2]),Math.max(a$[1],a$[3])]),B9=V$[2]-V$[0],HQ=V$[3]-V$[1],gX={borderColor:"",borderRadius:"",borderStyle:"",borderWidth:""};if(!D$&&b$.borderStyle.width>0){switch(b$.borderStyle.style){case m$.Dashed:gX.borderStyle="dashed";break;case m$.Solid:gX.borderStyle="solid";break;case m$.Underline:gX=Object.assign({borderBottomStyle:"solid"},gX);case m$.Beveled:case m$.Inset:}var DX=b$.borderStyle.width;gX.borderWidth="".concat(DX,"px"),b$.borderStyle.style!==m$.Underline&&(B9-=2*DX,HQ-=2*DX);var gK=b$.borderStyle,kq=gK.horizontalCornerRadius,_K=gK.verticalCornerRadius;(kq>0||_K>0)&&(gX.borderRadius="".concat(kq,"px / ").concat(_K,"px")),b$.color?gX.borderColor="rgb(".concat(0|b$.color[0],", ").concat(0|b$.color[1],", ").concat(0|b$.color[2],")"):gX.borderWidth="0"}return Et.createElement(Et.Fragment,null,W$&&E$({popup:{opened:NI,closeOnHover:mO,openOnHover:AI,toggleOnClick:J7},slot:{attrs:{style:Object.assign({height:"".concat(HQ,"px"),left:"".concat(_7[0],"px"),top:"".concat(_7[1],"px"),transform:"matrix(".concat(A$.transform.join(","),")"),transformOrigin:"-".concat(_7[0],"px -").concat(_7[1],"px"),width:"".concat(B9,"px")},gX)},children:Et.createElement(Et.Fragment,null,k$&&NI&&Et.createElement(GL,{annotation:b$}))}}))},r$=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$);return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(A$){return Et.createElement("div",Bt({},A$.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--caret","data-annotation-id":a$.id,onClick:A$.popup.toggleOnClick,onMouseEnter:A$.popup.openOnHover,onMouseLeave:A$.popup.closeOnHover}),A$.slot.children)})},O$=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$),A$=a$.rect,V$=A$[2]-A$[0],U$=A$[3]-A$[1],mO=a$.borderStyle.width;return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(NI){return Et.createElement("div",Bt({},NI.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--circle","data-annotation-id":a$.id,onClick:NI.popup.toggleOnClick,onMouseEnter:NI.popup.openOnHover,onMouseLeave:NI.popup.closeOnHover}),Et.createElement("svg",{height:"".concat(U$,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(V$," ").concat(U$),width:"".concat(V$,"px")},Et.createElement("circle",{cy:U$/2,fill:"none",rx:V$/2-mO/2,ry:U$/2-mO/2,stroke:"transparent",strokeWidth:mO||1})),NI.slot.children)})},Z$=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=I$(a$),k$=_$(a$),W$=!(a$.hasPopup!==!1||!D$&&!k$),z$=function(){var A$,V$,U$,mO,NI=a$.file;NI&&(A$=NI.filename,V$=NI.content,U$=typeof V$=="string"?"":URL.createObjectURL(new Blob([V$],{type:""})),(mO=document.createElement("a")).style.display="none",mO.href=U$||A$,mO.setAttribute("download",function(AI){var J7=AI.split("/").pop();return J7?J7.split("#")[0].split("?")[0]:AI}(A$)),document.body.appendChild(mO),mO.click(),document.body.removeChild(mO),U$&&URL.revokeObjectURL(U$))};return Et.createElement(B$,{annotation:a$,hasPopup:W$,ignoreBorder:!0,isRenderable:!0,page:b$,viewport:E$},function(A$){return Et.createElement("div",Bt({},A$.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--file-attachment","data-annotation-id":a$.id,onClick:A$.popup.toggleOnClick,onDoubleClick:z$,onMouseEnter:A$.popup.openOnHover,onMouseLeave:A$.popup.closeOnHover}),A$.slot.children)})},mL=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$);return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(A$){return Et.createElement("div",Bt({},A$.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--free-text","data-annotation-id":a$.id,onClick:A$.popup.toggleOnClick,onMouseEnter:A$.popup.openOnHover,onMouseLeave:A$.popup.closeOnHover}),A$.slot.children)})},P7=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=I$(a$),k$=_$(a$),W$=!(!D$&&!k$),z$=!a$.parentType||["Circle","Ink","Line","Polygon","PolyLine","Square"].indexOf(a$.parentType)!==-1;return Tr(function(){if(a$.parentId){var A$=document.querySelector('[data-annotation-id="'.concat(a$.parentId,'"]')),V$=document.querySelector('[data-annotation-id="'.concat(a$.id,'"]'));if(A$&&V$){var U$=parseFloat(A$.style.left),mO=parseFloat(A$.style.top)+parseFloat(A$.style.height);V$.style.left="".concat(U$,"px"),V$.style.top="".concat(mO,"px"),V$.style.transformOrigin="-".concat(U$,"px -").concat(mO,"px")}}},[]),Et.createElement(B$,{annotation:a$,hasPopup:z$,ignoreBorder:!1,isRenderable:W$,page:b$,viewport:E$},function(A$){return Et.createElement("div",Bt({},A$.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--popup","data-annotation-id":a$.id}),Et.createElement(GL,{annotation:a$}))})},L9=function(q1){var a$=q1.annotation,b$=q1.childAnnotation,E$=q1.page,D$=q1.viewport,k$=a$.hasPopup===!1,W$=I$(a$),z$=_$(a$),A$=!!(a$.hasPopup||W$||z$);if(a$.quadPoints&&a$.quadPoints.length>0){var V$=a$.quadPoints.map(function(U$){return Object.assign({},a$,{rect:[U$[2].x,U$[2].y,U$[1].x,U$[1].y],quadPoints:[]})});return Et.createElement(Et.Fragment,null,V$.map(function(U$,mO){return Et.createElement(L9,{key:mO,annotation:U$,childAnnotation:b$,page:E$,viewport:D$})}))}return Et.createElement(B$,{annotation:a$,hasPopup:k$,ignoreBorder:!0,isRenderable:A$,page:E$,viewport:D$},function(U$){return Et.createElement(Et.Fragment,null,Et.createElement("div",Bt({},U$.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--highlight","data-annotation-id":a$.id,onClick:U$.popup.toggleOnClick,onMouseEnter:U$.popup.openOnHover,onMouseLeave:U$.popup.closeOnHover}),U$.slot.children),b$&&b$.annotationType===nt.AnnotationType.Popup&&U$.popup.opened&&Et.createElement(P7,{annotation:b$,page:E$,viewport:D$}))})},f$=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$),A$=a$.rect,V$=A$[2]-A$[0],U$=A$[3]-A$[1],mO=a$.borderStyle.width;return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(NI){return Et.createElement("div",Bt({},NI.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--ink","data-annotation-id":a$.id,onClick:NI.popup.toggleOnClick,onMouseEnter:NI.popup.openOnHover,onMouseLeave:NI.popup.closeOnHover}),a$.inkLists&&a$.inkLists.length&&Et.createElement("svg",{height:"".concat(U$,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(V$," ").concat(U$),width:"".concat(V$,"px")},a$.inkLists.map(function(AI,J7){return Et.createElement("polyline",{key:J7,fill:"none",stroke:"transparent",strokeWidth:mO||1,points:AI.map(function(_7){return"".concat(_7.x-A$[0],",").concat(A$[3]-_7.y)}).join(" ")})})),NI.slot.children)})},l$=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$),A$=a$.rect,V$=A$[2]-A$[0],U$=A$[3]-A$[1],mO=a$.borderStyle.width;return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(NI){return Et.createElement("div",Bt({},NI.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--line","data-annotation-id":a$.id,onClick:NI.popup.toggleOnClick,onMouseEnter:NI.popup.openOnHover,onMouseLeave:NI.popup.closeOnHover}),Et.createElement("svg",{height:"".concat(U$,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(V$," ").concat(U$),width:"".concat(V$,"px")},Et.createElement("line",{stroke:"transparent",strokeWidth:mO||1,x1:A$[2]-a$.lineCoordinates[0],x2:A$[2]-a$.lineCoordinates[2],y1:A$[3]-a$.lineCoordinates[1],y2:A$[3]-a$.lineCoordinates[3]})),NI.slot.children)})},T$=/^([^\w]*)(javascript|data|vbscript)/im,q$=/&#(\w+)(^\w|;)?/g,Q$=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,gR=/^([^:]+):/gm,kI=function(q1,a$){var b$,E$=(b$=q1||"",b$.replace(q$,function(z$,A$){return String.fromCharCode(A$)})).replace(Q$,"").trim();if(!E$)return a$;var D$=E$[0];if(D$==="."||D$==="/")return E$;var k$=E$.match(gR);if(!k$)return E$;var W$=k$[0];return T$.test(W$)?a$:E$},Pq=function(q1){var a$,b$=q1.annotation,E$=q1.annotationContainerRef,D$=q1.doc,k$=q1.outlines,W$=q1.page,z$=q1.pageIndex,A$=q1.scale,V$=q1.viewport,U$=q1.onExecuteNamedAction,mO=q1.onJumpFromLinkAnnotation,NI=q1.onJumpToDest,AI=Et.useRef(),J7=k$&&k$.length&&b$.dest&&typeof b$.dest=="string"?(a$=k$.find(function(gX){return gX.dest===b$.dest}))===null||a$===void 0?void 0:a$.title:"",_7=!!(b$.url||b$.dest||b$.action||b$.unsafeUrl),B9={};if(b$.url||b$.unsafeUrl){var HQ=kI(b$.url||b$.unsafeUrl,"");HQ?B9={"data-target":"external",href:HQ,rel:"noopener noreferrer nofollow",target:b$.newWindow?"_blank":"",title:HQ}:_7=!1}else B9={href:"","data-annotation-link":b$.id,onClick:function(gX){gX.preventDefault(),b$.action?U$(b$.action):gD(D$,b$.dest).then(function(DX){var gK=AI.current,kq=E$.current;if(gK&&kq){var _K=gK.getBoundingClientRect();kq.style.setProperty("height","100%"),kq.style.setProperty("width","100%");var DY=kq.getBoundingClientRect();kq.style.removeProperty("height"),kq.style.removeProperty("width");var JQ=(_K.left-DY.left)/A$,ZQ=(DY.bottom-_K.bottom+_K.height)/A$;mO({bottomOffset:ZQ,label:J7,leftOffset:JQ,pageIndex:z$})}NI(DX)})}};return J7&&(B9=Object.assign({},B9,{title:J7,"aria-label":J7})),Et.createElement(B$,{annotation:b$,hasPopup:!1,ignoreBorder:!1,isRenderable:_7,page:W$,viewport:V$},function(gX){return Et.createElement("div",Bt({},gX.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--link","data-annotation-id":b$.id,"data-testid":"core__annotation--link-".concat(b$.id)}),Et.createElement("a",Bt({ref:AI},B9)))})},s$=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$),A$=a$.rect,V$=A$[2]-A$[0],U$=A$[3]-A$[1],mO=a$.borderStyle.width;return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(NI){return Et.createElement("div",Bt({},NI.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polygon","data-annotation-id":a$.id,onClick:NI.popup.toggleOnClick,onMouseEnter:NI.popup.openOnHover,onMouseLeave:NI.popup.closeOnHover}),a$.vertices&&a$.vertices.length&&Et.createElement("svg",{height:"".concat(U$,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(V$," ").concat(U$),width:"".concat(V$,"px")},Et.createElement("polygon",{fill:"none",stroke:"transparent",strokeWidth:mO||1,points:a$.vertices.map(function(AI){return"".concat(AI.x-A$[0],",").concat(A$[3]-AI.y)}).join(" ")})),NI.slot.children)})},C$=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$),A$=a$.rect,V$=A$[2]-A$[0],U$=A$[3]-A$[1],mO=a$.borderStyle.width;return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(NI){return Et.createElement("div",Bt({},NI.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polyline","data-annotation-id":a$.id,onClick:NI.popup.toggleOnClick,onMouseEnter:NI.popup.openOnHover,onMouseLeave:NI.popup.closeOnHover}),a$.vertices&&a$.vertices.length&&Et.createElement("svg",{height:"".concat(U$,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(V$," ").concat(U$),width:"".concat(V$,"px")},Et.createElement("polyline",{fill:"none",stroke:"transparent",strokeWidth:mO||1,points:a$.vertices.map(function(AI){return"".concat(AI.x-A$[0],",").concat(A$[3]-AI.y)}).join(" ")})),NI.slot.children)})},Y$=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$),A$=a$.rect,V$=A$[2]-A$[0],U$=A$[3]-A$[1],mO=a$.borderStyle.width;return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(NI){return Et.createElement("div",Bt({},NI.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--square","data-annotation-id":a$.id,onClick:NI.popup.toggleOnClick,onMouseEnter:NI.popup.openOnHover,onMouseLeave:NI.popup.closeOnHover}),Et.createElement("svg",{height:"".concat(U$,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(V$," ").concat(U$),width:"".concat(V$,"px")},Et.createElement("rect",{height:U$-mO,fill:"none",stroke:"transparent",strokeWidth:mO||1,x:mO/2,y:mO/2,width:V$-mO})),NI.slot.children)})},P$=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$);return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(A$){return Et.createElement("div",Bt({},A$.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--squiggly","data-annotation-id":a$.id,onClick:A$.popup.toggleOnClick,onMouseEnter:A$.popup.openOnHover,onMouseLeave:A$.popup.closeOnHover}),A$.slot.children)})},N$=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$);return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(A$){return Et.createElement("div",Bt({},A$.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--stamp","data-annotation-id":a$.id,onClick:A$.popup.toggleOnClick,onMouseEnter:A$.popup.openOnHover,onMouseLeave:A$.popup.closeOnHover}),A$.slot.children)})},H3=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$);return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(A$){return Et.createElement("div",Bt({},A$.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--strike-out","data-annotation-id":a$.id,onClick:A$.popup.toggleOnClick,onMouseEnter:A$.popup.openOnHover,onMouseLeave:A$.popup.closeOnHover}),A$.slot.children)})},D7=function(){return Et.createElement(Fr,{size:16},Et.createElement("path",{d:"M.5,16.5a1,1,0,0,0,1,1h2v4l4-4h15a1,1,0,0,0,1-1V3.5a1,1,0,0,0-1-1H1.5a1,1,0,0,0-1,1Z"}),Et.createElement("path",{d:"M7.25,9.75A.25.25,0,1,1,7,10a.25.25,0,0,1,.25-.25"}),Et.createElement("path",{d:"M12,9.75a.25.25,0,1,1-.25.25A.25.25,0,0,1,12,9.75"}),Et.createElement("path",{d:"M16.75,9.75a.25.25,0,1,1-.25.25.25.25,0,0,1,.25-.25"}))},Tq=function(){return Et.createElement(Fr,{size:16},Et.createElement("path",{d:"M0.500 12.001 A11.500 11.500 0 1 0 23.500 12.001 A11.500 11.500 0 1 0 0.500 12.001 Z"}),Et.createElement("path",{d:"M6.000 12.001 A6.000 6.000 0 1 0 18.000 12.001 A6.000 6.000 0 1 0 6.000 12.001 Z"}),Et.createElement("path",{d:"M21.423 5.406L17.415 9.414"}),Et.createElement("path",{d:"M14.587 6.585L18.607 2.565"}),Et.createElement("path",{d:"M5.405 21.424L9.413 17.416"}),Et.createElement("path",{d:"M6.585 14.588L2.577 18.596"}),Et.createElement("path",{d:"M18.602 21.419L14.595 17.412"}),Et.createElement("path",{d:"M17.419 14.58L21.428 18.589"}),Et.createElement("path",{d:"M2.582 5.399L6.588 9.406"}),Et.createElement("path",{d:"M9.421 6.581L5.412 2.572"}))},Cq=function(){return Et.createElement(Fr,{size:16},Et.createElement("path",{d:"M4.000 18.500 A1.500 1.500 0 1 0 7.000 18.500 A1.500 1.500 0 1 0 4.000 18.500 Z"}),Et.createElement("path",{d:"M20.5.5l-9.782,9.783a7,7,0,1,0,3,3L17,10h1.5V8.5L19,8h1.5V6.5L21,6h1.5V4.5l1-1V.5Z"}))},PK=function(){return Et.createElement(Fr,{size:16},Et.createElement("path",{d:"M2.000 2.500 L22.000 2.500 L22.000 23.500 L2.000 23.500 Z"}),Et.createElement("path",{d:"M6 4.5L6 0.5"}),Et.createElement("path",{d:"M18 4.5L18 0.5"}),Et.createElement("path",{d:"M10 4.5L10 0.5"}),Et.createElement("path",{d:"M14 4.5L14 0.5"}))},Nq=function(){return Et.createElement(Fr,{size:16},Et.createElement("path",{d:"M17.5 0.498L17.5 23.498"}),Et.createElement("path",{d:"M10.5 0.498L10.5 23.498"}),Et.createElement("path",{d:"M23.5.5H6.5a6,6,0,0,0,0,12h4"}))},DK=function(){return Et.createElement(Fr,{size:16},Et.createElement("path",{d:"M2.5 22.995L12 6.005 21.5 22.995 2.5 22.995z"}))},yK=function(q1){var a$=q1.annotation,b$=q1.childAnnotation,E$=q1.page,D$=q1.viewport,k$=a$.hasPopup===!1,W$=I$(a$),z$=_$(a$),A$=!!(a$.hasPopup||W$||z$),V$=a$.name?a$.name.toLowerCase():"";return Et.createElement(B$,{annotation:a$,hasPopup:k$,ignoreBorder:!1,isRenderable:A$,page:E$,viewport:D$},function(U$){return Et.createElement(Et.Fragment,null,Et.createElement("div",Bt({},U$.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--text","data-annotation-id":a$.id,onClick:U$.popup.toggleOnClick,onMouseEnter:U$.popup.openOnHover,onMouseLeave:U$.popup.closeOnHover}),V$&&Et.createElement("div",{className:"rpv-core__annotation-text-icon"},V$==="check"&&Et.createElement(Nr,null),V$==="comment"&&Et.createElement(D7,null),V$==="help"&&Et.createElement(Tq,null),V$==="insert"&&Et.createElement(DK,null),V$==="key"&&Et.createElement(Cq,null),V$==="note"&&Et.createElement(PK,null),(V$==="newparagraph"||V$==="paragraph")&&Et.createElement(Nq,null)),U$.slot.children),b$&&b$.annotationType===nt.AnnotationType.Popup&&U$.popup.opened&&Et.createElement(P7,{annotation:b$,page:E$,viewport:D$}))})},hee=function(q1){var a$=q1.annotation,b$=q1.page,E$=q1.viewport,D$=a$.hasPopup===!1,k$=I$(a$),W$=_$(a$),z$=!!(a$.hasPopup||k$||W$);return Et.createElement(B$,{annotation:a$,hasPopup:D$,ignoreBorder:!0,isRenderable:z$,page:b$,viewport:E$},function(A$){return Et.createElement("div",Bt({},A$.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--underline","data-annotation-id":a$.id,onClick:A$.popup.toggleOnClick,onMouseEnter:A$.popup.openOnHover,onMouseLeave:A$.popup.closeOnHover}),A$.slot.children)})},Cee=function(q1){var a$=q1.annotations,b$=q1.doc,E$=q1.outlines,D$=q1.page,k$=q1.pageIndex,W$=q1.plugins,z$=q1.rotation,A$=q1.scale,V$=q1.onExecuteNamedAction,U$=q1.onJumpFromLinkAnnotation,mO=q1.onJumpToDest,NI=Et.useRef(),AI=D$.getViewport({rotation:z$,scale:A$}).clone({dontFlip:!0}),J7=a$.filter(function(_7){return!_7.parentId});return Tr(function(){var _7=NI.current;_7&&W$.forEach(function(B9){B9.onAnnotationLayerRender&&B9.onAnnotationLayerRender({annotations:J7,container:_7,pageIndex:k$,rotation:z$,scale:A$})})},[]),Et.createElement("div",{ref:NI,className:"rpv-core__annotation-layer","data-testid":"core__annotation-layer-".concat(k$)},J7.map(function(_7){var B9=a$.find(function(HQ){return HQ.parentId===_7.id});switch(_7.annotationType){case nt.AnnotationType.Caret:return Et.createElement(r$,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.Circle:return Et.createElement(O$,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.FileAttachment:return Et.createElement(Z$,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.FreeText:return Et.createElement(mL,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.Highlight:return Et.createElement(L9,{key:_7.id,annotation:_7,childAnnotation:B9,page:D$,viewport:AI});case nt.AnnotationType.Ink:return Et.createElement(f$,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.Line:return Et.createElement(l$,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.Link:return Et.createElement(Pq,{key:_7.id,annotation:_7,annotationContainerRef:NI,doc:b$,outlines:E$,page:D$,pageIndex:k$,scale:A$,viewport:AI,onExecuteNamedAction:V$,onJumpFromLinkAnnotation:U$,onJumpToDest:mO});case nt.AnnotationType.Polygon:return Et.createElement(s$,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.Polyline:return Et.createElement(C$,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.Popup:return Et.createElement(P7,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.Square:return Et.createElement(Y$,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.Squiggly:return Et.createElement(P$,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.Stamp:return Et.createElement(N$,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.StrikeOut:return Et.createElement(H3,{key:_7.id,annotation:_7,page:D$,viewport:AI});case nt.AnnotationType.Text:return Et.createElement(yK,{key:_7.id,annotation:_7,childAnnotation:B9,page:D$,viewport:AI});case nt.AnnotationType.Underline:return Et.createElement(hee,{key:_7.id,annotation:_7,page:D$,viewport:AI});default:return Et.createElement(Et.Fragment,{key:_7.id})}}))},Oee=function(q1){var a$=q1.page,b$=q1.renderAnnotations,E$=p0(),D$=Et.useState({loading:!0,annotations:[]}),k$=D$[0],W$=D$[1];return Et.useEffect(function(){a$.getAnnotations({intent:"display"}).then(function(z$){E$.current&&W$({loading:!1,annotations:z$})})},[]),k$.loading?Et.createElement(Et.Fragment,null):b$(k$.annotations)},fee=function(q1){var a$=q1.doc,b$=q1.outlines,E$=q1.page,D$=q1.pageIndex,k$=q1.plugins,W$=q1.rotation,z$=q1.scale,A$=q1.onExecuteNamedAction,V$=q1.onJumpFromLinkAnnotation,U$=q1.onJumpToDest;return Et.createElement(Oee,{page:E$,renderAnnotations:function(mO){return Et.createElement(Cee,{annotations:mO,doc:a$,outlines:b$,page:E$,pageIndex:D$,plugins:k$,rotation:W$,scale:z$,onExecuteNamedAction:A$,onJumpFromLinkAnnotation:V$,onJumpToDest:U$})}})},GQ=function(q1,a$){var b$=q1%a$;return b$===0?q1:Math.floor(q1-b$)},Tee=function(q1){var a$=q1.canvasLayerRef,b$=q1.height,E$=q1.page,D$=q1.pageIndex,k$=q1.plugins,W$=q1.rotation,z$=q1.scale,A$=q1.width,V$=q1.onRenderCanvasCompleted,U$=Et.useRef();return Tr(function(){var mO=U$.current;mO&&mO.cancel();var NI=a$.current;NI.removeAttribute("data-testid"),k$.forEach(function(DY){DY.onCanvasLayerRender&&DY.onCanvasLayerRender({ele:NI,pageIndex:D$,rotation:W$,scale:z$,status:nt.LayerRenderStatus.PreRender})});var AI=E$.getViewport({rotation:W$,scale:z$}),J7=window.devicePixelRatio||1,_7=Math.sqrt(16777216/(AI.width*AI.height)),B9=J7>_7;B9?NI.style.transform="scale(1, 1)":NI.style.removeProperty("transform");var HQ=Math.min(_7,J7),gX=function(DY,JQ){var ZQ,eee;if(Math.floor(DY)===DY)return[DY,1];var tee=1/DY;if(tee>JQ)return[1,JQ];if(Math.floor(tee)===tee)return[1,tee];for(var ree=DY>1?tee:DY,xee=0,dee=1,bee=1,mee=1;;){var vee=xee+bee,yee=dee+mee;if(yee>JQ)break;ree<=vee/yee?(bee=(ZQ=[vee,yee])[0],mee=ZQ[1]):(xee=(eee=[vee,yee])[0],dee=eee[1])}return ree<(xee/dee+bee/mee)/2?ree===DY?[xee,dee]:[dee,xee]:ree===DY?[bee,mee]:[mee,bee]}(HQ,8),DX=gX[0],gK=gX[1];NI.width=GQ(AI.width*HQ,DX),NI.height=GQ(AI.height*HQ,DX),NI.style.width="".concat(GQ(AI.width,gK),"px"),NI.style.height="".concat(GQ(AI.height,gK),"px"),NI.hidden=!0;var kq=NI.getContext("2d",{alpha:!1}),_K=B9||J7!==1?[HQ,0,0,HQ,0,0]:null;return U$.current=E$.render({canvasContext:kq,transform:_K,viewport:AI}),U$.current.promise.then(function(){NI.hidden=!1,NI.setAttribute("data-testid","core__canvas-layer-".concat(D$)),k$.forEach(function(DY){DY.onCanvasLayerRender&&DY.onCanvasLayerRender({ele:NI,pageIndex:D$,rotation:W$,scale:z$,status:nt.LayerRenderStatus.DidRender})}),V$()},function(){V$()}),function(){NI&&(NI.width=0,NI.height=0)}},[]),Et.createElement("div",{className:"rpv-core__canvas-layer",style:{height:"".concat(b$,"px"),width:"".concat(A$,"px")}},Et.createElement("canvas",{ref:a$}))},YQ=function(q1){var a$=q1.height,b$=q1.page,E$=q1.rotation,D$=q1.scale,k$=q1.width,W$=Et.useRef();return Tr(function(){var z$=W$.current,A$=b$.getViewport({rotation:E$,scale:D$});b$.getOperatorList().then(function(V$){(function(){var U$=W$.current;U$&&(U$.innerHTML="")})(),new At.SVGGraphics(b$.commonObjs,b$.objs).getSVG(V$,A$).then(function(U$){U$.style.height="".concat(a$,"px"),U$.style.width="".concat(k$,"px"),z$.appendChild(U$)})})},[]),Et.createElement("div",{className:"rpv-core__svg-layer",ref:W$})},kee=function(q1){var a$=q1.containerRef,b$=q1.page,E$=q1.pageIndex,D$=q1.plugins,k$=q1.rotation,W$=q1.scale,z$=q1.onRenderTextCompleted,A$=Et.useRef(),V$=function(){var U$=a$.current;U$&&([].slice.call(U$.querySelectorAll(".rpv-core__text-layer-text")).forEach(function(mO){return U$.removeChild(mO)}),[].slice.call(U$.querySelectorAll('br[role="presentation"]')).forEach(function(mO){return U$.removeChild(mO)}))};return Tr(function(){var U$=A$.current;U$&&U$.cancel();var mO=a$.current;if(mO){mO.removeAttribute("data-testid");var NI=b$.getViewport({rotation:k$,scale:W$});return D$.forEach(function(AI){AI.onTextLayerRender&&AI.onTextLayerRender({ele:mO,pageIndex:E$,scale:W$,status:nt.LayerRenderStatus.PreRender})}),b$.getTextContent().then(function(AI){V$(),A$.current=At.renderTextLayer({container:mO,textContent:AI,textContentSource:AI,viewport:NI}),A$.current.promise.then(function(){mO.setAttribute("data-testid","core__text-layer-".concat(E$)),[].slice.call(mO.children).forEach(function(J7){J7.classList.contains("rpv-core__text-layer-text--not")||J7.classList.add("rpv-core__text-layer-text")}),D$.forEach(function(J7){J7.onTextLayerRender&&J7.onTextLayerRender({ele:mO,pageIndex:E$,scale:W$,status:nt.LayerRenderStatus.DidRender})}),z$()},function(){mO.removeAttribute("data-testid"),z$()})}),function(){var AI;V$(),(AI=A$.current)===null||AI===void 0||AI.cancel()}}},[]),Et.createElement("div",{className:"rpv-core__text-layer",ref:a$})},Nee=function(q1){var a$=q1.doc,b$=q1.measureRef,E$=q1.outlines,D$=q1.pageIndex,k$=q1.pageRotation,W$=q1.pageSize,z$=q1.plugins,A$=q1.renderPage,V$=q1.renderQueueKey,U$=q1.rotation,mO=q1.scale,NI=q1.shouldRender,AI=q1.viewMode,J7=q1.onExecuteNamedAction,_7=q1.onJumpFromLinkAnnotation,B9=q1.onJumpToDest,HQ=q1.onRenderCompleted,gX=q1.onRotatePage,DX=p0(),gK=Et.useState(null),kq=gK[0],_K=gK[1],DY=Et.useState(!1),JQ=DY[0],ZQ=DY[1],eee=Et.useState(!1),tee=eee[0],ree=eee[1],xee=Et.useRef(),dee=Et.useRef(),bee=Math.abs(U$+k$)%180==0,mee=W$.pageWidth*mO,vee=W$.pageHeight*mO,yee=bee?mee:vee,gee=bee?vee:mee,Mee=(W$.rotation+U$+k$)%360,jee=Et.useRef(0),Fee=A$||function(_ee){return Et.createElement(Et.Fragment,null,_ee.canvasLayer.children,_ee.textLayer.children,_ee.annotationLayer.children)};return Et.useEffect(function(){_K(null),ZQ(!1),ree(!1)},[k$,U$,mO]),Et.useEffect(function(){NI&&DX.current&&!kq&&J$(a$,D$).then(function(_ee){DX.current&&(jee.current=V$,_K(_ee))})},[NI,kq]),Et.useEffect(function(){JQ&&tee&&(V$!==jee.current?(_K(null),ZQ(!1),ree(!1)):HQ(D$))},[JQ,tee]),Et.createElement("div",{className:Mr({"rpv-core__page-layer":!0,"rpv-core__page-layer--dual":AI===nt.ViewMode.DualPage,"rpv-core__page-layer--dual-cover":AI===nt.ViewMode.DualPageWithCover,"rpv-core__page-layer--single":AI===nt.ViewMode.SinglePage}),"data-testid":"core__page-layer-".concat(D$),ref:b$,style:{height:"".concat(gee,"px"),width:"".concat(yee,"px")}},kq?Et.createElement(Et.Fragment,null,Fee({annotationLayer:{attrs:{},children:Et.createElement(fee,{doc:a$,outlines:E$,page:kq,pageIndex:D$,plugins:z$,rotation:Mee,scale:mO,onExecuteNamedAction:J7,onJumpFromLinkAnnotation:_7,onJumpToDest:B9})},canvasLayer:{attrs:{},children:Et.createElement(Tee,{canvasLayerRef:xee,height:gee,page:kq,pageIndex:D$,plugins:z$,rotation:Mee,scale:mO,width:yee,onRenderCanvasCompleted:function(){DX.current&&ZQ(!0)}})},canvasLayerRendered:JQ,doc:a$,height:gee,pageIndex:D$,rotation:Mee,scale:mO,svgLayer:{attrs:{},children:Et.createElement(YQ,{height:gee,page:kq,rotation:Mee,scale:mO,width:yee})},textLayer:{attrs:{},children:Et.createElement(kee,{containerRef:dee,page:kq,pageIndex:D$,plugins:z$,rotation:Mee,scale:mO,onRenderTextCompleted:function(){DX.current&&ree(!0)}})},textLayerRendered:tee,width:yee,markRendered:HQ,onRotatePage:function(_ee){return gX(D$,_ee)}}),z$.map(function(_ee,Pee){return _ee.renderPageLayer?Et.createElement(Et.Fragment,{key:Pee},_ee.renderPageLayer({canvasLayerRef:xee,canvasLayerRendered:JQ,doc:a$,height:gee,pageIndex:D$,rotation:Mee,scale:mO,textLayerRef:dee,textLayerRendered:tee,width:yee})):Et.createElement(Et.Fragment,{key:Pee})})):Et.createElement(rn,{testId:"core__page-layer-loading-".concat(D$)}))},zee=function(q1,a$){var b$=a$.rect;return q1.height!==b$.height||q1.width!==b$.width?b$:q1};(function(q1){q1.Horizontal="Horizontal",q1.Vertical="Vertical",q1.Both="Both"})(w$||(w$={}));var Ree=function(q1){return 1-Math.pow(1-q1,4)},AA=1e-4,c$={left:0,top:0},$$={capture:!1,passive:!0},p$=function(q1){var a$=q1.elementRef,b$=q1.enableSmoothScroll,E$=q1.isRtl,D$=q1.scrollDirection,k$=q1.onSmoothScroll,W$=Et.useState(c$),z$=W$[0],A$=W$[1],V$=Et.useState(a$.current),U$=V$[0],mO=V$[1],NI=E$?-1:1,AI=Et.useRef(D$);AI.current=D$;var J7=Et.useRef(c$),_7=Et.useRef(!0),B9=Et.useCallback(function(){_7.current=!0,b$&&A$(J7.current),k$(!1)},[]),HQ=Et.useCallback(function(){if(U$){switch(AI.current){case w$.Horizontal:J7.current={left:NI*U$.scrollLeft,top:0};break;case w$.Both:J7.current={left:NI*U$.scrollLeft,top:U$.scrollTop};break;case w$.Vertical:default:J7.current={left:0,top:U$.scrollTop}}b$&&!_7.current||A$(J7.current)}},[U$]);Tr(function(){mO(a$.current)}),Tr(function(){if(U$)return U$.addEventListener("scroll",HQ,$$),function(){U$.removeEventListener("scroll",HQ,$$)}},[U$]);var gX=Et.useCallback(function(DX,gK){var kq=a$.current;if(!kq)return Promise.resolve();var _K={left:0,top:0};switch(AI.current){case w$.Horizontal:_K.left=NI*DX.left;break;case w$.Both:_K.left=NI*DX.left,_K.top=DX.top;break;case w$.Vertical:default:_K.top=DX.top}return gK?(_7.current=!1,k$(!0),new Promise(function(DY,JQ){(function(ZQ,eee,tee,ree,xee,dee){xee===void 0&&(xee=function(Pee){return Pee}),dee===void 0&&(dee=function(){});var bee=0,mee=0,vee=!1;switch(eee){case w$.Horizontal:mee=ZQ.scrollLeft,bee=0;case w$.Both:mee=ZQ.scrollLeft,bee=ZQ.scrollTop;break;case w$.Vertical:default:mee=0,bee=ZQ.scrollTop}var yee=function(){vee||(vee=!0,ZQ.scrollLeft=tee.left,ZQ.scrollTop=tee.top,dee())};if(Math.abs(bee-tee.top)<=AA&&eee===w$.Vertical)yee();else if(Math.abs(mee-tee.left)<=AA&&eee===w$.Horizontal)yee();else{var gee,Mee=-1,jee=mee-tee.left,Fee=bee-tee.top,_ee=function(Pee){Mee===-1&&(Mee=Pee);var Bee=Pee-Mee,IY=Math.min(Bee/ree,1),IX=xee(IY),Lq={left:mee-jee*IX,top:bee-Fee*IX};switch(eee){case w$.Horizontal:ZQ.scrollLeft=Lq.left;break;case w$.Both:ZQ.scrollLeft=Lq.left,ZQ.scrollTop=Lq.top;break;case w$.Vertical:default:ZQ.scrollTop=Lq.top}Math.abs(Lq.top-tee.top)<=AA&&Math.abs(Lq.left-tee.left)<=AA&&!vee&&(window.cancelAnimationFrame(gee),yee()),Bee<ree?gee=window.requestAnimationFrame(_ee):window.cancelAnimationFrame(gee)};gee=window.requestAnimationFrame(_ee)}})(kq,AI.current,_K,400,Ree,function(){B9(),DY()})})):new Promise(function(DY,JQ){switch(AI.current){case w$.Horizontal:kq.scrollLeft=_K.left;break;case w$.Both:kq.scrollLeft=_K.left,kq.scrollTop=_K.top;break;case w$.Vertical:default:kq.scrollTop=_K.top}DY()})},[a$]);return{scrollOffset:z$,scrollTo:gX}},H$=function(q1,a$,b$){return Math.max(q1,Math.min(b$,a$))},Q9=function(q1,a$){if(a$!==nt.ViewMode.DualPageWithCover)return 0;if(!function(D$){var k$=D$.length;if(k$===1)return!1;for(var W$=1;W$<k$;W$++)if(D$[W$].height!==D$[0].height||D$[W$].width!==D$[0].width)return!0;return!1}(q1))return 2*q1[0].width;var b$=u$(q1.slice(1),2).map(function(D$){return D$.length===2?D$[0].width+D$[1].width:D$[0].width}),E$=[q1[0].width].concat(b$);return Math.max.apply(Math,E$)},Lee={left:0,top:0},lte={left:0,top:0},Vee={left:0,top:0},cte={left:0,top:0},Zee={height:0,width:0},Jee={left:0,top:0},$ie="data-virtual-index",Cre=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],Mre=function(q1){var a$=q1.enableSmoothScroll,b$=q1.isRtl,E$=q1.numberOfItems,D$=q1.parentRef,k$=q1.setRenderRange,W$=q1.sizes,z$=q1.scrollMode,A$=q1.viewMode,V$=Et.useState(!1),U$=V$[0],mO=V$[1],NI=Et.useCallback(function(IY){return mO(IY)},[]),AI=Et.useRef(z$);AI.current=z$;var J7=Et.useRef(A$);J7.current=A$;var _7=z$===nt.ScrollMode.Wrapped||A$===nt.ViewMode.DualPageWithCover||A$===nt.ViewMode.DualPage?w$.Both:z$===nt.ScrollMode.Horizontal?w$.Horizontal:w$.Vertical,B9=p$({elementRef:D$,enableSmoothScroll:a$,isRtl:b$,scrollDirection:_7,onSmoothScroll:NI}),HQ=B9.scrollOffset,gX=B9.scrollTo,DX=function(IY){var IX=IY.elementRef,Lq=Et.useState(IX.current),Bq=Lq[0],Fq=Lq[1],CK=Et.useRef(!1),TK=Et.useReducer(zee,{height:0,width:0}),Vq=TK[0],Rq=TK[1];return Tr(function(){IX.current!==Bq&&Fq(IX.current)}),Tr(function(){if(Bq&&!CK.current){CK.current=!0;var zQ=Bq.getBoundingClientRect(),XQ=zQ.height,cee=zQ.width;Rq({rect:{height:XQ,width:cee}})}},[Bq]),Et.useEffect(function(){if(Bq){var zQ=new ResizeObserver(function(XQ,cee){XQ.forEach(function(see){if(see.target===Bq){var Eee=see.contentRect,$ee=Eee.height,jQ=Eee.width;Rq({rect:{height:$ee,width:jQ}})}})});return zQ.observe(Bq),function(){zQ.unobserve(Bq)}}},[Bq]),Vq}({elementRef:D$}),gK=Et.useRef({scrollOffset:Jee,measurements:[]});gK.current.scrollOffset=HQ;var kq=Et.useMemo(function(){return Array(E$).fill(-1)},[]),_K=Et.useState(kq),DY=_K[0],JQ=_K[1],ZQ=Et.useMemo(function(){var IY=new IntersectionObserver(function(IX){IX.forEach(function(Lq){var Bq=Lq.isIntersecting?Lq.intersectionRatio:-1,Fq=Lq.target.getAttribute($ie);if(Fq){var CK=parseInt(Fq,10);0<=CK&&CK<E$&&JQ(function(TK){return TK[CK]=Bq,function(Vq,Rq,zQ){for(var XQ,cee=0,see=Rq.length;cee<see;cee++)!XQ&&cee in Rq||(XQ||(XQ=Array.prototype.slice.call(Rq,0,cee)),XQ[cee]=Rq[cee]);return Vq.concat(XQ||Array.prototype.slice.call(Rq))}([],TK)})}})},{threshold:Cre});return IY},[]),eee=Et.useMemo(function(){return z$===nt.ScrollMode.Page&&A$===nt.ViewMode.SinglePage?function(IY,IX,Lq){for(var Bq=[],Fq=0;Fq<IY;Fq++){var CK={height:Math.max(IX.height,Lq[Fq].height),width:Math.max(IX.width,Lq[Fq].width)},TK=Fq===0?cte:Bq[Fq-1].end,Vq={left:TK.left+CK.width,top:TK.top+CK.height};Bq[Fq]={index:Fq,start:TK,size:CK,end:Vq,visibility:-1}}return Bq}(E$,DX,W$):A$===nt.ViewMode.DualPageWithCover?function(IY,IX,Lq,Bq){for(var Fq=[],CK=0,TK=0,Vq=Vee,Rq=0;Rq<IY;Rq++){var zQ=Rq===0?{height:Bq===nt.ScrollMode.Page?Math.max(IX.height,Lq[Rq].height):Lq[Rq].height,width:Bq===nt.ScrollMode.Page?Math.max(IX.width,Lq[Rq].width):Lq[Rq].width}:{height:Bq===nt.ScrollMode.Page?Math.max(IX.height,Lq[Rq].height):Lq[Rq].height,width:Math.max(IX.width/2,Lq[Rq].width)};Bq===nt.ScrollMode.Page?Vq=Rq===0?Vee:{left:Rq%2==0?zQ.width:0,top:Math.floor((Rq-1)/2)*zQ.height+Fq[0].end.top}:Rq===0?(Vq=Vee,CK=Lq[0].height,TK=0):Rq%2==1?(Vq={left:0,top:CK+=TK},TK=Rq===IY-1?Lq[Rq].height:Math.max(Lq[Rq].height,Lq[Rq+1].height)):Vq={left:Fq[Rq-1].end.left,top:CK};var XQ={left:Vq.left+zQ.width,top:Vq.top+zQ.height};Fq[Rq]={index:Rq,start:Vq,size:zQ,end:XQ,visibility:-1}}return Fq}(E$,DX,W$,z$):A$===nt.ViewMode.DualPage?function(IY,IX,Lq,Bq){for(var Fq=[],CK=0,TK=0,Vq=lte,Rq=0;Rq<IY;Rq++){var zQ={height:Bq===nt.ScrollMode.Page?Math.max(IX.height,Lq[Rq].height):Lq[Rq].height,width:Math.max(IX.width/2,Lq[Rq].width)};Bq===nt.ScrollMode.Page?Vq={left:Rq%2==0?0:zQ.width,top:Math.floor(Rq/2)*zQ.height}:Rq%2==0?(Vq={left:0,top:CK+=TK},TK=Rq===IY-1?Lq[Rq].height:Math.max(Lq[Rq].height,Lq[Rq+1].height)):Vq={left:Fq[Rq-1].end.left,top:CK};var XQ={left:Vq.left+zQ.width,top:Vq.top+zQ.height};Fq[Rq]={index:Rq,start:Vq,size:zQ,end:XQ,visibility:-1}}return Fq}(E$,DX,W$,z$):function(IY,IX,Lq,Bq){for(var Fq=[],CK=0,TK={left:0,top:0},Vq=0,Rq=Lee,zQ=0;zQ<IY;zQ++){var XQ=Lq[zQ];if(zQ===0)CK=XQ.width,TK={left:0,top:0},Vq=XQ.height;else switch(Bq){case nt.ScrollMode.Wrapped:(CK+=XQ.width)<IX.width?(Rq={left:Fq[zQ-1].end.left,top:TK.top},Vq=Math.max(Vq,XQ.height)):(CK=XQ.width,TK={left:(Rq={left:TK.left,top:TK.top+Vq}).left,top:Rq.top},Vq=XQ.height);break;case nt.ScrollMode.Horizontal:case nt.ScrollMode.Vertical:default:Rq=Fq[zQ-1].end}var cee={left:Rq.left+XQ.width,top:Rq.top+XQ.height};Fq[zQ]={index:zQ,start:Rq,size:XQ,end:cee,visibility:-1}}return Fq}(E$,DX,W$,z$)},[z$,W$,A$,DX]),tee=eee[E$-1]?{height:eee[E$-1].end.top,width:eee[E$-1].end.left}:Zee;gK.current.measurements=eee;var ree=Et.useMemo(function(){var IY=function(zQ,XQ,cee,see){var Eee=0;switch(zQ){case w$.Horizontal:Eee=see.left;break;case w$.Vertical:default:Eee=see.top}var $ee=XQ.length-1,jQ=function(aee,Hee,tte,bte){for(;aee<=Hee;){var Yee=(aee+Hee)/2|0,ute=bte(Yee);if(ute<tte)aee=Yee+1;else{if(!(ute>tte))return Yee;Hee=Yee-1}}return aee>0?aee-1:0}(0,$ee,Eee,function(aee){switch(zQ){case w$.Horizontal:return XQ[aee].start.left;case w$.Both:case w$.Vertical:default:return XQ[aee].start.top}});if(zQ===w$.Both)for(var Aee=XQ[jQ].start.top;jQ-1>=0&&XQ[jQ-1].start.top===Aee&&XQ[jQ-1].start.left>=see.left;)jQ--;for(var uee=jQ;uee<=$ee;){var pee={top:XQ[uee].start.top-see.top,left:XQ[uee].start.left-see.left},wee={height:cee.height-pee.top,width:cee.width-pee.left};if(zQ===w$.Horizontal&&wee.width<0||zQ===w$.Vertical&&wee.height<0||zQ===w$.Both&&(wee.width<0||wee.height<0))break;uee++}return{start:jQ,end:uee}}(_7,eee,DX,HQ),IX=IY.start,Lq=IY.end,Bq=DY.slice(H$(0,E$,IX),H$(0,E$,Lq)),Fq=IX+Bq.reduce(function(zQ,XQ,cee,see){return XQ>see[zQ]?cee:zQ},0),CK=Fq=H$(0,E$-1,Fq),TK=k$({endPage:Lq,numPages:E$,startPage:IX}),Vq=TK.startPage,Rq=TK.endPage;switch(Vq=Math.max(Vq,0),Rq=Math.min(Rq,E$-1),A$){case nt.ViewMode.DualPageWithCover:Fq>0&&(CK=Fq%2==1?Fq:Fq-1),Vq=Vq===0?0:Vq%2==1?Vq:Vq-1,E$-(Rq=Rq%2==1?Rq-1:Rq)<=2&&(Rq=E$-1);break;case nt.ViewMode.DualPage:CK=Fq%2==0?Fq:Fq-1,Vq=Vq%2==0?Vq:Vq-1,Rq=Rq%2==1?Rq:Rq-1;break;case nt.ViewMode.SinglePage:default:CK=Fq}return{startPage:Vq,endPage:Rq,maxVisbilityIndex:CK}},[eee,DX,HQ,A$,DY]),xee=ree.startPage,dee=ree.endPage,bee=ree.maxVisbilityIndex,mee=Et.useMemo(function(){for(var IY=[],IX=function(Bq){var Fq=eee[Bq],CK=Bt(Bt({},Fq),{visibility:DY[Bq]!==void 0?DY[Bq]:-1,measureRef:function(TK){TK&&(TK.setAttribute($ie,"".concat(Bq)),ZQ.observe(TK))}});IY.push(CK)},Lq=xee;Lq<=dee;Lq++)IX(Lq);return IY},[xee,dee,DY,eee]),vee=Et.useCallback(function(IY,IX){var Lq=gK.current.measurements[H$(0,E$-1,IY)],Bq=AI.current===nt.ScrollMode.Page?Jee:IX;return Lq?gX({left:Bq.left+Lq.start.left,top:Bq.top+Lq.start.top},a$):Promise.resolve()},[gX,a$]),yee=Et.useCallback(function(IY,IX){var Lq=gK.current.measurements,Bq=Lq[IY].start,Fq=Lq.find(function(TK){return TK.start.top-Bq.top>1e-12});if(!Fq)return Promise.resolve();var CK=Fq.index;switch(J7.current){case nt.ViewMode.DualPage:CK=CK%2==0?CK:CK+1;break;case nt.ViewMode.DualPageWithCover:CK=CK%2==1?CK:CK+1}return vee(CK,IX)},[]),gee=Et.useCallback(function(IY,IX){for(var Lq=gK.current.measurements,Bq=Lq[IY].start,Fq=IY,CK=!1,TK=E$-1;TK>=0;TK--)if(Bq.top-Lq[TK].start.top>1e-12){CK=!0,Fq=Lq[TK].index;break}if(!CK)return Promise.resolve();switch(J7.current){case nt.ViewMode.DualPage:Fq=Fq%2==0?Fq:Fq-1;break;case nt.ViewMode.DualPageWithCover:Fq=Fq%2==0?Fq-1:Fq}return Fq===IY&&(Fq=IY-1),vee(Fq,IX)},[]),Mee=Et.useCallback(function(IY,IX){if(J7.current===nt.ViewMode.DualPageWithCover||J7.current===nt.ViewMode.DualPage)return yee(IY,IX);switch(AI.current){case nt.ScrollMode.Wrapped:return yee(IY,IX);case nt.ScrollMode.Horizontal:case nt.ScrollMode.Vertical:default:return vee(IY+1,IX)}},[]),jee=Et.useCallback(function(IY,IX){if(J7.current===nt.ViewMode.DualPageWithCover||J7.current===nt.ViewMode.DualPage)return gee(IY,IX);switch(AI.current){case nt.ScrollMode.Wrapped:return gee(IY,IX);case nt.ScrollMode.Horizontal:case nt.ScrollMode.Vertical:default:return vee(IY-1,IX)}},[]),Fee=Et.useCallback(function(){return function(IY,IX){switch(IX){case nt.ScrollMode.Horizontal:return{position:"relative",height:"100%",width:"".concat(IY.width,"px")};case nt.ScrollMode.Vertical:default:return{position:"relative",height:"".concat(IY.height,"px"),width:"100%"}}}(tee,AI.current)},[tee]),_ee=Et.useCallback(function(IY){return function(IX,Lq,Bq){return Bq!==nt.ScrollMode.Page?{}:{height:"".concat(Lq.height,"px"),width:"100%",position:"absolute",top:0,transform:"translateY(".concat(IX.start.top,"px)")}}(IY,DX,AI.current)},[DX]),Pee=Et.useCallback(function(IY){return function(IX,Lq,Bq,Fq,CK){var TK,Vq,Rq,zQ,XQ,cee,see,Eee=Lq?"right":"left",$ee=Lq?-1:1,jQ=Bq.length,Aee=IX.start.left*$ee,uee=IX.size,pee=uee.height,wee=uee.width;if(Fq===nt.ViewMode.DualPageWithCover){var aee=CK===nt.ScrollMode.Page?0:IX.start.top;return IX.index===0||jQ%2==0&&IX.index===jQ-1?((TK={height:"".concat(pee,"px"),minWidth:"".concat(Q9(Bq,Fq),"px"),width:"100%"})[Eee]=0,TK.position="absolute",TK.top=0,TK.transform="translate(".concat(Aee,"px, ").concat(aee,"px)"),TK):((Vq={height:"".concat(pee,"px"),width:"".concat(wee,"px")})[Eee]=0,Vq.position="absolute",Vq.top=0,Vq.transform="translate(".concat(Aee,"px, ").concat(aee,"px)"),Vq)}if(Fq===nt.ViewMode.DualPage)return(Rq={height:"".concat(pee,"px"),width:"".concat(wee,"px")})[Eee]=0,Rq.position="absolute",Rq.top=0,Rq.transform="translate(".concat(Aee,"px, ").concat(CK===nt.ScrollMode.Page?0:IX.start.top,"px)"),Rq;switch(CK){case nt.ScrollMode.Horizontal:return(zQ={height:"100%",width:"".concat(wee,"px")})[Eee]=0,zQ.position="absolute",zQ.top=0,zQ.transform="translateX(".concat(Aee,"px)"),zQ;case nt.ScrollMode.Page:return(XQ={height:"".concat(pee,"px"),width:"".concat(wee,"px")})[Eee]=0,XQ.position="absolute",XQ.top=0,XQ;case nt.ScrollMode.Wrapped:return(cee={height:"".concat(pee,"px"),width:"".concat(wee,"px")})[Eee]=0,cee.position="absolute",cee.top=0,cee.transform="translate(".concat(Aee,"px, ").concat(IX.start.top,"px)"),cee;case nt.ScrollMode.Vertical:default:return(see={height:"".concat(pee,"px"),width:"100%"})[Eee]=0,see.position="absolute",see.top=0,see.transform="translateY(".concat(IX.start.top,"px)"),see}}(IY,b$,W$,J7.current,AI.current)},[b$,W$]),Bee=Et.useCallback(function(IY,IX){var Lq=gK.current,Bq=Lq.measurements,Fq=Lq.scrollOffset,CK=Bq[H$(0,E$-1,IX)];if(CK){var TK=AI.current===nt.ScrollMode.Page?{left:CK.start.left,top:CK.start.top}:{left:Fq.left*IY,top:Fq.top*IY};return gX(TK,!1)}return Promise.resolve()},[]);return Et.useEffect(function(){return function(){ZQ.disconnect()}},[]),{boundingClientRect:DX,isSmoothScrolling:U$,startPage:xee,endPage:dee,maxVisbilityIndex:bee,virtualItems:mee,getContainerStyles:Fee,getItemContainerStyles:_ee,getItemStyles:Pee,scrollToItem:vee,scrollToNextItem:Mee,scrollToPreviousItem:jee,zoom:Bee}},zte=function(q1,a$,b$,E$,D$,k$){var W$=b$;switch(!0){case(D$===nt.ViewMode.DualPageWithCover&&k$>=3):case(D$===nt.ViewMode.DualPage&&k$>=3):W$=2*b$;break;default:W$=b$}switch(E$){case nt.SpecialZoomLevel.ActualSize:return 1;case nt.SpecialZoomLevel.PageFit:return Math.min((q1.clientWidth-17)/W$,(q1.clientHeight-16)/a$);case nt.SpecialZoomLevel.PageWidth:return(q1.clientWidth-17)/W$}},Pre=function(q1){var a$,b$,E$=q1.getCurrentPage,D$=(a$=50,b$=Et.useRef([]),Et.useEffect(function(){return function(){b$.current=[]}},[]),{push:function(V$){var U$=b$.current;U$.length+1>a$&&U$.shift(),U$.push(V$),b$.current=U$},map:function(V$){return b$.current.map(function(U$){return V$(U$)})},pop:function(){var V$=b$.current;if(V$.length===0)return null;var U$=V$.pop();return b$.current=V$,U$}}),k$=function(V$){var U$=Et.useRef([]);return Et.useEffect(function(){return function(){U$.current=[]}},[]),{dequeue:function(){var mO=U$.current;if(mO.length===0)return null;var NI=mO.shift();return U$.current=mO,NI||null},enqueue:function(mO){var NI=U$.current;NI.length+1>V$&&NI.pop(),U$.current=[mO].concat(NI)},map:function(mO){return U$.current.map(function(NI){return mO(NI)})}}}(50),W$=function(){var V$=k$.dequeue();return V$&&D$.push(V$),V$&&V$.pageIndex===E$()?W$():V$},z$=function(){var V$=D$.pop();return V$&&k$.enqueue(V$),V$&&V$.pageIndex===E$()?z$():V$},A$=Et.useCallback(function(V$){D$.push(V$)},[]);return{getNextDestination:W$,getPreviousDestination:z$,markVisitedDestination:A$}},Die=function(q1){var a$=[];return q1.map(function(b$){a$=a$.concat(b$).concat(function(E$){var D$=[];return E$.items&&E$.items.length>0&&(D$=D$.concat(Die(E$.items))),D$}(b$))}),a$},Rie={capture:!1,passive:!0},Tre={height:0,width:0},jte={height:0,width:0},$re=function(q1){var a$=q1.getCurrentPage,b$=q1.getCurrentScrollMode,E$=q1.jumpToPage,D$=q1.targetRef,k$=Et.useState(nt.FullScreenMode.Normal),W$=k$[0],z$=k$[1],A$=function(){var DY=Et.useState(Tre),JQ=DY[0],ZQ=DY[1],eee=uu(function(){ZQ({height:window.innerHeight,width:window.innerWidth})},100);return Tr(function(){return window.addEventListener("resize",eee,Rie),function(){window.removeEventListener("resize",eee,Rie)}},[]),JQ}(),V$=Et.useState(jte),U$=V$[0],mO=V$[1],NI=Et.useRef(jte),AI=Et.useRef(a$()),J7=Et.useRef(jte),_7=Et.useState(D$.current),B9=_7[0],HQ=_7[1],gX=Et.useRef();Tr(function(){D$.current!==B9&&HQ(D$.current)},[]),Tr(function(){if(B9){var DY=new ResizeObserver(function(JQ){JQ.forEach(function(ZQ){var eee=ZQ.target.getBoundingClientRect(),tee=eee.height,ree=eee.width;mO({height:tee,width:ree})})});return DY.observe(B9),function(){DY.unobserve(B9),DY.disconnect()}}},[B9]);var DX=Et.useCallback(function(DY){var JQ=ru();return JQ&&JQ!==DY?(z$(nt.FullScreenMode.Normal),Il(JQ)):Promise.resolve()},[]),gK=Et.useCallback(function(DY){DY&&ds()&&(HQ(DY),DX(DY).then(function(){gX.current=DY,z$(nt.FullScreenMode.Entering),function(JQ){ts&&JQ[Ko.RequestFullScreen]()}(DY)}))},[]),kq=Et.useCallback(function(){ru()&&(z$(nt.FullScreenMode.Exitting),Il(document))},[]),_K=Et.useCallback(function(){B9&&ru()!==B9&&z$(nt.FullScreenMode.Exitting)},[B9]);return Et.useEffect(function(){switch(W$){case nt.FullScreenMode.Entering:gX.current&&(gX.current.style.backgroundColor="var(--rpv-core__full-screen-target-background-color)"),AI.current=a$(),NI.current={height:window.innerHeight,width:window.innerWidth};break;case nt.FullScreenMode.Entered:b$()===nt.ScrollMode.Page?E$(AI.current).then(function(){z$(nt.FullScreenMode.EnteredCompletely)}):z$(nt.FullScreenMode.EnteredCompletely);break;case nt.FullScreenMode.Exitting:gX.current&&(gX.current.style.backgroundColor="",gX.current=null),AI.current=a$();break;case nt.FullScreenMode.Exited:z$(nt.FullScreenMode.Normal),b$()===nt.ScrollMode.Page&&E$(AI.current)}},[W$]),Et.useEffect(function(){if(W$!==nt.FullScreenMode.Normal)return W$===nt.FullScreenMode.Entering&&A$.height===U$.height&&A$.width===U$.width&&A$.height>0&&A$.width>0&&(J7.current.height===0||A$.height==J7.current.height)?(J7.current={height:window.innerHeight,width:window.innerWidth},void z$(nt.FullScreenMode.Entered)):void(W$===nt.FullScreenMode.Exitting&&NI.current.height===A$.height&&NI.current.width===A$.width&&A$.height>0&&A$.width>0&&z$(nt.FullScreenMode.Exited))},[W$,A$,U$]),Et.useEffect(function(){var DY;return DY=_K,ts&&document.addEventListener(Ko.FullScreenChange,DY),function(){(function(JQ){ts&&document.removeEventListener(Ko.FullScreenChange,JQ)})(_K)}},[B9]),{enterFullScreenMode:gK,exitFullScreenMode:kq,fullScreenMode:W$}},Dre={buildPageStyles:function(){return{}},transformSize:function(q1){return q1.size}},ete={left:0,top:0},Rre=function(q1){var a$=q1.currentFile,b$=q1.defaultScale,E$=q1.doc,D$=q1.enableSmoothScroll,k$=q1.initialPage,W$=q1.initialRotation,z$=q1.initialScale,A$=q1.pageLayout,V$=q1.pageSizes,U$=q1.plugins,mO=q1.renderPage,NI=q1.scrollMode,AI=q1.setRenderRange,J7=q1.viewMode,_7=q1.viewerState,B9=q1.onDocumentLoad,HQ=q1.onOpenFile,gX=q1.onPageChange,DX=q1.onRotate,gK=q1.onRotatePage,kq=q1.onZoom,_K=E$.numPages,DY=E$.loadingTask.docId,JQ=Et.useContext(Vx).l10n,ZQ=Et.useContext(dr),eee=ZQ.direction===nt.TextDirection.RightToLeft,tee=Et.useRef(),ree=Et.useRef(),xee=Et.useState(k$),dee=xee[0],bee=xee[1],mee=Et.useRef(null),vee=Pre({getCurrentPage:function(){return jQ.current.pageIndex}}),yee=Et.useState(W$),gee=yee[0],Mee=yee[1],jee=X1(gee),Fee=Et.useState(!1),_ee=Fee[0],Pee=Fee[1],Bee=Et.useState(new Map),IY=Bee[0],IX=Bee[1],Lq=Et.useState(NI),Bq=Lq[0],Fq=Lq[1],CK=X1(Bq),TK=Et.useState(J7),Vq=TK[0],Rq=TK[1],zQ=X1(Vq),XQ=function(ZN){var kQ=p0(),KQ=Et.useState([]),nee=KQ[0],iee=KQ[1];return Et.useEffect(function(){ZN.getOutline().then(function(QQ){if(kQ.current&&QQ!==null){var See=Die(QQ);iee(See)}})},[]),nee}(E$),cee=Et.useState(z$),see=cee[0],Eee=cee[1],$ee=X1(see),jQ=Et.useRef(_7),Aee=Et.useRef(typeof b$=="string"?b$:null),uee=Et.useRef(-1),pee=Et.useRef(-1),wee=Et.useRef(k$),aee=$re({getCurrentPage:function(){return jQ.current.pageIndex},getCurrentScrollMode:function(){return jQ.current.scrollMode},jumpToPage:function(ZN){return Gee(ZN)},targetRef:ree}),Hee=Et.useState(-1),tte=Hee[0],bte=Hee[1],Yee=Et.useState(0),ute=Yee[0],zre=Yee[1],Dee=hu({doc:E$});Et.useEffect(function(){return function(){F$.clear(),EI.clear()}},[DY]);var Lie=Et.useMemo(function(){return Object.assign({},Dre,A$)},[]),jre=Et.useMemo(function(){return Array(_K).fill(0).map(function(ZN,kQ){var KQ=[V$[kQ].pageHeight,V$[kQ].pageWidth],nee=Math.abs(gee)%180==0?{height:KQ[0],width:KQ[1]}:{height:KQ[1],width:KQ[0]},iee={height:nee.height*see,width:nee.width*see};return Lie.transformSize({numPages:_K,pageIndex:kQ,size:iee})})},[gee,see]),oee=Mre({enableSmoothScroll:D$,isRtl:eee,numberOfItems:_K,parentRef:ree,scrollMode:Bq,setRenderRange:AI,sizes:jre,viewMode:Vq}),Nre=uu(function(){!Aee.current||jQ.current.fullScreenMode!==nt.FullScreenMode.Normal||k$>0&&wee.current===k$||Kee(Aee.current)},200);(function(ZN){var kQ=ZN.targetRef,KQ=ZN.onResize;Tr(function(){var nee=new ResizeObserver(function(QQ){QQ.forEach(function(See){KQ(See.target)})}),iee=kQ.current;if(iee)return nee.observe(iee),function(){nee.unobserve(iee)}},[])})({targetRef:ree,onResize:Nre});var Wee=function(ZN){var kQ=ZN;U$.forEach(function(KQ){KQ.onViewerStateChange&&(kQ=KQ.onViewerStateChange(kQ))}),jQ.current=kQ},Bre=function(){return ree.current},Ure=function(){return jQ.current},Vre=Et.useCallback(function(ZN){vee.markVisitedDestination(ZN)},[]),Ute=Et.useCallback(function(ZN){var kQ=ZN.pageIndex,KQ=ZN.bottomOffset,nee=ZN.leftOffset,iee=ZN.scaleTo,QQ=ree.current,See=jQ.current;return QQ&&See?new Promise(function(qee,Xte){J$(E$,kQ).then(function(wte){var Xee=wte.getViewport({scale:1}),Ste=0,Hie=(typeof KQ=="function"?KQ(Xee.width,Xee.height):KQ)||0,_te=(typeof nee=="function"?nee(Xee.width,Xee.height):nee)||0,ite=See.scale;switch(iee){case nt.SpecialZoomLevel.PageFit:Ste=0,_te=0,Kee(nt.SpecialZoomLevel.PageFit);break;case nt.SpecialZoomLevel.PageWidth:ite=zte(QQ,V$[kQ].pageHeight,V$[kQ].pageWidth,nt.SpecialZoomLevel.PageWidth,J7,_K),Ste=(Xee.height-Hie)*ite,_te*=ite,Kee(ite);break;default:Ste=(Xee.height-Hie)*ite,_te*=ite}switch(See.scrollMode){case nt.ScrollMode.Horizontal:oee.scrollToItem(kQ,{left:_te,top:0}).then(function(){qee()});break;case nt.ScrollMode.Vertical:default:oee.scrollToItem(kQ,{left:0,top:Ste}).then(function(){qee()})}})}):Promise.resolve()},[]),Fie=Et.useCallback(function(ZN){return vee.markVisitedDestination(ZN),Ute(ZN)},[]),Hre=Et.useCallback(function(){var ZN=vee.getNextDestination();return ZN?Ute(ZN):Promise.resolve()},[]),Wre=Et.useCallback(function(){var ZN=vee.getPreviousDestination();return ZN?Ute(ZN):Promise.resolve()},[]),Gre=Et.useCallback(function(){return oee.scrollToNextItem(jQ.current.pageIndex,ete)},[]),Gee=Et.useCallback(function(ZN){return 0<=ZN&&ZN<_K?oee.scrollToItem(ZN,ete):Promise.resolve()},[]),qre=Et.useCallback(function(){return oee.scrollToPreviousItem(jQ.current.pageIndex,ete)},[]),zie=Et.useCallback(function(ZN){var kQ,KQ;(kQ=ZN.name,KQ=kQ.split(/\./).pop(),KQ?KQ.toLowerCase():"").toLowerCase()==="pdf"&&new Promise(function(nee){var iee=new FileReader;iee.readAsArrayBuffer(ZN),iee.onload=function(){var QQ=new Uint8Array(iee.result);nee(QQ)}}).then(function(nee){HQ(ZN.name,nee)})},[HQ]),jie=Et.useCallback(function(ZN){var kQ=ZN===nt.RotateDirection.Backward?-90:90,KQ=jQ.current.rotation,nee=KQ===360||KQ===-360?kQ:KQ+kQ;Dee.markNotRendered(),Mee(nee),Wee(Bt(Bt({},jQ.current),{rotation:nee})),DX({direction:ZN,doc:E$,rotation:nee})},[]),Vte=Et.useCallback(function(ZN,kQ){var KQ=kQ===nt.RotateDirection.Backward?-90:90,nee=jQ.current.pagesRotation,iee=(nee.has(ZN)?nee.get(ZN):W$)+KQ,QQ=nee.set(ZN,iee);IX(QQ),Pee(function(See){return!See}),Wee(Bt(Bt({},jQ.current),{pagesRotation:QQ,rotatedPage:ZN})),gK({direction:kQ,doc:E$,pageIndex:ZN,rotation:iee}),Dee.markRendering(ZN),bte(ZN)},[]),Nie=Et.useCallback(function(ZN){Wee(Bt(Bt({},jQ.current),{scrollMode:ZN})),Fq(ZN)},[]),Bie=Et.useCallback(function(ZN){Wee(Bt(Bt({},jQ.current),{viewMode:ZN})),Rq(ZN)},[]),Kee=Et.useCallback(function(ZN){var kQ=ree.current,KQ=jQ.current.pageIndex;if(!(KQ<0||KQ>=_K)){var nee=V$[KQ].pageHeight,iee=V$[KQ].pageWidth,QQ=kQ?typeof ZN=="string"?zte(kQ,nee,iee,ZN,jQ.current.viewMode,_K):ZN:1;Aee.current=typeof ZN=="string"?ZN:null,QQ!==jQ.current.scale&&(zre(function(See){return See+1}),Dee.markNotRendered(),Eee(QQ),kq({doc:E$,scale:QQ}),Wee(Bt(Bt({},jQ.current),{scale:QQ})))}},[]),Xre=Et.useCallback(function(ZN){aee.enterFullScreenMode(ZN)},[]),Yre=Et.useCallback(function(){aee.exitFullScreenMode()},[]);Et.useEffect(function(){Wee(Bt(Bt({},jQ.current),{fullScreenMode:aee.fullScreenMode}))},[aee.fullScreenMode]),Et.useEffect(function(){var ZN={enterFullScreenMode:Xre,exitFullScreenMode:Yre,getPagesContainer:Bre,getViewerState:Ure,jumpToDestination:Fie,jumpToNextDestination:Hre,jumpToPreviousDestination:Wre,jumpToNextPage:Gre,jumpToPreviousPage:qre,jumpToPage:Gee,openFile:zie,rotate:jie,rotatePage:Vte,setViewerState:Wee,switchScrollMode:Nie,switchViewMode:Bie,zoom:Kee};return U$.forEach(function(kQ){kQ.install&&kQ.install(ZN)}),function(){U$.forEach(function(kQ){kQ.uninstall&&kQ.uninstall(ZN)})}},[DY]),Et.useEffect(function(){B9({doc:E$,file:a$}),U$.forEach(function(ZN){ZN.onDocumentLoad&&ZN.onDocumentLoad({doc:E$,file:a$})})},[DY]);var Hte,Wte,Gte,Uie=oee.boundingClientRect;Hte=function(){k$&&Gee(k$)},Wte=Uie.height>0&&Uie.width>0,Gte=Et.useRef(!1),Tr(function(){Wte&&!Gte.current&&(Gte.current=!0,Hte())},[Hte,Wte]),Tr(function(){var ZN=jQ.current.pageIndex;ZN>-1&&CK!==Bq&&oee.scrollToItem(ZN,ete).then(function(){aee.fullScreenMode===nt.FullScreenMode.EnteredCompletely&&(D$||Dee.markNotRendered(),uee.current=-1)})},[Bq]),Tr(function(){var ZN=jQ.current.pageIndex;ZN>-1&&jee!==gee&&oee.scrollToItem(ZN,ete)},[gee]),Tr(function(){$ee!=0&&$ee!=jQ.current.scale&&oee.zoom(jQ.current.scale/$ee,jQ.current.pageIndex).then(function(){aee.fullScreenMode===nt.FullScreenMode.EnteredCompletely&&(pee.current=-1)})},[see]),Tr(function(){if(zQ!==jQ.current.viewMode){var ZN=oee.startPage,kQ=oee.endPage,KQ=oee.virtualItems;Dee.markNotRendered(),Dee.setRange(ZN,kQ);for(var nee=function(QQ){var See=KQ.find(function(qee){return qee.index===QQ});See&&Dee.setVisibility(QQ,See.visibility)},iee=ZN;iee<=kQ;iee++)nee(iee);qte()}},[Vq]),Tr(function(){var ZN=jQ.current.pageIndex;ZN>-1&&zQ!==Vq&&oee.scrollToItem(ZN,ete)},[Vq]),Tr(function(){var ZN=jQ.current.pageIndex;ZN>0&&ZN===k$&&wee.current===k$&&Aee.current&&(wee.current=-1,Kee(Aee.current))},[dee]),Et.useEffect(function(){oee.isSmoothScrolling||mee.current!==null&&mee.current===dee||(mee.current=dee,gX({currentPage:dee,doc:E$}))},[dee,oee.isSmoothScrolling]),Et.useEffect(function(){aee.fullScreenMode===nt.FullScreenMode.Entering&&jQ.current.scrollMode===nt.ScrollMode.Page&&(uee.current=jQ.current.pageIndex),aee.fullScreenMode===nt.FullScreenMode.EnteredCompletely&&jQ.current.scrollMode===nt.ScrollMode.Page&&D$&&(uee.current=-1),aee.fullScreenMode===nt.FullScreenMode.EnteredCompletely&&Aee.current&&(pee.current=jQ.current.pageIndex,Kee(Aee.current))},[aee.fullScreenMode]),Et.useEffect(function(){if(aee.fullScreenMode!==nt.FullScreenMode.Entering&&aee.fullScreenMode!==nt.FullScreenMode.Exitting&&!oee.isSmoothScrolling){var ZN=oee.startPage,kQ=oee.endPage,KQ=oee.maxVisbilityIndex,nee=oee.virtualItems,iee=KQ,QQ=aee.fullScreenMode===nt.FullScreenMode.Entered||aee.fullScreenMode===nt.FullScreenMode.EnteredCompletely;if(!(QQ&&iee!==uee.current&&uee.current>-1||QQ&&iee!==pee.current&&pee.current>-1)){bee(iee),Wee(Bt(Bt({},jQ.current),{pageIndex:iee})),Dee.setRange(ZN,kQ);for(var See=function(Xte){var wte=nee.find(function(Xee){return Xee.index===Xte});wte&&Dee.setVisibility(Xte,wte.visibility)},qee=ZN;qee<=kQ;qee++)See(qee);qte()}}},[oee.startPage,oee.endPage,oee.isSmoothScrolling,oee.maxVisbilityIndex,aee.fullScreenMode,_ee,gee,see]);var Kre=Et.useCallback(function(ZN){Dee.markRendered(ZN),qte()},[ute]),qte=function(){var ZN=Dee.getHighestPriorityPage();ZN>-1&&Dee.isInRange(ZN)&&(Dee.markRendering(ZN),bte(ZN))},Qre=function(ZN){var kQ=dee-1,KQ=dee+1;switch(ZN){case"FirstPage":Gee(0);break;case"LastPage":Gee(_K-1);break;case"NextPage":KQ<_K&&Gee(KQ);break;case"PrevPage":kQ>=0&&Gee(kQ)}},Zre=Et.useCallback(function(){var ZN=oee.virtualItems,kQ=[];switch(Vq){case nt.ViewMode.DualPage:kQ=u$(ZN,2);break;case nt.ViewMode.DualPageWithCover:ZN.length&&(kQ=ZN[0].index===0?[[ZN[0]]].concat(u$(ZN.slice(1),2)):u$(ZN,2));break;case nt.ViewMode.SinglePage:default:kQ=u$(ZN,1)}var KQ=JQ&&JQ.core?JQ.core.pageLabel:"Page {{pageIndex}}",nee={attrs:{className:"rpv-core__inner-container","data-testid":"core__inner-container",ref:tee,style:{height:"100%"}},children:Et.createElement(Et.Fragment,null),subSlot:{attrs:{"data-testid":"core__inner-pages",className:Mr({"rpv-core__inner-pages":!0,"rpv-core__inner-pages--horizontal":Bq===nt.ScrollMode.Horizontal,"rpv-core__inner-pages--rtl":eee,"rpv-core__inner-pages--single":Bq===nt.ScrollMode.Page,"rpv-core__inner-pages--vertical":Bq===nt.ScrollMode.Vertical,"rpv-core__inner-pages--wrapped":Bq===nt.ScrollMode.Wrapped}),ref:ree,style:{height:"100%",position:"relative"}},children:Et.createElement("div",{"data-testid":"core__inner-current-page-".concat(dee),style:Object.assign({"--scale-factor":see},oee.getContainerStyles())},kQ.map(function(iee){return Et.createElement("div",{className:Mr({"rpv-core__inner-page-container":!0,"rpv-core__inner-page-container--single":Bq===nt.ScrollMode.Page}),style:oee.getItemContainerStyles(iee[0]),key:"".concat(iee[0].index,"-").concat(Vq)},iee.map(function(QQ){var See=Vq===nt.ViewMode.DualPageWithCover&&(QQ.index===0||_K%2==0&&QQ.index===_K-1);return Et.createElement("div",{"aria-label":KQ.replace("{{pageIndex}}","".concat(QQ.index+1)),className:Mr({"rpv-core__inner-page":!0,"rpv-core__inner-page--dual-even":Vq===nt.ViewMode.DualPage&&QQ.index%2==0,"rpv-core__inner-page--dual-odd":Vq===nt.ViewMode.DualPage&&QQ.index%2==1,"rpv-core__inner-page--dual-cover":See,"rpv-core__inner-page--dual-cover-even":Vq===nt.ViewMode.DualPageWithCover&&!See&&QQ.index%2==0,"rpv-core__inner-page--dual-cover-odd":Vq===nt.ViewMode.DualPageWithCover&&!See&&QQ.index%2==1,"rpv-core__inner-page--single":Vq===nt.ViewMode.SinglePage&&Bq===nt.ScrollMode.Page}),role:"region",key:"".concat(QQ.index,"-").concat(Vq),style:Object.assign({},oee.getItemStyles(QQ),Lie.buildPageStyles({numPages:_K,pageIndex:QQ.index,scrollMode:Bq,viewMode:Vq}))},Et.createElement(Nee,{doc:E$,measureRef:QQ.measureRef,outlines:XQ,pageIndex:QQ.index,pageRotation:IY.has(QQ.index)?IY.get(QQ.index):0,pageSize:V$[QQ.index],plugins:U$,renderPage:mO,renderQueueKey:ute,rotation:gee,scale:see,shouldRender:tte===QQ.index,viewMode:Vq,onExecuteNamedAction:Qre,onJumpFromLinkAnnotation:Vre,onJumpToDest:Fie,onRenderCompleted:Kre,onRotatePage:Vte}))}))}))}};return U$.forEach(function(iee){iee.renderViewer&&(nee=iee.renderViewer({containerRef:tee,doc:E$,pagesContainerRef:ree,pagesRotation:IY,pageSizes:V$,rotation:gee,slot:nee,themeContext:ZQ,jumpToPage:Gee,openFile:zie,rotate:jie,rotatePage:Vte,switchScrollMode:Nie,switchViewMode:Bie,zoom:Kee}))}),nee},[U$,oee]),Vie=Et.useCallback(function(ZN){return Et.createElement("div",Bt({},ZN.attrs,{style:ZN.attrs&&ZN.attrs.style?ZN.attrs.style:{}}),ZN.children,ZN.subSlot&&Vie(ZN.subSlot))},[]);return Vie(Zre())},Iie=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.3,1.5,1.7,1.9,2.1,2.4,2.7,3,3.3,3.7,4.1,4.6,5.1,5.7,6.3,7,7.7,8.5,9.4,10],Ire=function(q1){var a$=q1.defaultScale,b$=q1.doc,E$=q1.render,D$=q1.scrollMode,k$=q1.viewMode,W$=Et.useRef(),z$=Et.useState({pageSizes:[],scale:0}),A$=z$[0],V$=z$[1];return Et.useLayoutEffect(function(){var U$=Array(b$.numPages).fill(0).map(function(mO,NI){return new Promise(function(AI,J7){J$(b$,NI).then(function(_7){var B9=_7.getViewport({scale:1});AI({pageHeight:B9.height,pageWidth:B9.width,rotation:B9.rotation})})})});Promise.all(U$).then(function(mO){var NI=W$.current;if(NI&&mO.length!==0){var AI=mO[0].pageWidth,J7=mO[0].pageHeight,_7=NI.parentElement,B9=(_7.clientWidth-45)/AI,HQ=(_7.clientHeight-45)/J7,gX=B9;switch(D$){case nt.ScrollMode.Horizontal:gX=Math.min(B9,HQ);break;case nt.ScrollMode.Vertical:default:gX=B9}var DX,gK,kq=a$?typeof a$=="string"?zte(_7,J7,AI,a$,k$,b$.numPages):a$:(DX=gX,(gK=Iie.findIndex(function(_K){return _K>=DX}))===-1||gK===0?DX:Iie[gK-1]);V$({pageSizes:mO,scale:kq})}})},[b$.loadingTask.docId]),A$.pageSizes.length===0||A$.scale===0?Et.createElement("div",{className:"rpv-core__page-size-calculator","data-testid":"core__page-size-calculating",ref:W$},Et.createElement(rn,null)):E$(A$.pageSizes,A$.scale)},xte=function(){},Nte=function(q1){function a$(b$,E$){var D$=q1.call(this)||this;return D$.verifyPassword=b$,D$.passwordStatus=E$,D$}return Ft(a$,q1),a$}(xte),Ore=function(q1){var a$=q1.passwordStatus,b$=q1.renderProtectedView,E$=q1.verifyPassword,D$=q1.onDocumentAskPassword,k$=Et.useContext(Vx).l10n,W$=Et.useState(""),z$=W$[0],A$=W$[1],V$=Et.useContext(dr).direction===nt.TextDirection.RightToLeft,U$=function(){return E$(z$)};return Et.useEffect(function(){D$&&D$({verifyPassword:E$})},[]),b$?b$({passwordStatus:a$,verifyPassword:E$}):Et.createElement("div",{className:"rpv-core__asking-password-wrapper"},Et.createElement("div",{className:Mr({"rpv-core__asking-password":!0,"rpv-core__asking-password--rtl":V$})},Et.createElement("div",{className:"rpv-core__asking-password-message"},a$===nt.PasswordStatus.RequiredPassword&&k$.core.askingPassword.requirePasswordToOpen,a$===nt.PasswordStatus.WrongPassword&&k$.core.wrongPassword.tryAgain),Et.createElement("div",{className:"rpv-core__asking-password-body"},Et.createElement("div",{className:Mr({"rpv-core__asking-password-input":!0,"rpv-core__asking-password-input--ltr":!V$,"rpv-core__asking-password-input--rtl":V$})},Et.createElement(Tn,{testId:"core__asking-password-input",type:"password",value:z$,onChange:A$,onKeyDown:function(mO){mO.key==="Enter"&&U$()}})),Et.createElement(tn,{onClick:U$},k$.core.askingPassword.submit))))},Oie=function(q1){function a$(b$){var E$=q1.call(this)||this;return E$.doc=b$,E$}return Ft(a$,q1),a$}(xte),kie=function(q1){function a$(b$){var E$=q1.call(this)||this;return E$.error=b$,E$}return Ft(a$,q1),a$}(xte),Bte=function(q1){function a$(b$){var E$=q1.call(this)||this;return E$.percentages=b$,E$}return Ft(a$,q1),a$}(xte),kre=function(q1){var a$=q1.characterMap,b$=q1.file,E$=q1.httpHeaders,D$=q1.render,k$=q1.renderError,W$=q1.renderLoader,z$=q1.renderProtectedView,A$=q1.transformGetDocumentParams,V$=q1.withCredentials,U$=q1.onDocumentAskPassword,mO=Et.useContext(dr).direction===nt.TextDirection.RightToLeft,NI=Et.useState(new Bte(0)),AI=NI[0],J7=NI[1],_7=Et.useRef(""),B9=p0();return Et.useEffect(function(){_7.current="",J7(new Bte(0));var HQ=new At.PDFWorker({name:"PDFWorker_".concat(Date.now())}),gX=Object.assign({httpHeaders:E$,withCredentials:V$,worker:HQ},typeof b$=="string"?{url:b$}:{data:b$},a$?{cMapUrl:a$.url,cMapPacked:a$.isCompressed}:{}),DX=A$?A$(gX):gX,gK=At.getDocument(DX);return gK.onPassword=function(kq,_K){switch(_K){case At.PasswordResponses.NEED_PASSWORD:B9.current&&J7(new Nte(kq,nt.PasswordStatus.RequiredPassword));break;case At.PasswordResponses.INCORRECT_PASSWORD:B9.current&&J7(new Nte(kq,nt.PasswordStatus.WrongPassword))}},gK.onProgress=function(kq){var _K=kq.total>0?Math.min(100,100*kq.loaded/kq.total):100;B9.current&&_7.current===""&&J7(new Bte(_K))},gK.promise.then(function(kq){_7.current=kq.loadingTask.docId,B9.current&&J7(new Oie(kq))},function(kq){return B9.current&&!HQ.destroyed&&J7(new kie({message:kq.message||"Cannot load document",name:kq.name}))}),function(){gK.destroy(),HQ.destroy()}},[b$]),AI instanceof Nte?Et.createElement(Ore,{passwordStatus:AI.passwordStatus,renderProtectedView:z$,verifyPassword:AI.verifyPassword,onDocumentAskPassword:U$}):AI instanceof Oie?D$(AI.doc):AI instanceof kie?k$?k$(AI.error):Et.createElement("div",{className:Mr({"rpv-core__doc-error":!0,"rpv-core__doc-error--rtl":mO})},Et.createElement("div",{className:"rpv-core__doc-error-text"},AI.error.message)):Et.createElement("div",{"data-testid":"core__doc-loading",className:Mr({"rpv-core__doc-loading":!0,"rpv-core__doc-loading--rtl":mO})},W$?W$(AI.percentages):Et.createElement(rn,null))},Lre=function(q1,a$){var b$=Et.useMemo(function(){return q1==="auto"?typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":q1},[]),E$=Et.useState(b$),D$=E$[0],k$=E$[1],W$=X1(D$);return Et.useEffect(function(){if(q1==="auto"){var z$=window.matchMedia("(prefers-color-scheme: dark)"),A$=function(V$){k$(V$.matches?"dark":"light")};return z$.addEventListener("change",A$),function(){return z$.removeEventListener("change",A$)}}},[]),Et.useEffect(function(){D$!==W$&&a$&&a$(D$)},[D$]),Et.useEffect(function(){q1!==D$&&k$(q1)},[q1]),{currentTheme:D$,setCurrentTheme:k$}},Fre=function(q1){return{startPage:q1.startPage-3,endPage:q1.endPage+3}};nt.Button=function(q1){var a$=q1.children,b$=q1.testId,E$=q1.onClick,D$=Et.useContext(dr).direction===nt.TextDirection.RightToLeft,k$=b$?{"data-testid":b$}:{};return Et.createElement("button",Bt({className:Mr({"rpv-core__button":!0,"rpv-core__button--rtl":D$}),type:"button",onClick:E$},k$),a$)},nt.Icon=Fr,nt.LazyRender=function(q1){var a$=q1.attrs,b$=q1.children,E$=q1.testId,D$=Et.useState(!1),k$=D$[0],W$=D$[1],z$=E$?Bt(Bt({},a$),{"data-testid":E$}):a$,A$=zr({once:!0,onVisibilityChanged:function(V$){V$.isVisible&&W$(!0)}});return Et.createElement("div",Bt({ref:A$},z$),k$&&b$)},nt.LocalizationContext=Vx,nt.Menu=function(q1){var a$=q1.children,b$=Et.useRef(),E$=Et.useRef([]),D$=Et.useContext(dr).direction===nt.TextDirection.RightToLeft,k$=function(z$){if(b$.current)switch(z$.key){case"Tab":z$.preventDefault();break;case"ArrowDown":z$.preventDefault(),W$(function(A$,V$){return V$+1});break;case"ArrowUp":z$.preventDefault(),W$(function(A$,V$){return V$-1});break;case"End":z$.preventDefault(),W$(function(A$,V$){return A$.length-1});break;case"Home":z$.preventDefault(),W$(function(A$,V$){return 0})}},W$=function(z$){if(b$.current){var A$=E$.current,V$=A$.findIndex(function(mO){return mO.getAttribute("tabindex")==="0"}),U$=Math.min(A$.length-1,Math.max(0,z$(A$,V$)));V$>=0&&V$<=A$.length-1&&A$[V$].setAttribute("tabindex","-1"),A$[U$].setAttribute("tabindex","0"),A$[U$].focus()}};return Tr(function(){var z$=b$.current;if(z$){var A$=function(V$){var U$=[];return V$.querySelectorAll('.rpv-core__menu-item[role="menuitem"]').forEach(function(mO){if(mO instanceof HTMLElement){var NI=mO.parentElement;(NI===V$||window.getComputedStyle(NI).display!=="none")&&U$.push(mO)}}),U$}(z$);E$.current=A$}},[]),Tr(function(){return document.addEventListener("keydown",k$),function(){document.removeEventListener("keydown",k$)}},[]),Et.createElement("div",{ref:b$,"aria-orientation":"vertical",className:Mr({"rpv-core__menu":!0,"rpv-core__menu--rtl":D$}),role:"menu",tabIndex:0},a$)},nt.MenuDivider=function(){return Et.createElement("div",{"aria-orientation":"horizontal",className:"rpv-core__menu-divider",role:"separator"})},nt.MenuItem=function(q1){var a$=q1.checked,b$=a$!==void 0&&a$,E$=q1.children,D$=q1.icon,k$=D$===void 0?null:D$,W$=q1.isDisabled,z$=W$!==void 0&&W$,A$=q1.testId,V$=q1.onClick,U$=Et.useContext(dr).direction===nt.TextDirection.RightToLeft,mO=A$?{"data-testid":A$}:{};return Et.createElement("button",Bt({className:Mr({"rpv-core__menu-item":!0,"rpv-core__menu-item--disabled":z$,"rpv-core__menu-item--ltr":!U$,"rpv-core__menu-item--rtl":U$}),role:"menuitem",tabIndex:-1,type:"button",onClick:V$},mO),Et.createElement("div",{className:Mr({"rpv-core__menu-item-icon":!0,"rpv-core__menu-item-icon--ltr":!U$,"rpv-core__menu-item-icon--rtl":U$})},k$),Et.createElement("div",{className:Mr({"rpv-core__menu-item-label":!0,"rpv-core__menu-item-label--ltr":!U$,"rpv-core__menu-item-label--rtl":U$})},E$),Et.createElement("div",{className:Mr({"rpv-core__menu-item-check":!0,"rpv-core__menu-item-check--ltr":!U$,"rpv-core__menu-item-check--rtl":U$})},b$&&Et.createElement(Nr,null)))},nt.MinimalButton=function(q1){var a$=q1.ariaLabel,b$=a$===void 0?"":a$,E$=q1.ariaKeyShortcuts,D$=E$===void 0?"":E$,k$=q1.children,W$=q1.isDisabled,z$=W$!==void 0&&W$,A$=q1.isSelected,V$=A$!==void 0&&A$,U$=q1.testId,mO=q1.onClick,NI=Et.useContext(dr).direction===nt.TextDirection.RightToLeft,AI=U$?{"data-testid":U$}:{};return Et.createElement("button",Bt({"aria-label":b$},D$&&{"aria-keyshortcuts":D$},z$&&{"aria-disabled":!0},{className:Mr({"rpv-core__minimal-button":!0,"rpv-core__minimal-button--disabled":z$,"rpv-core__minimal-button--rtl":NI,"rpv-core__minimal-button--selected":V$}),type:"button",onClick:mO},AI),k$)},nt.Modal=function(q1){var a$=q1.ariaControlsSuffix,b$=q1.closeOnClickOutside,E$=q1.closeOnEscape,D$=q1.content,k$=q1.isOpened,W$=k$!==void 0&&k$,z$=q1.target,A$=a$||"".concat(cu());return Et.createElement(o$,{target:z$?function(V$,U$){return Et.createElement("div",{"aria-expanded":U$?"true":"false","aria-haspopup":"dialog","aria-controls":"rpv-core__modal-body-".concat(A$)},z$(V$,U$))}:null,content:function(V$){return Et.createElement(LE,null,Et.createElement(l1,{ariaControlsSuffix:A$,closeOnClickOutside:b$,closeOnEscape:E$,onToggle:V$},D$(V$)))},isOpened:W$})},nt.Popover=function(q1){var a$=q1.ariaHasPopup,b$=a$===void 0?"dialog":a$,E$=q1.ariaControlsSuffix,D$=q1.closeOnClickOutside,k$=q1.closeOnEscape,W$=q1.content,z$=q1.lockScroll,A$=z$===void 0||z$,V$=q1.offset,U$=q1.position,mO=q1.target,NI=SA(!1),AI=NI.opened,J7=NI.toggle,_7=Et.useRef(),B9=Et.useMemo(function(){return E$||"".concat(cu())},[]);return Et.createElement("div",{ref:_7,"aria-expanded":AI?"true":"false","aria-haspopup":b$,"aria-controls":"rpv-core__popver-body-".concat(B9)},mO(J7,AI),AI&&Et.createElement(Et.Fragment,null,A$&&Et.createElement(tA,{closeOnEscape:k$,onClose:J7}),Et.createElement(S$,{ariaControlsSuffix:B9,closeOnClickOutside:D$,offset:V$,position:U$,targetRef:_7,onClose:J7},W$(J7))))},nt.PrimaryButton=tn,nt.ProgressBar=function(q1){var a$=q1.progress,b$=Et.useContext(dr).direction===nt.TextDirection.RightToLeft;return Et.createElement("div",{className:Mr({"rpv-core__progress-bar":!0,"rpv-core__progress-bar--rtl":b$})},Et.createElement("div",{className:"rpv-core__progress-bar-progress",style:{width:"".concat(a$,"%")}},a$,"%"))},nt.Separator=function(){return Et.createElement("div",{className:"rpv-core__separator"})},nt.Spinner=rn,nt.Splitter=function(q1){var a$=q1.constrain,b$=Et.useContext(dr).direction===nt.TextDirection.RightToLeft,E$=Et.useRef(),D$=Et.useRef(),k$=Et.useRef(),W$=Et.useRef(0),z$=Et.useRef(0),A$=Et.useRef(0),V$=Et.useRef(0),U$={capture:!0},mO=function(AI){var J7=E$.current,_7=D$.current,B9=k$.current;if(J7&&_7&&B9){var HQ=V$.current,gX=AI.clientX-W$.current,DX=A$.current+(b$?-gX:gX),gK=J7.parentElement.getBoundingClientRect().width,kq=100*DX/gK;if(J7.classList.add("rpv-core__splitter--resizing"),a$){var _K=gK-DX-HQ;if(!a$({firstHalfPercentage:kq,firstHalfSize:DX,secondHalfPercentage:100*_K/gK,secondHalfSize:_K}))return}_7.style.width="".concat(kq,"%"),document.body.classList.add("rpv-core__splitter-body--resizing"),_7.classList.add("rpv-core__splitter-sibling--resizing"),B9.classList.add("rpv-core__splitter-sibling--resizing")}},NI=function(AI){var J7=E$.current,_7=D$.current,B9=k$.current;J7&&_7&&B9&&(document.body.classList.remove("rpv-core__splitter-body--resizing"),J7.classList.remove("rpv-core__splitter--resizing"),_7.classList.remove("rpv-core__splitter-sibling--resizing"),B9.classList.remove("rpv-core__splitter-sibling--resizing"),document.removeEventListener("mousemove",mO,U$),document.removeEventListener("mouseup",NI,U$))};return Et.useEffect(function(){var AI=E$.current;AI&&(V$.current=AI.getBoundingClientRect().width,D$.current=AI.previousElementSibling,k$.current=AI.nextElementSibling)},[]),Et.createElement("div",{ref:E$,className:"rpv-core__splitter",onMouseDown:function(AI){var J7=D$.current;J7&&(W$.current=AI.clientX,z$.current=AI.clientY,A$.current=J7.getBoundingClientRect().width,document.addEventListener("mousemove",mO,U$),document.addEventListener("mouseup",NI,U$))}})},nt.TextBox=Tn,nt.ThemeContext=dr,nt.Tooltip=function(q1){var a$=q1.ariaControlsSuffix,b$=q1.content,E$=q1.offset,D$=q1.position,k$=q1.target,W$=SA(!1),z$=W$.opened,A$=W$.toggle,V$=Et.useRef(),U$=Et.useRef(),mO=Et.useMemo(function(){return a$||"".concat(cu())},[]);b0(function(){V$.current&&document.activeElement&&V$.current.contains(document.activeElement)&&AI()});var NI=function(){A$(nt.ToggleStatus.Open)},AI=function(){A$(nt.ToggleStatus.Close)};return Et.createElement(Et.Fragment,null,Et.createElement("div",{ref:V$,"aria-describedby":"rpv-core__tooltip-body-".concat(mO),onBlur:function(J7){J7.relatedTarget instanceof HTMLElement&&J7.currentTarget.parentElement&&J7.currentTarget.parentElement.contains(J7.relatedTarget)?U$.current&&(U$.current.style.display="none"):AI()},onFocus:NI,onMouseEnter:NI,onMouseLeave:AI},k$),z$&&Et.createElement(tS,{ariaControlsSuffix:mO,contentRef:U$,offset:E$,position:D$,targetRef:V$},b$()))},nt.Viewer=function(q1){var a$=q1.characterMap,b$=q1.defaultScale,E$=q1.enableSmoothScroll,D$=E$===void 0||E$,k$=q1.fileUrl,W$=q1.httpHeaders,z$=W$===void 0?{}:W$,A$=q1.initialPage,V$=A$===void 0?0:A$,U$=q1.pageLayout,mO=q1.initialRotation,NI=mO===void 0?0:mO,AI=q1.localization,J7=q1.plugins,_7=J7===void 0?[]:J7,B9=q1.renderError,HQ=q1.renderLoader,gX=q1.renderPage,DX=q1.renderProtectedView,gK=q1.scrollMode,kq=gK===void 0?nt.ScrollMode.Vertical:gK,_K=q1.setRenderRange,DY=_K===void 0?Fre:_K,JQ=q1.transformGetDocumentParams,ZQ=q1.theme,eee=ZQ===void 0?{direction:nt.TextDirection.LeftToRight,theme:"light"}:ZQ,tee=q1.viewMode,ree=tee===void 0?nt.ViewMode.SinglePage:tee,xee=q1.withCredentials,dee=xee!==void 0&&xee,bee=q1.onDocumentAskPassword,mee=q1.onDocumentLoad,vee=mee===void 0?function(){}:mee,yee=q1.onPageChange,gee=yee===void 0?function(){}:yee,Mee=q1.onRotate,jee=Mee===void 0?function(){}:Mee,Fee=q1.onRotatePage,_ee=Fee===void 0?function(){}:Fee,Pee=q1.onSwitchTheme,Bee=Pee===void 0?function(){}:Pee,IY=q1.onZoom,IX=IY===void 0?function(){}:IY,Lq=Et.useState({data:k$,name:typeof k$=="string"?k$:"",shouldLoad:!1}),Bq=Lq[0],Fq=Lq[1],CK=function(uee,pee){Fq({data:pee,name:uee,shouldLoad:!0})},TK=Et.useState(!1),Vq=TK[0],Rq=TK[1],zQ=X1(Bq);Et.useEffect(function(){var uee,pee,wee,aee;uee=zQ.data,aee=typeof(pee=k$),(wee=typeof uee)=="string"&&aee==="string"&&uee===pee||wee==="object"&&aee==="object"&&uee.length===pee.length&&uee.every(function(Hee,tte){return Hee===pee[tte]})||Fq({data:k$,name:typeof k$=="string"?k$:"",shouldLoad:Vq})},[k$,Vq]);var XQ=zr({onVisibilityChanged:function(uee){Rq(uee.isVisible),uee.isVisible&&Fq(function(pee){return Object.assign({},pee,{shouldLoad:!0})})}}),cee=typeof eee=="string"?{direction:nt.TextDirection.LeftToRight,theme:eee}:eee,see=Et.useState(AI||a1),Eee=see[0],$ee=see[1],jQ={l10n:Eee,setL10n:$ee},Aee=Object.assign({},{direction:cee.direction},Lre(cee.theme||"light",Bee));return Et.useEffect(function(){AI&&$ee(AI)},[AI]),Et.createElement(Vx.Provider,{value:jQ},Et.createElement(dr.Provider,{value:Aee},Et.createElement("div",{ref:XQ,className:"rpv-core__viewer rpv-core__viewer--".concat(Aee.currentTheme),"data-testid":"core__viewer",style:{height:"100%",width:"100%"}},Bq.shouldLoad&&Et.createElement(kre,{characterMap:a$,file:Bq.data,httpHeaders:z$,render:function(uee){return Et.createElement(Ire,{defaultScale:b$,doc:uee,render:function(pee,wee){return Et.createElement(Rre,{currentFile:{data:Bq.data,name:Bq.name},defaultScale:b$,doc:uee,enableSmoothScroll:D$,initialPage:V$,initialRotation:NI,initialScale:wee,pageLayout:U$,pageSizes:pee,plugins:_7,renderPage:gX,scrollMode:kq,setRenderRange:DY,viewMode:ree,viewerState:{file:Bq,fullScreenMode:nt.FullScreenMode.Normal,pageIndex:-1,pageHeight:pee[0].pageHeight,pageWidth:pee[0].pageWidth,pagesRotation:new Map,rotation:NI,scale:wee,scrollMode:kq,viewMode:ree},onDocumentLoad:vee,onOpenFile:CK,onPageChange:gee,onRotate:jee,onRotatePage:_ee,onZoom:IX})},scrollMode:kq,viewMode:ree})},renderError:B9,renderLoader:HQ,renderProtectedView:DX,transformGetDocumentParams:JQ,withCredentials:dee,onDocumentAskPassword:bee}))))},nt.Worker=function(q1){var a$=q1.children,b$=q1.workerUrl;return At.GlobalWorkerOptions.workerSrc=b$,Et.createElement(Et.Fragment,null,a$)},nt.chunk=u$,nt.classNames=Mr,nt.createStore=function(q1){var a$=q1||{},b$={},E$=function(k$,W$){var z$;a$=Bt(Bt({},a$),((z$={})[k$]=W$,z$)),(b$[k$]||[]).forEach(function(A$){return A$(a$[k$])})},D$=function(k$){return a$[k$]};return{subscribe:function(k$,W$){b$[k$]=(b$[k$]||[]).concat(W$)},unsubscribe:function(k$,W$){b$[k$]=(b$[k$]||[]).filter(function(z$){return z$!==W$})},update:function(k$,W$){E$(k$,W$)},updateCurrentValue:function(k$,W$){var z$=D$(k$);z$!==void 0&&E$(k$,W$(z$))},get:function(k$){return D$(k$)}}},nt.getDestination=gD,nt.getPage=J$,nt.isFullScreenEnabled=ds,nt.isMac=function(){return typeof window<"u"&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)},nt.useDebounceCallback=uu,nt.useIntersectionObserver=zr,nt.useIsMounted=p0,nt.useIsomorphicLayoutEffect=Tr,nt.usePrevious=X1,nt.useRenderQueue=hu})(core_min);/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$h.exports=core_min;var libExports$h=lib$h.exports,lib$g={exports:{}},defaultLayout_min={},lib$f={exports:{}},attachment_min={},e$e=libExports$h;function t$e(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var n$e=t$e(reactExports),a$e=function(nt){var st=nt.files,mt=n$e.useRef(),gt=n$e.useContext(e$e.LocalizationContext).l10n,_t=n$e.useContext(e$e.ThemeContext).direction===e$e.TextDirection.RightToLeft,Et=n$e.useRef([]),At=gt&&gt.attachment?gt.attachment.clickToDownload:"Click to download",Rt=function(Ft){var Nt=mt.current,Bt=[].slice.call(Nt.getElementsByClassName("rpv-attachment__item"));if(Bt.length!==0){Bt.forEach(function(Mr){return Mr.setAttribute("tabindex","-1")});var Gt=document.activeElement,dr=Bt[Math.min(Bt.length-1,Math.max(0,Ft(Bt,Gt)))];dr.setAttribute("tabindex","0"),dr.focus()}};return e$e.useIsomorphicLayoutEffect(function(){var Ft=mt.current;if(Ft){var Nt=[].slice.call(Ft.getElementsByClassName("rpv-attachment__item"));if(Et.current=Nt,Nt.length>0){var Bt=Nt[0];Bt.focus(),Bt.setAttribute("tabindex","0")}}},[]),n$e.createElement("div",{"data-testid":"attachment__list",className:e$e.classNames({"rpv-attachment__list":!0,"rpv-attachment__list--rtl":_t}),ref:mt,tabIndex:-1,onKeyDown:function(Ft){switch(Ft.key){case"ArrowDown":Ft.preventDefault(),Rt(function(Nt,Bt){return Nt.indexOf(Bt)+1});break;case"ArrowUp":Ft.preventDefault(),Rt(function(Nt,Bt){return Nt.indexOf(Bt)-1});break;case"End":Ft.preventDefault(),Rt(function(Nt,Bt){return Nt.length-1});break;case"Home":Ft.preventDefault(),Rt(function(Nt,Bt){return 0})}}},st.map(function(Ft){return n$e.createElement("button",{className:"rpv-attachment__item",key:Ft.fileName,tabIndex:-1,title:At,type:"button",onClick:function(){return Nt=Ft.fileName,Bt=Ft.data,Gt=typeof Bt=="string"?"":URL.createObjectURL(new Blob([Bt],{type:""})),(dr=document.createElement("a")).style.display="none",dr.href=Gt||Nt,dr.setAttribute("download",function(Mr){var Tr=Mr.split("/").pop();return Tr?Tr.split("#")[0].split("?")[0]:Mr}(Nt)),document.body.appendChild(dr),dr.click(),document.body.removeChild(dr),void(Gt&&URL.revokeObjectURL(Gt));var Nt,Bt,Gt,dr}},Ft.fileName)}))},r$e=function(nt){var st=nt.doc,mt=n$e.useContext(e$e.LocalizationContext).l10n,gt=n$e.useContext(e$e.ThemeContext).direction===e$e.TextDirection.RightToLeft,_t=mt&&mt.attachment?mt.attachment.noAttachment:"There is no attachment",Et=n$e.useState({files:[],isLoaded:!1}),At=Et[0],Rt=Et[1];return n$e.useEffect(function(){st.getAttachments().then(function(Ft){var Nt=Ft?Object.keys(Ft).map(function(Bt){return{data:Ft[Bt].content,fileName:Ft[Bt].filename}}):[];Rt({files:Nt,isLoaded:!0})})},[st]),At.isLoaded?At.files.length===0?n$e.createElement("div",{"data-testid":"attachment__empty",className:e$e.classNames({"rpv-attachment__empty":!0,"rpv-attachment__empty--rtl":gt})},_t):n$e.createElement(a$e,{files:At.files}):n$e.createElement(e$e.Spinner,null)},c$e=function(nt){var st=nt.store,mt=n$e.useState(st.get("doc")),gt=mt[0],_t=mt[1],Et=function(At){_t(At)};return n$e.useEffect(function(){return st.subscribe("doc",Et),function(){st.unsubscribe("doc",Et)}},[]),gt?n$e.createElement(r$e,{doc:gt}):n$e.createElement("div",{className:"rpv-attachment__loader"},n$e.createElement(e$e.Spinner,null))};attachment_min.attachmentPlugin=function(){var nt=n$e.useMemo(function(){return e$e.createStore({})},[]);return{onDocumentLoad:function(st){nt.update("doc",st.doc)},Attachments:function(){return n$e.createElement(c$e,{store:nt})}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$f.exports=attachment_min;var libExports$g=lib$f.exports,lib$e={exports:{}},bookmark_min={},e$d=libExports$h;function t$d(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var r$d,o$d=t$d(reactExports),n$d=function(){return n$d=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},n$d.apply(this,arguments)},a$d=function(){return o$d.createElement(e$d.Icon,{size:16},o$d.createElement("path",{d:"M6.427,8.245A.5.5,0,0,1,6.862,7.5H17.138a.5.5,0,0,1,.435.749l-5.139,9a.5.5,0,0,1-.868,0Z"}))},i$d=function(){return o$d.createElement(e$d.Icon,{size:16},o$d.createElement("path",{d:"M9.248,17.572a.5.5,0,0,1-.748-.434V6.862a.5.5,0,0,1,.748-.434l8.992,5.138a.5.5,0,0,1,0,.868Z"}))},c$d=function(nt){var st=nt.bookmark,mt=nt.depth,gt=nt.doc,_t=nt.index,Et=nt.isBookmarkExpanded,At=nt.numberOfSiblings,Rt=nt.pathFromRoot,Ft=nt.renderBookmarkItem,Nt=nt.store,Bt=Rt?"".concat(Rt,".").concat(_t):"".concat(_t),Gt=o$d.useMemo(function(){return function(ts){var Ko=ts.count,ds=ts.items;if(Ko>=0)return!1;var Il=ds.length;if(Il===0)return!1;for(var ru=ds.concat([]);ru.length>0;){var uu=ru.shift(),p0=uu.items;uu.count&&p0&&uu.count>0&&p0.length>0&&(Il+=p0.length,ru=ru.concat(p0))}return Math.abs(Ko)===Il}(st)},[st]),dr=Nt.get("bookmarkExpandedMap"),Mr=Et?Et({bookmark:st,doc:gt,depth:mt,index:_t}):dr.has(Bt)?dr.get(Bt):!Gt,Tr=o$d.useState(Mr),zr=Tr[0],Fr=Tr[1],Nr=st.items&&st.items.length>0,tn=function(){var ts=!zr;Nt.updateCurrentValue("bookmarkExpandedMap",function(Ko){return Ko.set(Bt,ts)}),Fr(ts)},rn=function(){var ts=st.dest,Ko=Nt.get("jumpToDestination");e$d.getDestination(gt,ts).then(function(ds){Ko&&Ko(n$d({label:st.title},ds))})},Tn=function(){Nr&&st.dest&&rn()},$n=function(){!Nr&&st.dest&&rn()},un=function(ts,Ko){return o$d.createElement("div",{className:"rpv-bookmark__item",style:{paddingLeft:"".concat(1.25*mt,"rem")},onClick:ts},Ko)},es=function(ts,Ko){return Nr?o$d.createElement("span",{className:"rpv-bookmark__toggle","data-testid":"bookmark__toggle-".concat(mt,"-").concat(_t),onClick:tn},zr?ts:Ko):o$d.createElement("span",{className:"rpv-bookmark__toggle"})},kn=function(ts){return st.url?o$d.createElement("a",{className:"rpv-bookmark__title",href:st.url,rel:"noopener noreferrer nofollow",target:st.newWindow?"_blank":""},st.title):o$d.createElement("div",{className:"rpv-bookmark__title","aria-label":st.title,onClick:ts},st.title)};return o$d.createElement("li",{"aria-expanded":zr?"true":"false","aria-label":st.title,"aria-level":mt+1,"aria-posinset":_t+1,"aria-setsize":At,role:"treeitem",tabIndex:-1},Ft?Ft({bookmark:st,depth:mt,hasSubItems:Nr,index:_t,isExpanded:zr,path:Bt,defaultRenderItem:un,defaultRenderTitle:kn,defaultRenderToggle:es,onClickItem:$n,onClickTitle:Tn,onToggleSubItems:tn}):un($n,o$d.createElement(o$d.Fragment,null,es(o$d.createElement(a$d,null),o$d.createElement(i$d,null)),kn(Tn))),Nr&&zr&&o$d.createElement(m$9,{bookmarks:st.items,depth:mt+1,doc:gt,isBookmarkExpanded:Et,isRoot:!1,pathFromRoot:Bt,renderBookmarkItem:Ft,store:Nt}))},m$9=function(nt){var st=nt.bookmarks,mt=nt.depth,gt=mt===void 0?0:mt,_t=nt.doc,Et=nt.isBookmarkExpanded,At=nt.isRoot,Rt=nt.pathFromRoot,Ft=nt.renderBookmarkItem,Nt=nt.store;return o$d.createElement("ul",{className:"rpv-bookmark__list",role:At?"tree":"group",tabIndex:-1},st.map(function(Bt,Gt){return o$d.createElement(c$d,{bookmark:Bt,depth:gt,doc:_t,index:Gt,isBookmarkExpanded:Et,key:Gt,numberOfSiblings:st.length,pathFromRoot:Rt,renderBookmarkItem:Ft,store:Nt})}))};(function(nt){nt[nt.Collapse=0]="Collapse",nt[nt.Expand=1]="Expand"})(r$d||(r$d={}));var l$d=function(nt){var st=nt.bookmarks,mt=nt.doc,gt=nt.isBookmarkExpanded,_t=nt.renderBookmarkItem,Et=nt.store,At=o$d.useRef(),Rt=function(Gt){var dr=At.current;if(dr&&Gt.target instanceof HTMLElement&&dr.contains(Gt.target))switch(Gt.key){case"ArrowDown":Gt.preventDefault(),Nt(function(Mr,Tr){return Mr.indexOf(Tr)+1});break;case"ArrowLeft":Gt.preventDefault(),Bt(r$d.Collapse);break;case"ArrowRight":Gt.preventDefault(),Bt(r$d.Expand);break;case"ArrowUp":Gt.preventDefault,Nt(function(Mr,Tr){return Mr.indexOf(Tr)-1});break;case"End":Gt.preventDefault(),Nt(function(Mr,Tr){return Mr.length-1});break;case" ":case"Enter":case"Space":Gt.preventDefault(),Ft();break;case"Home":Gt.preventDefault(),Nt(function(Mr,Tr){return 0})}},Ft=function(){var Gt=document.activeElement.closest(".rpv-bookmark__item").querySelector(".rpv-bookmark__title");Gt&&Gt.click()},Nt=function(Gt){var dr=At.current,Mr=[].slice.call(dr.getElementsByClassName("rpv-bookmark__item"));if(Mr.length!==0){var Tr=document.activeElement,zr=Mr[Math.min(Mr.length-1,Math.max(0,Gt(Mr,Tr)))];Tr.setAttribute("tabindex","-1"),zr.setAttribute("tabindex","0"),zr.focus()}},Bt=function(Gt){var dr=At.current;if([].slice.call(dr.getElementsByClassName("rpv-bookmark__item")).length!==0){var Mr=document.activeElement.closest(".rpv-bookmark__item"),Tr=Gt===r$d.Collapse?"true":"false";if(Mr&&Mr.parentElement.getAttribute("aria-expanded")===Tr){var zr=Mr.querySelector(".rpv-bookmark__toggle");zr&&zr.click()}}};return o$d.useEffect(function(){return document.addEventListener("keydown",Rt),function(){document.removeEventListener("keydown",Rt)}},[]),o$d.useEffect(function(){var Gt=At.current;if(Gt){var dr=[].slice.call(Gt.getElementsByClassName("rpv-bookmark__item"));dr.length>0&&(dr[0].focus(),dr[0].setAttribute("tabindex","0"))}},[]),o$d.createElement("div",{ref:At},o$d.createElement(m$9,{bookmarks:st,depth:0,doc:mt,isBookmarkExpanded:gt,isRoot:!0,pathFromRoot:"",renderBookmarkItem:_t,store:Et}))},s$9=function(nt){var st=nt.doc,mt=nt.isBookmarkExpanded,gt=nt.renderBookmarkItem,_t=nt.store,Et=o$d.useContext(e$d.LocalizationContext).l10n,At=o$d.useContext(e$d.ThemeContext).direction===e$d.TextDirection.RightToLeft,Rt=o$d.useState({isLoaded:!1,items:[]}),Ft=Rt[0],Nt=Rt[1];return o$d.useEffect(function(){Nt({isLoaded:!1,items:[]}),st.getOutline().then(function(Bt){Nt({isLoaded:!0,items:Bt||[]})})},[st]),Ft.isLoaded?Ft.items.length===0?o$d.createElement("div",{"data-testid":"bookmark__empty",className:e$d.classNames({"rpv-bookmark__empty":!0,"rpv-bookmark__empty--rtl":At})},Et&&Et.bookmark?Et.bookmark.noBookmark:"There is no bookmark"):o$d.createElement("div",{"data-testid":"bookmark__container",className:e$d.classNames({"rpv-bookmark__container":!0,"rpv-bookmark__container--rtl":At})},o$d.createElement(l$d,{bookmarks:Ft.items,doc:st,isBookmarkExpanded:mt,renderBookmarkItem:gt,store:_t})):o$d.createElement("div",{className:"rpv-bookmark__loader"},o$d.createElement(e$d.Spinner,null))},u$d=function(nt){var st=nt.isBookmarkExpanded,mt=nt.renderBookmarkItem,gt=nt.store,_t=o$d.useState(gt.get("doc")),Et=_t[0],At=_t[1],Rt=function(Ft){At(Ft)};return o$d.useEffect(function(){return gt.subscribe("doc",Rt),function(){gt.unsubscribe("doc",Rt)}},[]),Et?o$d.createElement(s$9,{doc:Et,isBookmarkExpanded:st,renderBookmarkItem:mt,store:gt}):o$d.createElement("div",{className:"rpv-bookmark__loader"},o$d.createElement(e$d.Spinner,null))};bookmark_min.DownArrowIcon=a$d,bookmark_min.RightArrowIcon=i$d,bookmark_min.bookmarkPlugin=function(){var nt=o$d.useMemo(function(){return e$d.createStore({bookmarkExpandedMap:new Map})},[]);return{install:function(st){nt.update("jumpToDestination",st.jumpToDestination)},onDocumentLoad:function(st){nt.update("doc",st.doc)},Bookmarks:function(st){return o$d.createElement(u$d,{isBookmarkExpanded:st==null?void 0:st.isBookmarkExpanded,renderBookmarkItem:st==null?void 0:st.renderBookmarkItem,store:nt})}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$e.exports=bookmark_min;var libExports$f=lib$e.exports,lib$d={exports:{}},thumbnail_min={};(function(nt){var st=libExports$h;function mt(zr){var Fr=Object.create(null);return zr&&Object.keys(zr).forEach(function(Nr){if(Nr!=="default"){var tn=Object.getOwnPropertyDescriptor(zr,Nr);Object.defineProperty(Fr,Nr,tn.get?tn:{enumerable:!0,get:function(){return zr[Nr]}})}}),Fr.default=zr,Object.freeze(Fr)}var gt,_t=mt(reactExports);nt.ThumbnailDirection=void 0,(gt=nt.ThumbnailDirection||(nt.ThumbnailDirection={})).Horizontal="Horizontal",gt.Vertical="Vertical";var Et=function(){return Et=Object.assign||function(zr){for(var Fr,Nr=1,tn=arguments.length;Nr<tn;Nr++)for(var rn in Fr=arguments[Nr])Object.prototype.hasOwnProperty.call(Fr,rn)&&(zr[rn]=Fr[rn]);return zr},Et.apply(this,arguments)},At=function(zr){var Fr=zr.doc,Nr=zr.getPageIndex,tn=zr.renderSpinner,rn=zr.store,Tn=zr.width,$n=Fr.numPages,un=Nr?Nr({numPages:$n}):0,es=Math.max(0,Math.min(un,$n-1)),kn=rn.get("pagesRotation")||new Map,ts=kn.has(es)?kn.get(es):0,Ko=_t.useState(""),ds=Ko[0],Il=Ko[1],ru=st.useIsMounted(),uu=_t.useRef(),p0=_t.useState(rn.get("rotation")||0),X1=p0[0],q0=p0[1],W0=_t.useState(ts),hu=W0[0],a1=W0[1],Vx=_t.useState(!1),t0=Vx[0],cu=Vx[1],lu=function(LE){var eS=LE.has(es)?LE.get(es):0;a1(eS)},b0=function(LE){q0(LE)},l1=st.useIntersectionObserver({onVisibilityChanged:function(LE){cu(LE.isVisible)}});return _t.useEffect(function(){if(t0){var LE=l1.current;LE&&(Il(""),st.getPage(Fr,es).then(function(eS){var SA=eS.getViewport({scale:1}),o$=(SA.rotation+X1+hu)%360,h$=Math.abs(X1+hu)%180==0,d$=h$?SA.width:SA.height,y$=h$?SA.height:SA.width,R$=document.createElement("canvas"),M$=R$.getContext("2d",{alpha:!1}),x$=LE.clientWidth,v$=LE.clientHeight,rS=Tn?Tn/d$:Math.min(x$/d$,v$/y$),wA=rS*d$,g$=rS*y$;R$.height=g$,R$.width=wA,R$.style.opacity="0";var S$=eS.getViewport({rotation:o$,scale:rS});uu.current=eS.render({canvasContext:M$,viewport:S$}),uu.current.promise.then(function(){ru.current&&Il(R$.toDataURL()),R$.width=0,R$.height=0},function(){})}))}},[hu,t0]),_t.useEffect(function(){return rn.subscribe("pagesRotation",lu),rn.subscribe("rotation",b0),function(){rn.unsubscribe("pagesRotation",lu),rn.unsubscribe("rotation",b0)}},[]),_t.useEffect(function(){return function(){var LE;(LE=uu.current)===null||LE===void 0||LE.cancel()}},[]),_t.createElement("div",{ref:l1,className:"rpv-thumbnail__cover-inner","data-testid":"thumbnail__cover-inner"},ds?_t.createElement("img",{className:"rpv-thumbnail__cover-image","data-testid":"thumbnail__cover-image",src:ds}):_t.createElement("div",{className:"rpv-thumbnail__cover-loader","data-testid":"thumbnail__cover-loader"},tn?tn():_t.createElement(st.Spinner,null)))},Rt=function(zr){var Fr=zr.getPageIndex,Nr=zr.renderSpinner,tn=zr.store,rn=zr.width,Tn=_t.useState(tn.get("doc")),$n=Tn[0],un=Tn[1],es=function(kn){un(kn)};return _t.useEffect(function(){return tn.subscribe("doc",es),function(){tn.unsubscribe("doc",es)}},[]),_t.createElement("div",{className:"rpv-thumbnail__cover"},$n?_t.createElement(At,{doc:$n,getPageIndex:Fr,renderSpinner:Nr,store:tn,width:rn}):_t.createElement("div",{className:"rpv-thumbnail__cover-loader"},Nr?Nr():_t.createElement(st.Spinner,null)))},Ft=function(){return _t.createElement(st.Spinner,null)},Nt=_t.createContext({renderSpinner:Ft}),Bt=function(zr){var Fr=zr.children,Nr=zr.doc,tn=st.useIsMounted(),rn=_t.useState({loading:!0,labels:[]}),Tn=rn[0],$n=rn[1];return _t.useEffect(function(){Nr.getPageLabels().then(function(un){tn.current&&$n({loading:!1,labels:un||[]})})},[Nr.loadingTask.docId]),Tn.loading?_t.createElement(_t.Fragment,null):Fr(Tn.labels)},Gt=function(zr){var Fr=zr.page,Nr=zr.pageHeight,tn=zr.pageIndex,rn=zr.pageWidth,Tn=zr.rotation,$n=zr.thumbnailHeight,un=zr.thumbnailWidth,es=zr.onRenderCompleted,kn=_t.useContext(st.LocalizationContext).l10n,ts=_t.useRef(),Ko=_t.useState(""),ds=Ko[0],Il=Ko[1],ru=kn&&kn.thumbnail?kn.thumbnail.thumbnailLabel:"Thumbnail of page {{pageIndex}}";return _t.useEffect(function(){var uu=ts.current;uu&&uu.cancel();var p0=document.createElement("canvas"),X1=p0.getContext("2d",{alpha:!1}),q0=un,W0=q0/(rn/Nr),hu=q0/rn;p0.height=W0,p0.width=q0,p0.style.height="".concat(W0,"px"),p0.style.width="".concat(q0,"px");var a1=Fr.getViewport({rotation:Tn,scale:hu});return ts.current=Fr.render({canvasContext:X1,viewport:a1}),ts.current.promise.then(function(){Il(p0.toDataURL()),es(tn)},function(){es(tn)}),function(){var Vx;(Vx=ts.current)===null||Vx===void 0||Vx.cancel()}},[Tn]),ds?_t.createElement("img",{"aria-label":ru.replace("{{pageIndex}}","".concat(tn+1)),src:ds,height:"".concat($n,"px"),width:"".concat(un,"px")}):_t.useContext(Nt).renderSpinner()},dr=function(zr){var Fr=zr.doc,Nr=zr.pageHeight,tn=zr.pageIndex,rn=zr.pageRotation,Tn=zr.pageWidth,$n=zr.rotation,un=zr.shouldRender,es=zr.thumbnailWidth,kn=zr.onRenderCompleted,ts=zr.onVisibilityChanged,Ko=st.useIsMounted(),ds=_t.useState({height:Nr,page:null,viewportRotation:0,width:Tn}),Il=ds[0],ru=ds[1],uu=Il.page,p0=Il.height,X1=Il.width,q0=X1/p0,W0=Math.abs($n+rn)%180==0,hu=W0?es:es/q0,a1=W0?es/q0:es;_t.useEffect(function(){un&&st.getPage(Fr,tn).then(function(cu){var lu=cu.getViewport({scale:1});Ko.current&&ru({height:lu.height,page:cu,viewportRotation:lu.rotation,width:lu.width})})},[un]);var Vx=(Il.viewportRotation+$n+rn)%360,t0=st.useIntersectionObserver({onVisibilityChanged:function(cu){ts(tn,cu)}});return _t.createElement("div",{className:"rpv-thumbnail__container","data-testid":"thumbnail__container-".concat(tn),ref:t0,style:{height:"".concat(a1,"px"),width:"".concat(hu,"px")}},uu?_t.createElement(Gt,{page:uu,pageHeight:W0?p0:X1,pageIndex:tn,pageWidth:W0?X1:p0,rotation:Vx,thumbnailHeight:a1,thumbnailWidth:hu,onRenderCompleted:kn}):_t.useContext(Nt).renderSpinner())},Mr=function(zr){var Fr=zr.currentPage,Nr=zr.doc,tn=zr.labels,rn=zr.pagesRotation,Tn=zr.pageHeight,$n=zr.pageWidth,un=zr.renderCurrentPageLabel,es=zr.renderThumbnailItem,kn=zr.rotatedPage,ts=zr.rotation,Ko=zr.thumbnailDirection,ds=zr.thumbnailWidth,Il=zr.viewMode,ru=zr.onJumpToPage,uu=zr.onRotatePage,p0=Nr.numPages,X1=Nr.loadingTask.docId,q0=_t.useRef(null),W0=_t.useRef([]),hu=_t.useState(Fr),a1=hu[0],Vx=hu[1],t0=_t.useContext(st.ThemeContext).direction===st.TextDirection.RightToLeft,cu=_t.useState(-1),lu=cu[0],b0=cu[1],l1=st.useIsMounted(),LE=st.usePrevious(Il),eS=_t.useRef(!1),SA=st.useRenderQueue({doc:Nr}),o$=_t.useMemo(function(){return Array(p0).fill(0).map(function(rS,wA){return wA})},[X1]),h$=_t.useMemo(function(){switch(Il){case st.ViewMode.DualPage:return st.chunk(o$,2);case st.ViewMode.DualPageWithCover:return[[o$[0]]].concat(st.chunk(o$.slice(1),2));case st.ViewMode.SinglePage:default:return st.chunk(o$,1)}},[X1,Il]),d$=function(){if(q0.current){var rS=W0.current,wA=a1+1;wA<rS.length&&(a1>=0&&rS[a1].setAttribute("tabindex","-1"),Vx(wA))}},y$=function(){if(q0.current){var rS=W0.current,wA=a1-1;wA>=0&&(a1>=0&&rS[a1].setAttribute("tabindex","-1"),Vx(wA))}},R$=function(){a1>=0&&a1<p0&&ru(a1)};st.useIsomorphicLayoutEffect(function(){var rS=q0.current;rS&&(W0.current=Array.from(rS.querySelectorAll(".rpv-thumbnail__item")))},[Il]),_t.useEffect(function(){var rS=W0.current;if(!(rS.length===0||a1<0||a1>rS.length)){var wA=rS[a1];wA.setAttribute("tabindex","0"),wA.focus()}},[a1]),st.useIsomorphicLayoutEffect(function(){var rS=q0.current,wA=W0.current;if(!(!rS||wA.length===0||Fr<0||Fr>wA.length)){var g$=wA[Fr].closest(".rpv-thumbnail__items");g$&&(Ko===nt.ThumbnailDirection.Vertical?function(S$,tA){var tS=S$.getBoundingClientRect().top-tA.getBoundingClientRect().top,m$=S$.clientHeight,u$=tA.clientHeight;tS<0?tA.scrollTop+=tS:tS+m$<=u$||(tA.scrollTop+=tS+m$-u$)}(g$,rS):function(S$,tA){var tS=S$.getBoundingClientRect().left-tA.getBoundingClientRect().left,m$=S$.clientWidth,u$=tA.clientWidth;tS<0?tA.scrollLeft+=tS:tS+m$<=u$||(tA.scrollLeft+=tS+m$-u$)}(g$,rS))}},[Fr,Ko]);var M$=_t.useCallback(function(rS){l1.current&&(SA.markRendered(rS),eS.current=!1,v$())},[X1]),x$=_t.useCallback(function(rS,wA){wA.isVisible?SA.setVisibility(rS,wA.ratio):SA.setOutOfRange(rS),v$()},[X1]),v$=_t.useCallback(function(){if(!eS.current){var rS=SA.getHighestPriorityPage();rS>-1&&(SA.markRendering(rS),eS.current=!0,b0(rS))}},[X1]);return _t.useEffect(function(){kn>=0&&(SA.markRendering(kn),eS.current=!0,b0(kn))},[X1,kn]),st.useIsomorphicLayoutEffect(function(){LE!==Il&&(SA.markNotRendered(),v$())},[Il]),_t.createElement("div",{ref:q0,"data-testid":"thumbnail__list",className:st.classNames({"rpv-thumbnail__list":!0,"rpv-thumbnail__list--horizontal":Ko===nt.ThumbnailDirection.Horizontal,"rpv-thumbnail__list--rtl":t0,"rpv-thumbnail__list--vertical":Ko===nt.ThumbnailDirection.Vertical}),onKeyDown:function(rS){switch(rS.key){case"ArrowDown":d$();break;case"ArrowUp":y$();break;case"Enter":R$()}}},h$.map(function(rS,wA){var g$=!1;switch(Il){case st.ViewMode.DualPage:g$=Fr===2*wA||Fr===2*wA+1;break;case st.ViewMode.DualPageWithCover:g$=Fr===0&&wA===0||wA>0&&Fr===2*wA-1||wA>0&&Fr===2*wA;break;case st.ViewMode.SinglePage:default:g$=Fr===wA}return _t.createElement("div",{className:st.classNames({"rpv-thumbnail__items":!0,"rpv-thumbnail__items--dual":Il===st.ViewMode.DualPage,"rpv-thumbnail__items--dual-cover":Il===st.ViewMode.DualPageWithCover,"rpv-thumbnail__items--single":Il===st.ViewMode.SinglePage,"rpv-thumbnail__items--selected":g$}),key:"".concat(wA,"___").concat(Il)},rS.map(function(S$){return function(tA){var tS=Il===st.ViewMode.DualPageWithCover&&(tA===0||p0%2==0&&tA===p0-1),m$="".concat(Nr.loadingTask.docId,"___").concat(tA),u$=tn.length===p0?tn[tA]:"".concat(tA+1),UE=un?un({currentPage:Fr,pageIndex:tA,numPages:p0,pageLabel:u$}):u$,F$=rn.has(tA)?rn.get(tA):0,EI=_t.createElement(dr,{doc:Nr,pageHeight:Tn,pageIndex:tA,pageRotation:F$,pageWidth:$n,rotation:ts,shouldRender:lu===tA,thumbnailWidth:ds,onRenderCompleted:M$,onVisibilityChanged:x$});return es?es({currentPage:Fr,key:m$,numPages:p0,pageIndex:tA,renderPageLabel:_t.createElement(_t.Fragment,null,UE),renderPageThumbnail:EI,onJumpToPage:function(){return ru(tA)},onRotatePage:function(pR){return uu(tA,pR)}}):_t.createElement("div",{key:m$},_t.createElement("div",{className:st.classNames({"rpv-thumbnail__item":!0,"rpv-thumbnail__item--dual-even":Il===st.ViewMode.DualPage&&tA%2==0,"rpv-thumbnail__item--dual-odd":Il===st.ViewMode.DualPage&&tA%2==1,"rpv-thumbnail__item--dual-cover":tS,"rpv-thumbnail__item--dual-cover-even":Il===st.ViewMode.DualPageWithCover&&!tS&&tA%2==0,"rpv-thumbnail__item--dual-cover-odd":Il===st.ViewMode.DualPageWithCover&&!tS&&tA%2==1,"rpv-thumbnail__item--single":Il===st.ViewMode.SinglePage,"rpv-thumbnail__item--selected":Fr===tA}),role:"button",tabIndex:Fr===tA?0:-1,onClick:function(){return ru(tA)}},EI),_t.createElement("div",{"data-testid":"thumbnail__label-".concat(tA),className:"rpv-thumbnail__label"},UE))}(S$)}))}))},Tr=function(zr){var Fr=zr.renderCurrentPageLabel,Nr=zr.renderThumbnailItem,tn=zr.store,rn=zr.thumbnailDirection,Tn=zr.thumbnailWidth,$n=_t.useState(tn.get("doc")),un=$n[0],es=$n[1],kn=_t.useState(tn.get("currentPage")||0),ts=kn[0],Ko=kn[1],ds=_t.useState(tn.get("pageHeight")||0),Il=ds[0],ru=ds[1],uu=_t.useState(tn.get("pageWidth")||0),p0=uu[0],X1=uu[1],q0=_t.useState(tn.get("rotation")||0),W0=q0[0],hu=q0[1],a1=_t.useState(tn.get("pagesRotation")||new Map),Vx=a1[0],t0=a1[1],cu=_t.useState(tn.get("rotatedPage")||-1),lu=cu[0],b0=cu[1],l1=_t.useState(tn.get("viewMode")),LE=l1[0],eS=l1[1],SA=function(wA){Ko(wA)},o$=function(wA){es(wA)},h$=function(wA){ru(wA)},d$=function(wA){X1(wA)},y$=function(wA){hu(wA)},R$=function(wA){t0(wA)},M$=function(wA){b0(wA)},x$=function(wA){eS(wA)},v$=function(wA){var g$=tn.get("jumpToPage");g$&&g$(wA)},rS=function(wA,g$){tn.get("rotatePage")(wA,g$)};return _t.useEffect(function(){return tn.subscribe("doc",o$),tn.subscribe("pageHeight",h$),tn.subscribe("pageWidth",d$),tn.subscribe("rotatedPage",M$),tn.subscribe("rotation",y$),tn.subscribe("pagesRotation",R$),tn.subscribe("viewMode",x$),function(){tn.unsubscribe("doc",o$),tn.unsubscribe("pageHeight",h$),tn.unsubscribe("pageWidth",d$),tn.unsubscribe("rotatedPage",M$),tn.unsubscribe("rotation",y$),tn.unsubscribe("pagesRotation",R$),tn.unsubscribe("viewMode",x$)}},[]),st.useIsomorphicLayoutEffect(function(){return tn.subscribe("currentPage",SA),function(){tn.unsubscribe("currentPage",SA)}},[]),un?_t.createElement(st.LazyRender,{testId:"thumbnail__list-container",attrs:{className:"rpv-thumbnail__list-container"}},_t.createElement(Bt,{doc:un},function(wA){return _t.createElement(Mr,{currentPage:ts,doc:un,labels:wA,pagesRotation:Vx,pageHeight:Il,pageWidth:p0,renderCurrentPageLabel:Fr,renderThumbnailItem:Nr,rotatedPage:lu,rotation:W0,thumbnailDirection:rn,thumbnailWidth:Tn,viewMode:LE,onJumpToPage:v$,onRotatePage:rS})})):_t.createElement("div",{"data-testid":"thumbnail-list__loader",className:"rpv-thumbnail__loader"},_t.useContext(Nt).renderSpinner())};nt.thumbnailPlugin=function(zr){var Fr=_t.useMemo(function(){return st.createStore({rotatePage:function(){},viewMode:st.ViewMode.SinglePage})},[]),Nr=_t.useState(""),tn=Nr[0],rn=Nr[1];return{install:function(Tn){Fr.update("jumpToPage",Tn.jumpToPage),Fr.update("rotatePage",Tn.rotatePage)},onDocumentLoad:function(Tn){rn(Tn.doc.loadingTask.docId),Fr.update("doc",Tn.doc)},onViewerStateChange:function(Tn){return Fr.update("currentPage",Tn.pageIndex),Fr.update("pagesRotation",Tn.pagesRotation),Fr.update("pageHeight",Tn.pageHeight),Fr.update("pageWidth",Tn.pageWidth),Fr.update("rotation",Tn.rotation),Fr.update("rotatedPage",Tn.rotatedPage),Fr.update("viewMode",Tn.viewMode),Tn},Cover:function(Tn){return _t.createElement(Rt,Et({},Tn,{renderSpinner:zr==null?void 0:zr.renderSpinner,store:Fr}))},Thumbnails:_t.useCallback(function(Tn){return _t.createElement(Nt.Provider,{value:{renderSpinner:(zr==null?void 0:zr.renderSpinner)||Ft}},_t.createElement(Tr,{renderCurrentPageLabel:zr==null?void 0:zr.renderCurrentPageLabel,renderThumbnailItem:Tn==null?void 0:Tn.renderThumbnailItem,store:Fr,thumbnailDirection:(Tn==null?void 0:Tn.thumbnailDirection)||nt.ThumbnailDirection.Vertical,thumbnailWidth:(zr==null?void 0:zr.thumbnailWidth)||100}))},[tn])}}})(thumbnail_min);/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$d.exports=thumbnail_min;var libExports$e=lib$d.exports,lib$c={exports:{}},toolbar_min={},lib$b={exports:{}},selectionMode_min={};(function(nt){var st=libExports$h;function mt(Tr){var zr=Object.create(null);return Tr&&Object.keys(Tr).forEach(function(Fr){if(Fr!=="default"){var Nr=Object.getOwnPropertyDescriptor(Tr,Fr);Object.defineProperty(zr,Fr,Nr.get?Nr:{enumerable:!0,get:function(){return Tr[Fr]}})}}),zr.default=Tr,Object.freeze(zr)}var gt,_t=mt(reactExports),Et=function(){return _t.createElement(st.Icon,{size:16},_t.createElement("path",{d:`M11.5,5.5v-2C11.5,2.672,12.172,2,13,2s1.5,0.672,1.5,1.5v2 M14.5,11.5v-6C14.5,4.672,15.172,4,16,4
            c0.828,0,1.5,0.672,1.5,1.5v3 M17.5,13V8.5C17.5,7.672,18.172,7,19,7s1.5,0.672,1.5,1.5v10c0,2.761-2.239,5-5,5h-3.335
            c-1.712-0.001-3.305-0.876-4.223-2.321C6.22,18.467,4.083,14,4.083,14c-0.378-0.545-0.242-1.292,0.303-1.67
            c0.446-0.309,1.044-0.281,1.458,0.07L8.5,15.5v-10C8.5,4.672,9.172,4,10,4s1.5,0.672,1.5,1.5v6`}))},At=function(){return At=Object.assign||function(Tr){for(var zr,Fr=1,Nr=arguments.length;Fr<Nr;Fr++)for(var tn in zr=arguments[Fr])Object.prototype.hasOwnProperty.call(zr,tn)&&(Tr[tn]=zr[tn]);return Tr},At.apply(this,arguments)};nt.SelectionMode=void 0,(gt=nt.SelectionMode||(nt.SelectionMode={})).Hand="Hand",gt.Text="Text";var Rt=function(){return _t.createElement(st.Icon,{size:16},_t.createElement("path",{d:`M13.675,11.671l2.941-2.941c0.195-0.196,0.195-0.512-0.001-0.707C16.563,7.971,16.5,7.931,16.43,7.906
            L4.168,3.527C3.908,3.434,3.622,3.57,3.529,3.83c-0.039,0.109-0.039,0.228,0,0.336l4.379,12.262
            c0.093,0.26,0.379,0.396,0.639,0.303c0.07-0.025,0.133-0.065,0.185-0.117l2.943-2.943l6.146,6.146c0.195,0.195,0.512,0.195,0.707,0
            l1.293-1.293c0.195-0.195,0.195-0.512,0-0.707L13.675,11.671z`}))},Ft=function(Tr){var zr=Tr.children,Fr=Tr.mode,Nr=Tr.onClick,tn=_t.useContext(st.LocalizationContext).l10n,rn="",Tn=_t.createElement(Rt,null);switch(Fr){case nt.SelectionMode.Hand:rn=tn&&tn.selectionMode?tn.selectionMode.handTool:"Hand tool",Tn=_t.createElement(Et,null);break;case nt.SelectionMode.Text:default:rn=tn&&tn.selectionMode?tn.selectionMode.textSelectionTool:"Text selection tool",Tn=_t.createElement(Rt,null)}return zr({icon:Tn,label:rn,onClick:Nr})},Nt={left:0,top:8},Bt=function(Tr){var zr=Tr.isSelected,Fr=Tr.mode,Nr=Tr.onClick,tn="";switch(Fr){case nt.SelectionMode.Hand:tn="selection-mode__hand-button";break;case nt.SelectionMode.Text:default:tn="selection-mode__text-button"}return _t.createElement(Ft,{mode:Fr,onClick:Nr},function(rn){return _t.createElement(st.Tooltip,{ariaControlsSuffix:"selection-mode-switch",position:st.Position.BottomCenter,target:_t.createElement(st.MinimalButton,{ariaLabel:rn.label,isSelected:zr,testId:tn,onClick:rn.onClick},rn.icon),content:function(){return rn.label},offset:Nt})})},Gt=function(Tr){var zr=Tr.children,Fr=Tr.mode,Nr=Tr.store,tn=Fr===Nr.get("selectionMode");return(zr||function(rn){return _t.createElement(Bt,{isSelected:tn,mode:rn.mode,onClick:rn.onClick})})({isSelected:tn,mode:Fr,onClick:function(){return Nr.update("selectionMode",Fr)}})},dr=function(Tr){var zr=Tr.isSelected,Fr=Tr.mode,Nr=Tr.onClick,tn="";switch(Fr){case nt.SelectionMode.Hand:tn="selection-mode__hand-menu";break;case nt.SelectionMode.Text:default:tn="selection-mode__text-menu"}return _t.createElement(Ft,{mode:Fr,onClick:Nr},function(rn){return _t.createElement(st.MenuItem,{checked:zr,icon:rn.icon,testId:tn,onClick:rn.onClick},rn.label)})},Mr=function(Tr){var zr=Tr.store,Fr=_t.useRef(null),Nr=_t.useState(nt.SelectionMode.Text),tn=Nr[0],rn=Nr[1],Tn=_t.useRef({top:0,left:0,x:0,y:0}),$n=function(Ko){var ds=Fr.current;ds&&(ds.scrollTop=Tn.current.top-(Ko.clientY-Tn.current.y),ds.scrollLeft=Tn.current.left-(Ko.clientX-Tn.current.x))},un=function(){var Ko=Fr.current;Ko&&(Ko.classList.add("rpv-selection-mode__grab"),Ko.classList.remove("rpv-selection-mode__grabbing"),document.removeEventListener("mousemove",$n),document.removeEventListener("mouseup",un))},es=function(Ko){var ds=Fr.current;ds&&tn!==nt.SelectionMode.Text&&(ds.classList.remove("rpv-selection-mode__grab"),ds.classList.add("rpv-selection-mode__grabbing"),Ko.preventDefault(),Ko.stopPropagation(),Tn.current={left:ds.scrollLeft,top:ds.scrollTop,x:Ko.clientX,y:Ko.clientY},document.addEventListener("mousemove",$n),document.addEventListener("mouseup",un))},kn=function(Ko){Fr.current=Ko()},ts=function(Ko){rn(Ko)};return _t.useEffect(function(){var Ko=Fr.current;if(Ko)return tn===nt.SelectionMode.Hand?Ko.classList.add("rpv-selection-mode__grab"):Ko.classList.remove("rpv-selection-mode__grab"),Ko.addEventListener("mousedown",es),function(){Ko.removeEventListener("mousedown",es)}},[tn]),_t.useEffect(function(){return zr.subscribe("getPagesContainer",kn),zr.subscribe("selectionMode",ts),function(){zr.unsubscribe("getPagesContainer",kn),zr.unsubscribe("selectionMode",ts)}},[]),_t.createElement(_t.Fragment,null)};nt.HandToolIcon=Et,nt.TextSelectionIcon=Rt,nt.selectionModePlugin=function(Tr){var zr=_t.useMemo(function(){return st.createStore()},[]),Fr=function(Nr){return _t.createElement(Gt,At({},Nr,{store:zr}))};return{install:function(Nr){zr.update("selectionMode",Tr&&Tr.selectionMode?Tr.selectionMode:nt.SelectionMode.Text),zr.update("getPagesContainer",Nr.getPagesContainer)},renderViewer:function(Nr){var tn=Nr.slot;return tn.subSlot&&tn.subSlot.children&&(tn.subSlot.children=_t.createElement(_t.Fragment,null,_t.createElement(Mr,{store:zr}),tn.subSlot.children)),tn},SwitchSelectionMode:Fr,SwitchSelectionModeButton:function(Nr){return _t.createElement(Fr,{mode:Nr.mode},function(tn){return _t.createElement(Bt,{isSelected:tn.isSelected,mode:tn.mode,onClick:function(){tn.onClick()}})})},SwitchSelectionModeMenuItem:function(Nr){return _t.createElement(Fr,{mode:Nr.mode},function(tn){return _t.createElement(dr,{isSelected:tn.isSelected,mode:tn.mode,onClick:function(){tn.onClick(),Nr.onClick()}})})}}}})(selectionMode_min);/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$b.exports=selectionMode_min;var libExports$d=lib$b.exports,lib$a={exports:{}},fullScreen_min={},e$c=libExports$h;function t$c(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var n$c=t$c(reactExports),r$c=function(){return n$c.createElement(e$c.Icon,{size:16},n$c.createElement("path",{d:"M11.5 23.499L11.5 14.499"}),n$c.createElement("path",{d:"M7.5 18.499L11.5 14.499 15.5 18.499"}),n$c.createElement("path",{d:"M11.5 1.499L11.5 10.499"}),n$c.createElement("path",{d:"M7.5 6.499L11.5 10.499 15.5 6.499"}),n$c.createElement("path",{d:"M20.5 12.499L1.5 12.499"}))},l$c=function(){return n$c.createElement(e$c.Icon,{size:16},n$c.createElement("path",{d:"M0.5 12L23.5 12"}),n$c.createElement("path",{d:"M11.5 1L11.5 23"}),n$c.createElement("path",{d:"M8.5 4L11.5 1 14.5 4"}),n$c.createElement("path",{d:"M20.5 9L23.5 12 20.5 15"}),n$c.createElement("path",{d:"M3.5 15L0.5 12 3.5 9"}),n$c.createElement("path",{d:"M14.5 20L11.5 23 8.5 20"}))},c$c=function(){return c$c=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},c$c.apply(this,arguments)},u$c={left:0,top:8},o$c=function(nt){var st=nt.enableShortcuts,mt=nt.onClick,gt=n$c.useContext(e$c.LocalizationContext).l10n,_t=gt&&gt.fullScreen?gt.fullScreen.enterFullScreen:"Full screen",Et=st?e$c.isMac()?"Meta+Ctrl+F":"F11":"";return n$c.createElement(e$c.Tooltip,{ariaControlsSuffix:"full-screen-enter",position:e$c.Position.BottomCenter,target:n$c.createElement(e$c.MinimalButton,{ariaKeyShortcuts:Et,ariaLabel:_t,isDisabled:!e$c.isFullScreenEnabled(),testId:"full-screen__enter-button",onClick:mt},n$c.createElement(l$c,null)),content:function(){return _t},offset:u$c})},i$c={left:0,top:8},a$c=function(nt){var st=nt.onClick,mt=n$c.useContext(e$c.LocalizationContext).l10n,gt=mt&&mt.fullScreen?mt.fullScreen.exitFullScreen:"Exit full screen";return n$c.createElement(e$c.Tooltip,{ariaControlsSuffix:"full-screen-exit",position:e$c.Position.BottomCenter,target:n$c.createElement(e$c.MinimalButton,{ariaKeyShortcuts:"Esc",ariaLabel:gt,testId:"full-screen__exit-button-with-tooltip",onClick:st},n$c.createElement(r$c,null)),content:function(){return gt},offset:i$c})},f$9=function(nt,st){var mt=n$c.useState(st.get("fullScreenMode")),gt=mt[0],_t=mt[1],Et=n$c.useCallback(function(At){_t(At)},[]);return n$c.useEffect(function(){return st.subscribe("fullScreenMode",Et),function(){st.unsubscribe("fullScreenMode",Et)}},[]),{enterFullScreen:function(){var At=st.get("getPagesContainer");if(At){var Rt=nt(At());st.get("enterFullScreenMode")(Rt)}},exitFullScreen:function(){st.get("exitFullScreenMode")()},isFullScreen:gt===e$c.FullScreenMode.Entering||gt===e$c.FullScreenMode.EnteredCompletely}},s$8=function(nt){var st=nt.children,mt=nt.enableShortcuts,gt=nt.getFullScreenTarget,_t=nt.store,Et=f$9(gt,_t),At=Et.enterFullScreen,Rt=Et.exitFullScreen,Ft=Et.isFullScreen;return(st||function(Nt){return Ft?n$c.createElement(a$c,{onClick:Nt.onClick}):n$c.createElement(o$c,{enableShortcuts:mt,onClick:Nt.onClick})})({onClick:Ft?Rt:At})},S$4=function(nt){var st=nt.onClick,mt=n$c.useContext(e$c.LocalizationContext).l10n,gt=mt&&mt.fullScreen?mt.fullScreen.enterFullScreen:"Full screen";return n$c.createElement(e$c.MenuItem,{icon:n$c.createElement(l$c,null),isDisabled:!e$c.isFullScreenEnabled(),testId:"full-screen__enter-menu",onClick:st},gt)},d$9=function(nt){var st=nt.onClick,mt=n$c.useContext(e$c.LocalizationContext).l10n,gt=n$c.useContext(e$c.ThemeContext).direction===e$c.TextDirection.RightToLeft,_t=mt&&mt.fullScreen?mt.fullScreen.exitFullScreen:"Exit full screen";return n$c.createElement("div",{className:e$c.classNames({"rpv-full-screen__exit-button":!0,"rpv-full-screen__exit-button--ltr":!gt,"rpv-full-screen__exit-button--rtl":gt})},n$c.createElement(e$c.MinimalButton,{ariaLabel:_t,testId:"full-screen__exit-button",onClick:st},n$c.createElement(r$c,null)))},m$8=function(nt){var st=nt.children,mt=nt.getFullScreenTarget,gt=nt.store,_t=f$9(mt,gt),Et=_t.enterFullScreen,At=_t.exitFullScreen,Rt=_t.isFullScreen;return Rt&&(st||function(Ft){return n$c.createElement(d$9,{onClick:Ft.onClick})})({onClick:Rt?At:Et})},E$5=function(nt){var st=nt.store,mt=nt.onEnterFullScreen,gt=nt.onExitFullScreen,_t=n$c.useState(st.get("fullScreenMode")),Et=_t[0],At=_t[1],Rt=n$c.useCallback(function(Ft){At(Ft)},[]);return n$c.useEffect(function(){switch(Et){case e$c.FullScreenMode.EnteredCompletely:mt(st.get("zoom"));break;case e$c.FullScreenMode.Exited:gt(st.get("zoom"))}},[Et]),n$c.useEffect(function(){return st.subscribe("fullScreenMode",Rt),function(){st.unsubscribe("fullScreenMode",Rt)}},[]),(Et===e$c.FullScreenMode.Entering||Et===e$c.FullScreenMode.Entered)&&n$c.createElement("div",{className:"rpv-full-screen__overlay"},n$c.createElement(e$c.Spinner,null))},F=function(nt){var st=nt.containerRef,mt=nt.getFullScreenTarget,gt=nt.store,_t=f$9(mt,gt).enterFullScreen,Et=function(At){if(!At.shiftKey&&!At.altKey&&(e$c.isMac()?At.metaKey&&At.ctrlKey&&At.key==="f":At.key==="F11")){var Rt=st.current;Rt&&document.activeElement&&Rt.contains(document.activeElement)&&(At.preventDefault(),_t())}};return n$c.useEffect(function(){if(st.current)return document.addEventListener("keydown",Et),function(){document.removeEventListener("keydown",Et)}},[st.current]),n$c.createElement(n$c.Fragment,null)};fullScreen_min.ExitFullScreenIcon=r$c,fullScreen_min.FullScreenIcon=l$c,fullScreen_min.fullScreenPlugin=function(nt){var st=(nt==null?void 0:nt.getFullScreenTarget)||function(At){return At},mt=n$c.useMemo(function(){return Object.assign({},{enableShortcuts:!0,onEnterFullScreen:function(){},onExitFullScreen:function(){}},nt)},[]),gt=n$c.useMemo(function(){return e$c.createStore({enterFullScreenMode:function(){},exitFullScreenMode:function(){},fullScreenMode:e$c.FullScreenMode.Normal,zoom:function(){}})},[]),_t=function(At){return n$c.createElement(s$8,c$c({},At,{enableShortcuts:mt.enableShortcuts,getFullScreenTarget:st,store:gt}))},Et=function(){return n$c.createElement(m$8,{getFullScreenTarget:st,store:gt},nt==null?void 0:nt.renderExitFullScreenButton)};return{install:function(At){gt.update("enterFullScreenMode",At.enterFullScreenMode),gt.update("exitFullScreenMode",At.exitFullScreenMode),gt.update("getPagesContainer",At.getPagesContainer),gt.update("zoom",At.zoom)},onViewerStateChange:function(At){return gt.update("fullScreenMode",At.fullScreenMode),At},renderViewer:function(At){var Rt=At.slot;return Rt.subSlot&&(Rt.subSlot.children=n$c.createElement(n$c.Fragment,null,mt.enableShortcuts&&n$c.createElement(F,{containerRef:At.containerRef,getFullScreenTarget:st,store:gt}),n$c.createElement(E$5,{store:gt,onEnterFullScreen:mt.onEnterFullScreen,onExitFullScreen:mt.onExitFullScreen}),n$c.createElement(Et,null),Rt.subSlot.children)),Rt},EnterFullScreen:_t,EnterFullScreenButton:function(){return n$c.createElement(_t,null,function(At){return n$c.createElement(o$c,c$c({enableShortcuts:mt.enableShortcuts},At))})},EnterFullScreenMenuItem:function(At){return n$c.createElement(_t,null,function(Rt){return n$c.createElement(S$4,{onClick:function(){Rt.onClick(),At.onClick()}})})}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$a.exports=fullScreen_min;var libExports$c=lib$a.exports,lib$9={exports:{}},getFile_min={},e$b=libExports$h;function t$b(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var n$b=t$b(reactExports),o$b=function(){return n$b.createElement(e$b.Icon,{size:16},n$b.createElement("path",{d:"M5.5,11.5c-.275,0-.341.159-.146.354l6.292,6.293a.5.5,0,0,0,.709,0l6.311-6.275c.2-.193.13-.353-.145-.355L15.5,11.5V1.5a1,1,0,0,0-1-1h-5a1,1,0,0,0-1,1V11a.5.5,0,0,1-.5.5Z"}),n$b.createElement("path",{d:"M23.5,18.5v4a1,1,0,0,1-1,1H1.5a1,1,0,0,1-1-1v-4"}))},r$b=function(){return r$b=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},r$b.apply(this,arguments)},i$b={left:0,top:8},a$b=function(nt){var st=nt.onClick,mt=n$b.useContext(e$b.LocalizationContext).l10n,gt=mt&&mt.download?mt.download.download:"Download";return n$b.createElement(e$b.Tooltip,{ariaControlsSuffix:"get-file",position:e$b.Position.BottomCenter,target:n$b.createElement(e$b.MinimalButton,{ariaLabel:gt,testId:"get-file__download-button",onClick:st},n$b.createElement(o$b,null)),content:function(){return gt},offset:i$b})},c$b=function(nt,st){var mt=document.createElement("a");mt.style.display="none",mt.href=nt,mt.setAttribute("download",st),document.body.appendChild(mt),mt.click(),document.body.removeChild(mt)},l$b=function(nt,st,mt){var gt=URL.createObjectURL(new Blob([nt],{type:mt}));c$b(gt,st),gt&&URL.revokeObjectURL(gt)},u$b=function(nt,st){nt.getData().then(function(mt){/iphone|ipod|ipad/i.test(navigator.userAgent)&&!/CriOS/i.test(navigator.userAgent)?l$b(mt,st,"application/octet-stream"):/iphone|ipod|ipad/i.test(navigator.userAgent)&&/CriOS/i.test(navigator.userAgent)?c$b("data:application/pdf;base64,".concat(function(gt){return btoa(Array(gt.length).fill("").map(function(_t,Et){return String.fromCharCode(gt[Et])}).join(""))}(mt)),st):l$b(mt,st,"application/pdf")})},f$8=function(nt){var st=nt.children,mt=nt.fileNameGenerator,gt=nt.store,_t=n$b.useState(gt.get("file")),Et=_t[0],At=_t[1],Rt=n$b.useState(gt.get("doc")),Ft=Rt[0],Nt=Rt[1],Bt=function(dr){Nt(dr)},Gt=function(dr){At(dr)};return n$b.useEffect(function(){return gt.subscribe("doc",Bt),gt.subscribe("file",Gt),function(){gt.subscribe("doc",Bt),gt.unsubscribe("file",Gt)}},[]),(st||function(dr){return n$b.createElement(a$b,{onClick:dr.onClick})})({onClick:function(){Ft&&Et&&u$b(Ft,mt(Et))}})},d$8=function(nt){var st=nt.onClick,mt=n$b.useContext(e$b.LocalizationContext).l10n,gt=mt&&mt.download?mt.download.download:"Download";return n$b.createElement(e$b.MenuItem,{icon:n$b.createElement(o$b,null),testId:"get-file__download-menu",onClick:st},gt)};getFile_min.DownloadIcon=o$b,getFile_min.getFilePlugin=function(nt){var st=n$b.useMemo(function(){return e$b.createStore({})},[]),mt=function(_t){return _t.name?(Et=_t.name,(At=Et.split("/").pop())?At.split("#")[0].split("?")[0]:Et):"document.pdf";var Et,At},gt=function(_t){return n$b.createElement(f$8,r$b({},_t,{fileNameGenerator:nt&&nt.fileNameGenerator||mt,store:st}))};return{onDocumentLoad:function(_t){st.update("doc",_t.doc),st.update("file",_t.file)},Download:gt,DownloadButton:function(){return n$b.createElement(gt,null,function(_t){return n$b.createElement(a$b,r$b({},_t))})},DownloadMenuItem:function(_t){return n$b.createElement(gt,null,function(Et){return n$b.createElement(d$8,{onClick:function(){Et.onClick(),_t.onClick()}})})}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$9.exports=getFile_min;var libExports$b=lib$9.exports,lib$8={exports:{}},open_min={},e$a=libExports$h;function t$a(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var n$a=t$a(reactExports),r$a=function(){return n$a.createElement(e$a.Icon,{size:16},n$a.createElement("path",{d:"M18.5,7.5c.275,0,.341-.159.146-.354L12.354.854a.5.5,0,0,0-.708,0L5.354,7.147c-.2.195-.129.354.146.354h3v10a1,1,0,0,0,1,1h5a1,1,0,0,0,1-1V7.5Z"}),n$a.createElement("path",{d:"M23.5,18.5v4a1,1,0,0,1-1,1H1.5a1,1,0,0,1-1-1v-4"}))},o$a=function(){return o$a=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},o$a.apply(this,arguments)},i$a=function(nt){var st=n$a.useRef(),mt=function(){var _t=st.current;_t&&(_t.click(),nt.get("triggerOpenFile")&&nt.update("triggerOpenFile",!1))},gt=function(_t){_t&&mt()};return n$a.useEffect(function(){return nt.subscribe("triggerOpenFile",gt),function(){nt.unsubscribe("triggerOpenFile",gt)}},[]),{inputRef:st,openFile:mt}},c$a={left:0,top:8},u$a=function(nt){var st=nt.enableShortcuts,mt=nt.store,gt=nt.onClick,_t=n$a.useContext(e$a.LocalizationContext).l10n,Et=_t&&_t.open?_t.open.openFile:"Open file",At=i$a(mt),Rt=At.inputRef,Ft=At.openFile,Nt=st?e$a.isMac()?"Meta+O":"Ctrl+O":"";return n$a.createElement(e$a.Tooltip,{ariaControlsSuffix:"open",position:e$a.Position.BottomCenter,target:n$a.createElement("div",{className:"rpv-open__input-wrapper"},n$a.createElement("input",{accept:".pdf",ref:Rt,className:"rpv-open__input",multiple:!1,tabIndex:-1,title:"",type:"file",onChange:gt}),n$a.createElement(e$a.MinimalButton,{ariaKeyShortcuts:Nt,ariaLabel:Et,testId:"open__button",onClick:Ft},n$a.createElement(r$a,null))),content:function(){return Et},offset:c$a})},a$a=function(nt){var st=nt.children,mt=nt.enableShortcuts,gt=nt.store;return(st||function(_t){return n$a.createElement(u$a,{enableShortcuts:mt,store:gt,onClick:_t.onClick})})({onClick:function(_t){var Et=_t.target.files;if(Et&&Et.length){var At=gt.get("openFile");At&&At(Et[0])}}})},l$a=function(nt){var st=nt.store,mt=nt.onClick,gt=n$a.useContext(e$a.LocalizationContext).l10n,_t=gt&&gt.open?gt.open.openFile:"Open file",Et=i$a(st),At=Et.inputRef,Rt=Et.openFile;return n$a.createElement(e$a.MenuItem,{icon:n$a.createElement(r$a,null),testId:"open__menu",onClick:Rt},n$a.createElement("div",{className:"rpv-open__input-wrapper"},n$a.createElement("input",{accept:".pdf",ref:At,className:"rpv-open__input",multiple:!1,tabIndex:-1,title:"",type:"file",onChange:mt}),_t))},p$7=function(nt){var st=nt.containerRef,mt=nt.store,gt=function(_t){if(!_t.shiftKey&&!_t.altKey&&_t.key==="o"&&(e$a.isMac()?_t.metaKey:_t.ctrlKey)){var Et=st.current;Et&&document.activeElement&&Et.contains(document.activeElement)&&(_t.preventDefault(),mt.update("triggerOpenFile",!0))}};return n$a.useEffect(function(){if(st.current)return document.addEventListener("keydown",gt),function(){document.removeEventListener("keydown",gt)}},[st.current]),n$a.createElement(n$a.Fragment,null)};open_min.OpenFileIcon=r$a,open_min.openPlugin=function(nt){var st=n$a.useMemo(function(){return Object.assign({},{enableShortcuts:!0},nt)},[]),mt=n$a.useMemo(function(){return e$a.createStore({})},[]),gt=function(_t){return n$a.createElement(a$a,o$a({enableShortcuts:st.enableShortcuts},_t,{store:mt}))};return{install:function(_t){mt.update("openFile",_t.openFile)},renderViewer:function(_t){var Et=_t.slot,At={children:n$a.createElement(n$a.Fragment,null,st.enableShortcuts&&n$a.createElement(p$7,{containerRef:_t.containerRef,store:mt}),Et.children)};return o$a(o$a({},Et),At)},Open:gt,OpenButton:function(){return n$a.createElement(gt,null)},OpenMenuItem:function(){return n$a.createElement(gt,null,function(_t){return n$a.createElement(l$a,{store:mt,onClick:_t.onClick})})}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$8.exports=open_min;var libExports$a=lib$8.exports,lib$7={exports:{}},pageNavigation_min={},e$9=libExports$h;function t$9(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var n$9=t$9(reactExports),a$9=function(){return n$9.createElement(e$9.Icon,{size:16},n$9.createElement("path",{d:`M2.32,2.966h19.452c0.552,0.001,1,0.449,0.999,1.001c0,0.182-0.05,0.36-0.144,0.516L12.9,20.552
            c-0.286,0.472-0.901,0.624-1.373,0.338c-0.138-0.084-0.254-0.2-0.338-0.338L1.465,4.483C1.179,4.01,1.331,3.396,1.804,3.11
            C1.96,3.016,2.138,2.966,2.32,2.966z`}))},r$9=function(){return n$9.createElement(e$9.Icon,{size:16},n$9.createElement("path",{d:`M0.541,5.627L11.666,18.2c0.183,0.207,0.499,0.226,0.706,0.043c0.015-0.014,0.03-0.028,0.043-0.043
            L23.541,5.627`}))},o$9=function(){return o$9=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},o$9.apply(this,arguments)},i$9=function(nt){var st=n$9.useState(nt.get("currentPage")||0),mt=st[0],gt=st[1],_t=function(Et){gt(Et)};return e$9.useIsomorphicLayoutEffect(function(){return nt.subscribe("currentPage",_t),function(){nt.unsubscribe("currentPage",_t)}},[]),{currentPage:mt}},u$9=function(nt){var st=n$9.useState(nt.get("numberOfPages")||0),mt=st[0],gt=st[1],_t=function(Et){gt(Et)};return n$9.useEffect(function(){return nt.subscribe("numberOfPages",_t),function(){nt.unsubscribe("numberOfPages",_t)}},[]),{numberOfPages:mt}},c$9=function(nt){var st=nt.store,mt=n$9.useContext(e$9.LocalizationContext).l10n,gt=n$9.useState("1"),_t=gt[0],Et=gt[1],At=i$9(st).currentPage,Rt=u$9(st).numberOfPages;n$9.useEffect(function(){return Et("".concat(At+1))},[At]);var Ft=function(Bt){var Gt=st.get("jumpToPage");Gt&&Gt(Bt)},Nt=mt&&mt.pageNavigation?mt.pageNavigation.enterPageNumber:"Enter a page number";return n$9.createElement("span",{className:"rpv-page-navigation__current-page-input"},n$9.createElement(e$9.TextBox,{ariaLabel:Nt,testId:"page-navigation__current-page-input",type:"text",value:_t,onChange:Et,onKeyDown:function(Bt){switch(Bt.key){case"ArrowUp":(Mr=At-1)>=0&&(Et("".concat(Mr+1)),Ft(Mr));break;case"ArrowDown":(dr=At+1)<Rt&&(Et("".concat(dr+1)),Ft(dr));break;case"Enter":Gt=parseInt(_t,10),_t===""||Gt<1||Gt>Rt?Et("".concat(At+1)):Ft(Gt-1)}var Gt,dr,Mr}}))},l$9=function(nt){var st=nt.children,mt=nt.doc,gt=e$9.useIsMounted(),_t=n$9.useState({loading:!0,labels:[]}),Et=_t[0],At=_t[1];return n$9.useEffect(function(){mt.getPageLabels().then(function(Rt){gt.current&&At({loading:!1,labels:Rt||[]})})},[mt.loadingTask.docId]),Et.loading?n$9.createElement(n$9.Fragment,null):st(Et.labels)},s$7=function(nt){var st=nt.children,mt=nt.store,gt=function(Rt){var Ft=n$9.useState(Rt.get("doc")),Nt=Ft[0],Bt=Ft[1],Gt=function(dr){Bt(dr)};return n$9.useEffect(function(){return Rt.subscribe("doc",Gt),function(){Rt.unsubscribe("doc",Gt)}},[]),Nt}(mt),_t=i$9(mt).currentPage,Et=u$9(mt).numberOfPages,At=st||function(Rt){return n$9.createElement(n$9.Fragment,null,Rt.currentPage+1)};return gt?n$9.createElement(l$9,{doc:gt},function(Rt){var Ft=Rt.length===Et&&Et>0?Rt[_t]:"";return At({currentPage:_t,numberOfPages:Et,pageLabel:Ft})}):n$9.createElement(n$9.Fragment,null)},g$5=function(){return n$9.createElement(e$9.Icon,{size:16},n$9.createElement("path",{d:`M21.783,21.034H2.332c-0.552,0-1-0.448-1-1c0-0.182,0.05-0.361,0.144-0.517L11.2,3.448
            c0.286-0.472,0.901-0.624,1.373-0.338c0.138,0.084,0.254,0.2,0.338,0.338l9.726,16.069c0.286,0.473,0.134,1.087-0.339,1.373
            C22.143,20.984,21.965,21.034,21.783,21.034z`}))},f$7={left:0,top:8},m$7=function(nt){var st=nt.isDisabled,mt=nt.onClick,gt=n$9.useContext(e$9.LocalizationContext).l10n,_t=gt&&gt.pageNavigation?gt.pageNavigation.goToFirstPage:"First page";return n$9.createElement(e$9.Tooltip,{ariaControlsSuffix:"page-navigation-first",position:e$9.Position.BottomCenter,target:n$9.createElement(e$9.MinimalButton,{ariaLabel:_t,isDisabled:st,testId:"page-navigation__first-button",onClick:mt},n$9.createElement(g$5,null)),content:function(){return _t},offset:f$7})},p$6=function(nt){var st=nt.children,mt=nt.store;return(st||function(gt){return n$9.createElement(m$7,{isDisabled:gt.isDisabled,onClick:gt.onClick})})({isDisabled:i$9(mt).currentPage===0,onClick:function(){var gt=mt.get("jumpToPage");gt&&gt(0)}})},v$5=function(nt){var st=nt.isDisabled,mt=nt.onClick,gt=n$9.useContext(e$9.LocalizationContext).l10n,_t=gt&&gt.pageNavigation?gt.pageNavigation.goToFirstPage:"First page";return n$9.createElement(e$9.MenuItem,{icon:n$9.createElement(g$5,null),isDisabled:st,testId:"page-navigation__first-menu",onClick:mt},_t)},d$7={left:0,top:8},P$2=function(nt){var st=nt.isDisabled,mt=nt.onClick,gt=n$9.useContext(e$9.LocalizationContext).l10n,_t=gt&&gt.pageNavigation?gt.pageNavigation.goToLastPage:"Last page";return n$9.createElement(e$9.Tooltip,{ariaControlsSuffix:"page-navigation-last",position:e$9.Position.BottomCenter,target:n$9.createElement(e$9.MinimalButton,{ariaLabel:_t,isDisabled:st,testId:"page-navigation__last-button",onClick:mt},n$9.createElement(a$9,null)),content:function(){return _t},offset:d$7})},b$4=function(nt){var st=nt.children,mt=nt.store,gt=i$9(mt).currentPage,_t=u$9(mt).numberOfPages;return(st||function(Et){return n$9.createElement(P$2,{isDisabled:Et.isDisabled,onClick:Et.onClick})})({isDisabled:gt+1>=_t,onClick:function(){var Et=mt.get("jumpToPage");Et&&Et(_t-1)}})},E$4=function(nt){var st=nt.isDisabled,mt=nt.onClick,gt=n$9.useContext(e$9.LocalizationContext).l10n,_t=gt&&gt.pageNavigation?gt.pageNavigation.goToLastPage:"Last page";return n$9.createElement(e$9.MenuItem,{icon:n$9.createElement(a$9,null),isDisabled:st,testId:"page-navigation__last-menu",onClick:mt},_t)},C$3={left:0,top:8},D=function(nt){var st=nt.isDisabled,mt=nt.onClick,gt=n$9.useContext(e$9.LocalizationContext).l10n,_t=gt&&gt.pageNavigation?gt.pageNavigation.goToNextPage:"Next page";return n$9.createElement(e$9.Tooltip,{ariaControlsSuffix:"page-navigation-next",position:e$9.Position.BottomCenter,target:n$9.createElement(e$9.MinimalButton,{ariaLabel:_t,isDisabled:st,testId:"page-navigation__next-button",onClick:mt},n$9.createElement(r$9,null)),content:function(){return _t},offset:C$3})},k$3=function(nt){var st=nt.children,mt=nt.store;return(st||function(gt){return n$9.createElement(D,{onClick:gt.onClick,isDisabled:gt.isDisabled})})({isDisabled:i$9(mt).currentPage+1>=u$9(mt).numberOfPages,onClick:function(){var gt=mt.get("jumpToNextPage");gt&&gt()}})},T=function(nt){var st=nt.isDisabled,mt=nt.onClick,gt=n$9.useContext(e$9.LocalizationContext).l10n,_t=gt&&gt.pageNavigation?gt.pageNavigation.goToNextPage:"Next page";return n$9.createElement(e$9.MenuItem,{icon:n$9.createElement(r$9,null),isDisabled:st,testId:"page-navigation__next-menu",onClick:mt},_t)},x$1=function(){return n$9.createElement(e$9.Icon,{size:16},n$9.createElement("path",{d:`M23.535,18.373L12.409,5.8c-0.183-0.207-0.499-0.226-0.706-0.043C11.688,5.77,11.674,5.785,11.66,5.8
            L0.535,18.373`}))},L={left:0,top:8},N=function(nt){var st=nt.isDisabled,mt=nt.onClick,gt=n$9.useContext(e$9.LocalizationContext).l10n,_t=gt&&gt.pageNavigation?gt.pageNavigation.goToPreviousPage:"Previous page";return n$9.createElement(e$9.Tooltip,{ariaControlsSuffix:"page-navigation-previous",position:e$9.Position.BottomCenter,target:n$9.createElement(e$9.MinimalButton,{ariaLabel:_t,isDisabled:st,testId:"page-navigation__previous-button",onClick:mt},n$9.createElement(x$1,null)),content:function(){return _t},offset:L})},j=function(nt){var st=nt.store;return(nt.children||function(mt){return n$9.createElement(N,{isDisabled:mt.isDisabled,onClick:mt.onClick})})({isDisabled:i$9(st).currentPage<=0,onClick:function(){var mt=st.get("jumpToPreviousPage");mt&&mt()}})},I$2=function(nt){var st=nt.isDisabled,mt=nt.onClick,gt=n$9.useContext(e$9.LocalizationContext).l10n,_t=gt&&gt.pageNavigation?gt.pageNavigation.goToPreviousPage:"Previous page";return n$9.createElement(e$9.MenuItem,{icon:n$9.createElement(x$1,null),isDisabled:st,testId:"page-navigation__previous-menu",onClick:mt},_t)},h$5=function(nt){var st=nt.children,mt=nt.store,gt=u$9(mt).numberOfPages;return st?st({numberOfPages:gt}):n$9.createElement(n$9.Fragment,null,gt)},y$1=function(nt){var st=nt.containerRef,mt=nt.numPages,gt=nt.store,_t=i$9(gt).currentPage,Et=n$9.useRef(_t);Et.current=_t;var At=n$9.useRef(!1),Rt=function(){At.current=!0},Ft=function(){At.current=!1},Nt=function(Bt){var Gt=st.current,dr=At.current||document.activeElement&&Gt.contains(document.activeElement);if(Gt&&dr){var Mr,Tr,zr=Bt.altKey&&Bt.key==="ArrowDown"||!Bt.shiftKey&&!Bt.altKey&&Bt.key==="PageDown",Fr=Bt.altKey&&Bt.key==="ArrowUp"||!Bt.shiftKey&&!Bt.altKey&&Bt.key==="PageUp";if(zr)return Bt.preventDefault(),Mr=gt.get("jumpToPage"),Tr=Et.current+1,void(Mr&&Tr<mt&&Mr(Tr));if(Fr)return Bt.preventDefault(),void function(){var Nr=gt.get("jumpToPage"),tn=Et.current-1;Nr&&tn>=0&&Nr(tn)}();if(e$9.isMac()?Bt.metaKey&&!Bt.ctrlKey:Bt.altKey)switch(Bt.key){case"ArrowLeft":Bt.preventDefault(),function(){var Nr=gt.get("jumpToPreviousDestination");Nr&&Nr()}();break;case"ArrowRight":Bt.preventDefault(),function(){var Nr=gt.get("jumpToNextDestination");Nr&&Nr()}()}}};return n$9.useEffect(function(){var Bt=st.current;if(Bt)return document.addEventListener("keydown",Nt),Bt.addEventListener("mouseenter",Rt),Bt.addEventListener("mouseleave",Ft),function(){document.removeEventListener("keydown",Nt),Bt.removeEventListener("mouseenter",Rt),Bt.removeEventListener("mouseleave",Ft)}},[st.current]),n$9.createElement(n$9.Fragment,null)};pageNavigation_min.DownArrowIcon=a$9,pageNavigation_min.NextIcon=r$9,pageNavigation_min.PreviousIcon=x$1,pageNavigation_min.UpArrowIcon=g$5,pageNavigation_min.pageNavigationPlugin=function(nt){var st=n$9.useMemo(function(){return Object.assign({},{enableShortcuts:!0},nt)},[]),mt=n$9.useMemo(function(){return e$9.createStore()},[]),gt=function(Rt){return n$9.createElement(p$6,o$9({},Rt,{store:mt}))},_t=function(Rt){return n$9.createElement(b$4,o$9({},Rt,{store:mt}))},Et=function(Rt){return n$9.createElement(k$3,o$9({},Rt,{store:mt}))},At=function(Rt){return n$9.createElement(j,o$9({},Rt,{store:mt}))};return{install:function(Rt){mt.update("jumpToDestination",Rt.jumpToDestination),mt.update("jumpToNextDestination",Rt.jumpToNextDestination),mt.update("jumpToNextPage",Rt.jumpToNextPage),mt.update("jumpToPage",Rt.jumpToPage),mt.update("jumpToPreviousDestination",Rt.jumpToPreviousDestination),mt.update("jumpToPreviousPage",Rt.jumpToPreviousPage)},renderViewer:function(Rt){var Ft=Rt.slot;if(!st.enableShortcuts)return Ft;var Nt={children:n$9.createElement(n$9.Fragment,null,n$9.createElement(y$1,{containerRef:Rt.containerRef,numPages:Rt.doc.numPages,store:mt}),Ft.children)};return o$9(o$9({},Ft),Nt)},onDocumentLoad:function(Rt){mt.update("doc",Rt.doc),mt.update("numberOfPages",Rt.doc.numPages)},onViewerStateChange:function(Rt){return mt.update("currentPage",Rt.pageIndex),Rt},jumpToNextPage:function(){var Rt=mt.get("jumpToNextPage");Rt&&Rt()},jumpToPage:function(Rt){var Ft=mt.get("jumpToPage");Ft&&Ft(Rt)},jumpToPreviousPage:function(){var Rt=mt.get("jumpToPreviousPage");Rt&&Rt()},CurrentPageInput:function(){return n$9.createElement(c$9,{store:mt})},CurrentPageLabel:function(Rt){return n$9.createElement(s$7,o$9({},Rt,{store:mt}))},GoToFirstPage:gt,GoToFirstPageButton:function(){return n$9.createElement(gt,null,function(Rt){return n$9.createElement(m$7,o$9({},Rt))})},GoToFirstPageMenuItem:function(Rt){return n$9.createElement(gt,null,function(Ft){return n$9.createElement(v$5,{isDisabled:Ft.isDisabled,onClick:function(){Ft.onClick(),Rt.onClick()}})})},GoToLastPage:_t,GoToLastPageButton:function(){return n$9.createElement(_t,null,function(Rt){return n$9.createElement(P$2,o$9({},Rt))})},GoToLastPageMenuItem:function(Rt){return n$9.createElement(_t,null,function(Ft){return n$9.createElement(E$4,{isDisabled:Ft.isDisabled,onClick:function(){Ft.onClick(),Rt.onClick()}})})},GoToNextPage:Et,GoToNextPageButton:function(){return n$9.createElement(Et,null,function(Rt){return n$9.createElement(D,o$9({},Rt))})},GoToNextPageMenuItem:function(Rt){return n$9.createElement(Et,null,function(Ft){return n$9.createElement(T,{isDisabled:Ft.isDisabled,onClick:function(){Ft.onClick(),Rt.onClick()}})})},GoToPreviousPage:At,GoToPreviousPageButton:function(){return n$9.createElement(At,null,function(Rt){return n$9.createElement(N,o$9({},Rt))})},GoToPreviousPageMenuItem:function(Rt){return n$9.createElement(At,null,function(Ft){return n$9.createElement(I$2,{isDisabled:Ft.isDisabled,onClick:function(){Ft.onClick(),Rt.onClick()}})})},NumberOfPages:function(Rt){return n$9.createElement(h$5,o$9({},Rt,{store:mt}))}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$7.exports=pageNavigation_min;var libExports$9=lib$7.exports,lib$6={exports:{}},print_min={},define_process_env_default={},e$8=libExports$h,t$8=reactExports,n$8=reactDomExports;function r$8(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var o$8,a$8=r$8(t$8),i$8=function(){return a$8.createElement(e$8.Icon,{size:16},a$8.createElement("path",{d:`M7.5,19.499h9 M7.5,16.499h9 M5.5,16.5h-3c-1.103-0.003-1.997-0.897-2-2v-6c0.003-1.103,0.897-1.997,2-2h19
            c1.103,0.003,1.997,0.897,2,2v6c-0.003,1.103-0.897,1.997-2,2h-3
            M5.5,4.5v-4h9.586c0.265,0,0.52,0.105,0.707,0.293l2.414,2.414
            C18.395,3.394,18.5,3.649,18.5,3.914V4.5
            M18.5,22.5c0,0.552-0.448,1-1,1h-11c-0.552,0-1-0.448-1-1v-9h13V22.5z
            M3.5,8.499
            c0.552,0,1,0.448,1,1s-0.448,1-1,1s-1-0.448-1-1S2.948,8.499,3.5,8.499z
            M14.5,0.499v4h4`}))},c$8=function(){return c$8=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},c$8.apply(this,arguments)},u$8={left:0,top:8},s$6=function(nt){var st=nt.enableShortcuts,mt=nt.onClick,gt=a$8.useContext(e$8.LocalizationContext).l10n,_t=gt&&gt.print?gt.print.print:"Print",Et=st?e$8.isMac()?"Meta+P":"Ctrl+P":"";return a$8.createElement(e$8.Tooltip,{ariaControlsSuffix:"print",position:e$8.Position.BottomCenter,target:a$8.createElement(e$8.MinimalButton,{ariaKeyShortcuts:Et,ariaLabel:_t,testId:"print__button",onClick:mt},a$8.createElement(i$8,null)),content:function(){return _t},offset:u$8})};(function(nt){nt.CheckingPermission="CheckingPermission",nt.Inactive="Inactive",nt.Preparing="Preparing",nt.Cancelled="Cancelled",nt.Ready="Ready"})(o$8||(o$8={}));var l$8=function(nt){var st=nt.children,mt=nt.enableShortcuts,gt=nt.store;return(st||s$6)({enableShortcuts:mt,onClick:function(){gt.update("printStatus",o$8.CheckingPermission)}})},p$5=function(nt){var st=nt.doc,mt=nt.store,gt=a$8.useContext(e$8.LocalizationContext).l10n,_t=a$8.useState(!0),Et=_t[0],At=_t[1];return a$8.useEffect(function(){st.getPermissions().then(function(Rt){Rt===null||Rt.includes(4)||Rt.includes(2048)?mt.update("printStatus",o$8.Preparing):At(!1)})},[]),Et?a$8.createElement(a$8.Fragment,null):a$8.createElement(e$8.Modal,{ariaControlsSuffix:"print-permission",closeOnClickOutside:!1,closeOnEscape:!1,content:function(Rt){return a$8.createElement(a$8.Fragment,null,a$8.createElement("div",{className:"rpv-print__permission-body"},gt&&gt.print?gt.print.disallowPrint:"The document does not allow to print"),a$8.createElement("div",{className:"rpv-print__permission-footer"},a$8.createElement(e$8.Button,{onClick:function(){Rt(),mt.update("printStatus",o$8.Cancelled)}},gt&&gt.print?gt.print.close:"Close")))},isOpened:!0})},m$6=function(nt){var st=nt.numLoadedPages,mt=nt.numPages,gt=nt.onCancel,_t=a$8.useContext(e$8.LocalizationContext).l10n,Et=a$8.useContext(e$8.ThemeContext).direction===e$8.TextDirection.RightToLeft,At=Math.floor(100*st/mt);return a$8.createElement("div",{className:"rpv-print__progress"},a$8.createElement("div",{className:e$8.classNames({"rpv-print__progress-body":!0,"rpv-print__progress-body--rtl":Et})},a$8.createElement("div",{className:"rpv-print__progress-message"},_t&&_t.print?_t.print.preparingDocument:"Preparing document ..."),a$8.createElement("div",{className:"rpv-print__progress-bar"},a$8.createElement(e$8.ProgressBar,{progress:At})),a$8.createElement(e$8.Button,{onClick:gt},_t&&_t.print?_t.print.cancel:"Cancel")))},d$6=function(nt){var st=nt.canvas,mt=nt.page,gt=nt.pageHeight,_t=nt.pageIndex,Et=nt.pageWidth,At=nt.rotation,Rt=nt.onLoad,Ft=e$8.useIsMounted(),Nt=a$8.useRef(),Bt=a$8.useState(""),Gt=Bt[0],dr=Bt[1],Mr=a$8.useMemo(function(){return typeof process<"u"&&define_process_env_default.JEST_WORKER_ID!==void 0},[]);return a$8.useEffect(function(){var Tr=Nt.current;Tr&&Tr.cancel();var zr=150/72;st.height=Math.floor(gt*zr),st.width=Math.floor(Et*zr);var Fr=st.getContext("2d");Fr.save(),Fr.fillStyle="rgb(255, 255, 255)",Fr.fillRect(0,0,st.width,st.height),Fr.restore();var Nr=mt.getViewport({rotation:At,scale:1});Nt.current=mt.render({canvasContext:Fr,intent:"print",transform:[zr,0,0,zr,0,0],viewport:Nr}),Nt.current.promise.then(function(){"toBlob"in st&&"createObjectURL"in URL?st.toBlob(function(tn){Ft.current&&dr(URL.createObjectURL(tn)),Mr&&Rt()}):(Ft.current&&dr(st.toDataURL()),Mr&&Rt())},function(){})},[]),Gt&&a$8.createElement("div",{className:"rpv-print__page"},a$8.createElement("img",{"data-testid":"print__thumbnail-".concat(_t),src:Gt,onLoad:function(){Mr||Rt()}}))},f$6=function(nt){var st=nt.canvas,mt=nt.doc,gt=nt.pageIndex,_t=nt.pageRotation,Et=nt.pageSize,At=nt.rotation,Rt=nt.shouldRender,Ft=nt.onLoad,Nt=e$8.useIsMounted(),Bt=a$8.useState(null),Gt=Bt[0],dr=Bt[1],Mr=Math.abs(At+_t)%180==0;a$8.useEffect(function(){Rt&&e$8.getPage(mt,gt).then(function(zr){Nt.current&&dr(zr)})},[Rt]);var Tr=(Et.rotation+At+_t)%360;return Gt&&a$8.createElement(d$6,{canvas:st,page:Gt,pageHeight:Mr?Et.pageHeight:Et.pageWidth,pageIndex:gt,pageWidth:Mr?Et.pageWidth:Et.pageHeight,rotation:Tr,onLoad:Ft})},g$4=function(nt){var st=nt.doc,mt=nt.numLoadedPages,gt=nt.pagesRotation,_t=nt.pageSizes,Et=nt.printPages,At=nt.printStatus,Rt=nt.rotation,Ft=nt.onCancel,Nt=nt.onLoad,Bt=a$8.useMemo(function(){return document.createElement("canvas")},[]),Gt=a$8.useMemo(function(){var Tr=document.querySelector(".rpv-print__zone");if(Tr)return Tr;var zr=document.createElement("div");return zr.classList.add("rpv-print__zone"),zr.setAttribute("data-testid","print__zone"),document.body.appendChild(zr),zr},[]);a$8.useEffect(function(){At===o$8.Ready&&(document.documentElement.classList.add("rpv-print__html-printing"),document.body.classList.add("rpv-print__body-printing"),window.print());var Tr=function(){if(At===o$8.Ready){document.documentElement.classList.remove("rpv-print__html-printing"),document.body.classList.remove("rpv-print__body-printing");var zr=document.querySelectorAll(".rpv-print__zone");zr&&zr.forEach(function(Fr){Fr.parentElement.removeChild(Fr)}),Bt.height=0,Bt.width=0,document.removeEventListener("mousemove",Tr),Ft()}};return document.addEventListener("mousemove",Tr),function(){return document.removeEventListener("mousemove",Tr)}},[At]);var dr=_t[0].pageHeight,Mr=_t[0].pageWidth;return n$8.createPortal(a$8.createElement(a$8.Fragment,null,Et.map(function(Tr,zr){return a$8.createElement(f$6,{key:Tr,canvas:Bt,doc:st,pageIndex:Tr,pageRotation:gt.has(Tr)?gt.get(Tr):0,pageSize:_t[Tr],rotation:Rt,shouldRender:zr===mt,onLoad:Nt})}),a$8.createElement("style",{dangerouslySetInnerHTML:{__html:"@page { size: ".concat(Mr,"pt ").concat(dr,"pt }")}})),Gt)},v$4=function(nt){var st=nt.doc,mt=nt.pagesRotation,gt=nt.pageSizes,_t=nt.renderProgressBar,Et=nt.rotation,At=nt.setPages,Rt=nt.store,Ft=a$8.useState(o$8.Inactive),Nt=Ft[0],Bt=Ft[1],Gt=a$8.useState(0),dr=Gt[0],Mr=Gt[1],Tr=a$8.useMemo(function(){var tn=st.numPages;return At(st).filter(function(rn){return rn>=0&&rn<tn})},[st,At]),zr=Tr.length,Fr=function(){Mr(0),Bt(o$8.Inactive)},Nr=function(tn){return Bt(tn)};return a$8.useEffect(function(){return Rt.subscribe("printStatus",Nr),function(){Rt.unsubscribe("printStatus",Nr)}},[]),a$8.createElement(a$8.Fragment,null,Nt===o$8.CheckingPermission&&a$8.createElement(p$5,{doc:st,store:Rt}),Nt===o$8.Preparing&&(_t?_t(dr,zr,Fr):a$8.createElement(m$6,{numLoadedPages:dr,numPages:zr,onCancel:Fr})),(Nt===o$8.Preparing||Nt===o$8.Ready)&&dr<=zr&&a$8.createElement(g$4,{doc:st,numLoadedPages:dr,pagesRotation:mt,pageSizes:gt,printPages:Tr,printStatus:Nt,rotation:Et,onCancel:Fr,onLoad:function(){var tn=dr+1;tn<=zr&&(Mr(tn),tn===zr&&Bt(o$8.Ready))}}))},h$4=function(nt){var st=nt.onClick,mt=a$8.useContext(e$8.LocalizationContext).l10n,gt=mt&&mt.print?mt.print.print:"Print";return a$8.createElement(e$8.MenuItem,{icon:a$8.createElement(i$8,null),testId:"print__menu",onClick:st},gt)},E$3=function(nt){var st=nt.containerRef,mt=nt.store,gt=function(_t){if(!_t.shiftKey&&!_t.altKey&&_t.key==="p"&&(e$8.isMac()?_t.metaKey:_t.ctrlKey)){var Et=st.current;Et&&document.activeElement&&Et.contains(document.activeElement)&&(_t.preventDefault(),mt.update("printStatus",o$8.Preparing))}};return a$8.useEffect(function(){if(st.current)return document.addEventListener("keydown",gt),function(){document.removeEventListener("keydown",gt)}},[st.current]),a$8.createElement(a$8.Fragment,null)};print_min.PrintIcon=i$8,print_min.getAllPagesNumbers=function(nt){return Array(nt.numPages).fill(0).map(function(st,mt){return mt})},print_min.getCustomPagesNumbers=function(nt){return function(st){var mt,gt=[];return nt.replace(/\s+/g,"").split(",").forEach(function(_t){var Et,At,Rt=_t.split("-").map(function(Ft){return parseInt(Ft,10)}).filter(function(Ft){return Number.isInteger(Ft)});Rt.length===1?gt.push(Rt[0]-1):Rt.length===2&&gt.push.apply(gt,(Et=Rt[0]-1,At=Rt[1]-1,Array(At-Et+1).fill(0).map(function(Ft,Nt){return Et+Nt})))}),(mt=gt,mt.filter(function(_t){return mt.indexOf(_t)===mt.lastIndexOf(_t)})).filter(function(_t){return _t>=0&&_t<st.numPages})}},print_min.getEvenPagesNumbers=function(nt){return Array(nt.numPages).fill(0).map(function(st,mt){return mt}).filter(function(st){return(st+1)%2==0})},print_min.getOddPagesNumbers=function(nt){return Array(nt.numPages).fill(0).map(function(st,mt){return mt}).filter(function(st){return(st+1)%2==1})},print_min.printPlugin=function(nt){var st=a$8.useMemo(function(){return Object.assign({},{enableShortcuts:!0,setPages:function(_t){return Array(_t.numPages).fill(0).map(function(Et,At){return At})}},nt)},[]),mt=a$8.useMemo(function(){return e$8.createStore({printStatus:o$8.Inactive})},[]),gt=function(_t){return a$8.createElement(l$8,c$8({enableShortcuts:st.enableShortcuts},_t,{store:mt}))};return{print:function(){mt.update("printStatus",o$8.CheckingPermission)},renderViewer:function(_t){var Et=_t.slot,At={children:a$8.createElement(a$8.Fragment,null,st.enableShortcuts&&a$8.createElement(E$3,{containerRef:_t.containerRef,store:mt}),a$8.createElement(v$4,{doc:_t.doc,pagesRotation:_t.pagesRotation,pageSizes:_t.pageSizes,renderProgressBar:nt==null?void 0:nt.renderProgressBar,rotation:_t.rotation,setPages:st.setPages,store:mt}),Et.children)};return c$8(c$8({},Et),At)},Print:gt,PrintButton:function(){return a$8.createElement(gt,null,function(_t){return a$8.createElement(s$6,c$8({},_t))})},PrintMenuItem:function(_t){return a$8.createElement(gt,null,function(Et){return a$8.createElement(h$4,{onClick:function(){Et.onClick(),_t.onClick()}})})},setPages:function(_t){st.setPages=_t}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$6.exports=print_min;var libExports$8=lib$6.exports,lib$5={exports:{}},properties_min={},e$7=libExports$h;function t$7(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var r$7=t$7(reactExports),n$7=function(){return r$7.createElement(e$7.Icon,{size:16},r$7.createElement("path",{d:`M12,1.001c6.075,0,11,4.925,11,11s-4.925,11-11,11s-11-4.925-11-11S5.925,1.001,12,1.001z
            M14.5,17.005H13
            c-0.552,0-1-0.448-1-1v-6.5c0-0.276-0.224-0.5-0.5-0.5H10
            M11.745,6.504L11.745,6.504
            M11.745,6.5c-0.138,0-0.25,0.112-0.25,0.25
            S11.607,7,11.745,7s0.25-0.112,0.25-0.25S11.883,6.5,11.745,6.5`}))},o$7=function(){return o$7=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},o$7.apply(this,arguments)},a$7=function(nt){var st=nt.doc,mt=nt.render,gt=r$7.useState(),_t=gt[0],Et=gt[1];return r$7.useEffect(function(){st.getMetadata().then(function(At){return Promise.resolve(At)}).then(function(At){return st.getDownloadInfo().then(function(Rt){return Promise.resolve({fileName:At.contentDispositionFilename||"",info:At.info,length:Rt.length})})}).then(function(At){Et(At)})},[]),_t?mt(_t):r$7.createElement("div",{className:"rpv-properties__loader"},r$7.createElement(e$7.Spinner,null))},i$7=function(nt){var st=nt.label,mt=nt.value,gt=r$7.useContext(e$7.ThemeContext).direction===e$7.TextDirection.RightToLeft;return r$7.createElement("dl",{className:e$7.classNames({"rpv-properties__item":!0,"rpv-properties__item--rtl":gt})},r$7.createElement("dt",{className:"rpv-properties__item-label"},st,":"),r$7.createElement("dd",{className:"rpv-properties__item-value"},mt||"-"))},l$7=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"),c$7=function(nt,st,mt,gt){var _t=parseInt(nt,10);return _t>=st&&_t<=mt?_t:gt},p$4=function(nt){var st=nt.doc,mt=nt.fileName,gt=nt.onToggle,_t=r$7.useContext(e$7.LocalizationContext).l10n,Et=function(At){var Rt=function(Ft){var Nt=l$7.exec(Ft);if(!Nt)return null;var Bt=parseInt(Nt[1],10),Gt=c$7(Nt[2],1,12,1)-1,dr=c$7(Nt[3],1,31,1),Mr=c$7(Nt[4],0,23,0),Tr=c$7(Nt[5],0,59,0),zr=c$7(Nt[6],0,59,0),Fr=Nt[7]||"Z",Nr=c$7(Nt[8],0,23,0),tn=c$7(Nt[9],0,59,0);switch(Fr){case"-":Mr+=Nr,Tr+=tn;break;case"+":Mr-=Nr,Tr-=tn}return new Date(Date.UTC(Bt,Gt,dr,Mr,Tr,zr))}(At);return Rt?"".concat(Rt.toLocaleDateString(),", ").concat(Rt.toLocaleTimeString()):""};return r$7.createElement("div",{className:"rpv-properties__modal"},r$7.createElement(a$7,{doc:st,render:function(At){return r$7.createElement(r$7.Fragment,null,r$7.createElement("div",{className:"rpv-properties__modal-section"},r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.fileName:"File name",value:At.fileName||(Nt=mt,Bt=Nt.split("/").pop(),Bt?Bt.split("#")[0].split("?")[0]:Nt)}),r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.fileSize:"File size",value:(Rt=At.length,Ft=Math.floor(Math.log(Rt)/Math.log(1024)),"".concat((Rt/Math.pow(1024,Ft)).toFixed(2)," ").concat(["B","kB","MB","GB","TB"][Ft]))})),r$7.createElement(e$7.Separator,null),r$7.createElement("div",{className:"rpv-properties__modal-section"},r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.title:"Title",value:At.info.Title}),r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.author:"Author",value:At.info.Author}),r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.subject:"Subject",value:At.info.Subject}),r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.keywords:"Keywords",value:At.info.Keywords}),r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.creator:"Creator",value:At.info.Creator}),r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.creationDate:"Creation date",value:Et(At.info.CreationDate)}),r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.modificationDate:"Modification date",value:Et(At.info.ModDate)})),r$7.createElement(e$7.Separator,null),r$7.createElement("div",{className:"rpv-properties__modal-section"},r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.pdfProducer:"PDF producer",value:At.info.Producer}),r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.pdfVersion:"PDF version",value:At.info.PDFFormatVersion}),r$7.createElement(i$7,{label:_t&&_t.properties?_t.properties.pageCount:"Page count",value:"".concat(st.numPages)})));var Rt,Ft,Nt,Bt}}),r$7.createElement("div",{className:"rpv-properties__modal-footer"},r$7.createElement(e$7.Button,{onClick:gt},_t&&_t.properties?_t.properties.close:"Close")))},s$5={left:0,top:8},u$7=function(nt){var st=nt.onClick,mt=r$7.useContext(e$7.LocalizationContext).l10n,gt=mt&&mt.properties?mt.properties.showProperties:"Show properties";return r$7.createElement(e$7.Tooltip,{ariaControlsSuffix:"properties",position:e$7.Position.BottomCenter,target:r$7.createElement(e$7.MinimalButton,{ariaLabel:gt,testId:"properties__button",onClick:st},r$7.createElement(n$7,null)),content:function(){return gt},offset:s$5})},m$5=function(nt){var st=nt.children,mt=nt.store,gt=function(At){var Rt=r$7.useState(At.get("doc")),Ft=Rt[0],Nt=Rt[1],Bt=function(Gt){Nt(Gt)};return r$7.useEffect(function(){return At.subscribe("doc",Bt),function(){At.unsubscribe("doc",Bt)}},[]),{currentDoc:Ft}}(mt).currentDoc,_t=mt.get("fileName")||"",Et=st||function(At){return r$7.createElement(u$7,o$7({},At))};return gt?r$7.createElement(e$7.Modal,{ariaControlsSuffix:"properties",target:function(At){return Et({onClick:At})},content:function(At){return r$7.createElement(p$4,{doc:gt,fileName:_t,onToggle:At})},closeOnClickOutside:!0,closeOnEscape:!0}):r$7.createElement(r$7.Fragment,null)},f$5=function(nt){var st=nt.onClick,mt=r$7.useContext(e$7.LocalizationContext).l10n,gt=mt&&mt.properties?mt.properties.showProperties:"Show properties";return r$7.createElement(e$7.MenuItem,{icon:r$7.createElement(n$7,null),testId:"properties__menu",onClick:st},gt)};properties_min.InfoIcon=n$7,properties_min.propertiesPlugin=function(){var nt=r$7.useMemo(function(){return e$7.createStore({fileName:""})},[]),st=function(mt){return r$7.createElement(m$5,o$7({},mt,{store:nt}))};return{onDocumentLoad:function(mt){nt.update("doc",mt.doc)},onViewerStateChange:function(mt){return nt.update("fileName",mt.file.name),mt},ShowProperties:st,ShowPropertiesButton:function(){return r$7.createElement(m$5,{store:nt})},ShowPropertiesMenuItem:function(mt){return r$7.createElement(st,null,function(gt){return r$7.createElement(f$5,o$7({},gt))})}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$5.exports=properties_min;var libExports$7=lib$5.exports,lib$4={exports:{}},rotate_min={},t$6=libExports$h;function e$6(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var r$6=e$6(reactExports),n$6=function(){return r$6.createElement(t$6.Icon,{ignoreDirection:!0,size:16},r$6.createElement("path",{d:`M3.434,10.537c0.141-0.438,0.316-0.864,0.523-1.274
            M3.069,14.425C3.023,14.053,3,13.679,3,13.305 c0-0.291,0.014-0.579,0.041-0.863
            M4.389,18.111c-0.341-0.539-0.623-1.112-0.843-1.711
            M7.163,20.9 c-0.543-0.345-1.048-0.747-1.506-1.2
            M10.98,22.248c-0.65-0.074-1.29-0.218-1.909-0.431
            M10,4.25h2 c4.987,0.015,9.017,4.069,9.003,9.055c-0.013,4.581-3.456,8.426-8.008,8.945
            M13.5,1.75L10,4.25l3.5,2.5`}))},o$6=function(){return r$6.createElement(t$6.Icon,{ignoreDirection:!0,size:16},r$6.createElement("path",{d:`M20.566,10.537c-0.141-0.438-0.316-0.864-0.523-1.274
            M20.931,14.425C20.977,14.053,21,13.679,21,13.305 c0-0.291-0.014-0.579-0.041-0.863
            M19.611,18.111c0.341-0.539,0.624-1.114,0.843-1.713
            M16.837,20.9 c0.543-0.345,1.048-0.747,1.506-1.2
            M13.02,22.248c0.65-0.074,1.29-0.218,1.909-0.431
            M14,4.25h-2 c-4.987,0.015-9.017,4.069-9.003,9.055c0.013,4.581,3.456,8.426,8.008,8.945
            M10.5,1.75l3.5,2.5l-3.5,2.5`}))},c$6=function(){return c$6=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},c$6.apply(this,arguments)},a$6={left:0,top:8},i$6=function(nt){var st=nt.direction,mt=nt.onClick,gt=r$6.useContext(t$6.LocalizationContext).l10n,_t=gt&&gt.rotate?gt.rotate.rotateBackward:"Rotate counterclockwise",Et=gt&&gt.rotate?gt.rotate.rotateForward:"Rotate clockwise",At=st===t$6.RotateDirection.Backward?_t:Et,Rt=st===t$6.RotateDirection.Backward?r$6.createElement(n$6,null):r$6.createElement(o$6,null);return r$6.createElement(t$6.Tooltip,{ariaControlsSuffix:"rotate",position:t$6.Position.BottomCenter,target:r$6.createElement(t$6.MinimalButton,{ariaLabel:At,testId:st===t$6.RotateDirection.Backward?"rotate__backward-button":"rotate__forward-button",onClick:mt},Rt),content:function(){return At},offset:a$6})},u$6=function(nt){var st=nt.children,mt=nt.direction,gt=nt.store;return(st||function(_t){return r$6.createElement(i$6,{direction:_t.direction,onClick:_t.onClick})})({direction:mt,onClick:function(){var _t=gt.get("rotate");_t&&_t(mt)}})},l$6=function(nt){var st=nt.direction,mt=nt.onClick,gt=r$6.useContext(t$6.LocalizationContext).l10n,_t=gt&&gt.rotate?gt.rotate.rotateBackward:"Rotate counterclockwise",Et=gt&&gt.rotate?gt.rotate.rotateForward:"Rotate clockwise",At=st===t$6.RotateDirection.Backward?_t:Et,Rt=st===t$6.RotateDirection.Backward?r$6.createElement(n$6,null):r$6.createElement(o$6,null);return r$6.createElement(t$6.MenuItem,{icon:Rt,testId:st===t$6.RotateDirection.Backward?"rotate__backward-menu":"rotate__forward-menu",onClick:mt},At)},d$5=function(nt){var st=nt.children,mt=nt.store;return st({onRotatePage:function(gt,_t){var Et=mt.get("rotatePage");Et&&Et(gt,_t)}})};rotate_min.RotateBackwardIcon=n$6,rotate_min.RotateForwardIcon=o$6,rotate_min.rotatePlugin=function(){var nt=r$6.useMemo(function(){return t$6.createStore()},[]),st=function(mt){return r$6.createElement(u$6,c$6({},mt,{store:nt}))};return{install:function(mt){nt.update("rotate",mt.rotate),nt.update("rotatePage",mt.rotatePage)},Rotate:st,RotateBackwardButton:function(){return r$6.createElement(st,{direction:t$6.RotateDirection.Backward},function(mt){return r$6.createElement(i$6,c$6({},mt))})},RotateBackwardMenuItem:function(mt){return r$6.createElement(st,{direction:t$6.RotateDirection.Backward},function(gt){return r$6.createElement(l$6,{direction:gt.direction,onClick:function(){gt.onClick(),mt.onClick()}})})},RotateForwardButton:function(){return r$6.createElement(st,{direction:t$6.RotateDirection.Forward},function(mt){return r$6.createElement(i$6,c$6({},mt))})},RotateForwardMenuItem:function(mt){return r$6.createElement(st,{direction:t$6.RotateDirection.Forward},function(gt){return r$6.createElement(l$6,{direction:gt.direction,onClick:function(){gt.onClick(),mt.onClick()}})})},RotatePage:function(mt){return r$6.createElement(d$5,c$6({},mt,{store:nt}))}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$4.exports=rotate_min;var libExports$6=lib$4.exports,lib$3={exports:{}},scrollMode_min={},e$5=libExports$h;function o$5(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var t$5=o$5(reactExports),l$5=function(){return t$5.createElement(e$5.Icon,{size:16},t$5.createElement("rect",{x:"0.5",y:"0.497",width:"22",height:"22",rx:"1",ry:"1"}),t$5.createElement("line",{x1:"0.5",y1:"6.497",x2:"22.5",y2:"6.497"}),t$5.createElement("line",{x1:"11.5",y1:"6.497",x2:"11.5",y2:"22.497"}))},c$5=function(){return t$5.createElement(e$5.Icon,{size:16},t$5.createElement("rect",{x:"0.5",y:"0.497",width:"22",height:"22",rx:"1",ry:"1"}),t$5.createElement("line",{x1:"11.5",y1:"0.497",x2:"11.5",y2:"22.497"}))},n$5=function(){return t$5.createElement(e$5.Icon,{size:16},t$5.createElement("path",{d:`M6.5,21.5c0,0.552-0.448,1-1,1h-4c-0.552,0-1-0.448-1-1v-20c0-0.552,0.448-1,1-1h4c0.552,0,1,0.448,1,1V21.5z
            M14.5,21.5c0,0.552-0.448,1-1,1h-4c-0.552,0-1-0.448-1-1v-20c0-0.552,0.448-1,1-1h4c0.552,0,1,0.448,1,1V21.5z
            M22.5,21.5 c0,0.552-0.448,1-1,1h-4c-0.552,0-1-0.448-1-1v-20c0-0.552,0.448-1,1-1h4c0.552,0,1,0.448,1,1V21.5z`}))},r$5=function(){return t$5.createElement(e$5.Icon,{size:16},t$5.createElement("rect",{x:"0.5",y:"0.497",width:"22",height:"22",rx:"1",ry:"1"}))},i$5=function(){return i$5=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},i$5.apply(this,arguments)},a$5=function(nt,st){nt.get("switchScrollMode")(st);var mt=nt.get("viewMode");st!==e$5.ScrollMode.Horizontal&&st!==e$5.ScrollMode.Wrapped||mt===e$5.ViewMode.SinglePage||nt.get("switchViewMode")(e$5.ViewMode.SinglePage)},d$4=function(){return t$5.createElement(e$5.Icon,{size:16},t$5.createElement("path",{d:`M23.5,5.5c0,0.552-0.448,1-1,1h-21c-0.552,0-1-0.448-1-1v-3c0-0.552,0.448-1,1-1h21c0.552,0,1,0.448,1,1V5.5z
            M23.5,13.5c0,0.552-0.448,1-1,1h-21c-0.552,0-1-0.448-1-1v-3c0-0.552,0.448-1,1-1h21c0.552,0,1,0.448,1,1V13.5z
            M23.5,21.5 c0,0.552-0.448,1-1,1h-21c-0.552,0-1-0.448-1-1v-3c0-0.552,0.448-1,1-1h21c0.552,0,1,0.448,1,1V21.5z`}))},s$4=function(){return t$5.createElement(e$5.Icon,{size:16},t$5.createElement("path",{d:`M10.5,9.5c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V9.5z
            M23.5,9.5c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V9.5z
            M10.5,22.5 c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V22.5z
            M23.5,22.5c0,0.552-0.448,1-1,1 h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V22.5z`}))},u$5=function(nt){var st=nt.children,mt=nt.mode,gt=nt.onClick,_t=t$5.useContext(e$5.LocalizationContext).l10n,Et="",At=t$5.createElement(d$4,null);switch(mt){case e$5.ScrollMode.Horizontal:Et=_t&&_t.scrollMode?_t.scrollMode.horizontalScrolling:"Horizontal scrolling",At=t$5.createElement(n$5,null);break;case e$5.ScrollMode.Page:Et=_t&&_t.scrollMode?_t.scrollMode.pageScrolling:"Page scrolling",At=t$5.createElement(r$5,null);break;case e$5.ScrollMode.Wrapped:Et=_t&&_t.scrollMode?_t.scrollMode.wrappedScrolling:"Wrapped scrolling",At=t$5.createElement(s$4,null);break;case e$5.ScrollMode.Vertical:default:Et=_t&&_t.scrollMode?_t.scrollMode.verticalScrolling:"Vertical scrolling",At=t$5.createElement(d$4,null)}return st({icon:At,label:Et,onClick:gt})},m$4={left:0,top:8},M$2=function(nt){var st=nt.isDisabled,mt=nt.isSelected,gt=nt.mode,_t=nt.onClick,Et="";switch(gt){case e$5.ScrollMode.Horizontal:Et="scroll-mode__horizontal-button";break;case e$5.ScrollMode.Page:Et="scroll-mode__page-button";break;case e$5.ScrollMode.Wrapped:Et="scroll-mode__wrapped-button";break;case e$5.ScrollMode.Vertical:default:Et="scroll-mode__vertical-button"}return t$5.createElement(u$5,{mode:gt,onClick:_t},function(At){return t$5.createElement(e$5.Tooltip,{ariaControlsSuffix:"scroll-mode-switch",position:e$5.Position.BottomCenter,target:t$5.createElement(e$5.MinimalButton,{ariaLabel:At.label,isDisabled:st,isSelected:mt,testId:Et,onClick:At.onClick},At.icon),content:function(){return At.label},offset:m$4})})},f$4=function(nt){var st=t$5.useState(nt.get("scrollMode")||e$5.ScrollMode.Vertical),mt=st[0],gt=st[1],_t=function(Et){gt(Et)};return t$5.useEffect(function(){return nt.subscribe("scrollMode",_t),function(){nt.unsubscribe("scrollMode",_t)}},[]),{scrollMode:mt}},w$1=function(nt){var st=t$5.useState(nt.get("viewMode")||e$5.ViewMode.SinglePage),mt=st[0],gt=st[1],_t=function(Et){gt(Et)};return t$5.useEffect(function(){return nt.subscribe("viewMode",_t),function(){nt.unsubscribe("viewMode",_t)}},[]),{viewMode:mt}},S$3=function(nt){var st=nt.children,mt=nt.mode,gt=nt.store,_t=w$1(gt).viewMode,Et=f$4(gt).scrollMode===mt,At=(mt===e$5.ScrollMode.Horizontal||mt===e$5.ScrollMode.Wrapped)&&_t!==e$5.ViewMode.SinglePage;return(st||function(Rt){return t$5.createElement(M$2,{isDisabled:At,isSelected:Et,mode:Rt.mode,onClick:Rt.onClick})})({isDisabled:At,isSelected:Et,mode:mt,onClick:function(){a$5(gt,mt)}})},g$3=function(nt){var st=nt.isDisabled,mt=nt.isSelected,gt=nt.mode,_t=nt.onClick,Et="";switch(gt){case e$5.ScrollMode.Horizontal:Et="scroll-mode__horizontal-menu";break;case e$5.ScrollMode.Page:Et="scroll-mode__page-menu";break;case e$5.ScrollMode.Wrapped:Et="scroll-mode__wrapped-menu";break;case e$5.ScrollMode.Vertical:default:Et="scroll-mode__vertical-menu"}return t$5.createElement(u$5,{mode:gt,onClick:_t},function(At){return t$5.createElement(e$5.MenuItem,{checked:mt,icon:At.icon,isDisabled:st,testId:Et,onClick:At.onClick},At.label)})},h$3=function(nt,st){nt.get("switchViewMode")(st);var mt=nt.get("scrollMode");mt!==e$5.ScrollMode.Horizontal&&mt!==e$5.ScrollMode.Wrapped||st===e$5.ViewMode.SinglePage||nt.get("switchScrollMode")(e$5.ScrollMode.Vertical)},b$3=function(nt){var st=nt.children,mt=nt.mode,gt=nt.onClick,_t=t$5.useContext(e$5.LocalizationContext).l10n,Et="",At=t$5.createElement(r$5,null);switch(mt){case e$5.ViewMode.DualPage:Et=_t&&_t.scrollMode?_t.scrollMode.dualPage:"Dual page",At=t$5.createElement(c$5,null);break;case e$5.ViewMode.DualPageWithCover:Et=_t&&_t.scrollMode?_t.scrollMode.dualPageCover:"Dual page with cover",At=t$5.createElement(l$5,null);break;case e$5.ViewMode.SinglePage:default:Et=_t&&_t.scrollMode?_t.scrollMode.singlePage:"Single page",At=t$5.createElement(r$5,null)}return st({icon:At,label:Et,onClick:gt})},p$3={left:0,top:8},v$3=function(nt){var st=nt.isDisabled,mt=nt.isSelected,gt=nt.mode,_t=nt.onClick,Et="";switch(gt){case e$5.ViewMode.DualPage:Et="view-mode__dual-button";break;case e$5.ViewMode.DualPageWithCover:Et="view-mode__dual-cover-button";break;case e$5.ViewMode.SinglePage:default:Et="view-mode__single-button"}return t$5.createElement(b$3,{mode:gt,onClick:_t},function(At){return t$5.createElement(e$5.Tooltip,{ariaControlsSuffix:"view-mode-switch",position:e$5.Position.BottomCenter,target:t$5.createElement(e$5.MinimalButton,{ariaLabel:At.label,isDisabled:st,isSelected:mt,testId:Et,onClick:At.onClick},At.icon),content:function(){return At.label},offset:p$3})})},k$2=function(nt){var st=nt.children,mt=nt.mode,gt=nt.store,_t=w$1(gt).viewMode,Et=f$4(gt).scrollMode,At=_t===mt,Rt=(Et===e$5.ScrollMode.Horizontal||Et===e$5.ScrollMode.Wrapped)&&mt!==e$5.ViewMode.SinglePage;return(st||function(Ft){return t$5.createElement(v$3,{isDisabled:Rt,isSelected:At,mode:Ft.mode,onClick:Ft.onClick})})({isDisabled:Rt,isSelected:At,mode:mt,onClick:function(){h$3(gt,mt)}})},C$2=function(nt){var st=nt.isDisabled,mt=nt.isSelected,gt=nt.mode,_t=nt.onClick,Et="";switch(gt){case e$5.ViewMode.DualPage:Et="view-mode__dual-menu";break;case e$5.ViewMode.DualPageWithCover:Et="view-mode__dual-cover-menu";break;case e$5.ViewMode.SinglePage:default:Et="view-mode__single-menu"}return t$5.createElement(b$3,{mode:gt,onClick:_t},function(At){return t$5.createElement(e$5.MenuItem,{checked:mt,icon:At.icon,isDisabled:st,testId:Et,onClick:At.onClick},At.label)})};scrollMode_min.DualPageCoverViewModeIcon=l$5,scrollMode_min.DualPageViewModeIcon=c$5,scrollMode_min.HorizontalScrollingIcon=n$5,scrollMode_min.PageScrollingIcon=r$5,scrollMode_min.VerticalScrollingIcon=d$4,scrollMode_min.WrappedScrollingIcon=s$4,scrollMode_min.scrollModePlugin=function(){var nt=t$5.useMemo(function(){return e$5.createStore({scrollMode:e$5.ScrollMode.Vertical,viewMode:e$5.ViewMode.SinglePage,switchScrollMode:function(){},switchViewMode:function(){}})},[]),st=function(gt){return t$5.createElement(S$3,i$5({},gt,{store:nt}))},mt=function(gt){return t$5.createElement(k$2,i$5({},gt,{store:nt}))};return{install:function(gt){nt.update("switchScrollMode",gt.switchScrollMode),nt.update("switchViewMode",gt.switchViewMode)},onViewerStateChange:function(gt){return nt.update("scrollMode",gt.scrollMode),nt.update("viewMode",gt.viewMode),gt},switchScrollMode:function(gt){a$5(nt,gt)},switchViewMode:function(gt){h$3(nt,gt)},SwitchScrollMode:st,SwitchScrollModeButton:function(gt){return t$5.createElement(st,{mode:gt.mode},function(_t){return t$5.createElement(M$2,{isDisabled:_t.isDisabled,isSelected:_t.isSelected,mode:_t.mode,onClick:function(){_t.onClick()}})})},SwitchScrollModeMenuItem:function(gt){return t$5.createElement(st,{mode:gt.mode},function(_t){return t$5.createElement(g$3,{isDisabled:_t.isDisabled,isSelected:_t.isSelected,mode:_t.mode,onClick:function(){_t.onClick(),gt.onClick()}})})},SwitchViewMode:mt,SwitchViewModeButton:function(gt){return t$5.createElement(mt,{mode:gt.mode},function(_t){return t$5.createElement(v$3,{isDisabled:_t.isDisabled,isSelected:_t.isSelected,mode:_t.mode,onClick:function(){_t.onClick()}})})},SwitchViewModeMenuItem:function(gt){return t$5.createElement(mt,{mode:gt.mode},function(_t){return t$5.createElement(C$2,{isDisabled:_t.isDisabled,isSelected:_t.isSelected,mode:_t.mode,onClick:function(){_t.onClick(),gt.onClick()}})})}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$3.exports=scrollMode_min;var libExports$5=lib$3.exports,lib$2={exports:{}},search_min={},e$4=libExports$h;function t$4(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var r$4=t$4(reactExports),n$4=function(){return r$4.createElement(e$4.Icon,{size:16},r$4.createElement("path",{d:`M0.541,5.627L11.666,18.2c0.183,0.207,0.499,0.226,0.706,0.043c0.015-0.014,0.03-0.028,0.043-0.043
            L23.541,5.627`}))},o$4=function(){return r$4.createElement(e$4.Icon,{size:16},r$4.createElement("path",{d:`M23.535,18.373L12.409,5.8c-0.183-0.207-0.499-0.226-0.706-0.043C11.688,5.77,11.674,5.785,11.66,5.8
            L0.535,18.373`}))},a$4=function(){return r$4.createElement(e$4.Icon,{ignoreDirection:!0,size:16},r$4.createElement("path",{d:`M10.5,0.5c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.5,10.5,0.5z
            M23.5,23.5
            l-5.929-5.929`}))},c$4=function(){return c$4=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},c$4.apply(this,arguments)},u$4={keyword:"",regExp:new RegExp(" "),wholeWords:!1},i$4=function(nt){return{left:"".concat(nt.left,"%"),top:"".concat(nt.top,"%"),height:"".concat(nt.height,"%"),width:"".concat(nt.width,"%")}},s$3=function(nt){var st=nt.index,mt=nt.area,gt=nt.onHighlightKeyword,_t=r$4.useRef();return e$4.useIsomorphicLayoutEffect(function(){var Et=_t.current;gt&&Et&&gt({highlightEle:Et,keyword:mt.keyword})},[]),r$4.createElement("div",{className:"rpv-search__highlight","data-index":st,ref:_t,style:i$4(mt),title:mt.keywordStr.trim()})},l$4=function(nt){var st=nt.parentNode;st&&st.removeChild(nt)},h$2=function(nt){var st=nt.parentNode;if(st){var mt=document.createRange();mt.selectNodeContents(nt),function(gt,_t){l$4(gt);var Et=_t.parentNode;Et&&Et.insertBefore(gt,_t),l$4(_t)}(mt.extractContents(),nt),st.normalize()}},d$3=function(nt,st){return nt.top<st.top?-1:nt.top>st.top?1:nt.left<st.left?-1:nt.left>st.left?1:0},f$3=function(nt){var st=nt.numPages,mt=nt.pageIndex,gt=nt.renderHighlights,_t=nt.store,Et=nt.onHighlightKeyword,At=r$4.useRef(),Rt=r$4.useCallback(function(uu){return r$4.createElement(r$4.Fragment,null,uu.highlightAreas.map(function(p0,X1){return r$4.createElement(s$3,{index:X1,key:X1,area:p0,onHighlightKeyword:Et})}))},[]),Ft=gt||Rt,Nt=r$4.useState(_t.get("matchPosition")),Bt=Nt[0],Gt=Nt[1],dr=r$4.useState(_t.get("keyword")||[u$4]),Mr=dr[0],Tr=dr[1],zr=r$4.useState({pageIndex:mt,scale:1,status:e$4.LayerRenderStatus.PreRender}),Fr=zr[0],Nr=zr[1],tn=r$4.useRef(null),rn=r$4.useRef([]),Tn=r$4.useState([]),$n=Tn[0],un=Tn[1],es=function(){return!0},kn=r$4.useCallback(function(){return _t.get("targetPageFilter")||es},[_t.get("targetPageFilter")]),ts=function(uu){var p0=rn.current;if(p0.length===0)return[];var X1=[],q0=[].slice.call(uu.querySelectorAll(".rpv-core__text-layer-text")),W0=p0.map(function(hu){return hu.char}).join("");return Mr.forEach(function(hu){var a1=hu.keyword;if(a1.trim()){for(var Vx,t0=hu.regExp.flags.indexOf("g")===-1?new RegExp(hu.regExp,"".concat(hu.regExp.flags,"g")):hu.regExp,cu=[];(Vx=t0.exec(W0))!==null;)cu.push({keyword:t0,startIndex:Vx.index,endIndex:t0.lastIndex});cu.map(function(lu){return{keyword:lu.keyword,indexes:p0.slice(lu.startIndex,lu.endIndex)}}).forEach(function(lu){var b0=lu.indexes.reduce(function(l1,LE){return l1[LE.spanIndex]=(l1[LE.spanIndex]||[]).concat([LE]),l1},{});Object.values(b0).forEach(function(l1){if(l1.length!==1||l1[0].char.trim()!==""){var LE=hu.wholeWords?l1.slice(1,-1):l1,eS=function(SA,o$,h$,d$,y$){var R$=document.createRange(),M$=d$.firstChild;if(!M$||M$.nodeType!==Node.TEXT_NODE)return null;var x$=M$.textContent.length,v$=y$[0].charIndexInSpan,rS=y$.length===1?v$:y$[y$.length-1].charIndexInSpan;if(v$>x$||rS+1>x$)return null;R$.setStart(M$,v$),R$.setEnd(M$,rS+1);var wA=document.createElement("span");R$.surroundContents(wA);var g$=wA.getBoundingClientRect(),S$=h$.getBoundingClientRect(),tA=S$.height,tS=S$.width,m$=100*(g$.left-S$.left)/tS,u$=100*(g$.top-S$.top)/tA,UE=100*g$.height/tA,F$=100*g$.width/tS;return h$2(wA),{keyword:o$,keywordStr:SA,numPages:st,pageIndex:mt,left:m$,top:u$,height:UE,width:F$,pageHeight:tA,pageWidth:tS}}(a1,lu.keyword,uu,q0[LE[0].spanIndex],LE);eS&&X1.push(eS)}})})}}),X1.sort(d$3)},Ko=function(uu){uu&&uu.length>0&&Tr(uu)},ds=function(uu){return Gt(uu)},Il=function(uu){if(uu.has(mt)){var p0=uu.get(mt);p0&&Nr({ele:p0.ele,pageIndex:mt,scale:p0.scale,status:p0.status})}},ru=function(){return Mr.length===0||Mr.length===1&&Mr[0].keyword.trim()===""};return r$4.useEffect(function(){if(!ru()&&Fr.status===e$4.LayerRenderStatus.DidRender&&!rn.current.length){var uu=Fr.ele,p0=[].slice.call(uu.querySelectorAll(".rpv-core__text-layer-text")).map(function(X1){return X1.textContent}).reduce(function(X1,q0,W0){return X1.concat(q0.split("").map(function(hu,a1){return{char:hu,charIndexInSpan:a1,spanIndex:W0}}))},[{char:"",charIndexInSpan:0,spanIndex:0}]).slice(1);rn.current=p0}},[Mr,Fr.status]),r$4.useEffect(function(){if(!ru()&&Fr.ele&&Fr.status===e$4.LayerRenderStatus.DidRender&&kn()({pageIndex:mt,numPages:st})){var uu=Fr.ele,p0=ts(uu);un(p0)}},[Mr,Bt,Fr.status,rn.current]),r$4.useEffect(function(){ru()&&Fr.ele&&Fr.status===e$4.LayerRenderStatus.DidRender&&un([])},[Mr,Fr.status]),r$4.useEffect(function(){if($n.length!==0){var uu=At.current;if(Bt.pageIndex===mt&&uu&&Fr.status===e$4.LayerRenderStatus.DidRender){var p0=uu.querySelector('.rpv-search__highlight[data-index="'.concat(Bt.matchIndex,'"]'));if(p0){var X1=function(a1,Vx){for(var t0=a1.offsetTop,cu=a1.offsetLeft,lu=a1.parentElement;lu&&lu!==Vx;)t0+=lu.offsetTop,cu+=lu.offsetLeft,lu=lu.parentElement;return{left:cu,top:t0}}(p0,uu),q0=X1.left,W0=X1.top,hu=_t.get("jumpToDestination");hu&&(hu({pageIndex:mt,bottomOffset:(uu.getBoundingClientRect().height-W0)/Fr.scale,leftOffset:q0/Fr.scale,scaleTo:Fr.scale}),tn.current&&tn.current.classList.remove("rpv-search__highlight--current"),tn.current=p0,p0.classList.add("rpv-search__highlight--current"))}}}},[$n,Bt]),r$4.useEffect(function(){return _t.subscribe("keyword",Ko),_t.subscribe("matchPosition",ds),_t.subscribe("renderStatus",Il),function(){_t.unsubscribe("keyword",Ko),_t.unsubscribe("matchPosition",ds),_t.unsubscribe("renderStatus",Il)}},[]),r$4.createElement("div",{className:"rpv-search__highlights","data-testid":"search__highlights-".concat(mt),ref:At},Ft({getCssProperties:i$4,highlightAreas:$n}))},p$2=function(nt){var st,mt=nt.wholeWords?" ".concat(nt.keyword," "):nt.keyword,gt=nt.matchCase?"g":"gi";return{keyword:nt.keyword,regExp:new RegExp((st=mt,st.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),gt),wholeWords:nt.wholeWords||!1}},g$2=function(nt,st,mt){return nt instanceof RegExp?{keyword:nt.source,regExp:nt,wholeWords:mt||!1}:typeof nt=="string"?nt===""?u$4:p$2({keyword:nt,matchCase:st||!1,wholeWords:mt||!1}):(st!==void 0&&(nt.matchCase=st),mt!==void 0&&(nt.wholeWords=mt),p$2(nt))},m$3=function(nt){var st,mt=nt.get("initialKeyword"),gt=r$4.useMemo(function(){if(mt&&mt.length===1){var ds=g$2(mt[0]);return{matchCase:ds.regExp.flags.indexOf("i")===-1,wholeWords:ds.wholeWords}}return{matchCase:!1,wholeWords:!1}},[]),_t=function(ds){var Il=r$4.useRef(ds.get("doc")),ru=function(uu){Il.current=uu};return r$4.useEffect(function(){return ds.subscribe("doc",ru),function(){ds.unsubscribe("doc",ru)}},[]),Il}(nt),Et=r$4.useState(mt),At=Et[0],Rt=Et[1],Ft=r$4.useState([]),Nt=Ft[0],Bt=Ft[1],Gt=r$4.useState(0),dr=Gt[0],Mr=Gt[1],Tr=r$4.useState(gt.matchCase),zr=Tr[0],Fr=Tr[1],Nr=r$4.useRef([]),tn=r$4.useState(gt.wholeWords),rn=tn[0],Tn=tn[1],$n=function(){return!0},un=r$4.useCallback(function(){return nt.get("targetPageFilter")||$n},[nt.get("targetPageFilter")]),es=function(ds){var Il=Nt.length;if(At.length===0||Il===0)return null;var ru=ds===Il+1?1:Math.max(1,Math.min(Il,ds));return Mr(ru),ts(Nt[ru-1])},kn=function(ds){return Rt(ds===""?[]:[ds])},ts=function(ds){var Il=nt.get("jumpToPage");return Il&&Il(ds.pageIndex),nt.update("matchPosition",{matchIndex:ds.matchIndex,pageIndex:ds.pageIndex}),ds},Ko=function(ds,Il,ru){var uu=_t.current;if(!uu)return Promise.resolve([]);var p0=uu.numPages,X1=ds.map(function(q0){return g$2(q0,Il,ru)});return nt.update("keyword",X1),Mr(0),Bt([]),new Promise(function(q0,W0){var hu=Nr.current.length===0?function(){var a1=_t.current;if(!a1)return Promise.resolve([]);var Vx=Array(a1.numPages).fill(0).map(function(t0,cu){return e$4.getPage(a1,cu).then(function(lu){return lu.getTextContent()}).then(function(lu){var b0=lu.items.map(function(l1){return l1.str||""}).join("");return Promise.resolve({pageContent:b0,pageIndex:cu})})});return Promise.all(Vx).then(function(t0){return t0.sort(function(cu,lu){return cu.pageIndex-lu.pageIndex}),Promise.resolve(t0.map(function(cu){return cu.pageContent}))})}().then(function(a1){return Nr.current=a1,Promise.resolve(a1)}):Promise.resolve(Nr.current);hu.then(function(a1){var Vx=[];a1.forEach(function(t0,cu){un()({pageIndex:cu,numPages:p0})&&X1.forEach(function(lu){for(var b0,l1=0;(b0=lu.regExp.exec(t0))!==null;)Vx.push({keyword:lu.regExp,matchIndex:l1,pageIndex:cu,pageText:t0,startIndex:b0.index,endIndex:lu.regExp.lastIndex}),l1++})}),Bt(Vx),Vx.length>0&&(Mr(1),ts(Vx[0])),q0(Vx)})})};return r$4.useEffect(function(){Nr.current=[]},[_t.current]),{clearKeyword:function(){nt.update("keyword",[u$4]),kn(""),Mr(0),Bt([]),Fr(!1),Tn(!1)},changeMatchCase:function(ds){Fr(ds),At.length>0&&Ko(At,ds,rn)},changeWholeWords:function(ds){Tn(ds),At.length>0&&Ko(At,zr,ds)},currentMatch:dr,jumpToMatch:es,jumpToNextMatch:function(){return es(dr+1)},jumpToPreviousMatch:function(){return es(dr-1)},keywords:At,matchCase:zr,numberOfMatches:Nt.length,wholeWords:rn,search:function(){return Ko(At,zr,rn)},searchFor:Ko,setKeywords:Rt,keyword:At.length===0?"":(st=At[0],st instanceof RegExp?st.source:typeof st=="string"?st:st.keyword),setKeyword:kn,setTargetPages:function(ds){nt.update("targetPageFilter",ds)}}},v$2=function(nt){var st=nt.children,mt=nt.store,gt=m$3(mt),_t=r$4.useState(!1),Et=_t[0],At=_t[1],Rt=function(Ft){return At(!0)};return r$4.useEffect(function(){return mt.subscribe("doc",Rt),function(){mt.unsubscribe("doc",Rt)}},[]),st(c$4(c$4({},gt),{isDocumentLoaded:Et}))},x=function(nt){var st=nt.containerRef,mt=nt.store,gt=r$4.useRef(!1),_t=function(){gt.current=!0},Et=function(){gt.current=!1},At=function(Rt){var Ft=st.current;Ft&&(Rt.shiftKey||Rt.altKey||Rt.key!=="f"||(e$4.isMac()?Rt.metaKey&&!Rt.ctrlKey:Rt.ctrlKey)&&(gt.current||document.activeElement&&Ft.contains(document.activeElement))&&(Rt.preventDefault(),mt.update("areShortcutsPressed",!0)))};return r$4.useEffect(function(){var Rt=st.current;if(Rt)return document.addEventListener("keydown",At),Rt.addEventListener("mouseenter",_t),Rt.addEventListener("mouseleave",Et),function(){document.removeEventListener("keydown",At),Rt.removeEventListener("mouseenter",_t),Rt.removeEventListener("mouseleave",Et)}},[st.current]),r$4.createElement(r$4.Fragment,null)},y={left:0,top:8},E$2=function(nt){var st=nt.store,mt=nt.onToggle,gt=r$4.useContext(e$4.LocalizationContext).l10n,_t=r$4.useContext(e$4.ThemeContext).direction,Et=r$4.useState(!1),At=Et[0],Rt=Et[1],Ft=r$4.useState(!1),Nt=Ft[0],Bt=Ft[1],Gt=_t===e$4.TextDirection.RightToLeft,dr=m$3(st),Mr=dr.clearKeyword,Tr=dr.changeMatchCase,zr=dr.changeWholeWords,Fr=dr.currentMatch,Nr=dr.jumpToNextMatch,tn=dr.jumpToPreviousMatch,rn=dr.keyword,Tn=dr.matchCase,$n=dr.numberOfMatches,un=dr.wholeWords,es=dr.search,kn=dr.setKeyword,ts=function(uu){Rt(!0),es().then(function(p0){Rt(!1),Bt(!0),uu&&uu()})};r$4.useEffect(function(){var uu=st.get("initialKeyword");uu&&uu.length===1&&rn&&ts(function(){st.update("initialKeyword",[])})},[]);var Ko=gt&&gt.search?gt.search.enterToSearch:"Enter to search",ds=gt&&gt.search?gt.search.previousMatch:"Previous match",Il=gt&&gt.search?gt.search.nextMatch:"Next match",ru=gt&&gt.search?gt.search.close:"Close";return r$4.createElement("div",{className:"rpv-search__popover"},r$4.createElement("div",{className:"rpv-search__popover-input-counter"},r$4.createElement(e$4.TextBox,{ariaLabel:Ko,autoFocus:!0,placeholder:Ko,type:"text",value:rn,onChange:function(uu){Bt(!1),kn(uu)},onKeyDown:function(uu){uu.key==="Enter"&&rn&&(Nt?Nr():ts())}}),r$4.createElement("div",{className:e$4.classNames({"rpv-search__popover-counter":!0,"rpv-search__popover-counter--ltr":!Gt,"rpv-search__popover-counter--rtl":Gt})},At&&r$4.createElement(e$4.Spinner,{testId:"search__popover-searching",size:"1rem"}),!At&&r$4.createElement("span",{"data-testid":"search__popover-num-matches"},Fr,"/",$n))),r$4.createElement("label",{className:"rpv-search__popover-label"},r$4.createElement("input",{className:"rpv-search__popover-label-checkbox","data-testid":"search__popover-match-case",checked:Tn,type:"checkbox",onChange:function(uu){Bt(!1),Tr(uu.target.checked)}})," ",gt&&gt.search?gt.search.matchCase:"Match case"),r$4.createElement("label",{className:"rpv-search__popover-label"},r$4.createElement("input",{className:"rpv-search__popover-label-checkbox",checked:un,"data-testid":"search__popover-whole-words",type:"checkbox",onChange:function(uu){Bt(!1),zr(uu.target.checked)}})," ",gt&&gt.search?gt.search.wholeWords:"Whole words"),r$4.createElement("div",{className:"rpv-search__popover-footer"},r$4.createElement("div",{className:"rpv-search__popover-footer-item"},r$4.createElement(e$4.Tooltip,{ariaControlsSuffix:"search-previous-match",position:Gt?e$4.Position.BottomRight:e$4.Position.BottomCenter,target:r$4.createElement(e$4.MinimalButton,{ariaLabel:ds,isDisabled:Fr<=1,onClick:tn},r$4.createElement(o$4,null)),content:function(){return ds},offset:y})),r$4.createElement("div",{className:"rpv-search__popover-footer-item"},r$4.createElement(e$4.Tooltip,{ariaControlsSuffix:"search-next-match",position:e$4.Position.BottomCenter,target:r$4.createElement(e$4.MinimalButton,{ariaLabel:Il,isDisabled:Fr>$n-1,onClick:Nr},r$4.createElement(n$4,null)),content:function(){return Il},offset:y})),r$4.createElement("div",{className:e$4.classNames({"rpv-search__popover-footer-button":!0,"rpv-search__popover-footer-button--ltr":!Gt,"rpv-search__popover-footer-button--rtl":Gt})},r$4.createElement(e$4.Button,{onClick:function(){mt(),Mr()}},ru))))},w=function(nt){var st=nt.children,mt=nt.onClick,gt=r$4.useContext(e$4.LocalizationContext).l10n,_t=gt&&gt.search?gt.search.search:"Search";return st({icon:r$4.createElement(a$4,null),label:_t,onClick:mt})},b$2={left:0,top:8},k$1=function(nt){var st=nt.enableShortcuts,mt=nt.store,gt=nt.onClick,_t=st?e$4.isMac()?"Meta+F":"Ctrl+F":"",Et=function(At){At&&gt()};return r$4.useEffect(function(){return mt.subscribe("areShortcutsPressed",Et),function(){mt.unsubscribe("areShortcutsPressed",Et)}},[]),r$4.createElement(w,{onClick:gt},function(At){return r$4.createElement(e$4.Tooltip,{ariaControlsSuffix:"search-popover",position:e$4.Position.BottomCenter,target:r$4.createElement(e$4.MinimalButton,{ariaKeyShortcuts:_t,ariaLabel:At.label,testId:"search__popover-button",onClick:gt},At.icon),content:function(){return At.label},offset:b$2})})},S$2={left:0,top:8},C$1=function(nt){var st=nt.children,mt=nt.enableShortcuts,gt=nt.store,_t=r$4.useContext(e$4.ThemeContext).direction===e$4.TextDirection.RightToLeft?e$4.Position.BottomRight:e$4.Position.BottomLeft,Et=st||function(At){return r$4.createElement(k$1,c$4({enableShortcuts:mt,store:gt},At))};return r$4.createElement(e$4.Popover,{ariaControlsSuffix:"search",lockScroll:!1,position:_t,target:function(At){return Et({onClick:At})},content:function(At){return r$4.createElement(E$2,{store:gt,onToggle:At})},offset:S$2,closeOnClickOutside:!1,closeOnEscape:!0})},P$1=function(nt){return Array.isArray(nt)?nt.map(function(st){return g$2(st)}):[g$2(nt)]};search_min.NextIcon=n$4,search_min.PreviousIcon=o$4,search_min.SearchIcon=a$4,search_min.searchPlugin=function(nt){var st=r$4.useMemo(function(){return Object.assign({},{enableShortcuts:!0,onHighlightKeyword:function(){}},nt)},[]),mt=r$4.useMemo(function(){return e$4.createStore({initialKeyword:nt&&nt.keyword?Array.isArray(nt.keyword)?nt.keyword:[nt.keyword]:[],keyword:nt&&nt.keyword?P$1(nt.keyword):[u$4],matchPosition:{matchIndex:-1,pageIndex:-1},renderStatus:new Map})},[]),gt=m$3(mt),_t=gt.clearKeyword,Et=gt.jumpToMatch,At=gt.jumpToNextMatch,Rt=gt.jumpToPreviousMatch,Ft=gt.searchFor,Nt=gt.setKeywords,Bt=gt.setTargetPages,Gt=function(dr){return r$4.createElement(C$1,c$4({enableShortcuts:st.enableShortcuts},dr,{store:mt}))};return{install:function(dr){var Mr=nt&&nt.keyword?Array.isArray(nt.keyword)?nt.keyword:[nt.keyword]:[],Tr=nt&&nt.keyword?P$1(nt.keyword):[u$4];mt.update("initialKeyword",Mr),mt.update("jumpToDestination",dr.jumpToDestination),mt.update("jumpToPage",dr.jumpToPage),mt.update("keyword",Tr)},renderPageLayer:function(dr){return r$4.createElement(f$3,{key:dr.pageIndex,numPages:dr.doc.numPages,pageIndex:dr.pageIndex,renderHighlights:nt==null?void 0:nt.renderHighlights,store:mt,onHighlightKeyword:st.onHighlightKeyword})},renderViewer:function(dr){var Mr=dr.slot;return Mr.subSlot&&(Mr.subSlot.children=r$4.createElement(r$4.Fragment,null,st.enableShortcuts&&r$4.createElement(x,{containerRef:dr.containerRef,store:mt}),Mr.subSlot.children)),Mr},uninstall:function(dr){var Mr=mt.get("renderStatus");Mr&&Mr.clear()},onDocumentLoad:function(dr){mt.update("doc",dr.doc)},onTextLayerRender:function(dr){var Mr=mt.get("renderStatus");Mr&&(Mr=Mr.set(dr.pageIndex,dr),mt.update("renderStatus",Mr))},Search:function(dr){return r$4.createElement(v$2,c$4({},dr,{store:mt}))},ShowSearchPopover:Gt,ShowSearchPopoverButton:function(){return r$4.createElement(Gt,null,function(dr){return r$4.createElement(k$1,c$4({enableShortcuts:st.enableShortcuts,store:mt},dr))})},clearHighlights:function(){_t()},highlight:function(dr){var Mr=Array.isArray(dr)?dr:[dr];return Nt(Mr),Ft(Mr)},jumpToMatch:Et,jumpToNextMatch:At,jumpToPreviousMatch:Rt,setTargetPages:Bt}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$2.exports=search_min;var libExports$4=lib$2.exports,lib$1={exports:{}},theme_min={},e$3=libExports$h;function t$3(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var n$3=t$3(reactExports),r$3=function(){return n$3.createElement(e$3.Icon,{size:16},n$3.createElement("path",{d:"M19.5,15.106l2.4-2.4a1,1,0,0,0,0-1.414l-2.4-2.4V5.5a1,1,0,0,0-1-1H15.106l-2.4-2.4a1,1,0,0,0-1.414,0l-2.4,2.4H5.5a1,1,0,0,0-1,1V8.894l-2.4,2.4a1,1,0,0,0,0,1.414l2.4,2.4V18.5a1,1,0,0,0,1,1H8.894l2.4,2.4a1,1,0,0,0,1.414,0l2.4-2.4H18.5a1,1,0,0,0,1-1Z"}),n$3.createElement("path",{d:"M10,6.349a6,6,0,0,1,0,11.3,6,6,0,1,0,0-11.3Z"}))},c$3=function(){return n$3.createElement(e$3.Icon,{size:16},n$3.createElement("path",{d:"M19.491,15.106l2.4-2.4a1,1,0,0,0,0-1.414l-2.4-2.4V5.5a1,1,0,0,0-1-1H15.1L12.7,2.1a1,1,0,0,0-1.414,0l-2.4,2.4H5.491a1,1,0,0,0-1,1V8.894l-2.4,2.4a1,1,0,0,0,0,1.414l2.4,2.4V18.5a1,1,0,0,0,1,1H8.885l2.4,2.4a1,1,0,0,0,1.414,0l2.4-2.4h3.394a1,1,0,0,0,1-1Z"}),n$3.createElement("path",{d:"M11.491,6c4,0,6,2.686,6,6s-2,6-6,6Z"}))},o$3=function(){return o$3=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},o$3.apply(this,arguments)},a$3={left:0,top:8},i$3=function(nt){var st=nt.onClick,mt=n$3.useContext(e$3.ThemeContext),gt=n$3.useContext(e$3.LocalizationContext).l10n,_t=mt.currentTheme==="dark",Et=gt&&gt.theme?_t?gt.theme.switchLightTheme:gt.theme.switchDarkTheme:_t?"Switch to the light theme":"Switch to the dark theme";return n$3.createElement(e$3.Tooltip,{ariaControlsSuffix:"theme-switch",position:e$3.Position.BottomCenter,target:n$3.createElement(e$3.MinimalButton,{ariaLabel:Et,testId:"theme__switch-button",onClick:st},_t?n$3.createElement(c$3,null):n$3.createElement(r$3,null)),content:function(){return Et},offset:a$3})},l$3=function(nt){var st=nt.children,mt=n$3.useContext(e$3.ThemeContext);return(st||function(gt){return n$3.createElement(i$3,{onClick:gt.onClick})})({onClick:function(){return mt.setCurrentTheme(mt.currentTheme==="dark"?"light":"dark")}})},u$3=function(nt){var st=nt.onClick,mt=n$3.useContext(e$3.ThemeContext),gt=n$3.useContext(e$3.LocalizationContext).l10n,_t=mt.currentTheme==="dark",Et=gt&&gt.theme?_t?gt.theme.switchLightTheme:gt.theme.switchDarkTheme:_t?"Switch to the light theme":"Switch to the dark theme";return n$3.createElement(e$3.MenuItem,{icon:_t?n$3.createElement(c$3,null):n$3.createElement(r$3,null),testId:"theme__switch-menu",onClick:st},Et)};theme_min.DarkIcon=r$3,theme_min.LightIcon=c$3,theme_min.themePlugin=function(){var nt=function(st){return n$3.createElement(l$3,o$3({},st))};return{SwitchTheme:nt,SwitchThemeButton:function(){return n$3.createElement(nt,null,function(st){return n$3.createElement(i$3,o$3({},st))})},SwitchThemeMenuItem:function(st){return n$3.createElement(nt,null,function(mt){return n$3.createElement(u$3,{onClick:function(){mt.onClick(),st.onClick()}})})}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$1.exports=theme_min;var libExports$3=lib$1.exports,lib={exports:{}},zoom_min={},e$2=libExports$h;function t$2(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var n$2=t$2(reactExports),o$2=function(){return n$2.createElement(e$2.Icon,{ignoreDirection:!0,size:16},n$2.createElement("path",{d:`M10.5,0.499c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.499,10.5,0.499z
            M23.5,23.499
            l-5.929-5.929
            M5.5,10.499h10
            M10.5,5.499v10`}))},r$2=function(){return n$2.createElement(e$2.Icon,{ignoreDirection:!0,size:16},n$2.createElement("path",{d:`M10.5,0.499c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.499,10.5,0.499z
            M23.5,23.499
            l-5.929-5.929
            M5.5,10.499h10`}))},c$2=function(){return c$2=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},c$2.apply(this,arguments)},a$2=function(nt){var st=n$2.useState(nt.get("scale")||0),mt=st[0],gt=st[1],_t=function(Et){gt(Et)};return n$2.useEffect(function(){return nt.subscribe("scale",_t),function(){nt.unsubscribe("scale",_t)}},[]),{scale:mt}},u$2=function(nt){var st=nt.children,mt=nt.store;return(st||function(gt){return n$2.createElement(n$2.Fragment,null,"".concat(Math.round(100*gt.scale),"%"))})({scale:a$2(mt).scale})},l$2={passive:!1},i$2=null,s$2=function(nt){var st=nt.pagesContainerRef,mt=nt.store,gt=e$2.useDebounceCallback(function(Et){var At=mt.get("zoom");At&&At(Et)},40),_t=function(Et){if(Et.ctrlKey){Et.preventDefault();var At=Et.target.getBoundingClientRect(),Rt=1-Et.deltaY/100,Ft=Et.clientX-At.left,Nt=Et.clientY-At.top,Bt=mt.get("scale"),Gt=(i$2||(i$2=document.createElementNS("http://www.w3.org/2000/svg","svg"))).createSVGMatrix().translate(Ft,Nt).scale(Rt).translate(-Ft,-Nt).scale(Bt);gt(Gt.a)}};return e$2.useIsomorphicLayoutEffect(function(){var Et=st.current;if(Et)return Et.addEventListener("wheel",_t,l$2),function(){Et.removeEventListener("wheel",_t)}},[]),n$2.createElement(n$2.Fragment,null)},m$2=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.3,1.5,1.7,1.9,2.1,2.4,2.7,3,3.3,3.7,4.1,4.6,5.1,5.7,6.3,7,7.7,8.5,9.4,10],f$2=function(nt){return m$2.find(function(st){return st>nt})||nt},v$1=function(nt){var st=m$2.findIndex(function(mt){return mt>=nt});return st===-1||st===0?nt:m$2[st-1]},p$1=function(nt){var st=nt.containerRef,mt=nt.store,gt=function(_t){if(!_t.shiftKey&&!_t.altKey&&(e$2.isMac()?_t.metaKey:_t.ctrlKey)){var Et=st.current;if(Et&&document.activeElement&&Et.contains(document.activeElement)){var At=mt.get("zoom");if(At){var Rt=mt.get("scale")||1,Ft=1;switch(_t.key){case"-":Ft=v$1(Rt);break;case"=":Ft=f$2(Rt);break;case"0":Ft=1;break;default:Ft=Rt}Ft!==Rt&&(_t.preventDefault(),At(Ft))}}}};return n$2.useEffect(function(){if(st.current)return document.addEventListener("keydown",gt),function(){document.removeEventListener("keydown",gt)}},[st.current]),n$2.createElement(n$2.Fragment,null)},z=[.5,.75,1,1.25,1.5,2,3,4],E$1={left:0,top:8},d$2=function(nt){var st=nt.levels,mt=st===void 0?z:st,gt=nt.scale,_t=nt.onZoom,Et=n$2.useContext(e$2.LocalizationContext).l10n,At=n$2.useContext(e$2.ThemeContext).direction===e$2.TextDirection.RightToLeft,Rt=Et&&Et.zoom?Et.zoom.zoomDocument:"Zoom document";return n$2.createElement(e$2.Popover,{ariaControlsSuffix:"zoom",ariaHasPopup:"menu",position:e$2.Position.BottomCenter,target:function(Ft){return n$2.createElement(e$2.MinimalButton,{ariaLabel:Rt,testId:"zoom__popover-target",onClick:function(){Ft()}},n$2.createElement("span",{className:"rpv-zoom__popover-target"},n$2.createElement("span",{"data-testid":"zoom__popover-target-scale",className:e$2.classNames({"rpv-zoom__popover-target-scale":!0,"rpv-zoom__popover-target-scale--ltr":!At,"rpv-zoom__popover-target-scale--rtl":At})},Math.round(100*gt),"%"),n$2.createElement("span",{className:"rpv-zoom__popover-target-arrow"})))},content:function(Ft){return n$2.createElement(e$2.Menu,null,Object.keys(e$2.SpecialZoomLevel).map(function(Nt){var Bt=Nt;return n$2.createElement(e$2.MenuItem,{key:Bt,onClick:function(){Ft(),_t(Bt)}},function(Gt){switch(Gt){case e$2.SpecialZoomLevel.ActualSize:return Et&&Et.zoom?Et.zoom.actualSize:"Actual size";case e$2.SpecialZoomLevel.PageFit:return Et&&Et.zoom?Et.zoom.pageFit:"Page fit";case e$2.SpecialZoomLevel.PageWidth:return Et&&Et.zoom?Et.zoom.pageWidth:"Page width"}}(Bt))}),n$2.createElement(e$2.MenuDivider,null),mt.map(function(Nt){return n$2.createElement(e$2.MenuItem,{key:Nt,onClick:function(){Ft(),_t(Nt)}},"".concat(Math.round(100*Nt),"%"))}))},offset:E$1,closeOnClickOutside:!0,closeOnEscape:!0})},g$1=function(nt){var st=nt.children,mt=nt.levels,gt=nt.store;return(st||function(_t){return n$2.createElement(d$2,{levels:mt,scale:_t.scale,onZoom:_t.onZoom})})({scale:a$2(gt).scale,onZoom:function(_t){var Et=gt.get("zoom");Et&&Et(_t)}})},C={left:0,top:8},h$1=function(nt){var st=nt.enableShortcuts,mt=nt.onClick,gt=n$2.useContext(e$2.LocalizationContext).l10n,_t=gt&&gt.zoom?gt.zoom.zoomIn:"Zoom in",Et=st?e$2.isMac()?"Meta+=":"Ctrl+=":"";return n$2.createElement(e$2.Tooltip,{ariaControlsSuffix:"zoom-in",position:e$2.Position.BottomCenter,target:n$2.createElement(e$2.MinimalButton,{ariaKeyShortcuts:Et,ariaLabel:_t,testId:"zoom__in-button",onClick:mt},n$2.createElement(o$2,null)),content:function(){return _t},offset:C})},b$1=function(nt){var st=nt.children,mt=nt.enableShortcuts,gt=nt.store,_t=a$2(gt).scale;return(st||h$1)({enableShortcuts:mt,onClick:function(){var Et=gt.get("zoom");Et&&Et(f$2(_t))}})},k=function(nt){var st=nt.onClick,mt=n$2.useContext(e$2.LocalizationContext).l10n,gt=mt&&mt.zoom?mt.zoom.zoomIn:"Zoom in";return n$2.createElement(e$2.MenuItem,{icon:n$2.createElement(o$2,null),testId:"zoom__in-menu",onClick:st},gt)},S$1={left:0,top:8},M$1=function(nt){var st=nt.enableShortcuts,mt=nt.onClick,gt=n$2.useContext(e$2.LocalizationContext).l10n,_t=gt&&gt.zoom?gt.zoom.zoomOut:"Zoom out",Et=st?e$2.isMac()?"Meta+-":"Ctrl+-":"";return n$2.createElement(e$2.Tooltip,{ariaControlsSuffix:"zoom-out",position:e$2.Position.BottomCenter,target:n$2.createElement(e$2.MinimalButton,{ariaKeyShortcuts:Et,ariaLabel:_t,testId:"zoom__out-button",onClick:mt},n$2.createElement(r$2,null)),content:function(){return _t},offset:S$1})},I$1=function(nt){var st=nt.children,mt=nt.enableShortcuts,gt=nt.store,_t=a$2(gt).scale;return(st||M$1)({enableShortcuts:mt,onClick:function(){var Et=gt.get("zoom");Et&&Et(v$1(_t))}})},Z=function(nt){var st=nt.onClick,mt=n$2.useContext(e$2.LocalizationContext).l10n,gt=mt&&mt.zoom?mt.zoom.zoomOut:"Zoom out";return n$2.createElement(e$2.MenuItem,{icon:n$2.createElement(r$2,null),testId:"zoom__out-menu",onClick:st},gt)};zoom_min.ZoomInIcon=o$2,zoom_min.ZoomOutIcon=r$2,zoom_min.zoomPlugin=function(nt){var st=n$2.useMemo(function(){return Object.assign({},{enableShortcuts:!0},nt)},[]),mt=n$2.useMemo(function(){return e$2.createStore({})},[]),gt=function(At){return n$2.createElement(b$1,c$2({enableShortcuts:st.enableShortcuts},At,{store:mt}))},_t=function(At){return n$2.createElement(I$1,c$2({enableShortcuts:st.enableShortcuts},At,{store:mt}))},Et=function(At){return n$2.createElement(g$1,c$2({},At,{store:mt}))};return{renderViewer:function(At){var Rt=At.slot;if(!st.enableShortcuts)return Rt;var Ft={children:n$2.createElement(n$2.Fragment,null,n$2.createElement(p$1,{containerRef:At.containerRef,store:mt}),n$2.createElement(s$2,{pagesContainerRef:At.pagesContainerRef,store:mt}),Rt.children)};return c$2(c$2({},Rt),Ft)},install:function(At){mt.update("zoom",At.zoom)},onViewerStateChange:function(At){return mt.update("scale",At.scale),At},zoomTo:function(At){var Rt=mt.get("zoom");Rt&&Rt(At)},CurrentScale:function(At){return n$2.createElement(u$2,c$2({},At,{store:mt}))},ZoomIn:gt,ZoomInButton:function(){return n$2.createElement(gt,null,function(At){return n$2.createElement(h$1,c$2({},At))})},ZoomInMenuItem:function(At){return n$2.createElement(gt,null,function(Rt){return n$2.createElement(k,{onClick:function(){Rt.onClick(),At.onClick()}})})},ZoomOut:_t,ZoomOutButton:function(){return n$2.createElement(_t,null,function(At){return n$2.createElement(M$1,c$2({},At))})},ZoomOutMenuItem:function(At){return n$2.createElement(_t,null,function(Rt){return n$2.createElement(Z,{onClick:function(){Rt.onClick(),At.onClick()}})})},Zoom:Et,ZoomPopover:function(At){return n$2.createElement(Et,null,function(Rt){return n$2.createElement(d$2,c$2({levels:At==null?void 0:At.levels},Rt))})}}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib.exports=zoom_min;var libExports$2=lib.exports,e$1=libExports$h,t$1=libExports$d,r$1=reactExports,n$1=libExports$c,o$1=libExports$b,a$1=libExports$a,l$1=libExports$9,i$1=libExports$8,c$1=libExports$7,m$1=libExports$6,u$1=libExports$5,s$1=libExports$4,d$1=libExports$3,p=libExports$2;function v(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var _=v(r$1),E=function(){return _.createElement(e$1.Icon,{size:16},_.createElement("path",{d:`M12,0.5c1.381,0,2.5,1.119,2.5,2.5S13.381,5.5,12,5.5S9.5,4.381,9.5,3S10.619,0.5,12,0.5z
            M12,9.5
            c1.381,0,2.5,1.119,2.5,2.5s-1.119,2.5-2.5,2.5S9.5,13.381,9.5,12S10.619,9.5,12,9.5z
            M12,18.5c1.381,0,2.5,1.119,2.5,2.5
            s-1.119,2.5-2.5,2.5S9.5,22.381,9.5,21S10.619,18.5,12,18.5z`}))},g={left:0,top:8},P=function(nt){var st=nt.toolbarSlot,mt=_.useContext(e$1.LocalizationContext).l10n,gt=_.useContext(e$1.ThemeContext).direction===e$1.TextDirection.RightToLeft?e$1.Position.BottomLeft:e$1.Position.BottomRight,_t=st.DownloadMenuItem,Et=st.EnterFullScreenMenuItem,At=st.GoToFirstPageMenuItem,Rt=st.GoToLastPageMenuItem,Ft=st.GoToNextPageMenuItem,Nt=st.GoToPreviousPageMenuItem,Bt=st.OpenMenuItem,Gt=st.PrintMenuItem,dr=st.RotateBackwardMenuItem,Mr=st.RotateForwardMenuItem,Tr=st.ShowPropertiesMenuItem,zr=st.SwitchScrollModeMenuItem,Fr=st.SwitchSelectionModeMenuItem,Nr=st.SwitchViewModeMenuItem,tn=st.SwitchThemeMenuItem;return _.createElement(e$1.Popover,{ariaControlsSuffix:"toolbar-more-actions",ariaHasPopup:"menu",position:gt,target:function(rn,Tn){var $n=mt&&mt.toolbar?mt.toolbar.moreActions:"More actions";return _.createElement(e$1.Tooltip,{ariaControlsSuffix:"toolbar-more-actions",position:gt,target:_.createElement(e$1.MinimalButton,{ariaLabel:$n,isSelected:Tn,testId:"toolbar__more-actions-popover-target",onClick:rn},_.createElement(E,null)),content:function(){return $n},offset:g})},content:function(rn){return _.createElement(e$1.Menu,null,_.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},_.createElement(tn,{onClick:rn})),_.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},_.createElement(Et,{onClick:rn})),_.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},_.createElement(Bt,null)),_.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},_.createElement(Gt,{onClick:rn})),_.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},_.createElement(_t,{onClick:rn})),_.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},_.createElement(e$1.MenuDivider,null)),_.createElement(At,{onClick:rn}),_.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},_.createElement(Nt,{onClick:rn})),_.createElement("div",{className:"rpv-core__display--block rpv-core__display--hidden-medium"},_.createElement(Ft,{onClick:rn})),_.createElement(Rt,{onClick:rn}),_.createElement(e$1.MenuDivider,null),_.createElement(Mr,{onClick:rn}),_.createElement(dr,{onClick:rn}),_.createElement(e$1.MenuDivider,null),_.createElement(Fr,{mode:t$1.SelectionMode.Text,onClick:rn}),_.createElement(Fr,{mode:t$1.SelectionMode.Hand,onClick:rn}),_.createElement(e$1.MenuDivider,null),_.createElement(zr,{mode:e$1.ScrollMode.Page,onClick:rn}),_.createElement(zr,{mode:e$1.ScrollMode.Vertical,onClick:rn}),_.createElement(zr,{mode:e$1.ScrollMode.Horizontal,onClick:rn}),_.createElement(zr,{mode:e$1.ScrollMode.Wrapped,onClick:rn}),_.createElement(e$1.MenuDivider,null),_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},_.createElement(Nr,{mode:e$1.ViewMode.SinglePage,onClick:rn})),_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},_.createElement(Nr,{mode:e$1.ViewMode.DualPage,onClick:rn})),_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},_.createElement(Nr,{mode:e$1.ViewMode.DualPageWithCover,onClick:rn})),_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},_.createElement(e$1.MenuDivider,null)),_.createElement(Tr,{onClick:rn}))},offset:g,closeOnClickOutside:!0,closeOnEscape:!0})},M=function(){return M=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},M.apply(this,arguments)},h=function(nt){return function(st){var mt=_.useMemo(function(){return nt(st)},[]),gt=_.useContext(e$1.ThemeContext).direction===e$1.TextDirection.RightToLeft,_t=mt.CurrentPageInput,Et=mt.Download,At=mt.EnterFullScreen,Rt=mt.GoToNextPage,Ft=mt.GoToPreviousPage,Nt=mt.NumberOfPages,Bt=mt.Open,Gt=mt.Print,dr=mt.ShowSearchPopover,Mr=mt.SwitchTheme,Tr=mt.Zoom,zr=mt.ZoomIn,Fr=mt.ZoomOut;return _.createElement("div",{"data-testid":"toolbar",className:e$1.classNames({"rpv-toolbar":!0,"rpv-toolbar--rtl":gt}),role:"toolbar","aria-orientation":"horizontal"},_.createElement("div",{className:"rpv-toolbar__left"},_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(dr,null)),_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(Ft,null))),_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(_t,null),_.createElement("span",{className:"rpv-toolbar__label"},_.createElement(Nt,null))),_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(Rt,null)))),_.createElement("div",{className:"rpv-toolbar__center"},_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(Fr,null)),_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-small"},_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(Tr,null))),_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(zr,null))),_.createElement("div",{className:"rpv-toolbar__right"},_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-medium"},_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(Mr,null))),_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-medium"},_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(At,null))),_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-medium"},_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(Bt,null))),_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-medium"},_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(Et,null))),_.createElement("div",{className:"rpv-core__display--hidden rpv-core__display--block-medium"},_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(Gt,null))),_.createElement("div",{className:"rpv-toolbar__item"},_.createElement(P,{toolbarSlot:mt}))))}},f$1=function(nt){var st=nt.NumberOfPages;return Object.assign({},nt,{NumberOfPages:function(){return _.createElement(_.Fragment,null,"/ ",_.createElement(st,null))}})},S=function(nt){return h(f$1)(nt)},I=function(nt){var st=nt.children,mt=nt.slot;return(st||S)(mt)};toolbar_min.MoreActionsPopover=P,toolbar_min.MoreIcon=E,toolbar_min.toolbarPlugin=function(nt){var st=n$1.fullScreenPlugin(nt?nt.fullScreenPlugin:{}),mt=o$1.getFilePlugin(nt?nt.getFilePlugin:{}),gt=a$1.openPlugin(nt?nt.openPlugin:{}),_t=l$1.pageNavigationPlugin(nt?nt.pageNavigationPlugin:{}),Et=i$1.printPlugin(nt?nt.printPlugin:{}),At=c$1.propertiesPlugin(),Rt=m$1.rotatePlugin(),Ft=u$1.scrollModePlugin(),Nt=s$1.searchPlugin(nt?nt.searchPlugin:{}),Bt=t$1.selectionModePlugin(nt?nt.selectionModePlugin:{}),Gt=d$1.themePlugin(),dr=p.zoomPlugin(nt?nt.zoomPlugin:{}),Mr=[st,mt,gt,_t,Et,At,Rt,Ft,Nt,Bt,Gt,dr],Tr=_.useCallback(function(zr){var Fr=st.EnterFullScreen,Nr=st.EnterFullScreenMenuItem,tn=mt.Download,rn=mt.DownloadMenuItem,Tn=gt.Open,$n=gt.OpenMenuItem,un=_t.CurrentPageInput,es=_t.CurrentPageLabel,kn=_t.GoToFirstPage,ts=_t.GoToFirstPageMenuItem,Ko=_t.GoToLastPage,ds=_t.GoToLastPageMenuItem,Il=_t.GoToNextPage,ru=_t.GoToNextPageMenuItem,uu=_t.GoToPreviousPage,p0=_t.GoToPreviousPageMenuItem,X1=_t.NumberOfPages,q0=Et.Print,W0=Et.PrintMenuItem,hu=At.ShowProperties,a1=At.ShowPropertiesMenuItem,Vx=Rt.Rotate,t0=Rt.RotateBackwardMenuItem,cu=Rt.RotateForwardMenuItem,lu=Ft.SwitchScrollMode,b0=Ft.SwitchScrollModeMenuItem,l1=Ft.SwitchViewMode,LE=Ft.SwitchViewModeMenuItem,eS=Nt.Search,SA=Nt.ShowSearchPopover,o$=Bt.SwitchSelectionMode,h$=Bt.SwitchSelectionModeMenuItem,d$=Gt.SwitchTheme,y$=Gt.SwitchThemeMenuItem,R$=dr.CurrentScale,M$=dr.Zoom,x$=dr.ZoomIn,v$=dr.ZoomInMenuItem,rS=dr.ZoomOut,wA=dr.ZoomOutMenuItem;return _.createElement(I,M({},zr,{slot:{CurrentPageInput:un,CurrentPageLabel:es,CurrentScale:R$,Download:tn,DownloadMenuItem:rn,EnterFullScreen:Fr,EnterFullScreenMenuItem:Nr,GoToFirstPage:kn,GoToFirstPageMenuItem:ts,GoToLastPage:Ko,GoToLastPageMenuItem:ds,GoToNextPage:Il,GoToNextPageMenuItem:ru,GoToPreviousPage:uu,GoToPreviousPageMenuItem:p0,NumberOfPages:X1,Open:Tn,OpenMenuItem:$n,Print:q0,PrintMenuItem:W0,Rotate:Vx,RotateBackwardMenuItem:t0,RotateForwardMenuItem:cu,Search:eS,ShowProperties:hu,ShowPropertiesMenuItem:a1,ShowSearchPopover:SA,SwitchScrollMode:lu,SwitchScrollModeMenuItem:b0,SwitchSelectionMode:o$,SwitchSelectionModeMenuItem:h$,SwitchViewMode:l1,SwitchViewModeMenuItem:LE,SwitchTheme:d$,SwitchThemeMenuItem:y$,Zoom:M$,ZoomIn:x$,ZoomInMenuItem:v$,ZoomOut:rS,ZoomOutMenuItem:wA}}))},[]);return{fullScreenPluginInstance:st,getFilePluginInstance:mt,openPluginInstance:gt,pageNavigationPluginInstance:_t,printPluginInstance:Et,propertiesPluginInstance:At,rotatePluginInstance:Rt,scrollModePluginInstance:Ft,searchPluginInstance:Nt,selectionModePluginInstance:Bt,themePluginInstance:Gt,zoomPluginInstance:dr,install:function(zr){Mr.forEach(function(Fr){Fr.install&&Fr.install(zr)})},renderPageLayer:function(zr){return _.createElement(_.Fragment,null,Mr.map(function(Fr,Nr){return Fr.renderPageLayer?_.createElement(_.Fragment,{key:Nr},Fr.renderPageLayer(zr)):_.createElement(_.Fragment,{key:Nr})}))},renderViewer:function(zr){var Fr=zr.slot;return Mr.forEach(function(Nr){Nr.renderViewer&&(Fr=Nr.renderViewer(M(M({},zr),{slot:Fr})))}),Fr},uninstall:function(zr){Mr.forEach(function(Fr){Fr.uninstall&&Fr.uninstall(zr)})},onDocumentLoad:function(zr){Mr.forEach(function(Fr){Fr.onDocumentLoad&&Fr.onDocumentLoad(zr)})},onAnnotationLayerRender:function(zr){Mr.forEach(function(Fr){Fr.onAnnotationLayerRender&&Fr.onAnnotationLayerRender(zr)})},onTextLayerRender:function(zr){Mr.forEach(function(Fr){Fr.onTextLayerRender&&Fr.onTextLayerRender(zr)})},onViewerStateChange:function(zr){var Fr=zr;return Mr.forEach(function(Nr){Nr.onViewerStateChange&&(Fr=Nr.onViewerStateChange(Fr))}),Fr},renderDefaultToolbar:h,Toolbar:Tr}};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$c.exports=toolbar_min;var libExports$1=lib$c.exports,e=libExports$h,t=reactExports,n=libExports$g,a=libExports$f,r=libExports$e,o=libExports$1;function l(nt){var st=Object.create(null);return nt&&Object.keys(nt).forEach(function(mt){if(mt!=="default"){var gt=Object.getOwnPropertyDescriptor(nt,mt);Object.defineProperty(st,mt,gt.get?gt:{enumerable:!0,get:function(){return nt[mt]}})}}),st.default=nt,Object.freeze(st)}var u=l(t),c=function(){return u.createElement(e.Icon,{size:16},u.createElement("path",{d:`M11.5,1.5h11c0.552,0,1,0.448,1,1v20c0,0.552-0.448,1-1,1h-21c-0.552,0-1-0.448-1-1v-20c0-0.552,0.448-1,1-1h3
            M11.5,10.5c0,0.55-0.3,0.661-0.659,0.248L8,7.5l-2.844,3.246c-0.363,0.414-0.659,0.3-0.659-0.247v-9c0-0.552,0.448-1,1-1h5
            c0.552,0,1,0.448,1,1L11.5,10.5z
            M14.5,6.499h6
            M14.5,10.499h6
            M3.5,14.499h17
            M3.5,18.499h16.497`}))},i=function(){return i=Object.assign||function(nt){for(var st,mt=1,gt=arguments.length;mt<gt;mt++)for(var _t in st=arguments[mt])Object.prototype.hasOwnProperty.call(st,_t)&&(nt[_t]=st[_t]);return nt},i.apply(this,arguments)},s=function(){return u.createElement(e.Icon,{size:16},u.createElement("path",{d:`M7.618,15.345l8.666-8.666c0.78-0.812,2.071-0.838,2.883-0.058s0.838,2.071,0.058,2.883
            c-0.019,0.02-0.038,0.039-0.058,0.058L7.461,21.305c-1.593,1.593-4.175,1.592-5.767,0s-1.592-4.175,0-5.767c0,0,0,0,0,0
            L13.928,3.305c2.189-2.19,5.739-2.19,7.929-0.001s2.19,5.739,0,7.929l0,0L13.192,19.9`}))},d=function(){return u.createElement(e.Icon,{size:16},u.createElement("path",{d:`M10.5,9.5c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V9.5z
            M23.5,9.5c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V9.5z
            M10.5,22.5 c0,0.552-0.448,1-1,1h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V22.5z
            M23.5,22.5c0,0.552-0.448,1-1,1 h-8c-0.552,0-1-0.448-1-1v-8c0-0.552,0.448-1,1-1h8c0.552,0,1,0.448,1,1V22.5z`}))},b={left:8,top:0},f={left:-8,top:0},m=function(nt){var st=nt.attachmentTabContent,mt=nt.bookmarkTabContent,gt=nt.store,_t=nt.thumbnailTabContent,Et=nt.tabs,At=u.useRef(),Rt=u.useContext(e.LocalizationContext).l10n,Ft=u.useState(gt.get("isCurrentTabOpened")||!1),Nt=Ft[0],Bt=Ft[1],Gt=u.useState(Math.max(gt.get("currentTab")||0,0)),dr=Gt[0],Mr=Gt[1],Tr=u.useContext(e.ThemeContext).direction===e.TextDirection.RightToLeft,zr=[{content:_t,icon:u.createElement(d,null),title:Rt&&Rt.defaultLayout?Rt.defaultLayout.thumbnail:"Thumbnail"},{content:mt,icon:u.createElement(c,null),title:Rt&&Rt.defaultLayout?Rt.defaultLayout.bookmark:"Bookmark"},{content:st,icon:u.createElement(s,null),title:Rt&&Rt.defaultLayout?Rt.defaultLayout.attachment:"Attachment"}],Fr=Et?Et(zr):zr,Nr=function(rn){rn>=0&&rn<=Fr.length-1&&(gt.update("isCurrentTabOpened",!0),Mr(rn))},tn=function(rn){Bt(rn)};return u.useEffect(function(){return gt.subscribe("currentTab",Nr),gt.subscribe("isCurrentTabOpened",tn),function(){gt.unsubscribe("currentTab",Nr),gt.unsubscribe("isCurrentTabOpened",tn)}},[]),Fr.length===0?u.createElement(u.Fragment,null):u.createElement(u.Fragment,null,u.createElement("div",{"data-testid":"default-layout__sidebar",className:e.classNames({"rpv-default-layout__sidebar":!0,"rpv-default-layout__sidebar--opened":Nt,"rpv-default-layout__sidebar--ltr":!Tr,"rpv-default-layout__sidebar--rtl":Tr}),ref:At},u.createElement("div",{className:"rpv-default-layout__sidebar-tabs"},u.createElement("div",{className:"rpv-default-layout__sidebar-headers",role:"tablist","aria-orientation":"vertical"},Fr.map(function(rn,Tn){return u.createElement("div",{"aria-controls":"rpv-default-layout__sidebar-content","aria-selected":dr===Tn,key:Tn,className:"rpv-default-layout__sidebar-header",id:"rpv-default-layout__sidebar-tab-".concat(Tn),role:"tab"},u.createElement(e.Tooltip,{ariaControlsSuffix:"default-layout-sidebar-tab-".concat(Tn),position:Tr?e.Position.LeftCenter:e.Position.RightCenter,target:u.createElement(e.MinimalButton,{ariaLabel:rn.title,isSelected:dr===Tn,onClick:function(){return function($n){if(dr===$n){gt.update("isCurrentTabOpened",!gt.get("isCurrentTabOpened"));var un=At.current;un&&un.style.width&&un.style.removeProperty("width")}else gt.update("currentTab",$n)}(Tn)}},rn.icon),content:function(){return rn.title},offset:Tr?f:b}))})),u.createElement("div",{"aria-labelledby":"rpv-default-layout__sidebar-tab-".concat(dr),id:"rpv-default-layout__sidebar-content",className:e.classNames({"rpv-default-layout__sidebar-content":!0,"rpv-default-layout__sidebar-content--opened":Nt,"rpv-default-layout__sidebar-content--ltr":!Tr,"rpv-default-layout__sidebar-content--rtl":Tr}),role:"tabpanel",tabIndex:-1},Fr[dr].content))),Nt&&u.createElement(e.Splitter,{constrain:function(rn){return rn.firstHalfPercentage>=20&&rn.firstHalfPercentage<=80}}))};defaultLayout_min.BookmarkIcon=c,defaultLayout_min.FileIcon=s,defaultLayout_min.ThumbnailIcon=d,defaultLayout_min.defaultLayoutPlugin=function(nt){var st=u.useMemo(function(){return e.createStore({isCurrentTabOpened:!1,currentTab:0})},[]),mt=n.attachmentPlugin(),gt=a.bookmarkPlugin(),_t=r.thumbnailPlugin(nt?nt.thumbnailPlugin:{}),Et=o.toolbarPlugin(nt?nt.toolbarPlugin:{}),At=mt.Attachments,Rt=gt.Bookmarks,Ft=_t.Thumbnails,Nt=Et.Toolbar,Bt=nt?nt.sidebarTabs:function(dr){return dr},Gt=[mt,gt,_t,Et];return{attachmentPluginInstance:mt,bookmarkPluginInstance:gt,thumbnailPluginInstance:_t,toolbarPluginInstance:Et,activateTab:function(dr){st.update("currentTab",dr)},toggleTab:function(dr){var Mr=st.get("currentTab");st.update("isCurrentTabOpened",!st.get("isCurrentTabOpened")),Mr!==dr&&st.update("currentTab",dr)},install:function(dr){Gt.forEach(function(Mr){Mr.install&&Mr.install(dr)})},renderPageLayer:function(dr){return u.createElement(u.Fragment,null,Gt.map(function(Mr,Tr){return Mr.renderPageLayer?u.createElement(u.Fragment,{key:Tr},Mr.renderPageLayer(dr)):u.createElement(u.Fragment,{key:Tr},u.createElement(u.Fragment,null))}))},renderViewer:function(dr){var Mr=dr.slot;Gt.forEach(function(zr){zr.renderViewer&&(Mr=zr.renderViewer(i(i({},dr),{slot:Mr})))});var Tr=Mr.subSlot&&Mr.subSlot.attrs?{className:Mr.subSlot.attrs.className,"data-testid":Mr.subSlot.attrs["data-testid"],ref:Mr.subSlot.attrs.ref,style:Mr.subSlot.attrs.style}:{};return Mr.children=u.createElement("div",{className:"rpv-default-layout__container"},u.createElement("div",{"data-testid":"default-layout__main",className:e.classNames({"rpv-default-layout__main":!0,"rpv-default-layout__main--rtl":dr.themeContext.direction===e.TextDirection.RightToLeft})},u.createElement(m,{attachmentTabContent:u.createElement(At,null),bookmarkTabContent:u.createElement(Rt,null),store:st,thumbnailTabContent:u.createElement(Ft,null),tabs:Bt}),u.createElement("div",{className:"rpv-default-layout__body","data-testid":"default-layout__body"},u.createElement("div",{className:"rpv-default-layout__toolbar"},nt&&nt.renderToolbar?nt.renderToolbar(Nt):u.createElement(Nt,null)),u.createElement("div",i({},Tr),Mr.subSlot.children))),Mr.children),Mr.subSlot.attrs={},Mr.subSlot.children=u.createElement(u.Fragment,null),Mr},uninstall:function(dr){Gt.forEach(function(Mr){Mr.uninstall&&Mr.uninstall(dr)})},onDocumentLoad:function(dr){Gt.forEach(function(Mr){Mr.onDocumentLoad&&Mr.onDocumentLoad(dr)}),nt&&nt.setInitialTab&&nt.setInitialTab(dr.doc).then(function(Mr){st.update("currentTab",Mr),st.update("isCurrentTabOpened",!0)})},onAnnotationLayerRender:function(dr){Gt.forEach(function(Mr){Mr.onAnnotationLayerRender&&Mr.onAnnotationLayerRender(dr)})},onTextLayerRender:function(dr){Gt.forEach(function(Mr){Mr.onTextLayerRender&&Mr.onTextLayerRender(dr)})},onViewerStateChange:function(dr){var Mr=dr;return Gt.forEach(function(Tr){Tr.onViewerStateChange&&(Mr=Tr.onViewerStateChange(Mr))}),Mr}}},defaultLayout_min.setInitialTabFromPageMode=function(nt){return new Promise(function(st,mt){nt.getPageMode().then(function(gt){if(gt)switch(gt){case e.PageMode.Attachments:st(2);break;case e.PageMode.Bookmarks:st(1);break;case e.PageMode.Thumbnails:st(0);break;default:st(-1)}else st(-1)})})};/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */lib$g.exports=defaultLayout_min;var libExports=lib$g.exports;function PdfViewer({fileUrl:nt}){const st=libExports.defaultLayoutPlugin();return jsxRuntimeExports.jsx("div",{style:{height:"80vh"},children:jsxRuntimeExports.jsx(libExports$h.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:jsxRuntimeExports.jsx(libExports$h.Viewer,{fileUrl:nt,plugins:[st]})})})}PdfViewer.propTypes={fileUrl:PropTypes.string.isRequired};const pdfUrl$1="/website/assets/em3dp-Cp8elmDz.pdf";function EM3DPPage(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GlobalStyle$2,{}),jsxRuntimeExports.jsxs(Nav,{children:[jsxRuntimeExports.jsx(NavLogoSection,{children:jsxRuntimeExports.jsxs(LogoBox,{children:[jsxRuntimeExports.jsxs("a",{href:"/portfolio/",children:[jsxRuntimeExports.jsx(Logo,{src:logoImg,alt:"Logo"})," "]}),jsxRuntimeExports.jsx(NBTitle,{children:"Nick Brady"})]})}),jsxRuntimeExports.jsx(WideNavLinkSection$2,{children:jsxRuntimeExports.jsxs(LinkBox,{children:[jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLinkedin,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"mailto:nickbrady8444@example.com",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faEnvelope,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]})})]}),jsxRuntimeExports.jsx(Main,{children:jsxRuntimeExports.jsxs(ContentContainer,{children:[jsxRuntimeExports.jsx(BoldTitle,{children:"Enhancing FDM 3D Printing with Electromagnetic Control"}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsx(KeywordBubble,{children:"3D Printing"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Electronics and Microcontrollers"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Procedural Modeling"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"C++"})]}),jsxRuntimeExports.jsx(Paragraph,{children:"I developed a software and hardware system to actively predict and cancel system vibrations, eliminating print artifacts using rapid electromagnetic actuation to produce inverse vibrations in the extruder. Additionally, I created a workflow employing high-frequency electromagnetic pulses to create fine surface patterns on printed objects, achieving an aesthetic texture that hides print layer lines without sacrificing dimensional accuracy, material overuse, or print time."}),jsxRuntimeExports.jsx(PdfContainer,{children:jsxRuntimeExports.jsx(PdfViewer,{fileUrl:pdfUrl$1})})]})})]})}const GlobalStyle$2=ft`
  :root {
    --light-gray: #b7b7b7;
    --dividing-line: #303f4d;
    --background: #f5f5f5;
  }

  h1, h2, h3, a, p, span {
    font-family: "Lexend Exa", sans-serif;
    font-weight: 400;
    color: var(--light-gray);
  }

  a {
    font-size: 10pt;
    text-decoration: none;
    text-transform: uppercase;
  }

  strong {
    font-weight: 400;
  }

`,WideNavLinkSection$2=dt(NavLinkSection)`
  flex-basis: 100%;
`,pdfUrl="/website/assets/kidneyPaper-RRW2WjII.pdf";function KidneyPage(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GlobalStyle$1,{}),jsxRuntimeExports.jsxs(Nav,{children:[jsxRuntimeExports.jsx(NavLogoSection,{children:jsxRuntimeExports.jsxs(LogoBox,{children:[jsxRuntimeExports.jsxs("a",{href:"/portfolio/",children:[jsxRuntimeExports.jsx(Logo,{src:logoImg,alt:"Logo"})," "]}),jsxRuntimeExports.jsx(NBTitle,{children:"Nick Brady"})]})}),jsxRuntimeExports.jsx(WideNavLinkSection$1,{children:jsxRuntimeExports.jsxs(LinkBox,{children:[jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLinkedin,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"mailto:nickbrady8444@example.com",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faEnvelope,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]})})]}),jsxRuntimeExports.jsx(Main,{children:jsxRuntimeExports.jsxs(ContentContainer,{children:[jsxRuntimeExports.jsx(BoldTitle,{children:"Autonomous Kidney Stone Detection and Guidance"}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsx(KeywordBubble,{children:"Computer Vision"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Software Development"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"3D Slicer"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Robotics"})]}),jsxRuntimeExports.jsx(Paragraph,{children:"I created an open-source 3D Slicer extension for the detection of and two-stage navigation toward kidney stones using a robotic ureteroscope. During gross guidance, preliminary targets are identified with hue, stabilized through temporal averaging, and validated with K-means grouping. Then, during fine guidance, a hue-and-lightness based region growing algorithm accurately segments stones in preparation for laser lithotripsy (ablation). Software devlopment was done using the 3D Slicer Python API, and OpenCV was used for computer vision."}),jsxRuntimeExports.jsx(Paragraph,{children:"I completed this work during a 10-week internship at the Harvard SNR Lab under the guidance of Professor Nobuhiko Hata."}),jsxRuntimeExports.jsx(PdfContainer,{children:jsxRuntimeExports.jsx(PdfViewer,{fileUrl:pdfUrl})})]})})]})}const GlobalStyle$1=ft`
  :root {
    --light-gray: #b7b7b7;
    --dividing-line: #303f4d;
    --background: #f5f5f5;
  }

  h1, h2, h3, a, p, span {
    font-family: "Lexend Exa", sans-serif;
    font-weight: 400;
    color: var(--light-gray);
  }

  a {
    font-size: 10pt;
    text-decoration: none;
    text-transform: uppercase;
  }

  strong {
    font-weight: 400;
  }

`,WideNavLinkSection$1=dt(NavLinkSection)`
  flex-basis: 100%;
`,accountGif="/website/assets/account-CjIRF225.gif",artistGif="/website/assets/artist-wxmaN5Vl.gif",bookmarkedImg="/website/assets/bookmarked-DRKn3QBz.png",compareImg="/website/assets/compare-BWnMVKw1.png",daily5Gif="/website/assets/daily5-CGV5HjAi.gif",followingGif="/website/assets/following-qrKq7RRH.gif",gutImg="/website/assets/gut-1ey_AFXw.png",homeImg="/website/assets/home-BArpmE0t.png",loginImg="/website/assets/login-BcE05MSv.png",searchGif="/website/assets/search-BJIJDbvC.gif",settingsImg="/website/assets/settings-MYAfPMRc.png",songGIf="/website/assets/song-DFu7HEi3.gif",tinderGif="/website/assets/tinder-CG8_Zsf1.gif";function OrthoticProstheticPage(){const nt={dots:!0,adaptiveHeight:!1,infinite:!0,slidesToShow:1,slidesToScroll:1,autoplay:!1,pauseOnHover:!0,nextArrow:jsxRuntimeExports.jsx(SampleNextArrow,{}),prevArrow:jsxRuntimeExports.jsx(SamplePrevArrow,{})};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(GlobalStyle,{}),jsxRuntimeExports.jsxs(Nav,{children:[jsxRuntimeExports.jsx(NavLogoSection,{children:jsxRuntimeExports.jsxs(LogoBox,{children:[jsxRuntimeExports.jsxs("a",{href:"/portfolio/",children:[jsxRuntimeExports.jsx(Logo,{src:logoImg,alt:"Logo"})," "]}),jsxRuntimeExports.jsx(NBTitle,{children:"Nick Brady"})]})}),jsxRuntimeExports.jsx(WideNavLinkSection,{children:jsxRuntimeExports.jsxs(LinkBox,{children:[jsxRuntimeExports.jsx("a",{href:"https://www.linkedin.com/in/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faLinkedin,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"mailto:nickbrady8444@example.com",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faEnvelope,size:"1x"})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/nickmbrady",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(FontAwesomeIcon,{icon:faGithub,size:"1x"})})]})})]}),jsxRuntimeExports.jsx(Main,{children:jsxRuntimeExports.jsxs(ContentContainer,{children:[jsxRuntimeExports.jsx(BoldTitle,{children:"Herd: Music App"}),jsxRuntimeExports.jsx(Paragraph,{children:"I worked with a client to create the complete front-end for an upcoming music-based social media mobile app, Herd. My work centered around creating a warm, aesthetic interface that allowed the bright colors of album covers to stand out. My favorite feature is the smooth and gratifying gesture-based ranking system. Everything was written with React Native with a Supabase backend."}),jsxRuntimeExports.jsxs(BubbleDiv,{children:[jsxRuntimeExports.jsx(KeywordBubble,{children:"Software Development"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Graphical User Interface"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"Javascript"}),jsxRuntimeExports.jsx(KeywordBubble,{children:"React Native"})]}),jsxRuntimeExports.jsx(SliderContainer,{style:{paddingTop:30,maxWidth:"40vh",margin:"0 auto"},children:jsxRuntimeExports.jsx("div",{className:"slider-container",children:jsxRuntimeExports.jsxs(Slider,{...nt,children:[jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:homeImg,alt:"Home"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:accountGif,alt:"Account"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:tinderGif,alt:"Tinder"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:artistGif,alt:"Artist"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:songGIf,alt:"Song"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:compareImg,alt:"Compare"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:daily5Gif,alt:"Daily 5"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:gutImg,alt:"Gut"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:loginImg,alt:"Login"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:searchGif,alt:"Search"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:bookmarkedImg,alt:"Bookmarked"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:followingGif,alt:"Following"})}),jsxRuntimeExports.jsx(FullHeightImageSliderDiv,{children:jsxRuntimeExports.jsx(SliderImg2,{src:settingsImg,alt:"Settings"})})]})})})]})})]})}const GlobalStyle=ft`
  :root {
    --light-gray: #b7b7b7;
    --dividing-line: #303f4d;
    --background: #f5f5f5;
  }

  h1, h2, h3, a, p, span {
    font-family: "Lexend Exa", sans-serif;
    font-weight: 400;
    color: var(--light-gray);
  }

  a {
    font-size: 10pt;
    text-decoration: none;
    text-transform: uppercase;
  }

  strong {
    font-weight: 400;
  }
  
`,WideNavLinkSection=dt(NavLinkSection)`
  flex-basis: 100%;
`;function App(){return jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(HomePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/projects",element:jsxRuntimeExports.jsx(ProjectsPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/experience",element:jsxRuntimeExports.jsx(ExperiencePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/about",element:jsxRuntimeExports.jsx(AboutPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/projects/orthoticprosthetic",element:jsxRuntimeExports.jsx(OrthoticProstheticPage$2,{})}),jsxRuntimeExports.jsx(Route,{path:"/projects/compositeelementdetection",element:jsxRuntimeExports.jsx(OrthoticProstheticPage$1,{})}),jsxRuntimeExports.jsx(Route,{path:"/projects/diffusionedge",element:jsxRuntimeExports.jsx(DiffusionEdgePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/projects/electromagnetic3dprinting",element:jsxRuntimeExports.jsx(EM3DPPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/projects/kidneystonenavigation",element:jsxRuntimeExports.jsx(KidneyPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/projects/herd",element:jsxRuntimeExports.jsx(OrthoticProstheticPage,{})})]})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(HashRouter,{children:jsxRuntimeExports.jsx(App,{})})}));export{commonjsGlobal as c,getDefaultExportFromCjs as g};
